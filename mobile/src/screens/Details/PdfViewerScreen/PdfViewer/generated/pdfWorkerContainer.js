
  const bundle = 'LyoqCiAqIEBsaWNzdGFydCBUaGUgZm9sbG93aW5nIGlzIHRoZSBlbnRpcmUgbGljZW5zZSBub3RpY2UgZm9yIHRoZQogKiBKYXZhc2NyaXB0IGNvZGUgaW4gdGhpcyBwYWdlCiAqCiAqIENvcHlyaWdodCAyMDIwIE1vemlsbGEgRm91bmRhdGlvbgogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgogKgogKiBAbGljZW5kIFRoZSBhYm92ZSBpcyB0aGUgZW50aXJlIGxpY2Vuc2Ugbm90aWNlIGZvciB0aGUKICogSmF2YXNjcmlwdCBjb2RlIGluIHRoaXMgcGFnZQogKi8KCihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7CglpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpCgkJbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7CgllbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkKCQlkZWZpbmUoInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciIsIFtdLCBmYWN0b3J5KTsKCWVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKQoJCWV4cG9ydHNbInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciJdID0gZmFjdG9yeSgpOwoJZWxzZQoJCXJvb3RbInBkZmpzLWRpc3QvYnVpbGQvcGRmLndvcmtlciJdID0gcm9vdC5wZGZqc1dvcmtlciA9IGZhY3RvcnkoKTsKfSkodGhpcywgZnVuY3Rpb24oKSB7CnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OwovKioqKioqLwovKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KLyoqKioqKi8gCWZ1bmN0aW9uIF9fd19wZGZqc19yZXF1aXJlX18obW9kdWxlSWQpIHsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQlpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkgewovKioqKioqLyAJCQlyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0czsKLyoqKioqKi8gCQl9Ci8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCWk6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsOiBmYWxzZSwKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLwovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgovKioqKioqLyAJCW1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pOwovKioqKioqLwovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubCA9IHRydWU7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9Ci8qKioqKiovCi8qKioqKiovCi8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKQovKioqKioqLyAJX193X3BkZmpzX3JlcXVpcmVfXy5tID0gbW9kdWxlczsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAlfX3dfcGRmanNfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOwovKioqKioqLwovKioqKioqLyAJLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzCi8qKioqKiovIAlfX3dfcGRmanNfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHsKLyoqKioqKi8gCQlpZighX193X3BkZmpzX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7Ci8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pOwovKioqKioqLyAJCX0KLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzCi8qKioqKiovIAlfX3dfcGRmanNfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7Ci8qKioqKiovIAkJaWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7Ci8qKioqKiovIAkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pOwovKioqKioqLyAJCX0KLyoqKioqKi8gCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pOwovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdAovKioqKioqLyAJLy8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0Ci8qKioqKiovIAkvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnMKLyoqKioqKi8gCS8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdAovKioqKioqLyAJLy8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZQovKioqKioqLyAJX193X3BkZmpzX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHsKLyoqKioqKi8gCQlpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKHZhbHVlKTsKLyoqKioqKi8gCQlpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlOwovKioqKioqLyAJCWlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7Ci8qKioqKiovIAkJdmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKLyoqKioqKi8gCQlfX3dfcGRmanNfcmVxdWlyZV9fLnIobnMpOwovKioqKioqLyAJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTsKLyoqKioqKi8gCQlpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dfcGRmanNfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7Ci8qKioqKiovIAkJcmV0dXJuIG5zOwovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzCi8qKioqKiovIAlfX3dfcGRmanNfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHsKLyoqKioqKi8gCQl2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID8KLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDoKLyoqKioqKi8gCQkJZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTsKLyoqKioqKi8gCQlfX3dfcGRmanNfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7Ci8qKioqKiovIAkJcmV0dXJuIGdldHRlcjsKLyoqKioqKi8gCX07Ci8qKioqKiovCi8qKioqKiovIAkvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwKLyoqKioqKi8gCV9fd19wZGZqc19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fCi8qKioqKiovIAlfX3dfcGRmanNfcmVxdWlyZV9fLnAgPSAiIjsKLyoqKioqKi8KLyoqKioqKi8KLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJcmV0dXJuIF9fd19wZGZqc19yZXF1aXJlX18oX193X3BkZmpzX3JlcXVpcmVfXy5zID0gMCk7Ci8qKioqKiovIH0pCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIChbCi8qIDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJXb3JrZXJNZXNzYWdlSGFuZGxlciIsIHsKICBlbnVtZXJhYmxlOiB0cnVlLAogIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgcmV0dXJuIF93b3JrZXIuV29ya2VyTWVzc2FnZUhhbmRsZXI7CiAgfQp9KTsKCnZhciBfd29ya2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxKTsKCnZhciBwZGZqc1ZlcnNpb24gPSAnMi41LjIwNyc7CnZhciBwZGZqc0J1aWxkID0gJzA5NzRkNjA1JzsKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuV29ya2VyTWVzc2FnZUhhbmRsZXIgPSBleHBvcnRzLldvcmtlclRhc2sgPSB2b2lkIDA7Cgp2YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfX3dfcGRmanNfcmVxdWlyZV9fKDIpKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5OCk7Cgp2YXIgX3BkZl9tYW5hZ2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTkpOwoKdmFyIF9pc19ub2RlID0gX193X3BkZmpzX3JlcXVpcmVfXyg3KTsKCnZhciBfbWVzc2FnZV9oYW5kbGVyID0gX193X3BkZmpzX3JlcXVpcmVfXygyMzgpOwoKdmFyIF93b3JrZXJfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMzkpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgImRlZmF1bHQiOiBvYmogfTsgfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJ1bmRlZmluZWQiIHx8ICEoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSkgcmV0dXJuOyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKdmFyIFdvcmtlclRhc2sgPSBmdW5jdGlvbiBXb3JrZXJUYXNrQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBXb3JrZXJUYXNrKG5hbWUpIHsKICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICB0aGlzLnRlcm1pbmF0ZWQgPSBmYWxzZTsKICAgIHRoaXMuX2NhcGFiaWxpdHkgPSAoMCwgX3V0aWwuY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHkpKCk7CiAgfQoKICBXb3JrZXJUYXNrLnByb3RvdHlwZSA9IHsKICAgIGdldCBmaW5pc2hlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NhcGFiaWxpdHkucHJvbWlzZTsKICAgIH0sCgogICAgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2goKSB7CiAgICAgIHRoaXMuX2NhcGFiaWxpdHkucmVzb2x2ZSgpOwogICAgfSwKICAgIHRlcm1pbmF0ZTogZnVuY3Rpb24gdGVybWluYXRlKCkgewogICAgICB0aGlzLnRlcm1pbmF0ZWQgPSB0cnVlOwogICAgfSwKICAgIGVuc3VyZU5vdFRlcm1pbmF0ZWQ6IGZ1bmN0aW9uIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKSB7CiAgICAgIGlmICh0aGlzLnRlcm1pbmF0ZWQpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIldvcmtlciB0YXNrIHdhcyB0ZXJtaW5hdGVkIik7CiAgICAgIH0KICAgIH0KICB9OwogIHJldHVybiBXb3JrZXJUYXNrOwp9KCk7CgpleHBvcnRzLldvcmtlclRhc2sgPSBXb3JrZXJUYXNrOwp2YXIgV29ya2VyTWVzc2FnZUhhbmRsZXIgPSB7CiAgc2V0dXA6IGZ1bmN0aW9uIHNldHVwKGhhbmRsZXIsIHBvcnQpIHsKICAgIHZhciB0ZXN0TWVzc2FnZVByb2Nlc3NlZCA9IGZhbHNlOwogICAgaGFuZGxlci5vbigidGVzdCIsIGZ1bmN0aW9uIHdwaFNldHVwVGVzdChkYXRhKSB7CiAgICAgIGlmICh0ZXN0TWVzc2FnZVByb2Nlc3NlZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGVzdE1lc3NhZ2VQcm9jZXNzZWQgPSB0cnVlOwoKICAgICAgaWYgKCEoZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpKSB7CiAgICAgICAgaGFuZGxlci5zZW5kKCJ0ZXN0IiwgbnVsbCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgc3VwcG9ydFRyYW5zZmVycyA9IGRhdGFbMF0gPT09IDI1NTsKICAgICAgaGFuZGxlci5wb3N0TWVzc2FnZVRyYW5zZmVycyA9IHN1cHBvcnRUcmFuc2ZlcnM7CiAgICAgIGhhbmRsZXIuc2VuZCgidGVzdCIsIHsKICAgICAgICBzdXBwb3J0VHJhbnNmZXJzOiBzdXBwb3J0VHJhbnNmZXJzCiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJjb25maWd1cmUiLCBmdW5jdGlvbiB3cGhDb25maWd1cmUoZGF0YSkgewogICAgICAoMCwgX3V0aWwuc2V0VmVyYm9zaXR5TGV2ZWwpKGRhdGEudmVyYm9zaXR5KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RG9jUmVxdWVzdCIsIGZ1bmN0aW9uIHdwaFNldHVwRG9jKGRhdGEpIHsKICAgICAgcmV0dXJuIFdvcmtlck1lc3NhZ2VIYW5kbGVyLmNyZWF0ZURvY3VtZW50SGFuZGxlcihkYXRhLCBwb3J0KTsKICAgIH0pOwogIH0sCiAgY3JlYXRlRG9jdW1lbnRIYW5kbGVyOiBmdW5jdGlvbiBjcmVhdGVEb2N1bWVudEhhbmRsZXIoZG9jUGFyYW1zLCBwb3J0KSB7CiAgICB2YXIgcGRmTWFuYWdlcjsKICAgIHZhciB0ZXJtaW5hdGVkID0gZmFsc2U7CiAgICB2YXIgY2FuY2VsWEhScyA9IG51bGw7CiAgICB2YXIgV29ya2VyVGFza3MgPSBbXTsKICAgIHZhciB2ZXJib3NpdHkgPSAoMCwgX3V0aWwuZ2V0VmVyYm9zaXR5TGV2ZWwpKCk7CiAgICB2YXIgYXBpVmVyc2lvbiA9IGRvY1BhcmFtcy5hcGlWZXJzaW9uOwogICAgdmFyIHdvcmtlclZlcnNpb24gPSAnMi41LjIwNyc7CgogICAgaWYgKGFwaVZlcnNpb24gIT09IHdvcmtlclZlcnNpb24pIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJUaGUgQVBJIHZlcnNpb24gXCIiLmNvbmNhdChhcGlWZXJzaW9uLCAiXCIgZG9lcyBub3QgbWF0Y2ggIikgKyAidGhlIFdvcmtlciB2ZXJzaW9uIFwiIi5jb25jYXQod29ya2VyVmVyc2lvbiwgIlwiLiIpKTsKICAgIH0KCiAgICB2YXIgZW51bWVyYWJsZVByb3BlcnRpZXMgPSBbXTsKCiAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBbXSkgewogICAgICBlbnVtZXJhYmxlUHJvcGVydGllcy5wdXNoKHByb3BlcnR5KTsKICAgIH0KCiAgICBpZiAoZW51bWVyYWJsZVByb3BlcnRpZXMubGVuZ3RoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiVGhlIGBBcnJheS5wcm90b3R5cGVgIGNvbnRhaW5zIHVuZXhwZWN0ZWQgZW51bWVyYWJsZSBwcm9wZXJ0aWVzOiAiICsgZW51bWVyYWJsZVByb3BlcnRpZXMuam9pbigiLCAiKSArICI7IHRodXMgYnJlYWtpbmcgZS5nLiBgZm9yLi4uaW5gIGl0ZXJhdGlvbiBvZiBgQXJyYXlgcy4iKTsKICAgIH0KCiAgICB2YXIgZG9jSWQgPSBkb2NQYXJhbXMuZG9jSWQ7CiAgICB2YXIgZG9jQmFzZVVybCA9IGRvY1BhcmFtcy5kb2NCYXNlVXJsOwogICAgdmFyIHdvcmtlckhhbmRsZXJOYW1lID0gZG9jUGFyYW1zLmRvY0lkICsgIl93b3JrZXIiOwogICAgdmFyIGhhbmRsZXIgPSBuZXcgX21lc3NhZ2VfaGFuZGxlci5NZXNzYWdlSGFuZGxlcih3b3JrZXJIYW5kbGVyTmFtZSwgZG9jSWQsIHBvcnQpOwogICAgaGFuZGxlci5wb3N0TWVzc2FnZVRyYW5zZmVycyA9IGRvY1BhcmFtcy5wb3N0TWVzc2FnZVRyYW5zZmVyczsKCiAgICBmdW5jdGlvbiBlbnN1cmVOb3RUZXJtaW5hdGVkKCkgewogICAgICBpZiAodGVybWluYXRlZCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiV29ya2VyIHdhcyB0ZXJtaW5hdGVkIik7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzdGFydFdvcmtlclRhc2sodGFzaykgewogICAgICBXb3JrZXJUYXNrcy5wdXNoKHRhc2spOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbmlzaFdvcmtlclRhc2sodGFzaykgewogICAgICB0YXNrLmZpbmlzaCgpOwogICAgICB2YXIgaSA9IFdvcmtlclRhc2tzLmluZGV4T2YodGFzayk7CiAgICAgIFdvcmtlclRhc2tzLnNwbGljZShpLCAxKTsKICAgIH0KCiAgICBmdW5jdGlvbiBsb2FkRG9jdW1lbnQoX3gpIHsKICAgICAgcmV0dXJuIF9sb2FkRG9jdW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfbG9hZERvY3VtZW50KCkgewogICAgICBfbG9hZERvY3VtZW50ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JbImRlZmF1bHQiXS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUocmVjb3ZlcnlNb2RlKSB7CiAgICAgICAgdmFyIF95aWVsZCRQcm9taXNlJGFsbCwgX3lpZWxkJFByb21pc2UkYWxsMiwgbnVtUGFnZXMsIGZpbmdlcnByaW50OwoKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlRG9jKCJjaGVja0hlYWRlciIpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZURvYygicGFyc2VTdGFydFhSZWYiKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVEb2MoInBhcnNlIiwgW3JlY292ZXJ5TW9kZV0pOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAocmVjb3ZlcnlNb2RlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZURvYygiY2hlY2tGaXJzdFBhZ2UiKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtwZGZNYW5hZ2VyLmVuc3VyZURvYygibnVtUGFnZXMiKSwgcGRmTWFuYWdlci5lbnN1cmVEb2MoImZpbmdlcnByaW50IildKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIF95aWVsZCRQcm9taXNlJGFsbCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBfeWllbGQkUHJvbWlzZSRhbGwyID0gX3NsaWNlZFRvQXJyYXkoX3lpZWxkJFByb21pc2UkYWxsLCAyKTsKICAgICAgICAgICAgICAgIG51bVBhZ2VzID0gX3lpZWxkJFByb21pc2UkYWxsMlswXTsKICAgICAgICAgICAgICAgIGZpbmdlcnByaW50ID0gX3lpZWxkJFByb21pc2UkYWxsMlsxXTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgICAgbnVtUGFnZXM6IG51bVBhZ2VzLAogICAgICAgICAgICAgICAgICBmaW5nZXJwcmludDogZmluZ2VycHJpbnQKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKTsKICAgICAgcmV0dXJuIF9sb2FkRG9jdW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRQZGZNYW5hZ2VyKGRhdGEsIGV2YWx1YXRvck9wdGlvbnMpIHsKICAgICAgdmFyIHBkZk1hbmFnZXJDYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICB2YXIgbmV3UGRmTWFuYWdlcjsKICAgICAgdmFyIHNvdXJjZSA9IGRhdGEuc291cmNlOwoKICAgICAgaWYgKHNvdXJjZS5kYXRhKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIG5ld1BkZk1hbmFnZXIgPSBuZXcgX3BkZl9tYW5hZ2VyLkxvY2FsUGRmTWFuYWdlcihkb2NJZCwgc291cmNlLmRhdGEsIHNvdXJjZS5wYXNzd29yZCwgZXZhbHVhdG9yT3B0aW9ucywgZG9jQmFzZVVybCk7CiAgICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZXNvbHZlKG5ld1BkZk1hbmFnZXIpOwogICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZWplY3QoZXgpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBkZk1hbmFnZXJDYXBhYmlsaXR5LnByb21pc2U7CiAgICAgIH0KCiAgICAgIHZhciBwZGZTdHJlYW0sCiAgICAgICAgICBjYWNoZWRDaHVua3MgPSBbXTsKCiAgICAgIHRyeSB7CiAgICAgICAgcGRmU3RyZWFtID0gbmV3IF93b3JrZXJfc3RyZWFtLlBERldvcmtlclN0cmVhbShoYW5kbGVyKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZWplY3QoZXgpOwogICAgICAgIHJldHVybiBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgICB9CgogICAgICB2YXIgZnVsbFJlcXVlc3QgPSBwZGZTdHJlYW0uZ2V0RnVsbFJlYWRlcigpOwogICAgICBmdWxsUmVxdWVzdC5oZWFkZXJzUmVhZHkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCFmdWxsUmVxdWVzdC5pc1JhbmdlU3VwcG9ydGVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgZGlzYWJsZUF1dG9GZXRjaCA9IHNvdXJjZS5kaXNhYmxlQXV0b0ZldGNoIHx8IGZ1bGxSZXF1ZXN0LmlzU3RyZWFtaW5nU3VwcG9ydGVkOwogICAgICAgIG5ld1BkZk1hbmFnZXIgPSBuZXcgX3BkZl9tYW5hZ2VyLk5ldHdvcmtQZGZNYW5hZ2VyKGRvY0lkLCBwZGZTdHJlYW0sIHsKICAgICAgICAgIG1zZ0hhbmRsZXI6IGhhbmRsZXIsCiAgICAgICAgICBwYXNzd29yZDogc291cmNlLnBhc3N3b3JkLAogICAgICAgICAgbGVuZ3RoOiBmdWxsUmVxdWVzdC5jb250ZW50TGVuZ3RoLAogICAgICAgICAgZGlzYWJsZUF1dG9GZXRjaDogZGlzYWJsZUF1dG9GZXRjaCwKICAgICAgICAgIHJhbmdlQ2h1bmtTaXplOiBzb3VyY2UucmFuZ2VDaHVua1NpemUKICAgICAgICB9LCBldmFsdWF0b3JPcHRpb25zLCBkb2NCYXNlVXJsKTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWNoZWRDaHVua3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIG5ld1BkZk1hbmFnZXIuc2VuZFByb2dyZXNzaXZlRGF0YShjYWNoZWRDaHVua3NbaV0pOwogICAgICAgIH0KCiAgICAgICAgY2FjaGVkQ2h1bmtzID0gW107CiAgICAgICAgcGRmTWFuYWdlckNhcGFiaWxpdHkucmVzb2x2ZShuZXdQZGZNYW5hZ2VyKTsKICAgICAgICBjYW5jZWxYSFJzID0gbnVsbDsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgIHBkZk1hbmFnZXJDYXBhYmlsaXR5LnJlamVjdChyZWFzb24pOwogICAgICAgIGNhbmNlbFhIUnMgPSBudWxsOwogICAgICB9KTsKICAgICAgdmFyIGxvYWRlZCA9IDA7CgogICAgICB2YXIgZmx1c2hDaHVua3MgPSBmdW5jdGlvbiBmbHVzaENodW5rcygpIHsKICAgICAgICB2YXIgcGRmRmlsZSA9ICgwLCBfdXRpbC5hcnJheXNUb0J5dGVzKShjYWNoZWRDaHVua3MpOwoKICAgICAgICBpZiAoc291cmNlLmxlbmd0aCAmJiBwZGZGaWxlLmxlbmd0aCAhPT0gc291cmNlLmxlbmd0aCkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJyZXBvcnRlZCBIVFRQIGxlbmd0aCBpcyBkaWZmZXJlbnQgZnJvbSBhY3R1YWwiKTsKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICBuZXdQZGZNYW5hZ2VyID0gbmV3IF9wZGZfbWFuYWdlci5Mb2NhbFBkZk1hbmFnZXIoZG9jSWQsIHBkZkZpbGUsIHNvdXJjZS5wYXNzd29yZCwgZXZhbHVhdG9yT3B0aW9ucywgZG9jQmFzZVVybCk7CiAgICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZXNvbHZlKG5ld1BkZk1hbmFnZXIpOwogICAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgICBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5yZWplY3QoZXgpOwogICAgICAgIH0KCiAgICAgICAgY2FjaGVkQ2h1bmtzID0gW107CiAgICAgIH07CgogICAgICB2YXIgcmVhZFByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJlYWRDaHVuayA9IGZ1bmN0aW9uIHJlYWRDaHVuayhfcmVmKSB7CiAgICAgICAgICB2YXIgdmFsdWUgPSBfcmVmLnZhbHVlLAogICAgICAgICAgICAgIGRvbmUgPSBfcmVmLmRvbmU7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZW5zdXJlTm90VGVybWluYXRlZCgpOwoKICAgICAgICAgICAgaWYgKGRvbmUpIHsKICAgICAgICAgICAgICBpZiAoIW5ld1BkZk1hbmFnZXIpIHsKICAgICAgICAgICAgICAgIGZsdXNoQ2h1bmtzKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYW5jZWxYSFJzID0gbnVsbDsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxvYWRlZCArPSAoMCwgX3V0aWwuYXJyYXlCeXRlTGVuZ3RoKSh2YWx1ZSk7CgogICAgICAgICAgICBpZiAoIWZ1bGxSZXF1ZXN0LmlzU3RyZWFtaW5nU3VwcG9ydGVkKSB7CiAgICAgICAgICAgICAgaGFuZGxlci5zZW5kKCJEb2NQcm9ncmVzcyIsIHsKICAgICAgICAgICAgICAgIGxvYWRlZDogbG9hZGVkLAogICAgICAgICAgICAgICAgdG90YWw6IE1hdGgubWF4KGxvYWRlZCwgZnVsbFJlcXVlc3QuY29udGVudExlbmd0aCB8fCAwKQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobmV3UGRmTWFuYWdlcikgewogICAgICAgICAgICAgIG5ld1BkZk1hbmFnZXIuc2VuZFByb2dyZXNzaXZlRGF0YSh2YWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY2FjaGVkQ2h1bmtzLnB1c2godmFsdWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdWxsUmVxdWVzdC5yZWFkKCkudGhlbihyZWFkQ2h1bmssIHJlamVjdCk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBmdWxsUmVxdWVzdC5yZWFkKCkudGhlbihyZWFkQ2h1bmssIHJlamVjdCk7CiAgICAgIH0pOwogICAgICByZWFkUHJvbWlzZVsiY2F0Y2giXShmdW5jdGlvbiAoZSkgewogICAgICAgIHBkZk1hbmFnZXJDYXBhYmlsaXR5LnJlamVjdChlKTsKICAgICAgICBjYW5jZWxYSFJzID0gbnVsbDsKICAgICAgfSk7CgogICAgICBjYW5jZWxYSFJzID0gZnVuY3Rpb24gY2FuY2VsWEhScyhyZWFzb24pIHsKICAgICAgICBwZGZTdHJlYW0uY2FuY2VsQWxsUmVxdWVzdHMocmVhc29uKTsKICAgICAgfTsKCiAgICAgIHJldHVybiBwZGZNYW5hZ2VyQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldHVwRG9jKGRhdGEpIHsKICAgICAgZnVuY3Rpb24gb25TdWNjZXNzKGRvYykgewogICAgICAgIGVuc3VyZU5vdFRlcm1pbmF0ZWQoKTsKICAgICAgICBoYW5kbGVyLnNlbmQoIkdldERvYyIsIHsKICAgICAgICAgIHBkZkluZm86IGRvYwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBvbkZhaWx1cmUoZXgpIHsKICAgICAgICBlbnN1cmVOb3RUZXJtaW5hdGVkKCk7CgogICAgICAgIGlmIChleCBpbnN0YW5jZW9mIF91dGlsLlBhc3N3b3JkRXhjZXB0aW9uKSB7CiAgICAgICAgICB2YXIgdGFzayA9IG5ldyBXb3JrZXJUYXNrKCJQYXNzd29yZEV4Y2VwdGlvbjogcmVzcG9uc2UgIi5jb25jYXQoZXguY29kZSkpOwogICAgICAgICAgc3RhcnRXb3JrZXJUYXNrKHRhc2spOwogICAgICAgICAgaGFuZGxlci5zZW5kV2l0aFByb21pc2UoIlBhc3N3b3JkUmVxdWVzdCIsIGV4KS50aGVuKGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgICAgICB2YXIgcGFzc3dvcmQgPSBfcmVmMi5wYXNzd29yZDsKICAgICAgICAgICAgZmluaXNoV29ya2VyVGFzayh0YXNrKTsKICAgICAgICAgICAgcGRmTWFuYWdlci51cGRhdGVQYXNzd29yZChwYXNzd29yZCk7CiAgICAgICAgICAgIHBkZk1hbmFnZXJSZWFkeSgpOwogICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwogICAgICAgICAgICBoYW5kbGVyLnNlbmQoIkRvY0V4Y2VwdGlvbiIsIGV4KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAoZXggaW5zdGFuY2VvZiBfdXRpbC5JbnZhbGlkUERGRXhjZXB0aW9uIHx8IGV4IGluc3RhbmNlb2YgX3V0aWwuTWlzc2luZ1BERkV4Y2VwdGlvbiB8fCBleCBpbnN0YW5jZW9mIF91dGlsLlVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbiB8fCBleCBpbnN0YW5jZW9mIF91dGlsLlVua25vd25FcnJvckV4Y2VwdGlvbikgewogICAgICAgICAgaGFuZGxlci5zZW5kKCJEb2NFeGNlcHRpb24iLCBleCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhhbmRsZXIuc2VuZCgiRG9jRXhjZXB0aW9uIiwgbmV3IF91dGlsLlVua25vd25FcnJvckV4Y2VwdGlvbihleC5tZXNzYWdlLCBleC50b1N0cmluZygpKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBwZGZNYW5hZ2VyUmVhZHkoKSB7CiAgICAgICAgZW5zdXJlTm90VGVybWluYXRlZCgpOwogICAgICAgIGxvYWREb2N1bWVudChmYWxzZSkudGhlbihvblN1Y2Nlc3MsIGZ1bmN0aW9uIGxvYWRGYWlsdXJlKGV4KSB7CiAgICAgICAgICBlbnN1cmVOb3RUZXJtaW5hdGVkKCk7CgogICAgICAgICAgaWYgKCEoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5YUmVmUGFyc2VFeGNlcHRpb24pKSB7CiAgICAgICAgICAgIG9uRmFpbHVyZShleCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBwZGZNYW5hZ2VyLnJlcXVlc3RMb2FkZWRTdHJlYW0oKTsKICAgICAgICAgIHBkZk1hbmFnZXIub25Mb2FkZWRTdHJlYW0oKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgZW5zdXJlTm90VGVybWluYXRlZCgpOwogICAgICAgICAgICBsb2FkRG9jdW1lbnQodHJ1ZSkudGhlbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9LCBvbkZhaWx1cmUpOwogICAgICB9CgogICAgICBlbnN1cmVOb3RUZXJtaW5hdGVkKCk7CiAgICAgIHZhciBldmFsdWF0b3JPcHRpb25zID0gewogICAgICAgIG1heEltYWdlU2l6ZTogZGF0YS5tYXhJbWFnZVNpemUsCiAgICAgICAgZGlzYWJsZUZvbnRGYWNlOiBkYXRhLmRpc2FibGVGb250RmFjZSwKICAgICAgICBpZ25vcmVFcnJvcnM6IGRhdGEuaWdub3JlRXJyb3JzLAogICAgICAgIGlzRXZhbFN1cHBvcnRlZDogZGF0YS5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgZm9udEV4dHJhUHJvcGVydGllczogZGF0YS5mb250RXh0cmFQcm9wZXJ0aWVzCiAgICAgIH07CiAgICAgIGdldFBkZk1hbmFnZXIoZGF0YSwgZXZhbHVhdG9yT3B0aW9ucykudGhlbihmdW5jdGlvbiAobmV3UGRmTWFuYWdlcikgewogICAgICAgIGlmICh0ZXJtaW5hdGVkKSB7CiAgICAgICAgICBuZXdQZGZNYW5hZ2VyLnRlcm1pbmF0ZShuZXcgX3V0aWwuQWJvcnRFeGNlcHRpb24oIldvcmtlciB3YXMgdGVybWluYXRlZC4iKSk7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIldvcmtlciB3YXMgdGVybWluYXRlZCIpOwogICAgICAgIH0KCiAgICAgICAgcGRmTWFuYWdlciA9IG5ld1BkZk1hbmFnZXI7CiAgICAgICAgcGRmTWFuYWdlci5vbkxvYWRlZFN0cmVhbSgpLnRoZW4oZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICAgICAgaGFuZGxlci5zZW5kKCJEYXRhTG9hZGVkIiwgewogICAgICAgICAgICBsZW5ndGg6IHN0cmVhbS5ieXRlcy5ieXRlTGVuZ3RoCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSkudGhlbihwZGZNYW5hZ2VyUmVhZHksIG9uRmFpbHVyZSk7CiAgICB9CgogICAgaGFuZGxlci5vbigiR2V0UGFnZSIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0UGFnZShkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmdldFBhZ2UoZGF0YS5wYWdlSW5kZXgpLnRoZW4oZnVuY3Rpb24gKHBhZ2UpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3BkZk1hbmFnZXIuZW5zdXJlKHBhZ2UsICJyb3RhdGUiKSwgcGRmTWFuYWdlci5lbnN1cmUocGFnZSwgInJlZiIpLCBwZGZNYW5hZ2VyLmVuc3VyZShwYWdlLCAidXNlclVuaXQiKSwgcGRmTWFuYWdlci5lbnN1cmUocGFnZSwgInZpZXciKV0pLnRoZW4oZnVuY3Rpb24gKF9yZWYzKSB7CiAgICAgICAgICB2YXIgX3JlZjQgPSBfc2xpY2VkVG9BcnJheShfcmVmMywgNCksCiAgICAgICAgICAgICAgcm90YXRlID0gX3JlZjRbMF0sCiAgICAgICAgICAgICAgcmVmID0gX3JlZjRbMV0sCiAgICAgICAgICAgICAgdXNlclVuaXQgPSBfcmVmNFsyXSwKICAgICAgICAgICAgICB2aWV3ID0gX3JlZjRbM107CgogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcm90YXRlOiByb3RhdGUsCiAgICAgICAgICAgIHJlZjogcmVmLAogICAgICAgICAgICB1c2VyVW5pdDogdXNlclVuaXQsCiAgICAgICAgICAgIHZpZXc6IHZpZXcKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlSW5kZXgiLCBmdW5jdGlvbiB3cGhTZXR1cEdldFBhZ2VJbmRleChkYXRhKSB7CiAgICAgIHZhciByZWYgPSBfcHJpbWl0aXZlcy5SZWYuZ2V0KGRhdGEucmVmLm51bSwgZGF0YS5yZWYuZ2VuKTsKCiAgICAgIHZhciBjYXRhbG9nID0gcGRmTWFuYWdlci5wZGZEb2N1bWVudC5jYXRhbG9nOwogICAgICByZXR1cm4gY2F0YWxvZy5nZXRQYWdlSW5kZXgocmVmKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RGVzdGluYXRpb25zIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXREZXN0aW5hdGlvbnMoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJkZXN0aW5hdGlvbnMiKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0RGVzdGluYXRpb24iLCBmdW5jdGlvbiB3cGhTZXR1cEdldERlc3RpbmF0aW9uKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygiZ2V0RGVzdGluYXRpb24iLCBbZGF0YS5pZF0pOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTGFiZWxzIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlTGFiZWxzKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygicGFnZUxhYmVscyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTGF5b3V0IiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRQYWdlTGF5b3V0KGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZW5zdXJlQ2F0YWxvZygicGFnZUxheW91dCIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRQYWdlTW9kZSIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0UGFnZU1vZGUoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJwYWdlTW9kZSIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRWaWV3ZXJQcmVmZXJlbmNlcyIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coInZpZXdlclByZWZlcmVuY2VzIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE9wZW5BY3Rpb24iLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJvcGVuQWN0aW9uIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldEF0dGFjaG1lbnRzIiwgZnVuY3Rpb24gd3BoU2V0dXBHZXRBdHRhY2htZW50cyhkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmVuc3VyZUNhdGFsb2coImF0dGFjaG1lbnRzIik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldEphdmFTY3JpcHQiLCBmdW5jdGlvbiB3cGhTZXR1cEdldEphdmFTY3JpcHQoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJqYXZhU2NyaXB0Iik7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE91dGxpbmUiLCBmdW5jdGlvbiB3cGhTZXR1cEdldE91dGxpbmUoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJkb2N1bWVudE91dGxpbmUiKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0UGVybWlzc2lvbnMiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJwZXJtaXNzaW9ucyIpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJHZXRNZXRhZGF0YSIsIGZ1bmN0aW9uIHdwaFNldHVwR2V0TWV0YWRhdGEoZGF0YSkgewogICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3BkZk1hbmFnZXIuZW5zdXJlRG9jKCJkb2N1bWVudEluZm8iKSwgcGRmTWFuYWdlci5lbnN1cmVDYXRhbG9nKCJtZXRhZGF0YSIpXSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldERhdGEiLCBmdW5jdGlvbiB3cGhTZXR1cEdldERhdGEoZGF0YSkgewogICAgICBwZGZNYW5hZ2VyLnJlcXVlc3RMb2FkZWRTdHJlYW0oKTsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIub25Mb2FkZWRTdHJlYW0oKS50aGVuKGZ1bmN0aW9uIChzdHJlYW0pIHsKICAgICAgICByZXR1cm4gc3RyZWFtLmJ5dGVzOwogICAgICB9KTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0U3RhdHMiLCBmdW5jdGlvbiB3cGhTZXR1cEdldFN0YXRzKGRhdGEpIHsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIucGRmRG9jdW1lbnQueHJlZi5zdGF0czsKICAgIH0pOwogICAgaGFuZGxlci5vbigiR2V0QW5ub3RhdGlvbnMiLCBmdW5jdGlvbiAoX3JlZjUpIHsKICAgICAgdmFyIHBhZ2VJbmRleCA9IF9yZWY1LnBhZ2VJbmRleCwKICAgICAgICAgIGludGVudCA9IF9yZWY1LmludGVudDsKICAgICAgcmV0dXJuIHBkZk1hbmFnZXIuZ2V0UGFnZShwYWdlSW5kZXgpLnRoZW4oZnVuY3Rpb24gKHBhZ2UpIHsKICAgICAgICByZXR1cm4gcGFnZS5nZXRBbm5vdGF0aW9uc0RhdGEoaW50ZW50KTsKICAgICAgfSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkdldE9wZXJhdG9yTGlzdCIsIGZ1bmN0aW9uIHdwaFNldHVwUmVuZGVyUGFnZShkYXRhLCBzaW5rKSB7CiAgICAgIHZhciBwYWdlSW5kZXggPSBkYXRhLnBhZ2VJbmRleDsKICAgICAgcGRmTWFuYWdlci5nZXRQYWdlKHBhZ2VJbmRleCkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgIHZhciB0YXNrID0gbmV3IFdvcmtlclRhc2soIkdldE9wZXJhdG9yTGlzdDogcGFnZSAiLmNvbmNhdChwYWdlSW5kZXgpKTsKICAgICAgICBzdGFydFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgdmFyIHN0YXJ0ID0gdmVyYm9zaXR5ID49IF91dGlsLlZlcmJvc2l0eUxldmVsLklORk9TID8gRGF0ZS5ub3coKSA6IDA7CiAgICAgICAgcGFnZS5nZXRPcGVyYXRvckxpc3QoewogICAgICAgICAgaGFuZGxlcjogaGFuZGxlciwKICAgICAgICAgIHNpbms6IHNpbmssCiAgICAgICAgICB0YXNrOiB0YXNrLAogICAgICAgICAgaW50ZW50OiBkYXRhLmludGVudCwKICAgICAgICAgIHJlbmRlckludGVyYWN0aXZlRm9ybXM6IGRhdGEucmVuZGVySW50ZXJhY3RpdmVGb3JtcwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKG9wZXJhdG9yTGlzdEluZm8pIHsKICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CgogICAgICAgICAgaWYgKHN0YXJ0KSB7CiAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgicGFnZT0iLmNvbmNhdChwYWdlSW5kZXggKyAxLCAiIC0gZ2V0T3BlcmF0b3JMaXN0OiB0aW1lPSIpICsgIiIuY29uY2F0KERhdGUubm93KCkgLSBzdGFydCwgIm1zLCBsZW49IikuY29uY2F0KG9wZXJhdG9yTGlzdEluZm8ubGVuZ3RoKSk7CiAgICAgICAgICB9CgogICAgICAgICAgc2luay5jbG9zZSgpOwogICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgIGZpbmlzaFdvcmtlclRhc2sodGFzayk7CgogICAgICAgICAgaWYgKHRhc2sudGVybWluYXRlZCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JPcGVyYXRvckxpc3QKICAgICAgICAgIH0pOwogICAgICAgICAgc2luay5lcnJvcihyZWFzb24pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sIHRoaXMpOwogICAgaGFuZGxlci5vbigiR2V0VGV4dENvbnRlbnQiLCBmdW5jdGlvbiB3cGhFeHRyYWN0VGV4dChkYXRhLCBzaW5rKSB7CiAgICAgIHZhciBwYWdlSW5kZXggPSBkYXRhLnBhZ2VJbmRleDsKCiAgICAgIHNpbmsub25QdWxsID0gZnVuY3Rpb24gKGRlc2lyZWRTaXplKSB7fTsKCiAgICAgIHNpbmsub25DYW5jZWwgPSBmdW5jdGlvbiAocmVhc29uKSB7fTsKCiAgICAgIHBkZk1hbmFnZXIuZ2V0UGFnZShwYWdlSW5kZXgpLnRoZW4oZnVuY3Rpb24gKHBhZ2UpIHsKICAgICAgICB2YXIgdGFzayA9IG5ldyBXb3JrZXJUYXNrKCJHZXRUZXh0Q29udGVudDogcGFnZSAiICsgcGFnZUluZGV4KTsKICAgICAgICBzdGFydFdvcmtlclRhc2sodGFzayk7CiAgICAgICAgdmFyIHN0YXJ0ID0gdmVyYm9zaXR5ID49IF91dGlsLlZlcmJvc2l0eUxldmVsLklORk9TID8gRGF0ZS5ub3coKSA6IDA7CiAgICAgICAgcGFnZS5leHRyYWN0VGV4dENvbnRlbnQoewogICAgICAgICAgaGFuZGxlcjogaGFuZGxlciwKICAgICAgICAgIHRhc2s6IHRhc2ssCiAgICAgICAgICBzaW5rOiBzaW5rLAogICAgICAgICAgbm9ybWFsaXplV2hpdGVzcGFjZTogZGF0YS5ub3JtYWxpemVXaGl0ZXNwYWNlLAogICAgICAgICAgY29tYmluZVRleHRJdGVtczogZGF0YS5jb21iaW5lVGV4dEl0ZW1zCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwoKICAgICAgICAgIGlmIChzdGFydCkgewogICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoInBhZ2U9Ii5jb25jYXQocGFnZUluZGV4ICsgMSwgIiAtIGdldFRleHRDb250ZW50OiB0aW1lPSIpICsgIiIuY29uY2F0KERhdGUubm93KCkgLSBzdGFydCwgIm1zIikpOwogICAgICAgICAgfQoKICAgICAgICAgIHNpbmsuY2xvc2UoKTsKICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICBmaW5pc2hXb3JrZXJUYXNrKHRhc2spOwoKICAgICAgICAgIGlmICh0YXNrLnRlcm1pbmF0ZWQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNpbmsuZXJyb3IocmVhc29uKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIkZvbnRGYWxsYmFjayIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBwZGZNYW5hZ2VyLmZvbnRGYWxsYmFjayhkYXRhLmlkLCBoYW5kbGVyKTsKICAgIH0pOwogICAgaGFuZGxlci5vbigiQ2xlYW51cCIsIGZ1bmN0aW9uIHdwaENsZWFudXAoZGF0YSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5jbGVhbnVwKHRydWUpOwogICAgfSk7CiAgICBoYW5kbGVyLm9uKCJUZXJtaW5hdGUiLCBmdW5jdGlvbiB3cGhUZXJtaW5hdGUoZGF0YSkgewogICAgICB0ZXJtaW5hdGVkID0gdHJ1ZTsKICAgICAgdmFyIHdhaXRPbiA9IFtdOwoKICAgICAgaWYgKHBkZk1hbmFnZXIpIHsKICAgICAgICBwZGZNYW5hZ2VyLnRlcm1pbmF0ZShuZXcgX3V0aWwuQWJvcnRFeGNlcHRpb24oIldvcmtlciB3YXMgdGVybWluYXRlZC4iKSk7CiAgICAgICAgdmFyIGNsZWFudXBQcm9taXNlID0gcGRmTWFuYWdlci5jbGVhbnVwKCk7CiAgICAgICAgd2FpdE9uLnB1c2goY2xlYW51cFByb21pc2UpOwogICAgICAgIHBkZk1hbmFnZXIgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgICgwLCBfcHJpbWl0aXZlcy5jbGVhclByaW1pdGl2ZUNhY2hlcykoKTsKICAgICAgfQoKICAgICAgaWYgKGNhbmNlbFhIUnMpIHsKICAgICAgICBjYW5jZWxYSFJzKG5ldyBfdXRpbC5BYm9ydEV4Y2VwdGlvbigiV29ya2VyIHdhcyB0ZXJtaW5hdGVkLiIpKTsKICAgICAgfQoKICAgICAgV29ya2VyVGFza3MuZm9yRWFjaChmdW5jdGlvbiAodGFzaykgewogICAgICAgIHdhaXRPbi5wdXNoKHRhc2suZmluaXNoZWQpOwogICAgICAgIHRhc2sudGVybWluYXRlKCk7CiAgICAgIH0pOwogICAgICByZXR1cm4gUHJvbWlzZS5hbGwod2FpdE9uKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBoYW5kbGVyLmRlc3Ryb3koKTsKICAgICAgICBoYW5kbGVyID0gbnVsbDsKICAgICAgfSk7CiAgICB9KTsKICAgIGhhbmRsZXIub24oIlJlYWR5IiwgZnVuY3Rpb24gd3BoUmVhZHkoZGF0YSkgewogICAgICBzZXR1cERvYyhkb2NQYXJhbXMpOwogICAgICBkb2NQYXJhbXMgPSBudWxsOwogICAgfSk7CiAgICByZXR1cm4gd29ya2VySGFuZGxlck5hbWU7CiAgfSwKICBpbml0aWFsaXplRnJvbVBvcnQ6IGZ1bmN0aW9uIGluaXRpYWxpemVGcm9tUG9ydChwb3J0KSB7CiAgICB2YXIgaGFuZGxlciA9IG5ldyBfbWVzc2FnZV9oYW5kbGVyLk1lc3NhZ2VIYW5kbGVyKCJ3b3JrZXIiLCAibWFpbiIsIHBvcnQpOwogICAgV29ya2VyTWVzc2FnZUhhbmRsZXIuc2V0dXAoaGFuZGxlciwgcG9ydCk7CiAgICBoYW5kbGVyLnNlbmQoInJlYWR5IiwgbnVsbCk7CiAgfQp9OwpleHBvcnRzLldvcmtlck1lc3NhZ2VIYW5kbGVyID0gV29ya2VyTWVzc2FnZUhhbmRsZXI7CgpmdW5jdGlvbiBpc01lc3NhZ2VQb3J0KG1heWJlUG9ydCkgewogIHJldHVybiB0eXBlb2YgbWF5YmVQb3J0LnBvc3RNZXNzYWdlID09PSAiZnVuY3Rpb24iICYmICJvbm1lc3NhZ2UiIGluIG1heWJlUG9ydDsKfQoKaWYgKHR5cGVvZiB3aW5kb3cgPT09ICJ1bmRlZmluZWQiICYmICFfaXNfbm9kZS5pc05vZGVKUyAmJiB0eXBlb2Ygc2VsZiAhPT0gInVuZGVmaW5lZCIgJiYgaXNNZXNzYWdlUG9ydChzZWxmKSkgewogIFdvcmtlck1lc3NhZ2VIYW5kbGVyLmluaXRpYWxpemVGcm9tUG9ydChzZWxmKTsKfQoKLyoqKi8gfSksCi8qIDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCm1vZHVsZS5leHBvcnRzID0gX193X3BkZmpzX3JlcXVpcmVfXygzKTsKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKG1vZHVsZSkgewoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9Cgp2YXIgcnVudGltZSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgInVzZSBzdHJpY3QiOwoKICB2YXIgT3AgPSBPYmplY3QucHJvdG90eXBlOwogIHZhciBoYXNPd24gPSBPcC5oYXNPd25Qcm9wZXJ0eTsKICB2YXIgdW5kZWZpbmVkOwogIHZhciAkU3ltYm9sID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiA/IFN5bWJvbCA6IHt9OwogIHZhciBpdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuaXRlcmF0b3IgfHwgIkBAaXRlcmF0b3IiOwogIHZhciBhc3luY0l0ZXJhdG9yU3ltYm9sID0gJFN5bWJvbC5hc3luY0l0ZXJhdG9yIHx8ICJAQGFzeW5jSXRlcmF0b3IiOwogIHZhciB0b1N0cmluZ1RhZ1N5bWJvbCA9ICRTeW1ib2wudG9TdHJpbmdUYWcgfHwgIkBAdG9TdHJpbmdUYWciOwoKICBmdW5jdGlvbiB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7CiAgICB2YXIgcHJvdG9HZW5lcmF0b3IgPSBvdXRlckZuICYmIG91dGVyRm4ucHJvdG90eXBlIGluc3RhbmNlb2YgR2VuZXJhdG9yID8gb3V0ZXJGbiA6IEdlbmVyYXRvcjsKICAgIHZhciBnZW5lcmF0b3IgPSBPYmplY3QuY3JlYXRlKHByb3RvR2VuZXJhdG9yLnByb3RvdHlwZSk7CiAgICB2YXIgY29udGV4dCA9IG5ldyBDb250ZXh0KHRyeUxvY3NMaXN0IHx8IFtdKTsKICAgIGdlbmVyYXRvci5faW52b2tlID0gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTsKICAgIHJldHVybiBnZW5lcmF0b3I7CiAgfQoKICBleHBvcnRzLndyYXAgPSB3cmFwOwoKICBmdW5jdGlvbiB0cnlDYXRjaChmbiwgb2JqLCBhcmcpIHsKICAgIHRyeSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdHlwZTogIm5vcm1hbCIsCiAgICAgICAgYXJnOiBmbi5jYWxsKG9iaiwgYXJnKQogICAgICB9OwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdHlwZTogInRocm93IiwKICAgICAgICBhcmc6IGVycgogICAgICB9OwogICAgfQogIH0KCiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkU3RhcnQgPSAic3VzcGVuZGVkU3RhcnQiOwogIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkID0gInN1c3BlbmRlZFlpZWxkIjsKICB2YXIgR2VuU3RhdGVFeGVjdXRpbmcgPSAiZXhlY3V0aW5nIjsKICB2YXIgR2VuU3RhdGVDb21wbGV0ZWQgPSAiY29tcGxldGVkIjsKICB2YXIgQ29udGludWVTZW50aW5lbCA9IHt9OwoKICBmdW5jdGlvbiBHZW5lcmF0b3IoKSB7fQoKICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvbigpIHt9CgogIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKCkge30KCiAgdmFyIEl0ZXJhdG9yUHJvdG90eXBlID0ge307CgogIEl0ZXJhdG9yUHJvdG90eXBlW2l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzOwogIH07CgogIHZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjsKICB2YXIgTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90byAmJiBnZXRQcm90byhnZXRQcm90byh2YWx1ZXMoW10pKSk7CgogIGlmIChOYXRpdmVJdGVyYXRvclByb3RvdHlwZSAmJiBOYXRpdmVJdGVyYXRvclByb3RvdHlwZSAhPT0gT3AgJiYgaGFzT3duLmNhbGwoTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUsIGl0ZXJhdG9yU3ltYm9sKSkgewogICAgSXRlcmF0b3JQcm90b3R5cGUgPSBOYXRpdmVJdGVyYXRvclByb3RvdHlwZTsKICB9CgogIHZhciBHcCA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9IEdlbmVyYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlKTsKICBHZW5lcmF0b3JGdW5jdGlvbi5wcm90b3R5cGUgPSBHcC5jb25zdHJ1Y3RvciA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlOwogIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb247CiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGVbdG9TdHJpbmdUYWdTeW1ib2xdID0gR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSAiR2VuZXJhdG9yRnVuY3Rpb24iOwoKICBmdW5jdGlvbiBkZWZpbmVJdGVyYXRvck1ldGhvZHMocHJvdG90eXBlKSB7CiAgICBbIm5leHQiLCAidGhyb3ciLCAicmV0dXJuIl0uZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7CiAgICAgIHByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24gKGFyZykgewogICAgICAgIHJldHVybiB0aGlzLl9pbnZva2UobWV0aG9kLCBhcmcpOwogICAgICB9OwogICAgfSk7CiAgfQoKICBleHBvcnRzLmlzR2VuZXJhdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiAoZ2VuRnVuKSB7CiAgICB2YXIgY3RvciA9IHR5cGVvZiBnZW5GdW4gPT09ICJmdW5jdGlvbiIgJiYgZ2VuRnVuLmNvbnN0cnVjdG9yOwogICAgcmV0dXJuIGN0b3IgPyBjdG9yID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fCAoY3Rvci5kaXNwbGF5TmFtZSB8fCBjdG9yLm5hbWUpID09PSAiR2VuZXJhdG9yRnVuY3Rpb24iIDogZmFsc2U7CiAgfTsKCiAgZXhwb3J0cy5tYXJrID0gZnVuY3Rpb24gKGdlbkZ1bikgewogICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikgewogICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoZ2VuRnVuLCBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSk7CiAgICB9IGVsc2UgewogICAgICBnZW5GdW4uX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7CgogICAgICBpZiAoISh0b1N0cmluZ1RhZ1N5bWJvbCBpbiBnZW5GdW4pKSB7CiAgICAgICAgZ2VuRnVuW3RvU3RyaW5nVGFnU3ltYm9sXSA9ICJHZW5lcmF0b3JGdW5jdGlvbiI7CiAgICAgIH0KICAgIH0KCiAgICBnZW5GdW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHcCk7CiAgICByZXR1cm4gZ2VuRnVuOwogIH07CgogIGV4cG9ydHMuYXdyYXAgPSBmdW5jdGlvbiAoYXJnKSB7CiAgICByZXR1cm4gewogICAgICBfX2F3YWl0OiBhcmcKICAgIH07CiAgfTsKCiAgZnVuY3Rpb24gQXN5bmNJdGVyYXRvcihnZW5lcmF0b3IsIFByb21pc2VJbXBsKSB7CiAgICBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCkgewogICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goZ2VuZXJhdG9yW21ldGhvZF0sIGdlbmVyYXRvciwgYXJnKTsKCiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gInRocm93IikgewogICAgICAgIHJlamVjdChyZWNvcmQuYXJnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcmVzdWx0ID0gcmVjb3JkLmFyZzsKICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7CgogICAgICAgIGlmICh2YWx1ZSAmJiBfdHlwZW9mKHZhbHVlKSA9PT0gIm9iamVjdCIgJiYgaGFzT3duLmNhbGwodmFsdWUsICJfX2F3YWl0IikpIHsKICAgICAgICAgIHJldHVybiBQcm9taXNlSW1wbC5yZXNvbHZlKHZhbHVlLl9fYXdhaXQpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgIGludm9rZSgibmV4dCIsIHZhbHVlLCByZXNvbHZlLCByZWplY3QpOwogICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICBpbnZva2UoInRocm93IiwgZXJyLCByZXNvbHZlLCByZWplY3QpOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gUHJvbWlzZUltcGwucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbiAodW53cmFwcGVkKSB7CiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQ7CiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICByZXR1cm4gaW52b2tlKCJ0aHJvdyIsIGVycm9yLCByZXNvbHZlLCByZWplY3QpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgdmFyIHByZXZpb3VzUHJvbWlzZTsKCiAgICBmdW5jdGlvbiBlbnF1ZXVlKG1ldGhvZCwgYXJnKSB7CiAgICAgIGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZUltcGwoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gcHJldmlvdXNQcm9taXNlID0gcHJldmlvdXNQcm9taXNlID8gcHJldmlvdXNQcm9taXNlLnRoZW4oY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7CiAgICB9CgogICAgdGhpcy5faW52b2tlID0gZW5xdWV1ZTsKICB9CgogIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhBc3luY0l0ZXJhdG9yLnByb3RvdHlwZSk7CgogIEFzeW5jSXRlcmF0b3IucHJvdG90eXBlW2FzeW5jSXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgZXhwb3J0cy5Bc3luY0l0ZXJhdG9yID0gQXN5bmNJdGVyYXRvcjsKCiAgZXhwb3J0cy5hc3luYyA9IGZ1bmN0aW9uIChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCwgUHJvbWlzZUltcGwpIHsKICAgIGlmIChQcm9taXNlSW1wbCA9PT0gdm9pZCAwKSBQcm9taXNlSW1wbCA9IFByb21pc2U7CiAgICB2YXIgaXRlciA9IG5ldyBBc3luY0l0ZXJhdG9yKHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpLCBQcm9taXNlSW1wbCk7CiAgICByZXR1cm4gZXhwb3J0cy5pc0dlbmVyYXRvckZ1bmN0aW9uKG91dGVyRm4pID8gaXRlciA6IGl0ZXIubmV4dCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICByZXR1cm4gcmVzdWx0LmRvbmUgPyByZXN1bHQudmFsdWUgOiBpdGVyLm5leHQoKTsKICAgIH0pOwogIH07CgogIGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCkgewogICAgdmFyIHN0YXRlID0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydDsKICAgIHJldHVybiBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcpIHsKICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUV4ZWN1dGluZykgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgcnVubmluZyIpOwogICAgICB9CgogICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlQ29tcGxldGVkKSB7CiAgICAgICAgaWYgKG1ldGhvZCA9PT0gInRocm93IikgewogICAgICAgICAgdGhyb3cgYXJnOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGRvbmVSZXN1bHQoKTsKICAgICAgfQoKICAgICAgY29udGV4dC5tZXRob2QgPSBtZXRob2Q7CiAgICAgIGNvbnRleHQuYXJnID0gYXJnOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICB2YXIgZGVsZWdhdGUgPSBjb250ZXh0LmRlbGVnYXRlOwoKICAgICAgICBpZiAoZGVsZWdhdGUpIHsKICAgICAgICAgIHZhciBkZWxlZ2F0ZVJlc3VsdCA9IG1heWJlSW52b2tlRGVsZWdhdGUoZGVsZWdhdGUsIGNvbnRleHQpOwoKICAgICAgICAgIGlmIChkZWxlZ2F0ZVJlc3VsdCkgewogICAgICAgICAgICBpZiAoZGVsZWdhdGVSZXN1bHQgPT09IENvbnRpbnVlU2VudGluZWwpIGNvbnRpbnVlOwogICAgICAgICAgICByZXR1cm4gZGVsZWdhdGVSZXN1bHQ7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09ICJuZXh0IikgewogICAgICAgICAgY29udGV4dC5zZW50ID0gY29udGV4dC5fc2VudCA9IGNvbnRleHQuYXJnOwogICAgICAgIH0gZWxzZSBpZiAoY29udGV4dC5tZXRob2QgPT09ICJ0aHJvdyIpIHsKICAgICAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydCkgewogICAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlQ29tcGxldGVkOwogICAgICAgICAgICB0aHJvdyBjb250ZXh0LmFyZzsKICAgICAgICAgIH0KCiAgICAgICAgICBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGNvbnRleHQuYXJnKTsKICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubWV0aG9kID09PSAicmV0dXJuIikgewogICAgICAgICAgY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGNvbnRleHQuYXJnKTsKICAgICAgICB9CgogICAgICAgIHN0YXRlID0gR2VuU3RhdGVFeGVjdXRpbmc7CiAgICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpOwoKICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09ICJub3JtYWwiKSB7CiAgICAgICAgICBzdGF0ZSA9IGNvbnRleHQuZG9uZSA/IEdlblN0YXRlQ29tcGxldGVkIDogR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDsKCiAgICAgICAgICBpZiAocmVjb3JkLmFyZyA9PT0gQ29udGludWVTZW50aW5lbCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB2YWx1ZTogcmVjb3JkLmFyZywKICAgICAgICAgICAgZG9uZTogY29udGV4dC5kb25lCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09ICJ0aHJvdyIpIHsKICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7CiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9ICJ0aHJvdyI7CiAgICAgICAgICBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmc7CiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCkgewogICAgdmFyIG1ldGhvZCA9IGRlbGVnYXRlLml0ZXJhdG9yW2NvbnRleHQubWV0aG9kXTsKCiAgICBpZiAobWV0aG9kID09PSB1bmRlZmluZWQpIHsKICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7CgogICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09ICJ0aHJvdyIpIHsKICAgICAgICBpZiAoZGVsZWdhdGUuaXRlcmF0b3JbInJldHVybiJdKSB7CiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9ICJyZXR1cm4iOwogICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7CiAgICAgICAgICBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KTsKCiAgICAgICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09ICJ0aHJvdyIpIHsKICAgICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb250ZXh0Lm1ldGhvZCA9ICJ0aHJvdyI7CiAgICAgICAgY29udGV4dC5hcmcgPSBuZXcgVHlwZUVycm9yKCJUaGUgaXRlcmF0b3IgZG9lcyBub3QgcHJvdmlkZSBhICd0aHJvdycgbWV0aG9kIik7CiAgICAgIH0KCiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsOwogICAgfQoKICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChtZXRob2QsIGRlbGVnYXRlLml0ZXJhdG9yLCBjb250ZXh0LmFyZyk7CgogICAgaWYgKHJlY29yZC50eXBlID09PSAidGhyb3ciKSB7CiAgICAgIGNvbnRleHQubWV0aG9kID0gInRocm93IjsKICAgICAgY29udGV4dC5hcmcgPSByZWNvcmQuYXJnOwogICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDsKICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7CiAgICB9CgogICAgdmFyIGluZm8gPSByZWNvcmQuYXJnOwoKICAgIGlmICghaW5mbykgewogICAgICBjb250ZXh0Lm1ldGhvZCA9ICJ0aHJvdyI7CiAgICAgIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcigiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3QiKTsKICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7CiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsOwogICAgfQoKICAgIGlmIChpbmZvLmRvbmUpIHsKICAgICAgY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWU7CiAgICAgIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2M7CgogICAgICBpZiAoY29udGV4dC5tZXRob2QgIT09ICJyZXR1cm4iKSB7CiAgICAgICAgY29udGV4dC5tZXRob2QgPSAibmV4dCI7CiAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBpbmZvOwogICAgfQoKICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsOwogICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7CiAgfQoKICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoR3ApOwogIEdwW3RvU3RyaW5nVGFnU3ltYm9sXSA9ICJHZW5lcmF0b3IiOwoKICBHcFtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICBHcC50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAiW29iamVjdCBHZW5lcmF0b3JdIjsKICB9OwoKICBmdW5jdGlvbiBwdXNoVHJ5RW50cnkobG9jcykgewogICAgdmFyIGVudHJ5ID0gewogICAgICB0cnlMb2M6IGxvY3NbMF0KICAgIH07CgogICAgaWYgKDEgaW4gbG9jcykgewogICAgICBlbnRyeS5jYXRjaExvYyA9IGxvY3NbMV07CiAgICB9CgogICAgaWYgKDIgaW4gbG9jcykgewogICAgICBlbnRyeS5maW5hbGx5TG9jID0gbG9jc1syXTsKICAgICAgZW50cnkuYWZ0ZXJMb2MgPSBsb2NzWzNdOwogICAgfQoKICAgIHRoaXMudHJ5RW50cmllcy5wdXNoKGVudHJ5KTsKICB9CgogIGZ1bmN0aW9uIHJlc2V0VHJ5RW50cnkoZW50cnkpIHsKICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uIHx8IHt9OwogICAgcmVjb3JkLnR5cGUgPSAibm9ybWFsIjsKICAgIGRlbGV0ZSByZWNvcmQuYXJnOwogICAgZW50cnkuY29tcGxldGlvbiA9IHJlY29yZDsKICB9CgogIGZ1bmN0aW9uIENvbnRleHQodHJ5TG9jc0xpc3QpIHsKICAgIHRoaXMudHJ5RW50cmllcyA9IFt7CiAgICAgIHRyeUxvYzogInJvb3QiCiAgICB9XTsKICAgIHRyeUxvY3NMaXN0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKTsKICAgIHRoaXMucmVzZXQodHJ1ZSk7CiAgfQoKICBleHBvcnRzLmtleXMgPSBmdW5jdGlvbiAob2JqZWN0KSB7CiAgICB2YXIga2V5cyA9IFtdOwoKICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHsKICAgICAga2V5cy5wdXNoKGtleSk7CiAgICB9CgogICAga2V5cy5yZXZlcnNlKCk7CiAgICByZXR1cm4gZnVuY3Rpb24gbmV4dCgpIHsKICAgICAgd2hpbGUgKGtleXMubGVuZ3RoKSB7CiAgICAgICAgdmFyIGtleSA9IGtleXMucG9wKCk7CgogICAgICAgIGlmIChrZXkgaW4gb2JqZWN0KSB7CiAgICAgICAgICBuZXh0LnZhbHVlID0ga2V5OwogICAgICAgICAgbmV4dC5kb25lID0gZmFsc2U7CiAgICAgICAgICByZXR1cm4gbmV4dDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG5leHQuZG9uZSA9IHRydWU7CiAgICAgIHJldHVybiBuZXh0OwogICAgfTsKICB9OwoKICBmdW5jdGlvbiB2YWx1ZXMoaXRlcmFibGUpIHsKICAgIGlmIChpdGVyYWJsZSkgewogICAgICB2YXIgaXRlcmF0b3JNZXRob2QgPSBpdGVyYWJsZVtpdGVyYXRvclN5bWJvbF07CgogICAgICBpZiAoaXRlcmF0b3JNZXRob2QpIHsKICAgICAgICByZXR1cm4gaXRlcmF0b3JNZXRob2QuY2FsbChpdGVyYWJsZSk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgaXRlcmFibGUubmV4dCA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIHJldHVybiBpdGVyYWJsZTsKICAgICAgfQoKICAgICAgaWYgKCFpc05hTihpdGVyYWJsZS5sZW5ndGgpKSB7CiAgICAgICAgdmFyIGkgPSAtMSwKICAgICAgICAgICAgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7CiAgICAgICAgICB3aGlsZSAoKytpIDwgaXRlcmFibGUubGVuZ3RoKSB7CiAgICAgICAgICAgIGlmIChoYXNPd24uY2FsbChpdGVyYWJsZSwgaSkpIHsKICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07CiAgICAgICAgICAgICAgbmV4dC5kb25lID0gZmFsc2U7CiAgICAgICAgICAgICAgcmV0dXJuIG5leHQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkOwogICAgICAgICAgbmV4dC5kb25lID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiBuZXh0OwogICAgICAgIH07CgogICAgICAgIHJldHVybiBuZXh0Lm5leHQgPSBuZXh0OwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgbmV4dDogZG9uZVJlc3VsdAogICAgfTsKICB9CgogIGV4cG9ydHMudmFsdWVzID0gdmFsdWVzOwoKICBmdW5jdGlvbiBkb25lUmVzdWx0KCkgewogICAgcmV0dXJuIHsKICAgICAgdmFsdWU6IHVuZGVmaW5lZCwKICAgICAgZG9uZTogdHJ1ZQogICAgfTsKICB9CgogIENvbnRleHQucHJvdG90eXBlID0gewogICAgY29uc3RydWN0b3I6IENvbnRleHQsCiAgICByZXNldDogZnVuY3Rpb24gcmVzZXQoc2tpcFRlbXBSZXNldCkgewogICAgICB0aGlzLnByZXYgPSAwOwogICAgICB0aGlzLm5leHQgPSAwOwogICAgICB0aGlzLnNlbnQgPSB0aGlzLl9zZW50ID0gdW5kZWZpbmVkOwogICAgICB0aGlzLmRvbmUgPSBmYWxzZTsKICAgICAgdGhpcy5kZWxlZ2F0ZSA9IG51bGw7CiAgICAgIHRoaXMubWV0aG9kID0gIm5leHQiOwogICAgICB0aGlzLmFyZyA9IHVuZGVmaW5lZDsKICAgICAgdGhpcy50cnlFbnRyaWVzLmZvckVhY2gocmVzZXRUcnlFbnRyeSk7CgogICAgICBpZiAoIXNraXBUZW1wUmVzZXQpIHsKICAgICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMpIHsKICAgICAgICAgIGlmIChuYW1lLmNoYXJBdCgwKSA9PT0gInQiICYmIGhhc093bi5jYWxsKHRoaXMsIG5hbWUpICYmICFpc05hTigrbmFtZS5zbGljZSgxKSkpIHsKICAgICAgICAgICAgdGhpc1tuYW1lXSA9IHVuZGVmaW5lZDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzdG9wOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICB0aGlzLmRvbmUgPSB0cnVlOwogICAgICB2YXIgcm9vdEVudHJ5ID0gdGhpcy50cnlFbnRyaWVzWzBdOwogICAgICB2YXIgcm9vdFJlY29yZCA9IHJvb3RFbnRyeS5jb21wbGV0aW9uOwoKICAgICAgaWYgKHJvb3RSZWNvcmQudHlwZSA9PT0gInRocm93IikgewogICAgICAgIHRocm93IHJvb3RSZWNvcmQuYXJnOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5ydmFsOwogICAgfSwKICAgIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbiBkaXNwYXRjaEV4Y2VwdGlvbihleGNlcHRpb24pIHsKICAgICAgaWYgKHRoaXMuZG9uZSkgewogICAgICAgIHRocm93IGV4Y2VwdGlvbjsKICAgICAgfQoKICAgICAgdmFyIGNvbnRleHQgPSB0aGlzOwoKICAgICAgZnVuY3Rpb24gaGFuZGxlKGxvYywgY2F1Z2h0KSB7CiAgICAgICAgcmVjb3JkLnR5cGUgPSAidGhyb3ciOwogICAgICAgIHJlY29yZC5hcmcgPSBleGNlcHRpb247CiAgICAgICAgY29udGV4dC5uZXh0ID0gbG9jOwoKICAgICAgICBpZiAoY2F1Z2h0KSB7CiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9ICJuZXh0IjsKICAgICAgICAgIGNvbnRleHQuYXJnID0gdW5kZWZpbmVkOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICEhY2F1Z2h0OwogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7CiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldOwogICAgICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uOwoKICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSAicm9vdCIpIHsKICAgICAgICAgIHJldHVybiBoYW5kbGUoImVuZCIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYpIHsKICAgICAgICAgIHZhciBoYXNDYXRjaCA9IGhhc093bi5jYWxsKGVudHJ5LCAiY2F0Y2hMb2MiKTsKICAgICAgICAgIHZhciBoYXNGaW5hbGx5ID0gaGFzT3duLmNhbGwoZW50cnksICJmaW5hbGx5TG9jIik7CgogICAgICAgICAgaWYgKGhhc0NhdGNoICYmIGhhc0ZpbmFsbHkpIHsKICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykgewogICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2F0Y2gpIHsKICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAoaGFzRmluYWxseSkgewogICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykgewogICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHkiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhYnJ1cHQ6IGZ1bmN0aW9uIGFicnVwdCh0eXBlLCBhcmcpIHsKICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgewogICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTsKCiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYgJiYgaGFzT3duLmNhbGwoZW50cnksICJmaW5hbGx5TG9jIikgJiYgdGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykgewogICAgICAgICAgdmFyIGZpbmFsbHlFbnRyeSA9IGVudHJ5OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZmluYWxseUVudHJ5ICYmICh0eXBlID09PSAiYnJlYWsiIHx8IHR5cGUgPT09ICJjb250aW51ZSIpICYmIGZpbmFsbHlFbnRyeS50cnlMb2MgPD0gYXJnICYmIGFyZyA8PSBmaW5hbGx5RW50cnkuZmluYWxseUxvYykgewogICAgICAgIGZpbmFsbHlFbnRyeSA9IG51bGw7CiAgICAgIH0KCiAgICAgIHZhciByZWNvcmQgPSBmaW5hbGx5RW50cnkgPyBmaW5hbGx5RW50cnkuY29tcGxldGlvbiA6IHt9OwogICAgICByZWNvcmQudHlwZSA9IHR5cGU7CiAgICAgIHJlY29yZC5hcmcgPSBhcmc7CgogICAgICBpZiAoZmluYWxseUVudHJ5KSB7CiAgICAgICAgdGhpcy5tZXRob2QgPSAibmV4dCI7CiAgICAgICAgdGhpcy5uZXh0ID0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2M7CiAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmNvbXBsZXRlKHJlY29yZCk7CiAgICB9LAogICAgY29tcGxldGU6IGZ1bmN0aW9uIGNvbXBsZXRlKHJlY29yZCwgYWZ0ZXJMb2MpIHsKICAgICAgaWYgKHJlY29yZC50eXBlID09PSAidGhyb3ciKSB7CiAgICAgICAgdGhyb3cgcmVjb3JkLmFyZzsKICAgICAgfQoKICAgICAgaWYgKHJlY29yZC50eXBlID09PSAiYnJlYWsiIHx8IHJlY29yZC50eXBlID09PSAiY29udGludWUiKSB7CiAgICAgICAgdGhpcy5uZXh0ID0gcmVjb3JkLmFyZzsKICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gInJldHVybiIpIHsKICAgICAgICB0aGlzLnJ2YWwgPSB0aGlzLmFyZyA9IHJlY29yZC5hcmc7CiAgICAgICAgdGhpcy5tZXRob2QgPSAicmV0dXJuIjsKICAgICAgICB0aGlzLm5leHQgPSAiZW5kIjsKICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gIm5vcm1hbCIgJiYgYWZ0ZXJMb2MpIHsKICAgICAgICB0aGlzLm5leHQgPSBhZnRlckxvYzsKICAgICAgfQoKICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7CiAgICB9LAogICAgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2goZmluYWxseUxvYykgewogICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7CiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldOwoKICAgICAgICBpZiAoZW50cnkuZmluYWxseUxvYyA9PT0gZmluYWxseUxvYykgewogICAgICAgICAgdGhpcy5jb21wbGV0ZShlbnRyeS5jb21wbGV0aW9uLCBlbnRyeS5hZnRlckxvYyk7CiAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTsKICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaCh0cnlMb2MpIHsKICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgewogICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTsKCiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7CiAgICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjsKCiAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09ICJ0aHJvdyIpIHsKICAgICAgICAgICAgdmFyIHRocm93biA9IHJlY29yZC5hcmc7CiAgICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0aHJvd247CiAgICAgICAgfQogICAgICB9CgogICAgICB0aHJvdyBuZXcgRXJyb3IoImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdCIpOwogICAgfSwKICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uIGRlbGVnYXRlWWllbGQoaXRlcmFibGUsIHJlc3VsdE5hbWUsIG5leHRMb2MpIHsKICAgICAgdGhpcy5kZWxlZ2F0ZSA9IHsKICAgICAgICBpdGVyYXRvcjogdmFsdWVzKGl0ZXJhYmxlKSwKICAgICAgICByZXN1bHROYW1lOiByZXN1bHROYW1lLAogICAgICAgIG5leHRMb2M6IG5leHRMb2MKICAgICAgfTsKCiAgICAgIGlmICh0aGlzLm1ldGhvZCA9PT0gIm5leHQiKSB7CiAgICAgICAgdGhpcy5hcmcgPSB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsOwogICAgfQogIH07CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKCBmYWxzZSA/IHVuZGVmaW5lZCA6IF90eXBlb2YobW9kdWxlKSkgPT09ICJvYmplY3QiID8gbW9kdWxlLmV4cG9ydHMgOiB7fSk7Cgp0cnkgewogIHJlZ2VuZXJhdG9yUnVudGltZSA9IHJ1bnRpbWU7Cn0gY2F0Y2ggKGFjY2lkZW50YWxTdHJpY3RNb2RlKSB7CiAgRnVuY3Rpb24oInIiLCAicmVnZW5lcmF0b3JSdW50aW1lID0gciIpKHJ1bnRpbWUpOwp9Ci8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbCh0aGlzLCBfX3dfcGRmanNfcmVxdWlyZV9fKDQpKG1vZHVsZSkpKQoKLyoqKi8gfSksCi8qIDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG1vZHVsZSkgewogIGlmICghbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkgewogICAgbW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uICgpIHt9OwoKICAgIG1vZHVsZS5wYXRocyA9IFtdOwogICAgaWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgImxvYWRlZCIsIHsKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIG1vZHVsZS5sOwogICAgICB9CiAgICB9KTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsICJpZCIsIHsKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIG1vZHVsZS5pOwogICAgICB9CiAgICB9KTsKICAgIG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxOwogIH0KCiAgcmV0dXJuIG1vZHVsZTsKfTsKCi8qKiovIH0pLAovKiA1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuYXJyYXlCeXRlTGVuZ3RoID0gYXJyYXlCeXRlTGVuZ3RoOwpleHBvcnRzLmFycmF5c1RvQnl0ZXMgPSBhcnJheXNUb0J5dGVzOwpleHBvcnRzLmFzc2VydCA9IGFzc2VydDsKZXhwb3J0cy5ieXRlc1RvU3RyaW5nID0gYnl0ZXNUb1N0cmluZzsKZXhwb3J0cy5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSA9IGNyZWF0ZVByb21pc2VDYXBhYmlsaXR5OwpleHBvcnRzLmdldFZlcmJvc2l0eUxldmVsID0gZ2V0VmVyYm9zaXR5TGV2ZWw7CmV4cG9ydHMuaW5mbyA9IGluZm87CmV4cG9ydHMuaXNBcnJheUJ1ZmZlciA9IGlzQXJyYXlCdWZmZXI7CmV4cG9ydHMuaXNBcnJheUVxdWFsID0gaXNBcnJheUVxdWFsOwpleHBvcnRzLmlzQm9vbCA9IGlzQm9vbDsKZXhwb3J0cy5pc0VtcHR5T2JqID0gaXNFbXB0eU9iajsKZXhwb3J0cy5pc051bSA9IGlzTnVtOwpleHBvcnRzLmlzU3RyaW5nID0gaXNTdHJpbmc7CmV4cG9ydHMuaXNTYW1lT3JpZ2luID0gaXNTYW1lT3JpZ2luOwpleHBvcnRzLmNyZWF0ZVZhbGlkQWJzb2x1dGVVcmwgPSBjcmVhdGVWYWxpZEFic29sdXRlVXJsOwpleHBvcnRzLnJlbW92ZU51bGxDaGFyYWN0ZXJzID0gcmVtb3ZlTnVsbENoYXJhY3RlcnM7CmV4cG9ydHMuc2V0VmVyYm9zaXR5TGV2ZWwgPSBzZXRWZXJib3NpdHlMZXZlbDsKZXhwb3J0cy5zaGFkb3cgPSBzaGFkb3c7CmV4cG9ydHMuc3RyaW5nMzIgPSBzdHJpbmczMjsKZXhwb3J0cy5zdHJpbmdUb0J5dGVzID0gc3RyaW5nVG9CeXRlczsKZXhwb3J0cy5zdHJpbmdUb1BERlN0cmluZyA9IHN0cmluZ1RvUERGU3RyaW5nOwpleHBvcnRzLnN0cmluZ1RvVVRGOFN0cmluZyA9IHN0cmluZ1RvVVRGOFN0cmluZzsKZXhwb3J0cy51dGY4U3RyaW5nVG9TdHJpbmcgPSB1dGY4U3RyaW5nVG9TdHJpbmc7CmV4cG9ydHMud2FybiA9IHdhcm47CmV4cG9ydHMudW5yZWFjaGFibGUgPSB1bnJlYWNoYWJsZTsKZXhwb3J0cy5Jc0V2YWxTdXBwb3J0ZWRDYWNoZWQgPSBleHBvcnRzLklzTGl0dGxlRW5kaWFuQ2FjaGVkID0gZXhwb3J0cy5jcmVhdGVPYmplY3RVUkwgPSBleHBvcnRzLkZvcm1hdEVycm9yID0gZXhwb3J0cy5VdGlsID0gZXhwb3J0cy5Vbmtub3duRXJyb3JFeGNlcHRpb24gPSBleHBvcnRzLlVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbiA9IGV4cG9ydHMuVGV4dFJlbmRlcmluZ01vZGUgPSBleHBvcnRzLlN0cmVhbVR5cGUgPSBleHBvcnRzLlBlcm1pc3Npb25GbGFnID0gZXhwb3J0cy5QYXNzd29yZFJlc3BvbnNlcyA9IGV4cG9ydHMuUGFzc3dvcmRFeGNlcHRpb24gPSBleHBvcnRzLk1pc3NpbmdQREZFeGNlcHRpb24gPSBleHBvcnRzLkludmFsaWRQREZFeGNlcHRpb24gPSBleHBvcnRzLkFib3J0RXhjZXB0aW9uID0gZXhwb3J0cy5DTWFwQ29tcHJlc3Npb25UeXBlID0gZXhwb3J0cy5JbWFnZUtpbmQgPSBleHBvcnRzLkZvbnRUeXBlID0gZXhwb3J0cy5Bbm5vdGF0aW9uVHlwZSA9IGV4cG9ydHMuQW5ub3RhdGlvblN0YXRlTW9kZWxUeXBlID0gZXhwb3J0cy5Bbm5vdGF0aW9uUmV2aWV3U3RhdGUgPSBleHBvcnRzLkFubm90YXRpb25SZXBseVR5cGUgPSBleHBvcnRzLkFubm90YXRpb25NYXJrZWRTdGF0ZSA9IGV4cG9ydHMuQW5ub3RhdGlvbkZsYWcgPSBleHBvcnRzLkFubm90YXRpb25GaWVsZEZsYWcgPSBleHBvcnRzLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUgPSBleHBvcnRzLlVOU1VQUE9SVEVEX0ZFQVRVUkVTID0gZXhwb3J0cy5WZXJib3NpdHlMZXZlbCA9IGV4cG9ydHMuT1BTID0gZXhwb3J0cy5JREVOVElUWV9NQVRSSVggPSBleHBvcnRzLkZPTlRfSURFTlRJVFlfTUFUUklYID0gZXhwb3J0cy5CYXNlRXhjZXB0aW9uID0gdm9pZCAwOwoKX193X3BkZmpzX3JlcXVpcmVfXyg2KTsKCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCnZhciBJREVOVElUWV9NQVRSSVggPSBbMSwgMCwgMCwgMSwgMCwgMF07CmV4cG9ydHMuSURFTlRJVFlfTUFUUklYID0gSURFTlRJVFlfTUFUUklYOwp2YXIgRk9OVF9JREVOVElUWV9NQVRSSVggPSBbMC4wMDEsIDAsIDAsIDAuMDAxLCAwLCAwXTsKZXhwb3J0cy5GT05UX0lERU5USVRZX01BVFJJWCA9IEZPTlRfSURFTlRJVFlfTUFUUklYOwp2YXIgUGVybWlzc2lvbkZsYWcgPSB7CiAgUFJJTlQ6IDB4MDQsCiAgTU9ESUZZX0NPTlRFTlRTOiAweDA4LAogIENPUFk6IDB4MTAsCiAgTU9ESUZZX0FOTk9UQVRJT05TOiAweDIwLAogIEZJTExfSU5URVJBQ1RJVkVfRk9STVM6IDB4MTAwLAogIENPUFlfRk9SX0FDQ0VTU0lCSUxJVFk6IDB4MjAwLAogIEFTU0VNQkxFOiAweDQwMCwKICBQUklOVF9ISUdIX1FVQUxJVFk6IDB4ODAwCn07CmV4cG9ydHMuUGVybWlzc2lvbkZsYWcgPSBQZXJtaXNzaW9uRmxhZzsKdmFyIFRleHRSZW5kZXJpbmdNb2RlID0gewogIEZJTEw6IDAsCiAgU1RST0tFOiAxLAogIEZJTExfU1RST0tFOiAyLAogIElOVklTSUJMRTogMywKICBGSUxMX0FERF9UT19QQVRIOiA0LAogIFNUUk9LRV9BRERfVE9fUEFUSDogNSwKICBGSUxMX1NUUk9LRV9BRERfVE9fUEFUSDogNiwKICBBRERfVE9fUEFUSDogNywKICBGSUxMX1NUUk9LRV9NQVNLOiAzLAogIEFERF9UT19QQVRIX0ZMQUc6IDQKfTsKZXhwb3J0cy5UZXh0UmVuZGVyaW5nTW9kZSA9IFRleHRSZW5kZXJpbmdNb2RlOwp2YXIgSW1hZ2VLaW5kID0gewogIEdSQVlTQ0FMRV8xQlBQOiAxLAogIFJHQl8yNEJQUDogMiwKICBSR0JBXzMyQlBQOiAzCn07CmV4cG9ydHMuSW1hZ2VLaW5kID0gSW1hZ2VLaW5kOwp2YXIgQW5ub3RhdGlvblR5cGUgPSB7CiAgVEVYVDogMSwKICBMSU5LOiAyLAogIEZSRUVURVhUOiAzLAogIExJTkU6IDQsCiAgU1FVQVJFOiA1LAogIENJUkNMRTogNiwKICBQT0xZR09OOiA3LAogIFBPTFlMSU5FOiA4LAogIEhJR0hMSUdIVDogOSwKICBVTkRFUkxJTkU6IDEwLAogIFNRVUlHR0xZOiAxMSwKICBTVFJJS0VPVVQ6IDEyLAogIFNUQU1QOiAxMywKICBDQVJFVDogMTQsCiAgSU5LOiAxNSwKICBQT1BVUDogMTYsCiAgRklMRUFUVEFDSE1FTlQ6IDE3LAogIFNPVU5EOiAxOCwKICBNT1ZJRTogMTksCiAgV0lER0VUOiAyMCwKICBTQ1JFRU46IDIxLAogIFBSSU5URVJNQVJLOiAyMiwKICBUUkFQTkVUOiAyMywKICBXQVRFUk1BUks6IDI0LAogIFRIUkVFRDogMjUsCiAgUkVEQUNUOiAyNgp9OwpleHBvcnRzLkFubm90YXRpb25UeXBlID0gQW5ub3RhdGlvblR5cGU7CnZhciBBbm5vdGF0aW9uU3RhdGVNb2RlbFR5cGUgPSB7CiAgTUFSS0VEOiAiTWFya2VkIiwKICBSRVZJRVc6ICJSZXZpZXciCn07CmV4cG9ydHMuQW5ub3RhdGlvblN0YXRlTW9kZWxUeXBlID0gQW5ub3RhdGlvblN0YXRlTW9kZWxUeXBlOwp2YXIgQW5ub3RhdGlvbk1hcmtlZFN0YXRlID0gewogIE1BUktFRDogIk1hcmtlZCIsCiAgVU5NQVJLRUQ6ICJVbm1hcmtlZCIKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uTWFya2VkU3RhdGUgPSBBbm5vdGF0aW9uTWFya2VkU3RhdGU7CnZhciBBbm5vdGF0aW9uUmV2aWV3U3RhdGUgPSB7CiAgQUNDRVBURUQ6ICJBY2NlcHRlZCIsCiAgUkVKRUNURUQ6ICJSZWplY3RlZCIsCiAgQ0FOQ0VMTEVEOiAiQ2FuY2VsbGVkIiwKICBDT01QTEVURUQ6ICJDb21wbGV0ZWQiLAogIE5PTkU6ICJOb25lIgp9OwpleHBvcnRzLkFubm90YXRpb25SZXZpZXdTdGF0ZSA9IEFubm90YXRpb25SZXZpZXdTdGF0ZTsKdmFyIEFubm90YXRpb25SZXBseVR5cGUgPSB7CiAgR1JPVVA6ICJHcm91cCIsCiAgUkVQTFk6ICJSIgp9OwpleHBvcnRzLkFubm90YXRpb25SZXBseVR5cGUgPSBBbm5vdGF0aW9uUmVwbHlUeXBlOwp2YXIgQW5ub3RhdGlvbkZsYWcgPSB7CiAgSU5WSVNJQkxFOiAweDAxLAogIEhJRERFTjogMHgwMiwKICBQUklOVDogMHgwNCwKICBOT1pPT006IDB4MDgsCiAgTk9ST1RBVEU6IDB4MTAsCiAgTk9WSUVXOiAweDIwLAogIFJFQURPTkxZOiAweDQwLAogIExPQ0tFRDogMHg4MCwKICBUT0dHTEVOT1ZJRVc6IDB4MTAwLAogIExPQ0tFRENPTlRFTlRTOiAweDIwMAp9OwpleHBvcnRzLkFubm90YXRpb25GbGFnID0gQW5ub3RhdGlvbkZsYWc7CnZhciBBbm5vdGF0aW9uRmllbGRGbGFnID0gewogIFJFQURPTkxZOiAweDAwMDAwMDEsCiAgUkVRVUlSRUQ6IDB4MDAwMDAwMiwKICBOT0VYUE9SVDogMHgwMDAwMDA0LAogIE1VTFRJTElORTogMHgwMDAxMDAwLAogIFBBU1NXT1JEOiAweDAwMDIwMDAsCiAgTk9UT0dHTEVUT09GRjogMHgwMDA0MDAwLAogIFJBRElPOiAweDAwMDgwMDAsCiAgUFVTSEJVVFRPTjogMHgwMDEwMDAwLAogIENPTUJPOiAweDAwMjAwMDAsCiAgRURJVDogMHgwMDQwMDAwLAogIFNPUlQ6IDB4MDA4MDAwMCwKICBGSUxFU0VMRUNUOiAweDAxMDAwMDAsCiAgTVVMVElTRUxFQ1Q6IDB4MDIwMDAwMCwKICBET05PVFNQRUxMQ0hFQ0s6IDB4MDQwMDAwMCwKICBET05PVFNDUk9MTDogMHgwODAwMDAwLAogIENPTUI6IDB4MTAwMDAwMCwKICBSSUNIVEVYVDogMHgyMDAwMDAwLAogIFJBRElPU0lOVU5JU09OOiAweDIwMDAwMDAsCiAgQ09NTUlUT05TRUxDSEFOR0U6IDB4NDAwMDAwMAp9OwpleHBvcnRzLkFubm90YXRpb25GaWVsZEZsYWcgPSBBbm5vdGF0aW9uRmllbGRGbGFnOwp2YXIgQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZSA9IHsKICBTT0xJRDogMSwKICBEQVNIRUQ6IDIsCiAgQkVWRUxFRDogMywKICBJTlNFVDogNCwKICBVTkRFUkxJTkU6IDUKfTsKZXhwb3J0cy5Bbm5vdGF0aW9uQm9yZGVyU3R5bGVUeXBlID0gQW5ub3RhdGlvbkJvcmRlclN0eWxlVHlwZTsKdmFyIFN0cmVhbVR5cGUgPSB7CiAgVU5LTk9XTjogIlVOS05PV04iLAogIEZMQVRFOiAiRkxBVEUiLAogIExaVzogIkxaVyIsCiAgRENUOiAiRENUIiwKICBKUFg6ICJKUFgiLAogIEpCSUc6ICJKQklHIiwKICBBODU6ICJBODUiLAogIEFIWDogIkFIWCIsCiAgQ0NGOiAiQ0NGIiwKICBSTFg6ICJSTFgiCn07CmV4cG9ydHMuU3RyZWFtVHlwZSA9IFN0cmVhbVR5cGU7CnZhciBGb250VHlwZSA9IHsKICBVTktOT1dOOiAiVU5LTk9XTiIsCiAgVFlQRTE6ICJUWVBFMSIsCiAgVFlQRTFDOiAiVFlQRTFDIiwKICBDSURGT05UVFlQRTA6ICJDSURGT05UVFlQRTAiLAogIENJREZPTlRUWVBFMEM6ICJDSURGT05UVFlQRTBDIiwKICBUUlVFVFlQRTogIlRSVUVUWVBFIiwKICBDSURGT05UVFlQRTI6ICJDSURGT05UVFlQRTIiLAogIFRZUEUzOiAiVFlQRTMiLAogIE9QRU5UWVBFOiAiT1BFTlRZUEUiLAogIFRZUEUwOiAiVFlQRTAiLAogIE1NVFlQRTE6ICJNTVRZUEUxIgp9OwpleHBvcnRzLkZvbnRUeXBlID0gRm9udFR5cGU7CnZhciBWZXJib3NpdHlMZXZlbCA9IHsKICBFUlJPUlM6IDAsCiAgV0FSTklOR1M6IDEsCiAgSU5GT1M6IDUKfTsKZXhwb3J0cy5WZXJib3NpdHlMZXZlbCA9IFZlcmJvc2l0eUxldmVsOwp2YXIgQ01hcENvbXByZXNzaW9uVHlwZSA9IHsKICBOT05FOiAwLAogIEJJTkFSWTogMSwKICBTVFJFQU06IDIKfTsKZXhwb3J0cy5DTWFwQ29tcHJlc3Npb25UeXBlID0gQ01hcENvbXByZXNzaW9uVHlwZTsKdmFyIE9QUyA9IHsKICBkZXBlbmRlbmN5OiAxLAogIHNldExpbmVXaWR0aDogMiwKICBzZXRMaW5lQ2FwOiAzLAogIHNldExpbmVKb2luOiA0LAogIHNldE1pdGVyTGltaXQ6IDUsCiAgc2V0RGFzaDogNiwKICBzZXRSZW5kZXJpbmdJbnRlbnQ6IDcsCiAgc2V0RmxhdG5lc3M6IDgsCiAgc2V0R1N0YXRlOiA5LAogIHNhdmU6IDEwLAogIHJlc3RvcmU6IDExLAogIHRyYW5zZm9ybTogMTIsCiAgbW92ZVRvOiAxMywKICBsaW5lVG86IDE0LAogIGN1cnZlVG86IDE1LAogIGN1cnZlVG8yOiAxNiwKICBjdXJ2ZVRvMzogMTcsCiAgY2xvc2VQYXRoOiAxOCwKICByZWN0YW5nbGU6IDE5LAogIHN0cm9rZTogMjAsCiAgY2xvc2VTdHJva2U6IDIxLAogIGZpbGw6IDIyLAogIGVvRmlsbDogMjMsCiAgZmlsbFN0cm9rZTogMjQsCiAgZW9GaWxsU3Ryb2tlOiAyNSwKICBjbG9zZUZpbGxTdHJva2U6IDI2LAogIGNsb3NlRU9GaWxsU3Ryb2tlOiAyNywKICBlbmRQYXRoOiAyOCwKICBjbGlwOiAyOSwKICBlb0NsaXA6IDMwLAogIGJlZ2luVGV4dDogMzEsCiAgZW5kVGV4dDogMzIsCiAgc2V0Q2hhclNwYWNpbmc6IDMzLAogIHNldFdvcmRTcGFjaW5nOiAzNCwKICBzZXRIU2NhbGU6IDM1LAogIHNldExlYWRpbmc6IDM2LAogIHNldEZvbnQ6IDM3LAogIHNldFRleHRSZW5kZXJpbmdNb2RlOiAzOCwKICBzZXRUZXh0UmlzZTogMzksCiAgbW92ZVRleHQ6IDQwLAogIHNldExlYWRpbmdNb3ZlVGV4dDogNDEsCiAgc2V0VGV4dE1hdHJpeDogNDIsCiAgbmV4dExpbmU6IDQzLAogIHNob3dUZXh0OiA0NCwKICBzaG93U3BhY2VkVGV4dDogNDUsCiAgbmV4dExpbmVTaG93VGV4dDogNDYsCiAgbmV4dExpbmVTZXRTcGFjaW5nU2hvd1RleHQ6IDQ3LAogIHNldENoYXJXaWR0aDogNDgsCiAgc2V0Q2hhcldpZHRoQW5kQm91bmRzOiA0OSwKICBzZXRTdHJva2VDb2xvclNwYWNlOiA1MCwKICBzZXRGaWxsQ29sb3JTcGFjZTogNTEsCiAgc2V0U3Ryb2tlQ29sb3I6IDUyLAogIHNldFN0cm9rZUNvbG9yTjogNTMsCiAgc2V0RmlsbENvbG9yOiA1NCwKICBzZXRGaWxsQ29sb3JOOiA1NSwKICBzZXRTdHJva2VHcmF5OiA1NiwKICBzZXRGaWxsR3JheTogNTcsCiAgc2V0U3Ryb2tlUkdCQ29sb3I6IDU4LAogIHNldEZpbGxSR0JDb2xvcjogNTksCiAgc2V0U3Ryb2tlQ01ZS0NvbG9yOiA2MCwKICBzZXRGaWxsQ01ZS0NvbG9yOiA2MSwKICBzaGFkaW5nRmlsbDogNjIsCiAgYmVnaW5JbmxpbmVJbWFnZTogNjMsCiAgYmVnaW5JbWFnZURhdGE6IDY0LAogIGVuZElubGluZUltYWdlOiA2NSwKICBwYWludFhPYmplY3Q6IDY2LAogIG1hcmtQb2ludDogNjcsCiAgbWFya1BvaW50UHJvcHM6IDY4LAogIGJlZ2luTWFya2VkQ29udGVudDogNjksCiAgYmVnaW5NYXJrZWRDb250ZW50UHJvcHM6IDcwLAogIGVuZE1hcmtlZENvbnRlbnQ6IDcxLAogIGJlZ2luQ29tcGF0OiA3MiwKICBlbmRDb21wYXQ6IDczLAogIHBhaW50Rm9ybVhPYmplY3RCZWdpbjogNzQsCiAgcGFpbnRGb3JtWE9iamVjdEVuZDogNzUsCiAgYmVnaW5Hcm91cDogNzYsCiAgZW5kR3JvdXA6IDc3LAogIGJlZ2luQW5ub3RhdGlvbnM6IDc4LAogIGVuZEFubm90YXRpb25zOiA3OSwKICBiZWdpbkFubm90YXRpb246IDgwLAogIGVuZEFubm90YXRpb246IDgxLAogIHBhaW50SnBlZ1hPYmplY3Q6IDgyLAogIHBhaW50SW1hZ2VNYXNrWE9iamVjdDogODMsCiAgcGFpbnRJbWFnZU1hc2tYT2JqZWN0R3JvdXA6IDg0LAogIHBhaW50SW1hZ2VYT2JqZWN0OiA4NSwKICBwYWludElubGluZUltYWdlWE9iamVjdDogODYsCiAgcGFpbnRJbmxpbmVJbWFnZVhPYmplY3RHcm91cDogODcsCiAgcGFpbnRJbWFnZVhPYmplY3RSZXBlYXQ6IDg4LAogIHBhaW50SW1hZ2VNYXNrWE9iamVjdFJlcGVhdDogODksCiAgcGFpbnRTb2xpZENvbG9ySW1hZ2VNYXNrOiA5MCwKICBjb25zdHJ1Y3RQYXRoOiA5MQp9OwpleHBvcnRzLk9QUyA9IE9QUzsKdmFyIFVOU1VQUE9SVEVEX0ZFQVRVUkVTID0gewogIHVua25vd246ICJ1bmtub3duIiwKICBmb3JtczogImZvcm1zIiwKICBqYXZhU2NyaXB0OiAiamF2YVNjcmlwdCIsCiAgc21hc2s6ICJzbWFzayIsCiAgc2hhZGluZ1BhdHRlcm46ICJzaGFkaW5nUGF0dGVybiIsCiAgZm9udDogImZvbnQiLAogIGVycm9yVGlsaW5nUGF0dGVybjogImVycm9yVGlsaW5nUGF0dGVybiIsCiAgZXJyb3JFeHRHU3RhdGU6ICJlcnJvckV4dEdTdGF0ZSIsCiAgZXJyb3JYT2JqZWN0OiAiZXJyb3JYT2JqZWN0IiwKICBlcnJvckZvbnRMb2FkVHlwZTM6ICJlcnJvckZvbnRMb2FkVHlwZTMiLAogIGVycm9yRm9udFN0YXRlOiAiZXJyb3JGb250U3RhdGUiLAogIGVycm9yRm9udE1pc3Npbmc6ICJlcnJvckZvbnRNaXNzaW5nIiwKICBlcnJvckZvbnRUcmFuc2xhdGU6ICJlcnJvckZvbnRUcmFuc2xhdGUiLAogIGVycm9yQ29sb3JTcGFjZTogImVycm9yQ29sb3JTcGFjZSIsCiAgZXJyb3JPcGVyYXRvckxpc3Q6ICJlcnJvck9wZXJhdG9yTGlzdCIsCiAgZXJyb3JGb250VG9Vbmljb2RlOiAiZXJyb3JGb250VG9Vbmljb2RlIiwKICBlcnJvckZvbnRMb2FkTmF0aXZlOiAiZXJyb3JGb250TG9hZE5hdGl2ZSIsCiAgZXJyb3JGb250R2V0UGF0aDogImVycm9yRm9udEdldFBhdGgiCn07CmV4cG9ydHMuVU5TVVBQT1JURURfRkVBVFVSRVMgPSBVTlNVUFBPUlRFRF9GRUFUVVJFUzsKdmFyIFBhc3N3b3JkUmVzcG9uc2VzID0gewogIE5FRURfUEFTU1dPUkQ6IDEsCiAgSU5DT1JSRUNUX1BBU1NXT1JEOiAyCn07CmV4cG9ydHMuUGFzc3dvcmRSZXNwb25zZXMgPSBQYXNzd29yZFJlc3BvbnNlczsKdmFyIHZlcmJvc2l0eSA9IFZlcmJvc2l0eUxldmVsLldBUk5JTkdTOwoKZnVuY3Rpb24gc2V0VmVyYm9zaXR5TGV2ZWwobGV2ZWwpIHsKICBpZiAoTnVtYmVyLmlzSW50ZWdlcihsZXZlbCkpIHsKICAgIHZlcmJvc2l0eSA9IGxldmVsOwogIH0KfQoKZnVuY3Rpb24gZ2V0VmVyYm9zaXR5TGV2ZWwoKSB7CiAgcmV0dXJuIHZlcmJvc2l0eTsKfQoKZnVuY3Rpb24gaW5mbyhtc2cpIHsKICBpZiAodmVyYm9zaXR5ID49IFZlcmJvc2l0eUxldmVsLklORk9TKSB7CiAgICBjb25zb2xlLmxvZygiSW5mbzogIi5jb25jYXQobXNnKSk7CiAgfQp9CgpmdW5jdGlvbiB3YXJuKG1zZykgewogIGlmICh2ZXJib3NpdHkgPj0gVmVyYm9zaXR5TGV2ZWwuV0FSTklOR1MpIHsKICAgIGNvbnNvbGUubG9nKCJXYXJuaW5nOiAiLmNvbmNhdChtc2cpKTsKICB9Cn0KCmZ1bmN0aW9uIHVucmVhY2hhYmxlKG1zZykgewogIHRocm93IG5ldyBFcnJvcihtc2cpOwp9CgpmdW5jdGlvbiBhc3NlcnQoY29uZCwgbXNnKSB7CiAgaWYgKCFjb25kKSB7CiAgICB1bnJlYWNoYWJsZShtc2cpOwogIH0KfQoKZnVuY3Rpb24gaXNTYW1lT3JpZ2luKGJhc2VVcmwsIG90aGVyVXJsKSB7CiAgdmFyIGJhc2U7CgogIHRyeSB7CiAgICBiYXNlID0gbmV3IFVSTChiYXNlVXJsKTsKCiAgICBpZiAoIWJhc2Uub3JpZ2luIHx8IGJhc2Uub3JpZ2luID09PSAibnVsbCIpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0gY2F0Y2ggKGUpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHZhciBvdGhlciA9IG5ldyBVUkwob3RoZXJVcmwsIGJhc2UpOwogIHJldHVybiBiYXNlLm9yaWdpbiA9PT0gb3RoZXIub3JpZ2luOwp9CgpmdW5jdGlvbiBfaXNWYWxpZFByb3RvY29sKHVybCkgewogIGlmICghdXJsKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBzd2l0Y2ggKHVybC5wcm90b2NvbCkgewogICAgY2FzZSAiaHR0cDoiOgogICAgY2FzZSAiaHR0cHM6IjoKICAgIGNhc2UgImZ0cDoiOgogICAgY2FzZSAibWFpbHRvOiI6CiAgICBjYXNlICJ0ZWw6IjoKICAgICAgcmV0dXJuIHRydWU7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gY3JlYXRlVmFsaWRBYnNvbHV0ZVVybCh1cmwsIGJhc2VVcmwpIHsKICBpZiAoIXVybCkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICB0cnkgewogICAgdmFyIGFic29sdXRlVXJsID0gYmFzZVVybCA/IG5ldyBVUkwodXJsLCBiYXNlVXJsKSA6IG5ldyBVUkwodXJsKTsKCiAgICBpZiAoX2lzVmFsaWRQcm90b2NvbChhYnNvbHV0ZVVybCkpIHsKICAgICAgcmV0dXJuIGFic29sdXRlVXJsOwogICAgfQogIH0gY2F0Y2ggKGV4KSB7fQoKICByZXR1cm4gbnVsbDsKfQoKZnVuY3Rpb24gc2hhZG93KG9iaiwgcHJvcCwgdmFsdWUpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBwcm9wLCB7CiAgICB2YWx1ZTogdmFsdWUsCiAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgd3JpdGFibGU6IGZhbHNlCiAgfSk7CiAgcmV0dXJuIHZhbHVlOwp9Cgp2YXIgQmFzZUV4Y2VwdGlvbiA9IGZ1bmN0aW9uIEJhc2VFeGNlcHRpb25DbG9zdXJlKCkgewogIGZ1bmN0aW9uIEJhc2VFeGNlcHRpb24obWVzc2FnZSkgewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IEJhc2VFeGNlcHRpb24pIHsKICAgICAgdW5yZWFjaGFibGUoIkNhbm5vdCBpbml0aWFsaXplIEJhc2VFeGNlcHRpb24uIik7CiAgICB9CgogICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKICAgIHRoaXMubmFtZSA9IHRoaXMuY29uc3RydWN0b3IubmFtZTsKICB9CgogIEJhc2VFeGNlcHRpb24ucHJvdG90eXBlID0gbmV3IEVycm9yKCk7CiAgQmFzZUV4Y2VwdGlvbi5jb25zdHJ1Y3RvciA9IEJhc2VFeGNlcHRpb247CiAgcmV0dXJuIEJhc2VFeGNlcHRpb247Cn0oKTsKCmV4cG9ydHMuQmFzZUV4Y2VwdGlvbiA9IEJhc2VFeGNlcHRpb247Cgp2YXIgUGFzc3dvcmRFeGNlcHRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlRXhjZXB0aW9uKSB7CiAgX2luaGVyaXRzKFBhc3N3b3JkRXhjZXB0aW9uLCBfQmFzZUV4Y2VwdGlvbik7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUGFzc3dvcmRFeGNlcHRpb24pOwoKICBmdW5jdGlvbiBQYXNzd29yZEV4Y2VwdGlvbihtc2csIGNvZGUpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGFzc3dvcmRFeGNlcHRpb24pOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgbXNnKTsKICAgIF90aGlzLmNvZGUgPSBjb2RlOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgcmV0dXJuIFBhc3N3b3JkRXhjZXB0aW9uOwp9KEJhc2VFeGNlcHRpb24pOwoKZXhwb3J0cy5QYXNzd29yZEV4Y2VwdGlvbiA9IFBhc3N3b3JkRXhjZXB0aW9uOwoKdmFyIFVua25vd25FcnJvckV4Y2VwdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VFeGNlcHRpb24yKSB7CiAgX2luaGVyaXRzKFVua25vd25FcnJvckV4Y2VwdGlvbiwgX0Jhc2VFeGNlcHRpb24yKTsKCiAgdmFyIF9zdXBlcjIgPSBfY3JlYXRlU3VwZXIoVW5rbm93bkVycm9yRXhjZXB0aW9uKTsKCiAgZnVuY3Rpb24gVW5rbm93bkVycm9yRXhjZXB0aW9uKG1zZywgZGV0YWlscykgewogICAgdmFyIF90aGlzMjsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVW5rbm93bkVycm9yRXhjZXB0aW9uKTsKCiAgICBfdGhpczIgPSBfc3VwZXIyLmNhbGwodGhpcywgbXNnKTsKICAgIF90aGlzMi5kZXRhaWxzID0gZGV0YWlsczsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICByZXR1cm4gVW5rbm93bkVycm9yRXhjZXB0aW9uOwp9KEJhc2VFeGNlcHRpb24pOwoKZXhwb3J0cy5Vbmtub3duRXJyb3JFeGNlcHRpb24gPSBVbmtub3duRXJyb3JFeGNlcHRpb247Cgp2YXIgSW52YWxpZFBERkV4Y2VwdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VFeGNlcHRpb24zKSB7CiAgX2luaGVyaXRzKEludmFsaWRQREZFeGNlcHRpb24sIF9CYXNlRXhjZXB0aW9uMyk7CgogIHZhciBfc3VwZXIzID0gX2NyZWF0ZVN1cGVyKEludmFsaWRQREZFeGNlcHRpb24pOwoKICBmdW5jdGlvbiBJbnZhbGlkUERGRXhjZXB0aW9uKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEludmFsaWRQREZFeGNlcHRpb24pOwoKICAgIHJldHVybiBfc3VwZXIzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICByZXR1cm4gSW52YWxpZFBERkV4Y2VwdGlvbjsKfShCYXNlRXhjZXB0aW9uKTsKCmV4cG9ydHMuSW52YWxpZFBERkV4Y2VwdGlvbiA9IEludmFsaWRQREZFeGNlcHRpb247Cgp2YXIgTWlzc2luZ1BERkV4Y2VwdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VFeGNlcHRpb240KSB7CiAgX2luaGVyaXRzKE1pc3NpbmdQREZFeGNlcHRpb24sIF9CYXNlRXhjZXB0aW9uNCk7CgogIHZhciBfc3VwZXI0ID0gX2NyZWF0ZVN1cGVyKE1pc3NpbmdQREZFeGNlcHRpb24pOwoKICBmdW5jdGlvbiBNaXNzaW5nUERGRXhjZXB0aW9uKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1pc3NpbmdQREZFeGNlcHRpb24pOwoKICAgIHJldHVybiBfc3VwZXI0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICByZXR1cm4gTWlzc2luZ1BERkV4Y2VwdGlvbjsKfShCYXNlRXhjZXB0aW9uKTsKCmV4cG9ydHMuTWlzc2luZ1BERkV4Y2VwdGlvbiA9IE1pc3NpbmdQREZFeGNlcHRpb247Cgp2YXIgVW5leHBlY3RlZFJlc3BvbnNlRXhjZXB0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZUV4Y2VwdGlvbjUpIHsKICBfaW5oZXJpdHMoVW5leHBlY3RlZFJlc3BvbnNlRXhjZXB0aW9uLCBfQmFzZUV4Y2VwdGlvbjUpOwoKICB2YXIgX3N1cGVyNSA9IF9jcmVhdGVTdXBlcihVbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24pOwoKICBmdW5jdGlvbiBVbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24obXNnLCBzdGF0dXMpIHsKICAgIHZhciBfdGhpczM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbik7CgogICAgX3RoaXMzID0gX3N1cGVyNS5jYWxsKHRoaXMsIG1zZyk7CiAgICBfdGhpczMuc3RhdHVzID0gc3RhdHVzOwogICAgcmV0dXJuIF90aGlzMzsKICB9CgogIHJldHVybiBVbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb247Cn0oQmFzZUV4Y2VwdGlvbik7CgpleHBvcnRzLlVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbiA9IFVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbjsKCnZhciBGb3JtYXRFcnJvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VFeGNlcHRpb242KSB7CiAgX2luaGVyaXRzKEZvcm1hdEVycm9yLCBfQmFzZUV4Y2VwdGlvbjYpOwoKICB2YXIgX3N1cGVyNiA9IF9jcmVhdGVTdXBlcihGb3JtYXRFcnJvcik7CgogIGZ1bmN0aW9uIEZvcm1hdEVycm9yKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZvcm1hdEVycm9yKTsKCiAgICByZXR1cm4gX3N1cGVyNi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0KCiAgcmV0dXJuIEZvcm1hdEVycm9yOwp9KEJhc2VFeGNlcHRpb24pOwoKZXhwb3J0cy5Gb3JtYXRFcnJvciA9IEZvcm1hdEVycm9yOwoKdmFyIEFib3J0RXhjZXB0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZUV4Y2VwdGlvbjcpIHsKICBfaW5oZXJpdHMoQWJvcnRFeGNlcHRpb24sIF9CYXNlRXhjZXB0aW9uNyk7CgogIHZhciBfc3VwZXI3ID0gX2NyZWF0ZVN1cGVyKEFib3J0RXhjZXB0aW9uKTsKCiAgZnVuY3Rpb24gQWJvcnRFeGNlcHRpb24oKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQWJvcnRFeGNlcHRpb24pOwoKICAgIHJldHVybiBfc3VwZXI3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICByZXR1cm4gQWJvcnRFeGNlcHRpb247Cn0oQmFzZUV4Y2VwdGlvbik7CgpleHBvcnRzLkFib3J0RXhjZXB0aW9uID0gQWJvcnRFeGNlcHRpb247CnZhciBOdWxsQ2hhcmFjdGVyc1JlZ0V4cCA9IC9ceDAwL2c7CgpmdW5jdGlvbiByZW1vdmVOdWxsQ2hhcmFjdGVycyhzdHIpIHsKICBpZiAodHlwZW9mIHN0ciAhPT0gInN0cmluZyIpIHsKICAgIHdhcm4oIlRoZSBhcmd1bWVudCBmb3IgcmVtb3ZlTnVsbENoYXJhY3RlcnMgbXVzdCBiZSBhIHN0cmluZy4iKTsKICAgIHJldHVybiBzdHI7CiAgfQoKICByZXR1cm4gc3RyLnJlcGxhY2UoTnVsbENoYXJhY3RlcnNSZWdFeHAsICIiKTsKfQoKZnVuY3Rpb24gYnl0ZXNUb1N0cmluZyhieXRlcykgewogIGFzc2VydChieXRlcyAhPT0gbnVsbCAmJiBfdHlwZW9mKGJ5dGVzKSA9PT0gIm9iamVjdCIgJiYgYnl0ZXMubGVuZ3RoICE9PSB1bmRlZmluZWQsICJJbnZhbGlkIGFyZ3VtZW50IGZvciBieXRlc1RvU3RyaW5nIik7CiAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKICB2YXIgTUFYX0FSR1VNRU5UX0NPVU5UID0gODE5MjsKCiAgaWYgKGxlbmd0aCA8IE1BWF9BUkdVTUVOVF9DT1VOVCkgewogICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgYnl0ZXMpOwogIH0KCiAgdmFyIHN0ckJ1ZiA9IFtdOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSBNQVhfQVJHVU1FTlRfQ09VTlQpIHsKICAgIHZhciBjaHVua0VuZCA9IE1hdGgubWluKGkgKyBNQVhfQVJHVU1FTlRfQ09VTlQsIGxlbmd0aCk7CiAgICB2YXIgY2h1bmsgPSBieXRlcy5zdWJhcnJheShpLCBjaHVua0VuZCk7CiAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGNodW5rKSk7CiAgfQoKICByZXR1cm4gc3RyQnVmLmpvaW4oIiIpOwp9CgpmdW5jdGlvbiBzdHJpbmdUb0J5dGVzKHN0cikgewogIGFzc2VydCh0eXBlb2Ygc3RyID09PSAic3RyaW5nIiwgIkludmFsaWQgYXJndW1lbnQgZm9yIHN0cmluZ1RvQnl0ZXMiKTsKICB2YXIgbGVuZ3RoID0gc3RyLmxlbmd0aDsKICB2YXIgYnl0ZXMgPSBuZXcgVWludDhBcnJheShsZW5ndGgpOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICBieXRlc1tpXSA9IHN0ci5jaGFyQ29kZUF0KGkpICYgMHhmZjsKICB9CgogIHJldHVybiBieXRlczsKfQoKZnVuY3Rpb24gYXJyYXlCeXRlTGVuZ3RoKGFycikgewogIGlmIChhcnIubGVuZ3RoICE9PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBhcnIubGVuZ3RoOwogIH0KCiAgYXNzZXJ0KGFyci5ieXRlTGVuZ3RoICE9PSB1bmRlZmluZWQsICJhcnJheUJ5dGVMZW5ndGggLSBpbnZhbGlkIGFyZ3VtZW50LiIpOwogIHJldHVybiBhcnIuYnl0ZUxlbmd0aDsKfQoKZnVuY3Rpb24gYXJyYXlzVG9CeXRlcyhhcnIpIHsKICB2YXIgbGVuZ3RoID0gYXJyLmxlbmd0aDsKCiAgaWYgKGxlbmd0aCA9PT0gMSAmJiBhcnJbMF0gaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7CiAgICByZXR1cm4gYXJyWzBdOwogIH0KCiAgdmFyIHJlc3VsdExlbmd0aCA9IDA7CgogIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgIHJlc3VsdExlbmd0aCArPSBhcnJheUJ5dGVMZW5ndGgoYXJyW2ldKTsKICB9CgogIHZhciBwb3MgPSAwOwogIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkocmVzdWx0TGVuZ3RoKTsKCiAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGxlbmd0aDsgX2krKykgewogICAgdmFyIGl0ZW0gPSBhcnJbX2ldOwoKICAgIGlmICghKGl0ZW0gaW5zdGFuY2VvZiBVaW50OEFycmF5KSkgewogICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgaXRlbSA9IHN0cmluZ1RvQnl0ZXMoaXRlbSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaXRlbSA9IG5ldyBVaW50OEFycmF5KGl0ZW0pOwogICAgICB9CiAgICB9CgogICAgdmFyIGl0ZW1MZW5ndGggPSBpdGVtLmJ5dGVMZW5ndGg7CiAgICBkYXRhLnNldChpdGVtLCBwb3MpOwogICAgcG9zICs9IGl0ZW1MZW5ndGg7CiAgfQoKICByZXR1cm4gZGF0YTsKfQoKZnVuY3Rpb24gc3RyaW5nMzIodmFsdWUpIHsKICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSh2YWx1ZSA+PiAyNCAmIDB4ZmYsIHZhbHVlID4+IDE2ICYgMHhmZiwgdmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZik7Cn0KCmZ1bmN0aW9uIGlzTGl0dGxlRW5kaWFuKCkgewogIHZhciBidWZmZXI4ID0gbmV3IFVpbnQ4QXJyYXkoNCk7CiAgYnVmZmVyOFswXSA9IDE7CiAgdmFyIHZpZXczMiA9IG5ldyBVaW50MzJBcnJheShidWZmZXI4LmJ1ZmZlciwgMCwgMSk7CiAgcmV0dXJuIHZpZXczMlswXSA9PT0gMTsKfQoKdmFyIElzTGl0dGxlRW5kaWFuQ2FjaGVkID0gewogIGdldCB2YWx1ZSgpIHsKICAgIHJldHVybiBzaGFkb3codGhpcywgInZhbHVlIiwgaXNMaXR0bGVFbmRpYW4oKSk7CiAgfQoKfTsKZXhwb3J0cy5Jc0xpdHRsZUVuZGlhbkNhY2hlZCA9IElzTGl0dGxlRW5kaWFuQ2FjaGVkOwoKZnVuY3Rpb24gaXNFdmFsU3VwcG9ydGVkKCkgewogIHRyeSB7CiAgICBuZXcgRnVuY3Rpb24oIiIpOwogICAgcmV0dXJuIHRydWU7CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKdmFyIElzRXZhbFN1cHBvcnRlZENhY2hlZCA9IHsKICBnZXQgdmFsdWUoKSB7CiAgICByZXR1cm4gc2hhZG93KHRoaXMsICJ2YWx1ZSIsIGlzRXZhbFN1cHBvcnRlZCgpKTsKICB9Cgp9OwpleHBvcnRzLklzRXZhbFN1cHBvcnRlZENhY2hlZCA9IElzRXZhbFN1cHBvcnRlZENhY2hlZDsKdmFyIHJnYkJ1ZiA9IFsicmdiKCIsIDAsICIsIiwgMCwgIiwiLCAwLCAiKSJdOwoKdmFyIFV0aWwgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFV0aWwoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVXRpbCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoVXRpbCwgbnVsbCwgW3sKICAgIGtleTogIm1ha2VDc3NSZ2IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1ha2VDc3NSZ2IociwgZywgYikgewogICAgICByZ2JCdWZbMV0gPSByOwogICAgICByZ2JCdWZbM10gPSBnOwogICAgICByZ2JCdWZbNV0gPSBiOwogICAgICByZXR1cm4gcmdiQnVmLmpvaW4oIiIpOwogICAgfQogIH0sIHsKICAgIGtleTogInRyYW5zZm9ybSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdHJhbnNmb3JtKG0xLCBtMikgewogICAgICByZXR1cm4gW20xWzBdICogbTJbMF0gKyBtMVsyXSAqIG0yWzFdLCBtMVsxXSAqIG0yWzBdICsgbTFbM10gKiBtMlsxXSwgbTFbMF0gKiBtMlsyXSArIG0xWzJdICogbTJbM10sIG0xWzFdICogbTJbMl0gKyBtMVszXSAqIG0yWzNdLCBtMVswXSAqIG0yWzRdICsgbTFbMl0gKiBtMls1XSArIG0xWzRdLCBtMVsxXSAqIG0yWzRdICsgbTFbM10gKiBtMls1XSArIG0xWzVdXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhcHBseVRyYW5zZm9ybSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlUcmFuc2Zvcm0ocCwgbSkgewogICAgICB2YXIgeHQgPSBwWzBdICogbVswXSArIHBbMV0gKiBtWzJdICsgbVs0XTsKICAgICAgdmFyIHl0ID0gcFswXSAqIG1bMV0gKyBwWzFdICogbVszXSArIG1bNV07CiAgICAgIHJldHVybiBbeHQsIHl0XTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhcHBseUludmVyc2VUcmFuc2Zvcm0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5SW52ZXJzZVRyYW5zZm9ybShwLCBtKSB7CiAgICAgIHZhciBkID0gbVswXSAqIG1bM10gLSBtWzFdICogbVsyXTsKICAgICAgdmFyIHh0ID0gKHBbMF0gKiBtWzNdIC0gcFsxXSAqIG1bMl0gKyBtWzJdICogbVs1XSAtIG1bNF0gKiBtWzNdKSAvIGQ7CiAgICAgIHZhciB5dCA9ICgtcFswXSAqIG1bMV0gKyBwWzFdICogbVswXSArIG1bNF0gKiBtWzFdIC0gbVs1XSAqIG1bMF0pIC8gZDsKICAgICAgcmV0dXJuIFt4dCwgeXRdOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEF4aWFsQWxpZ25lZEJvdW5kaW5nQm94IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBeGlhbEFsaWduZWRCb3VuZGluZ0JveChyLCBtKSB7CiAgICAgIHZhciBwMSA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0ociwgbSk7CiAgICAgIHZhciBwMiA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0oci5zbGljZSgyLCA0KSwgbSk7CiAgICAgIHZhciBwMyA9IFV0aWwuYXBwbHlUcmFuc2Zvcm0oW3JbMF0sIHJbM11dLCBtKTsKICAgICAgdmFyIHA0ID0gVXRpbC5hcHBseVRyYW5zZm9ybShbclsyXSwgclsxXV0sIG0pOwogICAgICByZXR1cm4gW01hdGgubWluKHAxWzBdLCBwMlswXSwgcDNbMF0sIHA0WzBdKSwgTWF0aC5taW4ocDFbMV0sIHAyWzFdLCBwM1sxXSwgcDRbMV0pLCBNYXRoLm1heChwMVswXSwgcDJbMF0sIHAzWzBdLCBwNFswXSksIE1hdGgubWF4KHAxWzFdLCBwMlsxXSwgcDNbMV0sIHA0WzFdKV07CiAgICB9CiAgfSwgewogICAga2V5OiAiaW52ZXJzZVRyYW5zZm9ybSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW52ZXJzZVRyYW5zZm9ybShtKSB7CiAgICAgIHZhciBkID0gbVswXSAqIG1bM10gLSBtWzFdICogbVsyXTsKICAgICAgcmV0dXJuIFttWzNdIC8gZCwgLW1bMV0gLyBkLCAtbVsyXSAvIGQsIG1bMF0gLyBkLCAobVsyXSAqIG1bNV0gLSBtWzRdICogbVszXSkgLyBkLCAobVs0XSAqIG1bMV0gLSBtWzVdICogbVswXSkgLyBkXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhcHBseTNkVHJhbnNmb3JtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseTNkVHJhbnNmb3JtKG0sIHYpIHsKICAgICAgcmV0dXJuIFttWzBdICogdlswXSArIG1bMV0gKiB2WzFdICsgbVsyXSAqIHZbMl0sIG1bM10gKiB2WzBdICsgbVs0XSAqIHZbMV0gKyBtWzVdICogdlsyXSwgbVs2XSAqIHZbMF0gKyBtWzddICogdlsxXSArIG1bOF0gKiB2WzJdXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzaW5ndWxhclZhbHVlRGVjb21wb3NlMmRTY2FsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2luZ3VsYXJWYWx1ZURlY29tcG9zZTJkU2NhbGUobSkgewogICAgICB2YXIgdHJhbnNwb3NlID0gW21bMF0sIG1bMl0sIG1bMV0sIG1bM11dOwogICAgICB2YXIgYSA9IG1bMF0gKiB0cmFuc3Bvc2VbMF0gKyBtWzFdICogdHJhbnNwb3NlWzJdOwogICAgICB2YXIgYiA9IG1bMF0gKiB0cmFuc3Bvc2VbMV0gKyBtWzFdICogdHJhbnNwb3NlWzNdOwogICAgICB2YXIgYyA9IG1bMl0gKiB0cmFuc3Bvc2VbMF0gKyBtWzNdICogdHJhbnNwb3NlWzJdOwogICAgICB2YXIgZCA9IG1bMl0gKiB0cmFuc3Bvc2VbMV0gKyBtWzNdICogdHJhbnNwb3NlWzNdOwogICAgICB2YXIgZmlyc3QgPSAoYSArIGQpIC8gMjsKICAgICAgdmFyIHNlY29uZCA9IE1hdGguc3FydCgoYSArIGQpICogKGEgKyBkKSAtIDQgKiAoYSAqIGQgLSBjICogYikpIC8gMjsKICAgICAgdmFyIHN4ID0gZmlyc3QgKyBzZWNvbmQgfHwgMTsKICAgICAgdmFyIHN5ID0gZmlyc3QgLSBzZWNvbmQgfHwgMTsKICAgICAgcmV0dXJuIFtNYXRoLnNxcnQoc3gpLCBNYXRoLnNxcnQoc3kpXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJub3JtYWxpemVSZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBub3JtYWxpemVSZWN0KHJlY3QpIHsKICAgICAgdmFyIHIgPSByZWN0LnNsaWNlKDApOwoKICAgICAgaWYgKHJlY3RbMF0gPiByZWN0WzJdKSB7CiAgICAgICAgclswXSA9IHJlY3RbMl07CiAgICAgICAgclsyXSA9IHJlY3RbMF07CiAgICAgIH0KCiAgICAgIGlmIChyZWN0WzFdID4gcmVjdFszXSkgewogICAgICAgIHJbMV0gPSByZWN0WzNdOwogICAgICAgIHJbM10gPSByZWN0WzFdOwogICAgICB9CgogICAgICByZXR1cm4gcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbnRlcnNlY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGludGVyc2VjdChyZWN0MSwgcmVjdDIpIHsKICAgICAgZnVuY3Rpb24gY29tcGFyZShhLCBiKSB7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgICB9CgogICAgICB2YXIgb3JkZXJlZFggPSBbcmVjdDFbMF0sIHJlY3QxWzJdLCByZWN0MlswXSwgcmVjdDJbMl1dLnNvcnQoY29tcGFyZSk7CiAgICAgIHZhciBvcmRlcmVkWSA9IFtyZWN0MVsxXSwgcmVjdDFbM10sIHJlY3QyWzFdLCByZWN0MlszXV0uc29ydChjb21wYXJlKTsKICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICByZWN0MSA9IFV0aWwubm9ybWFsaXplUmVjdChyZWN0MSk7CiAgICAgIHJlY3QyID0gVXRpbC5ub3JtYWxpemVSZWN0KHJlY3QyKTsKCiAgICAgIGlmIChvcmRlcmVkWFswXSA9PT0gcmVjdDFbMF0gJiYgb3JkZXJlZFhbMV0gPT09IHJlY3QyWzBdIHx8IG9yZGVyZWRYWzBdID09PSByZWN0MlswXSAmJiBvcmRlcmVkWFsxXSA9PT0gcmVjdDFbMF0pIHsKICAgICAgICByZXN1bHRbMF0gPSBvcmRlcmVkWFsxXTsKICAgICAgICByZXN1bHRbMl0gPSBvcmRlcmVkWFsyXTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKG9yZGVyZWRZWzBdID09PSByZWN0MVsxXSAmJiBvcmRlcmVkWVsxXSA9PT0gcmVjdDJbMV0gfHwgb3JkZXJlZFlbMF0gPT09IHJlY3QyWzFdICYmIG9yZGVyZWRZWzFdID09PSByZWN0MVsxXSkgewogICAgICAgIHJlc3VsdFsxXSA9IG9yZGVyZWRZWzFdOwogICAgICAgIHJlc3VsdFszXSA9IG9yZGVyZWRZWzJdOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFV0aWw7Cn0oKTsKCmV4cG9ydHMuVXRpbCA9IFV0aWw7CnZhciBQREZTdHJpbmdUcmFuc2xhdGVUYWJsZSA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAweDJEOCwgMHgyQzcsIDB4MkM2LCAweDJEOSwgMHgyREQsIDB4MkRCLCAweDJEQSwgMHgyREMsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDB4MjAyMiwgMHgyMDIwLCAweDIwMjEsIDB4MjAyNiwgMHgyMDE0LCAweDIwMTMsIDB4MTkyLCAweDIwNDQsIDB4MjAzOSwgMHgyMDNBLCAweDIyMTIsIDB4MjAzMCwgMHgyMDFFLCAweDIwMUMsIDB4MjAxRCwgMHgyMDE4LCAweDIwMTksIDB4MjAxQSwgMHgyMTIyLCAweEZCMDEsIDB4RkIwMiwgMHgxNDEsIDB4MTUyLCAweDE2MCwgMHgxNzgsIDB4MTdELCAweDEzMSwgMHgxNDIsIDB4MTUzLCAweDE2MSwgMHgxN0UsIDAsIDB4MjBBQ107CgpmdW5jdGlvbiBzdHJpbmdUb1BERlN0cmluZyhzdHIpIHsKICB2YXIgbGVuZ3RoID0gc3RyLmxlbmd0aCwKICAgICAgc3RyQnVmID0gW107CgogIGlmIChzdHJbMF0gPT09ICJceEZFIiAmJiBzdHJbMV0gPT09ICJceEZGIikgewogICAgZm9yICh2YXIgaSA9IDI7IGkgPCBsZW5ndGg7IGkgKz0gMikgewogICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHN0ci5jaGFyQ29kZUF0KGkpIDw8IDggfCBzdHIuY2hhckNvZGVBdChpICsgMSkpKTsKICAgIH0KICB9IGVsc2UgaWYgKHN0clswXSA9PT0gIlx4RkYiICYmIHN0clsxXSA9PT0gIlx4RkUiKSB7CiAgICBmb3IgKHZhciBfaTIgPSAyOyBfaTIgPCBsZW5ndGg7IF9pMiArPSAyKSB7CiAgICAgIHN0ckJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoc3RyLmNoYXJDb2RlQXQoX2kyICsgMSkgPDwgOCB8IHN0ci5jaGFyQ29kZUF0KF9pMikpKTsKICAgIH0KICB9IGVsc2UgewogICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgbGVuZ3RoOyArK19pMykgewogICAgICB2YXIgY29kZSA9IFBERlN0cmluZ1RyYW5zbGF0ZVRhYmxlW3N0ci5jaGFyQ29kZUF0KF9pMyldOwogICAgICBzdHJCdWYucHVzaChjb2RlID8gU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlKSA6IHN0ci5jaGFyQXQoX2kzKSk7CiAgICB9CiAgfQoKICByZXR1cm4gc3RyQnVmLmpvaW4oIiIpOwp9CgpmdW5jdGlvbiBzdHJpbmdUb1VURjhTdHJpbmcoc3RyKSB7CiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoc3RyKSk7Cn0KCmZ1bmN0aW9uIHV0ZjhTdHJpbmdUb1N0cmluZyhzdHIpIHsKICByZXR1cm4gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cikpOwp9CgpmdW5jdGlvbiBpc0VtcHR5T2JqKG9iaikgewogIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHJldHVybiB0cnVlOwp9CgpmdW5jdGlvbiBpc0Jvb2wodikgewogIHJldHVybiB0eXBlb2YgdiA9PT0gImJvb2xlYW4iOwp9CgpmdW5jdGlvbiBpc051bSh2KSB7CiAgcmV0dXJuIHR5cGVvZiB2ID09PSAibnVtYmVyIjsKfQoKZnVuY3Rpb24gaXNTdHJpbmcodikgewogIHJldHVybiB0eXBlb2YgdiA9PT0gInN0cmluZyI7Cn0KCmZ1bmN0aW9uIGlzQXJyYXlCdWZmZXIodikgewogIHJldHVybiBfdHlwZW9mKHYpID09PSAib2JqZWN0IiAmJiB2ICE9PSBudWxsICYmIHYuYnl0ZUxlbmd0aCAhPT0gdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBpc0FycmF5RXF1YWwoYXJyMSwgYXJyMikgewogIGlmIChhcnIxLmxlbmd0aCAhPT0gYXJyMi5sZW5ndGgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHJldHVybiBhcnIxLmV2ZXJ5KGZ1bmN0aW9uIChlbGVtZW50LCBpbmRleCkgewogICAgcmV0dXJuIGVsZW1lbnQgPT09IGFycjJbaW5kZXhdOwogIH0pOwp9CgpmdW5jdGlvbiBjcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSgpIHsKICB2YXIgY2FwYWJpbGl0eSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgdmFyIGlzU2V0dGxlZCA9IGZhbHNlOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjYXBhYmlsaXR5LCAic2V0dGxlZCIsIHsKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gaXNTZXR0bGVkOwogICAgfQogIH0pOwogIGNhcGFiaWxpdHkucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIGNhcGFiaWxpdHkucmVzb2x2ZSA9IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIGlzU2V0dGxlZCA9IHRydWU7CiAgICAgIHJlc29sdmUoZGF0YSk7CiAgICB9OwoKICAgIGNhcGFiaWxpdHkucmVqZWN0ID0gZnVuY3Rpb24gKHJlYXNvbikgewogICAgICBpc1NldHRsZWQgPSB0cnVlOwogICAgICByZWplY3QocmVhc29uKTsKICAgIH07CiAgfSk7CiAgcmV0dXJuIGNhcGFiaWxpdHk7Cn0KCnZhciBjcmVhdGVPYmplY3RVUkwgPSBmdW5jdGlvbiBjcmVhdGVPYmplY3RVUkxDbG9zdXJlKCkgewogIHZhciBkaWdpdHMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iOwogIHJldHVybiBmdW5jdGlvbiBjcmVhdGVPYmplY3RVUkwoZGF0YSwgY29udGVudFR5cGUpIHsKICAgIHZhciBmb3JjZURhdGFTY2hlbWEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwoKICAgIGlmICghZm9yY2VEYXRhU2NoZW1hICYmIFVSTC5jcmVhdGVPYmplY3RVUkwpIHsKICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbZGF0YV0sIHsKICAgICAgICB0eXBlOiBjb250ZW50VHlwZQogICAgICB9KTsKICAgICAgcmV0dXJuIFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICB9CgogICAgdmFyIGJ1ZmZlciA9ICJkYXRhOiIuY29uY2F0KGNvbnRlbnRUeXBlLCAiO2Jhc2U2NCwiKTsKCiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBkYXRhLmxlbmd0aDsgaSA8IGlpOyBpICs9IDMpIHsKICAgICAgdmFyIGIxID0gZGF0YVtpXSAmIDB4ZmY7CiAgICAgIHZhciBiMiA9IGRhdGFbaSArIDFdICYgMHhmZjsKICAgICAgdmFyIGIzID0gZGF0YVtpICsgMl0gJiAweGZmOwogICAgICB2YXIgZDEgPSBiMSA+PiAyLAogICAgICAgICAgZDIgPSAoYjEgJiAzKSA8PCA0IHwgYjIgPj4gNDsKICAgICAgdmFyIGQzID0gaSArIDEgPCBpaSA/IChiMiAmIDB4ZikgPDwgMiB8IGIzID4+IDYgOiA2NDsKICAgICAgdmFyIGQ0ID0gaSArIDIgPCBpaSA/IGIzICYgMHgzZiA6IDY0OwogICAgICBidWZmZXIgKz0gZGlnaXRzW2QxXSArIGRpZ2l0c1tkMl0gKyBkaWdpdHNbZDNdICsgZGlnaXRzW2Q0XTsKICAgIH0KCiAgICByZXR1cm4gYnVmZmVyOwogIH07Cn0oKTsKCmV4cG9ydHMuY3JlYXRlT2JqZWN0VVJMID0gY3JlYXRlT2JqZWN0VVJMOwoKLyoqKi8gfSksCi8qIDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCnZhciBfaXNfbm9kZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNyk7CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gInVuZGVmaW5lZCIgfHwgIWdsb2JhbFRoaXMuX3BkZmpzQ29tcGF0aWJpbGl0eUNoZWNrZWQpIHsKICBpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICJ1bmRlZmluZWQiIHx8IGdsb2JhbFRoaXMuTWF0aCAhPT0gTWF0aCkgewogICAgZ2xvYmFsVGhpcyA9IF9fd19wZGZqc19yZXF1aXJlX18oOCk7CiAgfQoKICBnbG9iYWxUaGlzLl9wZGZqc0NvbXBhdGliaWxpdHlDaGVja2VkID0gdHJ1ZTsKICB2YXIgaGFzRE9NID0gKHR5cGVvZiB3aW5kb3cgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKHdpbmRvdykpID09PSAib2JqZWN0IiAmJiAodHlwZW9mIGRvY3VtZW50ID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihkb2N1bWVudCkpID09PSAib2JqZWN0IjsKICB2YXIgdXNlckFnZW50ID0gdHlwZW9mIG5hdmlnYXRvciAhPT0gInVuZGVmaW5lZCIgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCAiIjsKICB2YXIgaXNJRSA9IC9UcmlkZW50Ly50ZXN0KHVzZXJBZ2VudCk7CgogIChmdW5jdGlvbiBjaGVja05vZGVCdG9hKCkgewogICAgaWYgKGdsb2JhbFRoaXMuYnRvYSB8fCAhX2lzX25vZGUuaXNOb2RlSlMpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGdsb2JhbFRoaXMuYnRvYSA9IGZ1bmN0aW9uIChjaGFycykgewogICAgICByZXR1cm4gQnVmZmVyLmZyb20oY2hhcnMsICJiaW5hcnkiKS50b1N0cmluZygiYmFzZTY0Iik7CiAgICB9OwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja05vZGVBdG9iKCkgewogICAgaWYgKGdsb2JhbFRoaXMuYXRvYiB8fCAhX2lzX25vZGUuaXNOb2RlSlMpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGdsb2JhbFRoaXMuYXRvYiA9IGZ1bmN0aW9uIChpbnB1dCkgewogICAgICByZXR1cm4gQnVmZmVyLmZyb20oaW5wdXQsICJiYXNlNjQiKS50b1N0cmluZygiYmluYXJ5Iik7CiAgICB9OwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja0NoaWxkTm9kZVJlbW92ZSgpIHsKICAgIGlmICghaGFzRE9NKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodHlwZW9mIEVsZW1lbnQucHJvdG90eXBlLnJlbW92ZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIEVsZW1lbnQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMucGFyZW50Tm9kZSkgewogICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzKTsKICAgICAgfQogICAgfTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tET01Ub2tlbkxpc3RBZGRSZW1vdmUoKSB7CiAgICBpZiAoIWhhc0RPTSB8fCBfaXNfbm9kZS5pc05vZGVKUykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgZGl2LmNsYXNzTGlzdC5hZGQoInRlc3RPbmUiLCAidGVzdFR3byIpOwoKICAgIGlmIChkaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCJ0ZXN0T25lIikgPT09IHRydWUgJiYgZGl2LmNsYXNzTGlzdC5jb250YWlucygidGVzdFR3byIpID09PSB0cnVlKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgT3JpZ2luYWxET01Ub2tlbkxpc3RBZGQgPSBET01Ub2tlbkxpc3QucHJvdG90eXBlLmFkZDsKICAgIHZhciBPcmlnaW5hbERPTVRva2VuTGlzdFJlbW92ZSA9IERPTVRva2VuTGlzdC5wcm90b3R5cGUucmVtb3ZlOwoKICAgIERPTVRva2VuTGlzdC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKCkgewogICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgdG9rZW5zID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgIHRva2Vuc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgX2kgPSAwLCBfdG9rZW5zID0gdG9rZW5zOyBfaSA8IF90b2tlbnMubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgdmFyIHRva2VuID0gX3Rva2Vuc1tfaV07CiAgICAgICAgT3JpZ2luYWxET01Ub2tlbkxpc3RBZGQuY2FsbCh0aGlzLCB0b2tlbik7CiAgICAgIH0KICAgIH07CgogICAgRE9NVG9rZW5MaXN0LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgdG9rZW5zID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7CiAgICAgICAgdG9rZW5zW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgICAgIH0KCiAgICAgIGZvciAodmFyIF9pMiA9IDAsIF90b2tlbnMyID0gdG9rZW5zOyBfaTIgPCBfdG9rZW5zMi5sZW5ndGg7IF9pMisrKSB7CiAgICAgICAgdmFyIHRva2VuID0gX3Rva2VuczJbX2kyXTsKICAgICAgICBPcmlnaW5hbERPTVRva2VuTGlzdFJlbW92ZS5jYWxsKHRoaXMsIHRva2VuKTsKICAgICAgfQogICAgfTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tET01Ub2tlbkxpc3RUb2dnbGUoKSB7CiAgICBpZiAoIWhhc0RPTSB8fCBfaXNfbm9kZS5pc05vZGVKUykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwoKICAgIGlmIChkaXYuY2xhc3NMaXN0LnRvZ2dsZSgidGVzdCIsIDApID09PSBmYWxzZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgRE9NVG9rZW5MaXN0LnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiAodG9rZW4pIHsKICAgICAgdmFyIGZvcmNlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyAhIWFyZ3VtZW50c1sxXSA6ICF0aGlzLmNvbnRhaW5zKHRva2VuKTsKICAgICAgcmV0dXJuIHRoaXNbZm9yY2UgPyAiYWRkIiA6ICJyZW1vdmUiXSh0b2tlbiksIGZvcmNlOwogICAgfTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tXaW5kb3dIaXN0b3J5UHVzaFN0YXRlUmVwbGFjZVN0YXRlKCkgewogICAgaWYgKCFoYXNET00gfHwgIWlzSUUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBPcmlnaW5hbFB1c2hTdGF0ZSA9IHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZTsKICAgIHZhciBPcmlnaW5hbFJlcGxhY2VTdGF0ZSA9IHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZTsKCiAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUgPSBmdW5jdGlvbiAoc3RhdGUsIHRpdGxlLCB1cmwpIHsKICAgICAgdmFyIGFyZ3MgPSB1cmwgPT09IHVuZGVmaW5lZCA/IFtzdGF0ZSwgdGl0bGVdIDogW3N0YXRlLCB0aXRsZSwgdXJsXTsKICAgICAgT3JpZ2luYWxQdXNoU3RhdGUuYXBwbHkodGhpcywgYXJncyk7CiAgICB9OwoKICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSwgdGl0bGUsIHVybCkgewogICAgICB2YXIgYXJncyA9IHVybCA9PT0gdW5kZWZpbmVkID8gW3N0YXRlLCB0aXRsZV0gOiBbc3RhdGUsIHRpdGxlLCB1cmxdOwogICAgICBPcmlnaW5hbFJlcGxhY2VTdGF0ZS5hcHBseSh0aGlzLCBhcmdzKTsKICAgIH07CiAgfSkoKTsKCiAgKGZ1bmN0aW9uIGNoZWNrU3RyaW5nU3RhcnRzV2l0aCgpIHsKICAgIGlmIChTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGgpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIF9fd19wZGZqc19yZXF1aXJlX18oNTMpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1N0cmluZ0VuZHNXaXRoKCkgewogICAgaWYgKFN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGgpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIF9fd19wZGZqc19yZXF1aXJlX18oNjQpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1N0cmluZ0luY2x1ZGVzKCkgewogICAgaWYgKFN0cmluZy5wcm90b3R5cGUuaW5jbHVkZXMpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIF9fd19wZGZqc19yZXF1aXJlX18oNjYpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja0FycmF5SW5jbHVkZXMoKSB7CiAgICBpZiAoQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBfX3dfcGRmanNfcmVxdWlyZV9fKDY4KTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tBcnJheUZyb20oKSB7CiAgICBpZiAoQXJyYXkuZnJvbSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgX193X3BkZmpzX3JlcXVpcmVfXyg3Nik7CiAgfSkoKTsKCiAgKGZ1bmN0aW9uIGNoZWNrT2JqZWN0QXNzaWduKCkgewogICAgaWYgKE9iamVjdC5hc3NpZ24pIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIF9fd19wZGZqc19yZXF1aXJlX18oOTgpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja01hdGhMb2cyKCkgewogICAgaWYgKE1hdGgubG9nMikgewogICAgICByZXR1cm47CiAgICB9CgogICAgTWF0aC5sb2cyID0gX193X3BkZmpzX3JlcXVpcmVfXygxMDEpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja051bWJlcklzTmFOKCkgewogICAgaWYgKE51bWJlci5pc05hTikgewogICAgICByZXR1cm47CiAgICB9CgogICAgTnVtYmVyLmlzTmFOID0gX193X3BkZmpzX3JlcXVpcmVfXygxMDMpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja051bWJlcklzSW50ZWdlcigpIHsKICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBOdW1iZXIuaXNJbnRlZ2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygxMDUpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1R5cGVkQXJyYXlTbGljZSgpIHsKICAgIGlmIChVaW50OEFycmF5LnByb3RvdHlwZS5zbGljZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgX193X3BkZmpzX3JlcXVpcmVfXygxMDgpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1Byb21pc2UoKSB7CiAgICBpZiAoZ2xvYmFsVGhpcy5Qcm9taXNlICYmIGdsb2JhbFRoaXMuUHJvbWlzZS5hbGxTZXR0bGVkKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBnbG9iYWxUaGlzLlByb21pc2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExMyk7CiAgfSkoKTsKCiAgKGZ1bmN0aW9uIGNoZWNrVVJMKCkgewogICAgZ2xvYmFsVGhpcy5VUkwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzNik7CiAgfSkoKTsKCiAgKGZ1bmN0aW9uIGNoZWNrUmVhZGFibGVTdHJlYW0oKSB7CiAgICB2YXIgaXNSZWFkYWJsZVN0cmVhbVN1cHBvcnRlZCA9IGZhbHNlOwoKICAgIGlmICh0eXBlb2YgUmVhZGFibGVTdHJlYW0gIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHRyeSB7CiAgICAgICAgbmV3IFJlYWRhYmxlU3RyZWFtKHsKICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbiBzdGFydChjb250cm9sbGVyKSB7CiAgICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBpc1JlYWRhYmxlU3RyZWFtU3VwcG9ydGVkID0gdHJ1ZTsKICAgICAgfSBjYXRjaCAoZSkge30KICAgIH0KCiAgICBpZiAoaXNSZWFkYWJsZVN0cmVhbVN1cHBvcnRlZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5SZWFkYWJsZVN0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQzKS5SZWFkYWJsZVN0cmVhbTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tNYXBFbnRyaWVzKCkgewogICAgaWYgKGdsb2JhbFRoaXMuTWFwICYmIGdsb2JhbFRoaXMuTWFwLnByb3RvdHlwZS5lbnRyaWVzKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBnbG9iYWxUaGlzLk1hcCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ0KTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tTZXRFbnRyaWVzKCkgewogICAgaWYgKGdsb2JhbFRoaXMuU2V0ICYmIGdsb2JhbFRoaXMuU2V0LnByb3RvdHlwZS5lbnRyaWVzKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBnbG9iYWxUaGlzLlNldCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUxKTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tXZWFrTWFwKCkgewogICAgaWYgKGdsb2JhbFRoaXMuV2Vha01hcCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5XZWFrTWFwID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTMpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1dlYWtTZXQoKSB7CiAgICBpZiAoZ2xvYmFsVGhpcy5XZWFrU2V0KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBnbG9iYWxUaGlzLldlYWtTZXQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1OSk7CiAgfSkoKTsKCiAgKGZ1bmN0aW9uIGNoZWNrU3RyaW5nQ29kZVBvaW50QXQoKSB7CiAgICBpZiAoU3RyaW5nLnByb3RvdHlwZS5jb2RlUG9pbnRBdCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgX193X3BkZmpzX3JlcXVpcmVfXygxNjEpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1N0cmluZ0Zyb21Db2RlUG9pbnQoKSB7CiAgICBpZiAoU3RyaW5nLmZyb21Db2RlUG9pbnQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIFN0cmluZy5mcm9tQ29kZVBvaW50ID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjMpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1N5bWJvbCgpIHsKICAgIGlmIChnbG9iYWxUaGlzLlN5bWJvbCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgX193X3BkZmpzX3JlcXVpcmVfXygxNjUpOwogIH0pKCk7CgogIChmdW5jdGlvbiBjaGVja1N0cmluZ1BhZFN0YXJ0KCkgewogICAgaWYgKFN0cmluZy5wcm90b3R5cGUucGFkU3RhcnQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIF9fd19wZGZqc19yZXF1aXJlX18oMTg4KTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tTdHJpbmdQYWRFbmQoKSB7CiAgICBpZiAoU3RyaW5nLnByb3RvdHlwZS5wYWRFbmQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIF9fd19wZGZqc19yZXF1aXJlX18oMTkzKTsKICB9KSgpOwoKICAoZnVuY3Rpb24gY2hlY2tPYmplY3RWYWx1ZXMoKSB7CiAgICBpZiAoT2JqZWN0LnZhbHVlcykgewogICAgICByZXR1cm47CiAgICB9CgogICAgT2JqZWN0LnZhbHVlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk1KTsKICB9KSgpOwp9CgovKioqLyB9KSwKLyogNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmlzTm9kZUpTID0gdm9pZCAwOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9Cgp2YXIgaXNOb2RlSlMgPSAodHlwZW9mIHByb2Nlc3MgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKHByb2Nlc3MpKSA9PT0gIm9iamVjdCIgJiYgcHJvY2VzcyArICIiID09PSAiW29iamVjdCBwcm9jZXNzXSIgJiYgIXByb2Nlc3MudmVyc2lvbnMubncgJiYgIXByb2Nlc3MudmVyc2lvbnMuZWxlY3Ryb247CmV4cG9ydHMuaXNOb2RlSlMgPSBpc05vZGVKUzsKCi8qKiovIH0pLAovKiA4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCl9fd19wZGZqc19yZXF1aXJlX18oOSk7Cm1vZHVsZS5leHBvcnRzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CgovKioqLyB9KSwKLyogOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgJCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CiQoeyBnbG9iYWw6IHRydWUgfSwgeyBnbG9iYWxUaGlzOiBnbG9iYWwgfSk7CgovKioqLyB9KSwKLyogMTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxMikuZjsKdmFyIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjYpOwp2YXIgcmVkZWZpbmUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI5KTsKdmFyIHNldEdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzApOwp2YXIgY29weUNvbnN0cnVjdG9yUHJvcGVydGllcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNDApOwp2YXIgaXNGb3JjZWQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUyKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob3B0aW9ucywgc291cmNlKSB7CiB2YXIgVEFSR0VUID0gb3B0aW9ucy50YXJnZXQ7CiB2YXIgR0xPQkFMID0gb3B0aW9ucy5nbG9iYWw7CiB2YXIgU1RBVElDID0gb3B0aW9ucy5zdGF0OwogdmFyIEZPUkNFRCwgdGFyZ2V0LCBrZXksIHRhcmdldFByb3BlcnR5LCBzb3VyY2VQcm9wZXJ0eSwgZGVzY3JpcHRvcjsKIGlmIChHTE9CQUwpIHsKICB0YXJnZXQgPSBnbG9iYWw7CiB9IGVsc2UgaWYgKFNUQVRJQykgewogIHRhcmdldCA9IGdsb2JhbFtUQVJHRVRdIHx8IHNldEdsb2JhbChUQVJHRVQsIHt9KTsKIH0gZWxzZSB7CiAgdGFyZ2V0ID0gKGdsb2JhbFtUQVJHRVRdIHx8IHt9KS5wcm90b3R5cGU7CiB9CiBpZiAodGFyZ2V0KQogIGZvciAoa2V5IGluIHNvdXJjZSkgewogICBzb3VyY2VQcm9wZXJ0eSA9IHNvdXJjZVtrZXldOwogICBpZiAob3B0aW9ucy5ub1RhcmdldEdldCkgewogICAgZGVzY3JpcHRvciA9IGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSk7CiAgICB0YXJnZXRQcm9wZXJ0eSA9IGRlc2NyaXB0b3IgJiYgZGVzY3JpcHRvci52YWx1ZTsKICAgfSBlbHNlCiAgICB0YXJnZXRQcm9wZXJ0eSA9IHRhcmdldFtrZXldOwogICBGT1JDRUQgPSBpc0ZvcmNlZChHTE9CQUwgPyBrZXkgOiBUQVJHRVQgKyAoU1RBVElDID8gJy4nIDogJyMnKSArIGtleSwgb3B0aW9ucy5mb3JjZWQpOwogICBpZiAoIUZPUkNFRCAmJiB0YXJnZXRQcm9wZXJ0eSAhPT0gdW5kZWZpbmVkKSB7CiAgICBpZiAodHlwZW9mIHNvdXJjZVByb3BlcnR5ID09PSB0eXBlb2YgdGFyZ2V0UHJvcGVydHkpCiAgICAgY29udGludWU7CiAgICBjb3B5Q29uc3RydWN0b3JQcm9wZXJ0aWVzKHNvdXJjZVByb3BlcnR5LCB0YXJnZXRQcm9wZXJ0eSk7CiAgIH0KICAgaWYgKG9wdGlvbnMuc2hhbSB8fCB0YXJnZXRQcm9wZXJ0eSAmJiB0YXJnZXRQcm9wZXJ0eS5zaGFtKSB7CiAgICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkoc291cmNlUHJvcGVydHksICdzaGFtJywgdHJ1ZSk7CiAgIH0KICAgcmVkZWZpbmUodGFyZ2V0LCBrZXksIHNvdXJjZVByb3BlcnR5LCBvcHRpb25zKTsKICB9Cn07CgovKioqLyB9KSwKLyogMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGNoZWNrID0gZnVuY3Rpb24gKGl0KSB7CiByZXR1cm4gaXQgJiYgaXQuTWF0aCA9PSBNYXRoICYmIGl0Owp9Owptb2R1bGUuZXhwb3J0cyA9IGNoZWNrKHR5cGVvZiBnbG9iYWxUaGlzID09ICdvYmplY3QnICYmIGdsb2JhbFRoaXMpIHx8IGNoZWNrKHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgd2luZG93KSB8fCBjaGVjayh0eXBlb2Ygc2VsZiA9PSAnb2JqZWN0JyAmJiBzZWxmKSB8fCBjaGVjayh0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGdsb2JhbCkgfHwgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsKCi8qKiovIH0pLAovKiAxMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgREVTQ1JJUFRPUlMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzKTsKdmFyIHByb3BlcnR5SXNFbnVtZXJhYmxlTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNSk7CnZhciBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2KTsKdmFyIHRvSW5kZXhlZE9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcpOwp2YXIgdG9QcmltaXRpdmUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxKTsKdmFyIGhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgSUU4X0RPTV9ERUZJTkUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI0KTsKdmFyIG5hdGl2ZUdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CmV4cG9ydHMuZiA9IERFU0NSSVBUT1JTID8gbmF0aXZlR2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIDogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApIHsKIE8gPSB0b0luZGV4ZWRPYmplY3QoTyk7CiBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7CiBpZiAoSUU4X0RPTV9ERUZJTkUpCiAgdHJ5IHsKICAgcmV0dXJuIG5hdGl2ZUdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKTsKICB9IGNhdGNoIChlcnJvcikgewogIH0KIGlmIChoYXMoTywgUCkpCiAgcmV0dXJuIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvcighcHJvcGVydHlJc0VudW1lcmFibGVNb2R1bGUuZi5jYWxsKE8sIFApLCBPW1BdKTsKfTsKCi8qKiovIH0pLAovKiAxMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZmFpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKbW9kdWxlLmV4cG9ydHMgPSAhZmFpbHMoZnVuY3Rpb24gKCkgewogcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgMSwgewogIGdldDogZnVuY3Rpb24gKCkgewogICByZXR1cm4gNzsKICB9CiB9KVsxXSAhPSA3Owp9KTsKCi8qKiovIH0pLAovKiAxNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChleGVjKSB7CiB0cnkgewogIHJldHVybiAhIWV4ZWMoKTsKIH0gY2F0Y2ggKGVycm9yKSB7CiAgcmV0dXJuIHRydWU7CiB9Cn07CgovKioqLyB9KSwKLyogMTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIG5hdGl2ZVByb3BlcnR5SXNFbnVtZXJhYmxlID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7CnZhciBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOwp2YXIgTkFTSE9STl9CVUcgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgJiYgIW5hdGl2ZVByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoeyAxOiAyIH0sIDEpOwpleHBvcnRzLmYgPSBOQVNIT1JOX0JVRyA/IGZ1bmN0aW9uIHByb3BlcnR5SXNFbnVtZXJhYmxlKFYpIHsKIHZhciBkZXNjcmlwdG9yID0gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRoaXMsIFYpOwogcmV0dXJuICEhZGVzY3JpcHRvciAmJiBkZXNjcmlwdG9yLmVudW1lcmFibGU7Cn0gOiBuYXRpdmVQcm9wZXJ0eUlzRW51bWVyYWJsZTsKCi8qKiovIH0pLAovKiAxNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChiaXRtYXAsIHZhbHVlKSB7CiByZXR1cm4gewogIGVudW1lcmFibGU6ICEoYml0bWFwICYgMSksCiAgY29uZmlndXJhYmxlOiAhKGJpdG1hcCAmIDIpLAogIHdyaXRhYmxlOiAhKGJpdG1hcCAmIDQpLAogIHZhbHVlOiB2YWx1ZQogfTsKfTsKCi8qKiovIH0pLAovKiAxNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgSW5kZXhlZE9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgpOwp2YXIgcmVxdWlyZU9iamVjdENvZXJjaWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjApOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIEluZGV4ZWRPYmplY3QocmVxdWlyZU9iamVjdENvZXJjaWJsZShpdCkpOwp9OwoKLyoqKi8gfSksCi8qIDE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBmYWlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQpOwp2YXIgY2xhc3NvZiA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkpOwp2YXIgc3BsaXQgPSAnJy5zcGxpdDsKbW9kdWxlLmV4cG9ydHMgPSBmYWlscyhmdW5jdGlvbiAoKSB7CiByZXR1cm4gIU9iamVjdCgneicpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApOwp9KSA/IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIGNsYXNzb2YoaXQpID09ICdTdHJpbmcnID8gc3BsaXQuY2FsbChpdCwgJycpIDogT2JqZWN0KGl0KTsKfSA6IE9iamVjdDsKCi8qKiovIH0pLAovKiAxOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZzsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7Cn07CgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIGlmIChpdCA9PSB1bmRlZmluZWQpCiAgdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAiICsgaXQpOwogcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBpc09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjIpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpbnB1dCwgUFJFRkVSUkVEX1NUUklORykgewogaWYgKCFpc09iamVjdChpbnB1dCkpCiAgcmV0dXJuIGlucHV0OwogdmFyIGZuLCB2YWw7CiBpZiAoUFJFRkVSUkVEX1NUUklORyAmJiB0eXBlb2YgKGZuID0gaW5wdXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaW5wdXQpKSkKICByZXR1cm4gdmFsOwogaWYgKHR5cGVvZiAoZm4gPSBpbnB1dC52YWx1ZU9mKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGlucHV0KSkpCiAgcmV0dXJuIHZhbDsKIGlmICghUFJFRkVSUkVEX1NUUklORyAmJiB0eXBlb2YgKGZuID0gaW5wdXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaW5wdXQpKSkKICByZXR1cm4gdmFsOwogdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKTsKfTsKCi8qKiovIH0pLAovKiAyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIHR5cGVvZiBpdCA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJzsKfTsKCi8qKiovIH0pLAovKiAyMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgp2YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQsIGtleSkgewogcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoaXQsIGtleSk7Cn07CgovKioqLyB9KSwKLyogMjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMyk7CnZhciBmYWlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQpOwp2YXIgY3JlYXRlRWxlbWVudCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjUpOwptb2R1bGUuZXhwb3J0cyA9ICFERVNDUklQVE9SUyAmJiAhZmFpbHMoZnVuY3Rpb24gKCkgewogcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjcmVhdGVFbGVtZW50KCdkaXYnKSwgJ2EnLCB7CiAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgIHJldHVybiA3OwogIH0KIH0pLmEgIT0gNzsKfSk7CgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGRvY3VtZW50ID0gZ2xvYmFsLmRvY3VtZW50Owp2YXIgRVhJU1RTID0gaXNPYmplY3QoZG9jdW1lbnQpICYmIGlzT2JqZWN0KGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIEVYSVNUUyA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXQpIDoge307Cn07CgovKioqLyB9KSwKLyogMjYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMyk7CnZhciBkZWZpbmVQcm9wZXJ0eU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjcpOwp2YXIgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxNik7Cm1vZHVsZS5leHBvcnRzID0gREVTQ1JJUFRPUlMgPyBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7CiByZXR1cm4gZGVmaW5lUHJvcGVydHlNb2R1bGUuZihvYmplY3QsIGtleSwgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKDEsIHZhbHVlKSk7Cn0gOiBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7CiBvYmplY3Rba2V5XSA9IHZhbHVlOwogcmV0dXJuIG9iamVjdDsKfTsKCi8qKiovIH0pLAovKiAyNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgREVTQ1JJUFRPUlMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzKTsKdmFyIElFOF9ET01fREVGSU5FID0gX193X3BkZmpzX3JlcXVpcmVfXygyNCk7CnZhciBhbk9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjgpOwp2YXIgdG9QcmltaXRpdmUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxKTsKdmFyIG5hdGl2ZURlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwpleHBvcnRzLmYgPSBERVNDUklQVE9SUyA/IG5hdGl2ZURlZmluZVByb3BlcnR5IDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykgewogYW5PYmplY3QoTyk7CiBQID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSk7CiBhbk9iamVjdChBdHRyaWJ1dGVzKTsKIGlmIChJRThfRE9NX0RFRklORSkKICB0cnkgewogICByZXR1cm4gbmF0aXZlRGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcyk7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICB9CiBpZiAoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKQogIHRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQnKTsKIGlmICgndmFsdWUnIGluIEF0dHJpYnV0ZXMpCiAgT1tQXSA9IEF0dHJpYnV0ZXMudmFsdWU7CiByZXR1cm4gTzsKfTsKCi8qKiovIH0pLAovKiAyOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIGlmICghaXNPYmplY3QoaXQpKSB7CiAgdGhyb3cgVHlwZUVycm9yKFN0cmluZyhpdCkgKyAnIGlzIG5vdCBhbiBvYmplY3QnKTsKIH0KIHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiAyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI2KTsKdmFyIGhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgc2V0R2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygzMCk7CnZhciBpbnNwZWN0U291cmNlID0gX193X3BkZmpzX3JlcXVpcmVfXygzMSk7CnZhciBJbnRlcm5hbFN0YXRlTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygzMyk7CnZhciBnZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5nZXQ7CnZhciBlbmZvcmNlSW50ZXJuYWxTdGF0ZSA9IEludGVybmFsU3RhdGVNb2R1bGUuZW5mb3JjZTsKdmFyIFRFTVBMQVRFID0gU3RyaW5nKFN0cmluZykuc3BsaXQoJ1N0cmluZycpOwoobW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTywga2V5LCB2YWx1ZSwgb3B0aW9ucykgewogdmFyIHVuc2FmZSA9IG9wdGlvbnMgPyAhIW9wdGlvbnMudW5zYWZlIDogZmFsc2U7CiB2YXIgc2ltcGxlID0gb3B0aW9ucyA/ICEhb3B0aW9ucy5lbnVtZXJhYmxlIDogZmFsc2U7CiB2YXIgbm9UYXJnZXRHZXQgPSBvcHRpb25zID8gISFvcHRpb25zLm5vVGFyZ2V0R2V0IDogZmFsc2U7CiBpZiAodHlwZW9mIHZhbHVlID09ICdmdW5jdGlvbicpIHsKICBpZiAodHlwZW9mIGtleSA9PSAnc3RyaW5nJyAmJiAhaGFzKHZhbHVlLCAnbmFtZScpKQogICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkodmFsdWUsICduYW1lJywga2V5KTsKICBlbmZvcmNlSW50ZXJuYWxTdGF0ZSh2YWx1ZSkuc291cmNlID0gVEVNUExBVEUuam9pbih0eXBlb2Yga2V5ID09ICdzdHJpbmcnID8ga2V5IDogJycpOwogfQogaWYgKE8gPT09IGdsb2JhbCkgewogIGlmIChzaW1wbGUpCiAgIE9ba2V5XSA9IHZhbHVlOwogIGVsc2UKICAgc2V0R2xvYmFsKGtleSwgdmFsdWUpOwogIHJldHVybjsKIH0gZWxzZSBpZiAoIXVuc2FmZSkgewogIGRlbGV0ZSBPW2tleV07CiB9IGVsc2UgaWYgKCFub1RhcmdldEdldCAmJiBPW2tleV0pIHsKICBzaW1wbGUgPSB0cnVlOwogfQogaWYgKHNpbXBsZSkKICBPW2tleV0gPSB2YWx1ZTsKIGVsc2UKICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkoTywga2V5LCB2YWx1ZSk7Cn0pKEZ1bmN0aW9uLnByb3RvdHlwZSwgJ3RvU3RyaW5nJywgZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiByZXR1cm4gdHlwZW9mIHRoaXMgPT0gJ2Z1bmN0aW9uJyAmJiBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpLnNvdXJjZSB8fCBpbnNwZWN0U291cmNlKHRoaXMpOwp9KTsKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI2KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogdHJ5IHsKICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkoZ2xvYmFsLCBrZXksIHZhbHVlKTsKIH0gY2F0Y2ggKGVycm9yKSB7CiAgZ2xvYmFsW2tleV0gPSB2YWx1ZTsKIH0KIHJldHVybiB2YWx1ZTsKfTsKCi8qKiovIH0pLAovKiAzMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgc3RvcmUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDMyKTsKdmFyIGZ1bmN0aW9uVG9TdHJpbmcgPSBGdW5jdGlvbi50b1N0cmluZzsKaWYgKHR5cGVvZiBzdG9yZS5pbnNwZWN0U291cmNlICE9ICdmdW5jdGlvbicpIHsKIHN0b3JlLmluc3BlY3RTb3VyY2UgPSBmdW5jdGlvbiAoaXQpIHsKICByZXR1cm4gZnVuY3Rpb25Ub1N0cmluZy5jYWxsKGl0KTsKIH07Cn0KbW9kdWxlLmV4cG9ydHMgPSBzdG9yZS5pbnNwZWN0U291cmNlOwoKLyoqKi8gfSksCi8qIDMyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIHNldEdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzApOwp2YXIgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXyc7CnZhciBzdG9yZSA9IGdsb2JhbFtTSEFSRURdIHx8IHNldEdsb2JhbChTSEFSRUQsIHt9KTsKbW9kdWxlLmV4cG9ydHMgPSBzdG9yZTsKCi8qKiovIH0pLAovKiAzMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgTkFUSVZFX1dFQUtfTUFQID0gX193X3BkZmpzX3JlcXVpcmVfXygzNCk7CnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIGlzT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMik7CnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI2KTsKdmFyIG9iamVjdEhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgc2hhcmVkS2V5ID0gX193X3BkZmpzX3JlcXVpcmVfXygzNSk7CnZhciBoaWRkZW5LZXlzID0gX193X3BkZmpzX3JlcXVpcmVfXygzOSk7CnZhciBXZWFrTWFwID0gZ2xvYmFsLldlYWtNYXA7CnZhciBzZXQsIGdldCwgaGFzOwp2YXIgZW5mb3JjZSA9IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIGhhcyhpdCkgPyBnZXQoaXQpIDogc2V0KGl0LCB7fSk7Cn07CnZhciBnZXR0ZXJGb3IgPSBmdW5jdGlvbiAoVFlQRSkgewogcmV0dXJuIGZ1bmN0aW9uIChpdCkgewogIHZhciBzdGF0ZTsKICBpZiAoIWlzT2JqZWN0KGl0KSB8fCAoc3RhdGUgPSBnZXQoaXQpKS50eXBlICE9PSBUWVBFKSB7CiAgIHRocm93IFR5cGVFcnJvcignSW5jb21wYXRpYmxlIHJlY2VpdmVyLCAnICsgVFlQRSArICcgcmVxdWlyZWQnKTsKICB9CiAgcmV0dXJuIHN0YXRlOwogfTsKfTsKaWYgKE5BVElWRV9XRUFLX01BUCkgewogdmFyIHN0b3JlID0gbmV3IFdlYWtNYXAoKTsKIHZhciB3bWdldCA9IHN0b3JlLmdldDsKIHZhciB3bWhhcyA9IHN0b3JlLmhhczsKIHZhciB3bXNldCA9IHN0b3JlLnNldDsKIHNldCA9IGZ1bmN0aW9uIChpdCwgbWV0YWRhdGEpIHsKICB3bXNldC5jYWxsKHN0b3JlLCBpdCwgbWV0YWRhdGEpOwogIHJldHVybiBtZXRhZGF0YTsKIH07CiBnZXQgPSBmdW5jdGlvbiAoaXQpIHsKICByZXR1cm4gd21nZXQuY2FsbChzdG9yZSwgaXQpIHx8IHt9OwogfTsKIGhhcyA9IGZ1bmN0aW9uIChpdCkgewogIHJldHVybiB3bWhhcy5jYWxsKHN0b3JlLCBpdCk7CiB9Owp9IGVsc2UgewogdmFyIFNUQVRFID0gc2hhcmVkS2V5KCdzdGF0ZScpOwogaGlkZGVuS2V5c1tTVEFURV0gPSB0cnVlOwogc2V0ID0gZnVuY3Rpb24gKGl0LCBtZXRhZGF0YSkgewogIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShpdCwgU1RBVEUsIG1ldGFkYXRhKTsKICByZXR1cm4gbWV0YWRhdGE7CiB9OwogZ2V0ID0gZnVuY3Rpb24gKGl0KSB7CiAgcmV0dXJuIG9iamVjdEhhcyhpdCwgU1RBVEUpID8gaXRbU1RBVEVdIDoge307CiB9OwogaGFzID0gZnVuY3Rpb24gKGl0KSB7CiAgcmV0dXJuIG9iamVjdEhhcyhpdCwgU1RBVEUpOwogfTsKfQptb2R1bGUuZXhwb3J0cyA9IHsKIHNldDogc2V0LAogZ2V0OiBnZXQsCiBoYXM6IGhhcywKIGVuZm9yY2U6IGVuZm9yY2UsCiBnZXR0ZXJGb3I6IGdldHRlckZvcgp9OwoKLyoqKi8gfSksCi8qIDM0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIGluc3BlY3RTb3VyY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDMxKTsKdmFyIFdlYWtNYXAgPSBnbG9iYWwuV2Vha01hcDsKbW9kdWxlLmV4cG9ydHMgPSB0eXBlb2YgV2Vha01hcCA9PT0gJ2Z1bmN0aW9uJyAmJiAvbmF0aXZlIGNvZGUvLnRlc3QoaW5zcGVjdFNvdXJjZShXZWFrTWFwKSk7CgovKioqLyB9KSwKLyogMzUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHNoYXJlZCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzYpOwp2YXIgdWlkID0gX193X3BkZmpzX3JlcXVpcmVfXygzOCk7CnZhciBrZXlzID0gc2hhcmVkKCdrZXlzJyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkgewogcmV0dXJuIGtleXNba2V5XSB8fCAoa2V5c1trZXldID0gdWlkKGtleSkpOwp9OwoKLyoqKi8gfSksCi8qIDM2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBJU19QVVJFID0gX193X3BkZmpzX3JlcXVpcmVfXygzNyk7CnZhciBzdG9yZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzIpOwoobW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiB7fSk7Cn0pKCd2ZXJzaW9ucycsIFtdKS5wdXNoKHsKIHZlcnNpb246ICczLjYuNScsCiBtb2RlOiBJU19QVVJFID8gJ3B1cmUnIDogJ2dsb2JhbCcsCiBjb3B5cmlnaHQ6ICfCqSAyMDIwIERlbmlzIFB1c2hrYXJldiAoemxvaXJvY2sucnUpJwp9KTsKCi8qKiovIH0pLAovKiAzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IGZhbHNlOwoKLyoqKi8gfSksCi8qIDM4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBpZCA9IDA7CnZhciBwb3N0Zml4ID0gTWF0aC5yYW5kb20oKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoa2V5KSB7CiByZXR1cm4gJ1N5bWJvbCgnICsgU3RyaW5nKGtleSA9PT0gdW5kZWZpbmVkID8gJycgOiBrZXkpICsgJylfJyArICgrK2lkICsgcG9zdGZpeCkudG9TdHJpbmcoMzYpOwp9OwoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0ge307CgovKioqLyB9KSwKLyogNDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgb3duS2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNDEpOwp2YXIgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMik7CnZhciBkZWZpbmVQcm9wZXJ0eU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0YXJnZXQsIHNvdXJjZSkgewogdmFyIGtleXMgPSBvd25LZXlzKHNvdXJjZSk7CiB2YXIgZGVmaW5lUHJvcGVydHkgPSBkZWZpbmVQcm9wZXJ0eU1vZHVsZS5mOwogdmFyIGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGdldE93blByb3BlcnR5RGVzY3JpcHRvck1vZHVsZS5mOwogZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7CiAgdmFyIGtleSA9IGtleXNbaV07CiAgaWYgKCFoYXModGFyZ2V0LCBrZXkpKQogICBkZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiB9Cn07CgovKioqLyB9KSwKLyogNDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGdldEJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQyKTsKdmFyIGdldE93blByb3BlcnR5TmFtZXNNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ0KTsKdmFyIGdldE93blByb3BlcnR5U3ltYm9sc01vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNTEpOwp2YXIgYW5PYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI4KTsKbW9kdWxlLmV4cG9ydHMgPSBnZXRCdWlsdEluKCdSZWZsZWN0JywgJ293bktleXMnKSB8fCBmdW5jdGlvbiBvd25LZXlzKGl0KSB7CiB2YXIga2V5cyA9IGdldE93blByb3BlcnR5TmFtZXNNb2R1bGUuZihhbk9iamVjdChpdCkpOwogdmFyIGdldE93blByb3BlcnR5U3ltYm9scyA9IGdldE93blByb3BlcnR5U3ltYm9sc01vZHVsZS5mOwogcmV0dXJuIGdldE93blByb3BlcnR5U3ltYm9scyA/IGtleXMuY29uY2F0KGdldE93blByb3BlcnR5U3ltYm9scyhpdCkpIDoga2V5czsKfTsKCi8qKiovIH0pLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgcGF0aCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDMpOwp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBhRnVuY3Rpb24gPSBmdW5jdGlvbiAodmFyaWFibGUpIHsKIHJldHVybiB0eXBlb2YgdmFyaWFibGUgPT0gJ2Z1bmN0aW9uJyA/IHZhcmlhYmxlIDogdW5kZWZpbmVkOwp9Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChuYW1lc3BhY2UsIG1ldGhvZCkgewogcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyID8gYUZ1bmN0aW9uKHBhdGhbbmFtZXNwYWNlXSkgfHwgYUZ1bmN0aW9uKGdsb2JhbFtuYW1lc3BhY2VdKSA6IHBhdGhbbmFtZXNwYWNlXSAmJiBwYXRoW25hbWVzcGFjZV1bbWV0aG9kXSB8fCBnbG9iYWxbbmFtZXNwYWNlXSAmJiBnbG9iYWxbbmFtZXNwYWNlXVttZXRob2RdOwp9OwoKLyoqKi8gfSksCi8qIDQzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKbW9kdWxlLmV4cG9ydHMgPSBnbG9iYWw7CgovKioqLyB9KSwKLyogNDQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGludGVybmFsT2JqZWN0S2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNDUpOwp2YXIgZW51bUJ1Z0tleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKdmFyIGhpZGRlbktleXMgPSBlbnVtQnVnS2V5cy5jb25jYXQoJ2xlbmd0aCcsICdwcm90b3R5cGUnKTsKZXhwb3J0cy5mID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhPKSB7CiByZXR1cm4gaW50ZXJuYWxPYmplY3RLZXlzKE8sIGhpZGRlbktleXMpOwp9OwoKLyoqKi8gfSksCi8qIDQ1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBoYXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIHRvSW5kZXhlZE9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcpOwp2YXIgaW5kZXhPZiA9IF9fd19wZGZqc19yZXF1aXJlX18oNDYpLmluZGV4T2Y7CnZhciBoaWRkZW5LZXlzID0gX193X3BkZmpzX3JlcXVpcmVfXygzOSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iamVjdCwgbmFtZXMpIHsKIHZhciBPID0gdG9JbmRleGVkT2JqZWN0KG9iamVjdCk7CiB2YXIgaSA9IDA7CiB2YXIgcmVzdWx0ID0gW107CiB2YXIga2V5OwogZm9yIChrZXkgaW4gTykKICAhaGFzKGhpZGRlbktleXMsIGtleSkgJiYgaGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTsKIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKQogIGlmIChoYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpIHsKICAgfmluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHJlc3VsdC5wdXNoKGtleSk7CiAgfQogcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiA0NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbmRleGVkT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygxNyk7CnZhciB0b0xlbmd0aCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDcpOwp2YXIgdG9BYnNvbHV0ZUluZGV4ID0gX193X3BkZmpzX3JlcXVpcmVfXyg0OSk7CnZhciBjcmVhdGVNZXRob2QgPSBmdW5jdGlvbiAoSVNfSU5DTFVERVMpIHsKIHJldHVybiBmdW5jdGlvbiAoJHRoaXMsIGVsLCBmcm9tSW5kZXgpIHsKICB2YXIgTyA9IHRvSW5kZXhlZE9iamVjdCgkdGhpcyk7CiAgdmFyIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKTsKICB2YXIgaW5kZXggPSB0b0Fic29sdXRlSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpOwogIHZhciB2YWx1ZTsKICBpZiAoSVNfSU5DTFVERVMgJiYgZWwgIT0gZWwpCiAgIHdoaWxlIChsZW5ndGggPiBpbmRleCkgewogICAgdmFsdWUgPSBPW2luZGV4KytdOwogICAgaWYgKHZhbHVlICE9IHZhbHVlKQogICAgIHJldHVybiB0cnVlOwogICB9CiAgZWxzZQogICBmb3IgKDsgbGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIHsKICAgIGlmICgoSVNfSU5DTFVERVMgfHwgaW5kZXggaW4gTykgJiYgT1tpbmRleF0gPT09IGVsKQogICAgIHJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwOwogICB9CiAgcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTsKIH07Cn07Cm1vZHVsZS5leHBvcnRzID0gewogaW5jbHVkZXM6IGNyZWF0ZU1ldGhvZCh0cnVlKSwKIGluZGV4T2Y6IGNyZWF0ZU1ldGhvZChmYWxzZSkKfTsKCi8qKiovIH0pLAovKiA0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgdG9JbnRlZ2VyID0gX193X3BkZmpzX3JlcXVpcmVfXyg0OCk7CnZhciBtaW4gPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXJndW1lbnQpIHsKIHJldHVybiBhcmd1bWVudCA+IDAgPyBtaW4odG9JbnRlZ2VyKGFyZ3VtZW50KSwgMHgxRkZGRkZGRkZGRkZGRikgOiAwOwp9OwoKLyoqKi8gfSksCi8qIDQ4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCnZhciBjZWlsID0gTWF0aC5jZWlsOwp2YXIgZmxvb3IgPSBNYXRoLmZsb29yOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcmd1bWVudCkgewogcmV0dXJuIGlzTmFOKGFyZ3VtZW50ID0gK2FyZ3VtZW50KSA/IDAgOiAoYXJndW1lbnQgPiAwID8gZmxvb3IgOiBjZWlsKShhcmd1bWVudCk7Cn07CgovKioqLyB9KSwKLyogNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHRvSW50ZWdlciA9IF9fd19wZGZqc19yZXF1aXJlX18oNDgpOwp2YXIgbWF4ID0gTWF0aC5tYXg7CnZhciBtaW4gPSBNYXRoLm1pbjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaW5kZXgsIGxlbmd0aCkgewogdmFyIGludGVnZXIgPSB0b0ludGVnZXIoaW5kZXgpOwogcmV0dXJuIGludGVnZXIgPCAwID8gbWF4KGludGVnZXIgKyBsZW5ndGgsIDApIDogbWluKGludGVnZXIsIGxlbmd0aCk7Cn07CgovKioqLyB9KSwKLyogNTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBbCiAnY29uc3RydWN0b3InLAogJ2hhc093blByb3BlcnR5JywKICdpc1Byb3RvdHlwZU9mJywKICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsCiAndG9Mb2NhbGVTdHJpbmcnLAogJ3RvU3RyaW5nJywKICd2YWx1ZU9mJwpdOwoKLyoqKi8gfSksCi8qIDUxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCmV4cG9ydHMuZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7CgovKioqLyB9KSwKLyogNTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7CnZhciByZXBsYWNlbWVudCA9IC8jfFwucHJvdG90eXBlXC4vOwp2YXIgaXNGb3JjZWQgPSBmdW5jdGlvbiAoZmVhdHVyZSwgZGV0ZWN0aW9uKSB7CiB2YXIgdmFsdWUgPSBkYXRhW25vcm1hbGl6ZShmZWF0dXJlKV07CiByZXR1cm4gdmFsdWUgPT0gUE9MWUZJTEwgPyB0cnVlIDogdmFsdWUgPT0gTkFUSVZFID8gZmFsc2UgOiB0eXBlb2YgZGV0ZWN0aW9uID09ICdmdW5jdGlvbicgPyBmYWlscyhkZXRlY3Rpb24pIDogISFkZXRlY3Rpb247Cn07CnZhciBub3JtYWxpemUgPSBpc0ZvcmNlZC5ub3JtYWxpemUgPSBmdW5jdGlvbiAoc3RyaW5nKSB7CiByZXR1cm4gU3RyaW5nKHN0cmluZykucmVwbGFjZShyZXBsYWNlbWVudCwgJy4nKS50b0xvd2VyQ2FzZSgpOwp9Owp2YXIgZGF0YSA9IGlzRm9yY2VkLmRhdGEgPSB7fTsKdmFyIE5BVElWRSA9IGlzRm9yY2VkLk5BVElWRSA9ICdOJzsKdmFyIFBPTFlGSUxMID0gaXNGb3JjZWQuUE9MWUZJTEwgPSAnUCc7Cm1vZHVsZS5leHBvcnRzID0gaXNGb3JjZWQ7CgovKioqLyB9KSwKLyogNTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKX193X3BkZmpzX3JlcXVpcmVfXyg1NCk7CnZhciBlbnRyeVVuYmluZCA9IF9fd19wZGZqc19yZXF1aXJlX18oNjEpOwptb2R1bGUuZXhwb3J0cyA9IGVudHJ5VW5iaW5kKCdTdHJpbmcnLCAnc3RhcnRzV2l0aCcpOwoKLyoqKi8gfSksCi8qIDU0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyKS5mOwp2YXIgdG9MZW5ndGggPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ3KTsKdmFyIG5vdEFSZWdFeHAgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU1KTsKdmFyIHJlcXVpcmVPYmplY3RDb2VyY2libGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwKTsKdmFyIGNvcnJlY3RJc1JlZ0V4cExvZ2ljID0gX193X3BkZmpzX3JlcXVpcmVfXyg2MCk7CnZhciBJU19QVVJFID0gX193X3BkZmpzX3JlcXVpcmVfXygzNyk7CnZhciBuYXRpdmVTdGFydHNXaXRoID0gJycuc3RhcnRzV2l0aDsKdmFyIG1pbiA9IE1hdGgubWluOwp2YXIgQ09SUkVDVF9JU19SRUdFWFBfTE9HSUMgPSBjb3JyZWN0SXNSZWdFeHBMb2dpYygnc3RhcnRzV2l0aCcpOwp2YXIgTUROX1BPTFlGSUxMX0JVRyA9ICFJU19QVVJFICYmICFDT1JSRUNUX0lTX1JFR0VYUF9MT0dJQyAmJiAhIWZ1bmN0aW9uICgpIHsKIHZhciBkZXNjcmlwdG9yID0gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKFN0cmluZy5wcm90b3R5cGUsICdzdGFydHNXaXRoJyk7CiByZXR1cm4gZGVzY3JpcHRvciAmJiAhZGVzY3JpcHRvci53cml0YWJsZTsKfSgpOwokKHsKIHRhcmdldDogJ1N0cmluZycsCiBwcm90bzogdHJ1ZSwKIGZvcmNlZDogIU1ETl9QT0xZRklMTF9CVUcgJiYgIUNPUlJFQ1RfSVNfUkVHRVhQX0xPR0lDCn0sIHsKIHN0YXJ0c1dpdGg6IGZ1bmN0aW9uIHN0YXJ0c1dpdGgoc2VhcmNoU3RyaW5nKSB7CiAgdmFyIHRoYXQgPSBTdHJpbmcocmVxdWlyZU9iamVjdENvZXJjaWJsZSh0aGlzKSk7CiAgbm90QVJlZ0V4cChzZWFyY2hTdHJpbmcpOwogIHZhciBpbmRleCA9IHRvTGVuZ3RoKG1pbihhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCwgdGhhdC5sZW5ndGgpKTsKICB2YXIgc2VhcmNoID0gU3RyaW5nKHNlYXJjaFN0cmluZyk7CiAgcmV0dXJuIG5hdGl2ZVN0YXJ0c1dpdGggPyBuYXRpdmVTdGFydHNXaXRoLmNhbGwodGhhdCwgc2VhcmNoLCBpbmRleCkgOiB0aGF0LnNsaWNlKGluZGV4LCBpbmRleCArIHNlYXJjaC5sZW5ndGgpID09PSBzZWFyY2g7CiB9Cn0pOwoKLyoqKi8gfSksCi8qIDU1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBpc1JlZ0V4cCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTYpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogaWYgKGlzUmVnRXhwKGl0KSkgewogIHRocm93IFR5cGVFcnJvcigiVGhlIG1ldGhvZCBkb2Vzbid0IGFjY2VwdCByZWd1bGFyIGV4cHJlc3Npb25zIik7CiB9CiByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogNTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGlzT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMik7CnZhciBjbGFzc29mID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7CnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIE1BVENIID0gd2VsbEtub3duU3ltYm9sKCdtYXRjaCcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogdmFyIGlzUmVnRXhwOwogcmV0dXJuIGlzT2JqZWN0KGl0KSAmJiAoKGlzUmVnRXhwID0gaXRbTUFUQ0hdKSAhPT0gdW5kZWZpbmVkID8gISFpc1JlZ0V4cCA6IGNsYXNzb2YoaXQpID09ICdSZWdFeHAnKTsKfTsKCi8qKiovIH0pLAovKiA1NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBzaGFyZWQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM2KTsKdmFyIGhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgdWlkID0gX193X3BkZmpzX3JlcXVpcmVfXygzOCk7CnZhciBOQVRJVkVfU1lNQk9MID0gX193X3BkZmpzX3JlcXVpcmVfXyg1OCk7CnZhciBVU0VfU1lNQk9MX0FTX1VJRCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTkpOwp2YXIgV2VsbEtub3duU3ltYm9sc1N0b3JlID0gc2hhcmVkKCd3a3MnKTsKdmFyIFN5bWJvbCA9IGdsb2JhbC5TeW1ib2w7CnZhciBjcmVhdGVXZWxsS25vd25TeW1ib2wgPSBVU0VfU1lNQk9MX0FTX1VJRCA/IFN5bWJvbCA6IFN5bWJvbCAmJiBTeW1ib2wud2l0aG91dFNldHRlciB8fCB1aWQ7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG5hbWUpIHsKIGlmICghaGFzKFdlbGxLbm93blN5bWJvbHNTdG9yZSwgbmFtZSkpIHsKICBpZiAoTkFUSVZFX1NZTUJPTCAmJiBoYXMoU3ltYm9sLCBuYW1lKSkKICAgV2VsbEtub3duU3ltYm9sc1N0b3JlW25hbWVdID0gU3ltYm9sW25hbWVdOwogIGVsc2UKICAgV2VsbEtub3duU3ltYm9sc1N0b3JlW25hbWVdID0gY3JlYXRlV2VsbEtub3duU3ltYm9sKCdTeW1ib2wuJyArIG5hbWUpOwogfQogcmV0dXJuIFdlbGxLbm93blN5bWJvbHNTdG9yZVtuYW1lXTsKfTsKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZmFpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKbW9kdWxlLmV4cG9ydHMgPSAhIU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgJiYgIWZhaWxzKGZ1bmN0aW9uICgpIHsKIHJldHVybiAhU3RyaW5nKFN5bWJvbCgpKTsKfSk7CgovKioqLyB9KSwKLyogNTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIE5BVElWRV9TWU1CT0wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU4KTsKbW9kdWxlLmV4cG9ydHMgPSBOQVRJVkVfU1lNQk9MICYmICFTeW1ib2wuc2hhbSAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09ICdzeW1ib2wnOwoKLyoqKi8gfSksCi8qIDYwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIE1BVENIID0gd2VsbEtub3duU3ltYm9sKCdtYXRjaCcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChNRVRIT0RfTkFNRSkgewogdmFyIHJlZ2V4cCA9IC8uLzsKIHRyeSB7CiAgJy8uLydbTUVUSE9EX05BTUVdKHJlZ2V4cCk7CiB9IGNhdGNoIChlKSB7CiAgdHJ5IHsKICAgcmVnZXhwW01BVENIXSA9IGZhbHNlOwogICByZXR1cm4gJy8uLydbTUVUSE9EX05BTUVdKHJlZ2V4cCk7CiAgfSBjYXRjaCAoZikgewogIH0KIH0KIHJldHVybiBmYWxzZTsKfTsKCi8qKiovIH0pLAovKiA2MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBiaW5kID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Mik7CnZhciBjYWxsID0gRnVuY3Rpb24uY2FsbDsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQ09OU1RSVUNUT1IsIE1FVEhPRCwgbGVuZ3RoKSB7CiByZXR1cm4gYmluZChjYWxsLCBnbG9iYWxbQ09OU1RSVUNUT1JdLnByb3RvdHlwZVtNRVRIT0RdLCBsZW5ndGgpOwp9OwoKLyoqKi8gfSksCi8qIDYyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBhRnVuY3Rpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYzKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZm4sIHRoYXQsIGxlbmd0aCkgewogYUZ1bmN0aW9uKGZuKTsKIGlmICh0aGF0ID09PSB1bmRlZmluZWQpCiAgcmV0dXJuIGZuOwogc3dpdGNoIChsZW5ndGgpIHsKIGNhc2UgMDoKICByZXR1cm4gZnVuY3Rpb24gKCkgewogICByZXR1cm4gZm4uY2FsbCh0aGF0KTsKICB9OwogY2FzZSAxOgogIHJldHVybiBmdW5jdGlvbiAoYSkgewogICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTsKICB9OwogY2FzZSAyOgogIHJldHVybiBmdW5jdGlvbiAoYSwgYikgewogICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTsKICB9OwogY2FzZSAzOgogIHJldHVybiBmdW5jdGlvbiAoYSwgYiwgYykgewogICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTsKICB9OwogfQogcmV0dXJuIGZ1bmN0aW9uICgpIHsKICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTsKIH07Cn07CgovKioqLyB9KSwKLyogNjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIGlmICh0eXBlb2YgaXQgIT0gJ2Z1bmN0aW9uJykgewogIHRocm93IFR5cGVFcnJvcihTdHJpbmcoaXQpICsgJyBpcyBub3QgYSBmdW5jdGlvbicpOwogfQogcmV0dXJuIGl0Owp9OwoKLyoqKi8gfSksCi8qIDY0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCl9fd19wZGZqc19yZXF1aXJlX18oNjUpOwp2YXIgZW50cnlVbmJpbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYxKTsKbW9kdWxlLmV4cG9ydHMgPSBlbnRyeVVuYmluZCgnU3RyaW5nJywgJ2VuZHNXaXRoJyk7CgovKioqLyB9KSwKLyogNjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTIpLmY7CnZhciB0b0xlbmd0aCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDcpOwp2YXIgbm90QVJlZ0V4cCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTUpOwp2YXIgcmVxdWlyZU9iamVjdENvZXJjaWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjApOwp2YXIgY29ycmVjdElzUmVnRXhwTG9naWMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYwKTsKdmFyIElTX1BVUkUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM3KTsKdmFyIG5hdGl2ZUVuZHNXaXRoID0gJycuZW5kc1dpdGg7CnZhciBtaW4gPSBNYXRoLm1pbjsKdmFyIENPUlJFQ1RfSVNfUkVHRVhQX0xPR0lDID0gY29ycmVjdElzUmVnRXhwTG9naWMoJ2VuZHNXaXRoJyk7CnZhciBNRE5fUE9MWUZJTExfQlVHID0gIUlTX1BVUkUgJiYgIUNPUlJFQ1RfSVNfUkVHRVhQX0xPR0lDICYmICEhZnVuY3Rpb24gKCkgewogdmFyIGRlc2NyaXB0b3IgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoU3RyaW5nLnByb3RvdHlwZSwgJ2VuZHNXaXRoJyk7CiByZXR1cm4gZGVzY3JpcHRvciAmJiAhZGVzY3JpcHRvci53cml0YWJsZTsKfSgpOwokKHsKIHRhcmdldDogJ1N0cmluZycsCiBwcm90bzogdHJ1ZSwKIGZvcmNlZDogIU1ETl9QT0xZRklMTF9CVUcgJiYgIUNPUlJFQ1RfSVNfUkVHRVhQX0xPR0lDCn0sIHsKIGVuZHNXaXRoOiBmdW5jdGlvbiBlbmRzV2l0aChzZWFyY2hTdHJpbmcpIHsKICB2YXIgdGhhdCA9IFN0cmluZyhyZXF1aXJlT2JqZWN0Q29lcmNpYmxlKHRoaXMpKTsKICBub3RBUmVnRXhwKHNlYXJjaFN0cmluZyk7CiAgdmFyIGVuZFBvc2l0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7CiAgdmFyIGxlbiA9IHRvTGVuZ3RoKHRoYXQubGVuZ3RoKTsKICB2YXIgZW5kID0gZW5kUG9zaXRpb24gPT09IHVuZGVmaW5lZCA/IGxlbiA6IG1pbih0b0xlbmd0aChlbmRQb3NpdGlvbiksIGxlbik7CiAgdmFyIHNlYXJjaCA9IFN0cmluZyhzZWFyY2hTdHJpbmcpOwogIHJldHVybiBuYXRpdmVFbmRzV2l0aCA/IG5hdGl2ZUVuZHNXaXRoLmNhbGwodGhhdCwgc2VhcmNoLCBlbmQpIDogdGhhdC5zbGljZShlbmQgLSBzZWFyY2gubGVuZ3RoLCBlbmQpID09PSBzZWFyY2g7CiB9Cn0pOwoKLyoqKi8gfSksCi8qIDY2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCl9fd19wZGZqc19yZXF1aXJlX18oNjcpOwp2YXIgZW50cnlVbmJpbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYxKTsKbW9kdWxlLmV4cG9ydHMgPSBlbnRyeVVuYmluZCgnU3RyaW5nJywgJ2luY2x1ZGVzJyk7CgovKioqLyB9KSwKLyogNjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIG5vdEFSZWdFeHAgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU1KTsKdmFyIHJlcXVpcmVPYmplY3RDb2VyY2libGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwKTsKdmFyIGNvcnJlY3RJc1JlZ0V4cExvZ2ljID0gX193X3BkZmpzX3JlcXVpcmVfXyg2MCk7CiQoewogdGFyZ2V0OiAnU3RyaW5nJywKIHByb3RvOiB0cnVlLAogZm9yY2VkOiAhY29ycmVjdElzUmVnRXhwTG9naWMoJ2luY2x1ZGVzJykKfSwgewogaW5jbHVkZXM6IGZ1bmN0aW9uIGluY2x1ZGVzKHNlYXJjaFN0cmluZykgewogIHJldHVybiAhIX5TdHJpbmcocmVxdWlyZU9iamVjdENvZXJjaWJsZSh0aGlzKSkuaW5kZXhPZihub3RBUmVnRXhwKHNlYXJjaFN0cmluZyksIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsKIH0KfSk7CgovKioqLyB9KSwKLyogNjggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKX193X3BkZmpzX3JlcXVpcmVfXyg2OSk7CnZhciBlbnRyeVVuYmluZCA9IF9fd19wZGZqc19yZXF1aXJlX18oNjEpOwptb2R1bGUuZXhwb3J0cyA9IGVudHJ5VW5iaW5kKCdBcnJheScsICdpbmNsdWRlcycpOwoKLyoqKi8gfSksCi8qIDY5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciAkaW5jbHVkZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ2KS5pbmNsdWRlczsKdmFyIGFkZFRvVW5zY29wYWJsZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcwKTsKdmFyIGFycmF5TWV0aG9kVXNlc1RvTGVuZ3RoID0gX193X3BkZmpzX3JlcXVpcmVfXyg3NSk7CnZhciBVU0VTX1RPX0xFTkdUSCA9IGFycmF5TWV0aG9kVXNlc1RvTGVuZ3RoKCdpbmRleE9mJywgewogQUNDRVNTT1JTOiB0cnVlLAogMTogMAp9KTsKJCh7CiB0YXJnZXQ6ICdBcnJheScsCiBwcm90bzogdHJ1ZSwKIGZvcmNlZDogIVVTRVNfVE9fTEVOR1RICn0sIHsKIGluY2x1ZGVzOiBmdW5jdGlvbiBpbmNsdWRlcyhlbCkgewogIHJldHVybiAkaW5jbHVkZXModGhpcywgZWwsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsKIH0KfSk7CmFkZFRvVW5zY29wYWJsZXMoJ2luY2x1ZGVzJyk7CgovKioqLyB9KSwKLyogNzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgY3JlYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXyg3MSk7CnZhciBkZWZpbmVQcm9wZXJ0eU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjcpOwp2YXIgVU5TQ09QQUJMRVMgPSB3ZWxsS25vd25TeW1ib2woJ3Vuc2NvcGFibGVzJyk7CnZhciBBcnJheVByb3RvdHlwZSA9IEFycmF5LnByb3RvdHlwZTsKaWYgKEFycmF5UHJvdG90eXBlW1VOU0NPUEFCTEVTXSA9PSB1bmRlZmluZWQpIHsKIGRlZmluZVByb3BlcnR5TW9kdWxlLmYoQXJyYXlQcm90b3R5cGUsIFVOU0NPUEFCTEVTLCB7CiAgY29uZmlndXJhYmxlOiB0cnVlLAogIHZhbHVlOiBjcmVhdGUobnVsbCkKIH0pOwp9Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGtleSkgewogQXJyYXlQcm90b3R5cGVbVU5TQ09QQUJMRVNdW2tleV0gPSB0cnVlOwp9OwoKLyoqKi8gfSksCi8qIDcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBhbk9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjgpOwp2YXIgZGVmaW5lUHJvcGVydGllcyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzIpOwp2YXIgZW51bUJ1Z0tleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKdmFyIGhpZGRlbktleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM5KTsKdmFyIGh0bWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc0KTsKdmFyIGRvY3VtZW50Q3JlYXRlRWxlbWVudCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjUpOwp2YXIgc2hhcmVkS2V5ID0gX193X3BkZmpzX3JlcXVpcmVfXygzNSk7CnZhciBHVCA9ICc+JzsKdmFyIExUID0gJzwnOwp2YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7CnZhciBTQ1JJUFQgPSAnc2NyaXB0JzsKdmFyIElFX1BST1RPID0gc2hhcmVkS2V5KCdJRV9QUk9UTycpOwp2YXIgRW1wdHlDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uICgpIHsKfTsKdmFyIHNjcmlwdFRhZyA9IGZ1bmN0aW9uIChjb250ZW50KSB7CiByZXR1cm4gTFQgKyBTQ1JJUFQgKyBHVCArIGNvbnRlbnQgKyBMVCArICcvJyArIFNDUklQVCArIEdUOwp9Owp2YXIgTnVsbFByb3RvT2JqZWN0VmlhQWN0aXZlWCA9IGZ1bmN0aW9uIChhY3RpdmVYRG9jdW1lbnQpIHsKIGFjdGl2ZVhEb2N1bWVudC53cml0ZShzY3JpcHRUYWcoJycpKTsKIGFjdGl2ZVhEb2N1bWVudC5jbG9zZSgpOwogdmFyIHRlbXAgPSBhY3RpdmVYRG9jdW1lbnQucGFyZW50V2luZG93Lk9iamVjdDsKIGFjdGl2ZVhEb2N1bWVudCA9IG51bGw7CiByZXR1cm4gdGVtcDsKfTsKdmFyIE51bGxQcm90b09iamVjdFZpYUlGcmFtZSA9IGZ1bmN0aW9uICgpIHsKIHZhciBpZnJhbWUgPSBkb2N1bWVudENyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOwogdmFyIEpTID0gJ2phdmEnICsgU0NSSVBUICsgJzonOwogdmFyIGlmcmFtZURvY3VtZW50OwogaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiBodG1sLmFwcGVuZENoaWxkKGlmcmFtZSk7CiBpZnJhbWUuc3JjID0gU3RyaW5nKEpTKTsKIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7CiBpZnJhbWVEb2N1bWVudC5vcGVuKCk7CiBpZnJhbWVEb2N1bWVudC53cml0ZShzY3JpcHRUYWcoJ2RvY3VtZW50LkY9T2JqZWN0JykpOwogaWZyYW1lRG9jdW1lbnQuY2xvc2UoKTsKIHJldHVybiBpZnJhbWVEb2N1bWVudC5GOwp9Owp2YXIgYWN0aXZlWERvY3VtZW50Owp2YXIgTnVsbFByb3RvT2JqZWN0ID0gZnVuY3Rpb24gKCkgewogdHJ5IHsKICBhY3RpdmVYRG9jdW1lbnQgPSBkb2N1bWVudC5kb21haW4gJiYgbmV3IEFjdGl2ZVhPYmplY3QoJ2h0bWxmaWxlJyk7CiB9IGNhdGNoIChlcnJvcikgewogfQogTnVsbFByb3RvT2JqZWN0ID0gYWN0aXZlWERvY3VtZW50ID8gTnVsbFByb3RvT2JqZWN0VmlhQWN0aXZlWChhY3RpdmVYRG9jdW1lbnQpIDogTnVsbFByb3RvT2JqZWN0VmlhSUZyYW1lKCk7CiB2YXIgbGVuZ3RoID0gZW51bUJ1Z0tleXMubGVuZ3RoOwogd2hpbGUgKGxlbmd0aC0tKQogIGRlbGV0ZSBOdWxsUHJvdG9PYmplY3RbUFJPVE9UWVBFXVtlbnVtQnVnS2V5c1tsZW5ndGhdXTsKIHJldHVybiBOdWxsUHJvdG9PYmplY3QoKTsKfTsKaGlkZGVuS2V5c1tJRV9QUk9UT10gPSB0cnVlOwptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpIHsKIHZhciByZXN1bHQ7CiBpZiAoTyAhPT0gbnVsbCkgewogIEVtcHR5Q29uc3RydWN0b3JbUFJPVE9UWVBFXSA9IGFuT2JqZWN0KE8pOwogIHJlc3VsdCA9IG5ldyBFbXB0eUNvbnN0cnVjdG9yKCk7CiAgRW1wdHlDb25zdHJ1Y3RvcltQUk9UT1RZUEVdID0gbnVsbDsKICByZXN1bHRbSUVfUFJPVE9dID0gTzsKIH0gZWxzZQogIHJlc3VsdCA9IE51bGxQcm90b09iamVjdCgpOwogcmV0dXJuIFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCA/IHJlc3VsdCA6IGRlZmluZVByb3BlcnRpZXMocmVzdWx0LCBQcm9wZXJ0aWVzKTsKfTsKCi8qKiovIH0pLAovKiA3MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgREVTQ1JJUFRPUlMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzKTsKdmFyIGRlZmluZVByb3BlcnR5TW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygyNyk7CnZhciBhbk9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjgpOwp2YXIgb2JqZWN0S2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzMpOwptb2R1bGUuZXhwb3J0cyA9IERFU0NSSVBUT1JTID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpIHsKIGFuT2JqZWN0KE8pOwogdmFyIGtleXMgPSBvYmplY3RLZXlzKFByb3BlcnRpZXMpOwogdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoOwogdmFyIGluZGV4ID0gMDsKIHZhciBrZXk7CiB3aGlsZSAobGVuZ3RoID4gaW5kZXgpCiAgZGVmaW5lUHJvcGVydHlNb2R1bGUuZihPLCBrZXkgPSBrZXlzW2luZGV4KytdLCBQcm9wZXJ0aWVzW2tleV0pOwogcmV0dXJuIE87Cn07CgovKioqLyB9KSwKLyogNzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGludGVybmFsT2JqZWN0S2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNDUpOwp2YXIgZW51bUJ1Z0tleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUwKTsKbW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKE8pIHsKIHJldHVybiBpbnRlcm5hbE9iamVjdEtleXMoTywgZW51bUJ1Z0tleXMpOwp9OwoKLyoqKi8gfSksCi8qIDc0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnZXRCdWlsdEluID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Mik7Cm1vZHVsZS5leHBvcnRzID0gZ2V0QnVpbHRJbignZG9jdW1lbnQnLCAnZG9jdW1lbnRFbGVtZW50Jyk7CgovKioqLyB9KSwKLyogNzUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMyk7CnZhciBmYWlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQpOwp2YXIgaGFzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMyk7CnZhciBkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsKdmFyIGNhY2hlID0ge307CnZhciB0aHJvd2VyID0gZnVuY3Rpb24gKGl0KSB7CiB0aHJvdyBpdDsKfTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTUVUSE9EX05BTUUsIG9wdGlvbnMpIHsKIGlmIChoYXMoY2FjaGUsIE1FVEhPRF9OQU1FKSkKICByZXR1cm4gY2FjaGVbTUVUSE9EX05BTUVdOwogaWYgKCFvcHRpb25zKQogIG9wdGlvbnMgPSB7fTsKIHZhciBtZXRob2QgPSBbXVtNRVRIT0RfTkFNRV07CiB2YXIgQUNDRVNTT1JTID0gaGFzKG9wdGlvbnMsICdBQ0NFU1NPUlMnKSA/IG9wdGlvbnMuQUNDRVNTT1JTIDogZmFsc2U7CiB2YXIgYXJndW1lbnQwID0gaGFzKG9wdGlvbnMsIDApID8gb3B0aW9uc1swXSA6IHRocm93ZXI7CiB2YXIgYXJndW1lbnQxID0gaGFzKG9wdGlvbnMsIDEpID8gb3B0aW9uc1sxXSA6IHVuZGVmaW5lZDsKIHJldHVybiBjYWNoZVtNRVRIT0RfTkFNRV0gPSAhIW1ldGhvZCAmJiAhZmFpbHMoZnVuY3Rpb24gKCkgewogIGlmIChBQ0NFU1NPUlMgJiYgIURFU0NSSVBUT1JTKQogICByZXR1cm4gdHJ1ZTsKICB2YXIgTyA9IHsgbGVuZ3RoOiAtMSB9OwogIGlmIChBQ0NFU1NPUlMpCiAgIGRlZmluZVByb3BlcnR5KE8sIDEsIHsKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBnZXQ6IHRocm93ZXIKICAgfSk7CiAgZWxzZQogICBPWzFdID0gMTsKICBtZXRob2QuY2FsbChPLCBhcmd1bWVudDAsIGFyZ3VtZW50MSk7CiB9KTsKfTsKCi8qKiovIH0pLAovKiA3NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDc3KTsKX193X3BkZmpzX3JlcXVpcmVfXyg4OSk7CnZhciBwYXRoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7Cm1vZHVsZS5leHBvcnRzID0gcGF0aC5BcnJheS5mcm9tOwoKLyoqKi8gfSksCi8qIDc3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBjaGFyQXQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc4KS5jaGFyQXQ7CnZhciBJbnRlcm5hbFN0YXRlTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygzMyk7CnZhciBkZWZpbmVJdGVyYXRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oNzkpOwp2YXIgU1RSSU5HX0lURVJBVE9SID0gJ1N0cmluZyBJdGVyYXRvcic7CnZhciBzZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5zZXQ7CnZhciBnZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5nZXR0ZXJGb3IoU1RSSU5HX0lURVJBVE9SKTsKZGVmaW5lSXRlcmF0b3IoU3RyaW5nLCAnU3RyaW5nJywgZnVuY3Rpb24gKGl0ZXJhdGVkKSB7CiBzZXRJbnRlcm5hbFN0YXRlKHRoaXMsIHsKICB0eXBlOiBTVFJJTkdfSVRFUkFUT1IsCiAgc3RyaW5nOiBTdHJpbmcoaXRlcmF0ZWQpLAogIGluZGV4OiAwCiB9KTsKfSwgZnVuY3Rpb24gbmV4dCgpIHsKIHZhciBzdGF0ZSA9IGdldEludGVybmFsU3RhdGUodGhpcyk7CiB2YXIgc3RyaW5nID0gc3RhdGUuc3RyaW5nOwogdmFyIGluZGV4ID0gc3RhdGUuaW5kZXg7CiB2YXIgcG9pbnQ7CiBpZiAoaW5kZXggPj0gc3RyaW5nLmxlbmd0aCkKICByZXR1cm4gewogICB2YWx1ZTogdW5kZWZpbmVkLAogICBkb25lOiB0cnVlCiAgfTsKIHBvaW50ID0gY2hhckF0KHN0cmluZywgaW5kZXgpOwogc3RhdGUuaW5kZXggKz0gcG9pbnQubGVuZ3RoOwogcmV0dXJuIHsKICB2YWx1ZTogcG9pbnQsCiAgZG9uZTogZmFsc2UKIH07Cn0pOwoKLyoqKi8gfSksCi8qIDc4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciB0b0ludGVnZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ4KTsKdmFyIHJlcXVpcmVPYmplY3RDb2VyY2libGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwKTsKdmFyIGNyZWF0ZU1ldGhvZCA9IGZ1bmN0aW9uIChDT05WRVJUX1RPX1NUUklORykgewogcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgcG9zKSB7CiAgdmFyIFMgPSBTdHJpbmcocmVxdWlyZU9iamVjdENvZXJjaWJsZSgkdGhpcykpOwogIHZhciBwb3NpdGlvbiA9IHRvSW50ZWdlcihwb3MpOwogIHZhciBzaXplID0gUy5sZW5ndGg7CiAgdmFyIGZpcnN0LCBzZWNvbmQ7CiAgaWYgKHBvc2l0aW9uIDwgMCB8fCBwb3NpdGlvbiA+PSBzaXplKQogICByZXR1cm4gQ09OVkVSVF9UT19TVFJJTkcgPyAnJyA6IHVuZGVmaW5lZDsKICBmaXJzdCA9IFMuY2hhckNvZGVBdChwb3NpdGlvbik7CiAgcmV0dXJuIGZpcnN0IDwgMHhEODAwIHx8IGZpcnN0ID4gMHhEQkZGIHx8IHBvc2l0aW9uICsgMSA9PT0gc2l6ZSB8fCAoc2Vjb25kID0gUy5jaGFyQ29kZUF0KHBvc2l0aW9uICsgMSkpIDwgMHhEQzAwIHx8IHNlY29uZCA+IDB4REZGRiA/IENPTlZFUlRfVE9fU1RSSU5HID8gUy5jaGFyQXQocG9zaXRpb24pIDogZmlyc3QgOiBDT05WRVJUX1RPX1NUUklORyA/IFMuc2xpY2UocG9zaXRpb24sIHBvc2l0aW9uICsgMikgOiAoZmlyc3QgLSAweEQ4MDAgPDwgMTApICsgKHNlY29uZCAtIDB4REMwMCkgKyAweDEwMDAwOwogfTsKfTsKbW9kdWxlLmV4cG9ydHMgPSB7CiBjb2RlQXQ6IGNyZWF0ZU1ldGhvZChmYWxzZSksCiBjaGFyQXQ6IGNyZWF0ZU1ldGhvZCh0cnVlKQp9OwoKLyoqKi8gfSksCi8qIDc5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBjcmVhdGVJdGVyYXRvckNvbnN0cnVjdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXyg4MCk7CnZhciBnZXRQcm90b3R5cGVPZiA9IF9fd19wZGZqc19yZXF1aXJlX18oODIpOwp2YXIgc2V0UHJvdG90eXBlT2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg3KTsKdmFyIHNldFRvU3RyaW5nVGFnID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7CnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI2KTsKdmFyIHJlZGVmaW5lID0gX193X3BkZmpzX3JlcXVpcmVfXygyOSk7CnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIElTX1BVUkUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM3KTsKdmFyIEl0ZXJhdG9ycyA9IF9fd19wZGZqc19yZXF1aXJlX18oODYpOwp2YXIgSXRlcmF0b3JzQ29yZSA9IF9fd19wZGZqc19yZXF1aXJlX18oODEpOwp2YXIgSXRlcmF0b3JQcm90b3R5cGUgPSBJdGVyYXRvcnNDb3JlLkl0ZXJhdG9yUHJvdG90eXBlOwp2YXIgQlVHR1lfU0FGQVJJX0lURVJBVE9SUyA9IEl0ZXJhdG9yc0NvcmUuQlVHR1lfU0FGQVJJX0lURVJBVE9SUzsKdmFyIElURVJBVE9SID0gd2VsbEtub3duU3ltYm9sKCdpdGVyYXRvcicpOwp2YXIgS0VZUyA9ICdrZXlzJzsKdmFyIFZBTFVFUyA9ICd2YWx1ZXMnOwp2YXIgRU5UUklFUyA9ICdlbnRyaWVzJzsKdmFyIHJldHVyblRoaXMgPSBmdW5jdGlvbiAoKSB7CiByZXR1cm4gdGhpczsKfTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoSXRlcmFibGUsIE5BTUUsIEl0ZXJhdG9yQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKSB7CiBjcmVhdGVJdGVyYXRvckNvbnN0cnVjdG9yKEl0ZXJhdG9yQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpOwogdmFyIGdldEl0ZXJhdGlvbk1ldGhvZCA9IGZ1bmN0aW9uIChLSU5EKSB7CiAgaWYgKEtJTkQgPT09IERFRkFVTFQgJiYgZGVmYXVsdEl0ZXJhdG9yKQogICByZXR1cm4gZGVmYXVsdEl0ZXJhdG9yOwogIGlmICghQlVHR1lfU0FGQVJJX0lURVJBVE9SUyAmJiBLSU5EIGluIEl0ZXJhYmxlUHJvdG90eXBlKQogICByZXR1cm4gSXRlcmFibGVQcm90b3R5cGVbS0lORF07CiAgc3dpdGNoIChLSU5EKSB7CiAgY2FzZSBLRVlTOgogICByZXR1cm4gZnVuY3Rpb24ga2V5cygpIHsKICAgIHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzLCBLSU5EKTsKICAgfTsKICBjYXNlIFZBTFVFUzoKICAgcmV0dXJuIGZ1bmN0aW9uIHZhbHVlcygpIHsKICAgIHJldHVybiBuZXcgSXRlcmF0b3JDb25zdHJ1Y3Rvcih0aGlzLCBLSU5EKTsKICAgfTsKICBjYXNlIEVOVFJJRVM6CiAgIHJldHVybiBmdW5jdGlvbiBlbnRyaWVzKCkgewogICAgcmV0dXJuIG5ldyBJdGVyYXRvckNvbnN0cnVjdG9yKHRoaXMsIEtJTkQpOwogICB9OwogIH0KICByZXR1cm4gZnVuY3Rpb24gKCkgewogICByZXR1cm4gbmV3IEl0ZXJhdG9yQ29uc3RydWN0b3IodGhpcyk7CiAgfTsKIH07CiB2YXIgVE9fU1RSSU5HX1RBRyA9IE5BTUUgKyAnIEl0ZXJhdG9yJzsKIHZhciBJTkNPUlJFQ1RfVkFMVUVTX05BTUUgPSBmYWxzZTsKIHZhciBJdGVyYWJsZVByb3RvdHlwZSA9IEl0ZXJhYmxlLnByb3RvdHlwZTsKIHZhciBuYXRpdmVJdGVyYXRvciA9IEl0ZXJhYmxlUHJvdG90eXBlW0lURVJBVE9SXSB8fCBJdGVyYWJsZVByb3RvdHlwZVsnQEBpdGVyYXRvciddIHx8IERFRkFVTFQgJiYgSXRlcmFibGVQcm90b3R5cGVbREVGQVVMVF07CiB2YXIgZGVmYXVsdEl0ZXJhdG9yID0gIUJVR0dZX1NBRkFSSV9JVEVSQVRPUlMgJiYgbmF0aXZlSXRlcmF0b3IgfHwgZ2V0SXRlcmF0aW9uTWV0aG9kKERFRkFVTFQpOwogdmFyIGFueU5hdGl2ZUl0ZXJhdG9yID0gTkFNRSA9PSAnQXJyYXknID8gSXRlcmFibGVQcm90b3R5cGUuZW50cmllcyB8fCBuYXRpdmVJdGVyYXRvciA6IG5hdGl2ZUl0ZXJhdG9yOwogdmFyIEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwgbWV0aG9kcywgS0VZOwogaWYgKGFueU5hdGl2ZUl0ZXJhdG9yKSB7CiAgQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG90eXBlT2YoYW55TmF0aXZlSXRlcmF0b3IuY2FsbChuZXcgSXRlcmFibGUoKSkpOwogIGlmIChJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSAmJiBDdXJyZW50SXRlcmF0b3JQcm90b3R5cGUubmV4dCkgewogICBpZiAoIUlTX1BVUkUgJiYgZ2V0UHJvdG90eXBlT2YoQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlKSAhPT0gSXRlcmF0b3JQcm90b3R5cGUpIHsKICAgIGlmIChzZXRQcm90b3R5cGVPZikgewogICAgIHNldFByb3RvdHlwZU9mKEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwgSXRlcmF0b3JQcm90b3R5cGUpOwogICAgfSBlbHNlIGlmICh0eXBlb2YgQ3VycmVudEl0ZXJhdG9yUHJvdG90eXBlW0lURVJBVE9SXSAhPSAnZnVuY3Rpb24nKSB7CiAgICAgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5KEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwogICAgfQogICB9CiAgIHNldFRvU3RyaW5nVGFnKEN1cnJlbnRJdGVyYXRvclByb3RvdHlwZSwgVE9fU1RSSU5HX1RBRywgdHJ1ZSwgdHJ1ZSk7CiAgIGlmIChJU19QVVJFKQogICAgSXRlcmF0b3JzW1RPX1NUUklOR19UQUddID0gcmV0dXJuVGhpczsKICB9CiB9CiBpZiAoREVGQVVMVCA9PSBWQUxVRVMgJiYgbmF0aXZlSXRlcmF0b3IgJiYgbmF0aXZlSXRlcmF0b3IubmFtZSAhPT0gVkFMVUVTKSB7CiAgSU5DT1JSRUNUX1ZBTFVFU19OQU1FID0gdHJ1ZTsKICBkZWZhdWx0SXRlcmF0b3IgPSBmdW5jdGlvbiB2YWx1ZXMoKSB7CiAgIHJldHVybiBuYXRpdmVJdGVyYXRvci5jYWxsKHRoaXMpOwogIH07CiB9CiBpZiAoKCFJU19QVVJFIHx8IEZPUkNFRCkgJiYgSXRlcmFibGVQcm90b3R5cGVbSVRFUkFUT1JdICE9PSBkZWZhdWx0SXRlcmF0b3IpIHsKICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkoSXRlcmFibGVQcm90b3R5cGUsIElURVJBVE9SLCBkZWZhdWx0SXRlcmF0b3IpOwogfQogSXRlcmF0b3JzW05BTUVdID0gZGVmYXVsdEl0ZXJhdG9yOwogaWYgKERFRkFVTFQpIHsKICBtZXRob2RzID0gewogICB2YWx1ZXM6IGdldEl0ZXJhdGlvbk1ldGhvZChWQUxVRVMpLAogICBrZXlzOiBJU19TRVQgPyBkZWZhdWx0SXRlcmF0b3IgOiBnZXRJdGVyYXRpb25NZXRob2QoS0VZUyksCiAgIGVudHJpZXM6IGdldEl0ZXJhdGlvbk1ldGhvZChFTlRSSUVTKQogIH07CiAgaWYgKEZPUkNFRCkKICAgZm9yIChLRVkgaW4gbWV0aG9kcykgewogICAgaWYgKEJVR0dZX1NBRkFSSV9JVEVSQVRPUlMgfHwgSU5DT1JSRUNUX1ZBTFVFU19OQU1FIHx8ICEoS0VZIGluIEl0ZXJhYmxlUHJvdG90eXBlKSkgewogICAgIHJlZGVmaW5lKEl0ZXJhYmxlUHJvdG90eXBlLCBLRVksIG1ldGhvZHNbS0VZXSk7CiAgICB9CiAgIH0KICBlbHNlCiAgICQoewogICAgdGFyZ2V0OiBOQU1FLAogICAgcHJvdG86IHRydWUsCiAgICBmb3JjZWQ6IEJVR0dZX1NBRkFSSV9JVEVSQVRPUlMgfHwgSU5DT1JSRUNUX1ZBTFVFU19OQU1FCiAgIH0sIG1ldGhvZHMpOwogfQogcmV0dXJuIG1ldGhvZHM7Cn07CgovKioqLyB9KSwKLyogODAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIEl0ZXJhdG9yUHJvdG90eXBlID0gX193X3BkZmpzX3JlcXVpcmVfXyg4MSkuSXRlcmF0b3JQcm90b3R5cGU7CnZhciBjcmVhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcxKTsKdmFyIGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTYpOwp2YXIgc2V0VG9TdHJpbmdUYWcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg1KTsKdmFyIEl0ZXJhdG9ycyA9IF9fd19wZGZqc19yZXF1aXJlX18oODYpOwp2YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uICgpIHsKIHJldHVybiB0aGlzOwp9Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChJdGVyYXRvckNvbnN0cnVjdG9yLCBOQU1FLCBuZXh0KSB7CiB2YXIgVE9fU1RSSU5HX1RBRyA9IE5BTUUgKyAnIEl0ZXJhdG9yJzsKIEl0ZXJhdG9yQ29uc3RydWN0b3IucHJvdG90eXBlID0gY3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlLCB7IG5leHQ6IGNyZWF0ZVByb3BlcnR5RGVzY3JpcHRvcigxLCBuZXh0KSB9KTsKIHNldFRvU3RyaW5nVGFnKEl0ZXJhdG9yQ29uc3RydWN0b3IsIFRPX1NUUklOR19UQUcsIGZhbHNlLCB0cnVlKTsKIEl0ZXJhdG9yc1tUT19TVFJJTkdfVEFHXSA9IHJldHVyblRoaXM7CiByZXR1cm4gSXRlcmF0b3JDb25zdHJ1Y3RvcjsKfTsKCi8qKiovIH0pLAovKiA4MSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZ2V0UHJvdG90eXBlT2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgyKTsKdmFyIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjYpOwp2YXIgaGFzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMyk7CnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIElTX1BVUkUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM3KTsKdmFyIElURVJBVE9SID0gd2VsbEtub3duU3ltYm9sKCdpdGVyYXRvcicpOwp2YXIgQlVHR1lfU0FGQVJJX0lURVJBVE9SUyA9IGZhbHNlOwp2YXIgcmV0dXJuVGhpcyA9IGZ1bmN0aW9uICgpIHsKIHJldHVybiB0aGlzOwp9Owp2YXIgSXRlcmF0b3JQcm90b3R5cGUsIFByb3RvdHlwZU9mQXJyYXlJdGVyYXRvclByb3RvdHlwZSwgYXJyYXlJdGVyYXRvcjsKaWYgKFtdLmtleXMpIHsKIGFycmF5SXRlcmF0b3IgPSBbXS5rZXlzKCk7CiBpZiAoISgnbmV4dCcgaW4gYXJyYXlJdGVyYXRvcikpCiAgQlVHR1lfU0FGQVJJX0lURVJBVE9SUyA9IHRydWU7CiBlbHNlIHsKICBQcm90b3R5cGVPZkFycmF5SXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90b3R5cGVPZihnZXRQcm90b3R5cGVPZihhcnJheUl0ZXJhdG9yKSk7CiAgaWYgKFByb3RvdHlwZU9mQXJyYXlJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSkKICAgSXRlcmF0b3JQcm90b3R5cGUgPSBQcm90b3R5cGVPZkFycmF5SXRlcmF0b3JQcm90b3R5cGU7CiB9Cn0KaWYgKEl0ZXJhdG9yUHJvdG90eXBlID09IHVuZGVmaW5lZCkKIEl0ZXJhdG9yUHJvdG90eXBlID0ge307CmlmICghSVNfUFVSRSAmJiAhaGFzKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUikpIHsKIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IsIHJldHVyblRoaXMpOwp9Cm1vZHVsZS5leHBvcnRzID0gewogSXRlcmF0b3JQcm90b3R5cGU6IEl0ZXJhdG9yUHJvdG90eXBlLAogQlVHR1lfU0FGQVJJX0lURVJBVE9SUzogQlVHR1lfU0FGQVJJX0lURVJBVE9SUwp9OwoKLyoqKi8gfSksCi8qIDgyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBoYXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIHRvT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Myk7CnZhciBzaGFyZWRLZXkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM1KTsKdmFyIENPUlJFQ1RfUFJPVE9UWVBFX0dFVFRFUiA9IF9fd19wZGZqc19yZXF1aXJlX18oODQpOwp2YXIgSUVfUFJPVE8gPSBzaGFyZWRLZXkoJ0lFX1BST1RPJyk7CnZhciBPYmplY3RQcm90b3R5cGUgPSBPYmplY3QucHJvdG90eXBlOwptb2R1bGUuZXhwb3J0cyA9IENPUlJFQ1RfUFJPVE9UWVBFX0dFVFRFUiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIChPKSB7CiBPID0gdG9PYmplY3QoTyk7CiBpZiAoaGFzKE8sIElFX1BST1RPKSkKICByZXR1cm4gT1tJRV9QUk9UT107CiBpZiAodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3RvcikgewogIHJldHVybiBPLmNvbnN0cnVjdG9yLnByb3RvdHlwZTsKIH0KIHJldHVybiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG90eXBlIDogbnVsbDsKfTsKCi8qKiovIH0pLAovKiA4MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgcmVxdWlyZU9iamVjdENvZXJjaWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjApOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcmd1bWVudCkgewogcmV0dXJuIE9iamVjdChyZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KSk7Cn07CgovKioqLyB9KSwKLyogODQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7Cm1vZHVsZS5leHBvcnRzID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKIGZ1bmN0aW9uIEYoKSB7CiB9CiBGLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IG51bGw7CiByZXR1cm4gT2JqZWN0LmdldFByb3RvdHlwZU9mKG5ldyBGKCkpICE9PSBGLnByb3RvdHlwZTsKfSk7CgovKioqLyB9KSwKLyogODUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGRlZmluZVByb3BlcnR5ID0gX193X3BkZmpzX3JlcXVpcmVfXygyNykuZjsKdmFyIGhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgd2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Nyk7CnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCwgVEFHLCBTVEFUSUMpIHsKIGlmIChpdCAmJiAhaGFzKGl0ID0gU1RBVElDID8gaXQgOiBpdC5wcm90b3R5cGUsIFRPX1NUUklOR19UQUcpKSB7CiAgZGVmaW5lUHJvcGVydHkoaXQsIFRPX1NUUklOR19UQUcsIHsKICAgY29uZmlndXJhYmxlOiB0cnVlLAogICB2YWx1ZTogVEFHCiAgfSk7CiB9Cn07CgovKioqLyB9KSwKLyogODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKbW9kdWxlLmV4cG9ydHMgPSB7fTsKCi8qKiovIH0pLAovKiA4NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgYW5PYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI4KTsKdmFyIGFQb3NzaWJsZVByb3RvdHlwZSA9IF9fd19wZGZqc19yZXF1aXJlX18oODgpOwptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoJ19fcHJvdG9fXycgaW4ge30gPyBmdW5jdGlvbiAoKSB7CiB2YXIgQ09SUkVDVF9TRVRURVIgPSBmYWxzZTsKIHZhciB0ZXN0ID0ge307CiB2YXIgc2V0dGVyOwogdHJ5IHsKICBzZXR0ZXIgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE9iamVjdC5wcm90b3R5cGUsICdfX3Byb3RvX18nKS5zZXQ7CiAgc2V0dGVyLmNhbGwodGVzdCwgW10pOwogIENPUlJFQ1RfU0VUVEVSID0gdGVzdCBpbnN0YW5jZW9mIEFycmF5OwogfSBjYXRjaCAoZXJyb3IpIHsKIH0KIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90bykgewogIGFuT2JqZWN0KE8pOwogIGFQb3NzaWJsZVByb3RvdHlwZShwcm90byk7CiAgaWYgKENPUlJFQ1RfU0VUVEVSKQogICBzZXR0ZXIuY2FsbChPLCBwcm90byk7CiAgZWxzZQogICBPLl9fcHJvdG9fXyA9IHByb3RvOwogIHJldHVybiBPOwogfTsKfSgpIDogdW5kZWZpbmVkKTsKCi8qKiovIH0pLAovKiA4OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIGlmICghaXNPYmplY3QoaXQpICYmIGl0ICE9PSBudWxsKSB7CiAgdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBzZXQgIiArIFN0cmluZyhpdCkgKyAnIGFzIGEgcHJvdG90eXBlJyk7CiB9CiByZXR1cm4gaXQ7Cn07CgovKioqLyB9KSwKLyogODkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIGZyb20gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkwKTsKdmFyIGNoZWNrQ29ycmVjdG5lc3NPZkl0ZXJhdGlvbiA9IF9fd19wZGZqc19yZXF1aXJlX18oOTcpOwp2YXIgSU5DT1JSRUNUX0lURVJBVElPTiA9ICFjaGVja0NvcnJlY3RuZXNzT2ZJdGVyYXRpb24oZnVuY3Rpb24gKGl0ZXJhYmxlKSB7CiBBcnJheS5mcm9tKGl0ZXJhYmxlKTsKfSk7CiQoewogdGFyZ2V0OiAnQXJyYXknLAogc3RhdDogdHJ1ZSwKIGZvcmNlZDogSU5DT1JSRUNUX0lURVJBVElPTgp9LCB7IGZyb206IGZyb20gfSk7CgovKioqLyB9KSwKLyogOTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGJpbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYyKTsKdmFyIHRvT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Myk7CnZhciBjYWxsV2l0aFNhZmVJdGVyYXRpb25DbG9zaW5nID0gX193X3BkZmpzX3JlcXVpcmVfXyg5MSk7CnZhciBpc0FycmF5SXRlcmF0b3JNZXRob2QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkyKTsKdmFyIHRvTGVuZ3RoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Nyk7CnZhciBjcmVhdGVQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oOTMpOwp2YXIgZ2V0SXRlcmF0b3JNZXRob2QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk0KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBmcm9tKGFycmF5TGlrZSkgewogdmFyIE8gPSB0b09iamVjdChhcnJheUxpa2UpOwogdmFyIEMgPSB0eXBlb2YgdGhpcyA9PSAnZnVuY3Rpb24nID8gdGhpcyA6IEFycmF5OwogdmFyIGFyZ3VtZW50c0xlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7CiB2YXIgbWFwZm4gPSBhcmd1bWVudHNMZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogdmFyIG1hcHBpbmcgPSBtYXBmbiAhPT0gdW5kZWZpbmVkOwogdmFyIGl0ZXJhdG9yTWV0aG9kID0gZ2V0SXRlcmF0b3JNZXRob2QoTyk7CiB2YXIgaW5kZXggPSAwOwogdmFyIGxlbmd0aCwgcmVzdWx0LCBzdGVwLCBpdGVyYXRvciwgbmV4dCwgdmFsdWU7CiBpZiAobWFwcGluZykKICBtYXBmbiA9IGJpbmQobWFwZm4sIGFyZ3VtZW50c0xlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQsIDIpOwogaWYgKGl0ZXJhdG9yTWV0aG9kICE9IHVuZGVmaW5lZCAmJiAhKEMgPT0gQXJyYXkgJiYgaXNBcnJheUl0ZXJhdG9yTWV0aG9kKGl0ZXJhdG9yTWV0aG9kKSkpIHsKICBpdGVyYXRvciA9IGl0ZXJhdG9yTWV0aG9kLmNhbGwoTyk7CiAgbmV4dCA9IGl0ZXJhdG9yLm5leHQ7CiAgcmVzdWx0ID0gbmV3IEMoKTsKICBmb3IgKDsgIShzdGVwID0gbmV4dC5jYWxsKGl0ZXJhdG9yKSkuZG9uZTsgaW5kZXgrKykgewogICB2YWx1ZSA9IG1hcHBpbmcgPyBjYWxsV2l0aFNhZmVJdGVyYXRpb25DbG9zaW5nKGl0ZXJhdG9yLCBtYXBmbiwgWwogICAgc3RlcC52YWx1ZSwKICAgIGluZGV4CiAgIF0sIHRydWUpIDogc3RlcC52YWx1ZTsKICAgY3JlYXRlUHJvcGVydHkocmVzdWx0LCBpbmRleCwgdmFsdWUpOwogIH0KIH0gZWxzZSB7CiAgbGVuZ3RoID0gdG9MZW5ndGgoTy5sZW5ndGgpOwogIHJlc3VsdCA9IG5ldyBDKGxlbmd0aCk7CiAgZm9yICg7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKSB7CiAgIHZhbHVlID0gbWFwcGluZyA/IG1hcGZuKE9baW5kZXhdLCBpbmRleCkgOiBPW2luZGV4XTsKICAgY3JlYXRlUHJvcGVydHkocmVzdWx0LCBpbmRleCwgdmFsdWUpOwogIH0KIH0KIHJlc3VsdC5sZW5ndGggPSBpbmRleDsKIHJldHVybiByZXN1bHQ7Cn07CgovKioqLyB9KSwKLyogOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGFuT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyOCk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0ZXJhdG9yLCBmbiwgdmFsdWUsIEVOVFJJRVMpIHsKIHRyeSB7CiAgcmV0dXJuIEVOVFJJRVMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTsKIH0gY2F0Y2ggKGVycm9yKSB7CiAgdmFyIHJldHVybk1ldGhvZCA9IGl0ZXJhdG9yWydyZXR1cm4nXTsKICBpZiAocmV0dXJuTWV0aG9kICE9PSB1bmRlZmluZWQpCiAgIGFuT2JqZWN0KHJldHVybk1ldGhvZC5jYWxsKGl0ZXJhdG9yKSk7CiAgdGhyb3cgZXJyb3I7CiB9Cn07CgovKioqLyB9KSwKLyogOTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgSXRlcmF0b3JzID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Nik7CnZhciBJVEVSQVRPUiA9IHdlbGxLbm93blN5bWJvbCgnaXRlcmF0b3InKTsKdmFyIEFycmF5UHJvdG90eXBlID0gQXJyYXkucHJvdG90eXBlOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b3R5cGVbSVRFUkFUT1JdID09PSBpdCk7Cn07CgovKioqLyB9KSwKLyogOTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIHRvUHJpbWl0aXZlID0gX193X3BkZmpzX3JlcXVpcmVfXygyMSk7CnZhciBkZWZpbmVQcm9wZXJ0eU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjcpOwp2YXIgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxNik7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iamVjdCwga2V5LCB2YWx1ZSkgewogdmFyIHByb3BlcnR5S2V5ID0gdG9QcmltaXRpdmUoa2V5KTsKIGlmIChwcm9wZXJ0eUtleSBpbiBvYmplY3QpCiAgZGVmaW5lUHJvcGVydHlNb2R1bGUuZihvYmplY3QsIHByb3BlcnR5S2V5LCBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IoMCwgdmFsdWUpKTsKIGVsc2UKICBvYmplY3RbcHJvcGVydHlLZXldID0gdmFsdWU7Cn07CgovKioqLyB9KSwKLyogOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGNsYXNzb2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk1KTsKdmFyIEl0ZXJhdG9ycyA9IF9fd19wZGZqc19yZXF1aXJlX18oODYpOwp2YXIgd2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Nyk7CnZhciBJVEVSQVRPUiA9IHdlbGxLbm93blN5bWJvbCgnaXRlcmF0b3InKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXQpIHsKIGlmIChpdCAhPSB1bmRlZmluZWQpCiAgcmV0dXJuIGl0W0lURVJBVE9SXSB8fCBpdFsnQEBpdGVyYXRvciddIHx8IEl0ZXJhdG9yc1tjbGFzc29mKGl0KV07Cn07CgovKioqLyB9KSwKLyogOTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIFRPX1NUUklOR19UQUdfU1VQUE9SVCA9IF9fd19wZGZqc19yZXF1aXJlX18oOTYpOwp2YXIgY2xhc3NvZlJhdyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkpOwp2YXIgd2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Nyk7CnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpOwp2YXIgQ09SUkVDVF9BUkdVTUVOVFMgPSBjbGFzc29mUmF3KGZ1bmN0aW9uICgpIHsKIHJldHVybiBhcmd1bWVudHM7Cn0oKSkgPT0gJ0FyZ3VtZW50cyc7CnZhciB0cnlHZXQgPSBmdW5jdGlvbiAoaXQsIGtleSkgewogdHJ5IHsKICByZXR1cm4gaXRba2V5XTsKIH0gY2F0Y2ggKGVycm9yKSB7CiB9Cn07Cm1vZHVsZS5leHBvcnRzID0gVE9fU1RSSU5HX1RBR19TVVBQT1JUID8gY2xhc3NvZlJhdyA6IGZ1bmN0aW9uIChpdCkgewogdmFyIE8sIHRhZywgcmVzdWx0OwogcmV0dXJuIGl0ID09PSB1bmRlZmluZWQgPyAnVW5kZWZpbmVkJyA6IGl0ID09PSBudWxsID8gJ051bGwnIDogdHlwZW9mICh0YWcgPSB0cnlHZXQoTyA9IE9iamVjdChpdCksIFRPX1NUUklOR19UQUcpKSA9PSAnc3RyaW5nJyA/IHRhZyA6IENPUlJFQ1RfQVJHVU1FTlRTID8gY2xhc3NvZlJhdyhPKSA6IChyZXN1bHQgPSBjbGFzc29mUmF3KE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogcmVzdWx0Owp9OwoKLyoqKi8gfSksCi8qIDk2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIFRPX1NUUklOR19UQUcgPSB3ZWxsS25vd25TeW1ib2woJ3RvU3RyaW5nVGFnJyk7CnZhciB0ZXN0ID0ge307CnRlc3RbVE9fU1RSSU5HX1RBR10gPSAneic7Cm1vZHVsZS5leHBvcnRzID0gU3RyaW5nKHRlc3QpID09PSAnW29iamVjdCB6XSc7CgovKioqLyB9KSwKLyogOTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgSVRFUkFUT1IgPSB3ZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7CnZhciBTQUZFX0NMT1NJTkcgPSBmYWxzZTsKdHJ5IHsKIHZhciBjYWxsZWQgPSAwOwogdmFyIGl0ZXJhdG9yV2l0aFJldHVybiA9IHsKICBuZXh0OiBmdW5jdGlvbiAoKSB7CiAgIHJldHVybiB7IGRvbmU6ICEhY2FsbGVkKysgfTsKICB9LAogICdyZXR1cm4nOiBmdW5jdGlvbiAoKSB7CiAgIFNBRkVfQ0xPU0lORyA9IHRydWU7CiAgfQogfTsKIGl0ZXJhdG9yV2l0aFJldHVybltJVEVSQVRPUl0gPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHRoaXM7CiB9OwogQXJyYXkuZnJvbShpdGVyYXRvcldpdGhSZXR1cm4sIGZ1bmN0aW9uICgpIHsKICB0aHJvdyAyOwogfSk7Cn0gY2F0Y2ggKGVycm9yKSB7Cn0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZXhlYywgU0tJUF9DTE9TSU5HKSB7CiBpZiAoIVNLSVBfQ0xPU0lORyAmJiAhU0FGRV9DTE9TSU5HKQogIHJldHVybiBmYWxzZTsKIHZhciBJVEVSQVRJT05fU1VQUE9SVCA9IGZhbHNlOwogdHJ5IHsKICB2YXIgb2JqZWN0ID0ge307CiAgb2JqZWN0W0lURVJBVE9SXSA9IGZ1bmN0aW9uICgpIHsKICAgcmV0dXJuIHsKICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKICAgICByZXR1cm4geyBkb25lOiBJVEVSQVRJT05fU1VQUE9SVCA9IHRydWUgfTsKICAgIH0KICAgfTsKICB9OwogIGV4ZWMob2JqZWN0KTsKIH0gY2F0Y2ggKGVycm9yKSB7CiB9CiByZXR1cm4gSVRFUkFUSU9OX1NVUFBPUlQ7Cn07CgovKioqLyB9KSwKLyogOTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKX193X3BkZmpzX3JlcXVpcmVfXyg5OSk7CnZhciBwYXRoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7Cm1vZHVsZS5leHBvcnRzID0gcGF0aC5PYmplY3QuYXNzaWduOwoKLyoqKi8gfSksCi8qIDk5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBhc3NpZ24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwMCk7CiQoewogdGFyZ2V0OiAnT2JqZWN0JywKIHN0YXQ6IHRydWUsCiBmb3JjZWQ6IE9iamVjdC5hc3NpZ24gIT09IGFzc2lnbgp9LCB7IGFzc2lnbjogYXNzaWduIH0pOwoKLyoqKi8gfSksCi8qIDEwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgREVTQ1JJUFRPUlMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzKTsKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7CnZhciBvYmplY3RLZXlzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Myk7CnZhciBnZXRPd25Qcm9wZXJ0eVN5bWJvbHNNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUxKTsKdmFyIHByb3BlcnR5SXNFbnVtZXJhYmxlTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNSk7CnZhciB0b09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oODMpOwp2YXIgSW5kZXhlZE9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTgpOwp2YXIgbmF0aXZlQXNzaWduID0gT2JqZWN0LmFzc2lnbjsKdmFyIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5Owptb2R1bGUuZXhwb3J0cyA9ICFuYXRpdmVBc3NpZ24gfHwgZmFpbHMoZnVuY3Rpb24gKCkgewogaWYgKERFU0NSSVBUT1JTICYmIG5hdGl2ZUFzc2lnbih7IGI6IDEgfSwgbmF0aXZlQXNzaWduKGRlZmluZVByb3BlcnR5KHt9LCAnYScsIHsKICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICBkZWZpbmVQcm9wZXJ0eSh0aGlzLCAnYicsIHsKICAgICB2YWx1ZTogMywKICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSk7CiAgIH0KICB9KSwgeyBiOiAyIH0pKS5iICE9PSAxKQogIHJldHVybiB0cnVlOwogdmFyIEEgPSB7fTsKIHZhciBCID0ge307CiB2YXIgc3ltYm9sID0gU3ltYm9sKCk7CiB2YXIgYWxwaGFiZXQgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3QnOwogQVtzeW1ib2xdID0gNzsKIGFscGhhYmV0LnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uIChjaHIpIHsKICBCW2Nocl0gPSBjaHI7CiB9KTsKIHJldHVybiBuYXRpdmVBc3NpZ24oe30sIEEpW3N5bWJvbF0gIT0gNyB8fCBvYmplY3RLZXlzKG5hdGl2ZUFzc2lnbih7fSwgQikpLmpvaW4oJycpICE9IGFscGhhYmV0Owp9KSA/IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIHNvdXJjZSkgewogdmFyIFQgPSB0b09iamVjdCh0YXJnZXQpOwogdmFyIGFyZ3VtZW50c0xlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7CiB2YXIgaW5kZXggPSAxOwogdmFyIGdldE93blByb3BlcnR5U3ltYm9scyA9IGdldE93blByb3BlcnR5U3ltYm9sc01vZHVsZS5mOwogdmFyIHByb3BlcnR5SXNFbnVtZXJhYmxlID0gcHJvcGVydHlJc0VudW1lcmFibGVNb2R1bGUuZjsKIHdoaWxlIChhcmd1bWVudHNMZW5ndGggPiBpbmRleCkgewogIHZhciBTID0gSW5kZXhlZE9iamVjdChhcmd1bWVudHNbaW5kZXgrK10pOwogIHZhciBrZXlzID0gZ2V0T3duUHJvcGVydHlTeW1ib2xzID8gb2JqZWN0S2V5cyhTKS5jb25jYXQoZ2V0T3duUHJvcGVydHlTeW1ib2xzKFMpKSA6IG9iamVjdEtleXMoUyk7CiAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoOwogIHZhciBqID0gMDsKICB2YXIga2V5OwogIHdoaWxlIChsZW5ndGggPiBqKSB7CiAgIGtleSA9IGtleXNbaisrXTsKICAgaWYgKCFERVNDUklQVE9SUyB8fCBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKFMsIGtleSkpCiAgICBUW2tleV0gPSBTW2tleV07CiAgfQogfQogcmV0dXJuIFQ7Cn0gOiBuYXRpdmVBc3NpZ247CgovKioqLyB9KSwKLyogMTAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCl9fd19wZGZqc19yZXF1aXJlX18oMTAyKTsKdmFyIHBhdGggPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQzKTsKbW9kdWxlLmV4cG9ydHMgPSBwYXRoLk1hdGgubG9nMjsKCi8qKiovIH0pLAovKiAxMDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIGxvZyA9IE1hdGgubG9nOwp2YXIgTE4yID0gTWF0aC5MTjI7CiQoewogdGFyZ2V0OiAnTWF0aCcsCiBzdGF0OiB0cnVlCn0sIHsKIGxvZzI6IGZ1bmN0aW9uIGxvZzIoeCkgewogIHJldHVybiBsb2coeCkgLyBMTjI7CiB9Cn0pOwoKLyoqKi8gfSksCi8qIDEwMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDEwNCk7CnZhciBwYXRoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7Cm1vZHVsZS5leHBvcnRzID0gcGF0aC5OdW1iZXIuaXNOYU47CgovKioqLyB9KSwKLyogMTA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CiQoewogdGFyZ2V0OiAnTnVtYmVyJywKIHN0YXQ6IHRydWUKfSwgewogaXNOYU46IGZ1bmN0aW9uIGlzTmFOKG51bWJlcikgewogIHJldHVybiBudW1iZXIgIT0gbnVtYmVyOwogfQp9KTsKCi8qKiovIH0pLAovKiAxMDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKX193X3BkZmpzX3JlcXVpcmVfXygxMDYpOwp2YXIgcGF0aCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDMpOwptb2R1bGUuZXhwb3J0cyA9IHBhdGguTnVtYmVyLmlzSW50ZWdlcjsKCi8qKiovIH0pLAovKiAxMDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIGlzSW50ZWdlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTA3KTsKJCh7CiB0YXJnZXQ6ICdOdW1iZXInLAogc3RhdDogdHJ1ZQp9LCB7IGlzSW50ZWdlcjogaXNJbnRlZ2VyIH0pOwoKLyoqKi8gfSksCi8qIDEwNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGZsb29yID0gTWF0aC5mbG9vcjsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0ludGVnZXIoaXQpIHsKIHJldHVybiAhaXNPYmplY3QoaXQpICYmIGlzRmluaXRlKGl0KSAmJiBmbG9vcihpdCkgPT09IGl0Owp9OwoKLyoqKi8gfSksCi8qIDEwOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDEwOSk7CgovKioqLyB9KSwKLyogMTA5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBBcnJheUJ1ZmZlclZpZXdDb3JlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTApOwp2YXIgc3BlY2llc0NvbnN0cnVjdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTIpOwp2YXIgZmFpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKdmFyIGFUeXBlZEFycmF5ID0gQXJyYXlCdWZmZXJWaWV3Q29yZS5hVHlwZWRBcnJheTsKdmFyIGFUeXBlZEFycmF5Q29uc3RydWN0b3IgPSBBcnJheUJ1ZmZlclZpZXdDb3JlLmFUeXBlZEFycmF5Q29uc3RydWN0b3I7CnZhciBleHBvcnRUeXBlZEFycmF5TWV0aG9kID0gQXJyYXlCdWZmZXJWaWV3Q29yZS5leHBvcnRUeXBlZEFycmF5TWV0aG9kOwp2YXIgJHNsaWNlID0gW10uc2xpY2U7CnZhciBGT1JDRUQgPSBmYWlscyhmdW5jdGlvbiAoKSB7CiBuZXcgSW50OEFycmF5KDEpLnNsaWNlKCk7Cn0pOwpleHBvcnRUeXBlZEFycmF5TWV0aG9kKCdzbGljZScsIGZ1bmN0aW9uIHNsaWNlKHN0YXJ0LCBlbmQpIHsKIHZhciBsaXN0ID0gJHNsaWNlLmNhbGwoYVR5cGVkQXJyYXkodGhpcyksIHN0YXJ0LCBlbmQpOwogdmFyIEMgPSBzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7CiB2YXIgaW5kZXggPSAwOwogdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoOwogdmFyIHJlc3VsdCA9IG5ldyAoYVR5cGVkQXJyYXlDb25zdHJ1Y3RvcihDKSkobGVuZ3RoKTsKIHdoaWxlIChsZW5ndGggPiBpbmRleCkKICByZXN1bHRbaW5kZXhdID0gbGlzdFtpbmRleCsrXTsKIHJldHVybiByZXN1bHQ7Cn0sIEZPUkNFRCk7CgovKioqLyB9KSwKLyogMTEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBOQVRJVkVfQVJSQVlfQlVGRkVSID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTEpOwp2YXIgREVTQ1JJUFRPUlMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzKTsKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgY2xhc3NvZiA9IF9fd19wZGZqc19yZXF1aXJlX18oOTUpOwp2YXIgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5ID0gX193X3BkZmpzX3JlcXVpcmVfXygyNik7CnZhciByZWRlZmluZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjkpOwp2YXIgZGVmaW5lUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI3KS5mOwp2YXIgZ2V0UHJvdG90eXBlT2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgyKTsKdmFyIHNldFByb3RvdHlwZU9mID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Nyk7CnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIHVpZCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzgpOwp2YXIgSW50OEFycmF5ID0gZ2xvYmFsLkludDhBcnJheTsKdmFyIEludDhBcnJheVByb3RvdHlwZSA9IEludDhBcnJheSAmJiBJbnQ4QXJyYXkucHJvdG90eXBlOwp2YXIgVWludDhDbGFtcGVkQXJyYXkgPSBnbG9iYWwuVWludDhDbGFtcGVkQXJyYXk7CnZhciBVaW50OENsYW1wZWRBcnJheVByb3RvdHlwZSA9IFVpbnQ4Q2xhbXBlZEFycmF5ICYmIFVpbnQ4Q2xhbXBlZEFycmF5LnByb3RvdHlwZTsKdmFyIFR5cGVkQXJyYXkgPSBJbnQ4QXJyYXkgJiYgZ2V0UHJvdG90eXBlT2YoSW50OEFycmF5KTsKdmFyIFR5cGVkQXJyYXlQcm90b3R5cGUgPSBJbnQ4QXJyYXlQcm90b3R5cGUgJiYgZ2V0UHJvdG90eXBlT2YoSW50OEFycmF5UHJvdG90eXBlKTsKdmFyIE9iamVjdFByb3RvdHlwZSA9IE9iamVjdC5wcm90b3R5cGU7CnZhciBpc1Byb3RvdHlwZU9mID0gT2JqZWN0UHJvdG90eXBlLmlzUHJvdG90eXBlT2Y7CnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpOwp2YXIgVFlQRURfQVJSQVlfVEFHID0gdWlkKCdUWVBFRF9BUlJBWV9UQUcnKTsKdmFyIE5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgPSBOQVRJVkVfQVJSQVlfQlVGRkVSICYmICEhc2V0UHJvdG90eXBlT2YgJiYgY2xhc3NvZihnbG9iYWwub3BlcmEpICE9PSAnT3BlcmEnOwp2YXIgVFlQRURfQVJSQVlfVEFHX1JFUUlSRUQgPSBmYWxzZTsKdmFyIE5BTUU7CnZhciBUeXBlZEFycmF5Q29uc3RydWN0b3JzTGlzdCA9IHsKIEludDhBcnJheTogMSwKIFVpbnQ4QXJyYXk6IDEsCiBVaW50OENsYW1wZWRBcnJheTogMSwKIEludDE2QXJyYXk6IDIsCiBVaW50MTZBcnJheTogMiwKIEludDMyQXJyYXk6IDQsCiBVaW50MzJBcnJheTogNCwKIEZsb2F0MzJBcnJheTogNCwKIEZsb2F0NjRBcnJheTogOAp9Owp2YXIgaXNWaWV3ID0gZnVuY3Rpb24gaXNWaWV3KGl0KSB7CiB2YXIga2xhc3MgPSBjbGFzc29mKGl0KTsKIHJldHVybiBrbGFzcyA9PT0gJ0RhdGFWaWV3JyB8fCBoYXMoVHlwZWRBcnJheUNvbnN0cnVjdG9yc0xpc3QsIGtsYXNzKTsKfTsKdmFyIGlzVHlwZWRBcnJheSA9IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIGlzT2JqZWN0KGl0KSAmJiBoYXMoVHlwZWRBcnJheUNvbnN0cnVjdG9yc0xpc3QsIGNsYXNzb2YoaXQpKTsKfTsKdmFyIGFUeXBlZEFycmF5ID0gZnVuY3Rpb24gKGl0KSB7CiBpZiAoaXNUeXBlZEFycmF5KGl0KSkKICByZXR1cm4gaXQ7CiB0aHJvdyBUeXBlRXJyb3IoJ1RhcmdldCBpcyBub3QgYSB0eXBlZCBhcnJheScpOwp9Owp2YXIgYVR5cGVkQXJyYXlDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uIChDKSB7CiBpZiAoc2V0UHJvdG90eXBlT2YpIHsKICBpZiAoaXNQcm90b3R5cGVPZi5jYWxsKFR5cGVkQXJyYXksIEMpKQogICByZXR1cm4gQzsKIH0gZWxzZQogIGZvciAodmFyIEFSUkFZIGluIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0KQogICBpZiAoaGFzKFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0LCBOQU1FKSkgewogICAgdmFyIFR5cGVkQXJyYXlDb25zdHJ1Y3RvciA9IGdsb2JhbFtBUlJBWV07CiAgICBpZiAoVHlwZWRBcnJheUNvbnN0cnVjdG9yICYmIChDID09PSBUeXBlZEFycmF5Q29uc3RydWN0b3IgfHwgaXNQcm90b3R5cGVPZi5jYWxsKFR5cGVkQXJyYXlDb25zdHJ1Y3RvciwgQykpKSB7CiAgICAgcmV0dXJuIEM7CiAgICB9CiAgIH0KIHRocm93IFR5cGVFcnJvcignVGFyZ2V0IGlzIG5vdCBhIHR5cGVkIGFycmF5IGNvbnN0cnVjdG9yJyk7Cn07CnZhciBleHBvcnRUeXBlZEFycmF5TWV0aG9kID0gZnVuY3Rpb24gKEtFWSwgcHJvcGVydHksIGZvcmNlZCkgewogaWYgKCFERVNDUklQVE9SUykKICByZXR1cm47CiBpZiAoZm9yY2VkKQogIGZvciAodmFyIEFSUkFZIGluIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0KSB7CiAgIHZhciBUeXBlZEFycmF5Q29uc3RydWN0b3IgPSBnbG9iYWxbQVJSQVldOwogICBpZiAoVHlwZWRBcnJheUNvbnN0cnVjdG9yICYmIGhhcyhUeXBlZEFycmF5Q29uc3RydWN0b3IucHJvdG90eXBlLCBLRVkpKSB7CiAgICBkZWxldGUgVHlwZWRBcnJheUNvbnN0cnVjdG9yLnByb3RvdHlwZVtLRVldOwogICB9CiAgfQogaWYgKCFUeXBlZEFycmF5UHJvdG90eXBlW0tFWV0gfHwgZm9yY2VkKSB7CiAgcmVkZWZpbmUoVHlwZWRBcnJheVByb3RvdHlwZSwgS0VZLCBmb3JjZWQgPyBwcm9wZXJ0eSA6IE5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgJiYgSW50OEFycmF5UHJvdG90eXBlW0tFWV0gfHwgcHJvcGVydHkpOwogfQp9Owp2YXIgZXhwb3J0VHlwZWRBcnJheVN0YXRpY01ldGhvZCA9IGZ1bmN0aW9uIChLRVksIHByb3BlcnR5LCBmb3JjZWQpIHsKIHZhciBBUlJBWSwgVHlwZWRBcnJheUNvbnN0cnVjdG9yOwogaWYgKCFERVNDUklQVE9SUykKICByZXR1cm47CiBpZiAoc2V0UHJvdG90eXBlT2YpIHsKICBpZiAoZm9yY2VkKQogICBmb3IgKEFSUkFZIGluIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcnNMaXN0KSB7CiAgICBUeXBlZEFycmF5Q29uc3RydWN0b3IgPSBnbG9iYWxbQVJSQVldOwogICAgaWYgKFR5cGVkQXJyYXlDb25zdHJ1Y3RvciAmJiBoYXMoVHlwZWRBcnJheUNvbnN0cnVjdG9yLCBLRVkpKSB7CiAgICAgZGVsZXRlIFR5cGVkQXJyYXlDb25zdHJ1Y3RvcltLRVldOwogICAgfQogICB9CiAgaWYgKCFUeXBlZEFycmF5W0tFWV0gfHwgZm9yY2VkKSB7CiAgIHRyeSB7CiAgICByZXR1cm4gcmVkZWZpbmUoVHlwZWRBcnJheSwgS0VZLCBmb3JjZWQgPyBwcm9wZXJ0eSA6IE5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgJiYgSW50OEFycmF5W0tFWV0gfHwgcHJvcGVydHkpOwogICB9IGNhdGNoIChlcnJvcikgewogICB9CiAgfSBlbHNlCiAgIHJldHVybjsKIH0KIGZvciAoQVJSQVkgaW4gVHlwZWRBcnJheUNvbnN0cnVjdG9yc0xpc3QpIHsKICBUeXBlZEFycmF5Q29uc3RydWN0b3IgPSBnbG9iYWxbQVJSQVldOwogIGlmIChUeXBlZEFycmF5Q29uc3RydWN0b3IgJiYgKCFUeXBlZEFycmF5Q29uc3RydWN0b3JbS0VZXSB8fCBmb3JjZWQpKSB7CiAgIHJlZGVmaW5lKFR5cGVkQXJyYXlDb25zdHJ1Y3RvciwgS0VZLCBwcm9wZXJ0eSk7CiAgfQogfQp9Owpmb3IgKE5BTUUgaW4gVHlwZWRBcnJheUNvbnN0cnVjdG9yc0xpc3QpIHsKIGlmICghZ2xvYmFsW05BTUVdKQogIE5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgPSBmYWxzZTsKfQppZiAoIU5BVElWRV9BUlJBWV9CVUZGRVJfVklFV1MgfHwgdHlwZW9mIFR5cGVkQXJyYXkgIT0gJ2Z1bmN0aW9uJyB8fCBUeXBlZEFycmF5ID09PSBGdW5jdGlvbi5wcm90b3R5cGUpIHsKIFR5cGVkQXJyYXkgPSBmdW5jdGlvbiBUeXBlZEFycmF5KCkgewogIHRocm93IFR5cGVFcnJvcignSW5jb3JyZWN0IGludm9jYXRpb24nKTsKIH07CiBpZiAoTkFUSVZFX0FSUkFZX0JVRkZFUl9WSUVXUykKICBmb3IgKE5BTUUgaW4gVHlwZWRBcnJheUNvbnN0cnVjdG9yc0xpc3QpIHsKICAgaWYgKGdsb2JhbFtOQU1FXSkKICAgIHNldFByb3RvdHlwZU9mKGdsb2JhbFtOQU1FXSwgVHlwZWRBcnJheSk7CiAgfQp9CmlmICghTkFUSVZFX0FSUkFZX0JVRkZFUl9WSUVXUyB8fCAhVHlwZWRBcnJheVByb3RvdHlwZSB8fCBUeXBlZEFycmF5UHJvdG90eXBlID09PSBPYmplY3RQcm90b3R5cGUpIHsKIFR5cGVkQXJyYXlQcm90b3R5cGUgPSBUeXBlZEFycmF5LnByb3RvdHlwZTsKIGlmIChOQVRJVkVfQVJSQVlfQlVGRkVSX1ZJRVdTKQogIGZvciAoTkFNRSBpbiBUeXBlZEFycmF5Q29uc3RydWN0b3JzTGlzdCkgewogICBpZiAoZ2xvYmFsW05BTUVdKQogICAgc2V0UHJvdG90eXBlT2YoZ2xvYmFsW05BTUVdLnByb3RvdHlwZSwgVHlwZWRBcnJheVByb3RvdHlwZSk7CiAgfQp9CmlmIChOQVRJVkVfQVJSQVlfQlVGRkVSX1ZJRVdTICYmIGdldFByb3RvdHlwZU9mKFVpbnQ4Q2xhbXBlZEFycmF5UHJvdG90eXBlKSAhPT0gVHlwZWRBcnJheVByb3RvdHlwZSkgewogc2V0UHJvdG90eXBlT2YoVWludDhDbGFtcGVkQXJyYXlQcm90b3R5cGUsIFR5cGVkQXJyYXlQcm90b3R5cGUpOwp9CmlmIChERVNDUklQVE9SUyAmJiAhaGFzKFR5cGVkQXJyYXlQcm90b3R5cGUsIFRPX1NUUklOR19UQUcpKSB7CiBUWVBFRF9BUlJBWV9UQUdfUkVRSVJFRCA9IHRydWU7CiBkZWZpbmVQcm9wZXJ0eShUeXBlZEFycmF5UHJvdG90eXBlLCBUT19TVFJJTkdfVEFHLCB7CiAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgIHJldHVybiBpc09iamVjdCh0aGlzKSA/IHRoaXNbVFlQRURfQVJSQVlfVEFHXSA6IHVuZGVmaW5lZDsKICB9CiB9KTsKIGZvciAoTkFNRSBpbiBUeXBlZEFycmF5Q29uc3RydWN0b3JzTGlzdCkKICBpZiAoZ2xvYmFsW05BTUVdKSB7CiAgIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShnbG9iYWxbTkFNRV0sIFRZUEVEX0FSUkFZX1RBRywgTkFNRSk7CiAgfQp9Cm1vZHVsZS5leHBvcnRzID0gewogTkFUSVZFX0FSUkFZX0JVRkZFUl9WSUVXUzogTkFUSVZFX0FSUkFZX0JVRkZFUl9WSUVXUywKIFRZUEVEX0FSUkFZX1RBRzogVFlQRURfQVJSQVlfVEFHX1JFUUlSRUQgJiYgVFlQRURfQVJSQVlfVEFHLAogYVR5cGVkQXJyYXk6IGFUeXBlZEFycmF5LAogYVR5cGVkQXJyYXlDb25zdHJ1Y3RvcjogYVR5cGVkQXJyYXlDb25zdHJ1Y3RvciwKIGV4cG9ydFR5cGVkQXJyYXlNZXRob2Q6IGV4cG9ydFR5cGVkQXJyYXlNZXRob2QsCiBleHBvcnRUeXBlZEFycmF5U3RhdGljTWV0aG9kOiBleHBvcnRUeXBlZEFycmF5U3RhdGljTWV0aG9kLAogaXNWaWV3OiBpc1ZpZXcsCiBpc1R5cGVkQXJyYXk6IGlzVHlwZWRBcnJheSwKIFR5cGVkQXJyYXk6IFR5cGVkQXJyYXksCiBUeXBlZEFycmF5UHJvdG90eXBlOiBUeXBlZEFycmF5UHJvdG90eXBlCn07CgovKioqLyB9KSwKLyogMTExICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gdHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgRGF0YVZpZXcgIT09ICd1bmRlZmluZWQnOwoKLyoqKi8gfSksCi8qIDExMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgYW5PYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI4KTsKdmFyIGFGdW5jdGlvbiA9IF9fd19wZGZqc19yZXF1aXJlX18oNjMpOwp2YXIgd2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Nyk7CnZhciBTUEVDSUVTID0gd2VsbEtub3duU3ltYm9sKCdzcGVjaWVzJyk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKE8sIGRlZmF1bHRDb25zdHJ1Y3RvcikgewogdmFyIEMgPSBhbk9iamVjdChPKS5jb25zdHJ1Y3RvcjsKIHZhciBTOwogcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBkZWZhdWx0Q29uc3RydWN0b3IgOiBhRnVuY3Rpb24oUyk7Cn07CgovKioqLyB9KSwKLyogMTEzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCl9fd19wZGZqc19yZXF1aXJlX18oMTE0KTsKX193X3BkZmpzX3JlcXVpcmVfXyg3Nyk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTE2KTsKX193X3BkZmpzX3JlcXVpcmVfXygxMTkpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDEzNCk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTM1KTsKdmFyIHBhdGggPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQzKTsKbW9kdWxlLmV4cG9ydHMgPSBwYXRoLlByb21pc2U7CgovKioqLyB9KSwKLyogMTE0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBUT19TVFJJTkdfVEFHX1NVUFBPUlQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk2KTsKdmFyIHJlZGVmaW5lID0gX193X3BkZmpzX3JlcXVpcmVfXygyOSk7CnZhciB0b1N0cmluZyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTE1KTsKaWYgKCFUT19TVFJJTkdfVEFHX1NVUFBPUlQpIHsKIHJlZGVmaW5lKE9iamVjdC5wcm90b3R5cGUsICd0b1N0cmluZycsIHRvU3RyaW5nLCB7IHVuc2FmZTogdHJ1ZSB9KTsKfQoKLyoqKi8gfSksCi8qIDExNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgVE9fU1RSSU5HX1RBR19TVVBQT1JUID0gX193X3BkZmpzX3JlcXVpcmVfXyg5Nik7CnZhciBjbGFzc29mID0gX193X3BkZmpzX3JlcXVpcmVfXyg5NSk7Cm1vZHVsZS5leHBvcnRzID0gVE9fU1RSSU5HX1RBR19TVVBQT1JUID8ge30udG9TdHJpbmcgOiBmdW5jdGlvbiB0b1N0cmluZygpIHsKIHJldHVybiAnW29iamVjdCAnICsgY2xhc3NvZih0aGlzKSArICddJzsKfTsKCi8qKiovIH0pLAovKiAxMTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgRE9NSXRlcmFibGVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMTcpOwp2YXIgQXJyYXlJdGVyYXRvck1ldGhvZHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExOCk7CnZhciBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI2KTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgSVRFUkFUT1IgPSB3ZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7CnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpOwp2YXIgQXJyYXlWYWx1ZXMgPSBBcnJheUl0ZXJhdG9yTWV0aG9kcy52YWx1ZXM7CmZvciAodmFyIENPTExFQ1RJT05fTkFNRSBpbiBET01JdGVyYWJsZXMpIHsKIHZhciBDb2xsZWN0aW9uID0gZ2xvYmFsW0NPTExFQ1RJT05fTkFNRV07CiB2YXIgQ29sbGVjdGlvblByb3RvdHlwZSA9IENvbGxlY3Rpb24gJiYgQ29sbGVjdGlvbi5wcm90b3R5cGU7CiBpZiAoQ29sbGVjdGlvblByb3RvdHlwZSkgewogIGlmIChDb2xsZWN0aW9uUHJvdG90eXBlW0lURVJBVE9SXSAhPT0gQXJyYXlWYWx1ZXMpCiAgIHRyeSB7CiAgICBjcmVhdGVOb25FbnVtZXJhYmxlUHJvcGVydHkoQ29sbGVjdGlvblByb3RvdHlwZSwgSVRFUkFUT1IsIEFycmF5VmFsdWVzKTsKICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIENvbGxlY3Rpb25Qcm90b3R5cGVbSVRFUkFUT1JdID0gQXJyYXlWYWx1ZXM7CiAgIH0KICBpZiAoIUNvbGxlY3Rpb25Qcm90b3R5cGVbVE9fU1RSSU5HX1RBR10pIHsKICAgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5KENvbGxlY3Rpb25Qcm90b3R5cGUsIFRPX1NUUklOR19UQUcsIENPTExFQ1RJT05fTkFNRSk7CiAgfQogIGlmIChET01JdGVyYWJsZXNbQ09MTEVDVElPTl9OQU1FXSkKICAgZm9yICh2YXIgTUVUSE9EX05BTUUgaW4gQXJyYXlJdGVyYXRvck1ldGhvZHMpIHsKICAgIGlmIChDb2xsZWN0aW9uUHJvdG90eXBlW01FVEhPRF9OQU1FXSAhPT0gQXJyYXlJdGVyYXRvck1ldGhvZHNbTUVUSE9EX05BTUVdKQogICAgIHRyeSB7CiAgICAgIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eShDb2xsZWN0aW9uUHJvdG90eXBlLCBNRVRIT0RfTkFNRSwgQXJyYXlJdGVyYXRvck1ldGhvZHNbTUVUSE9EX05BTUVdKTsKICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICBDb2xsZWN0aW9uUHJvdG90eXBlW01FVEhPRF9OQU1FXSA9IEFycmF5SXRlcmF0b3JNZXRob2RzW01FVEhPRF9OQU1FXTsKICAgICB9CiAgIH0KIH0KfQoKLyoqKi8gfSksCi8qIDExNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7Cgptb2R1bGUuZXhwb3J0cyA9IHsKIENTU1J1bGVMaXN0OiAwLAogQ1NTU3R5bGVEZWNsYXJhdGlvbjogMCwKIENTU1ZhbHVlTGlzdDogMCwKIENsaWVudFJlY3RMaXN0OiAwLAogRE9NUmVjdExpc3Q6IDAsCiBET01TdHJpbmdMaXN0OiAwLAogRE9NVG9rZW5MaXN0OiAxLAogRGF0YVRyYW5zZmVySXRlbUxpc3Q6IDAsCiBGaWxlTGlzdDogMCwKIEhUTUxBbGxDb2xsZWN0aW9uOiAwLAogSFRNTENvbGxlY3Rpb246IDAsCiBIVE1MRm9ybUVsZW1lbnQ6IDAsCiBIVE1MU2VsZWN0RWxlbWVudDogMCwKIE1lZGlhTGlzdDogMCwKIE1pbWVUeXBlQXJyYXk6IDAsCiBOYW1lZE5vZGVNYXA6IDAsCiBOb2RlTGlzdDogMSwKIFBhaW50UmVxdWVzdExpc3Q6IDAsCiBQbHVnaW46IDAsCiBQbHVnaW5BcnJheTogMCwKIFNWR0xlbmd0aExpc3Q6IDAsCiBTVkdOdW1iZXJMaXN0OiAwLAogU1ZHUGF0aFNlZ0xpc3Q6IDAsCiBTVkdQb2ludExpc3Q6IDAsCiBTVkdTdHJpbmdMaXN0OiAwLAogU1ZHVHJhbnNmb3JtTGlzdDogMCwKIFNvdXJjZUJ1ZmZlckxpc3Q6IDAsCiBTdHlsZVNoZWV0TGlzdDogMCwKIFRleHRUcmFja0N1ZUxpc3Q6IDAsCiBUZXh0VHJhY2tMaXN0OiAwLAogVG91Y2hMaXN0OiAwCn07CgovKioqLyB9KSwKLyogMTE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciB0b0luZGV4ZWRPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3KTsKdmFyIGFkZFRvVW5zY29wYWJsZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcwKTsKdmFyIEl0ZXJhdG9ycyA9IF9fd19wZGZqc19yZXF1aXJlX18oODYpOwp2YXIgSW50ZXJuYWxTdGF0ZU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzMpOwp2YXIgZGVmaW5lSXRlcmF0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc5KTsKdmFyIEFSUkFZX0lURVJBVE9SID0gJ0FycmF5IEl0ZXJhdG9yJzsKdmFyIHNldEludGVybmFsU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLnNldDsKdmFyIGdldEludGVybmFsU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLmdldHRlckZvcihBUlJBWV9JVEVSQVRPUik7Cm1vZHVsZS5leHBvcnRzID0gZGVmaW5lSXRlcmF0b3IoQXJyYXksICdBcnJheScsIGZ1bmN0aW9uIChpdGVyYXRlZCwga2luZCkgewogc2V0SW50ZXJuYWxTdGF0ZSh0aGlzLCB7CiAgdHlwZTogQVJSQVlfSVRFUkFUT1IsCiAgdGFyZ2V0OiB0b0luZGV4ZWRPYmplY3QoaXRlcmF0ZWQpLAogIGluZGV4OiAwLAogIGtpbmQ6IGtpbmQKIH0pOwp9LCBmdW5jdGlvbiAoKSB7CiB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpOwogdmFyIHRhcmdldCA9IHN0YXRlLnRhcmdldDsKIHZhciBraW5kID0gc3RhdGUua2luZDsKIHZhciBpbmRleCA9IHN0YXRlLmluZGV4Kys7CiBpZiAoIXRhcmdldCB8fCBpbmRleCA+PSB0YXJnZXQubGVuZ3RoKSB7CiAgc3RhdGUudGFyZ2V0ID0gdW5kZWZpbmVkOwogIHJldHVybiB7CiAgIHZhbHVlOiB1bmRlZmluZWQsCiAgIGRvbmU6IHRydWUKICB9OwogfQogaWYgKGtpbmQgPT0gJ2tleXMnKQogIHJldHVybiB7CiAgIHZhbHVlOiBpbmRleCwKICAgZG9uZTogZmFsc2UKICB9OwogaWYgKGtpbmQgPT0gJ3ZhbHVlcycpCiAgcmV0dXJuIHsKICAgdmFsdWU6IHRhcmdldFtpbmRleF0sCiAgIGRvbmU6IGZhbHNlCiAgfTsKIHJldHVybiB7CiAgdmFsdWU6IFsKICAgaW5kZXgsCiAgIHRhcmdldFtpbmRleF0KICBdLAogIGRvbmU6IGZhbHNlCiB9Owp9LCAndmFsdWVzJyk7Ckl0ZXJhdG9ycy5Bcmd1bWVudHMgPSBJdGVyYXRvcnMuQXJyYXk7CmFkZFRvVW5zY29wYWJsZXMoJ2tleXMnKTsKYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7CmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsKCi8qKiovIH0pLAovKiAxMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIElTX1BVUkUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM3KTsKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgZ2V0QnVpbHRJbiA9IF9fd19wZGZqc19yZXF1aXJlX18oNDIpOwp2YXIgTmF0aXZlUHJvbWlzZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTIwKTsKdmFyIHJlZGVmaW5lID0gX193X3BkZmpzX3JlcXVpcmVfXygyOSk7CnZhciByZWRlZmluZUFsbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTIxKTsKdmFyIHNldFRvU3RyaW5nVGFnID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7CnZhciBzZXRTcGVjaWVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjIpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGFGdW5jdGlvbiA9IF9fd19wZGZqc19yZXF1aXJlX18oNjMpOwp2YXIgYW5JbnN0YW5jZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTIzKTsKdmFyIGNsYXNzb2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5KTsKdmFyIGluc3BlY3RTb3VyY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDMxKTsKdmFyIGl0ZXJhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyNCk7CnZhciBjaGVja0NvcnJlY3RuZXNzT2ZJdGVyYXRpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk3KTsKdmFyIHNwZWNpZXNDb25zdHJ1Y3RvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEyKTsKdmFyIHRhc2sgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyNSkuc2V0Owp2YXIgbWljcm90YXNrID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjgpOwp2YXIgcHJvbWlzZVJlc29sdmUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyOSk7CnZhciBob3N0UmVwb3J0RXJyb3JzID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzEpOwp2YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHlNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzMCk7CnZhciBwZXJmb3JtID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzIpOwp2YXIgSW50ZXJuYWxTdGF0ZU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzMpOwp2YXIgaXNGb3JjZWQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUyKTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgVjhfVkVSU0lPTiA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMzKTsKdmFyIFNQRUNJRVMgPSB3ZWxsS25vd25TeW1ib2woJ3NwZWNpZXMnKTsKdmFyIFBST01JU0UgPSAnUHJvbWlzZSc7CnZhciBnZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5nZXQ7CnZhciBzZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5zZXQ7CnZhciBnZXRJbnRlcm5hbFByb21pc2VTdGF0ZSA9IEludGVybmFsU3RhdGVNb2R1bGUuZ2V0dGVyRm9yKFBST01JU0UpOwp2YXIgUHJvbWlzZUNvbnN0cnVjdG9yID0gTmF0aXZlUHJvbWlzZTsKdmFyIFR5cGVFcnJvciA9IGdsb2JhbC5UeXBlRXJyb3I7CnZhciBkb2N1bWVudCA9IGdsb2JhbC5kb2N1bWVudDsKdmFyIHByb2Nlc3MgPSBnbG9iYWwucHJvY2VzczsKdmFyICRmZXRjaCA9IGdldEJ1aWx0SW4oJ2ZldGNoJyk7CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5TW9kdWxlLmY7CnZhciBuZXdHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eTsKdmFyIElTX05PREUgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJzsKdmFyIERJU1BBVENIX0VWRU5UID0gISEoZG9jdW1lbnQgJiYgZG9jdW1lbnQuY3JlYXRlRXZlbnQgJiYgZ2xvYmFsLmRpc3BhdGNoRXZlbnQpOwp2YXIgVU5IQU5ETEVEX1JFSkVDVElPTiA9ICd1bmhhbmRsZWRyZWplY3Rpb24nOwp2YXIgUkVKRUNUSU9OX0hBTkRMRUQgPSAncmVqZWN0aW9uaGFuZGxlZCc7CnZhciBQRU5ESU5HID0gMDsKdmFyIEZVTEZJTExFRCA9IDE7CnZhciBSRUpFQ1RFRCA9IDI7CnZhciBIQU5ETEVEID0gMTsKdmFyIFVOSEFORExFRCA9IDI7CnZhciBJbnRlcm5hbCwgT3duUHJvbWlzZUNhcGFiaWxpdHksIFByb21pc2VXcmFwcGVyLCBuYXRpdmVUaGVuOwp2YXIgRk9SQ0VEID0gaXNGb3JjZWQoUFJPTUlTRSwgZnVuY3Rpb24gKCkgewogdmFyIEdMT0JBTF9DT1JFX0pTX1BST01JU0UgPSBpbnNwZWN0U291cmNlKFByb21pc2VDb25zdHJ1Y3RvcikgIT09IFN0cmluZyhQcm9taXNlQ29uc3RydWN0b3IpOwogaWYgKCFHTE9CQUxfQ09SRV9KU19QUk9NSVNFKSB7CiAgaWYgKFY4X1ZFUlNJT04gPT09IDY2KQogICByZXR1cm4gdHJ1ZTsKICBpZiAoIUlTX05PREUgJiYgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCAhPSAnZnVuY3Rpb24nKQogICByZXR1cm4gdHJ1ZTsKIH0KIGlmIChJU19QVVJFICYmICFQcm9taXNlQ29uc3RydWN0b3IucHJvdG90eXBlWydmaW5hbGx5J10pCiAgcmV0dXJuIHRydWU7CiBpZiAoVjhfVkVSU0lPTiA+PSA1MSAmJiAvbmF0aXZlIGNvZGUvLnRlc3QoUHJvbWlzZUNvbnN0cnVjdG9yKSkKICByZXR1cm4gZmFsc2U7CiB2YXIgcHJvbWlzZSA9IFByb21pc2VDb25zdHJ1Y3Rvci5yZXNvbHZlKDEpOwogdmFyIEZha2VQcm9taXNlID0gZnVuY3Rpb24gKGV4ZWMpIHsKICBleGVjKGZ1bmN0aW9uICgpIHsKICB9LCBmdW5jdGlvbiAoKSB7CiAgfSk7CiB9OwogdmFyIGNvbnN0cnVjdG9yID0gcHJvbWlzZS5jb25zdHJ1Y3RvciA9IHt9OwogY29uc3RydWN0b3JbU1BFQ0lFU10gPSBGYWtlUHJvbWlzZTsKIHJldHVybiAhKHByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7CiB9KSBpbnN0YW5jZW9mIEZha2VQcm9taXNlKTsKfSk7CnZhciBJTkNPUlJFQ1RfSVRFUkFUSU9OID0gRk9SQ0VEIHx8ICFjaGVja0NvcnJlY3RuZXNzT2ZJdGVyYXRpb24oZnVuY3Rpb24gKGl0ZXJhYmxlKSB7CiBQcm9taXNlQ29uc3RydWN0b3IuYWxsKGl0ZXJhYmxlKVsnY2F0Y2gnXShmdW5jdGlvbiAoKSB7CiB9KTsKfSk7CnZhciBpc1RoZW5hYmxlID0gZnVuY3Rpb24gKGl0KSB7CiB2YXIgdGhlbjsKIHJldHVybiBpc09iamVjdChpdCkgJiYgdHlwZW9mICh0aGVuID0gaXQudGhlbikgPT0gJ2Z1bmN0aW9uJyA/IHRoZW4gOiBmYWxzZTsKfTsKdmFyIG5vdGlmeSA9IGZ1bmN0aW9uIChwcm9taXNlLCBzdGF0ZSwgaXNSZWplY3QpIHsKIGlmIChzdGF0ZS5ub3RpZmllZCkKICByZXR1cm47CiBzdGF0ZS5ub3RpZmllZCA9IHRydWU7CiB2YXIgY2hhaW4gPSBzdGF0ZS5yZWFjdGlvbnM7CiBtaWNyb3Rhc2soZnVuY3Rpb24gKCkgewogIHZhciB2YWx1ZSA9IHN0YXRlLnZhbHVlOwogIHZhciBvayA9IHN0YXRlLnN0YXRlID09IEZVTEZJTExFRDsKICB2YXIgaW5kZXggPSAwOwogIHdoaWxlIChjaGFpbi5sZW5ndGggPiBpbmRleCkgewogICB2YXIgcmVhY3Rpb24gPSBjaGFpbltpbmRleCsrXTsKICAgdmFyIGhhbmRsZXIgPSBvayA/IHJlYWN0aW9uLm9rIDogcmVhY3Rpb24uZmFpbDsKICAgdmFyIHJlc29sdmUgPSByZWFjdGlvbi5yZXNvbHZlOwogICB2YXIgcmVqZWN0ID0gcmVhY3Rpb24ucmVqZWN0OwogICB2YXIgZG9tYWluID0gcmVhY3Rpb24uZG9tYWluOwogICB2YXIgcmVzdWx0LCB0aGVuLCBleGl0ZWQ7CiAgIHRyeSB7CiAgICBpZiAoaGFuZGxlcikgewogICAgIGlmICghb2spIHsKICAgICAgaWYgKHN0YXRlLnJlamVjdGlvbiA9PT0gVU5IQU5ETEVEKQogICAgICAgb25IYW5kbGVVbmhhbmRsZWQocHJvbWlzZSwgc3RhdGUpOwogICAgICBzdGF0ZS5yZWplY3Rpb24gPSBIQU5ETEVEOwogICAgIH0KICAgICBpZiAoaGFuZGxlciA9PT0gdHJ1ZSkKICAgICAgcmVzdWx0ID0gdmFsdWU7CiAgICAgZWxzZSB7CiAgICAgIGlmIChkb21haW4pCiAgICAgICBkb21haW4uZW50ZXIoKTsKICAgICAgcmVzdWx0ID0gaGFuZGxlcih2YWx1ZSk7CiAgICAgIGlmIChkb21haW4pIHsKICAgICAgIGRvbWFpbi5leGl0KCk7CiAgICAgICBleGl0ZWQgPSB0cnVlOwogICAgICB9CiAgICAgfQogICAgIGlmIChyZXN1bHQgPT09IHJlYWN0aW9uLnByb21pc2UpIHsKICAgICAgcmVqZWN0KFR5cGVFcnJvcignUHJvbWlzZS1jaGFpbiBjeWNsZScpKTsKICAgICB9IGVsc2UgaWYgKHRoZW4gPSBpc1RoZW5hYmxlKHJlc3VsdCkpIHsKICAgICAgdGhlbi5jYWxsKHJlc3VsdCwgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICB9IGVsc2UKICAgICAgcmVzb2x2ZShyZXN1bHQpOwogICAgfSBlbHNlCiAgICAgcmVqZWN0KHZhbHVlKTsKICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGlmIChkb21haW4gJiYgIWV4aXRlZCkKICAgICBkb21haW4uZXhpdCgpOwogICAgcmVqZWN0KGVycm9yKTsKICAgfQogIH0KICBzdGF0ZS5yZWFjdGlvbnMgPSBbXTsKICBzdGF0ZS5ub3RpZmllZCA9IGZhbHNlOwogIGlmIChpc1JlamVjdCAmJiAhc3RhdGUucmVqZWN0aW9uKQogICBvblVuaGFuZGxlZChwcm9taXNlLCBzdGF0ZSk7CiB9KTsKfTsKdmFyIGRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiAobmFtZSwgcHJvbWlzZSwgcmVhc29uKSB7CiB2YXIgZXZlbnQsIGhhbmRsZXI7CiBpZiAoRElTUEFUQ0hfRVZFTlQpIHsKICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpOwogIGV2ZW50LnByb21pc2UgPSBwcm9taXNlOwogIGV2ZW50LnJlYXNvbiA9IHJlYXNvbjsKICBldmVudC5pbml0RXZlbnQobmFtZSwgZmFsc2UsIHRydWUpOwogIGdsb2JhbC5kaXNwYXRjaEV2ZW50KGV2ZW50KTsKIH0gZWxzZQogIGV2ZW50ID0gewogICBwcm9taXNlOiBwcm9taXNlLAogICByZWFzb246IHJlYXNvbgogIH07CiBpZiAoaGFuZGxlciA9IGdsb2JhbFsnb24nICsgbmFtZV0pCiAgaGFuZGxlcihldmVudCk7CiBlbHNlIGlmIChuYW1lID09PSBVTkhBTkRMRURfUkVKRUNUSU9OKQogIGhvc3RSZXBvcnRFcnJvcnMoJ1VuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbicsIHJlYXNvbik7Cn07CnZhciBvblVuaGFuZGxlZCA9IGZ1bmN0aW9uIChwcm9taXNlLCBzdGF0ZSkgewogdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24gKCkgewogIHZhciB2YWx1ZSA9IHN0YXRlLnZhbHVlOwogIHZhciBJU19VTkhBTkRMRUQgPSBpc1VuaGFuZGxlZChzdGF0ZSk7CiAgdmFyIHJlc3VsdDsKICBpZiAoSVNfVU5IQU5ETEVEKSB7CiAgIHJlc3VsdCA9IHBlcmZvcm0oZnVuY3Rpb24gKCkgewogICAgaWYgKElTX05PREUpIHsKICAgICBwcm9jZXNzLmVtaXQoJ3VuaGFuZGxlZFJlamVjdGlvbicsIHZhbHVlLCBwcm9taXNlKTsKICAgIH0gZWxzZQogICAgIGRpc3BhdGNoRXZlbnQoVU5IQU5ETEVEX1JFSkVDVElPTiwgcHJvbWlzZSwgdmFsdWUpOwogICB9KTsKICAgc3RhdGUucmVqZWN0aW9uID0gSVNfTk9ERSB8fCBpc1VuaGFuZGxlZChzdGF0ZSkgPyBVTkhBTkRMRUQgOiBIQU5ETEVEOwogICBpZiAocmVzdWx0LmVycm9yKQogICAgdGhyb3cgcmVzdWx0LnZhbHVlOwogIH0KIH0pOwp9Owp2YXIgaXNVbmhhbmRsZWQgPSBmdW5jdGlvbiAoc3RhdGUpIHsKIHJldHVybiBzdGF0ZS5yZWplY3Rpb24gIT09IEhBTkRMRUQgJiYgIXN0YXRlLnBhcmVudDsKfTsKdmFyIG9uSGFuZGxlVW5oYW5kbGVkID0gZnVuY3Rpb24gKHByb21pc2UsIHN0YXRlKSB7CiB0YXNrLmNhbGwoZ2xvYmFsLCBmdW5jdGlvbiAoKSB7CiAgaWYgKElTX05PREUpIHsKICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7CiAgfSBlbHNlCiAgIGRpc3BhdGNoRXZlbnQoUkVKRUNUSU9OX0hBTkRMRUQsIHByb21pc2UsIHN0YXRlLnZhbHVlKTsKIH0pOwp9Owp2YXIgYmluZCA9IGZ1bmN0aW9uIChmbiwgcHJvbWlzZSwgc3RhdGUsIHVud3JhcCkgewogcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkgewogIGZuKHByb21pc2UsIHN0YXRlLCB2YWx1ZSwgdW53cmFwKTsKIH07Cn07CnZhciBpbnRlcm5hbFJlamVjdCA9IGZ1bmN0aW9uIChwcm9taXNlLCBzdGF0ZSwgdmFsdWUsIHVud3JhcCkgewogaWYgKHN0YXRlLmRvbmUpCiAgcmV0dXJuOwogc3RhdGUuZG9uZSA9IHRydWU7CiBpZiAodW53cmFwKQogIHN0YXRlID0gdW53cmFwOwogc3RhdGUudmFsdWUgPSB2YWx1ZTsKIHN0YXRlLnN0YXRlID0gUkVKRUNURUQ7CiBub3RpZnkocHJvbWlzZSwgc3RhdGUsIHRydWUpOwp9Owp2YXIgaW50ZXJuYWxSZXNvbHZlID0gZnVuY3Rpb24gKHByb21pc2UsIHN0YXRlLCB2YWx1ZSwgdW53cmFwKSB7CiBpZiAoc3RhdGUuZG9uZSkKICByZXR1cm47CiBzdGF0ZS5kb25lID0gdHJ1ZTsKIGlmICh1bndyYXApCiAgc3RhdGUgPSB1bndyYXA7CiB0cnkgewogIGlmIChwcm9taXNlID09PSB2YWx1ZSkKICAgdGhyb3cgVHlwZUVycm9yKCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZiIpOwogIHZhciB0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSk7CiAgaWYgKHRoZW4pIHsKICAgbWljcm90YXNrKGZ1bmN0aW9uICgpIHsKICAgIHZhciB3cmFwcGVyID0geyBkb25lOiBmYWxzZSB9OwogICAgdHJ5IHsKICAgICB0aGVuLmNhbGwodmFsdWUsIGJpbmQoaW50ZXJuYWxSZXNvbHZlLCBwcm9taXNlLCB3cmFwcGVyLCBzdGF0ZSksIGJpbmQoaW50ZXJuYWxSZWplY3QsIHByb21pc2UsIHdyYXBwZXIsIHN0YXRlKSk7CiAgICB9IGNhdGNoIChlcnJvcikgewogICAgIGludGVybmFsUmVqZWN0KHByb21pc2UsIHdyYXBwZXIsIGVycm9yLCBzdGF0ZSk7CiAgICB9CiAgIH0pOwogIH0gZWxzZSB7CiAgIHN0YXRlLnZhbHVlID0gdmFsdWU7CiAgIHN0YXRlLnN0YXRlID0gRlVMRklMTEVEOwogICBub3RpZnkocHJvbWlzZSwgc3RhdGUsIGZhbHNlKTsKICB9CiB9IGNhdGNoIChlcnJvcikgewogIGludGVybmFsUmVqZWN0KHByb21pc2UsIHsgZG9uZTogZmFsc2UgfSwgZXJyb3IsIHN0YXRlKTsKIH0KfTsKaWYgKEZPUkNFRCkgewogUHJvbWlzZUNvbnN0cnVjdG9yID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcikgewogIGFuSW5zdGFuY2UodGhpcywgUHJvbWlzZUNvbnN0cnVjdG9yLCBQUk9NSVNFKTsKICBhRnVuY3Rpb24oZXhlY3V0b3IpOwogIEludGVybmFsLmNhbGwodGhpcyk7CiAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZSh0aGlzKTsKICB0cnkgewogICBleGVjdXRvcihiaW5kKGludGVybmFsUmVzb2x2ZSwgdGhpcywgc3RhdGUpLCBiaW5kKGludGVybmFsUmVqZWN0LCB0aGlzLCBzdGF0ZSkpOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgIGludGVybmFsUmVqZWN0KHRoaXMsIHN0YXRlLCBlcnJvcik7CiAgfQogfTsKIEludGVybmFsID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcikgewogIHNldEludGVybmFsU3RhdGUodGhpcywgewogICB0eXBlOiBQUk9NSVNFLAogICBkb25lOiBmYWxzZSwKICAgbm90aWZpZWQ6IGZhbHNlLAogICBwYXJlbnQ6IGZhbHNlLAogICByZWFjdGlvbnM6IFtdLAogICByZWplY3Rpb246IGZhbHNlLAogICBzdGF0ZTogUEVORElORywKICAgdmFsdWU6IHVuZGVmaW5lZAogIH0pOwogfTsKIEludGVybmFsLnByb3RvdHlwZSA9IHJlZGVmaW5lQWxsKFByb21pc2VDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHsKICB0aGVuOiBmdW5jdGlvbiB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7CiAgIHZhciBzdGF0ZSA9IGdldEludGVybmFsUHJvbWlzZVN0YXRlKHRoaXMpOwogICB2YXIgcmVhY3Rpb24gPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgUHJvbWlzZUNvbnN0cnVjdG9yKSk7CiAgIHJlYWN0aW9uLm9rID0gdHlwZW9mIG9uRnVsZmlsbGVkID09ICdmdW5jdGlvbicgPyBvbkZ1bGZpbGxlZCA6IHRydWU7CiAgIHJlYWN0aW9uLmZhaWwgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7CiAgIHJlYWN0aW9uLmRvbWFpbiA9IElTX05PREUgPyBwcm9jZXNzLmRvbWFpbiA6IHVuZGVmaW5lZDsKICAgc3RhdGUucGFyZW50ID0gdHJ1ZTsKICAgc3RhdGUucmVhY3Rpb25zLnB1c2gocmVhY3Rpb24pOwogICBpZiAoc3RhdGUuc3RhdGUgIT0gUEVORElORykKICAgIG5vdGlmeSh0aGlzLCBzdGF0ZSwgZmFsc2UpOwogICByZXR1cm4gcmVhY3Rpb24ucHJvbWlzZTsKICB9LAogICdjYXRjaCc6IGZ1bmN0aW9uIChvblJlamVjdGVkKSB7CiAgIHJldHVybiB0aGlzLnRoZW4odW5kZWZpbmVkLCBvblJlamVjdGVkKTsKICB9CiB9KTsKIE93blByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24gKCkgewogIHZhciBwcm9taXNlID0gbmV3IEludGVybmFsKCk7CiAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZShwcm9taXNlKTsKICB0aGlzLnByb21pc2UgPSBwcm9taXNlOwogIHRoaXMucmVzb2x2ZSA9IGJpbmQoaW50ZXJuYWxSZXNvbHZlLCBwcm9taXNlLCBzdGF0ZSk7CiAgdGhpcy5yZWplY3QgPSBiaW5kKGludGVybmFsUmVqZWN0LCBwcm9taXNlLCBzdGF0ZSk7CiB9OwogbmV3UHJvbWlzZUNhcGFiaWxpdHlNb2R1bGUuZiA9IG5ld1Byb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24gKEMpIHsKICByZXR1cm4gQyA9PT0gUHJvbWlzZUNvbnN0cnVjdG9yIHx8IEMgPT09IFByb21pc2VXcmFwcGVyID8gbmV3IE93blByb21pc2VDYXBhYmlsaXR5KEMpIDogbmV3R2VuZXJpY1Byb21pc2VDYXBhYmlsaXR5KEMpOwogfTsKIGlmICghSVNfUFVSRSAmJiB0eXBlb2YgTmF0aXZlUHJvbWlzZSA9PSAnZnVuY3Rpb24nKSB7CiAgbmF0aXZlVGhlbiA9IE5hdGl2ZVByb21pc2UucHJvdG90eXBlLnRoZW47CiAgcmVkZWZpbmUoTmF0aXZlUHJvbWlzZS5wcm90b3R5cGUsICd0aGVuJywgZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkgewogICB2YXIgdGhhdCA9IHRoaXM7CiAgIHJldHVybiBuZXcgUHJvbWlzZUNvbnN0cnVjdG9yKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIG5hdGl2ZVRoZW4uY2FsbCh0aGF0LCByZXNvbHZlLCByZWplY3QpOwogICB9KS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKTsKICB9LCB7IHVuc2FmZTogdHJ1ZSB9KTsKICBpZiAodHlwZW9mICRmZXRjaCA9PSAnZnVuY3Rpb24nKQogICAkKHsKICAgIGdsb2JhbDogdHJ1ZSwKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBmb3JjZWQ6IHRydWUKICAgfSwgewogICAgZmV0Y2g6IGZ1bmN0aW9uIGZldGNoKGlucHV0KSB7CiAgICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKFByb21pc2VDb25zdHJ1Y3RvciwgJGZldGNoLmFwcGx5KGdsb2JhbCwgYXJndW1lbnRzKSk7CiAgICB9CiAgIH0pOwogfQp9CiQoewogZ2xvYmFsOiB0cnVlLAogd3JhcDogdHJ1ZSwKIGZvcmNlZDogRk9SQ0VECn0sIHsgUHJvbWlzZTogUHJvbWlzZUNvbnN0cnVjdG9yIH0pOwpzZXRUb1N0cmluZ1RhZyhQcm9taXNlQ29uc3RydWN0b3IsIFBST01JU0UsIGZhbHNlLCB0cnVlKTsKc2V0U3BlY2llcyhQUk9NSVNFKTsKUHJvbWlzZVdyYXBwZXIgPSBnZXRCdWlsdEluKFBST01JU0UpOwokKHsKIHRhcmdldDogUFJPTUlTRSwKIHN0YXQ6IHRydWUsCiBmb3JjZWQ6IEZPUkNFRAp9LCB7CiByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdChyKSB7CiAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSh0aGlzKTsKICBjYXBhYmlsaXR5LnJlamVjdC5jYWxsKHVuZGVmaW5lZCwgcik7CiAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKIH0KfSk7CiQoewogdGFyZ2V0OiBQUk9NSVNFLAogc3RhdDogdHJ1ZSwKIGZvcmNlZDogSVNfUFVSRSB8fCBGT1JDRUQKfSwgewogcmVzb2x2ZTogZnVuY3Rpb24gcmVzb2x2ZSh4KSB7CiAgcmV0dXJuIHByb21pc2VSZXNvbHZlKElTX1BVUkUgJiYgdGhpcyA9PT0gUHJvbWlzZVdyYXBwZXIgPyBQcm9taXNlQ29uc3RydWN0b3IgOiB0aGlzLCB4KTsKIH0KfSk7CiQoewogdGFyZ2V0OiBQUk9NSVNFLAogc3RhdDogdHJ1ZSwKIGZvcmNlZDogSU5DT1JSRUNUX0lURVJBVElPTgp9LCB7CiBhbGw6IGZ1bmN0aW9uIGFsbChpdGVyYWJsZSkgewogIHZhciBDID0gdGhpczsKICB2YXIgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpOwogIHZhciByZXNvbHZlID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogIHZhciByZWplY3QgPSBjYXBhYmlsaXR5LnJlamVjdDsKICB2YXIgcmVzdWx0ID0gcGVyZm9ybShmdW5jdGlvbiAoKSB7CiAgIHZhciAkcHJvbWlzZVJlc29sdmUgPSBhRnVuY3Rpb24oQy5yZXNvbHZlKTsKICAgdmFyIHZhbHVlcyA9IFtdOwogICB2YXIgY291bnRlciA9IDA7CiAgIHZhciByZW1haW5pbmcgPSAxOwogICBpdGVyYXRlKGl0ZXJhYmxlLCBmdW5jdGlvbiAocHJvbWlzZSkgewogICAgdmFyIGluZGV4ID0gY291bnRlcisrOwogICAgdmFyIGFscmVhZHlDYWxsZWQgPSBmYWxzZTsKICAgIHZhbHVlcy5wdXNoKHVuZGVmaW5lZCk7CiAgICByZW1haW5pbmcrKzsKICAgICRwcm9taXNlUmVzb2x2ZS5jYWxsKEMsIHByb21pc2UpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgaWYgKGFscmVhZHlDYWxsZWQpCiAgICAgIHJldHVybjsKICAgICBhbHJlYWR5Q2FsbGVkID0gdHJ1ZTsKICAgICB2YWx1ZXNbaW5kZXhdID0gdmFsdWU7CiAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwogICAgfSwgcmVqZWN0KTsKICAgfSk7CiAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICB9KTsKICBpZiAocmVzdWx0LmVycm9yKQogICByZWplY3QocmVzdWx0LnZhbHVlKTsKICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOwogfSwKIHJhY2U6IGZ1bmN0aW9uIHJhY2UoaXRlcmFibGUpIHsKICB2YXIgQyA9IHRoaXM7CiAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShDKTsKICB2YXIgcmVqZWN0ID0gY2FwYWJpbGl0eS5yZWplY3Q7CiAgdmFyIHJlc3VsdCA9IHBlcmZvcm0oZnVuY3Rpb24gKCkgewogICB2YXIgJHByb21pc2VSZXNvbHZlID0gYUZ1bmN0aW9uKEMucmVzb2x2ZSk7CiAgIGl0ZXJhdGUoaXRlcmFibGUsIGZ1bmN0aW9uIChwcm9taXNlKSB7CiAgICAkcHJvbWlzZVJlc29sdmUuY2FsbChDLCBwcm9taXNlKS50aGVuKGNhcGFiaWxpdHkucmVzb2x2ZSwgcmVqZWN0KTsKICAgfSk7CiAgfSk7CiAgaWYgKHJlc3VsdC5lcnJvcikKICAgcmVqZWN0KHJlc3VsdC52YWx1ZSk7CiAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKIH0KfSk7CgovKioqLyB9KSwKLyogMTIwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKbW9kdWxlLmV4cG9ydHMgPSBnbG9iYWwuUHJvbWlzZTsKCi8qKiovIH0pLAovKiAxMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHJlZGVmaW5lID0gX193X3BkZmpzX3JlcXVpcmVfXygyOSk7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHRhcmdldCwgc3JjLCBvcHRpb25zKSB7CiBmb3IgKHZhciBrZXkgaW4gc3JjKQogIHJlZGVmaW5lKHRhcmdldCwga2V5LCBzcmNba2V5XSwgb3B0aW9ucyk7CiByZXR1cm4gdGFyZ2V0Owp9OwoKLyoqKi8gfSksCi8qIDEyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZ2V0QnVpbHRJbiA9IF9fd19wZGZqc19yZXF1aXJlX18oNDIpOwp2YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI3KTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgREVTQ1JJUFRPUlMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzKTsKdmFyIFNQRUNJRVMgPSB3ZWxsS25vd25TeW1ib2woJ3NwZWNpZXMnKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQ09OU1RSVUNUT1JfTkFNRSkgewogdmFyIENvbnN0cnVjdG9yID0gZ2V0QnVpbHRJbihDT05TVFJVQ1RPUl9OQU1FKTsKIHZhciBkZWZpbmVQcm9wZXJ0eSA9IGRlZmluZVByb3BlcnR5TW9kdWxlLmY7CiBpZiAoREVTQ1JJUFRPUlMgJiYgQ29uc3RydWN0b3IgJiYgIUNvbnN0cnVjdG9yW1NQRUNJRVNdKSB7CiAgZGVmaW5lUHJvcGVydHkoQ29uc3RydWN0b3IsIFNQRUNJRVMsIHsKICAgY29uZmlndXJhYmxlOiB0cnVlLAogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzOwogICB9CiAgfSk7CiB9Cn07CgovKioqLyB9KSwKLyogMTIzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSkgewogaWYgKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICB0aHJvdyBUeXBlRXJyb3IoJ0luY29ycmVjdCAnICsgKG5hbWUgPyBuYW1lICsgJyAnIDogJycpICsgJ2ludm9jYXRpb24nKTsKIH0KIHJldHVybiBpdDsKfTsKCi8qKiovIH0pLAovKiAxMjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGFuT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyOCk7CnZhciBpc0FycmF5SXRlcmF0b3JNZXRob2QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkyKTsKdmFyIHRvTGVuZ3RoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Nyk7CnZhciBiaW5kID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Mik7CnZhciBnZXRJdGVyYXRvck1ldGhvZCA9IF9fd19wZGZqc19yZXF1aXJlX18oOTQpOwp2YXIgY2FsbFdpdGhTYWZlSXRlcmF0aW9uQ2xvc2luZyA9IF9fd19wZGZqc19yZXF1aXJlX18oOTEpOwp2YXIgUmVzdWx0ID0gZnVuY3Rpb24gKHN0b3BwZWQsIHJlc3VsdCkgewogdGhpcy5zdG9wcGVkID0gc3RvcHBlZDsKIHRoaXMucmVzdWx0ID0gcmVzdWx0Owp9Owp2YXIgaXRlcmF0ZSA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGl0ZXJhYmxlLCBmbiwgdGhhdCwgQVNfRU5UUklFUywgSVNfSVRFUkFUT1IpIHsKIHZhciBib3VuZEZ1bmN0aW9uID0gYmluZChmbiwgdGhhdCwgQVNfRU5UUklFUyA/IDIgOiAxKTsKIHZhciBpdGVyYXRvciwgaXRlckZuLCBpbmRleCwgbGVuZ3RoLCByZXN1bHQsIG5leHQsIHN0ZXA7CiBpZiAoSVNfSVRFUkFUT1IpIHsKICBpdGVyYXRvciA9IGl0ZXJhYmxlOwogfSBlbHNlIHsKICBpdGVyRm4gPSBnZXRJdGVyYXRvck1ldGhvZChpdGVyYWJsZSk7CiAgaWYgKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJykKICAgdGhyb3cgVHlwZUVycm9yKCdUYXJnZXQgaXMgbm90IGl0ZXJhYmxlJyk7CiAgaWYgKGlzQXJyYXlJdGVyYXRvck1ldGhvZChpdGVyRm4pKSB7CiAgIGZvciAoaW5kZXggPSAwLCBsZW5ndGggPSB0b0xlbmd0aChpdGVyYWJsZS5sZW5ndGgpOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKykgewogICAgcmVzdWx0ID0gQVNfRU5UUklFUyA/IGJvdW5kRnVuY3Rpb24oYW5PYmplY3Qoc3RlcCA9IGl0ZXJhYmxlW2luZGV4XSlbMF0sIHN0ZXBbMV0pIDogYm91bmRGdW5jdGlvbihpdGVyYWJsZVtpbmRleF0pOwogICAgaWYgKHJlc3VsdCAmJiByZXN1bHQgaW5zdGFuY2VvZiBSZXN1bHQpCiAgICAgcmV0dXJuIHJlc3VsdDsKICAgfQogICByZXR1cm4gbmV3IFJlc3VsdChmYWxzZSk7CiAgfQogIGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoaXRlcmFibGUpOwogfQogbmV4dCA9IGl0ZXJhdG9yLm5leHQ7CiB3aGlsZSAoIShzdGVwID0gbmV4dC5jYWxsKGl0ZXJhdG9yKSkuZG9uZSkgewogIHJlc3VsdCA9IGNhbGxXaXRoU2FmZUl0ZXJhdGlvbkNsb3NpbmcoaXRlcmF0b3IsIGJvdW5kRnVuY3Rpb24sIHN0ZXAudmFsdWUsIEFTX0VOVFJJRVMpOwogIGlmICh0eXBlb2YgcmVzdWx0ID09ICdvYmplY3QnICYmIHJlc3VsdCAmJiByZXN1bHQgaW5zdGFuY2VvZiBSZXN1bHQpCiAgIHJldHVybiByZXN1bHQ7CiB9CiByZXR1cm4gbmV3IFJlc3VsdChmYWxzZSk7Cn07Cml0ZXJhdGUuc3RvcCA9IGZ1bmN0aW9uIChyZXN1bHQpIHsKIHJldHVybiBuZXcgUmVzdWx0KHRydWUsIHJlc3VsdCk7Cn07CgovKioqLyB9KSwKLyogMTI1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7CnZhciBjbGFzc29mID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7CnZhciBiaW5kID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Mik7CnZhciBodG1sID0gX193X3BkZmpzX3JlcXVpcmVfXyg3NCk7CnZhciBjcmVhdGVFbGVtZW50ID0gX193X3BkZmpzX3JlcXVpcmVfXygyNSk7CnZhciBJU19JT1MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyNik7CnZhciBsb2NhdGlvbiA9IGdsb2JhbC5sb2NhdGlvbjsKdmFyIHNldCA9IGdsb2JhbC5zZXRJbW1lZGlhdGU7CnZhciBjbGVhciA9IGdsb2JhbC5jbGVhckltbWVkaWF0ZTsKdmFyIHByb2Nlc3MgPSBnbG9iYWwucHJvY2VzczsKdmFyIE1lc3NhZ2VDaGFubmVsID0gZ2xvYmFsLk1lc3NhZ2VDaGFubmVsOwp2YXIgRGlzcGF0Y2ggPSBnbG9iYWwuRGlzcGF0Y2g7CnZhciBjb3VudGVyID0gMDsKdmFyIHF1ZXVlID0ge307CnZhciBPTlJFQURZU1RBVEVDSEFOR0UgPSAnb25yZWFkeXN0YXRlY2hhbmdlJzsKdmFyIGRlZmVyLCBjaGFubmVsLCBwb3J0Owp2YXIgcnVuID0gZnVuY3Rpb24gKGlkKSB7CiBpZiAocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKSB7CiAgdmFyIGZuID0gcXVldWVbaWRdOwogIGRlbGV0ZSBxdWV1ZVtpZF07CiAgZm4oKTsKIH0KfTsKdmFyIHJ1bm5lciA9IGZ1bmN0aW9uIChpZCkgewogcmV0dXJuIGZ1bmN0aW9uICgpIHsKICBydW4oaWQpOwogfTsKfTsKdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50KSB7CiBydW4oZXZlbnQuZGF0YSk7Cn07CnZhciBwb3N0ID0gZnVuY3Rpb24gKGlkKSB7CiBnbG9iYWwucG9zdE1lc3NhZ2UoaWQgKyAnJywgbG9jYXRpb24ucHJvdG9jb2wgKyAnLy8nICsgbG9jYXRpb24uaG9zdCk7Cn07CmlmICghc2V0IHx8ICFjbGVhcikgewogc2V0ID0gZnVuY3Rpb24gc2V0SW1tZWRpYXRlKGZuKSB7CiAgdmFyIGFyZ3MgPSBbXTsKICB2YXIgaSA9IDE7CiAgd2hpbGUgKGFyZ3VtZW50cy5sZW5ndGggPiBpKQogICBhcmdzLnB1c2goYXJndW1lbnRzW2krK10pOwogIHF1ZXVlWysrY291bnRlcl0gPSBmdW5jdGlvbiAoKSB7CiAgICh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pKS5hcHBseSh1bmRlZmluZWQsIGFyZ3MpOwogIH07CiAgZGVmZXIoY291bnRlcik7CiAgcmV0dXJuIGNvdW50ZXI7CiB9OwogY2xlYXIgPSBmdW5jdGlvbiBjbGVhckltbWVkaWF0ZShpZCkgewogIGRlbGV0ZSBxdWV1ZVtpZF07CiB9OwogaWYgKGNsYXNzb2YocHJvY2VzcykgPT0gJ3Byb2Nlc3MnKSB7CiAgZGVmZXIgPSBmdW5jdGlvbiAoaWQpIHsKICAgcHJvY2Vzcy5uZXh0VGljayhydW5uZXIoaWQpKTsKICB9OwogfSBlbHNlIGlmIChEaXNwYXRjaCAmJiBEaXNwYXRjaC5ub3cpIHsKICBkZWZlciA9IGZ1bmN0aW9uIChpZCkgewogICBEaXNwYXRjaC5ub3cocnVubmVyKGlkKSk7CiAgfTsKIH0gZWxzZSBpZiAoTWVzc2FnZUNoYW5uZWwgJiYgIUlTX0lPUykgewogIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTsKICBwb3J0ID0gY2hhbm5lbC5wb3J0MjsKICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGxpc3RlbmVyOwogIGRlZmVyID0gYmluZChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsKIH0gZWxzZSBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIgJiYgdHlwZW9mIHBvc3RNZXNzYWdlID09ICdmdW5jdGlvbicgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzICYmICFmYWlscyhwb3N0KSAmJiBsb2NhdGlvbi5wcm90b2NvbCAhPT0gJ2ZpbGU6JykgewogIGRlZmVyID0gcG9zdDsKICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGxpc3RlbmVyLCBmYWxzZSk7CiB9IGVsc2UgaWYgKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjcmVhdGVFbGVtZW50KCdzY3JpcHQnKSkgewogIGRlZmVyID0gZnVuY3Rpb24gKGlkKSB7CiAgIGh0bWwuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudCgnc2NyaXB0JykpW09OUkVBRFlTVEFURUNIQU5HRV0gPSBmdW5jdGlvbiAoKSB7CiAgICBodG1sLnJlbW92ZUNoaWxkKHRoaXMpOwogICAgcnVuKGlkKTsKICAgfTsKICB9OwogfSBlbHNlIHsKICBkZWZlciA9IGZ1bmN0aW9uIChpZCkgewogICBzZXRUaW1lb3V0KHJ1bm5lcihpZCksIDApOwogIH07CiB9Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiBzZXQ6IHNldCwKIGNsZWFyOiBjbGVhcgp9OwoKLyoqKi8gfSksCi8qIDEyNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgdXNlckFnZW50ID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjcpOwptb2R1bGUuZXhwb3J0cyA9IC8oaXBob25lfGlwb2R8aXBhZCkuKmFwcGxld2Via2l0L2kudGVzdCh1c2VyQWdlbnQpOwoKLyoqKi8gfSksCi8qIDEyNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZ2V0QnVpbHRJbiA9IF9fd19wZGZqc19yZXF1aXJlX18oNDIpOwptb2R1bGUuZXhwb3J0cyA9IGdldEJ1aWx0SW4oJ25hdmlnYXRvcicsICd1c2VyQWdlbnQnKSB8fCAnJzsKCi8qKiovIH0pLAovKiAxMjggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxMikuZjsKdmFyIGNsYXNzb2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5KTsKdmFyIG1hY3JvdGFzayA9IF9fd19wZGZqc19yZXF1aXJlX18oMTI1KS5zZXQ7CnZhciBJU19JT1MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyNik7CnZhciBNdXRhdGlvbk9ic2VydmVyID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7CnZhciBwcm9jZXNzID0gZ2xvYmFsLnByb2Nlc3M7CnZhciBQcm9taXNlID0gZ2xvYmFsLlByb21pc2U7CnZhciBJU19OT0RFID0gY2xhc3NvZihwcm9jZXNzKSA9PSAncHJvY2Vzcyc7CnZhciBxdWV1ZU1pY3JvdGFza0Rlc2NyaXB0b3IgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZ2xvYmFsLCAncXVldWVNaWNyb3Rhc2snKTsKdmFyIHF1ZXVlTWljcm90YXNrID0gcXVldWVNaWNyb3Rhc2tEZXNjcmlwdG9yICYmIHF1ZXVlTWljcm90YXNrRGVzY3JpcHRvci52YWx1ZTsKdmFyIGZsdXNoLCBoZWFkLCBsYXN0LCBub3RpZnksIHRvZ2dsZSwgbm9kZSwgcHJvbWlzZSwgdGhlbjsKaWYgKCFxdWV1ZU1pY3JvdGFzaykgewogZmx1c2ggPSBmdW5jdGlvbiAoKSB7CiAgdmFyIHBhcmVudCwgZm47CiAgaWYgKElTX05PREUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSkKICAgcGFyZW50LmV4aXQoKTsKICB3aGlsZSAoaGVhZCkgewogICBmbiA9IGhlYWQuZm47CiAgIGhlYWQgPSBoZWFkLm5leHQ7CiAgIHRyeSB7CiAgICBmbigpOwogICB9IGNhdGNoIChlcnJvcikgewogICAgaWYgKGhlYWQpCiAgICAgbm90aWZ5KCk7CiAgICBlbHNlCiAgICAgbGFzdCA9IHVuZGVmaW5lZDsKICAgIHRocm93IGVycm9yOwogICB9CiAgfQogIGxhc3QgPSB1bmRlZmluZWQ7CiAgaWYgKHBhcmVudCkKICAgcGFyZW50LmVudGVyKCk7CiB9OwogaWYgKElTX05PREUpIHsKICBub3RpZnkgPSBmdW5jdGlvbiAoKSB7CiAgIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpOwogIH07CiB9IGVsc2UgaWYgKE11dGF0aW9uT2JzZXJ2ZXIgJiYgIUlTX0lPUykgewogIHRvZ2dsZSA9IHRydWU7CiAgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTsKICBuZXcgTXV0YXRpb25PYnNlcnZlcihmbHVzaCkub2JzZXJ2ZShub2RlLCB7IGNoYXJhY3RlckRhdGE6IHRydWUgfSk7CiAgbm90aWZ5ID0gZnVuY3Rpb24gKCkgewogICBub2RlLmRhdGEgPSB0b2dnbGUgPSAhdG9nZ2xlOwogIH07CiB9IGVsc2UgaWYgKFByb21pc2UgJiYgUHJvbWlzZS5yZXNvbHZlKSB7CiAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpOwogIHRoZW4gPSBwcm9taXNlLnRoZW47CiAgbm90aWZ5ID0gZnVuY3Rpb24gKCkgewogICB0aGVuLmNhbGwocHJvbWlzZSwgZmx1c2gpOwogIH07CiB9IGVsc2UgewogIG5vdGlmeSA9IGZ1bmN0aW9uICgpIHsKICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7CiAgfTsKIH0KfQptb2R1bGUuZXhwb3J0cyA9IHF1ZXVlTWljcm90YXNrIHx8IGZ1bmN0aW9uIChmbikgewogdmFyIHRhc2sgPSB7CiAgZm46IGZuLAogIG5leHQ6IHVuZGVmaW5lZAogfTsKIGlmIChsYXN0KQogIGxhc3QubmV4dCA9IHRhc2s7CiBpZiAoIWhlYWQpIHsKICBoZWFkID0gdGFzazsKICBub3RpZnkoKTsKIH0KIGxhc3QgPSB0YXNrOwp9OwoKLyoqKi8gfSksCi8qIDEyOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgYW5PYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI4KTsKdmFyIGlzT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMik7CnZhciBuZXdQcm9taXNlQ2FwYWJpbGl0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMwKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQywgeCkgewogYW5PYmplY3QoQyk7CiBpZiAoaXNPYmplY3QoeCkgJiYgeC5jb25zdHJ1Y3RvciA9PT0gQykKICByZXR1cm4geDsKIHZhciBwcm9taXNlQ2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5LmYoQyk7CiB2YXIgcmVzb2x2ZSA9IHByb21pc2VDYXBhYmlsaXR5LnJlc29sdmU7CiByZXNvbHZlKHgpOwogcmV0dXJuIHByb21pc2VDYXBhYmlsaXR5LnByb21pc2U7Cn07CgovKioqLyB9KSwKLyogMTMwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBhRnVuY3Rpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYzKTsKdmFyIFByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24gKEMpIHsKIHZhciByZXNvbHZlLCByZWplY3Q7CiB0aGlzLnByb21pc2UgPSBuZXcgQyhmdW5jdGlvbiAoJCRyZXNvbHZlLCAkJHJlamVjdCkgewogIGlmIChyZXNvbHZlICE9PSB1bmRlZmluZWQgfHwgcmVqZWN0ICE9PSB1bmRlZmluZWQpCiAgIHRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsKICByZXNvbHZlID0gJCRyZXNvbHZlOwogIHJlamVjdCA9ICQkcmVqZWN0OwogfSk7CiB0aGlzLnJlc29sdmUgPSBhRnVuY3Rpb24ocmVzb2x2ZSk7CiB0aGlzLnJlamVjdCA9IGFGdW5jdGlvbihyZWplY3QpOwp9Owptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gKEMpIHsKIHJldHVybiBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoQyk7Cn07CgovKioqLyB9KSwKLyogMTMxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYSwgYikgewogdmFyIGNvbnNvbGUgPSBnbG9iYWwuY29uc29sZTsKIGlmIChjb25zb2xlICYmIGNvbnNvbGUuZXJyb3IpIHsKICBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gY29uc29sZS5lcnJvcihhKSA6IGNvbnNvbGUuZXJyb3IoYSwgYik7CiB9Cn07CgovKioqLyB9KSwKLyogMTMyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGV4ZWMpIHsKIHRyeSB7CiAgcmV0dXJuIHsKICAgZXJyb3I6IGZhbHNlLAogICB2YWx1ZTogZXhlYygpCiAgfTsKIH0gY2F0Y2ggKGVycm9yKSB7CiAgcmV0dXJuIHsKICAgZXJyb3I6IHRydWUsCiAgIHZhbHVlOiBlcnJvcgogIH07CiB9Cn07CgovKioqLyB9KSwKLyogMTMzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIHVzZXJBZ2VudCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTI3KTsKdmFyIHByb2Nlc3MgPSBnbG9iYWwucHJvY2VzczsKdmFyIHZlcnNpb25zID0gcHJvY2VzcyAmJiBwcm9jZXNzLnZlcnNpb25zOwp2YXIgdjggPSB2ZXJzaW9ucyAmJiB2ZXJzaW9ucy52ODsKdmFyIG1hdGNoLCB2ZXJzaW9uOwppZiAodjgpIHsKIG1hdGNoID0gdjguc3BsaXQoJy4nKTsKIHZlcnNpb24gPSBtYXRjaFswXSArIG1hdGNoWzFdOwp9IGVsc2UgaWYgKHVzZXJBZ2VudCkgewogbWF0Y2ggPSB1c2VyQWdlbnQubWF0Y2goL0VkZ2VcLyhcZCspLyk7CiBpZiAoIW1hdGNoIHx8IG1hdGNoWzFdID49IDc0KSB7CiAgbWF0Y2ggPSB1c2VyQWdlbnQubWF0Y2goL0Nocm9tZVwvKFxkKykvKTsKICBpZiAobWF0Y2gpCiAgIHZlcnNpb24gPSBtYXRjaFsxXTsKIH0KfQptb2R1bGUuZXhwb3J0cyA9IHZlcnNpb24gJiYgK3ZlcnNpb247CgovKioqLyB9KSwKLyogMTM0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBhRnVuY3Rpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYzKTsKdmFyIG5ld1Byb21pc2VDYXBhYmlsaXR5TW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzApOwp2YXIgcGVyZm9ybSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMyKTsKdmFyIGl0ZXJhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyNCk7CiQoewogdGFyZ2V0OiAnUHJvbWlzZScsCiBzdGF0OiB0cnVlCn0sIHsKIGFsbFNldHRsZWQ6IGZ1bmN0aW9uIGFsbFNldHRsZWQoaXRlcmFibGUpIHsKICB2YXIgQyA9IHRoaXM7CiAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eU1vZHVsZS5mKEMpOwogIHZhciByZXNvbHZlID0gY2FwYWJpbGl0eS5yZXNvbHZlOwogIHZhciByZWplY3QgPSBjYXBhYmlsaXR5LnJlamVjdDsKICB2YXIgcmVzdWx0ID0gcGVyZm9ybShmdW5jdGlvbiAoKSB7CiAgIHZhciBwcm9taXNlUmVzb2x2ZSA9IGFGdW5jdGlvbihDLnJlc29sdmUpOwogICB2YXIgdmFsdWVzID0gW107CiAgIHZhciBjb3VudGVyID0gMDsKICAgdmFyIHJlbWFpbmluZyA9IDE7CiAgIGl0ZXJhdGUoaXRlcmFibGUsIGZ1bmN0aW9uIChwcm9taXNlKSB7CiAgICB2YXIgaW5kZXggPSBjb3VudGVyKys7CiAgICB2YXIgYWxyZWFkeUNhbGxlZCA9IGZhbHNlOwogICAgdmFsdWVzLnB1c2godW5kZWZpbmVkKTsKICAgIHJlbWFpbmluZysrOwogICAgcHJvbWlzZVJlc29sdmUuY2FsbChDLCBwcm9taXNlKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgIGlmIChhbHJlYWR5Q2FsbGVkKQogICAgICByZXR1cm47CiAgICAgYWxyZWFkeUNhbGxlZCA9IHRydWU7CiAgICAgdmFsdWVzW2luZGV4XSA9IHsKICAgICAgc3RhdHVzOiAnZnVsZmlsbGVkJywKICAgICAgdmFsdWU6IHZhbHVlCiAgICAgfTsKICAgICAtLXJlbWFpbmluZyB8fCByZXNvbHZlKHZhbHVlcyk7CiAgICB9LCBmdW5jdGlvbiAoZSkgewogICAgIGlmIChhbHJlYWR5Q2FsbGVkKQogICAgICByZXR1cm47CiAgICAgYWxyZWFkeUNhbGxlZCA9IHRydWU7CiAgICAgdmFsdWVzW2luZGV4XSA9IHsKICAgICAgc3RhdHVzOiAncmVqZWN0ZWQnLAogICAgICByZWFzb246IGUKICAgICB9OwogICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsKICAgIH0pOwogICB9KTsKICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOwogIH0pOwogIGlmIChyZXN1bHQuZXJyb3IpCiAgIHJlamVjdChyZXN1bHQudmFsdWUpOwogIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiB9Cn0pOwoKLyoqKi8gfSksCi8qIDEzNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgSVNfUFVSRSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzcpOwp2YXIgTmF0aXZlUHJvbWlzZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTIwKTsKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7CnZhciBnZXRCdWlsdEluID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Mik7CnZhciBzcGVjaWVzQ29uc3RydWN0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExMik7CnZhciBwcm9taXNlUmVzb2x2ZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTI5KTsKdmFyIHJlZGVmaW5lID0gX193X3BkZmpzX3JlcXVpcmVfXygyOSk7CnZhciBOT05fR0VORVJJQyA9ICEhTmF0aXZlUHJvbWlzZSAmJiBmYWlscyhmdW5jdGlvbiAoKSB7CiBOYXRpdmVQcm9taXNlLnByb3RvdHlwZVsnZmluYWxseSddLmNhbGwoewogIHRoZW46IGZ1bmN0aW9uICgpIHsKICB9CiB9LCBmdW5jdGlvbiAoKSB7CiB9KTsKfSk7CiQoewogdGFyZ2V0OiAnUHJvbWlzZScsCiBwcm90bzogdHJ1ZSwKIHJlYWw6IHRydWUsCiBmb3JjZWQ6IE5PTl9HRU5FUklDCn0sIHsKICdmaW5hbGx5JzogZnVuY3Rpb24gKG9uRmluYWxseSkgewogIHZhciBDID0gc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsIGdldEJ1aWx0SW4oJ1Byb21pc2UnKSk7CiAgdmFyIGlzRnVuY3Rpb24gPSB0eXBlb2Ygb25GaW5hbGx5ID09ICdmdW5jdGlvbic7CiAgcmV0dXJuIHRoaXMudGhlbihpc0Z1bmN0aW9uID8gZnVuY3Rpb24gKHgpIHsKICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKEMsIG9uRmluYWxseSgpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB4OwogICB9KTsKICB9IDogb25GaW5hbGx5LCBpc0Z1bmN0aW9uID8gZnVuY3Rpb24gKGUpIHsKICAgcmV0dXJuIHByb21pc2VSZXNvbHZlKEMsIG9uRmluYWxseSgpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgIHRocm93IGU7CiAgIH0pOwogIH0gOiBvbkZpbmFsbHkpOwogfQp9KTsKaWYgKCFJU19QVVJFICYmIHR5cGVvZiBOYXRpdmVQcm9taXNlID09ICdmdW5jdGlvbicgJiYgIU5hdGl2ZVByb21pc2UucHJvdG90eXBlWydmaW5hbGx5J10pIHsKIHJlZGVmaW5lKE5hdGl2ZVByb21pc2UucHJvdG90eXBlLCAnZmluYWxseScsIGdldEJ1aWx0SW4oJ1Byb21pc2UnKS5wcm90b3R5cGVbJ2ZpbmFsbHknXSk7Cn0KCi8qKiovIH0pLAovKiAxMzYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKX193X3BkZmpzX3JlcXVpcmVfXygxMzcpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDE0Mik7Cl9fd19wZGZqc19yZXF1aXJlX18oMTQwKTsKdmFyIHBhdGggPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQzKTsKbW9kdWxlLmV4cG9ydHMgPSBwYXRoLlVSTDsKCi8qKiovIH0pLAovKiAxMzcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKX193X3BkZmpzX3JlcXVpcmVfXyg3Nyk7CnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBERVNDUklQVE9SUyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMpOwp2YXIgVVNFX05BVElWRV9VUkwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzOCk7CnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIGRlZmluZVByb3BlcnRpZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDcyKTsKdmFyIHJlZGVmaW5lID0gX193X3BkZmpzX3JlcXVpcmVfXygyOSk7CnZhciBhbkluc3RhbmNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjMpOwp2YXIgaGFzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMyk7CnZhciBhc3NpZ24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwMCk7CnZhciBhcnJheUZyb20gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDkwKTsKdmFyIGNvZGVBdCA9IF9fd19wZGZqc19yZXF1aXJlX18oNzgpLmNvZGVBdDsKdmFyIHRvQVNDSUkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEzOSk7CnZhciBzZXRUb1N0cmluZ1RhZyA9IF9fd19wZGZqc19yZXF1aXJlX18oODUpOwp2YXIgVVJMU2VhcmNoUGFyYW1zTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDApOwp2YXIgSW50ZXJuYWxTdGF0ZU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzMpOwp2YXIgTmF0aXZlVVJMID0gZ2xvYmFsLlVSTDsKdmFyIFVSTFNlYXJjaFBhcmFtcyA9IFVSTFNlYXJjaFBhcmFtc01vZHVsZS5VUkxTZWFyY2hQYXJhbXM7CnZhciBnZXRJbnRlcm5hbFNlYXJjaFBhcmFtc1N0YXRlID0gVVJMU2VhcmNoUGFyYW1zTW9kdWxlLmdldFN0YXRlOwp2YXIgc2V0SW50ZXJuYWxTdGF0ZSA9IEludGVybmFsU3RhdGVNb2R1bGUuc2V0Owp2YXIgZ2V0SW50ZXJuYWxVUkxTdGF0ZSA9IEludGVybmFsU3RhdGVNb2R1bGUuZ2V0dGVyRm9yKCdVUkwnKTsKdmFyIGZsb29yID0gTWF0aC5mbG9vcjsKdmFyIHBvdyA9IE1hdGgucG93Owp2YXIgSU5WQUxJRF9BVVRIT1JJVFkgPSAnSW52YWxpZCBhdXRob3JpdHknOwp2YXIgSU5WQUxJRF9TQ0hFTUUgPSAnSW52YWxpZCBzY2hlbWUnOwp2YXIgSU5WQUxJRF9IT1NUID0gJ0ludmFsaWQgaG9zdCc7CnZhciBJTlZBTElEX1BPUlQgPSAnSW52YWxpZCBwb3J0JzsKdmFyIEFMUEhBID0gL1tBLVphLXpdLzsKdmFyIEFMUEhBTlVNRVJJQyA9IC9bXGQrLS5BLVphLXpdLzsKdmFyIERJR0lUID0gL1xkLzsKdmFyIEhFWF9TVEFSVCA9IC9eKDB4fDBYKS87CnZhciBPQ1QgPSAvXlswLTddKyQvOwp2YXIgREVDID0gL15cZCskLzsKdmFyIEhFWCA9IC9eW1xkQS1GYS1mXSskLzsKdmFyIEZPUkJJRERFTl9IT1NUX0NPREVfUE9JTlQgPSAvW1x1MDAwMFx1MDAwOVx1MDAwQVx1MDAwRCAjJS86P0BbXFxdXS87CnZhciBGT1JCSURERU5fSE9TVF9DT0RFX1BPSU5UX0VYQ0xVRElOR19QRVJDRU5UID0gL1tcdTAwMDBcdTAwMDlcdTAwMEFcdTAwMEQgIy86P0BbXFxdXS87CnZhciBMRUFESU5HX0FORF9UUkFJTElOR19DMF9DT05UUk9MX09SX1NQQUNFID0gL15bXHUwMDAwLVx1MDAxRiBdK3xbXHUwMDAwLVx1MDAxRiBdKyQvZzsKdmFyIFRBQl9BTkRfTkVXX0xJTkUgPSAvW1x1MDAwOVx1MDAwQVx1MDAwRF0vZzsKdmFyIEVPRjsKdmFyIHBhcnNlSG9zdCA9IGZ1bmN0aW9uICh1cmwsIGlucHV0KSB7CiB2YXIgcmVzdWx0LCBjb2RlUG9pbnRzLCBpbmRleDsKIGlmIChpbnB1dC5jaGFyQXQoMCkgPT0gJ1snKSB7CiAgaWYgKGlucHV0LmNoYXJBdChpbnB1dC5sZW5ndGggLSAxKSAhPSAnXScpCiAgIHJldHVybiBJTlZBTElEX0hPU1Q7CiAgcmVzdWx0ID0gcGFyc2VJUHY2KGlucHV0LnNsaWNlKDEsIC0xKSk7CiAgaWYgKCFyZXN1bHQpCiAgIHJldHVybiBJTlZBTElEX0hPU1Q7CiAgdXJsLmhvc3QgPSByZXN1bHQ7CiB9IGVsc2UgaWYgKCFpc1NwZWNpYWwodXJsKSkgewogIGlmIChGT1JCSURERU5fSE9TVF9DT0RFX1BPSU5UX0VYQ0xVRElOR19QRVJDRU5ULnRlc3QoaW5wdXQpKQogICByZXR1cm4gSU5WQUxJRF9IT1NUOwogIHJlc3VsdCA9ICcnOwogIGNvZGVQb2ludHMgPSBhcnJheUZyb20oaW5wdXQpOwogIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IGNvZGVQb2ludHMubGVuZ3RoOyBpbmRleCsrKSB7CiAgIHJlc3VsdCArPSBwZXJjZW50RW5jb2RlKGNvZGVQb2ludHNbaW5kZXhdLCBDMENvbnRyb2xQZXJjZW50RW5jb2RlU2V0KTsKICB9CiAgdXJsLmhvc3QgPSByZXN1bHQ7CiB9IGVsc2UgewogIGlucHV0ID0gdG9BU0NJSShpbnB1dCk7CiAgaWYgKEZPUkJJRERFTl9IT1NUX0NPREVfUE9JTlQudGVzdChpbnB1dCkpCiAgIHJldHVybiBJTlZBTElEX0hPU1Q7CiAgcmVzdWx0ID0gcGFyc2VJUHY0KGlucHV0KTsKICBpZiAocmVzdWx0ID09PSBudWxsKQogICByZXR1cm4gSU5WQUxJRF9IT1NUOwogIHVybC5ob3N0ID0gcmVzdWx0OwogfQp9Owp2YXIgcGFyc2VJUHY0ID0gZnVuY3Rpb24gKGlucHV0KSB7CiB2YXIgcGFydHMgPSBpbnB1dC5zcGxpdCgnLicpOwogdmFyIHBhcnRzTGVuZ3RoLCBudW1iZXJzLCBpbmRleCwgcGFydCwgcmFkaXgsIG51bWJlciwgaXB2NDsKIGlmIChwYXJ0cy5sZW5ndGggJiYgcGFydHNbcGFydHMubGVuZ3RoIC0gMV0gPT0gJycpIHsKICBwYXJ0cy5wb3AoKTsKIH0KIHBhcnRzTGVuZ3RoID0gcGFydHMubGVuZ3RoOwogaWYgKHBhcnRzTGVuZ3RoID4gNCkKICByZXR1cm4gaW5wdXQ7CiBudW1iZXJzID0gW107CiBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBwYXJ0c0xlbmd0aDsgaW5kZXgrKykgewogIHBhcnQgPSBwYXJ0c1tpbmRleF07CiAgaWYgKHBhcnQgPT0gJycpCiAgIHJldHVybiBpbnB1dDsKICByYWRpeCA9IDEwOwogIGlmIChwYXJ0Lmxlbmd0aCA+IDEgJiYgcGFydC5jaGFyQXQoMCkgPT0gJzAnKSB7CiAgIHJhZGl4ID0gSEVYX1NUQVJULnRlc3QocGFydCkgPyAxNiA6IDg7CiAgIHBhcnQgPSBwYXJ0LnNsaWNlKHJhZGl4ID09IDggPyAxIDogMik7CiAgfQogIGlmIChwYXJ0ID09PSAnJykgewogICBudW1iZXIgPSAwOwogIH0gZWxzZSB7CiAgIGlmICghKHJhZGl4ID09IDEwID8gREVDIDogcmFkaXggPT0gOCA/IE9DVCA6IEhFWCkudGVzdChwYXJ0KSkKICAgIHJldHVybiBpbnB1dDsKICAgbnVtYmVyID0gcGFyc2VJbnQocGFydCwgcmFkaXgpOwogIH0KICBudW1iZXJzLnB1c2gobnVtYmVyKTsKIH0KIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IHBhcnRzTGVuZ3RoOyBpbmRleCsrKSB7CiAgbnVtYmVyID0gbnVtYmVyc1tpbmRleF07CiAgaWYgKGluZGV4ID09IHBhcnRzTGVuZ3RoIC0gMSkgewogICBpZiAobnVtYmVyID49IHBvdygyNTYsIDUgLSBwYXJ0c0xlbmd0aCkpCiAgICByZXR1cm4gbnVsbDsKICB9IGVsc2UgaWYgKG51bWJlciA+IDI1NSkKICAgcmV0dXJuIG51bGw7CiB9CiBpcHY0ID0gbnVtYmVycy5wb3AoKTsKIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IG51bWJlcnMubGVuZ3RoOyBpbmRleCsrKSB7CiAgaXB2NCArPSBudW1iZXJzW2luZGV4XSAqIHBvdygyNTYsIDMgLSBpbmRleCk7CiB9CiByZXR1cm4gaXB2NDsKfTsKdmFyIHBhcnNlSVB2NiA9IGZ1bmN0aW9uIChpbnB1dCkgewogdmFyIGFkZHJlc3MgPSBbCiAgMCwKICAwLAogIDAsCiAgMCwKICAwLAogIDAsCiAgMCwKICAwCiBdOwogdmFyIHBpZWNlSW5kZXggPSAwOwogdmFyIGNvbXByZXNzID0gbnVsbDsKIHZhciBwb2ludGVyID0gMDsKIHZhciB2YWx1ZSwgbGVuZ3RoLCBudW1iZXJzU2VlbiwgaXB2NFBpZWNlLCBudW1iZXIsIHN3YXBzLCBzd2FwOwogdmFyIGNoYXIgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGlucHV0LmNoYXJBdChwb2ludGVyKTsKIH07CiBpZiAoY2hhcigpID09ICc6JykgewogIGlmIChpbnB1dC5jaGFyQXQoMSkgIT0gJzonKQogICByZXR1cm47CiAgcG9pbnRlciArPSAyOwogIHBpZWNlSW5kZXgrKzsKICBjb21wcmVzcyA9IHBpZWNlSW5kZXg7CiB9CiB3aGlsZSAoY2hhcigpKSB7CiAgaWYgKHBpZWNlSW5kZXggPT0gOCkKICAgcmV0dXJuOwogIGlmIChjaGFyKCkgPT0gJzonKSB7CiAgIGlmIChjb21wcmVzcyAhPT0gbnVsbCkKICAgIHJldHVybjsKICAgcG9pbnRlcisrOwogICBwaWVjZUluZGV4Kys7CiAgIGNvbXByZXNzID0gcGllY2VJbmRleDsKICAgY29udGludWU7CiAgfQogIHZhbHVlID0gbGVuZ3RoID0gMDsKICB3aGlsZSAobGVuZ3RoIDwgNCAmJiBIRVgudGVzdChjaGFyKCkpKSB7CiAgIHZhbHVlID0gdmFsdWUgKiAxNiArIHBhcnNlSW50KGNoYXIoKSwgMTYpOwogICBwb2ludGVyKys7CiAgIGxlbmd0aCsrOwogIH0KICBpZiAoY2hhcigpID09ICcuJykgewogICBpZiAobGVuZ3RoID09IDApCiAgICByZXR1cm47CiAgIHBvaW50ZXIgLT0gbGVuZ3RoOwogICBpZiAocGllY2VJbmRleCA+IDYpCiAgICByZXR1cm47CiAgIG51bWJlcnNTZWVuID0gMDsKICAgd2hpbGUgKGNoYXIoKSkgewogICAgaXB2NFBpZWNlID0gbnVsbDsKICAgIGlmIChudW1iZXJzU2VlbiA+IDApIHsKICAgICBpZiAoY2hhcigpID09ICcuJyAmJiBudW1iZXJzU2VlbiA8IDQpCiAgICAgIHBvaW50ZXIrKzsKICAgICBlbHNlCiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICghRElHSVQudGVzdChjaGFyKCkpKQogICAgIHJldHVybjsKICAgIHdoaWxlIChESUdJVC50ZXN0KGNoYXIoKSkpIHsKICAgICBudW1iZXIgPSBwYXJzZUludChjaGFyKCksIDEwKTsKICAgICBpZiAoaXB2NFBpZWNlID09PSBudWxsKQogICAgICBpcHY0UGllY2UgPSBudW1iZXI7CiAgICAgZWxzZSBpZiAoaXB2NFBpZWNlID09IDApCiAgICAgIHJldHVybjsKICAgICBlbHNlCiAgICAgIGlwdjRQaWVjZSA9IGlwdjRQaWVjZSAqIDEwICsgbnVtYmVyOwogICAgIGlmIChpcHY0UGllY2UgPiAyNTUpCiAgICAgIHJldHVybjsKICAgICBwb2ludGVyKys7CiAgICB9CiAgICBhZGRyZXNzW3BpZWNlSW5kZXhdID0gYWRkcmVzc1twaWVjZUluZGV4XSAqIDI1NiArIGlwdjRQaWVjZTsKICAgIG51bWJlcnNTZWVuKys7CiAgICBpZiAobnVtYmVyc1NlZW4gPT0gMiB8fCBudW1iZXJzU2VlbiA9PSA0KQogICAgIHBpZWNlSW5kZXgrKzsKICAgfQogICBpZiAobnVtYmVyc1NlZW4gIT0gNCkKICAgIHJldHVybjsKICAgYnJlYWs7CiAgfSBlbHNlIGlmIChjaGFyKCkgPT0gJzonKSB7CiAgIHBvaW50ZXIrKzsKICAgaWYgKCFjaGFyKCkpCiAgICByZXR1cm47CiAgfSBlbHNlIGlmIChjaGFyKCkpCiAgIHJldHVybjsKICBhZGRyZXNzW3BpZWNlSW5kZXgrK10gPSB2YWx1ZTsKIH0KIGlmIChjb21wcmVzcyAhPT0gbnVsbCkgewogIHN3YXBzID0gcGllY2VJbmRleCAtIGNvbXByZXNzOwogIHBpZWNlSW5kZXggPSA3OwogIHdoaWxlIChwaWVjZUluZGV4ICE9IDAgJiYgc3dhcHMgPiAwKSB7CiAgIHN3YXAgPSBhZGRyZXNzW3BpZWNlSW5kZXhdOwogICBhZGRyZXNzW3BpZWNlSW5kZXgtLV0gPSBhZGRyZXNzW2NvbXByZXNzICsgc3dhcHMgLSAxXTsKICAgYWRkcmVzc1tjb21wcmVzcyArIC0tc3dhcHNdID0gc3dhcDsKICB9CiB9IGVsc2UgaWYgKHBpZWNlSW5kZXggIT0gOCkKICByZXR1cm47CiByZXR1cm4gYWRkcmVzczsKfTsKdmFyIGZpbmRMb25nZXN0WmVyb1NlcXVlbmNlID0gZnVuY3Rpb24gKGlwdjYpIHsKIHZhciBtYXhJbmRleCA9IG51bGw7CiB2YXIgbWF4TGVuZ3RoID0gMTsKIHZhciBjdXJyU3RhcnQgPSBudWxsOwogdmFyIGN1cnJMZW5ndGggPSAwOwogdmFyIGluZGV4ID0gMDsKIGZvciAoOyBpbmRleCA8IDg7IGluZGV4KyspIHsKICBpZiAoaXB2NltpbmRleF0gIT09IDApIHsKICAgaWYgKGN1cnJMZW5ndGggPiBtYXhMZW5ndGgpIHsKICAgIG1heEluZGV4ID0gY3VyclN0YXJ0OwogICAgbWF4TGVuZ3RoID0gY3Vyckxlbmd0aDsKICAgfQogICBjdXJyU3RhcnQgPSBudWxsOwogICBjdXJyTGVuZ3RoID0gMDsKICB9IGVsc2UgewogICBpZiAoY3VyclN0YXJ0ID09PSBudWxsKQogICAgY3VyclN0YXJ0ID0gaW5kZXg7CiAgICsrY3Vyckxlbmd0aDsKICB9CiB9CiBpZiAoY3Vyckxlbmd0aCA+IG1heExlbmd0aCkgewogIG1heEluZGV4ID0gY3VyclN0YXJ0OwogIG1heExlbmd0aCA9IGN1cnJMZW5ndGg7CiB9CiByZXR1cm4gbWF4SW5kZXg7Cn07CnZhciBzZXJpYWxpemVIb3N0ID0gZnVuY3Rpb24gKGhvc3QpIHsKIHZhciByZXN1bHQsIGluZGV4LCBjb21wcmVzcywgaWdub3JlMDsKIGlmICh0eXBlb2YgaG9zdCA9PSAnbnVtYmVyJykgewogIHJlc3VsdCA9IFtdOwogIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IDQ7IGluZGV4KyspIHsKICAgcmVzdWx0LnVuc2hpZnQoaG9zdCAlIDI1Nik7CiAgIGhvc3QgPSBmbG9vcihob3N0IC8gMjU2KTsKICB9CiAgcmV0dXJuIHJlc3VsdC5qb2luKCcuJyk7CiB9IGVsc2UgaWYgKHR5cGVvZiBob3N0ID09ICdvYmplY3QnKSB7CiAgcmVzdWx0ID0gJyc7CiAgY29tcHJlc3MgPSBmaW5kTG9uZ2VzdFplcm9TZXF1ZW5jZShob3N0KTsKICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCA4OyBpbmRleCsrKSB7CiAgIGlmIChpZ25vcmUwICYmIGhvc3RbaW5kZXhdID09PSAwKQogICAgY29udGludWU7CiAgIGlmIChpZ25vcmUwKQogICAgaWdub3JlMCA9IGZhbHNlOwogICBpZiAoY29tcHJlc3MgPT09IGluZGV4KSB7CiAgICByZXN1bHQgKz0gaW5kZXggPyAnOicgOiAnOjonOwogICAgaWdub3JlMCA9IHRydWU7CiAgIH0gZWxzZSB7CiAgICByZXN1bHQgKz0gaG9zdFtpbmRleF0udG9TdHJpbmcoMTYpOwogICAgaWYgKGluZGV4IDwgNykKICAgICByZXN1bHQgKz0gJzonOwogICB9CiAgfQogIHJldHVybiAnWycgKyByZXN1bHQgKyAnXSc7CiB9CiByZXR1cm4gaG9zdDsKfTsKdmFyIEMwQ29udHJvbFBlcmNlbnRFbmNvZGVTZXQgPSB7fTsKdmFyIGZyYWdtZW50UGVyY2VudEVuY29kZVNldCA9IGFzc2lnbih7fSwgQzBDb250cm9sUGVyY2VudEVuY29kZVNldCwgewogJyAnOiAxLAogJyInOiAxLAogJzwnOiAxLAogJz4nOiAxLAogJ2AnOiAxCn0pOwp2YXIgcGF0aFBlcmNlbnRFbmNvZGVTZXQgPSBhc3NpZ24oe30sIGZyYWdtZW50UGVyY2VudEVuY29kZVNldCwgewogJyMnOiAxLAogJz8nOiAxLAogJ3snOiAxLAogJ30nOiAxCn0pOwp2YXIgdXNlcmluZm9QZXJjZW50RW5jb2RlU2V0ID0gYXNzaWduKHt9LCBwYXRoUGVyY2VudEVuY29kZVNldCwgewogJy8nOiAxLAogJzonOiAxLAogJzsnOiAxLAogJz0nOiAxLAogJ0AnOiAxLAogJ1snOiAxLAogJ1xcJzogMSwKICddJzogMSwKICdeJzogMSwKICd8JzogMQp9KTsKdmFyIHBlcmNlbnRFbmNvZGUgPSBmdW5jdGlvbiAoY2hhciwgc2V0KSB7CiB2YXIgY29kZSA9IGNvZGVBdChjaGFyLCAwKTsKIHJldHVybiBjb2RlID4gMHgyMCAmJiBjb2RlIDwgMHg3RiAmJiAhaGFzKHNldCwgY2hhcikgPyBjaGFyIDogZW5jb2RlVVJJQ29tcG9uZW50KGNoYXIpOwp9Owp2YXIgc3BlY2lhbFNjaGVtZXMgPSB7CiBmdHA6IDIxLAogZmlsZTogbnVsbCwKIGh0dHA6IDgwLAogaHR0cHM6IDQ0MywKIHdzOiA4MCwKIHdzczogNDQzCn07CnZhciBpc1NwZWNpYWwgPSBmdW5jdGlvbiAodXJsKSB7CiByZXR1cm4gaGFzKHNwZWNpYWxTY2hlbWVzLCB1cmwuc2NoZW1lKTsKfTsKdmFyIGluY2x1ZGVzQ3JlZGVudGlhbHMgPSBmdW5jdGlvbiAodXJsKSB7CiByZXR1cm4gdXJsLnVzZXJuYW1lICE9ICcnIHx8IHVybC5wYXNzd29yZCAhPSAnJzsKfTsKdmFyIGNhbm5vdEhhdmVVc2VybmFtZVBhc3N3b3JkUG9ydCA9IGZ1bmN0aW9uICh1cmwpIHsKIHJldHVybiAhdXJsLmhvc3QgfHwgdXJsLmNhbm5vdEJlQUJhc2VVUkwgfHwgdXJsLnNjaGVtZSA9PSAnZmlsZSc7Cn07CnZhciBpc1dpbmRvd3NEcml2ZUxldHRlciA9IGZ1bmN0aW9uIChzdHJpbmcsIG5vcm1hbGl6ZWQpIHsKIHZhciBzZWNvbmQ7CiByZXR1cm4gc3RyaW5nLmxlbmd0aCA9PSAyICYmIEFMUEhBLnRlc3Qoc3RyaW5nLmNoYXJBdCgwKSkgJiYgKChzZWNvbmQgPSBzdHJpbmcuY2hhckF0KDEpKSA9PSAnOicgfHwgIW5vcm1hbGl6ZWQgJiYgc2Vjb25kID09ICd8Jyk7Cn07CnZhciBzdGFydHNXaXRoV2luZG93c0RyaXZlTGV0dGVyID0gZnVuY3Rpb24gKHN0cmluZykgewogdmFyIHRoaXJkOwogcmV0dXJuIHN0cmluZy5sZW5ndGggPiAxICYmIGlzV2luZG93c0RyaXZlTGV0dGVyKHN0cmluZy5zbGljZSgwLCAyKSkgJiYgKHN0cmluZy5sZW5ndGggPT0gMiB8fCAoKHRoaXJkID0gc3RyaW5nLmNoYXJBdCgyKSkgPT09ICcvJyB8fCB0aGlyZCA9PT0gJ1xcJyB8fCB0aGlyZCA9PT0gJz8nIHx8IHRoaXJkID09PSAnIycpKTsKfTsKdmFyIHNob3J0ZW5VUkxzUGF0aCA9IGZ1bmN0aW9uICh1cmwpIHsKIHZhciBwYXRoID0gdXJsLnBhdGg7CiB2YXIgcGF0aFNpemUgPSBwYXRoLmxlbmd0aDsKIGlmIChwYXRoU2l6ZSAmJiAodXJsLnNjaGVtZSAhPSAnZmlsZScgfHwgcGF0aFNpemUgIT0gMSB8fCAhaXNXaW5kb3dzRHJpdmVMZXR0ZXIocGF0aFswXSwgdHJ1ZSkpKSB7CiAgcGF0aC5wb3AoKTsKIH0KfTsKdmFyIGlzU2luZ2xlRG90ID0gZnVuY3Rpb24gKHNlZ21lbnQpIHsKIHJldHVybiBzZWdtZW50ID09PSAnLicgfHwgc2VnbWVudC50b0xvd2VyQ2FzZSgpID09PSAnJTJlJzsKfTsKdmFyIGlzRG91YmxlRG90ID0gZnVuY3Rpb24gKHNlZ21lbnQpIHsKIHNlZ21lbnQgPSBzZWdtZW50LnRvTG93ZXJDYXNlKCk7CiByZXR1cm4gc2VnbWVudCA9PT0gJy4uJyB8fCBzZWdtZW50ID09PSAnJTJlLicgfHwgc2VnbWVudCA9PT0gJy4lMmUnIHx8IHNlZ21lbnQgPT09ICclMmUlMmUnOwp9Owp2YXIgU0NIRU1FX1NUQVJUID0ge307CnZhciBTQ0hFTUUgPSB7fTsKdmFyIE5PX1NDSEVNRSA9IHt9Owp2YXIgU1BFQ0lBTF9SRUxBVElWRV9PUl9BVVRIT1JJVFkgPSB7fTsKdmFyIFBBVEhfT1JfQVVUSE9SSVRZID0ge307CnZhciBSRUxBVElWRSA9IHt9Owp2YXIgUkVMQVRJVkVfU0xBU0ggPSB7fTsKdmFyIFNQRUNJQUxfQVVUSE9SSVRZX1NMQVNIRVMgPSB7fTsKdmFyIFNQRUNJQUxfQVVUSE9SSVRZX0lHTk9SRV9TTEFTSEVTID0ge307CnZhciBBVVRIT1JJVFkgPSB7fTsKdmFyIEhPU1QgPSB7fTsKdmFyIEhPU1ROQU1FID0ge307CnZhciBQT1JUID0ge307CnZhciBGSUxFID0ge307CnZhciBGSUxFX1NMQVNIID0ge307CnZhciBGSUxFX0hPU1QgPSB7fTsKdmFyIFBBVEhfU1RBUlQgPSB7fTsKdmFyIFBBVEggPSB7fTsKdmFyIENBTk5PVF9CRV9BX0JBU0VfVVJMX1BBVEggPSB7fTsKdmFyIFFVRVJZID0ge307CnZhciBGUkFHTUVOVCA9IHt9Owp2YXIgcGFyc2VVUkwgPSBmdW5jdGlvbiAodXJsLCBpbnB1dCwgc3RhdGVPdmVycmlkZSwgYmFzZSkgewogdmFyIHN0YXRlID0gc3RhdGVPdmVycmlkZSB8fCBTQ0hFTUVfU1RBUlQ7CiB2YXIgcG9pbnRlciA9IDA7CiB2YXIgYnVmZmVyID0gJyc7CiB2YXIgc2VlbkF0ID0gZmFsc2U7CiB2YXIgc2VlbkJyYWNrZXQgPSBmYWxzZTsKIHZhciBzZWVuUGFzc3dvcmRUb2tlbiA9IGZhbHNlOwogdmFyIGNvZGVQb2ludHMsIGNoYXIsIGJ1ZmZlckNvZGVQb2ludHMsIGZhaWx1cmU7CiBpZiAoIXN0YXRlT3ZlcnJpZGUpIHsKICB1cmwuc2NoZW1lID0gJyc7CiAgdXJsLnVzZXJuYW1lID0gJyc7CiAgdXJsLnBhc3N3b3JkID0gJyc7CiAgdXJsLmhvc3QgPSBudWxsOwogIHVybC5wb3J0ID0gbnVsbDsKICB1cmwucGF0aCA9IFtdOwogIHVybC5xdWVyeSA9IG51bGw7CiAgdXJsLmZyYWdtZW50ID0gbnVsbDsKICB1cmwuY2Fubm90QmVBQmFzZVVSTCA9IGZhbHNlOwogIGlucHV0ID0gaW5wdXQucmVwbGFjZShMRUFESU5HX0FORF9UUkFJTElOR19DMF9DT05UUk9MX09SX1NQQUNFLCAnJyk7CiB9CiBpbnB1dCA9IGlucHV0LnJlcGxhY2UoVEFCX0FORF9ORVdfTElORSwgJycpOwogY29kZVBvaW50cyA9IGFycmF5RnJvbShpbnB1dCk7CiB3aGlsZSAocG9pbnRlciA8PSBjb2RlUG9pbnRzLmxlbmd0aCkgewogIGNoYXIgPSBjb2RlUG9pbnRzW3BvaW50ZXJdOwogIHN3aXRjaCAoc3RhdGUpIHsKICBjYXNlIFNDSEVNRV9TVEFSVDoKICAgaWYgKGNoYXIgJiYgQUxQSEEudGVzdChjaGFyKSkgewogICAgYnVmZmVyICs9IGNoYXIudG9Mb3dlckNhc2UoKTsKICAgIHN0YXRlID0gU0NIRU1FOwogICB9IGVsc2UgaWYgKCFzdGF0ZU92ZXJyaWRlKSB7CiAgICBzdGF0ZSA9IE5PX1NDSEVNRTsKICAgIGNvbnRpbnVlOwogICB9IGVsc2UKICAgIHJldHVybiBJTlZBTElEX1NDSEVNRTsKICAgYnJlYWs7CiAgY2FzZSBTQ0hFTUU6CiAgIGlmIChjaGFyICYmIChBTFBIQU5VTUVSSUMudGVzdChjaGFyKSB8fCBjaGFyID09ICcrJyB8fCBjaGFyID09ICctJyB8fCBjaGFyID09ICcuJykpIHsKICAgIGJ1ZmZlciArPSBjaGFyLnRvTG93ZXJDYXNlKCk7CiAgIH0gZWxzZSBpZiAoY2hhciA9PSAnOicpIHsKICAgIGlmIChzdGF0ZU92ZXJyaWRlICYmIChpc1NwZWNpYWwodXJsKSAhPSBoYXMoc3BlY2lhbFNjaGVtZXMsIGJ1ZmZlcikgfHwgYnVmZmVyID09ICdmaWxlJyAmJiAoaW5jbHVkZXNDcmVkZW50aWFscyh1cmwpIHx8IHVybC5wb3J0ICE9PSBudWxsKSB8fCB1cmwuc2NoZW1lID09ICdmaWxlJyAmJiAhdXJsLmhvc3QpKQogICAgIHJldHVybjsKICAgIHVybC5zY2hlbWUgPSBidWZmZXI7CiAgICBpZiAoc3RhdGVPdmVycmlkZSkgewogICAgIGlmIChpc1NwZWNpYWwodXJsKSAmJiBzcGVjaWFsU2NoZW1lc1t1cmwuc2NoZW1lXSA9PSB1cmwucG9ydCkKICAgICAgdXJsLnBvcnQgPSBudWxsOwogICAgIHJldHVybjsKICAgIH0KICAgIGJ1ZmZlciA9ICcnOwogICAgaWYgKHVybC5zY2hlbWUgPT0gJ2ZpbGUnKSB7CiAgICAgc3RhdGUgPSBGSUxFOwogICAgfSBlbHNlIGlmIChpc1NwZWNpYWwodXJsKSAmJiBiYXNlICYmIGJhc2Uuc2NoZW1lID09IHVybC5zY2hlbWUpIHsKICAgICBzdGF0ZSA9IFNQRUNJQUxfUkVMQVRJVkVfT1JfQVVUSE9SSVRZOwogICAgfSBlbHNlIGlmIChpc1NwZWNpYWwodXJsKSkgewogICAgIHN0YXRlID0gU1BFQ0lBTF9BVVRIT1JJVFlfU0xBU0hFUzsKICAgIH0gZWxzZSBpZiAoY29kZVBvaW50c1twb2ludGVyICsgMV0gPT0gJy8nKSB7CiAgICAgc3RhdGUgPSBQQVRIX09SX0FVVEhPUklUWTsKICAgICBwb2ludGVyKys7CiAgICB9IGVsc2UgewogICAgIHVybC5jYW5ub3RCZUFCYXNlVVJMID0gdHJ1ZTsKICAgICB1cmwucGF0aC5wdXNoKCcnKTsKICAgICBzdGF0ZSA9IENBTk5PVF9CRV9BX0JBU0VfVVJMX1BBVEg7CiAgICB9CiAgIH0gZWxzZSBpZiAoIXN0YXRlT3ZlcnJpZGUpIHsKICAgIGJ1ZmZlciA9ICcnOwogICAgc3RhdGUgPSBOT19TQ0hFTUU7CiAgICBwb2ludGVyID0gMDsKICAgIGNvbnRpbnVlOwogICB9IGVsc2UKICAgIHJldHVybiBJTlZBTElEX1NDSEVNRTsKICAgYnJlYWs7CiAgY2FzZSBOT19TQ0hFTUU6CiAgIGlmICghYmFzZSB8fCBiYXNlLmNhbm5vdEJlQUJhc2VVUkwgJiYgY2hhciAhPSAnIycpCiAgICByZXR1cm4gSU5WQUxJRF9TQ0hFTUU7CiAgIGlmIChiYXNlLmNhbm5vdEJlQUJhc2VVUkwgJiYgY2hhciA9PSAnIycpIHsKICAgIHVybC5zY2hlbWUgPSBiYXNlLnNjaGVtZTsKICAgIHVybC5wYXRoID0gYmFzZS5wYXRoLnNsaWNlKCk7CiAgICB1cmwucXVlcnkgPSBiYXNlLnF1ZXJ5OwogICAgdXJsLmZyYWdtZW50ID0gJyc7CiAgICB1cmwuY2Fubm90QmVBQmFzZVVSTCA9IHRydWU7CiAgICBzdGF0ZSA9IEZSQUdNRU5UOwogICAgYnJlYWs7CiAgIH0KICAgc3RhdGUgPSBiYXNlLnNjaGVtZSA9PSAnZmlsZScgPyBGSUxFIDogUkVMQVRJVkU7CiAgIGNvbnRpbnVlOwogIGNhc2UgU1BFQ0lBTF9SRUxBVElWRV9PUl9BVVRIT1JJVFk6CiAgIGlmIChjaGFyID09ICcvJyAmJiBjb2RlUG9pbnRzW3BvaW50ZXIgKyAxXSA9PSAnLycpIHsKICAgIHN0YXRlID0gU1BFQ0lBTF9BVVRIT1JJVFlfSUdOT1JFX1NMQVNIRVM7CiAgICBwb2ludGVyKys7CiAgIH0gZWxzZSB7CiAgICBzdGF0ZSA9IFJFTEFUSVZFOwogICAgY29udGludWU7CiAgIH0KICAgYnJlYWs7CiAgY2FzZSBQQVRIX09SX0FVVEhPUklUWToKICAgaWYgKGNoYXIgPT0gJy8nKSB7CiAgICBzdGF0ZSA9IEFVVEhPUklUWTsKICAgIGJyZWFrOwogICB9IGVsc2UgewogICAgc3RhdGUgPSBQQVRIOwogICAgY29udGludWU7CiAgIH0KICBjYXNlIFJFTEFUSVZFOgogICB1cmwuc2NoZW1lID0gYmFzZS5zY2hlbWU7CiAgIGlmIChjaGFyID09IEVPRikgewogICAgdXJsLnVzZXJuYW1lID0gYmFzZS51c2VybmFtZTsKICAgIHVybC5wYXNzd29yZCA9IGJhc2UucGFzc3dvcmQ7CiAgICB1cmwuaG9zdCA9IGJhc2UuaG9zdDsKICAgIHVybC5wb3J0ID0gYmFzZS5wb3J0OwogICAgdXJsLnBhdGggPSBiYXNlLnBhdGguc2xpY2UoKTsKICAgIHVybC5xdWVyeSA9IGJhc2UucXVlcnk7CiAgIH0gZWxzZSBpZiAoY2hhciA9PSAnLycgfHwgY2hhciA9PSAnXFwnICYmIGlzU3BlY2lhbCh1cmwpKSB7CiAgICBzdGF0ZSA9IFJFTEFUSVZFX1NMQVNIOwogICB9IGVsc2UgaWYgKGNoYXIgPT0gJz8nKSB7CiAgICB1cmwudXNlcm5hbWUgPSBiYXNlLnVzZXJuYW1lOwogICAgdXJsLnBhc3N3b3JkID0gYmFzZS5wYXNzd29yZDsKICAgIHVybC5ob3N0ID0gYmFzZS5ob3N0OwogICAgdXJsLnBvcnQgPSBiYXNlLnBvcnQ7CiAgICB1cmwucGF0aCA9IGJhc2UucGF0aC5zbGljZSgpOwogICAgdXJsLnF1ZXJ5ID0gJyc7CiAgICBzdGF0ZSA9IFFVRVJZOwogICB9IGVsc2UgaWYgKGNoYXIgPT0gJyMnKSB7CiAgICB1cmwudXNlcm5hbWUgPSBiYXNlLnVzZXJuYW1lOwogICAgdXJsLnBhc3N3b3JkID0gYmFzZS5wYXNzd29yZDsKICAgIHVybC5ob3N0ID0gYmFzZS5ob3N0OwogICAgdXJsLnBvcnQgPSBiYXNlLnBvcnQ7CiAgICB1cmwucGF0aCA9IGJhc2UucGF0aC5zbGljZSgpOwogICAgdXJsLnF1ZXJ5ID0gYmFzZS5xdWVyeTsKICAgIHVybC5mcmFnbWVudCA9ICcnOwogICAgc3RhdGUgPSBGUkFHTUVOVDsKICAgfSBlbHNlIHsKICAgIHVybC51c2VybmFtZSA9IGJhc2UudXNlcm5hbWU7CiAgICB1cmwucGFzc3dvcmQgPSBiYXNlLnBhc3N3b3JkOwogICAgdXJsLmhvc3QgPSBiYXNlLmhvc3Q7CiAgICB1cmwucG9ydCA9IGJhc2UucG9ydDsKICAgIHVybC5wYXRoID0gYmFzZS5wYXRoLnNsaWNlKCk7CiAgICB1cmwucGF0aC5wb3AoKTsKICAgIHN0YXRlID0gUEFUSDsKICAgIGNvbnRpbnVlOwogICB9CiAgIGJyZWFrOwogIGNhc2UgUkVMQVRJVkVfU0xBU0g6CiAgIGlmIChpc1NwZWNpYWwodXJsKSAmJiAoY2hhciA9PSAnLycgfHwgY2hhciA9PSAnXFwnKSkgewogICAgc3RhdGUgPSBTUEVDSUFMX0FVVEhPUklUWV9JR05PUkVfU0xBU0hFUzsKICAgfSBlbHNlIGlmIChjaGFyID09ICcvJykgewogICAgc3RhdGUgPSBBVVRIT1JJVFk7CiAgIH0gZWxzZSB7CiAgICB1cmwudXNlcm5hbWUgPSBiYXNlLnVzZXJuYW1lOwogICAgdXJsLnBhc3N3b3JkID0gYmFzZS5wYXNzd29yZDsKICAgIHVybC5ob3N0ID0gYmFzZS5ob3N0OwogICAgdXJsLnBvcnQgPSBiYXNlLnBvcnQ7CiAgICBzdGF0ZSA9IFBBVEg7CiAgICBjb250aW51ZTsKICAgfQogICBicmVhazsKICBjYXNlIFNQRUNJQUxfQVVUSE9SSVRZX1NMQVNIRVM6CiAgIHN0YXRlID0gU1BFQ0lBTF9BVVRIT1JJVFlfSUdOT1JFX1NMQVNIRVM7CiAgIGlmIChjaGFyICE9ICcvJyB8fCBidWZmZXIuY2hhckF0KHBvaW50ZXIgKyAxKSAhPSAnLycpCiAgICBjb250aW51ZTsKICAgcG9pbnRlcisrOwogICBicmVhazsKICBjYXNlIFNQRUNJQUxfQVVUSE9SSVRZX0lHTk9SRV9TTEFTSEVTOgogICBpZiAoY2hhciAhPSAnLycgJiYgY2hhciAhPSAnXFwnKSB7CiAgICBzdGF0ZSA9IEFVVEhPUklUWTsKICAgIGNvbnRpbnVlOwogICB9CiAgIGJyZWFrOwogIGNhc2UgQVVUSE9SSVRZOgogICBpZiAoY2hhciA9PSAnQCcpIHsKICAgIGlmIChzZWVuQXQpCiAgICAgYnVmZmVyID0gJyU0MCcgKyBidWZmZXI7CiAgICBzZWVuQXQgPSB0cnVlOwogICAgYnVmZmVyQ29kZVBvaW50cyA9IGFycmF5RnJvbShidWZmZXIpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXJDb2RlUG9pbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgdmFyIGNvZGVQb2ludCA9IGJ1ZmZlckNvZGVQb2ludHNbaV07CiAgICAgaWYgKGNvZGVQb2ludCA9PSAnOicgJiYgIXNlZW5QYXNzd29yZFRva2VuKSB7CiAgICAgIHNlZW5QYXNzd29yZFRva2VuID0gdHJ1ZTsKICAgICAgY29udGludWU7CiAgICAgfQogICAgIHZhciBlbmNvZGVkQ29kZVBvaW50cyA9IHBlcmNlbnRFbmNvZGUoY29kZVBvaW50LCB1c2VyaW5mb1BlcmNlbnRFbmNvZGVTZXQpOwogICAgIGlmIChzZWVuUGFzc3dvcmRUb2tlbikKICAgICAgdXJsLnBhc3N3b3JkICs9IGVuY29kZWRDb2RlUG9pbnRzOwogICAgIGVsc2UKICAgICAgdXJsLnVzZXJuYW1lICs9IGVuY29kZWRDb2RlUG9pbnRzOwogICAgfQogICAgYnVmZmVyID0gJyc7CiAgIH0gZWxzZSBpZiAoY2hhciA9PSBFT0YgfHwgY2hhciA9PSAnLycgfHwgY2hhciA9PSAnPycgfHwgY2hhciA9PSAnIycgfHwgY2hhciA9PSAnXFwnICYmIGlzU3BlY2lhbCh1cmwpKSB7CiAgICBpZiAoc2VlbkF0ICYmIGJ1ZmZlciA9PSAnJykKICAgICByZXR1cm4gSU5WQUxJRF9BVVRIT1JJVFk7CiAgICBwb2ludGVyIC09IGFycmF5RnJvbShidWZmZXIpLmxlbmd0aCArIDE7CiAgICBidWZmZXIgPSAnJzsKICAgIHN0YXRlID0gSE9TVDsKICAgfSBlbHNlCiAgICBidWZmZXIgKz0gY2hhcjsKICAgYnJlYWs7CiAgY2FzZSBIT1NUOgogIGNhc2UgSE9TVE5BTUU6CiAgIGlmIChzdGF0ZU92ZXJyaWRlICYmIHVybC5zY2hlbWUgPT0gJ2ZpbGUnKSB7CiAgICBzdGF0ZSA9IEZJTEVfSE9TVDsKICAgIGNvbnRpbnVlOwogICB9IGVsc2UgaWYgKGNoYXIgPT0gJzonICYmICFzZWVuQnJhY2tldCkgewogICAgaWYgKGJ1ZmZlciA9PSAnJykKICAgICByZXR1cm4gSU5WQUxJRF9IT1NUOwogICAgZmFpbHVyZSA9IHBhcnNlSG9zdCh1cmwsIGJ1ZmZlcik7CiAgICBpZiAoZmFpbHVyZSkKICAgICByZXR1cm4gZmFpbHVyZTsKICAgIGJ1ZmZlciA9ICcnOwogICAgc3RhdGUgPSBQT1JUOwogICAgaWYgKHN0YXRlT3ZlcnJpZGUgPT0gSE9TVE5BTUUpCiAgICAgcmV0dXJuOwogICB9IGVsc2UgaWYgKGNoYXIgPT0gRU9GIHx8IGNoYXIgPT0gJy8nIHx8IGNoYXIgPT0gJz8nIHx8IGNoYXIgPT0gJyMnIHx8IGNoYXIgPT0gJ1xcJyAmJiBpc1NwZWNpYWwodXJsKSkgewogICAgaWYgKGlzU3BlY2lhbCh1cmwpICYmIGJ1ZmZlciA9PSAnJykKICAgICByZXR1cm4gSU5WQUxJRF9IT1NUOwogICAgaWYgKHN0YXRlT3ZlcnJpZGUgJiYgYnVmZmVyID09ICcnICYmIChpbmNsdWRlc0NyZWRlbnRpYWxzKHVybCkgfHwgdXJsLnBvcnQgIT09IG51bGwpKQogICAgIHJldHVybjsKICAgIGZhaWx1cmUgPSBwYXJzZUhvc3QodXJsLCBidWZmZXIpOwogICAgaWYgKGZhaWx1cmUpCiAgICAgcmV0dXJuIGZhaWx1cmU7CiAgICBidWZmZXIgPSAnJzsKICAgIHN0YXRlID0gUEFUSF9TVEFSVDsKICAgIGlmIChzdGF0ZU92ZXJyaWRlKQogICAgIHJldHVybjsKICAgIGNvbnRpbnVlOwogICB9IGVsc2UgewogICAgaWYgKGNoYXIgPT0gJ1snKQogICAgIHNlZW5CcmFja2V0ID0gdHJ1ZTsKICAgIGVsc2UgaWYgKGNoYXIgPT0gJ10nKQogICAgIHNlZW5CcmFja2V0ID0gZmFsc2U7CiAgICBidWZmZXIgKz0gY2hhcjsKICAgfQogICBicmVhazsKICBjYXNlIFBPUlQ6CiAgIGlmIChESUdJVC50ZXN0KGNoYXIpKSB7CiAgICBidWZmZXIgKz0gY2hhcjsKICAgfSBlbHNlIGlmIChjaGFyID09IEVPRiB8fCBjaGFyID09ICcvJyB8fCBjaGFyID09ICc/JyB8fCBjaGFyID09ICcjJyB8fCBjaGFyID09ICdcXCcgJiYgaXNTcGVjaWFsKHVybCkgfHwgc3RhdGVPdmVycmlkZSkgewogICAgaWYgKGJ1ZmZlciAhPSAnJykgewogICAgIHZhciBwb3J0ID0gcGFyc2VJbnQoYnVmZmVyLCAxMCk7CiAgICAgaWYgKHBvcnQgPiAweEZGRkYpCiAgICAgIHJldHVybiBJTlZBTElEX1BPUlQ7CiAgICAgdXJsLnBvcnQgPSBpc1NwZWNpYWwodXJsKSAmJiBwb3J0ID09PSBzcGVjaWFsU2NoZW1lc1t1cmwuc2NoZW1lXSA/IG51bGwgOiBwb3J0OwogICAgIGJ1ZmZlciA9ICcnOwogICAgfQogICAgaWYgKHN0YXRlT3ZlcnJpZGUpCiAgICAgcmV0dXJuOwogICAgc3RhdGUgPSBQQVRIX1NUQVJUOwogICAgY29udGludWU7CiAgIH0gZWxzZQogICAgcmV0dXJuIElOVkFMSURfUE9SVDsKICAgYnJlYWs7CiAgY2FzZSBGSUxFOgogICB1cmwuc2NoZW1lID0gJ2ZpbGUnOwogICBpZiAoY2hhciA9PSAnLycgfHwgY2hhciA9PSAnXFwnKQogICAgc3RhdGUgPSBGSUxFX1NMQVNIOwogICBlbHNlIGlmIChiYXNlICYmIGJhc2Uuc2NoZW1lID09ICdmaWxlJykgewogICAgaWYgKGNoYXIgPT0gRU9GKSB7CiAgICAgdXJsLmhvc3QgPSBiYXNlLmhvc3Q7CiAgICAgdXJsLnBhdGggPSBiYXNlLnBhdGguc2xpY2UoKTsKICAgICB1cmwucXVlcnkgPSBiYXNlLnF1ZXJ5OwogICAgfSBlbHNlIGlmIChjaGFyID09ICc/JykgewogICAgIHVybC5ob3N0ID0gYmFzZS5ob3N0OwogICAgIHVybC5wYXRoID0gYmFzZS5wYXRoLnNsaWNlKCk7CiAgICAgdXJsLnF1ZXJ5ID0gJyc7CiAgICAgc3RhdGUgPSBRVUVSWTsKICAgIH0gZWxzZSBpZiAoY2hhciA9PSAnIycpIHsKICAgICB1cmwuaG9zdCA9IGJhc2UuaG9zdDsKICAgICB1cmwucGF0aCA9IGJhc2UucGF0aC5zbGljZSgpOwogICAgIHVybC5xdWVyeSA9IGJhc2UucXVlcnk7CiAgICAgdXJsLmZyYWdtZW50ID0gJyc7CiAgICAgc3RhdGUgPSBGUkFHTUVOVDsKICAgIH0gZWxzZSB7CiAgICAgaWYgKCFzdGFydHNXaXRoV2luZG93c0RyaXZlTGV0dGVyKGNvZGVQb2ludHMuc2xpY2UocG9pbnRlcikuam9pbignJykpKSB7CiAgICAgIHVybC5ob3N0ID0gYmFzZS5ob3N0OwogICAgICB1cmwucGF0aCA9IGJhc2UucGF0aC5zbGljZSgpOwogICAgICBzaG9ydGVuVVJMc1BhdGgodXJsKTsKICAgICB9CiAgICAgc3RhdGUgPSBQQVRIOwogICAgIGNvbnRpbnVlOwogICAgfQogICB9IGVsc2UgewogICAgc3RhdGUgPSBQQVRIOwogICAgY29udGludWU7CiAgIH0KICAgYnJlYWs7CiAgY2FzZSBGSUxFX1NMQVNIOgogICBpZiAoY2hhciA9PSAnLycgfHwgY2hhciA9PSAnXFwnKSB7CiAgICBzdGF0ZSA9IEZJTEVfSE9TVDsKICAgIGJyZWFrOwogICB9CiAgIGlmIChiYXNlICYmIGJhc2Uuc2NoZW1lID09ICdmaWxlJyAmJiAhc3RhcnRzV2l0aFdpbmRvd3NEcml2ZUxldHRlcihjb2RlUG9pbnRzLnNsaWNlKHBvaW50ZXIpLmpvaW4oJycpKSkgewogICAgaWYgKGlzV2luZG93c0RyaXZlTGV0dGVyKGJhc2UucGF0aFswXSwgdHJ1ZSkpCiAgICAgdXJsLnBhdGgucHVzaChiYXNlLnBhdGhbMF0pOwogICAgZWxzZQogICAgIHVybC5ob3N0ID0gYmFzZS5ob3N0OwogICB9CiAgIHN0YXRlID0gUEFUSDsKICAgY29udGludWU7CiAgY2FzZSBGSUxFX0hPU1Q6CiAgIGlmIChjaGFyID09IEVPRiB8fCBjaGFyID09ICcvJyB8fCBjaGFyID09ICdcXCcgfHwgY2hhciA9PSAnPycgfHwgY2hhciA9PSAnIycpIHsKICAgIGlmICghc3RhdGVPdmVycmlkZSAmJiBpc1dpbmRvd3NEcml2ZUxldHRlcihidWZmZXIpKSB7CiAgICAgc3RhdGUgPSBQQVRIOwogICAgfSBlbHNlIGlmIChidWZmZXIgPT0gJycpIHsKICAgICB1cmwuaG9zdCA9ICcnOwogICAgIGlmIChzdGF0ZU92ZXJyaWRlKQogICAgICByZXR1cm47CiAgICAgc3RhdGUgPSBQQVRIX1NUQVJUOwogICAgfSBlbHNlIHsKICAgICBmYWlsdXJlID0gcGFyc2VIb3N0KHVybCwgYnVmZmVyKTsKICAgICBpZiAoZmFpbHVyZSkKICAgICAgcmV0dXJuIGZhaWx1cmU7CiAgICAgaWYgKHVybC5ob3N0ID09ICdsb2NhbGhvc3QnKQogICAgICB1cmwuaG9zdCA9ICcnOwogICAgIGlmIChzdGF0ZU92ZXJyaWRlKQogICAgICByZXR1cm47CiAgICAgYnVmZmVyID0gJyc7CiAgICAgc3RhdGUgPSBQQVRIX1NUQVJUOwogICAgfQogICAgY29udGludWU7CiAgIH0gZWxzZQogICAgYnVmZmVyICs9IGNoYXI7CiAgIGJyZWFrOwogIGNhc2UgUEFUSF9TVEFSVDoKICAgaWYgKGlzU3BlY2lhbCh1cmwpKSB7CiAgICBzdGF0ZSA9IFBBVEg7CiAgICBpZiAoY2hhciAhPSAnLycgJiYgY2hhciAhPSAnXFwnKQogICAgIGNvbnRpbnVlOwogICB9IGVsc2UgaWYgKCFzdGF0ZU92ZXJyaWRlICYmIGNoYXIgPT0gJz8nKSB7CiAgICB1cmwucXVlcnkgPSAnJzsKICAgIHN0YXRlID0gUVVFUlk7CiAgIH0gZWxzZSBpZiAoIXN0YXRlT3ZlcnJpZGUgJiYgY2hhciA9PSAnIycpIHsKICAgIHVybC5mcmFnbWVudCA9ICcnOwogICAgc3RhdGUgPSBGUkFHTUVOVDsKICAgfSBlbHNlIGlmIChjaGFyICE9IEVPRikgewogICAgc3RhdGUgPSBQQVRIOwogICAgaWYgKGNoYXIgIT0gJy8nKQogICAgIGNvbnRpbnVlOwogICB9CiAgIGJyZWFrOwogIGNhc2UgUEFUSDoKICAgaWYgKGNoYXIgPT0gRU9GIHx8IGNoYXIgPT0gJy8nIHx8IGNoYXIgPT0gJ1xcJyAmJiBpc1NwZWNpYWwodXJsKSB8fCAhc3RhdGVPdmVycmlkZSAmJiAoY2hhciA9PSAnPycgfHwgY2hhciA9PSAnIycpKSB7CiAgICBpZiAoaXNEb3VibGVEb3QoYnVmZmVyKSkgewogICAgIHNob3J0ZW5VUkxzUGF0aCh1cmwpOwogICAgIGlmIChjaGFyICE9ICcvJyAmJiAhKGNoYXIgPT0gJ1xcJyAmJiBpc1NwZWNpYWwodXJsKSkpIHsKICAgICAgdXJsLnBhdGgucHVzaCgnJyk7CiAgICAgfQogICAgfSBlbHNlIGlmIChpc1NpbmdsZURvdChidWZmZXIpKSB7CiAgICAgaWYgKGNoYXIgIT0gJy8nICYmICEoY2hhciA9PSAnXFwnICYmIGlzU3BlY2lhbCh1cmwpKSkgewogICAgICB1cmwucGF0aC5wdXNoKCcnKTsKICAgICB9CiAgICB9IGVsc2UgewogICAgIGlmICh1cmwuc2NoZW1lID09ICdmaWxlJyAmJiAhdXJsLnBhdGgubGVuZ3RoICYmIGlzV2luZG93c0RyaXZlTGV0dGVyKGJ1ZmZlcikpIHsKICAgICAgaWYgKHVybC5ob3N0KQogICAgICAgdXJsLmhvc3QgPSAnJzsKICAgICAgYnVmZmVyID0gYnVmZmVyLmNoYXJBdCgwKSArICc6JzsKICAgICB9CiAgICAgdXJsLnBhdGgucHVzaChidWZmZXIpOwogICAgfQogICAgYnVmZmVyID0gJyc7CiAgICBpZiAodXJsLnNjaGVtZSA9PSAnZmlsZScgJiYgKGNoYXIgPT0gRU9GIHx8IGNoYXIgPT0gJz8nIHx8IGNoYXIgPT0gJyMnKSkgewogICAgIHdoaWxlICh1cmwucGF0aC5sZW5ndGggPiAxICYmIHVybC5wYXRoWzBdID09PSAnJykgewogICAgICB1cmwucGF0aC5zaGlmdCgpOwogICAgIH0KICAgIH0KICAgIGlmIChjaGFyID09ICc/JykgewogICAgIHVybC5xdWVyeSA9ICcnOwogICAgIHN0YXRlID0gUVVFUlk7CiAgICB9IGVsc2UgaWYgKGNoYXIgPT0gJyMnKSB7CiAgICAgdXJsLmZyYWdtZW50ID0gJyc7CiAgICAgc3RhdGUgPSBGUkFHTUVOVDsKICAgIH0KICAgfSBlbHNlIHsKICAgIGJ1ZmZlciArPSBwZXJjZW50RW5jb2RlKGNoYXIsIHBhdGhQZXJjZW50RW5jb2RlU2V0KTsKICAgfQogICBicmVhazsKICBjYXNlIENBTk5PVF9CRV9BX0JBU0VfVVJMX1BBVEg6CiAgIGlmIChjaGFyID09ICc/JykgewogICAgdXJsLnF1ZXJ5ID0gJyc7CiAgICBzdGF0ZSA9IFFVRVJZOwogICB9IGVsc2UgaWYgKGNoYXIgPT0gJyMnKSB7CiAgICB1cmwuZnJhZ21lbnQgPSAnJzsKICAgIHN0YXRlID0gRlJBR01FTlQ7CiAgIH0gZWxzZSBpZiAoY2hhciAhPSBFT0YpIHsKICAgIHVybC5wYXRoWzBdICs9IHBlcmNlbnRFbmNvZGUoY2hhciwgQzBDb250cm9sUGVyY2VudEVuY29kZVNldCk7CiAgIH0KICAgYnJlYWs7CiAgY2FzZSBRVUVSWToKICAgaWYgKCFzdGF0ZU92ZXJyaWRlICYmIGNoYXIgPT0gJyMnKSB7CiAgICB1cmwuZnJhZ21lbnQgPSAnJzsKICAgIHN0YXRlID0gRlJBR01FTlQ7CiAgIH0gZWxzZSBpZiAoY2hhciAhPSBFT0YpIHsKICAgIGlmIChjaGFyID09ICInIiAmJiBpc1NwZWNpYWwodXJsKSkKICAgICB1cmwucXVlcnkgKz0gJyUyNyc7CiAgICBlbHNlIGlmIChjaGFyID09ICcjJykKICAgICB1cmwucXVlcnkgKz0gJyUyMyc7CiAgICBlbHNlCiAgICAgdXJsLnF1ZXJ5ICs9IHBlcmNlbnRFbmNvZGUoY2hhciwgQzBDb250cm9sUGVyY2VudEVuY29kZVNldCk7CiAgIH0KICAgYnJlYWs7CiAgY2FzZSBGUkFHTUVOVDoKICAgaWYgKGNoYXIgIT0gRU9GKQogICAgdXJsLmZyYWdtZW50ICs9IHBlcmNlbnRFbmNvZGUoY2hhciwgZnJhZ21lbnRQZXJjZW50RW5jb2RlU2V0KTsKICAgYnJlYWs7CiAgfQogIHBvaW50ZXIrKzsKIH0KfTsKdmFyIFVSTENvbnN0cnVjdG9yID0gZnVuY3Rpb24gVVJMKHVybCkgewogdmFyIHRoYXQgPSBhbkluc3RhbmNlKHRoaXMsIFVSTENvbnN0cnVjdG9yLCAnVVJMJyk7CiB2YXIgYmFzZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogdmFyIHVybFN0cmluZyA9IFN0cmluZyh1cmwpOwogdmFyIHN0YXRlID0gc2V0SW50ZXJuYWxTdGF0ZSh0aGF0LCB7IHR5cGU6ICdVUkwnIH0pOwogdmFyIGJhc2VTdGF0ZSwgZmFpbHVyZTsKIGlmIChiYXNlICE9PSB1bmRlZmluZWQpIHsKICBpZiAoYmFzZSBpbnN0YW5jZW9mIFVSTENvbnN0cnVjdG9yKQogICBiYXNlU3RhdGUgPSBnZXRJbnRlcm5hbFVSTFN0YXRlKGJhc2UpOwogIGVsc2UgewogICBmYWlsdXJlID0gcGFyc2VVUkwoYmFzZVN0YXRlID0ge30sIFN0cmluZyhiYXNlKSk7CiAgIGlmIChmYWlsdXJlKQogICAgdGhyb3cgVHlwZUVycm9yKGZhaWx1cmUpOwogIH0KIH0KIGZhaWx1cmUgPSBwYXJzZVVSTChzdGF0ZSwgdXJsU3RyaW5nLCBudWxsLCBiYXNlU3RhdGUpOwogaWYgKGZhaWx1cmUpCiAgdGhyb3cgVHlwZUVycm9yKGZhaWx1cmUpOwogdmFyIHNlYXJjaFBhcmFtcyA9IHN0YXRlLnNlYXJjaFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTsKIHZhciBzZWFyY2hQYXJhbXNTdGF0ZSA9IGdldEludGVybmFsU2VhcmNoUGFyYW1zU3RhdGUoc2VhcmNoUGFyYW1zKTsKIHNlYXJjaFBhcmFtc1N0YXRlLnVwZGF0ZVNlYXJjaFBhcmFtcyhzdGF0ZS5xdWVyeSk7CiBzZWFyY2hQYXJhbXNTdGF0ZS51cGRhdGVVUkwgPSBmdW5jdGlvbiAoKSB7CiAgc3RhdGUucXVlcnkgPSBTdHJpbmcoc2VhcmNoUGFyYW1zKSB8fCBudWxsOwogfTsKIGlmICghREVTQ1JJUFRPUlMpIHsKICB0aGF0LmhyZWYgPSBzZXJpYWxpemVVUkwuY2FsbCh0aGF0KTsKICB0aGF0Lm9yaWdpbiA9IGdldE9yaWdpbi5jYWxsKHRoYXQpOwogIHRoYXQucHJvdG9jb2wgPSBnZXRQcm90b2NvbC5jYWxsKHRoYXQpOwogIHRoYXQudXNlcm5hbWUgPSBnZXRVc2VybmFtZS5jYWxsKHRoYXQpOwogIHRoYXQucGFzc3dvcmQgPSBnZXRQYXNzd29yZC5jYWxsKHRoYXQpOwogIHRoYXQuaG9zdCA9IGdldEhvc3QuY2FsbCh0aGF0KTsKICB0aGF0Lmhvc3RuYW1lID0gZ2V0SG9zdG5hbWUuY2FsbCh0aGF0KTsKICB0aGF0LnBvcnQgPSBnZXRQb3J0LmNhbGwodGhhdCk7CiAgdGhhdC5wYXRobmFtZSA9IGdldFBhdGhuYW1lLmNhbGwodGhhdCk7CiAgdGhhdC5zZWFyY2ggPSBnZXRTZWFyY2guY2FsbCh0aGF0KTsKICB0aGF0LnNlYXJjaFBhcmFtcyA9IGdldFNlYXJjaFBhcmFtcy5jYWxsKHRoYXQpOwogIHRoYXQuaGFzaCA9IGdldEhhc2guY2FsbCh0aGF0KTsKIH0KfTsKdmFyIFVSTFByb3RvdHlwZSA9IFVSTENvbnN0cnVjdG9yLnByb3RvdHlwZTsKdmFyIHNlcmlhbGl6ZVVSTCA9IGZ1bmN0aW9uICgpIHsKIHZhciB1cmwgPSBnZXRJbnRlcm5hbFVSTFN0YXRlKHRoaXMpOwogdmFyIHNjaGVtZSA9IHVybC5zY2hlbWU7CiB2YXIgdXNlcm5hbWUgPSB1cmwudXNlcm5hbWU7CiB2YXIgcGFzc3dvcmQgPSB1cmwucGFzc3dvcmQ7CiB2YXIgaG9zdCA9IHVybC5ob3N0OwogdmFyIHBvcnQgPSB1cmwucG9ydDsKIHZhciBwYXRoID0gdXJsLnBhdGg7CiB2YXIgcXVlcnkgPSB1cmwucXVlcnk7CiB2YXIgZnJhZ21lbnQgPSB1cmwuZnJhZ21lbnQ7CiB2YXIgb3V0cHV0ID0gc2NoZW1lICsgJzonOwogaWYgKGhvc3QgIT09IG51bGwpIHsKICBvdXRwdXQgKz0gJy8vJzsKICBpZiAoaW5jbHVkZXNDcmVkZW50aWFscyh1cmwpKSB7CiAgIG91dHB1dCArPSB1c2VybmFtZSArIChwYXNzd29yZCA/ICc6JyArIHBhc3N3b3JkIDogJycpICsgJ0AnOwogIH0KICBvdXRwdXQgKz0gc2VyaWFsaXplSG9zdChob3N0KTsKICBpZiAocG9ydCAhPT0gbnVsbCkKICAgb3V0cHV0ICs9ICc6JyArIHBvcnQ7CiB9IGVsc2UgaWYgKHNjaGVtZSA9PSAnZmlsZScpCiAgb3V0cHV0ICs9ICcvLyc7CiBvdXRwdXQgKz0gdXJsLmNhbm5vdEJlQUJhc2VVUkwgPyBwYXRoWzBdIDogcGF0aC5sZW5ndGggPyAnLycgKyBwYXRoLmpvaW4oJy8nKSA6ICcnOwogaWYgKHF1ZXJ5ICE9PSBudWxsKQogIG91dHB1dCArPSAnPycgKyBxdWVyeTsKIGlmIChmcmFnbWVudCAhPT0gbnVsbCkKICBvdXRwdXQgKz0gJyMnICsgZnJhZ21lbnQ7CiByZXR1cm4gb3V0cHV0Owp9Owp2YXIgZ2V0T3JpZ2luID0gZnVuY3Rpb24gKCkgewogdmFyIHVybCA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcyk7CiB2YXIgc2NoZW1lID0gdXJsLnNjaGVtZTsKIHZhciBwb3J0ID0gdXJsLnBvcnQ7CiBpZiAoc2NoZW1lID09ICdibG9iJykKICB0cnkgewogICByZXR1cm4gbmV3IFVSTChzY2hlbWUucGF0aFswXSkub3JpZ2luOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgIHJldHVybiAnbnVsbCc7CiAgfQogaWYgKHNjaGVtZSA9PSAnZmlsZScgfHwgIWlzU3BlY2lhbCh1cmwpKQogIHJldHVybiAnbnVsbCc7CiByZXR1cm4gc2NoZW1lICsgJzovLycgKyBzZXJpYWxpemVIb3N0KHVybC5ob3N0KSArIChwb3J0ICE9PSBudWxsID8gJzonICsgcG9ydCA6ICcnKTsKfTsKdmFyIGdldFByb3RvY29sID0gZnVuY3Rpb24gKCkgewogcmV0dXJuIGdldEludGVybmFsVVJMU3RhdGUodGhpcykuc2NoZW1lICsgJzonOwp9Owp2YXIgZ2V0VXNlcm5hbWUgPSBmdW5jdGlvbiAoKSB7CiByZXR1cm4gZ2V0SW50ZXJuYWxVUkxTdGF0ZSh0aGlzKS51c2VybmFtZTsKfTsKdmFyIGdldFBhc3N3b3JkID0gZnVuY3Rpb24gKCkgewogcmV0dXJuIGdldEludGVybmFsVVJMU3RhdGUodGhpcykucGFzc3dvcmQ7Cn07CnZhciBnZXRIb3N0ID0gZnVuY3Rpb24gKCkgewogdmFyIHVybCA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcyk7CiB2YXIgaG9zdCA9IHVybC5ob3N0OwogdmFyIHBvcnQgPSB1cmwucG9ydDsKIHJldHVybiBob3N0ID09PSBudWxsID8gJycgOiBwb3J0ID09PSBudWxsID8gc2VyaWFsaXplSG9zdChob3N0KSA6IHNlcmlhbGl6ZUhvc3QoaG9zdCkgKyAnOicgKyBwb3J0Owp9Owp2YXIgZ2V0SG9zdG5hbWUgPSBmdW5jdGlvbiAoKSB7CiB2YXIgaG9zdCA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcykuaG9zdDsKIHJldHVybiBob3N0ID09PSBudWxsID8gJycgOiBzZXJpYWxpemVIb3N0KGhvc3QpOwp9Owp2YXIgZ2V0UG9ydCA9IGZ1bmN0aW9uICgpIHsKIHZhciBwb3J0ID0gZ2V0SW50ZXJuYWxVUkxTdGF0ZSh0aGlzKS5wb3J0OwogcmV0dXJuIHBvcnQgPT09IG51bGwgPyAnJyA6IFN0cmluZyhwb3J0KTsKfTsKdmFyIGdldFBhdGhuYW1lID0gZnVuY3Rpb24gKCkgewogdmFyIHVybCA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcyk7CiB2YXIgcGF0aCA9IHVybC5wYXRoOwogcmV0dXJuIHVybC5jYW5ub3RCZUFCYXNlVVJMID8gcGF0aFswXSA6IHBhdGgubGVuZ3RoID8gJy8nICsgcGF0aC5qb2luKCcvJykgOiAnJzsKfTsKdmFyIGdldFNlYXJjaCA9IGZ1bmN0aW9uICgpIHsKIHZhciBxdWVyeSA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcykucXVlcnk7CiByZXR1cm4gcXVlcnkgPyAnPycgKyBxdWVyeSA6ICcnOwp9Owp2YXIgZ2V0U2VhcmNoUGFyYW1zID0gZnVuY3Rpb24gKCkgewogcmV0dXJuIGdldEludGVybmFsVVJMU3RhdGUodGhpcykuc2VhcmNoUGFyYW1zOwp9Owp2YXIgZ2V0SGFzaCA9IGZ1bmN0aW9uICgpIHsKIHZhciBmcmFnbWVudCA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcykuZnJhZ21lbnQ7CiByZXR1cm4gZnJhZ21lbnQgPyAnIycgKyBmcmFnbWVudCA6ICcnOwp9Owp2YXIgYWNjZXNzb3JEZXNjcmlwdG9yID0gZnVuY3Rpb24gKGdldHRlciwgc2V0dGVyKSB7CiByZXR1cm4gewogIGdldDogZ2V0dGVyLAogIHNldDogc2V0dGVyLAogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICBlbnVtZXJhYmxlOiB0cnVlCiB9Owp9OwppZiAoREVTQ1JJUFRPUlMpIHsKIGRlZmluZVByb3BlcnRpZXMoVVJMUHJvdG90eXBlLCB7CiAgaHJlZjogYWNjZXNzb3JEZXNjcmlwdG9yKHNlcmlhbGl6ZVVSTCwgZnVuY3Rpb24gKGhyZWYpIHsKICAgdmFyIHVybCA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcyk7CiAgIHZhciB1cmxTdHJpbmcgPSBTdHJpbmcoaHJlZik7CiAgIHZhciBmYWlsdXJlID0gcGFyc2VVUkwodXJsLCB1cmxTdHJpbmcpOwogICBpZiAoZmFpbHVyZSkKICAgIHRocm93IFR5cGVFcnJvcihmYWlsdXJlKTsKICAgZ2V0SW50ZXJuYWxTZWFyY2hQYXJhbXNTdGF0ZSh1cmwuc2VhcmNoUGFyYW1zKS51cGRhdGVTZWFyY2hQYXJhbXModXJsLnF1ZXJ5KTsKICB9KSwKICBvcmlnaW46IGFjY2Vzc29yRGVzY3JpcHRvcihnZXRPcmlnaW4pLAogIHByb3RvY29sOiBhY2Nlc3NvckRlc2NyaXB0b3IoZ2V0UHJvdG9jb2wsIGZ1bmN0aW9uIChwcm90b2NvbCkgewogICB2YXIgdXJsID0gZ2V0SW50ZXJuYWxVUkxTdGF0ZSh0aGlzKTsKICAgcGFyc2VVUkwodXJsLCBTdHJpbmcocHJvdG9jb2wpICsgJzonLCBTQ0hFTUVfU1RBUlQpOwogIH0pLAogIHVzZXJuYW1lOiBhY2Nlc3NvckRlc2NyaXB0b3IoZ2V0VXNlcm5hbWUsIGZ1bmN0aW9uICh1c2VybmFtZSkgewogICB2YXIgdXJsID0gZ2V0SW50ZXJuYWxVUkxTdGF0ZSh0aGlzKTsKICAgdmFyIGNvZGVQb2ludHMgPSBhcnJheUZyb20oU3RyaW5nKHVzZXJuYW1lKSk7CiAgIGlmIChjYW5ub3RIYXZlVXNlcm5hbWVQYXNzd29yZFBvcnQodXJsKSkKICAgIHJldHVybjsKICAgdXJsLnVzZXJuYW1lID0gJyc7CiAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29kZVBvaW50cy5sZW5ndGg7IGkrKykgewogICAgdXJsLnVzZXJuYW1lICs9IHBlcmNlbnRFbmNvZGUoY29kZVBvaW50c1tpXSwgdXNlcmluZm9QZXJjZW50RW5jb2RlU2V0KTsKICAgfQogIH0pLAogIHBhc3N3b3JkOiBhY2Nlc3NvckRlc2NyaXB0b3IoZ2V0UGFzc3dvcmQsIGZ1bmN0aW9uIChwYXNzd29yZCkgewogICB2YXIgdXJsID0gZ2V0SW50ZXJuYWxVUkxTdGF0ZSh0aGlzKTsKICAgdmFyIGNvZGVQb2ludHMgPSBhcnJheUZyb20oU3RyaW5nKHBhc3N3b3JkKSk7CiAgIGlmIChjYW5ub3RIYXZlVXNlcm5hbWVQYXNzd29yZFBvcnQodXJsKSkKICAgIHJldHVybjsKICAgdXJsLnBhc3N3b3JkID0gJyc7CiAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29kZVBvaW50cy5sZW5ndGg7IGkrKykgewogICAgdXJsLnBhc3N3b3JkICs9IHBlcmNlbnRFbmNvZGUoY29kZVBvaW50c1tpXSwgdXNlcmluZm9QZXJjZW50RW5jb2RlU2V0KTsKICAgfQogIH0pLAogIGhvc3Q6IGFjY2Vzc29yRGVzY3JpcHRvcihnZXRIb3N0LCBmdW5jdGlvbiAoaG9zdCkgewogICB2YXIgdXJsID0gZ2V0SW50ZXJuYWxVUkxTdGF0ZSh0aGlzKTsKICAgaWYgKHVybC5jYW5ub3RCZUFCYXNlVVJMKQogICAgcmV0dXJuOwogICBwYXJzZVVSTCh1cmwsIFN0cmluZyhob3N0KSwgSE9TVCk7CiAgfSksCiAgaG9zdG5hbWU6IGFjY2Vzc29yRGVzY3JpcHRvcihnZXRIb3N0bmFtZSwgZnVuY3Rpb24gKGhvc3RuYW1lKSB7CiAgIHZhciB1cmwgPSBnZXRJbnRlcm5hbFVSTFN0YXRlKHRoaXMpOwogICBpZiAodXJsLmNhbm5vdEJlQUJhc2VVUkwpCiAgICByZXR1cm47CiAgIHBhcnNlVVJMKHVybCwgU3RyaW5nKGhvc3RuYW1lKSwgSE9TVE5BTUUpOwogIH0pLAogIHBvcnQ6IGFjY2Vzc29yRGVzY3JpcHRvcihnZXRQb3J0LCBmdW5jdGlvbiAocG9ydCkgewogICB2YXIgdXJsID0gZ2V0SW50ZXJuYWxVUkxTdGF0ZSh0aGlzKTsKICAgaWYgKGNhbm5vdEhhdmVVc2VybmFtZVBhc3N3b3JkUG9ydCh1cmwpKQogICAgcmV0dXJuOwogICBwb3J0ID0gU3RyaW5nKHBvcnQpOwogICBpZiAocG9ydCA9PSAnJykKICAgIHVybC5wb3J0ID0gbnVsbDsKICAgZWxzZQogICAgcGFyc2VVUkwodXJsLCBwb3J0LCBQT1JUKTsKICB9KSwKICBwYXRobmFtZTogYWNjZXNzb3JEZXNjcmlwdG9yKGdldFBhdGhuYW1lLCBmdW5jdGlvbiAocGF0aG5hbWUpIHsKICAgdmFyIHVybCA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcyk7CiAgIGlmICh1cmwuY2Fubm90QmVBQmFzZVVSTCkKICAgIHJldHVybjsKICAgdXJsLnBhdGggPSBbXTsKICAgcGFyc2VVUkwodXJsLCBwYXRobmFtZSArICcnLCBQQVRIX1NUQVJUKTsKICB9KSwKICBzZWFyY2g6IGFjY2Vzc29yRGVzY3JpcHRvcihnZXRTZWFyY2gsIGZ1bmN0aW9uIChzZWFyY2gpIHsKICAgdmFyIHVybCA9IGdldEludGVybmFsVVJMU3RhdGUodGhpcyk7CiAgIHNlYXJjaCA9IFN0cmluZyhzZWFyY2gpOwogICBpZiAoc2VhcmNoID09ICcnKSB7CiAgICB1cmwucXVlcnkgPSBudWxsOwogICB9IGVsc2UgewogICAgaWYgKCc/JyA9PSBzZWFyY2guY2hhckF0KDApKQogICAgIHNlYXJjaCA9IHNlYXJjaC5zbGljZSgxKTsKICAgIHVybC5xdWVyeSA9ICcnOwogICAgcGFyc2VVUkwodXJsLCBzZWFyY2gsIFFVRVJZKTsKICAgfQogICBnZXRJbnRlcm5hbFNlYXJjaFBhcmFtc1N0YXRlKHVybC5zZWFyY2hQYXJhbXMpLnVwZGF0ZVNlYXJjaFBhcmFtcyh1cmwucXVlcnkpOwogIH0pLAogIHNlYXJjaFBhcmFtczogYWNjZXNzb3JEZXNjcmlwdG9yKGdldFNlYXJjaFBhcmFtcyksCiAgaGFzaDogYWNjZXNzb3JEZXNjcmlwdG9yKGdldEhhc2gsIGZ1bmN0aW9uIChoYXNoKSB7CiAgIHZhciB1cmwgPSBnZXRJbnRlcm5hbFVSTFN0YXRlKHRoaXMpOwogICBoYXNoID0gU3RyaW5nKGhhc2gpOwogICBpZiAoaGFzaCA9PSAnJykgewogICAgdXJsLmZyYWdtZW50ID0gbnVsbDsKICAgIHJldHVybjsKICAgfQogICBpZiAoJyMnID09IGhhc2guY2hhckF0KDApKQogICAgaGFzaCA9IGhhc2guc2xpY2UoMSk7CiAgIHVybC5mcmFnbWVudCA9ICcnOwogICBwYXJzZVVSTCh1cmwsIGhhc2gsIEZSQUdNRU5UKTsKICB9KQogfSk7Cn0KcmVkZWZpbmUoVVJMUHJvdG90eXBlLCAndG9KU09OJywgZnVuY3Rpb24gdG9KU09OKCkgewogcmV0dXJuIHNlcmlhbGl6ZVVSTC5jYWxsKHRoaXMpOwp9LCB7IGVudW1lcmFibGU6IHRydWUgfSk7CnJlZGVmaW5lKFVSTFByb3RvdHlwZSwgJ3RvU3RyaW5nJywgZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiByZXR1cm4gc2VyaWFsaXplVVJMLmNhbGwodGhpcyk7Cn0sIHsgZW51bWVyYWJsZTogdHJ1ZSB9KTsKaWYgKE5hdGl2ZVVSTCkgewogdmFyIG5hdGl2ZUNyZWF0ZU9iamVjdFVSTCA9IE5hdGl2ZVVSTC5jcmVhdGVPYmplY3RVUkw7CiB2YXIgbmF0aXZlUmV2b2tlT2JqZWN0VVJMID0gTmF0aXZlVVJMLnJldm9rZU9iamVjdFVSTDsKIGlmIChuYXRpdmVDcmVhdGVPYmplY3RVUkwpCiAgcmVkZWZpbmUoVVJMQ29uc3RydWN0b3IsICdjcmVhdGVPYmplY3RVUkwnLCBmdW5jdGlvbiBjcmVhdGVPYmplY3RVUkwoYmxvYikgewogICByZXR1cm4gbmF0aXZlQ3JlYXRlT2JqZWN0VVJMLmFwcGx5KE5hdGl2ZVVSTCwgYXJndW1lbnRzKTsKICB9KTsKIGlmIChuYXRpdmVSZXZva2VPYmplY3RVUkwpCiAgcmVkZWZpbmUoVVJMQ29uc3RydWN0b3IsICdyZXZva2VPYmplY3RVUkwnLCBmdW5jdGlvbiByZXZva2VPYmplY3RVUkwodXJsKSB7CiAgIHJldHVybiBuYXRpdmVSZXZva2VPYmplY3RVUkwuYXBwbHkoTmF0aXZlVVJMLCBhcmd1bWVudHMpOwogIH0pOwp9CnNldFRvU3RyaW5nVGFnKFVSTENvbnN0cnVjdG9yLCAnVVJMJyk7CiQoewogZ2xvYmFsOiB0cnVlLAogZm9yY2VkOiAhVVNFX05BVElWRV9VUkwsCiBzaGFtOiAhREVTQ1JJUFRPUlMKfSwgeyBVUkw6IFVSTENvbnN0cnVjdG9yIH0pOwoKLyoqKi8gfSksCi8qIDEzOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZmFpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgSVNfUFVSRSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzcpOwp2YXIgSVRFUkFUT1IgPSB3ZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7Cm1vZHVsZS5leHBvcnRzID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKIHZhciB1cmwgPSBuZXcgVVJMKCdiP2E9MSZiPTImYz0zJywgJ2h0dHA6Ly9hJyk7CiB2YXIgc2VhcmNoUGFyYW1zID0gdXJsLnNlYXJjaFBhcmFtczsKIHZhciByZXN1bHQgPSAnJzsKIHVybC5wYXRobmFtZSA9ICdjJTIwZCc7CiBzZWFyY2hQYXJhbXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGtleSkgewogIHNlYXJjaFBhcmFtc1snZGVsZXRlJ10oJ2InKTsKICByZXN1bHQgKz0ga2V5ICsgdmFsdWU7CiB9KTsKIHJldHVybiBJU19QVVJFICYmICF1cmwudG9KU09OIHx8ICFzZWFyY2hQYXJhbXMuc29ydCB8fCB1cmwuaHJlZiAhPT0gJ2h0dHA6Ly9hL2MlMjBkP2E9MSZjPTMnIHx8IHNlYXJjaFBhcmFtcy5nZXQoJ2MnKSAhPT0gJzMnIHx8IFN0cmluZyhuZXcgVVJMU2VhcmNoUGFyYW1zKCc/YT0xJykpICE9PSAnYT0xJyB8fCAhc2VhcmNoUGFyYW1zW0lURVJBVE9SXSB8fCBuZXcgVVJMKCdodHRwczovL2FAYicpLnVzZXJuYW1lICE9PSAnYScgfHwgbmV3IFVSTFNlYXJjaFBhcmFtcyhuZXcgVVJMU2VhcmNoUGFyYW1zKCdhPWInKSkuZ2V0KCdhJykgIT09ICdiJyB8fCBuZXcgVVJMKCdodHRwOi8v0YLQtdGB0YInKS5ob3N0ICE9PSAneG4tLWUxYXliYycgfHwgbmV3IFVSTCgnaHR0cDovL2Ej0LEnKS5oYXNoICE9PSAnIyVEMCVCMScgfHwgcmVzdWx0ICE9PSAnYTFjMycgfHwgbmV3IFVSTCgnaHR0cDovL3gnLCB1bmRlZmluZWQpLmhvc3QgIT09ICd4JzsKfSk7CgovKioqLyB9KSwKLyogMTM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBtYXhJbnQgPSAyMTQ3NDgzNjQ3Owp2YXIgYmFzZSA9IDM2Owp2YXIgdE1pbiA9IDE7CnZhciB0TWF4ID0gMjY7CnZhciBza2V3ID0gMzg7CnZhciBkYW1wID0gNzAwOwp2YXIgaW5pdGlhbEJpYXMgPSA3MjsKdmFyIGluaXRpYWxOID0gMTI4Owp2YXIgZGVsaW1pdGVyID0gJy0nOwp2YXIgcmVnZXhOb25BU0NJSSA9IC9bXlwwLVx1MDA3RV0vOwp2YXIgcmVnZXhTZXBhcmF0b3JzID0gL1suXHUzMDAyXHVGRjBFXHVGRjYxXS9nOwp2YXIgT1ZFUkZMT1dfRVJST1IgPSAnT3ZlcmZsb3c6IGlucHV0IG5lZWRzIHdpZGVyIGludGVnZXJzIHRvIHByb2Nlc3MnOwp2YXIgYmFzZU1pbnVzVE1pbiA9IGJhc2UgLSB0TWluOwp2YXIgZmxvb3IgPSBNYXRoLmZsb29yOwp2YXIgc3RyaW5nRnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZTsKdmFyIHVjczJkZWNvZGUgPSBmdW5jdGlvbiAoc3RyaW5nKSB7CiB2YXIgb3V0cHV0ID0gW107CiB2YXIgY291bnRlciA9IDA7CiB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aDsKIHdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7CiAgdmFyIHZhbHVlID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTsKICBpZiAodmFsdWUgPj0gMHhEODAwICYmIHZhbHVlIDw9IDB4REJGRiAmJiBjb3VudGVyIDwgbGVuZ3RoKSB7CiAgIHZhciBleHRyYSA9IHN0cmluZy5jaGFyQ29kZUF0KGNvdW50ZXIrKyk7CiAgIGlmICgoZXh0cmEgJiAweEZDMDApID09IDB4REMwMCkgewogICAgb3V0cHV0LnB1c2goKCh2YWx1ZSAmIDB4M0ZGKSA8PCAxMCkgKyAoZXh0cmEgJiAweDNGRikgKyAweDEwMDAwKTsKICAgfSBlbHNlIHsKICAgIG91dHB1dC5wdXNoKHZhbHVlKTsKICAgIGNvdW50ZXItLTsKICAgfQogIH0gZWxzZSB7CiAgIG91dHB1dC5wdXNoKHZhbHVlKTsKICB9CiB9CiByZXR1cm4gb3V0cHV0Owp9Owp2YXIgZGlnaXRUb0Jhc2ljID0gZnVuY3Rpb24gKGRpZ2l0KSB7CiByZXR1cm4gZGlnaXQgKyAyMiArIDc1ICogKGRpZ2l0IDwgMjYpOwp9Owp2YXIgYWRhcHQgPSBmdW5jdGlvbiAoZGVsdGEsIG51bVBvaW50cywgZmlyc3RUaW1lKSB7CiB2YXIgayA9IDA7CiBkZWx0YSA9IGZpcnN0VGltZSA/IGZsb29yKGRlbHRhIC8gZGFtcCkgOiBkZWx0YSA+PiAxOwogZGVsdGEgKz0gZmxvb3IoZGVsdGEgLyBudW1Qb2ludHMpOwogZm9yICg7IGRlbHRhID4gYmFzZU1pbnVzVE1pbiAqIHRNYXggPj4gMTsgayArPSBiYXNlKSB7CiAgZGVsdGEgPSBmbG9vcihkZWx0YSAvIGJhc2VNaW51c1RNaW4pOwogfQogcmV0dXJuIGZsb29yKGsgKyAoYmFzZU1pbnVzVE1pbiArIDEpICogZGVsdGEgLyAoZGVsdGEgKyBza2V3KSk7Cn07CnZhciBlbmNvZGUgPSBmdW5jdGlvbiAoaW5wdXQpIHsKIHZhciBvdXRwdXQgPSBbXTsKIGlucHV0ID0gdWNzMmRlY29kZShpbnB1dCk7CiB2YXIgaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7CiB2YXIgbiA9IGluaXRpYWxOOwogdmFyIGRlbHRhID0gMDsKIHZhciBiaWFzID0gaW5pdGlhbEJpYXM7CiB2YXIgaSwgY3VycmVudFZhbHVlOwogZm9yIChpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgY3VycmVudFZhbHVlID0gaW5wdXRbaV07CiAgaWYgKGN1cnJlbnRWYWx1ZSA8IDB4ODApIHsKICAgb3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGN1cnJlbnRWYWx1ZSkpOwogIH0KIH0KIHZhciBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7CiB2YXIgaGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aDsKIGlmIChiYXNpY0xlbmd0aCkgewogIG91dHB1dC5wdXNoKGRlbGltaXRlcik7CiB9CiB3aGlsZSAoaGFuZGxlZENQQ291bnQgPCBpbnB1dExlbmd0aCkgewogIHZhciBtID0gbWF4SW50OwogIGZvciAoaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykgewogICBjdXJyZW50VmFsdWUgPSBpbnB1dFtpXTsKICAgaWYgKGN1cnJlbnRWYWx1ZSA+PSBuICYmIGN1cnJlbnRWYWx1ZSA8IG0pIHsKICAgIG0gPSBjdXJyZW50VmFsdWU7CiAgIH0KICB9CiAgdmFyIGhhbmRsZWRDUENvdW50UGx1c09uZSA9IGhhbmRsZWRDUENvdW50ICsgMTsKICBpZiAobSAtIG4gPiBmbG9vcigobWF4SW50IC0gZGVsdGEpIC8gaGFuZGxlZENQQ291bnRQbHVzT25lKSkgewogICB0aHJvdyBSYW5nZUVycm9yKE9WRVJGTE9XX0VSUk9SKTsKICB9CiAgZGVsdGEgKz0gKG0gLSBuKSAqIGhhbmRsZWRDUENvdW50UGx1c09uZTsKICBuID0gbTsKICBmb3IgKGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHsKICAgY3VycmVudFZhbHVlID0gaW5wdXRbaV07CiAgIGlmIChjdXJyZW50VmFsdWUgPCBuICYmICsrZGVsdGEgPiBtYXhJbnQpIHsKICAgIHRocm93IFJhbmdlRXJyb3IoT1ZFUkZMT1dfRVJST1IpOwogICB9CiAgIGlmIChjdXJyZW50VmFsdWUgPT0gbikgewogICAgdmFyIHEgPSBkZWx0YTsKICAgIGZvciAodmFyIGsgPSBiYXNlOzsgayArPSBiYXNlKSB7CiAgICAgdmFyIHQgPSBrIDw9IGJpYXMgPyB0TWluIDogayA+PSBiaWFzICsgdE1heCA/IHRNYXggOiBrIC0gYmlhczsKICAgICBpZiAocSA8IHQpCiAgICAgIGJyZWFrOwogICAgIHZhciBxTWludXNUID0gcSAtIHQ7CiAgICAgdmFyIGJhc2VNaW51c1QgPSBiYXNlIC0gdDsKICAgICBvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCkpKTsKICAgICBxID0gZmxvb3IocU1pbnVzVCAvIGJhc2VNaW51c1QpOwogICAgfQogICAgb3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGRpZ2l0VG9CYXNpYyhxKSkpOwogICAgYmlhcyA9IGFkYXB0KGRlbHRhLCBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsIGhhbmRsZWRDUENvdW50ID09IGJhc2ljTGVuZ3RoKTsKICAgIGRlbHRhID0gMDsKICAgICsraGFuZGxlZENQQ291bnQ7CiAgIH0KICB9CiAgKytkZWx0YTsKICArK247CiB9CiByZXR1cm4gb3V0cHV0LmpvaW4oJycpOwp9Owptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpbnB1dCkgewogdmFyIGVuY29kZWQgPSBbXTsKIHZhciBsYWJlbHMgPSBpbnB1dC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UocmVnZXhTZXBhcmF0b3JzLCAnXHUwMDJFJykuc3BsaXQoJy4nKTsKIHZhciBpLCBsYWJlbDsKIGZvciAoaSA9IDA7IGkgPCBsYWJlbHMubGVuZ3RoOyBpKyspIHsKICBsYWJlbCA9IGxhYmVsc1tpXTsKICBlbmNvZGVkLnB1c2gocmVnZXhOb25BU0NJSS50ZXN0KGxhYmVsKSA/ICd4bi0tJyArIGVuY29kZShsYWJlbCkgOiBsYWJlbCk7CiB9CiByZXR1cm4gZW5jb2RlZC5qb2luKCcuJyk7Cn07CgovKioqLyB9KSwKLyogMTQwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCl9fd19wZGZqc19yZXF1aXJlX18oMTE4KTsKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIGdldEJ1aWx0SW4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQyKTsKdmFyIFVTRV9OQVRJVkVfVVJMID0gX193X3BkZmpzX3JlcXVpcmVfXygxMzgpOwp2YXIgcmVkZWZpbmUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI5KTsKdmFyIHJlZGVmaW5lQWxsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjEpOwp2YXIgc2V0VG9TdHJpbmdUYWcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg1KTsKdmFyIGNyZWF0ZUl0ZXJhdG9yQ29uc3RydWN0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgwKTsKdmFyIEludGVybmFsU3RhdGVNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDMzKTsKdmFyIGFuSW5zdGFuY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyMyk7CnZhciBoYXNPd24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIGJpbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYyKTsKdmFyIGNsYXNzb2YgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk1KTsKdmFyIGFuT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyOCk7CnZhciBpc09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjIpOwp2YXIgY3JlYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXyg3MSk7CnZhciBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2KTsKdmFyIGdldEl0ZXJhdG9yID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDEpOwp2YXIgZ2V0SXRlcmF0b3JNZXRob2QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk0KTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgJGZldGNoID0gZ2V0QnVpbHRJbignZmV0Y2gnKTsKdmFyIEhlYWRlcnMgPSBnZXRCdWlsdEluKCdIZWFkZXJzJyk7CnZhciBJVEVSQVRPUiA9IHdlbGxLbm93blN5bWJvbCgnaXRlcmF0b3InKTsKdmFyIFVSTF9TRUFSQ0hfUEFSQU1TID0gJ1VSTFNlYXJjaFBhcmFtcyc7CnZhciBVUkxfU0VBUkNIX1BBUkFNU19JVEVSQVRPUiA9IFVSTF9TRUFSQ0hfUEFSQU1TICsgJ0l0ZXJhdG9yJzsKdmFyIHNldEludGVybmFsU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLnNldDsKdmFyIGdldEludGVybmFsUGFyYW1zU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLmdldHRlckZvcihVUkxfU0VBUkNIX1BBUkFNUyk7CnZhciBnZXRJbnRlcm5hbEl0ZXJhdG9yU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLmdldHRlckZvcihVUkxfU0VBUkNIX1BBUkFNU19JVEVSQVRPUik7CnZhciBwbHVzID0gL1wrL2c7CnZhciBzZXF1ZW5jZXMgPSBBcnJheSg0KTsKdmFyIHBlcmNlbnRTZXF1ZW5jZSA9IGZ1bmN0aW9uIChieXRlcykgewogcmV0dXJuIHNlcXVlbmNlc1tieXRlcyAtIDFdIHx8IChzZXF1ZW5jZXNbYnl0ZXMgLSAxXSA9IFJlZ0V4cCgnKCg/OiVbXFxkYS1mXXsyfSl7JyArIGJ5dGVzICsgJ30pJywgJ2dpJykpOwp9Owp2YXIgcGVyY2VudERlY29kZSA9IGZ1bmN0aW9uIChzZXF1ZW5jZSkgewogdHJ5IHsKICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHNlcXVlbmNlKTsKIH0gY2F0Y2ggKGVycm9yKSB7CiAgcmV0dXJuIHNlcXVlbmNlOwogfQp9Owp2YXIgZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaXQpIHsKIHZhciByZXN1bHQgPSBpdC5yZXBsYWNlKHBsdXMsICcgJyk7CiB2YXIgYnl0ZXMgPSA0OwogdHJ5IHsKICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdCk7CiB9IGNhdGNoIChlcnJvcikgewogIHdoaWxlIChieXRlcykgewogICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShwZXJjZW50U2VxdWVuY2UoYnl0ZXMtLSksIHBlcmNlbnREZWNvZGUpOwogIH0KICByZXR1cm4gcmVzdWx0OwogfQp9Owp2YXIgZmluZCA9IC9bIScoKX5dfCUyMC9nOwp2YXIgcmVwbGFjZSA9IHsKICchJzogJyUyMScsCiAiJyI6ICclMjcnLAogJygnOiAnJTI4JywKICcpJzogJyUyOScsCiAnfic6ICclN0UnLAogJyUyMCc6ICcrJwp9Owp2YXIgcmVwbGFjZXIgPSBmdW5jdGlvbiAobWF0Y2gpIHsKIHJldHVybiByZXBsYWNlW21hdGNoXTsKfTsKdmFyIHNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpdCkgewogcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChpdCkucmVwbGFjZShmaW5kLCByZXBsYWNlcik7Cn07CnZhciBwYXJzZVNlYXJjaFBhcmFtcyA9IGZ1bmN0aW9uIChyZXN1bHQsIHF1ZXJ5KSB7CiBpZiAocXVlcnkpIHsKICB2YXIgYXR0cmlidXRlcyA9IHF1ZXJ5LnNwbGl0KCcmJyk7CiAgdmFyIGluZGV4ID0gMDsKICB2YXIgYXR0cmlidXRlLCBlbnRyeTsKICB3aGlsZSAoaW5kZXggPCBhdHRyaWJ1dGVzLmxlbmd0aCkgewogICBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW2luZGV4KytdOwogICBpZiAoYXR0cmlidXRlLmxlbmd0aCkgewogICAgZW50cnkgPSBhdHRyaWJ1dGUuc3BsaXQoJz0nKTsKICAgIHJlc3VsdC5wdXNoKHsKICAgICBrZXk6IGRlc2VyaWFsaXplKGVudHJ5LnNoaWZ0KCkpLAogICAgIHZhbHVlOiBkZXNlcmlhbGl6ZShlbnRyeS5qb2luKCc9JykpCiAgICB9KTsKICAgfQogIH0KIH0KfTsKdmFyIHVwZGF0ZVNlYXJjaFBhcmFtcyA9IGZ1bmN0aW9uIChxdWVyeSkgewogdGhpcy5lbnRyaWVzLmxlbmd0aCA9IDA7CiBwYXJzZVNlYXJjaFBhcmFtcyh0aGlzLmVudHJpZXMsIHF1ZXJ5KTsKfTsKdmFyIHZhbGlkYXRlQXJndW1lbnRzTGVuZ3RoID0gZnVuY3Rpb24gKHBhc3NlZCwgcmVxdWlyZWQpIHsKIGlmIChwYXNzZWQgPCByZXF1aXJlZCkKICB0aHJvdyBUeXBlRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7Cn07CnZhciBVUkxTZWFyY2hQYXJhbXNJdGVyYXRvciA9IGNyZWF0ZUl0ZXJhdG9yQ29uc3RydWN0b3IoZnVuY3Rpb24gSXRlcmF0b3IocGFyYW1zLCBraW5kKSB7CiBzZXRJbnRlcm5hbFN0YXRlKHRoaXMsIHsKICB0eXBlOiBVUkxfU0VBUkNIX1BBUkFNU19JVEVSQVRPUiwKICBpdGVyYXRvcjogZ2V0SXRlcmF0b3IoZ2V0SW50ZXJuYWxQYXJhbXNTdGF0ZShwYXJhbXMpLmVudHJpZXMpLAogIGtpbmQ6IGtpbmQKIH0pOwp9LCAnSXRlcmF0b3InLCBmdW5jdGlvbiBuZXh0KCkgewogdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxJdGVyYXRvclN0YXRlKHRoaXMpOwogdmFyIGtpbmQgPSBzdGF0ZS5raW5kOwogdmFyIHN0ZXAgPSBzdGF0ZS5pdGVyYXRvci5uZXh0KCk7CiB2YXIgZW50cnkgPSBzdGVwLnZhbHVlOwogaWYgKCFzdGVwLmRvbmUpIHsKICBzdGVwLnZhbHVlID0ga2luZCA9PT0gJ2tleXMnID8gZW50cnkua2V5IDoga2luZCA9PT0gJ3ZhbHVlcycgPyBlbnRyeS52YWx1ZSA6IFsKICAgZW50cnkua2V5LAogICBlbnRyeS52YWx1ZQogIF07CiB9CiByZXR1cm4gc3RlcDsKfSk7CnZhciBVUkxTZWFyY2hQYXJhbXNDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uIFVSTFNlYXJjaFBhcmFtcygpIHsKIGFuSW5zdGFuY2UodGhpcywgVVJMU2VhcmNoUGFyYW1zQ29uc3RydWN0b3IsIFVSTF9TRUFSQ0hfUEFSQU1TKTsKIHZhciBpbml0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQ7CiB2YXIgdGhhdCA9IHRoaXM7CiB2YXIgZW50cmllcyA9IFtdOwogdmFyIGl0ZXJhdG9yTWV0aG9kLCBpdGVyYXRvciwgbmV4dCwgc3RlcCwgZW50cnlJdGVyYXRvciwgZW50cnlOZXh0LCBmaXJzdCwgc2Vjb25kLCBrZXk7CiBzZXRJbnRlcm5hbFN0YXRlKHRoYXQsIHsKICB0eXBlOiBVUkxfU0VBUkNIX1BBUkFNUywKICBlbnRyaWVzOiBlbnRyaWVzLAogIHVwZGF0ZVVSTDogZnVuY3Rpb24gKCkgewogIH0sCiAgdXBkYXRlU2VhcmNoUGFyYW1zOiB1cGRhdGVTZWFyY2hQYXJhbXMKIH0pOwogaWYgKGluaXQgIT09IHVuZGVmaW5lZCkgewogIGlmIChpc09iamVjdChpbml0KSkgewogICBpdGVyYXRvck1ldGhvZCA9IGdldEl0ZXJhdG9yTWV0aG9kKGluaXQpOwogICBpZiAodHlwZW9mIGl0ZXJhdG9yTWV0aG9kID09PSAnZnVuY3Rpb24nKSB7CiAgICBpdGVyYXRvciA9IGl0ZXJhdG9yTWV0aG9kLmNhbGwoaW5pdCk7CiAgICBuZXh0ID0gaXRlcmF0b3IubmV4dDsKICAgIHdoaWxlICghKHN0ZXAgPSBuZXh0LmNhbGwoaXRlcmF0b3IpKS5kb25lKSB7CiAgICAgZW50cnlJdGVyYXRvciA9IGdldEl0ZXJhdG9yKGFuT2JqZWN0KHN0ZXAudmFsdWUpKTsKICAgICBlbnRyeU5leHQgPSBlbnRyeUl0ZXJhdG9yLm5leHQ7CiAgICAgaWYgKChmaXJzdCA9IGVudHJ5TmV4dC5jYWxsKGVudHJ5SXRlcmF0b3IpKS5kb25lIHx8IChzZWNvbmQgPSBlbnRyeU5leHQuY2FsbChlbnRyeUl0ZXJhdG9yKSkuZG9uZSB8fCAhZW50cnlOZXh0LmNhbGwoZW50cnlJdGVyYXRvcikuZG9uZSkKICAgICAgdGhyb3cgVHlwZUVycm9yKCdFeHBlY3RlZCBzZXF1ZW5jZSB3aXRoIGxlbmd0aCAyJyk7CiAgICAgZW50cmllcy5wdXNoKHsKICAgICAga2V5OiBmaXJzdC52YWx1ZSArICcnLAogICAgICB2YWx1ZTogc2Vjb25kLnZhbHVlICsgJycKICAgICB9KTsKICAgIH0KICAgfSBlbHNlCiAgICBmb3IgKGtleSBpbiBpbml0KQogICAgIGlmIChoYXNPd24oaW5pdCwga2V5KSkKICAgICAgZW50cmllcy5wdXNoKHsKICAgICAgIGtleToga2V5LAogICAgICAgdmFsdWU6IGluaXRba2V5XSArICcnCiAgICAgIH0pOwogIH0gZWxzZSB7CiAgIHBhcnNlU2VhcmNoUGFyYW1zKGVudHJpZXMsIHR5cGVvZiBpbml0ID09PSAnc3RyaW5nJyA/IGluaXQuY2hhckF0KDApID09PSAnPycgPyBpbml0LnNsaWNlKDEpIDogaW5pdCA6IGluaXQgKyAnJyk7CiAgfQogfQp9Owp2YXIgVVJMU2VhcmNoUGFyYW1zUHJvdG90eXBlID0gVVJMU2VhcmNoUGFyYW1zQ29uc3RydWN0b3IucHJvdG90eXBlOwpyZWRlZmluZUFsbChVUkxTZWFyY2hQYXJhbXNQcm90b3R5cGUsIHsKIGFwcGVuZDogZnVuY3Rpb24gYXBwZW5kKG5hbWUsIHZhbHVlKSB7CiAgdmFsaWRhdGVBcmd1bWVudHNMZW5ndGgoYXJndW1lbnRzLmxlbmd0aCwgMik7CiAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxQYXJhbXNTdGF0ZSh0aGlzKTsKICBzdGF0ZS5lbnRyaWVzLnB1c2goewogICBrZXk6IG5hbWUgKyAnJywKICAgdmFsdWU6IHZhbHVlICsgJycKICB9KTsKICBzdGF0ZS51cGRhdGVVUkwoKTsKIH0sCiAnZGVsZXRlJzogZnVuY3Rpb24gKG5hbWUpIHsKICB2YWxpZGF0ZUFyZ3VtZW50c0xlbmd0aChhcmd1bWVudHMubGVuZ3RoLCAxKTsKICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFBhcmFtc1N0YXRlKHRoaXMpOwogIHZhciBlbnRyaWVzID0gc3RhdGUuZW50cmllczsKICB2YXIga2V5ID0gbmFtZSArICcnOwogIHZhciBpbmRleCA9IDA7CiAgd2hpbGUgKGluZGV4IDwgZW50cmllcy5sZW5ndGgpIHsKICAgaWYgKGVudHJpZXNbaW5kZXhdLmtleSA9PT0ga2V5KQogICAgZW50cmllcy5zcGxpY2UoaW5kZXgsIDEpOwogICBlbHNlCiAgICBpbmRleCsrOwogIH0KICBzdGF0ZS51cGRhdGVVUkwoKTsKIH0sCiBnZXQ6IGZ1bmN0aW9uIGdldChuYW1lKSB7CiAgdmFsaWRhdGVBcmd1bWVudHNMZW5ndGgoYXJndW1lbnRzLmxlbmd0aCwgMSk7CiAgdmFyIGVudHJpZXMgPSBnZXRJbnRlcm5hbFBhcmFtc1N0YXRlKHRoaXMpLmVudHJpZXM7CiAgdmFyIGtleSA9IG5hbWUgKyAnJzsKICB2YXIgaW5kZXggPSAwOwogIGZvciAoOyBpbmRleCA8IGVudHJpZXMubGVuZ3RoOyBpbmRleCsrKSB7CiAgIGlmIChlbnRyaWVzW2luZGV4XS5rZXkgPT09IGtleSkKICAgIHJldHVybiBlbnRyaWVzW2luZGV4XS52YWx1ZTsKICB9CiAgcmV0dXJuIG51bGw7CiB9LAogZ2V0QWxsOiBmdW5jdGlvbiBnZXRBbGwobmFtZSkgewogIHZhbGlkYXRlQXJndW1lbnRzTGVuZ3RoKGFyZ3VtZW50cy5sZW5ndGgsIDEpOwogIHZhciBlbnRyaWVzID0gZ2V0SW50ZXJuYWxQYXJhbXNTdGF0ZSh0aGlzKS5lbnRyaWVzOwogIHZhciBrZXkgPSBuYW1lICsgJyc7CiAgdmFyIHJlc3VsdCA9IFtdOwogIHZhciBpbmRleCA9IDA7CiAgZm9yICg7IGluZGV4IDwgZW50cmllcy5sZW5ndGg7IGluZGV4KyspIHsKICAgaWYgKGVudHJpZXNbaW5kZXhdLmtleSA9PT0ga2V5KQogICAgcmVzdWx0LnB1c2goZW50cmllc1tpbmRleF0udmFsdWUpOwogIH0KICByZXR1cm4gcmVzdWx0OwogfSwKIGhhczogZnVuY3Rpb24gaGFzKG5hbWUpIHsKICB2YWxpZGF0ZUFyZ3VtZW50c0xlbmd0aChhcmd1bWVudHMubGVuZ3RoLCAxKTsKICB2YXIgZW50cmllcyA9IGdldEludGVybmFsUGFyYW1zU3RhdGUodGhpcykuZW50cmllczsKICB2YXIga2V5ID0gbmFtZSArICcnOwogIHZhciBpbmRleCA9IDA7CiAgd2hpbGUgKGluZGV4IDwgZW50cmllcy5sZW5ndGgpIHsKICAgaWYgKGVudHJpZXNbaW5kZXgrK10ua2V5ID09PSBrZXkpCiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgcmV0dXJuIGZhbHNlOwogfSwKIHNldDogZnVuY3Rpb24gc2V0KG5hbWUsIHZhbHVlKSB7CiAgdmFsaWRhdGVBcmd1bWVudHNMZW5ndGgoYXJndW1lbnRzLmxlbmd0aCwgMSk7CiAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxQYXJhbXNTdGF0ZSh0aGlzKTsKICB2YXIgZW50cmllcyA9IHN0YXRlLmVudHJpZXM7CiAgdmFyIGZvdW5kID0gZmFsc2U7CiAgdmFyIGtleSA9IG5hbWUgKyAnJzsKICB2YXIgdmFsID0gdmFsdWUgKyAnJzsKICB2YXIgaW5kZXggPSAwOwogIHZhciBlbnRyeTsKICBmb3IgKDsgaW5kZXggPCBlbnRyaWVzLmxlbmd0aDsgaW5kZXgrKykgewogICBlbnRyeSA9IGVudHJpZXNbaW5kZXhdOwogICBpZiAoZW50cnkua2V5ID09PSBrZXkpIHsKICAgIGlmIChmb3VuZCkKICAgICBlbnRyaWVzLnNwbGljZShpbmRleC0tLCAxKTsKICAgIGVsc2UgewogICAgIGZvdW5kID0gdHJ1ZTsKICAgICBlbnRyeS52YWx1ZSA9IHZhbDsKICAgIH0KICAgfQogIH0KICBpZiAoIWZvdW5kKQogICBlbnRyaWVzLnB1c2goewogICAga2V5OiBrZXksCiAgICB2YWx1ZTogdmFsCiAgIH0pOwogIHN0YXRlLnVwZGF0ZVVSTCgpOwogfSwKIHNvcnQ6IGZ1bmN0aW9uIHNvcnQoKSB7CiAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxQYXJhbXNTdGF0ZSh0aGlzKTsKICB2YXIgZW50cmllcyA9IHN0YXRlLmVudHJpZXM7CiAgdmFyIHNsaWNlID0gZW50cmllcy5zbGljZSgpOwogIHZhciBlbnRyeSwgZW50cmllc0luZGV4LCBzbGljZUluZGV4OwogIGVudHJpZXMubGVuZ3RoID0gMDsKICBmb3IgKHNsaWNlSW5kZXggPSAwOyBzbGljZUluZGV4IDwgc2xpY2UubGVuZ3RoOyBzbGljZUluZGV4KyspIHsKICAgZW50cnkgPSBzbGljZVtzbGljZUluZGV4XTsKICAgZm9yIChlbnRyaWVzSW5kZXggPSAwOyBlbnRyaWVzSW5kZXggPCBzbGljZUluZGV4OyBlbnRyaWVzSW5kZXgrKykgewogICAgaWYgKGVudHJpZXNbZW50cmllc0luZGV4XS5rZXkgPiBlbnRyeS5rZXkpIHsKICAgICBlbnRyaWVzLnNwbGljZShlbnRyaWVzSW5kZXgsIDAsIGVudHJ5KTsKICAgICBicmVhazsKICAgIH0KICAgfQogICBpZiAoZW50cmllc0luZGV4ID09PSBzbGljZUluZGV4KQogICAgZW50cmllcy5wdXNoKGVudHJ5KTsKICB9CiAgc3RhdGUudXBkYXRlVVJMKCk7CiB9LAogZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChjYWxsYmFjaykgewogIHZhciBlbnRyaWVzID0gZ2V0SW50ZXJuYWxQYXJhbXNTdGF0ZSh0aGlzKS5lbnRyaWVzOwogIHZhciBib3VuZEZ1bmN0aW9uID0gYmluZChjYWxsYmFjaywgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQsIDMpOwogIHZhciBpbmRleCA9IDA7CiAgdmFyIGVudHJ5OwogIHdoaWxlIChpbmRleCA8IGVudHJpZXMubGVuZ3RoKSB7CiAgIGVudHJ5ID0gZW50cmllc1tpbmRleCsrXTsKICAgYm91bmRGdW5jdGlvbihlbnRyeS52YWx1ZSwgZW50cnkua2V5LCB0aGlzKTsKICB9CiB9LAoga2V5czogZnVuY3Rpb24ga2V5cygpIHsKICByZXR1cm4gbmV3IFVSTFNlYXJjaFBhcmFtc0l0ZXJhdG9yKHRoaXMsICdrZXlzJyk7CiB9LAogdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoKSB7CiAgcmV0dXJuIG5ldyBVUkxTZWFyY2hQYXJhbXNJdGVyYXRvcih0aGlzLCAndmFsdWVzJyk7CiB9LAogZW50cmllczogZnVuY3Rpb24gZW50cmllcygpIHsKICByZXR1cm4gbmV3IFVSTFNlYXJjaFBhcmFtc0l0ZXJhdG9yKHRoaXMsICdlbnRyaWVzJyk7CiB9Cn0sIHsgZW51bWVyYWJsZTogdHJ1ZSB9KTsKcmVkZWZpbmUoVVJMU2VhcmNoUGFyYW1zUHJvdG90eXBlLCBJVEVSQVRPUiwgVVJMU2VhcmNoUGFyYW1zUHJvdG90eXBlLmVudHJpZXMpOwpyZWRlZmluZShVUkxTZWFyY2hQYXJhbXNQcm90b3R5cGUsICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCkgewogdmFyIGVudHJpZXMgPSBnZXRJbnRlcm5hbFBhcmFtc1N0YXRlKHRoaXMpLmVudHJpZXM7CiB2YXIgcmVzdWx0ID0gW107CiB2YXIgaW5kZXggPSAwOwogdmFyIGVudHJ5Owogd2hpbGUgKGluZGV4IDwgZW50cmllcy5sZW5ndGgpIHsKICBlbnRyeSA9IGVudHJpZXNbaW5kZXgrK107CiAgcmVzdWx0LnB1c2goc2VyaWFsaXplKGVudHJ5LmtleSkgKyAnPScgKyBzZXJpYWxpemUoZW50cnkudmFsdWUpKTsKIH0KIHJldHVybiByZXN1bHQuam9pbignJicpOwp9LCB7IGVudW1lcmFibGU6IHRydWUgfSk7CnNldFRvU3RyaW5nVGFnKFVSTFNlYXJjaFBhcmFtc0NvbnN0cnVjdG9yLCBVUkxfU0VBUkNIX1BBUkFNUyk7CiQoewogZ2xvYmFsOiB0cnVlLAogZm9yY2VkOiAhVVNFX05BVElWRV9VUkwKfSwgeyBVUkxTZWFyY2hQYXJhbXM6IFVSTFNlYXJjaFBhcmFtc0NvbnN0cnVjdG9yIH0pOwppZiAoIVVTRV9OQVRJVkVfVVJMICYmIHR5cGVvZiAkZmV0Y2ggPT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgSGVhZGVycyA9PSAnZnVuY3Rpb24nKSB7CiAkKHsKICBnbG9iYWw6IHRydWUsCiAgZW51bWVyYWJsZTogdHJ1ZSwKICBmb3JjZWQ6IHRydWUKIH0sIHsKICBmZXRjaDogZnVuY3Rpb24gZmV0Y2goaW5wdXQpIHsKICAgdmFyIGFyZ3MgPSBbaW5wdXRdOwogICB2YXIgaW5pdCwgYm9keSwgaGVhZGVyczsKICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7CiAgICBpbml0ID0gYXJndW1lbnRzWzFdOwogICAgaWYgKGlzT2JqZWN0KGluaXQpKSB7CiAgICAgYm9keSA9IGluaXQuYm9keTsKICAgICBpZiAoY2xhc3NvZihib2R5KSA9PT0gVVJMX1NFQVJDSF9QQVJBTVMpIHsKICAgICAgaGVhZGVycyA9IGluaXQuaGVhZGVycyA/IG5ldyBIZWFkZXJzKGluaXQuaGVhZGVycykgOiBuZXcgSGVhZGVycygpOwogICAgICBpZiAoIWhlYWRlcnMuaGFzKCdjb250ZW50LXR5cGUnKSkgewogICAgICAgaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCcpOwogICAgICB9CiAgICAgIGluaXQgPSBjcmVhdGUoaW5pdCwgewogICAgICAgYm9keTogY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKDAsIFN0cmluZyhib2R5KSksCiAgICAgICBoZWFkZXJzOiBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IoMCwgaGVhZGVycykKICAgICAgfSk7CiAgICAgfQogICAgfQogICAgYXJncy5wdXNoKGluaXQpOwogICB9CiAgIHJldHVybiAkZmV0Y2guYXBwbHkodGhpcywgYXJncyk7CiAgfQogfSk7Cn0KbW9kdWxlLmV4cG9ydHMgPSB7CiBVUkxTZWFyY2hQYXJhbXM6IFVSTFNlYXJjaFBhcmFtc0NvbnN0cnVjdG9yLAogZ2V0U3RhdGU6IGdldEludGVybmFsUGFyYW1zU3RhdGUKfTsKCi8qKiovIH0pLAovKiAxNDEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGFuT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyOCk7CnZhciBnZXRJdGVyYXRvck1ldGhvZCA9IF9fd19wZGZqc19yZXF1aXJlX18oOTQpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkgewogdmFyIGl0ZXJhdG9yTWV0aG9kID0gZ2V0SXRlcmF0b3JNZXRob2QoaXQpOwogaWYgKHR5cGVvZiBpdGVyYXRvck1ldGhvZCAhPSAnZnVuY3Rpb24nKSB7CiAgdGhyb3cgVHlwZUVycm9yKFN0cmluZyhpdCkgKyAnIGlzIG5vdCBpdGVyYWJsZScpOwogfQogcmV0dXJuIGFuT2JqZWN0KGl0ZXJhdG9yTWV0aG9kLmNhbGwoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAxNDIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKJCh7CiB0YXJnZXQ6ICdVUkwnLAogcHJvdG86IHRydWUsCiBlbnVtZXJhYmxlOiB0cnVlCn0sIHsKIHRvSlNPTjogZnVuY3Rpb24gdG9KU09OKCkgewogIHJldHVybiBVUkwucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGhpcyk7CiB9Cn0pOwoKLyoqKi8gfSksCi8qIDE0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgooZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkgewogIHRydWUgPyBmYWN0b3J5KGV4cG9ydHMpIDogdW5kZWZpbmVkOwp9KHRoaXMsIGZ1bmN0aW9uIChleHBvcnRzKSB7CiAndXNlIHN0cmljdCc7CiB2YXIgU3ltYm9sUG9seWZpbGwgPSB0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICdzeW1ib2wnID8gU3ltYm9sIDogZnVuY3Rpb24gKGRlc2NyaXB0aW9uKSB7CiAgcmV0dXJuICJTeW1ib2woIiArIGRlc2NyaXB0aW9uICsgIikiOwogfTsKIGZ1bmN0aW9uIG5vb3AoKSB7CiB9CiB2YXIgTnVtYmVySXNOYU4gPSBOdW1iZXIuaXNOYU4gfHwgZnVuY3Rpb24gKHgpIHsKICByZXR1cm4geCAhPT0geDsKIH07CiB2YXIgcmV0aHJvd0Fzc2VydGlvbkVycm9yUmVqZWN0aW9uID0gbm9vcDsKIGZ1bmN0aW9uIHR5cGVJc09iamVjdCh4KSB7CiAgcmV0dXJuIHR5cGVvZiB4ID09PSAnb2JqZWN0JyAmJiB4ICE9PSBudWxsIHx8IHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nOwogfQogZnVuY3Rpb24gY3JlYXRlQXJyYXlGcm9tTGlzdChlbGVtZW50cykgewogIHJldHVybiBlbGVtZW50cy5zbGljZSgpOwogfQogZnVuY3Rpb24gQXJyYXlCdWZmZXJDb3B5KGRlc3QsIGRlc3RPZmZzZXQsIHNyYywgc3JjT2Zmc2V0LCBuKSB7CiAgbmV3IFVpbnQ4QXJyYXkoZGVzdCkuc2V0KG5ldyBVaW50OEFycmF5KHNyYywgc3JjT2Zmc2V0LCBuKSwgZGVzdE9mZnNldCk7CiB9CiBmdW5jdGlvbiBJc0Zpbml0ZU5vbk5lZ2F0aXZlTnVtYmVyKHYpIHsKICBpZiAoSXNOb25OZWdhdGl2ZU51bWJlcih2KSA9PT0gZmFsc2UpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAodiA9PT0gSW5maW5pdHkpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKIH0KIGZ1bmN0aW9uIElzTm9uTmVnYXRpdmVOdW1iZXIodikgewogIGlmICh0eXBlb2YgdiAhPT0gJ251bWJlcicpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAoTnVtYmVySXNOYU4odikpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAodiA8IDApIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKIH0KIGZ1bmN0aW9uIENhbGwoRiwgViwgYXJncykgewogIGlmICh0eXBlb2YgRiAhPT0gJ2Z1bmN0aW9uJykgewogICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBpcyBub3QgYSBmdW5jdGlvbicpOwogIH0KICByZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmNhbGwoRiwgViwgYXJncyk7CiB9CiBmdW5jdGlvbiBDcmVhdGVBbGdvcml0aG1Gcm9tVW5kZXJseWluZ01ldGhvZCh1bmRlcmx5aW5nT2JqZWN0LCBtZXRob2ROYW1lLCBhbGdvQXJnQ291bnQsIGV4dHJhQXJncykgewogIHZhciBtZXRob2QgPSB1bmRlcmx5aW5nT2JqZWN0W21ldGhvZE5hbWVdOwogIGlmIChtZXRob2QgIT09IHVuZGVmaW5lZCkgewogICBpZiAodHlwZW9mIG1ldGhvZCAhPT0gJ2Z1bmN0aW9uJykgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcihtZXRob2QgKyAiIGlzIG5vdCBhIG1ldGhvZCIpOwogICB9CiAgIHN3aXRjaCAoYWxnb0FyZ0NvdW50KSB7CiAgIGNhc2UgMDogewogICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBQcm9taXNlQ2FsbChtZXRob2QsIHVuZGVybHlpbmdPYmplY3QsIGV4dHJhQXJncyk7CiAgICAgfTsKICAgIH0KICAgY2FzZSAxOiB7CiAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcmcpIHsKICAgICAgdmFyIGZ1bGxBcmdzID0gW2FyZ10uY29uY2F0KGV4dHJhQXJncyk7CiAgICAgIHJldHVybiBQcm9taXNlQ2FsbChtZXRob2QsIHVuZGVybHlpbmdPYmplY3QsIGZ1bGxBcmdzKTsKICAgICB9OwogICAgfQogICB9CiAgfQogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKHVuZGVmaW5lZCk7CiAgfTsKIH0KIGZ1bmN0aW9uIEludm9rZU9yTm9vcChPLCBQLCBhcmdzKSB7CiAgdmFyIG1ldGhvZCA9IE9bUF07CiAgaWYgKG1ldGhvZCA9PT0gdW5kZWZpbmVkKSB7CiAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQogIHJldHVybiBDYWxsKG1ldGhvZCwgTywgYXJncyk7CiB9CiBmdW5jdGlvbiBQcm9taXNlQ2FsbChGLCBWLCBhcmdzKSB7CiAgdHJ5IHsKICAgcmV0dXJuIHByb21pc2VSZXNvbHZlZFdpdGgoQ2FsbChGLCBWLCBhcmdzKSk7CiAgfSBjYXRjaCAodmFsdWUpIHsKICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgodmFsdWUpOwogIH0KIH0KIGZ1bmN0aW9uIFRyYW5zZmVyQXJyYXlCdWZmZXIoTykgewogIHJldHVybiBPOwogfQogZnVuY3Rpb24gSXNEZXRhY2hlZEJ1ZmZlcihPKSB7CiAgcmV0dXJuIGZhbHNlOwogfQogZnVuY3Rpb24gVmFsaWRhdGVBbmROb3JtYWxpemVIaWdoV2F0ZXJNYXJrKGhpZ2hXYXRlck1hcmspIHsKICBoaWdoV2F0ZXJNYXJrID0gTnVtYmVyKGhpZ2hXYXRlck1hcmspOwogIGlmIChOdW1iZXJJc05hTihoaWdoV2F0ZXJNYXJrKSB8fCBoaWdoV2F0ZXJNYXJrIDwgMCkgewogICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignaGlnaFdhdGVyTWFyayBwcm9wZXJ0eSBvZiBhIHF1ZXVpbmcgc3RyYXRlZ3kgbXVzdCBiZSBub24tbmVnYXRpdmUgYW5kIG5vbi1OYU4nKTsKICB9CiAgcmV0dXJuIGhpZ2hXYXRlck1hcms7CiB9CiBmdW5jdGlvbiBNYWtlU2l6ZUFsZ29yaXRobUZyb21TaXplRnVuY3Rpb24oc2l6ZSkgewogIGlmIChzaXplID09PSB1bmRlZmluZWQpIHsKICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAxOwogICB9OwogIH0KICBpZiAodHlwZW9mIHNpemUgIT09ICdmdW5jdGlvbicpIHsKICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc2l6ZSBwcm9wZXJ0eSBvZiBhIHF1ZXVpbmcgc3RyYXRlZ3kgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7CiAgfQogIHJldHVybiBmdW5jdGlvbiAoY2h1bmspIHsKICAgcmV0dXJuIHNpemUoY2h1bmspOwogIH07CiB9CiB2YXIgb3JpZ2luYWxQcm9taXNlID0gUHJvbWlzZTsKIHZhciBvcmlnaW5hbFByb21pc2VUaGVuID0gUHJvbWlzZS5wcm90b3R5cGUudGhlbjsKIHZhciBvcmlnaW5hbFByb21pc2VSZXNvbHZlID0gUHJvbWlzZS5yZXNvbHZlLmJpbmQob3JpZ2luYWxQcm9taXNlKTsKIHZhciBvcmlnaW5hbFByb21pc2VSZWplY3QgPSBQcm9taXNlLnJlamVjdC5iaW5kKG9yaWdpbmFsUHJvbWlzZSk7CiBmdW5jdGlvbiBuZXdQcm9taXNlKGV4ZWN1dG9yKSB7CiAgcmV0dXJuIG5ldyBvcmlnaW5hbFByb21pc2UoZXhlY3V0b3IpOwogfQogZnVuY3Rpb24gcHJvbWlzZVJlc29sdmVkV2l0aCh2YWx1ZSkgewogIHJldHVybiBvcmlnaW5hbFByb21pc2VSZXNvbHZlKHZhbHVlKTsKIH0KIGZ1bmN0aW9uIHByb21pc2VSZWplY3RlZFdpdGgocmVhc29uKSB7CiAgcmV0dXJuIG9yaWdpbmFsUHJvbWlzZVJlamVjdChyZWFzb24pOwogfQogZnVuY3Rpb24gUGVyZm9ybVByb21pc2VUaGVuKHByb21pc2UsIG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7CiAgcmV0dXJuIG9yaWdpbmFsUHJvbWlzZVRoZW4uY2FsbChwcm9taXNlLCBvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCk7CiB9CiBmdW5jdGlvbiB1cG9uUHJvbWlzZShwcm9taXNlLCBvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkgewogIFBlcmZvcm1Qcm9taXNlVGhlbihQZXJmb3JtUHJvbWlzZVRoZW4ocHJvbWlzZSwgb25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpLCB1bmRlZmluZWQsIHJldGhyb3dBc3NlcnRpb25FcnJvclJlamVjdGlvbik7CiB9CiBmdW5jdGlvbiB1cG9uRnVsZmlsbG1lbnQocHJvbWlzZSwgb25GdWxmaWxsZWQpIHsKICB1cG9uUHJvbWlzZShwcm9taXNlLCBvbkZ1bGZpbGxlZCk7CiB9CiBmdW5jdGlvbiB1cG9uUmVqZWN0aW9uKHByb21pc2UsIG9uUmVqZWN0ZWQpIHsKICB1cG9uUHJvbWlzZShwcm9taXNlLCB1bmRlZmluZWQsIG9uUmVqZWN0ZWQpOwogfQogZnVuY3Rpb24gdHJhbnNmb3JtUHJvbWlzZVdpdGgocHJvbWlzZSwgZnVsZmlsbG1lbnRIYW5kbGVyLCByZWplY3Rpb25IYW5kbGVyKSB7CiAgcmV0dXJuIFBlcmZvcm1Qcm9taXNlVGhlbihwcm9taXNlLCBmdWxmaWxsbWVudEhhbmRsZXIsIHJlamVjdGlvbkhhbmRsZXIpOwogfQogZnVuY3Rpb24gc2V0UHJvbWlzZUlzSGFuZGxlZFRvVHJ1ZShwcm9taXNlKSB7CiAgUGVyZm9ybVByb21pc2VUaGVuKHByb21pc2UsIHVuZGVmaW5lZCwgcmV0aHJvd0Fzc2VydGlvbkVycm9yUmVqZWN0aW9uKTsKIH0KIHZhciBRVUVVRV9NQVhfQVJSQVlfU0laRSA9IDE2Mzg0OwogdmFyIFNpbXBsZVF1ZXVlID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFNpbXBsZVF1ZXVlKCkgewogICB0aGlzLl9jdXJzb3IgPSAwOwogICB0aGlzLl9zaXplID0gMDsKICAgdGhpcy5fZnJvbnQgPSB7CiAgICBfZWxlbWVudHM6IFtdLAogICAgX25leHQ6IHVuZGVmaW5lZAogICB9OwogICB0aGlzLl9iYWNrID0gdGhpcy5fZnJvbnQ7CiAgIHRoaXMuX2N1cnNvciA9IDA7CiAgIHRoaXMuX3NpemUgPSAwOwogIH0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2ltcGxlUXVldWUucHJvdG90eXBlLCAibGVuZ3RoIiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLl9zaXplOwogICB9LAogICBlbnVtZXJhYmxlOiB0cnVlLAogICBjb25maWd1cmFibGU6IHRydWUKICB9KTsKICBTaW1wbGVRdWV1ZS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgIHZhciBvbGRCYWNrID0gdGhpcy5fYmFjazsKICAgdmFyIG5ld0JhY2sgPSBvbGRCYWNrOwogICBpZiAob2xkQmFjay5fZWxlbWVudHMubGVuZ3RoID09PSBRVUVVRV9NQVhfQVJSQVlfU0laRSAtIDEpIHsKICAgIG5ld0JhY2sgPSB7CiAgICAgX2VsZW1lbnRzOiBbXSwKICAgICBfbmV4dDogdW5kZWZpbmVkCiAgICB9OwogICB9CiAgIG9sZEJhY2suX2VsZW1lbnRzLnB1c2goZWxlbWVudCk7CiAgIGlmIChuZXdCYWNrICE9PSBvbGRCYWNrKSB7CiAgICB0aGlzLl9iYWNrID0gbmV3QmFjazsKICAgIG9sZEJhY2suX25leHQgPSBuZXdCYWNrOwogICB9CiAgICsrdGhpcy5fc2l6ZTsKICB9OwogIFNpbXBsZVF1ZXVlLnByb3RvdHlwZS5zaGlmdCA9IGZ1bmN0aW9uICgpIHsKICAgdmFyIG9sZEZyb250ID0gdGhpcy5fZnJvbnQ7CiAgIHZhciBuZXdGcm9udCA9IG9sZEZyb250OwogICB2YXIgb2xkQ3Vyc29yID0gdGhpcy5fY3Vyc29yOwogICB2YXIgbmV3Q3Vyc29yID0gb2xkQ3Vyc29yICsgMTsKICAgdmFyIGVsZW1lbnRzID0gb2xkRnJvbnQuX2VsZW1lbnRzOwogICB2YXIgZWxlbWVudCA9IGVsZW1lbnRzW29sZEN1cnNvcl07CiAgIGlmIChuZXdDdXJzb3IgPT09IFFVRVVFX01BWF9BUlJBWV9TSVpFKSB7CiAgICBuZXdGcm9udCA9IG9sZEZyb250Ll9uZXh0OwogICAgbmV3Q3Vyc29yID0gMDsKICAgfQogICAtLXRoaXMuX3NpemU7CiAgIHRoaXMuX2N1cnNvciA9IG5ld0N1cnNvcjsKICAgaWYgKG9sZEZyb250ICE9PSBuZXdGcm9udCkgewogICAgdGhpcy5fZnJvbnQgPSBuZXdGcm9udDsKICAgfQogICBlbGVtZW50c1tvbGRDdXJzb3JdID0gdW5kZWZpbmVkOwogICByZXR1cm4gZWxlbWVudDsKICB9OwogIFNpbXBsZVF1ZXVlLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgIHZhciBpID0gdGhpcy5fY3Vyc29yOwogICB2YXIgbm9kZSA9IHRoaXMuX2Zyb250OwogICB2YXIgZWxlbWVudHMgPSBub2RlLl9lbGVtZW50czsKICAgd2hpbGUgKGkgIT09IGVsZW1lbnRzLmxlbmd0aCB8fCBub2RlLl9uZXh0ICE9PSB1bmRlZmluZWQpIHsKICAgIGlmIChpID09PSBlbGVtZW50cy5sZW5ndGgpIHsKICAgICBub2RlID0gbm9kZS5fbmV4dDsKICAgICBlbGVtZW50cyA9IG5vZGUuX2VsZW1lbnRzOwogICAgIGkgPSAwOwogICAgIGlmIChlbGVtZW50cy5sZW5ndGggPT09IDApIHsKICAgICAgYnJlYWs7CiAgICAgfQogICAgfQogICAgY2FsbGJhY2soZWxlbWVudHNbaV0pOwogICAgKytpOwogICB9CiAgfTsKICBTaW1wbGVRdWV1ZS5wcm90b3R5cGUucGVlayA9IGZ1bmN0aW9uICgpIHsKICAgdmFyIGZyb250ID0gdGhpcy5fZnJvbnQ7CiAgIHZhciBjdXJzb3IgPSB0aGlzLl9jdXJzb3I7CiAgIHJldHVybiBmcm9udC5fZWxlbWVudHNbY3Vyc29yXTsKICB9OwogIHJldHVybiBTaW1wbGVRdWV1ZTsKIH0oKTsKIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtQ3JlYXRlUmVhZFJlc3VsdCh2YWx1ZSwgZG9uZSwgZm9yQXV0aG9yQ29kZSkgewogIHZhciBwcm90b3R5cGUgPSBudWxsOwogIGlmIChmb3JBdXRob3JDb2RlID09PSB0cnVlKSB7CiAgIHByb3RvdHlwZSA9IE9iamVjdC5wcm90b3R5cGU7CiAgfQogIHZhciBvYmogPSBPYmplY3QuY3JlYXRlKHByb3RvdHlwZSk7CiAgb2JqLnZhbHVlID0gdmFsdWU7CiAgb2JqLmRvbmUgPSBkb25lOwogIHJldHVybiBvYmo7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbVJlYWRlckdlbmVyaWNJbml0aWFsaXplKHJlYWRlciwgc3RyZWFtKSB7CiAgcmVhZGVyLl9mb3JBdXRob3JDb2RlID0gdHJ1ZTsKICByZWFkZXIuX293bmVyUmVhZGFibGVTdHJlYW0gPSBzdHJlYW07CiAgc3RyZWFtLl9yZWFkZXIgPSByZWFkZXI7CiAgaWYgKHN0cmVhbS5fc3RhdGUgPT09ICdyZWFkYWJsZScpIHsKICAgZGVmYXVsdFJlYWRlckNsb3NlZFByb21pc2VJbml0aWFsaXplKHJlYWRlcik7CiAgfSBlbHNlIGlmIChzdHJlYW0uX3N0YXRlID09PSAnY2xvc2VkJykgewogICBkZWZhdWx0UmVhZGVyQ2xvc2VkUHJvbWlzZUluaXRpYWxpemVBc1Jlc29sdmVkKHJlYWRlcik7CiAgfSBlbHNlIHsKICAgZGVmYXVsdFJlYWRlckNsb3NlZFByb21pc2VJbml0aWFsaXplQXNSZWplY3RlZChyZWFkZXIsIHN0cmVhbS5fc3RvcmVkRXJyb3IpOwogIH0KIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtUmVhZGVyR2VuZXJpY0NhbmNlbChyZWFkZXIsIHJlYXNvbikgewogIHZhciBzdHJlYW0gPSByZWFkZXIuX293bmVyUmVhZGFibGVTdHJlYW07CiAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtQ2FuY2VsKHN0cmVhbSwgcmVhc29uKTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtUmVhZGVyR2VuZXJpY1JlbGVhc2UocmVhZGVyKSB7CiAgaWYgKHJlYWRlci5fb3duZXJSZWFkYWJsZVN0cmVhbS5fc3RhdGUgPT09ICdyZWFkYWJsZScpIHsKICAgZGVmYXVsdFJlYWRlckNsb3NlZFByb21pc2VSZWplY3QocmVhZGVyLCBuZXcgVHlwZUVycm9yKCdSZWFkZXIgd2FzIHJlbGVhc2VkIGFuZCBjYW4gbm8gbG9uZ2VyIGJlIHVzZWQgdG8gbW9uaXRvciB0aGUgc3RyZWFtXCdzIGNsb3NlZG5lc3MnKSk7CiAgfSBlbHNlIHsKICAgZGVmYXVsdFJlYWRlckNsb3NlZFByb21pc2VSZXNldFRvUmVqZWN0ZWQocmVhZGVyLCBuZXcgVHlwZUVycm9yKCdSZWFkZXIgd2FzIHJlbGVhc2VkIGFuZCBjYW4gbm8gbG9uZ2VyIGJlIHVzZWQgdG8gbW9uaXRvciB0aGUgc3RyZWFtXCdzIGNsb3NlZG5lc3MnKSk7CiAgfQogIHJlYWRlci5fb3duZXJSZWFkYWJsZVN0cmVhbS5fcmVhZGVyID0gdW5kZWZpbmVkOwogIHJlYWRlci5fb3duZXJSZWFkYWJsZVN0cmVhbSA9IHVuZGVmaW5lZDsKIH0KIGZ1bmN0aW9uIHJlYWRlckxvY2tFeGNlcHRpb24obmFtZSkgewogIHJldHVybiBuZXcgVHlwZUVycm9yKCdDYW5ub3QgJyArIG5hbWUgKyAnIGEgc3RyZWFtIHVzaW5nIGEgcmVsZWFzZWQgcmVhZGVyJyk7CiB9CiBmdW5jdGlvbiBkZWZhdWx0UmVhZGVyQ2xvc2VkUHJvbWlzZUluaXRpYWxpemUocmVhZGVyKSB7CiAgcmVhZGVyLl9jbG9zZWRQcm9taXNlID0gbmV3UHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgIHJlYWRlci5fY2xvc2VkUHJvbWlzZV9yZXNvbHZlID0gcmVzb2x2ZTsKICAgcmVhZGVyLl9jbG9zZWRQcm9taXNlX3JlamVjdCA9IHJlamVjdDsKICB9KTsKIH0KIGZ1bmN0aW9uIGRlZmF1bHRSZWFkZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZUFzUmVqZWN0ZWQocmVhZGVyLCByZWFzb24pIHsKICBkZWZhdWx0UmVhZGVyQ2xvc2VkUHJvbWlzZUluaXRpYWxpemUocmVhZGVyKTsKICBkZWZhdWx0UmVhZGVyQ2xvc2VkUHJvbWlzZVJlamVjdChyZWFkZXIsIHJlYXNvbik7CiB9CiBmdW5jdGlvbiBkZWZhdWx0UmVhZGVyQ2xvc2VkUHJvbWlzZUluaXRpYWxpemVBc1Jlc29sdmVkKHJlYWRlcikgewogIGRlZmF1bHRSZWFkZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZShyZWFkZXIpOwogIGRlZmF1bHRSZWFkZXJDbG9zZWRQcm9taXNlUmVzb2x2ZShyZWFkZXIpOwogfQogZnVuY3Rpb24gZGVmYXVsdFJlYWRlckNsb3NlZFByb21pc2VSZWplY3QocmVhZGVyLCByZWFzb24pIHsKICBzZXRQcm9taXNlSXNIYW5kbGVkVG9UcnVlKHJlYWRlci5fY2xvc2VkUHJvbWlzZSk7CiAgcmVhZGVyLl9jbG9zZWRQcm9taXNlX3JlamVjdChyZWFzb24pOwogIHJlYWRlci5fY2xvc2VkUHJvbWlzZV9yZXNvbHZlID0gdW5kZWZpbmVkOwogIHJlYWRlci5fY2xvc2VkUHJvbWlzZV9yZWplY3QgPSB1bmRlZmluZWQ7CiB9CiBmdW5jdGlvbiBkZWZhdWx0UmVhZGVyQ2xvc2VkUHJvbWlzZVJlc2V0VG9SZWplY3RlZChyZWFkZXIsIHJlYXNvbikgewogIGRlZmF1bHRSZWFkZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZUFzUmVqZWN0ZWQocmVhZGVyLCByZWFzb24pOwogfQogZnVuY3Rpb24gZGVmYXVsdFJlYWRlckNsb3NlZFByb21pc2VSZXNvbHZlKHJlYWRlcikgewogIHJlYWRlci5fY2xvc2VkUHJvbWlzZV9yZXNvbHZlKHVuZGVmaW5lZCk7CiAgcmVhZGVyLl9jbG9zZWRQcm9taXNlX3Jlc29sdmUgPSB1bmRlZmluZWQ7CiAgcmVhZGVyLl9jbG9zZWRQcm9taXNlX3JlamVjdCA9IHVuZGVmaW5lZDsKIH0KIHZhciBDYW5jZWxTdGVwcyA9IFN5bWJvbFBvbHlmaWxsKCdbW0NhbmNlbFN0ZXBzXV0nKTsKIHZhciBQdWxsU3RlcHMgPSBTeW1ib2xQb2x5ZmlsbCgnW1tQdWxsU3RlcHNdXScpOwogZnVuY3Rpb24gQWNxdWlyZVJlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlcihzdHJlYW0sIGZvckF1dGhvckNvZGUpIHsKICBpZiAoZm9yQXV0aG9yQ29kZSA9PT0gdm9pZCAwKSB7CiAgIGZvckF1dGhvckNvZGUgPSBmYWxzZTsKICB9CiAgdmFyIHJlYWRlciA9IG5ldyBSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXIoc3RyZWFtKTsKICByZWFkZXIuX2ZvckF1dGhvckNvZGUgPSBmb3JBdXRob3JDb2RlOwogIHJldHVybiByZWFkZXI7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbUFkZFJlYWRSZXF1ZXN0KHN0cmVhbSkgewogIHZhciBwcm9taXNlID0gbmV3UHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgIHZhciByZWFkUmVxdWVzdCA9IHsKICAgIF9yZXNvbHZlOiByZXNvbHZlLAogICAgX3JlamVjdDogcmVqZWN0CiAgIH07CiAgIHN0cmVhbS5fcmVhZGVyLl9yZWFkUmVxdWVzdHMucHVzaChyZWFkUmVxdWVzdCk7CiAgfSk7CiAgcmV0dXJuIHByb21pc2U7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbUZ1bGZpbGxSZWFkUmVxdWVzdChzdHJlYW0sIGNodW5rLCBkb25lKSB7CiAgdmFyIHJlYWRlciA9IHN0cmVhbS5fcmVhZGVyOwogIHZhciByZWFkUmVxdWVzdCA9IHJlYWRlci5fcmVhZFJlcXVlc3RzLnNoaWZ0KCk7CiAgcmVhZFJlcXVlc3QuX3Jlc29sdmUoUmVhZGFibGVTdHJlYW1DcmVhdGVSZWFkUmVzdWx0KGNodW5rLCBkb25lLCByZWFkZXIuX2ZvckF1dGhvckNvZGUpKTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtR2V0TnVtUmVhZFJlcXVlc3RzKHN0cmVhbSkgewogIHJldHVybiBzdHJlYW0uX3JlYWRlci5fcmVhZFJlcXVlc3RzLmxlbmd0aDsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtSGFzRGVmYXVsdFJlYWRlcihzdHJlYW0pIHsKICB2YXIgcmVhZGVyID0gc3RyZWFtLl9yZWFkZXI7CiAgaWYgKHJlYWRlciA9PT0gdW5kZWZpbmVkKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYgKCFJc1JlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlcihyZWFkZXIpKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgcmV0dXJuIHRydWU7CiB9CiB2YXIgUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlcihzdHJlYW0pIHsKICAgaWYgKElzUmVhZGFibGVTdHJlYW0oc3RyZWFtKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1JlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlciBjYW4gb25seSBiZSBjb25zdHJ1Y3RlZCB3aXRoIGEgUmVhZGFibGVTdHJlYW0gaW5zdGFuY2UnKTsKICAgfQogICBpZiAoSXNSZWFkYWJsZVN0cmVhbUxvY2tlZChzdHJlYW0pID09PSB0cnVlKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGlzIHN0cmVhbSBoYXMgYWxyZWFkeSBiZWVuIGxvY2tlZCBmb3IgZXhjbHVzaXZlIHJlYWRpbmcgYnkgYW5vdGhlciByZWFkZXInKTsKICAgfQogICBSZWFkYWJsZVN0cmVhbVJlYWRlckdlbmVyaWNJbml0aWFsaXplKHRoaXMsIHN0cmVhbSk7CiAgIHRoaXMuX3JlYWRSZXF1ZXN0cyA9IG5ldyBTaW1wbGVRdWV1ZSgpOwogIH0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyLnByb3RvdHlwZSwgImNsb3NlZCIsIHsKICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoIUlzUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyKHRoaXMpKSB7CiAgICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgoZGVmYXVsdFJlYWRlckJyYW5kQ2hlY2tFeGNlcHRpb24oJ2Nsb3NlZCcpKTsKICAgIH0KICAgIHJldHVybiB0aGlzLl9jbG9zZWRQcm9taXNlOwogICB9LAogICBlbnVtZXJhYmxlOiB0cnVlLAogICBjb25maWd1cmFibGU6IHRydWUKICB9KTsKICBSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXIucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uIChyZWFzb24pIHsKICAgaWYgKCFJc1JlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlcih0aGlzKSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgoZGVmYXVsdFJlYWRlckJyYW5kQ2hlY2tFeGNlcHRpb24oJ2NhbmNlbCcpKTsKICAgfQogICBpZiAodGhpcy5fb3duZXJSZWFkYWJsZVN0cmVhbSA9PT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChyZWFkZXJMb2NrRXhjZXB0aW9uKCdjYW5jZWwnKSk7CiAgIH0KICAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtUmVhZGVyR2VuZXJpY0NhbmNlbCh0aGlzLCByZWFzb24pOwogIH07CiAgUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKCkgewogICBpZiAoIUlzUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyKHRoaXMpKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChkZWZhdWx0UmVhZGVyQnJhbmRDaGVja0V4Y2VwdGlvbigncmVhZCcpKTsKICAgfQogICBpZiAodGhpcy5fb3duZXJSZWFkYWJsZVN0cmVhbSA9PT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChyZWFkZXJMb2NrRXhjZXB0aW9uKCdyZWFkIGZyb20nKSk7CiAgIH0KICAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlclJlYWQodGhpcyk7CiAgfTsKICBSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXIucHJvdG90eXBlLnJlbGVhc2VMb2NrID0gZnVuY3Rpb24gKCkgewogICBpZiAoIUlzUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyKHRoaXMpKSB7CiAgICB0aHJvdyBkZWZhdWx0UmVhZGVyQnJhbmRDaGVja0V4Y2VwdGlvbigncmVsZWFzZUxvY2snKTsKICAgfQogICBpZiAodGhpcy5fb3duZXJSZWFkYWJsZVN0cmVhbSA9PT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm47CiAgIH0KICAgaWYgKHRoaXMuX3JlYWRSZXF1ZXN0cy5sZW5ndGggPiAwKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUcmllZCB0byByZWxlYXNlIGEgcmVhZGVyIGxvY2sgd2hlbiB0aGF0IHJlYWRlciBoYXMgcGVuZGluZyByZWFkKCkgY2FsbHMgdW4tc2V0dGxlZCcpOwogICB9CiAgIFJlYWRhYmxlU3RyZWFtUmVhZGVyR2VuZXJpY1JlbGVhc2UodGhpcyk7CiAgfTsKICByZXR1cm4gUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyOwogfSgpOwogZnVuY3Rpb24gSXNSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXIoeCkgewogIGlmICghdHlwZUlzT2JqZWN0KHgpKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoeCwgJ19yZWFkUmVxdWVzdHMnKSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwogfQogZnVuY3Rpb24gUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyUmVhZChyZWFkZXIpIHsKICB2YXIgc3RyZWFtID0gcmVhZGVyLl9vd25lclJlYWRhYmxlU3RyZWFtOwogIHN0cmVhbS5fZGlzdHVyYmVkID0gdHJ1ZTsKICBpZiAoc3RyZWFtLl9zdGF0ZSA9PT0gJ2Nsb3NlZCcpIHsKICAgcmV0dXJuIHByb21pc2VSZXNvbHZlZFdpdGgoUmVhZGFibGVTdHJlYW1DcmVhdGVSZWFkUmVzdWx0KHVuZGVmaW5lZCwgdHJ1ZSwgcmVhZGVyLl9mb3JBdXRob3JDb2RlKSk7CiAgfQogIGlmIChzdHJlYW0uX3N0YXRlID09PSAnZXJyb3JlZCcpIHsKICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgoc3RyZWFtLl9zdG9yZWRFcnJvcik7CiAgfQogIHJldHVybiBzdHJlYW0uX3JlYWRhYmxlU3RyZWFtQ29udHJvbGxlcltQdWxsU3RlcHNdKCk7CiB9CiBmdW5jdGlvbiBkZWZhdWx0UmVhZGVyQnJhbmRDaGVja0V4Y2VwdGlvbihuYW1lKSB7CiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoIlJlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlci5wcm90b3R5cGUuIiArIG5hbWUgKyAiIGNhbiBvbmx5IGJlIHVzZWQgb24gYSBSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXIiKTsKIH0KIHZhciBfYTsKIHZhciBBc3luY0l0ZXJhdG9yUHJvdG90eXBlOwogaWYgKHR5cGVvZiBTeW1ib2xQb2x5ZmlsbC5hc3luY0l0ZXJhdG9yID09PSAnc3ltYm9sJykgewogIEFzeW5jSXRlcmF0b3JQcm90b3R5cGUgPSAoX2EgPSB7fSwgX2FbU3ltYm9sUG9seWZpbGwuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7CiAgIHJldHVybiB0aGlzOwogIH0sIF9hKTsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXN5bmNJdGVyYXRvclByb3RvdHlwZSwgU3ltYm9sUG9seWZpbGwuYXN5bmNJdGVyYXRvciwgeyBlbnVtZXJhYmxlOiBmYWxzZSB9KTsKIH0KIHZhciBSZWFkYWJsZVN0cmVhbUFzeW5jSXRlcmF0b3JQcm90b3R5cGUgPSB7CiAgbmV4dDogZnVuY3Rpb24gKCkgewogICBpZiAoSXNSZWFkYWJsZVN0cmVhbUFzeW5jSXRlcmF0b3IodGhpcykgPT09IGZhbHNlKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChzdHJlYW1Bc3luY0l0ZXJhdG9yQnJhbmRDaGVja0V4Y2VwdGlvbignbmV4dCcpKTsKICAgfQogICB2YXIgcmVhZGVyID0gdGhpcy5fYXN5bmNJdGVyYXRvclJlYWRlcjsKICAgaWYgKHJlYWRlci5fb3duZXJSZWFkYWJsZVN0cmVhbSA9PT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChyZWFkZXJMb2NrRXhjZXB0aW9uKCdpdGVyYXRlJykpOwogICB9CiAgIHJldHVybiB0cmFuc2Zvcm1Qcm9taXNlV2l0aChSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXJSZWFkKHJlYWRlciksIGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgIHZhciBkb25lID0gcmVzdWx0LmRvbmU7CiAgICBpZiAoZG9uZSkgewogICAgIFJlYWRhYmxlU3RyZWFtUmVhZGVyR2VuZXJpY1JlbGVhc2UocmVhZGVyKTsKICAgIH0KICAgIHZhciB2YWx1ZSA9IHJlc3VsdC52YWx1ZTsKICAgIHJldHVybiBSZWFkYWJsZVN0cmVhbUNyZWF0ZVJlYWRSZXN1bHQodmFsdWUsIGRvbmUsIHRydWUpOwogICB9KTsKICB9LAogIHJldHVybjogZnVuY3Rpb24gKHZhbHVlKSB7CiAgIGlmIChJc1JlYWRhYmxlU3RyZWFtQXN5bmNJdGVyYXRvcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKHN0cmVhbUFzeW5jSXRlcmF0b3JCcmFuZENoZWNrRXhjZXB0aW9uKCduZXh0JykpOwogICB9CiAgIHZhciByZWFkZXIgPSB0aGlzLl9hc3luY0l0ZXJhdG9yUmVhZGVyOwogICBpZiAocmVhZGVyLl9vd25lclJlYWRhYmxlU3RyZWFtID09PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKHJlYWRlckxvY2tFeGNlcHRpb24oJ2ZpbmlzaCBpdGVyYXRpbmcnKSk7CiAgIH0KICAgaWYgKHJlYWRlci5fcmVhZFJlcXVlc3RzLmxlbmd0aCA+IDApIHsKICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKG5ldyBUeXBlRXJyb3IoJ1RyaWVkIHRvIHJlbGVhc2UgYSByZWFkZXIgbG9jayB3aGVuIHRoYXQgcmVhZGVyIGhhcyBwZW5kaW5nIHJlYWQoKSBjYWxscyB1bi1zZXR0bGVkJykpOwogICB9CiAgIGlmICh0aGlzLl9wcmV2ZW50Q2FuY2VsID09PSBmYWxzZSkgewogICAgdmFyIHJlc3VsdCA9IFJlYWRhYmxlU3RyZWFtUmVhZGVyR2VuZXJpY0NhbmNlbChyZWFkZXIsIHZhbHVlKTsKICAgIFJlYWRhYmxlU3RyZWFtUmVhZGVyR2VuZXJpY1JlbGVhc2UocmVhZGVyKTsKICAgIHJldHVybiB0cmFuc2Zvcm1Qcm9taXNlV2l0aChyZXN1bHQsIGZ1bmN0aW9uICgpIHsKICAgICByZXR1cm4gUmVhZGFibGVTdHJlYW1DcmVhdGVSZWFkUmVzdWx0KHZhbHVlLCB0cnVlLCB0cnVlKTsKICAgIH0pOwogICB9CiAgIFJlYWRhYmxlU3RyZWFtUmVhZGVyR2VuZXJpY1JlbGVhc2UocmVhZGVyKTsKICAgcmV0dXJuIHByb21pc2VSZXNvbHZlZFdpdGgoUmVhZGFibGVTdHJlYW1DcmVhdGVSZWFkUmVzdWx0KHZhbHVlLCB0cnVlLCB0cnVlKSk7CiAgfQogfTsKIGlmIChBc3luY0l0ZXJhdG9yUHJvdG90eXBlICE9PSB1bmRlZmluZWQpIHsKICBPYmplY3Quc2V0UHJvdG90eXBlT2YoUmVhZGFibGVTdHJlYW1Bc3luY0l0ZXJhdG9yUHJvdG90eXBlLCBBc3luY0l0ZXJhdG9yUHJvdG90eXBlKTsKIH0KIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWFkYWJsZVN0cmVhbUFzeW5jSXRlcmF0b3JQcm90b3R5cGUsICduZXh0JywgeyBlbnVtZXJhYmxlOiBmYWxzZSB9KTsKIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWFkYWJsZVN0cmVhbUFzeW5jSXRlcmF0b3JQcm90b3R5cGUsICdyZXR1cm4nLCB7IGVudW1lcmFibGU6IGZhbHNlIH0pOwogZnVuY3Rpb24gQWNxdWlyZVJlYWRhYmxlU3RyZWFtQXN5bmNJdGVyYXRvcihzdHJlYW0sIHByZXZlbnRDYW5jZWwpIHsKICBpZiAocHJldmVudENhbmNlbCA9PT0gdm9pZCAwKSB7CiAgIHByZXZlbnRDYW5jZWwgPSBmYWxzZTsKICB9CiAgdmFyIHJlYWRlciA9IEFjcXVpcmVSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXIoc3RyZWFtKTsKICB2YXIgaXRlcmF0b3IgPSBPYmplY3QuY3JlYXRlKFJlYWRhYmxlU3RyZWFtQXN5bmNJdGVyYXRvclByb3RvdHlwZSk7CiAgaXRlcmF0b3IuX2FzeW5jSXRlcmF0b3JSZWFkZXIgPSByZWFkZXI7CiAgaXRlcmF0b3IuX3ByZXZlbnRDYW5jZWwgPSBCb29sZWFuKHByZXZlbnRDYW5jZWwpOwogIHJldHVybiBpdGVyYXRvcjsKIH0KIGZ1bmN0aW9uIElzUmVhZGFibGVTdHJlYW1Bc3luY0l0ZXJhdG9yKHgpIHsKICBpZiAoIXR5cGVJc09iamVjdCh4KSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdfYXN5bmNJdGVyYXRvclJlYWRlcicpKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgcmV0dXJuIHRydWU7CiB9CiBmdW5jdGlvbiBzdHJlYW1Bc3luY0l0ZXJhdG9yQnJhbmRDaGVja0V4Y2VwdGlvbihuYW1lKSB7CiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoIlJlYWRhYmxlU3RyZWFtQXN5bmNJdGVyYXRvci4iICsgbmFtZSArICIgY2FuIG9ubHkgYmUgdXNlZCBvbiBhIFJlYWRhYmxlU3RlYW1Bc3luY0l0ZXJhdG9yIik7CiB9CiBmdW5jdGlvbiBEZXF1ZXVlVmFsdWUoY29udGFpbmVyKSB7CiAgdmFyIHBhaXIgPSBjb250YWluZXIuX3F1ZXVlLnNoaWZ0KCk7CiAgY29udGFpbmVyLl9xdWV1ZVRvdGFsU2l6ZSAtPSBwYWlyLnNpemU7CiAgaWYgKGNvbnRhaW5lci5fcXVldWVUb3RhbFNpemUgPCAwKSB7CiAgIGNvbnRhaW5lci5fcXVldWVUb3RhbFNpemUgPSAwOwogIH0KICByZXR1cm4gcGFpci52YWx1ZTsKIH0KIGZ1bmN0aW9uIEVucXVldWVWYWx1ZVdpdGhTaXplKGNvbnRhaW5lciwgdmFsdWUsIHNpemUpIHsKICBzaXplID0gTnVtYmVyKHNpemUpOwogIGlmICghSXNGaW5pdGVOb25OZWdhdGl2ZU51bWJlcihzaXplKSkgewogICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignU2l6ZSBtdXN0IGJlIGEgZmluaXRlLCBub24tTmFOLCBub24tbmVnYXRpdmUgbnVtYmVyLicpOwogIH0KICBjb250YWluZXIuX3F1ZXVlLnB1c2goewogICB2YWx1ZTogdmFsdWUsCiAgIHNpemU6IHNpemUKICB9KTsKICBjb250YWluZXIuX3F1ZXVlVG90YWxTaXplICs9IHNpemU7CiB9CiBmdW5jdGlvbiBQZWVrUXVldWVWYWx1ZShjb250YWluZXIpIHsKICB2YXIgcGFpciA9IGNvbnRhaW5lci5fcXVldWUucGVlaygpOwogIHJldHVybiBwYWlyLnZhbHVlOwogfQogZnVuY3Rpb24gUmVzZXRRdWV1ZShjb250YWluZXIpIHsKICBjb250YWluZXIuX3F1ZXVlID0gbmV3IFNpbXBsZVF1ZXVlKCk7CiAgY29udGFpbmVyLl9xdWV1ZVRvdGFsU2l6ZSA9IDA7CiB9CiB2YXIgQWJvcnRTdGVwcyA9IFN5bWJvbFBvbHlmaWxsKCdbW0Fib3J0U3RlcHNdXScpOwogdmFyIEVycm9yU3RlcHMgPSBTeW1ib2xQb2x5ZmlsbCgnW1tFcnJvclN0ZXBzXV0nKTsKIHZhciBXcml0YWJsZVN0cmVhbSA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbSh1bmRlcmx5aW5nU2luaywgc3RyYXRlZ3kpIHsKICAgaWYgKHVuZGVybHlpbmdTaW5rID09PSB2b2lkIDApIHsKICAgIHVuZGVybHlpbmdTaW5rID0ge307CiAgIH0KICAgaWYgKHN0cmF0ZWd5ID09PSB2b2lkIDApIHsKICAgIHN0cmF0ZWd5ID0ge307CiAgIH0KICAgSW5pdGlhbGl6ZVdyaXRhYmxlU3RyZWFtKHRoaXMpOwogICB2YXIgc2l6ZSA9IHN0cmF0ZWd5LnNpemU7CiAgIHZhciBoaWdoV2F0ZXJNYXJrID0gc3RyYXRlZ3kuaGlnaFdhdGVyTWFyazsKICAgdmFyIHR5cGUgPSB1bmRlcmx5aW5nU2luay50eXBlOwogICBpZiAodHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW52YWxpZCB0eXBlIGlzIHNwZWNpZmllZCcpOwogICB9CiAgIHZhciBzaXplQWxnb3JpdGhtID0gTWFrZVNpemVBbGdvcml0aG1Gcm9tU2l6ZUZ1bmN0aW9uKHNpemUpOwogICBpZiAoaGlnaFdhdGVyTWFyayA9PT0gdW5kZWZpbmVkKSB7CiAgICBoaWdoV2F0ZXJNYXJrID0gMTsKICAgfQogICBoaWdoV2F0ZXJNYXJrID0gVmFsaWRhdGVBbmROb3JtYWxpemVIaWdoV2F0ZXJNYXJrKGhpZ2hXYXRlck1hcmspOwogICBTZXRVcFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJGcm9tVW5kZXJseWluZ1NpbmsodGhpcywgdW5kZXJseWluZ1NpbmssIGhpZ2hXYXRlck1hcmssIHNpemVBbGdvcml0aG0pOwogIH0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV3JpdGFibGVTdHJlYW0ucHJvdG90eXBlLCAibG9ja2VkIiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmIChJc1dyaXRhYmxlU3RyZWFtKHRoaXMpID09PSBmYWxzZSkgewogICAgIHRocm93IHN0cmVhbUJyYW5kQ2hlY2tFeGNlcHRpb24oJ2xvY2tlZCcpOwogICAgfQogICAgcmV0dXJuIElzV3JpdGFibGVTdHJlYW1Mb2NrZWQodGhpcyk7CiAgIH0sCiAgIGVudW1lcmFibGU6IHRydWUsCiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwogIFdyaXRhYmxlU3RyZWFtLnByb3RvdHlwZS5hYm9ydCA9IGZ1bmN0aW9uIChyZWFzb24pIHsKICAgaWYgKElzV3JpdGFibGVTdHJlYW0odGhpcykgPT09IGZhbHNlKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChzdHJlYW1CcmFuZENoZWNrRXhjZXB0aW9uKCdhYm9ydCcpKTsKICAgfQogICBpZiAoSXNXcml0YWJsZVN0cmVhbUxvY2tlZCh0aGlzKSA9PT0gdHJ1ZSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgobmV3IFR5cGVFcnJvcignQ2Fubm90IGFib3J0IGEgc3RyZWFtIHRoYXQgYWxyZWFkeSBoYXMgYSB3cml0ZXInKSk7CiAgIH0KICAgcmV0dXJuIFdyaXRhYmxlU3RyZWFtQWJvcnQodGhpcywgcmVhc29uKTsKICB9OwogIFdyaXRhYmxlU3RyZWFtLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgaWYgKElzV3JpdGFibGVTdHJlYW0odGhpcykgPT09IGZhbHNlKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChzdHJlYW1CcmFuZENoZWNrRXhjZXB0aW9uKCdjbG9zZScpKTsKICAgfQogICBpZiAoSXNXcml0YWJsZVN0cmVhbUxvY2tlZCh0aGlzKSA9PT0gdHJ1ZSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgobmV3IFR5cGVFcnJvcignQ2Fubm90IGNsb3NlIGEgc3RyZWFtIHRoYXQgYWxyZWFkeSBoYXMgYSB3cml0ZXInKSk7CiAgIH0KICAgaWYgKFdyaXRhYmxlU3RyZWFtQ2xvc2VRdWV1ZWRPckluRmxpZ2h0KHRoaXMpID09PSB0cnVlKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2xvc2UgYW4gYWxyZWFkeS1jbG9zaW5nIHN0cmVhbScpKTsKICAgfQogICByZXR1cm4gV3JpdGFibGVTdHJlYW1DbG9zZSh0aGlzKTsKICB9OwogIFdyaXRhYmxlU3RyZWFtLnByb3RvdHlwZS5nZXRXcml0ZXIgPSBmdW5jdGlvbiAoKSB7CiAgIGlmIChJc1dyaXRhYmxlU3RyZWFtKHRoaXMpID09PSBmYWxzZSkgewogICAgdGhyb3cgc3RyZWFtQnJhbmRDaGVja0V4Y2VwdGlvbignZ2V0V3JpdGVyJyk7CiAgIH0KICAgcmV0dXJuIEFjcXVpcmVXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIodGhpcyk7CiAgfTsKICByZXR1cm4gV3JpdGFibGVTdHJlYW07CiB9KCk7CiBmdW5jdGlvbiBBY3F1aXJlV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyKHN0cmVhbSkgewogIHJldHVybiBuZXcgV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyKHN0cmVhbSk7CiB9CiBmdW5jdGlvbiBDcmVhdGVXcml0YWJsZVN0cmVhbShzdGFydEFsZ29yaXRobSwgd3JpdGVBbGdvcml0aG0sIGNsb3NlQWxnb3JpdGhtLCBhYm9ydEFsZ29yaXRobSwgaGlnaFdhdGVyTWFyaywgc2l6ZUFsZ29yaXRobSkgewogIGlmIChoaWdoV2F0ZXJNYXJrID09PSB2b2lkIDApIHsKICAgaGlnaFdhdGVyTWFyayA9IDE7CiAgfQogIGlmIChzaXplQWxnb3JpdGhtID09PSB2b2lkIDApIHsKICAgc2l6ZUFsZ29yaXRobSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAxOwogICB9OwogIH0KICB2YXIgc3RyZWFtID0gT2JqZWN0LmNyZWF0ZShXcml0YWJsZVN0cmVhbS5wcm90b3R5cGUpOwogIEluaXRpYWxpemVXcml0YWJsZVN0cmVhbShzdHJlYW0pOwogIHZhciBjb250cm9sbGVyID0gT2JqZWN0LmNyZWF0ZShXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZSk7CiAgU2V0VXBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyKHN0cmVhbSwgY29udHJvbGxlciwgc3RhcnRBbGdvcml0aG0sIHdyaXRlQWxnb3JpdGhtLCBjbG9zZUFsZ29yaXRobSwgYWJvcnRBbGdvcml0aG0sIGhpZ2hXYXRlck1hcmssIHNpemVBbGdvcml0aG0pOwogIHJldHVybiBzdHJlYW07CiB9CiBmdW5jdGlvbiBJbml0aWFsaXplV3JpdGFibGVTdHJlYW0oc3RyZWFtKSB7CiAgc3RyZWFtLl9zdGF0ZSA9ICd3cml0YWJsZSc7CiAgc3RyZWFtLl9zdG9yZWRFcnJvciA9IHVuZGVmaW5lZDsKICBzdHJlYW0uX3dyaXRlciA9IHVuZGVmaW5lZDsKICBzdHJlYW0uX3dyaXRhYmxlU3RyZWFtQ29udHJvbGxlciA9IHVuZGVmaW5lZDsKICBzdHJlYW0uX3dyaXRlUmVxdWVzdHMgPSBuZXcgU2ltcGxlUXVldWUoKTsKICBzdHJlYW0uX2luRmxpZ2h0V3JpdGVSZXF1ZXN0ID0gdW5kZWZpbmVkOwogIHN0cmVhbS5fY2xvc2VSZXF1ZXN0ID0gdW5kZWZpbmVkOwogIHN0cmVhbS5faW5GbGlnaHRDbG9zZVJlcXVlc3QgPSB1bmRlZmluZWQ7CiAgc3RyZWFtLl9wZW5kaW5nQWJvcnRSZXF1ZXN0ID0gdW5kZWZpbmVkOwogIHN0cmVhbS5fYmFja3ByZXNzdXJlID0gZmFsc2U7CiB9CiBmdW5jdGlvbiBJc1dyaXRhYmxlU3RyZWFtKHgpIHsKICBpZiAoIXR5cGVJc09iamVjdCh4KSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdfd3JpdGFibGVTdHJlYW1Db250cm9sbGVyJykpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKIH0KIGZ1bmN0aW9uIElzV3JpdGFibGVTdHJlYW1Mb2NrZWQoc3RyZWFtKSB7CiAgaWYgKHN0cmVhbS5fd3JpdGVyID09PSB1bmRlZmluZWQpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtQWJvcnQoc3RyZWFtLCByZWFzb24pIHsKICB2YXIgc3RhdGUgPSBzdHJlYW0uX3N0YXRlOwogIGlmIChzdGF0ZSA9PT0gJ2Nsb3NlZCcgfHwgc3RhdGUgPT09ICdlcnJvcmVkJykgewogICByZXR1cm4gcHJvbWlzZVJlc29sdmVkV2l0aCh1bmRlZmluZWQpOwogIH0KICBpZiAoc3RyZWFtLl9wZW5kaW5nQWJvcnRSZXF1ZXN0ICE9PSB1bmRlZmluZWQpIHsKICAgcmV0dXJuIHN0cmVhbS5fcGVuZGluZ0Fib3J0UmVxdWVzdC5fcHJvbWlzZTsKICB9CiAgdmFyIHdhc0FscmVhZHlFcnJvcmluZyA9IGZhbHNlOwogIGlmIChzdGF0ZSA9PT0gJ2Vycm9yaW5nJykgewogICB3YXNBbHJlYWR5RXJyb3JpbmcgPSB0cnVlOwogICByZWFzb24gPSB1bmRlZmluZWQ7CiAgfQogIHZhciBwcm9taXNlID0gbmV3UHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgIHN0cmVhbS5fcGVuZGluZ0Fib3J0UmVxdWVzdCA9IHsKICAgIF9wcm9taXNlOiB1bmRlZmluZWQsCiAgICBfcmVzb2x2ZTogcmVzb2x2ZSwKICAgIF9yZWplY3Q6IHJlamVjdCwKICAgIF9yZWFzb246IHJlYXNvbiwKICAgIF93YXNBbHJlYWR5RXJyb3Jpbmc6IHdhc0FscmVhZHlFcnJvcmluZwogICB9OwogIH0pOwogIHN0cmVhbS5fcGVuZGluZ0Fib3J0UmVxdWVzdC5fcHJvbWlzZSA9IHByb21pc2U7CiAgaWYgKHdhc0FscmVhZHlFcnJvcmluZyA9PT0gZmFsc2UpIHsKICAgV3JpdGFibGVTdHJlYW1TdGFydEVycm9yaW5nKHN0cmVhbSwgcmVhc29uKTsKICB9CiAgcmV0dXJuIHByb21pc2U7CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbUNsb3NlKHN0cmVhbSkgewogIHZhciBzdGF0ZSA9IHN0cmVhbS5fc3RhdGU7CiAgaWYgKHN0YXRlID09PSAnY2xvc2VkJyB8fCBzdGF0ZSA9PT0gJ2Vycm9yZWQnKSB7CiAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKG5ldyBUeXBlRXJyb3IoIlRoZSBzdHJlYW0gKGluICIgKyBzdGF0ZSArICIgc3RhdGUpIGlzIG5vdCBpbiB0aGUgd3JpdGFibGUgc3RhdGUgYW5kIGNhbm5vdCBiZSBjbG9zZWQiKSk7CiAgfQogIHZhciBwcm9taXNlID0gbmV3UHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgIHZhciBjbG9zZVJlcXVlc3QgPSB7CiAgICBfcmVzb2x2ZTogcmVzb2x2ZSwKICAgIF9yZWplY3Q6IHJlamVjdAogICB9OwogICBzdHJlYW0uX2Nsb3NlUmVxdWVzdCA9IGNsb3NlUmVxdWVzdDsKICB9KTsKICB2YXIgd3JpdGVyID0gc3RyZWFtLl93cml0ZXI7CiAgaWYgKHdyaXRlciAhPT0gdW5kZWZpbmVkICYmIHN0cmVhbS5fYmFja3ByZXNzdXJlID09PSB0cnVlICYmIHN0YXRlID09PSAnd3JpdGFibGUnKSB7CiAgIGRlZmF1bHRXcml0ZXJSZWFkeVByb21pc2VSZXNvbHZlKHdyaXRlcik7CiAgfQogIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbG9zZShzdHJlYW0uX3dyaXRhYmxlU3RyZWFtQ29udHJvbGxlcik7CiAgcmV0dXJuIHByb21pc2U7CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbUFkZFdyaXRlUmVxdWVzdChzdHJlYW0pIHsKICB2YXIgcHJvbWlzZSA9IG5ld1Byb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICB2YXIgd3JpdGVSZXF1ZXN0ID0gewogICAgX3Jlc29sdmU6IHJlc29sdmUsCiAgICBfcmVqZWN0OiByZWplY3QKICAgfTsKICAgc3RyZWFtLl93cml0ZVJlcXVlc3RzLnB1c2god3JpdGVSZXF1ZXN0KTsKICB9KTsKICByZXR1cm4gcHJvbWlzZTsKIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVhbFdpdGhSZWplY3Rpb24oc3RyZWFtLCBlcnJvcikgewogIHZhciBzdGF0ZSA9IHN0cmVhbS5fc3RhdGU7CiAgaWYgKHN0YXRlID09PSAnd3JpdGFibGUnKSB7CiAgIFdyaXRhYmxlU3RyZWFtU3RhcnRFcnJvcmluZyhzdHJlYW0sIGVycm9yKTsKICAgcmV0dXJuOwogIH0KICBXcml0YWJsZVN0cmVhbUZpbmlzaEVycm9yaW5nKHN0cmVhbSk7CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbVN0YXJ0RXJyb3Jpbmcoc3RyZWFtLCByZWFzb24pIHsKICB2YXIgY29udHJvbGxlciA9IHN0cmVhbS5fd3JpdGFibGVTdHJlYW1Db250cm9sbGVyOwogIHN0cmVhbS5fc3RhdGUgPSAnZXJyb3JpbmcnOwogIHN0cmVhbS5fc3RvcmVkRXJyb3IgPSByZWFzb247CiAgdmFyIHdyaXRlciA9IHN0cmVhbS5fd3JpdGVyOwogIGlmICh3cml0ZXIgIT09IHVuZGVmaW5lZCkgewogICBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXJFbnN1cmVSZWFkeVByb21pc2VSZWplY3RlZCh3cml0ZXIsIHJlYXNvbik7CiAgfQogIGlmIChXcml0YWJsZVN0cmVhbUhhc09wZXJhdGlvbk1hcmtlZEluRmxpZ2h0KHN0cmVhbSkgPT09IGZhbHNlICYmIGNvbnRyb2xsZXIuX3N0YXJ0ZWQgPT09IHRydWUpIHsKICAgV3JpdGFibGVTdHJlYW1GaW5pc2hFcnJvcmluZyhzdHJlYW0pOwogIH0KIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRmluaXNoRXJyb3Jpbmcoc3RyZWFtKSB7CiAgc3RyZWFtLl9zdGF0ZSA9ICdlcnJvcmVkJzsKICBzdHJlYW0uX3dyaXRhYmxlU3RyZWFtQ29udHJvbGxlcltFcnJvclN0ZXBzXSgpOwogIHZhciBzdG9yZWRFcnJvciA9IHN0cmVhbS5fc3RvcmVkRXJyb3I7CiAgc3RyZWFtLl93cml0ZVJlcXVlc3RzLmZvckVhY2goZnVuY3Rpb24gKHdyaXRlUmVxdWVzdCkgewogICB3cml0ZVJlcXVlc3QuX3JlamVjdChzdG9yZWRFcnJvcik7CiAgfSk7CiAgc3RyZWFtLl93cml0ZVJlcXVlc3RzID0gbmV3IFNpbXBsZVF1ZXVlKCk7CiAgaWYgKHN0cmVhbS5fcGVuZGluZ0Fib3J0UmVxdWVzdCA9PT0gdW5kZWZpbmVkKSB7CiAgIFdyaXRhYmxlU3RyZWFtUmVqZWN0Q2xvc2VBbmRDbG9zZWRQcm9taXNlSWZOZWVkZWQoc3RyZWFtKTsKICAgcmV0dXJuOwogIH0KICB2YXIgYWJvcnRSZXF1ZXN0ID0gc3RyZWFtLl9wZW5kaW5nQWJvcnRSZXF1ZXN0OwogIHN0cmVhbS5fcGVuZGluZ0Fib3J0UmVxdWVzdCA9IHVuZGVmaW5lZDsKICBpZiAoYWJvcnRSZXF1ZXN0Ll93YXNBbHJlYWR5RXJyb3JpbmcgPT09IHRydWUpIHsKICAgYWJvcnRSZXF1ZXN0Ll9yZWplY3Qoc3RvcmVkRXJyb3IpOwogICBXcml0YWJsZVN0cmVhbVJlamVjdENsb3NlQW5kQ2xvc2VkUHJvbWlzZUlmTmVlZGVkKHN0cmVhbSk7CiAgIHJldHVybjsKICB9CiAgdmFyIHByb21pc2UgPSBzdHJlYW0uX3dyaXRhYmxlU3RyZWFtQ29udHJvbGxlcltBYm9ydFN0ZXBzXShhYm9ydFJlcXVlc3QuX3JlYXNvbik7CiAgdXBvblByb21pc2UocHJvbWlzZSwgZnVuY3Rpb24gKCkgewogICBhYm9ydFJlcXVlc3QuX3Jlc29sdmUoKTsKICAgV3JpdGFibGVTdHJlYW1SZWplY3RDbG9zZUFuZENsb3NlZFByb21pc2VJZk5lZWRlZChzdHJlYW0pOwogIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgYWJvcnRSZXF1ZXN0Ll9yZWplY3QocmVhc29uKTsKICAgV3JpdGFibGVTdHJlYW1SZWplY3RDbG9zZUFuZENsb3NlZFByb21pc2VJZk5lZWRlZChzdHJlYW0pOwogIH0pOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1GaW5pc2hJbkZsaWdodFdyaXRlKHN0cmVhbSkgewogIHN0cmVhbS5faW5GbGlnaHRXcml0ZVJlcXVlc3QuX3Jlc29sdmUodW5kZWZpbmVkKTsKICBzdHJlYW0uX2luRmxpZ2h0V3JpdGVSZXF1ZXN0ID0gdW5kZWZpbmVkOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1GaW5pc2hJbkZsaWdodFdyaXRlV2l0aEVycm9yKHN0cmVhbSwgZXJyb3IpIHsKICBzdHJlYW0uX2luRmxpZ2h0V3JpdGVSZXF1ZXN0Ll9yZWplY3QoZXJyb3IpOwogIHN0cmVhbS5faW5GbGlnaHRXcml0ZVJlcXVlc3QgPSB1bmRlZmluZWQ7CiAgV3JpdGFibGVTdHJlYW1EZWFsV2l0aFJlamVjdGlvbihzdHJlYW0sIGVycm9yKTsKIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRmluaXNoSW5GbGlnaHRDbG9zZShzdHJlYW0pIHsKICBzdHJlYW0uX2luRmxpZ2h0Q2xvc2VSZXF1ZXN0Ll9yZXNvbHZlKHVuZGVmaW5lZCk7CiAgc3RyZWFtLl9pbkZsaWdodENsb3NlUmVxdWVzdCA9IHVuZGVmaW5lZDsKICB2YXIgc3RhdGUgPSBzdHJlYW0uX3N0YXRlOwogIGlmIChzdGF0ZSA9PT0gJ2Vycm9yaW5nJykgewogICBzdHJlYW0uX3N0b3JlZEVycm9yID0gdW5kZWZpbmVkOwogICBpZiAoc3RyZWFtLl9wZW5kaW5nQWJvcnRSZXF1ZXN0ICE9PSB1bmRlZmluZWQpIHsKICAgIHN0cmVhbS5fcGVuZGluZ0Fib3J0UmVxdWVzdC5fcmVzb2x2ZSgpOwogICAgc3RyZWFtLl9wZW5kaW5nQWJvcnRSZXF1ZXN0ID0gdW5kZWZpbmVkOwogICB9CiAgfQogIHN0cmVhbS5fc3RhdGUgPSAnY2xvc2VkJzsKICB2YXIgd3JpdGVyID0gc3RyZWFtLl93cml0ZXI7CiAgaWYgKHdyaXRlciAhPT0gdW5kZWZpbmVkKSB7CiAgIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlUmVzb2x2ZSh3cml0ZXIpOwogIH0KIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRmluaXNoSW5GbGlnaHRDbG9zZVdpdGhFcnJvcihzdHJlYW0sIGVycm9yKSB7CiAgc3RyZWFtLl9pbkZsaWdodENsb3NlUmVxdWVzdC5fcmVqZWN0KGVycm9yKTsKICBzdHJlYW0uX2luRmxpZ2h0Q2xvc2VSZXF1ZXN0ID0gdW5kZWZpbmVkOwogIGlmIChzdHJlYW0uX3BlbmRpbmdBYm9ydFJlcXVlc3QgIT09IHVuZGVmaW5lZCkgewogICBzdHJlYW0uX3BlbmRpbmdBYm9ydFJlcXVlc3QuX3JlamVjdChlcnJvcik7CiAgIHN0cmVhbS5fcGVuZGluZ0Fib3J0UmVxdWVzdCA9IHVuZGVmaW5lZDsKICB9CiAgV3JpdGFibGVTdHJlYW1EZWFsV2l0aFJlamVjdGlvbihzdHJlYW0sIGVycm9yKTsKIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtQ2xvc2VRdWV1ZWRPckluRmxpZ2h0KHN0cmVhbSkgewogIGlmIChzdHJlYW0uX2Nsb3NlUmVxdWVzdCA9PT0gdW5kZWZpbmVkICYmIHN0cmVhbS5faW5GbGlnaHRDbG9zZVJlcXVlc3QgPT09IHVuZGVmaW5lZCkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1IYXNPcGVyYXRpb25NYXJrZWRJbkZsaWdodChzdHJlYW0pIHsKICBpZiAoc3RyZWFtLl9pbkZsaWdodFdyaXRlUmVxdWVzdCA9PT0gdW5kZWZpbmVkICYmIHN0cmVhbS5faW5GbGlnaHRDbG9zZVJlcXVlc3QgPT09IHVuZGVmaW5lZCkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1NYXJrQ2xvc2VSZXF1ZXN0SW5GbGlnaHQoc3RyZWFtKSB7CiAgc3RyZWFtLl9pbkZsaWdodENsb3NlUmVxdWVzdCA9IHN0cmVhbS5fY2xvc2VSZXF1ZXN0OwogIHN0cmVhbS5fY2xvc2VSZXF1ZXN0ID0gdW5kZWZpbmVkOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1NYXJrRmlyc3RXcml0ZVJlcXVlc3RJbkZsaWdodChzdHJlYW0pIHsKICBzdHJlYW0uX2luRmxpZ2h0V3JpdGVSZXF1ZXN0ID0gc3RyZWFtLl93cml0ZVJlcXVlc3RzLnNoaWZ0KCk7CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbVJlamVjdENsb3NlQW5kQ2xvc2VkUHJvbWlzZUlmTmVlZGVkKHN0cmVhbSkgewogIGlmIChzdHJlYW0uX2Nsb3NlUmVxdWVzdCAhPT0gdW5kZWZpbmVkKSB7CiAgIHN0cmVhbS5fY2xvc2VSZXF1ZXN0Ll9yZWplY3Qoc3RyZWFtLl9zdG9yZWRFcnJvcik7CiAgIHN0cmVhbS5fY2xvc2VSZXF1ZXN0ID0gdW5kZWZpbmVkOwogIH0KICB2YXIgd3JpdGVyID0gc3RyZWFtLl93cml0ZXI7CiAgaWYgKHdyaXRlciAhPT0gdW5kZWZpbmVkKSB7CiAgIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlUmVqZWN0KHdyaXRlciwgc3RyZWFtLl9zdG9yZWRFcnJvcik7CiAgfQogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1VcGRhdGVCYWNrcHJlc3N1cmUoc3RyZWFtLCBiYWNrcHJlc3N1cmUpIHsKICB2YXIgd3JpdGVyID0gc3RyZWFtLl93cml0ZXI7CiAgaWYgKHdyaXRlciAhPT0gdW5kZWZpbmVkICYmIGJhY2twcmVzc3VyZSAhPT0gc3RyZWFtLl9iYWNrcHJlc3N1cmUpIHsKICAgaWYgKGJhY2twcmVzc3VyZSA9PT0gdHJ1ZSkgewogICAgZGVmYXVsdFdyaXRlclJlYWR5UHJvbWlzZVJlc2V0KHdyaXRlcik7CiAgIH0gZWxzZSB7CiAgICBkZWZhdWx0V3JpdGVyUmVhZHlQcm9taXNlUmVzb2x2ZSh3cml0ZXIpOwogICB9CiAgfQogIHN0cmVhbS5fYmFja3ByZXNzdXJlID0gYmFja3ByZXNzdXJlOwogfQogdmFyIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlciA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIoc3RyZWFtKSB7CiAgIGlmIChJc1dyaXRhYmxlU3RyZWFtKHN0cmVhbSkgPT09IGZhbHNlKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIgY2FuIG9ubHkgYmUgY29uc3RydWN0ZWQgd2l0aCBhIFdyaXRhYmxlU3RyZWFtIGluc3RhbmNlJyk7CiAgIH0KICAgaWYgKElzV3JpdGFibGVTdHJlYW1Mb2NrZWQoc3RyZWFtKSA9PT0gdHJ1ZSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhpcyBzdHJlYW0gaGFzIGFscmVhZHkgYmVlbiBsb2NrZWQgZm9yIGV4Y2x1c2l2ZSB3cml0aW5nIGJ5IGFub3RoZXIgd3JpdGVyJyk7CiAgIH0KICAgdGhpcy5fb3duZXJXcml0YWJsZVN0cmVhbSA9IHN0cmVhbTsKICAgc3RyZWFtLl93cml0ZXIgPSB0aGlzOwogICB2YXIgc3RhdGUgPSBzdHJlYW0uX3N0YXRlOwogICBpZiAoc3RhdGUgPT09ICd3cml0YWJsZScpIHsKICAgIGlmIChXcml0YWJsZVN0cmVhbUNsb3NlUXVldWVkT3JJbkZsaWdodChzdHJlYW0pID09PSBmYWxzZSAmJiBzdHJlYW0uX2JhY2twcmVzc3VyZSA9PT0gdHJ1ZSkgewogICAgIGRlZmF1bHRXcml0ZXJSZWFkeVByb21pc2VJbml0aWFsaXplKHRoaXMpOwogICAgfSBlbHNlIHsKICAgICBkZWZhdWx0V3JpdGVyUmVhZHlQcm9taXNlSW5pdGlhbGl6ZUFzUmVzb2x2ZWQodGhpcyk7CiAgICB9CiAgICBkZWZhdWx0V3JpdGVyQ2xvc2VkUHJvbWlzZUluaXRpYWxpemUodGhpcyk7CiAgIH0gZWxzZSBpZiAoc3RhdGUgPT09ICdlcnJvcmluZycpIHsKICAgIGRlZmF1bHRXcml0ZXJSZWFkeVByb21pc2VJbml0aWFsaXplQXNSZWplY3RlZCh0aGlzLCBzdHJlYW0uX3N0b3JlZEVycm9yKTsKICAgIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZSh0aGlzKTsKICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ2Nsb3NlZCcpIHsKICAgIGRlZmF1bHRXcml0ZXJSZWFkeVByb21pc2VJbml0aWFsaXplQXNSZXNvbHZlZCh0aGlzKTsKICAgIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZUFzUmVzb2x2ZWQodGhpcyk7CiAgIH0gZWxzZSB7CiAgICB2YXIgc3RvcmVkRXJyb3IgPSBzdHJlYW0uX3N0b3JlZEVycm9yOwogICAgZGVmYXVsdFdyaXRlclJlYWR5UHJvbWlzZUluaXRpYWxpemVBc1JlamVjdGVkKHRoaXMsIHN0b3JlZEVycm9yKTsKICAgIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZUFzUmVqZWN0ZWQodGhpcywgc3RvcmVkRXJyb3IpOwogICB9CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIucHJvdG90eXBlLCAiY2xvc2VkIiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmIChJc1dyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChkZWZhdWx0V3JpdGVyQnJhbmRDaGVja0V4Y2VwdGlvbignY2xvc2VkJykpOwogICAgfQogICAgcmV0dXJuIHRoaXMuX2Nsb3NlZFByb21pc2U7CiAgIH0sCiAgIGVudW1lcmFibGU6IHRydWUsCiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIucHJvdG90eXBlLCAiZGVzaXJlZFNpemUiLCB7CiAgIGdldDogZnVuY3Rpb24gKCkgewogICAgaWYgKElzV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyKHRoaXMpID09PSBmYWxzZSkgewogICAgIHRocm93IGRlZmF1bHRXcml0ZXJCcmFuZENoZWNrRXhjZXB0aW9uKCdkZXNpcmVkU2l6ZScpOwogICAgfQogICAgaWYgKHRoaXMuX293bmVyV3JpdGFibGVTdHJlYW0gPT09IHVuZGVmaW5lZCkgewogICAgIHRocm93IGRlZmF1bHRXcml0ZXJMb2NrRXhjZXB0aW9uKCdkZXNpcmVkU2l6ZScpOwogICAgfQogICAgcmV0dXJuIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlckdldERlc2lyZWRTaXplKHRoaXMpOwogICB9LAogICBlbnVtZXJhYmxlOiB0cnVlLAogICBjb25maWd1cmFibGU6IHRydWUKICB9KTsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyLnByb3RvdHlwZSwgInJlYWR5IiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmIChJc1dyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChkZWZhdWx0V3JpdGVyQnJhbmRDaGVja0V4Y2VwdGlvbigncmVhZHknKSk7CiAgICB9CiAgICByZXR1cm4gdGhpcy5fcmVhZHlQcm9taXNlOwogICB9LAogICBlbnVtZXJhYmxlOiB0cnVlLAogICBjb25maWd1cmFibGU6IHRydWUKICB9KTsKICBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIucHJvdG90eXBlLmFib3J0ID0gZnVuY3Rpb24gKHJlYXNvbikgewogICBpZiAoSXNXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIodGhpcykgPT09IGZhbHNlKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChkZWZhdWx0V3JpdGVyQnJhbmRDaGVja0V4Y2VwdGlvbignYWJvcnQnKSk7CiAgIH0KICAgaWYgKHRoaXMuX293bmVyV3JpdGFibGVTdHJlYW0gPT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgoZGVmYXVsdFdyaXRlckxvY2tFeGNlcHRpb24oJ2Fib3J0JykpOwogICB9CiAgIHJldHVybiBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXJBYm9ydCh0aGlzLCByZWFzb24pOwogIH07CiAgV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgaWYgKElzV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyKHRoaXMpID09PSBmYWxzZSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgoZGVmYXVsdFdyaXRlckJyYW5kQ2hlY2tFeGNlcHRpb24oJ2Nsb3NlJykpOwogICB9CiAgIHZhciBzdHJlYW0gPSB0aGlzLl9vd25lcldyaXRhYmxlU3RyZWFtOwogICBpZiAoc3RyZWFtID09PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKGRlZmF1bHRXcml0ZXJMb2NrRXhjZXB0aW9uKCdjbG9zZScpKTsKICAgfQogICBpZiAoV3JpdGFibGVTdHJlYW1DbG9zZVF1ZXVlZE9ySW5GbGlnaHQoc3RyZWFtKSA9PT0gdHJ1ZSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgobmV3IFR5cGVFcnJvcignQ2Fubm90IGNsb3NlIGFuIGFscmVhZHktY2xvc2luZyBzdHJlYW0nKSk7CiAgIH0KICAgcmV0dXJuIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlckNsb3NlKHRoaXMpOwogIH07CiAgV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyLnByb3RvdHlwZS5yZWxlYXNlTG9jayA9IGZ1bmN0aW9uICgpIHsKICAgaWYgKElzV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyKHRoaXMpID09PSBmYWxzZSkgewogICAgdGhyb3cgZGVmYXVsdFdyaXRlckJyYW5kQ2hlY2tFeGNlcHRpb24oJ3JlbGVhc2VMb2NrJyk7CiAgIH0KICAgdmFyIHN0cmVhbSA9IHRoaXMuX293bmVyV3JpdGFibGVTdHJlYW07CiAgIGlmIChzdHJlYW0gPT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuOwogICB9CiAgIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlclJlbGVhc2UodGhpcyk7CiAgfTsKICBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKGNodW5rKSB7CiAgIGlmIChJc1dyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKGRlZmF1bHRXcml0ZXJCcmFuZENoZWNrRXhjZXB0aW9uKCd3cml0ZScpKTsKICAgfQogICBpZiAodGhpcy5fb3duZXJXcml0YWJsZVN0cmVhbSA9PT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChkZWZhdWx0V3JpdGVyTG9ja0V4Y2VwdGlvbignd3JpdGUgdG8nKSk7CiAgIH0KICAgcmV0dXJuIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlcldyaXRlKHRoaXMsIGNodW5rKTsKICB9OwogIHJldHVybiBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXI7CiB9KCk7CiBmdW5jdGlvbiBJc1dyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlcih4KSB7CiAgaWYgKCF0eXBlSXNPYmplY3QoeCkpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCAnX293bmVyV3JpdGFibGVTdHJlYW0nKSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyQWJvcnQod3JpdGVyLCByZWFzb24pIHsKICB2YXIgc3RyZWFtID0gd3JpdGVyLl9vd25lcldyaXRhYmxlU3RyZWFtOwogIHJldHVybiBXcml0YWJsZVN0cmVhbUFib3J0KHN0cmVhbSwgcmVhc29uKTsKIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlckNsb3NlKHdyaXRlcikgewogIHZhciBzdHJlYW0gPSB3cml0ZXIuX293bmVyV3JpdGFibGVTdHJlYW07CiAgcmV0dXJuIFdyaXRhYmxlU3RyZWFtQ2xvc2Uoc3RyZWFtKTsKIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlckNsb3NlV2l0aEVycm9yUHJvcGFnYXRpb24od3JpdGVyKSB7CiAgdmFyIHN0cmVhbSA9IHdyaXRlci5fb3duZXJXcml0YWJsZVN0cmVhbTsKICB2YXIgc3RhdGUgPSBzdHJlYW0uX3N0YXRlOwogIGlmIChXcml0YWJsZVN0cmVhbUNsb3NlUXVldWVkT3JJbkZsaWdodChzdHJlYW0pID09PSB0cnVlIHx8IHN0YXRlID09PSAnY2xvc2VkJykgewogICByZXR1cm4gcHJvbWlzZVJlc29sdmVkV2l0aCh1bmRlZmluZWQpOwogIH0KICBpZiAoc3RhdGUgPT09ICdlcnJvcmVkJykgewogICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChzdHJlYW0uX3N0b3JlZEVycm9yKTsKICB9CiAgcmV0dXJuIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlckNsb3NlKHdyaXRlcik7CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXJFbnN1cmVDbG9zZWRQcm9taXNlUmVqZWN0ZWQod3JpdGVyLCBlcnJvcikgewogIGlmICh3cml0ZXIuX2Nsb3NlZFByb21pc2VTdGF0ZSA9PT0gJ3BlbmRpbmcnKSB7CiAgIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlUmVqZWN0KHdyaXRlciwgZXJyb3IpOwogIH0gZWxzZSB7CiAgIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlUmVzZXRUb1JlamVjdGVkKHdyaXRlciwgZXJyb3IpOwogIH0KIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlckVuc3VyZVJlYWR5UHJvbWlzZVJlamVjdGVkKHdyaXRlciwgZXJyb3IpIHsKICBpZiAod3JpdGVyLl9yZWFkeVByb21pc2VTdGF0ZSA9PT0gJ3BlbmRpbmcnKSB7CiAgIGRlZmF1bHRXcml0ZXJSZWFkeVByb21pc2VSZWplY3Qod3JpdGVyLCBlcnJvcik7CiAgfSBlbHNlIHsKICAgZGVmYXVsdFdyaXRlclJlYWR5UHJvbWlzZVJlc2V0VG9SZWplY3RlZCh3cml0ZXIsIGVycm9yKTsKICB9CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXJHZXREZXNpcmVkU2l6ZSh3cml0ZXIpIHsKICB2YXIgc3RyZWFtID0gd3JpdGVyLl9vd25lcldyaXRhYmxlU3RyZWFtOwogIHZhciBzdGF0ZSA9IHN0cmVhbS5fc3RhdGU7CiAgaWYgKHN0YXRlID09PSAnZXJyb3JlZCcgfHwgc3RhdGUgPT09ICdlcnJvcmluZycpIHsKICAgcmV0dXJuIG51bGw7CiAgfQogIGlmIChzdGF0ZSA9PT0gJ2Nsb3NlZCcpIHsKICAgcmV0dXJuIDA7CiAgfQogIHJldHVybiBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyR2V0RGVzaXJlZFNpemUoc3RyZWFtLl93cml0YWJsZVN0cmVhbUNvbnRyb2xsZXIpOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyUmVsZWFzZSh3cml0ZXIpIHsKICB2YXIgc3RyZWFtID0gd3JpdGVyLl9vd25lcldyaXRhYmxlU3RyZWFtOwogIHZhciByZWxlYXNlZEVycm9yID0gbmV3IFR5cGVFcnJvcignV3JpdGVyIHdhcyByZWxlYXNlZCBhbmQgY2FuIG5vIGxvbmdlciBiZSB1c2VkIHRvIG1vbml0b3IgdGhlIHN0cmVhbVwncyBjbG9zZWRuZXNzJyk7CiAgV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyRW5zdXJlUmVhZHlQcm9taXNlUmVqZWN0ZWQod3JpdGVyLCByZWxlYXNlZEVycm9yKTsKICBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXJFbnN1cmVDbG9zZWRQcm9taXNlUmVqZWN0ZWQod3JpdGVyLCByZWxlYXNlZEVycm9yKTsKICBzdHJlYW0uX3dyaXRlciA9IHVuZGVmaW5lZDsKICB3cml0ZXIuX293bmVyV3JpdGFibGVTdHJlYW0gPSB1bmRlZmluZWQ7CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXJXcml0ZSh3cml0ZXIsIGNodW5rKSB7CiAgdmFyIHN0cmVhbSA9IHdyaXRlci5fb3duZXJXcml0YWJsZVN0cmVhbTsKICB2YXIgY29udHJvbGxlciA9IHN0cmVhbS5fd3JpdGFibGVTdHJlYW1Db250cm9sbGVyOwogIHZhciBjaHVua1NpemUgPSBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyR2V0Q2h1bmtTaXplKGNvbnRyb2xsZXIsIGNodW5rKTsKICBpZiAoc3RyZWFtICE9PSB3cml0ZXIuX293bmVyV3JpdGFibGVTdHJlYW0pIHsKICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgoZGVmYXVsdFdyaXRlckxvY2tFeGNlcHRpb24oJ3dyaXRlIHRvJykpOwogIH0KICB2YXIgc3RhdGUgPSBzdHJlYW0uX3N0YXRlOwogIGlmIChzdGF0ZSA9PT0gJ2Vycm9yZWQnKSB7CiAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKHN0cmVhbS5fc3RvcmVkRXJyb3IpOwogIH0KICBpZiAoV3JpdGFibGVTdHJlYW1DbG9zZVF1ZXVlZE9ySW5GbGlnaHQoc3RyZWFtKSA9PT0gdHJ1ZSB8fCBzdGF0ZSA9PT0gJ2Nsb3NlZCcpIHsKICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgobmV3IFR5cGVFcnJvcignVGhlIHN0cmVhbSBpcyBjbG9zaW5nIG9yIGNsb3NlZCBhbmQgY2Fubm90IGJlIHdyaXR0ZW4gdG8nKSk7CiAgfQogIGlmIChzdGF0ZSA9PT0gJ2Vycm9yaW5nJykgewogICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChzdHJlYW0uX3N0b3JlZEVycm9yKTsKICB9CiAgdmFyIHByb21pc2UgPSBXcml0YWJsZVN0cmVhbUFkZFdyaXRlUmVxdWVzdChzdHJlYW0pOwogIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJXcml0ZShjb250cm9sbGVyLCBjaHVuaywgY2h1bmtTaXplKTsKICByZXR1cm4gcHJvbWlzZTsKIH0KIHZhciBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIoKSB7CiAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1dyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIgY2Fubm90IGJlIGNvbnN0cnVjdGVkIGV4cGxpY2l0bHknKTsKICB9CiAgV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICBpZiAoSXNXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyKHRoaXMpID09PSBmYWxzZSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlci5wcm90b3R5cGUuZXJyb3IgY2FuIG9ubHkgYmUgdXNlZCBvbiBhIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXInKTsKICAgfQogICB2YXIgc3RhdGUgPSB0aGlzLl9jb250cm9sbGVkV3JpdGFibGVTdHJlYW0uX3N0YXRlOwogICBpZiAoc3RhdGUgIT09ICd3cml0YWJsZScpIHsKICAgIHJldHVybjsKICAgfQogICBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyRXJyb3IodGhpcywgZSk7CiAgfTsKICBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZVtBYm9ydFN0ZXBzXSA9IGZ1bmN0aW9uIChyZWFzb24pIHsKICAgdmFyIHJlc3VsdCA9IHRoaXMuX2Fib3J0QWxnb3JpdGhtKHJlYXNvbik7CiAgIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbGVhckFsZ29yaXRobXModGhpcyk7CiAgIHJldHVybiByZXN1bHQ7CiAgfTsKICBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZVtFcnJvclN0ZXBzXSA9IGZ1bmN0aW9uICgpIHsKICAgUmVzZXRRdWV1ZSh0aGlzKTsKICB9OwogIHJldHVybiBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyOwogfSgpOwogZnVuY3Rpb24gSXNXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyKHgpIHsKICBpZiAoIXR5cGVJc09iamVjdCh4KSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdfY29udHJvbGxlZFdyaXRhYmxlU3RyZWFtJykpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKIH0KIGZ1bmN0aW9uIFNldFVwV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcihzdHJlYW0sIGNvbnRyb2xsZXIsIHN0YXJ0QWxnb3JpdGhtLCB3cml0ZUFsZ29yaXRobSwgY2xvc2VBbGdvcml0aG0sIGFib3J0QWxnb3JpdGhtLCBoaWdoV2F0ZXJNYXJrLCBzaXplQWxnb3JpdGhtKSB7CiAgY29udHJvbGxlci5fY29udHJvbGxlZFdyaXRhYmxlU3RyZWFtID0gc3RyZWFtOwogIHN0cmVhbS5fd3JpdGFibGVTdHJlYW1Db250cm9sbGVyID0gY29udHJvbGxlcjsKICBjb250cm9sbGVyLl9xdWV1ZSA9IHVuZGVmaW5lZDsKICBjb250cm9sbGVyLl9xdWV1ZVRvdGFsU2l6ZSA9IHVuZGVmaW5lZDsKICBSZXNldFF1ZXVlKGNvbnRyb2xsZXIpOwogIGNvbnRyb2xsZXIuX3N0YXJ0ZWQgPSBmYWxzZTsKICBjb250cm9sbGVyLl9zdHJhdGVneVNpemVBbGdvcml0aG0gPSBzaXplQWxnb3JpdGhtOwogIGNvbnRyb2xsZXIuX3N0cmF0ZWd5SFdNID0gaGlnaFdhdGVyTWFyazsKICBjb250cm9sbGVyLl93cml0ZUFsZ29yaXRobSA9IHdyaXRlQWxnb3JpdGhtOwogIGNvbnRyb2xsZXIuX2Nsb3NlQWxnb3JpdGhtID0gY2xvc2VBbGdvcml0aG07CiAgY29udHJvbGxlci5fYWJvcnRBbGdvcml0aG0gPSBhYm9ydEFsZ29yaXRobTsKICB2YXIgYmFja3ByZXNzdXJlID0gV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckdldEJhY2twcmVzc3VyZShjb250cm9sbGVyKTsKICBXcml0YWJsZVN0cmVhbVVwZGF0ZUJhY2twcmVzc3VyZShzdHJlYW0sIGJhY2twcmVzc3VyZSk7CiAgdmFyIHN0YXJ0UmVzdWx0ID0gc3RhcnRBbGdvcml0aG0oKTsKICB2YXIgc3RhcnRQcm9taXNlID0gcHJvbWlzZVJlc29sdmVkV2l0aChzdGFydFJlc3VsdCk7CiAgdXBvblByb21pc2Uoc3RhcnRQcm9taXNlLCBmdW5jdGlvbiAoKSB7CiAgIGNvbnRyb2xsZXIuX3N0YXJ0ZWQgPSB0cnVlOwogICBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQWR2YW5jZVF1ZXVlSWZOZWVkZWQoY29udHJvbGxlcik7CiAgfSwgZnVuY3Rpb24gKHIpIHsKICAgY29udHJvbGxlci5fc3RhcnRlZCA9IHRydWU7CiAgIFdyaXRhYmxlU3RyZWFtRGVhbFdpdGhSZWplY3Rpb24oc3RyZWFtLCByKTsKICB9KTsKIH0KIGZ1bmN0aW9uIFNldFVwV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckZyb21VbmRlcmx5aW5nU2luayhzdHJlYW0sIHVuZGVybHlpbmdTaW5rLCBoaWdoV2F0ZXJNYXJrLCBzaXplQWxnb3JpdGhtKSB7CiAgdmFyIGNvbnRyb2xsZXIgPSBPYmplY3QuY3JlYXRlKFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIucHJvdG90eXBlKTsKICBmdW5jdGlvbiBzdGFydEFsZ29yaXRobSgpIHsKICAgcmV0dXJuIEludm9rZU9yTm9vcCh1bmRlcmx5aW5nU2luaywgJ3N0YXJ0JywgW2NvbnRyb2xsZXJdKTsKICB9CiAgdmFyIHdyaXRlQWxnb3JpdGhtID0gQ3JlYXRlQWxnb3JpdGhtRnJvbVVuZGVybHlpbmdNZXRob2QodW5kZXJseWluZ1NpbmssICd3cml0ZScsIDEsIFtjb250cm9sbGVyXSk7CiAgdmFyIGNsb3NlQWxnb3JpdGhtID0gQ3JlYXRlQWxnb3JpdGhtRnJvbVVuZGVybHlpbmdNZXRob2QodW5kZXJseWluZ1NpbmssICdjbG9zZScsIDAsIFtdKTsKICB2YXIgYWJvcnRBbGdvcml0aG0gPSBDcmVhdGVBbGdvcml0aG1Gcm9tVW5kZXJseWluZ01ldGhvZCh1bmRlcmx5aW5nU2luaywgJ2Fib3J0JywgMSwgW10pOwogIFNldFVwV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcihzdHJlYW0sIGNvbnRyb2xsZXIsIHN0YXJ0QWxnb3JpdGhtLCB3cml0ZUFsZ29yaXRobSwgY2xvc2VBbGdvcml0aG0sIGFib3J0QWxnb3JpdGhtLCBoaWdoV2F0ZXJNYXJrLCBzaXplQWxnb3JpdGhtKTsKIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbGVhckFsZ29yaXRobXMoY29udHJvbGxlcikgewogIGNvbnRyb2xsZXIuX3dyaXRlQWxnb3JpdGhtID0gdW5kZWZpbmVkOwogIGNvbnRyb2xsZXIuX2Nsb3NlQWxnb3JpdGhtID0gdW5kZWZpbmVkOwogIGNvbnRyb2xsZXIuX2Fib3J0QWxnb3JpdGhtID0gdW5kZWZpbmVkOwogIGNvbnRyb2xsZXIuX3N0cmF0ZWd5U2l6ZUFsZ29yaXRobSA9IHVuZGVmaW5lZDsKIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbG9zZShjb250cm9sbGVyKSB7CiAgRW5xdWV1ZVZhbHVlV2l0aFNpemUoY29udHJvbGxlciwgJ2Nsb3NlJywgMCk7CiAgV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckFkdmFuY2VRdWV1ZUlmTmVlZGVkKGNvbnRyb2xsZXIpOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckdldENodW5rU2l6ZShjb250cm9sbGVyLCBjaHVuaykgewogIHRyeSB7CiAgIHJldHVybiBjb250cm9sbGVyLl9zdHJhdGVneVNpemVBbGdvcml0aG0oY2h1bmspOwogIH0gY2F0Y2ggKGNodW5rU2l6ZUUpIHsKICAgV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckVycm9ySWZOZWVkZWQoY29udHJvbGxlciwgY2h1bmtTaXplRSk7CiAgIHJldHVybiAxOwogIH0KIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJHZXREZXNpcmVkU2l6ZShjb250cm9sbGVyKSB7CiAgcmV0dXJuIGNvbnRyb2xsZXIuX3N0cmF0ZWd5SFdNIC0gY29udHJvbGxlci5fcXVldWVUb3RhbFNpemU7CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyV3JpdGUoY29udHJvbGxlciwgY2h1bmssIGNodW5rU2l6ZSkgewogIHZhciB3cml0ZVJlY29yZCA9IHsgY2h1bms6IGNodW5rIH07CiAgdHJ5IHsKICAgRW5xdWV1ZVZhbHVlV2l0aFNpemUoY29udHJvbGxlciwgd3JpdGVSZWNvcmQsIGNodW5rU2l6ZSk7CiAgfSBjYXRjaCAoZW5xdWV1ZUUpIHsKICAgV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckVycm9ySWZOZWVkZWQoY29udHJvbGxlciwgZW5xdWV1ZUUpOwogICByZXR1cm47CiAgfQogIHZhciBzdHJlYW0gPSBjb250cm9sbGVyLl9jb250cm9sbGVkV3JpdGFibGVTdHJlYW07CiAgaWYgKFdyaXRhYmxlU3RyZWFtQ2xvc2VRdWV1ZWRPckluRmxpZ2h0KHN0cmVhbSkgPT09IGZhbHNlICYmIHN0cmVhbS5fc3RhdGUgPT09ICd3cml0YWJsZScpIHsKICAgdmFyIGJhY2twcmVzc3VyZSA9IFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJHZXRCYWNrcHJlc3N1cmUoY29udHJvbGxlcik7CiAgIFdyaXRhYmxlU3RyZWFtVXBkYXRlQmFja3ByZXNzdXJlKHN0cmVhbSwgYmFja3ByZXNzdXJlKTsKICB9CiAgV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckFkdmFuY2VRdWV1ZUlmTmVlZGVkKGNvbnRyb2xsZXIpOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckFkdmFuY2VRdWV1ZUlmTmVlZGVkKGNvbnRyb2xsZXIpIHsKICB2YXIgc3RyZWFtID0gY29udHJvbGxlci5fY29udHJvbGxlZFdyaXRhYmxlU3RyZWFtOwogIGlmIChjb250cm9sbGVyLl9zdGFydGVkID09PSBmYWxzZSkgewogICByZXR1cm47CiAgfQogIGlmIChzdHJlYW0uX2luRmxpZ2h0V3JpdGVSZXF1ZXN0ICE9PSB1bmRlZmluZWQpIHsKICAgcmV0dXJuOwogIH0KICB2YXIgc3RhdGUgPSBzdHJlYW0uX3N0YXRlOwogIGlmIChzdGF0ZSA9PT0gJ2Vycm9yaW5nJykgewogICBXcml0YWJsZVN0cmVhbUZpbmlzaEVycm9yaW5nKHN0cmVhbSk7CiAgIHJldHVybjsKICB9CiAgaWYgKGNvbnRyb2xsZXIuX3F1ZXVlLmxlbmd0aCA9PT0gMCkgewogICByZXR1cm47CiAgfQogIHZhciB3cml0ZVJlY29yZCA9IFBlZWtRdWV1ZVZhbHVlKGNvbnRyb2xsZXIpOwogIGlmICh3cml0ZVJlY29yZCA9PT0gJ2Nsb3NlJykgewogICBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyUHJvY2Vzc0Nsb3NlKGNvbnRyb2xsZXIpOwogIH0gZWxzZSB7CiAgIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJQcm9jZXNzV3JpdGUoY29udHJvbGxlciwgd3JpdGVSZWNvcmQuY2h1bmspOwogIH0KIH0KIGZ1bmN0aW9uIFdyaXRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFcnJvcklmTmVlZGVkKGNvbnRyb2xsZXIsIGVycm9yKSB7CiAgaWYgKGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRXcml0YWJsZVN0cmVhbS5fc3RhdGUgPT09ICd3cml0YWJsZScpIHsKICAgV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckVycm9yKGNvbnRyb2xsZXIsIGVycm9yKTsKICB9CiB9CiBmdW5jdGlvbiBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyUHJvY2Vzc0Nsb3NlKGNvbnRyb2xsZXIpIHsKICB2YXIgc3RyZWFtID0gY29udHJvbGxlci5fY29udHJvbGxlZFdyaXRhYmxlU3RyZWFtOwogIFdyaXRhYmxlU3RyZWFtTWFya0Nsb3NlUmVxdWVzdEluRmxpZ2h0KHN0cmVhbSk7CiAgRGVxdWV1ZVZhbHVlKGNvbnRyb2xsZXIpOwogIHZhciBzaW5rQ2xvc2VQcm9taXNlID0gY29udHJvbGxlci5fY2xvc2VBbGdvcml0aG0oKTsKICBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2xlYXJBbGdvcml0aG1zKGNvbnRyb2xsZXIpOwogIHVwb25Qcm9taXNlKHNpbmtDbG9zZVByb21pc2UsIGZ1bmN0aW9uICgpIHsKICAgV3JpdGFibGVTdHJlYW1GaW5pc2hJbkZsaWdodENsb3NlKHN0cmVhbSk7CiAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICBXcml0YWJsZVN0cmVhbUZpbmlzaEluRmxpZ2h0Q2xvc2VXaXRoRXJyb3Ioc3RyZWFtLCByZWFzb24pOwogIH0pOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlclByb2Nlc3NXcml0ZShjb250cm9sbGVyLCBjaHVuaykgewogIHZhciBzdHJlYW0gPSBjb250cm9sbGVyLl9jb250cm9sbGVkV3JpdGFibGVTdHJlYW07CiAgV3JpdGFibGVTdHJlYW1NYXJrRmlyc3RXcml0ZVJlcXVlc3RJbkZsaWdodChzdHJlYW0pOwogIHZhciBzaW5rV3JpdGVQcm9taXNlID0gY29udHJvbGxlci5fd3JpdGVBbGdvcml0aG0oY2h1bmspOwogIHVwb25Qcm9taXNlKHNpbmtXcml0ZVByb21pc2UsIGZ1bmN0aW9uICgpIHsKICAgV3JpdGFibGVTdHJlYW1GaW5pc2hJbkZsaWdodFdyaXRlKHN0cmVhbSk7CiAgIHZhciBzdGF0ZSA9IHN0cmVhbS5fc3RhdGU7CiAgIERlcXVldWVWYWx1ZShjb250cm9sbGVyKTsKICAgaWYgKFdyaXRhYmxlU3RyZWFtQ2xvc2VRdWV1ZWRPckluRmxpZ2h0KHN0cmVhbSkgPT09IGZhbHNlICYmIHN0YXRlID09PSAnd3JpdGFibGUnKSB7CiAgICB2YXIgYmFja3ByZXNzdXJlID0gV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckdldEJhY2twcmVzc3VyZShjb250cm9sbGVyKTsKICAgIFdyaXRhYmxlU3RyZWFtVXBkYXRlQmFja3ByZXNzdXJlKHN0cmVhbSwgYmFja3ByZXNzdXJlKTsKICAgfQogICBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQWR2YW5jZVF1ZXVlSWZOZWVkZWQoY29udHJvbGxlcik7CiAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICBpZiAoc3RyZWFtLl9zdGF0ZSA9PT0gJ3dyaXRhYmxlJykgewogICAgV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckNsZWFyQWxnb3JpdGhtcyhjb250cm9sbGVyKTsKICAgfQogICBXcml0YWJsZVN0cmVhbUZpbmlzaEluRmxpZ2h0V3JpdGVXaXRoRXJyb3Ioc3RyZWFtLCByZWFzb24pOwogIH0pOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckdldEJhY2twcmVzc3VyZShjb250cm9sbGVyKSB7CiAgdmFyIGRlc2lyZWRTaXplID0gV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckdldERlc2lyZWRTaXplKGNvbnRyb2xsZXIpOwogIHJldHVybiBkZXNpcmVkU2l6ZSA8PSAwOwogfQogZnVuY3Rpb24gV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckVycm9yKGNvbnRyb2xsZXIsIGVycm9yKSB7CiAgdmFyIHN0cmVhbSA9IGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRXcml0YWJsZVN0cmVhbTsKICBXcml0YWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2xlYXJBbGdvcml0aG1zKGNvbnRyb2xsZXIpOwogIFdyaXRhYmxlU3RyZWFtU3RhcnRFcnJvcmluZyhzdHJlYW0sIGVycm9yKTsKIH0KIGZ1bmN0aW9uIHN0cmVhbUJyYW5kQ2hlY2tFeGNlcHRpb24obmFtZSkgewogIHJldHVybiBuZXcgVHlwZUVycm9yKCJXcml0YWJsZVN0cmVhbS5wcm90b3R5cGUuIiArIG5hbWUgKyAiIGNhbiBvbmx5IGJlIHVzZWQgb24gYSBXcml0YWJsZVN0cmVhbSIpOwogfQogZnVuY3Rpb24gZGVmYXVsdFdyaXRlckJyYW5kQ2hlY2tFeGNlcHRpb24obmFtZSkgewogIHJldHVybiBuZXcgVHlwZUVycm9yKCJXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXIucHJvdG90eXBlLiIgKyBuYW1lICsgIiBjYW4gb25seSBiZSB1c2VkIG9uIGEgV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyIik7CiB9CiBmdW5jdGlvbiBkZWZhdWx0V3JpdGVyTG9ja0V4Y2VwdGlvbihuYW1lKSB7CiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCAnICsgbmFtZSArICcgYSBzdHJlYW0gdXNpbmcgYSByZWxlYXNlZCB3cml0ZXInKTsKIH0KIGZ1bmN0aW9uIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZSh3cml0ZXIpIHsKICB3cml0ZXIuX2Nsb3NlZFByb21pc2UgPSBuZXdQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgd3JpdGVyLl9jbG9zZWRQcm9taXNlX3Jlc29sdmUgPSByZXNvbHZlOwogICB3cml0ZXIuX2Nsb3NlZFByb21pc2VfcmVqZWN0ID0gcmVqZWN0OwogICB3cml0ZXIuX2Nsb3NlZFByb21pc2VTdGF0ZSA9ICdwZW5kaW5nJzsKICB9KTsKIH0KIGZ1bmN0aW9uIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZUFzUmVqZWN0ZWQod3JpdGVyLCByZWFzb24pIHsKICBkZWZhdWx0V3JpdGVyQ2xvc2VkUHJvbWlzZUluaXRpYWxpemUod3JpdGVyKTsKICBkZWZhdWx0V3JpdGVyQ2xvc2VkUHJvbWlzZVJlamVjdCh3cml0ZXIsIHJlYXNvbik7CiB9CiBmdW5jdGlvbiBkZWZhdWx0V3JpdGVyQ2xvc2VkUHJvbWlzZUluaXRpYWxpemVBc1Jlc29sdmVkKHdyaXRlcikgewogIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlSW5pdGlhbGl6ZSh3cml0ZXIpOwogIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlUmVzb2x2ZSh3cml0ZXIpOwogfQogZnVuY3Rpb24gZGVmYXVsdFdyaXRlckNsb3NlZFByb21pc2VSZWplY3Qod3JpdGVyLCByZWFzb24pIHsKICBzZXRQcm9taXNlSXNIYW5kbGVkVG9UcnVlKHdyaXRlci5fY2xvc2VkUHJvbWlzZSk7CiAgd3JpdGVyLl9jbG9zZWRQcm9taXNlX3JlamVjdChyZWFzb24pOwogIHdyaXRlci5fY2xvc2VkUHJvbWlzZV9yZXNvbHZlID0gdW5kZWZpbmVkOwogIHdyaXRlci5fY2xvc2VkUHJvbWlzZV9yZWplY3QgPSB1bmRlZmluZWQ7CiAgd3JpdGVyLl9jbG9zZWRQcm9taXNlU3RhdGUgPSAncmVqZWN0ZWQnOwogfQogZnVuY3Rpb24gZGVmYXVsdFdyaXRlckNsb3NlZFByb21pc2VSZXNldFRvUmVqZWN0ZWQod3JpdGVyLCByZWFzb24pIHsKICBkZWZhdWx0V3JpdGVyQ2xvc2VkUHJvbWlzZUluaXRpYWxpemVBc1JlamVjdGVkKHdyaXRlciwgcmVhc29uKTsKIH0KIGZ1bmN0aW9uIGRlZmF1bHRXcml0ZXJDbG9zZWRQcm9taXNlUmVzb2x2ZSh3cml0ZXIpIHsKICB3cml0ZXIuX2Nsb3NlZFByb21pc2VfcmVzb2x2ZSh1bmRlZmluZWQpOwogIHdyaXRlci5fY2xvc2VkUHJvbWlzZV9yZXNvbHZlID0gdW5kZWZpbmVkOwogIHdyaXRlci5fY2xvc2VkUHJvbWlzZV9yZWplY3QgPSB1bmRlZmluZWQ7CiAgd3JpdGVyLl9jbG9zZWRQcm9taXNlU3RhdGUgPSAncmVzb2x2ZWQnOwogfQogZnVuY3Rpb24gZGVmYXVsdFdyaXRlclJlYWR5UHJvbWlzZUluaXRpYWxpemUod3JpdGVyKSB7CiAgd3JpdGVyLl9yZWFkeVByb21pc2UgPSBuZXdQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgd3JpdGVyLl9yZWFkeVByb21pc2VfcmVzb2x2ZSA9IHJlc29sdmU7CiAgIHdyaXRlci5fcmVhZHlQcm9taXNlX3JlamVjdCA9IHJlamVjdDsKICB9KTsKICB3cml0ZXIuX3JlYWR5UHJvbWlzZVN0YXRlID0gJ3BlbmRpbmcnOwogfQogZnVuY3Rpb24gZGVmYXVsdFdyaXRlclJlYWR5UHJvbWlzZUluaXRpYWxpemVBc1JlamVjdGVkKHdyaXRlciwgcmVhc29uKSB7CiAgZGVmYXVsdFdyaXRlclJlYWR5UHJvbWlzZUluaXRpYWxpemUod3JpdGVyKTsKICBkZWZhdWx0V3JpdGVyUmVhZHlQcm9taXNlUmVqZWN0KHdyaXRlciwgcmVhc29uKTsKIH0KIGZ1bmN0aW9uIGRlZmF1bHRXcml0ZXJSZWFkeVByb21pc2VJbml0aWFsaXplQXNSZXNvbHZlZCh3cml0ZXIpIHsKICBkZWZhdWx0V3JpdGVyUmVhZHlQcm9taXNlSW5pdGlhbGl6ZSh3cml0ZXIpOwogIGRlZmF1bHRXcml0ZXJSZWFkeVByb21pc2VSZXNvbHZlKHdyaXRlcik7CiB9CiBmdW5jdGlvbiBkZWZhdWx0V3JpdGVyUmVhZHlQcm9taXNlUmVqZWN0KHdyaXRlciwgcmVhc29uKSB7CiAgc2V0UHJvbWlzZUlzSGFuZGxlZFRvVHJ1ZSh3cml0ZXIuX3JlYWR5UHJvbWlzZSk7CiAgd3JpdGVyLl9yZWFkeVByb21pc2VfcmVqZWN0KHJlYXNvbik7CiAgd3JpdGVyLl9yZWFkeVByb21pc2VfcmVzb2x2ZSA9IHVuZGVmaW5lZDsKICB3cml0ZXIuX3JlYWR5UHJvbWlzZV9yZWplY3QgPSB1bmRlZmluZWQ7CiAgd3JpdGVyLl9yZWFkeVByb21pc2VTdGF0ZSA9ICdyZWplY3RlZCc7CiB9CiBmdW5jdGlvbiBkZWZhdWx0V3JpdGVyUmVhZHlQcm9taXNlUmVzZXQod3JpdGVyKSB7CiAgZGVmYXVsdFdyaXRlclJlYWR5UHJvbWlzZUluaXRpYWxpemUod3JpdGVyKTsKIH0KIGZ1bmN0aW9uIGRlZmF1bHRXcml0ZXJSZWFkeVByb21pc2VSZXNldFRvUmVqZWN0ZWQod3JpdGVyLCByZWFzb24pIHsKICBkZWZhdWx0V3JpdGVyUmVhZHlQcm9taXNlSW5pdGlhbGl6ZUFzUmVqZWN0ZWQod3JpdGVyLCByZWFzb24pOwogfQogZnVuY3Rpb24gZGVmYXVsdFdyaXRlclJlYWR5UHJvbWlzZVJlc29sdmUod3JpdGVyKSB7CiAgd3JpdGVyLl9yZWFkeVByb21pc2VfcmVzb2x2ZSh1bmRlZmluZWQpOwogIHdyaXRlci5fcmVhZHlQcm9taXNlX3Jlc29sdmUgPSB1bmRlZmluZWQ7CiAgd3JpdGVyLl9yZWFkeVByb21pc2VfcmVqZWN0ID0gdW5kZWZpbmVkOwogIHdyaXRlci5fcmVhZHlQcm9taXNlU3RhdGUgPSAnZnVsZmlsbGVkJzsKIH0KIGZ1bmN0aW9uIGlzQWJvcnRTaWduYWwodmFsdWUpIHsKICBpZiAodHlwZW9mIHZhbHVlICE9PSAnb2JqZWN0JyB8fCB2YWx1ZSA9PT0gbnVsbCkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHRyeSB7CiAgIHJldHVybiB0eXBlb2YgdmFsdWUuYWJvcnRlZCA9PT0gJ2Jvb2xlYW4nOwogIH0gY2F0Y2ggKF9hKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiB9CiB2YXIgTmF0aXZlRE9NRXhjZXB0aW9uID0gdHlwZW9mIERPTUV4Y2VwdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBET01FeGNlcHRpb24gOiB1bmRlZmluZWQ7CiBmdW5jdGlvbiBpc0RPTUV4Y2VwdGlvbkNvbnN0cnVjdG9yKGN0b3IpIHsKICBpZiAoISh0eXBlb2YgY3RvciA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgY3RvciA9PT0gJ29iamVjdCcpKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgdHJ5IHsKICAgbmV3IGN0b3IoKTsKICAgcmV0dXJuIHRydWU7CiAgfSBjYXRjaCAoX2EpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KIH0KIGZ1bmN0aW9uIGNyZWF0ZURPTUV4Y2VwdGlvblBvbHlmaWxsKCkgewogIHZhciBjdG9yID0gZnVuY3Rpb24gRE9NRXhjZXB0aW9uKG1lc3NhZ2UsIG5hbWUpIHsKICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnJzsKICAgdGhpcy5uYW1lID0gbmFtZSB8fCAnRXJyb3InOwogICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHsKICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpOwogICB9CiAgfTsKICBjdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY3Rvci5wcm90b3R5cGUsICdjb25zdHJ1Y3RvcicsIHsKICAgdmFsdWU6IGN0b3IsCiAgIHdyaXRhYmxlOiB0cnVlLAogICBjb25maWd1cmFibGU6IHRydWUKICB9KTsKICByZXR1cm4gY3RvcjsKIH0KIHZhciBET01FeGNlcHRpb24kMSA9IGlzRE9NRXhjZXB0aW9uQ29uc3RydWN0b3IoTmF0aXZlRE9NRXhjZXB0aW9uKSA/IE5hdGl2ZURPTUV4Y2VwdGlvbiA6IGNyZWF0ZURPTUV4Y2VwdGlvblBvbHlmaWxsKCk7CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbVBpcGVUbyhzb3VyY2UsIGRlc3QsIHByZXZlbnRDbG9zZSwgcHJldmVudEFib3J0LCBwcmV2ZW50Q2FuY2VsLCBzaWduYWwpIHsKICB2YXIgcmVhZGVyID0gQWNxdWlyZVJlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlcihzb3VyY2UpOwogIHZhciB3cml0ZXIgPSBBY3F1aXJlV3JpdGFibGVTdHJlYW1EZWZhdWx0V3JpdGVyKGRlc3QpOwogIHNvdXJjZS5fZGlzdHVyYmVkID0gdHJ1ZTsKICB2YXIgc2h1dHRpbmdEb3duID0gZmFsc2U7CiAgdmFyIGN1cnJlbnRXcml0ZSA9IHByb21pc2VSZXNvbHZlZFdpdGgodW5kZWZpbmVkKTsKICByZXR1cm4gbmV3UHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgIHZhciBhYm9ydEFsZ29yaXRobTsKICAgaWYgKHNpZ25hbCAhPT0gdW5kZWZpbmVkKSB7CiAgICBhYm9ydEFsZ29yaXRobSA9IGZ1bmN0aW9uICgpIHsKICAgICB2YXIgZXJyb3IgPSBuZXcgRE9NRXhjZXB0aW9uJDEoJ0Fib3J0ZWQnLCAnQWJvcnRFcnJvcicpOwogICAgIHZhciBhY3Rpb25zID0gW107CiAgICAgaWYgKHByZXZlbnRBYm9ydCA9PT0gZmFsc2UpIHsKICAgICAgYWN0aW9ucy5wdXNoKGZ1bmN0aW9uICgpIHsKICAgICAgIGlmIChkZXN0Ll9zdGF0ZSA9PT0gJ3dyaXRhYmxlJykgewogICAgICAgIHJldHVybiBXcml0YWJsZVN0cmVhbUFib3J0KGRlc3QsIGVycm9yKTsKICAgICAgIH0KICAgICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKHVuZGVmaW5lZCk7CiAgICAgIH0pOwogICAgIH0KICAgICBpZiAocHJldmVudENhbmNlbCA9PT0gZmFsc2UpIHsKICAgICAgYWN0aW9ucy5wdXNoKGZ1bmN0aW9uICgpIHsKICAgICAgIGlmIChzb3VyY2UuX3N0YXRlID09PSAncmVhZGFibGUnKSB7CiAgICAgICAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtQ2FuY2VsKHNvdXJjZSwgZXJyb3IpOwogICAgICAgfQogICAgICAgcmV0dXJuIHByb21pc2VSZXNvbHZlZFdpdGgodW5kZWZpbmVkKTsKICAgICAgfSk7CiAgICAgfQogICAgIHNodXRkb3duV2l0aEFjdGlvbihmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBQcm9taXNlLmFsbChhY3Rpb25zLm1hcChmdW5jdGlvbiAoYWN0aW9uKSB7CiAgICAgICByZXR1cm4gYWN0aW9uKCk7CiAgICAgIH0pKTsKICAgICB9LCB0cnVlLCBlcnJvcik7CiAgICB9OwogICAgaWYgKHNpZ25hbC5hYm9ydGVkID09PSB0cnVlKSB7CiAgICAgYWJvcnRBbGdvcml0aG0oKTsKICAgICByZXR1cm47CiAgICB9CiAgICBzaWduYWwuYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBhYm9ydEFsZ29yaXRobSk7CiAgIH0KICAgZnVuY3Rpb24gcGlwZUxvb3AoKSB7CiAgICByZXR1cm4gbmV3UHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZUxvb3AsIHJlamVjdExvb3ApIHsKICAgICBmdW5jdGlvbiBuZXh0KGRvbmUpIHsKICAgICAgaWYgKGRvbmUpIHsKICAgICAgIHJlc29sdmVMb29wKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICBQZXJmb3JtUHJvbWlzZVRoZW4ocGlwZVN0ZXAoKSwgbmV4dCwgcmVqZWN0TG9vcCk7CiAgICAgIH0KICAgICB9CiAgICAgbmV4dChmYWxzZSk7CiAgICB9KTsKICAgfQogICBmdW5jdGlvbiBwaXBlU3RlcCgpIHsKICAgIGlmIChzaHV0dGluZ0Rvd24gPT09IHRydWUpIHsKICAgICByZXR1cm4gcHJvbWlzZVJlc29sdmVkV2l0aCh0cnVlKTsKICAgIH0KICAgIHJldHVybiBQZXJmb3JtUHJvbWlzZVRoZW4od3JpdGVyLl9yZWFkeVByb21pc2UsIGZ1bmN0aW9uICgpIHsKICAgICByZXR1cm4gUGVyZm9ybVByb21pc2VUaGVuKFJlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlclJlYWQocmVhZGVyKSwgZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0LmRvbmUgPT09IHRydWUpIHsKICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGN1cnJlbnRXcml0ZSA9IFBlcmZvcm1Qcm9taXNlVGhlbihXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXJXcml0ZSh3cml0ZXIsIHJlc3VsdC52YWx1ZSksIHVuZGVmaW5lZCwgbm9vcCk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgICB9KTsKICAgIH0pOwogICB9CiAgIGlzT3JCZWNvbWVzRXJyb3JlZChzb3VyY2UsIHJlYWRlci5fY2xvc2VkUHJvbWlzZSwgZnVuY3Rpb24gKHN0b3JlZEVycm9yKSB7CiAgICBpZiAocHJldmVudEFib3J0ID09PSBmYWxzZSkgewogICAgIHNodXRkb3duV2l0aEFjdGlvbihmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBXcml0YWJsZVN0cmVhbUFib3J0KGRlc3QsIHN0b3JlZEVycm9yKTsKICAgICB9LCB0cnVlLCBzdG9yZWRFcnJvcik7CiAgICB9IGVsc2UgewogICAgIHNodXRkb3duKHRydWUsIHN0b3JlZEVycm9yKTsKICAgIH0KICAgfSk7CiAgIGlzT3JCZWNvbWVzRXJyb3JlZChkZXN0LCB3cml0ZXIuX2Nsb3NlZFByb21pc2UsIGZ1bmN0aW9uIChzdG9yZWRFcnJvcikgewogICAgaWYgKHByZXZlbnRDYW5jZWwgPT09IGZhbHNlKSB7CiAgICAgc2h1dGRvd25XaXRoQWN0aW9uKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtQ2FuY2VsKHNvdXJjZSwgc3RvcmVkRXJyb3IpOwogICAgIH0sIHRydWUsIHN0b3JlZEVycm9yKTsKICAgIH0gZWxzZSB7CiAgICAgc2h1dGRvd24odHJ1ZSwgc3RvcmVkRXJyb3IpOwogICAgfQogICB9KTsKICAgaXNPckJlY29tZXNDbG9zZWQoc291cmNlLCByZWFkZXIuX2Nsb3NlZFByb21pc2UsIGZ1bmN0aW9uICgpIHsKICAgIGlmIChwcmV2ZW50Q2xvc2UgPT09IGZhbHNlKSB7CiAgICAgc2h1dGRvd25XaXRoQWN0aW9uKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFdyaXRhYmxlU3RyZWFtRGVmYXVsdFdyaXRlckNsb3NlV2l0aEVycm9yUHJvcGFnYXRpb24od3JpdGVyKTsKICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgc2h1dGRvd24oKTsKICAgIH0KICAgfSk7CiAgIGlmIChXcml0YWJsZVN0cmVhbUNsb3NlUXVldWVkT3JJbkZsaWdodChkZXN0KSA9PT0gdHJ1ZSB8fCBkZXN0Ll9zdGF0ZSA9PT0gJ2Nsb3NlZCcpIHsKICAgIHZhciBkZXN0Q2xvc2VkXzEgPSBuZXcgVHlwZUVycm9yKCd0aGUgZGVzdGluYXRpb24gd3JpdGFibGUgc3RyZWFtIGNsb3NlZCBiZWZvcmUgYWxsIGRhdGEgY291bGQgYmUgcGlwZWQgdG8gaXQnKTsKICAgIGlmIChwcmV2ZW50Q2FuY2VsID09PSBmYWxzZSkgewogICAgIHNodXRkb3duV2l0aEFjdGlvbihmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBSZWFkYWJsZVN0cmVhbUNhbmNlbChzb3VyY2UsIGRlc3RDbG9zZWRfMSk7CiAgICAgfSwgdHJ1ZSwgZGVzdENsb3NlZF8xKTsKICAgIH0gZWxzZSB7CiAgICAgc2h1dGRvd24odHJ1ZSwgZGVzdENsb3NlZF8xKTsKICAgIH0KICAgfQogICBzZXRQcm9taXNlSXNIYW5kbGVkVG9UcnVlKHBpcGVMb29wKCkpOwogICBmdW5jdGlvbiB3YWl0Rm9yV3JpdGVzVG9GaW5pc2goKSB7CiAgICB2YXIgb2xkQ3VycmVudFdyaXRlID0gY3VycmVudFdyaXRlOwogICAgcmV0dXJuIFBlcmZvcm1Qcm9taXNlVGhlbihjdXJyZW50V3JpdGUsIGZ1bmN0aW9uICgpIHsKICAgICByZXR1cm4gb2xkQ3VycmVudFdyaXRlICE9PSBjdXJyZW50V3JpdGUgPyB3YWl0Rm9yV3JpdGVzVG9GaW5pc2goKSA6IHVuZGVmaW5lZDsKICAgIH0pOwogICB9CiAgIGZ1bmN0aW9uIGlzT3JCZWNvbWVzRXJyb3JlZChzdHJlYW0sIHByb21pc2UsIGFjdGlvbikgewogICAgaWYgKHN0cmVhbS5fc3RhdGUgPT09ICdlcnJvcmVkJykgewogICAgIGFjdGlvbihzdHJlYW0uX3N0b3JlZEVycm9yKTsKICAgIH0gZWxzZSB7CiAgICAgdXBvblJlamVjdGlvbihwcm9taXNlLCBhY3Rpb24pOwogICAgfQogICB9CiAgIGZ1bmN0aW9uIGlzT3JCZWNvbWVzQ2xvc2VkKHN0cmVhbSwgcHJvbWlzZSwgYWN0aW9uKSB7CiAgICBpZiAoc3RyZWFtLl9zdGF0ZSA9PT0gJ2Nsb3NlZCcpIHsKICAgICBhY3Rpb24oKTsKICAgIH0gZWxzZSB7CiAgICAgdXBvbkZ1bGZpbGxtZW50KHByb21pc2UsIGFjdGlvbik7CiAgICB9CiAgIH0KICAgZnVuY3Rpb24gc2h1dGRvd25XaXRoQWN0aW9uKGFjdGlvbiwgb3JpZ2luYWxJc0Vycm9yLCBvcmlnaW5hbEVycm9yKSB7CiAgICBpZiAoc2h1dHRpbmdEb3duID09PSB0cnVlKSB7CiAgICAgcmV0dXJuOwogICAgfQogICAgc2h1dHRpbmdEb3duID0gdHJ1ZTsKICAgIGlmIChkZXN0Ll9zdGF0ZSA9PT0gJ3dyaXRhYmxlJyAmJiBXcml0YWJsZVN0cmVhbUNsb3NlUXVldWVkT3JJbkZsaWdodChkZXN0KSA9PT0gZmFsc2UpIHsKICAgICB1cG9uRnVsZmlsbG1lbnQod2FpdEZvcldyaXRlc1RvRmluaXNoKCksIGRvVGhlUmVzdCk7CiAgICB9IGVsc2UgewogICAgIGRvVGhlUmVzdCgpOwogICAgfQogICAgZnVuY3Rpb24gZG9UaGVSZXN0KCkgewogICAgIHVwb25Qcm9taXNlKGFjdGlvbigpLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBmaW5hbGl6ZShvcmlnaW5hbElzRXJyb3IsIG9yaWdpbmFsRXJyb3IpOwogICAgIH0sIGZ1bmN0aW9uIChuZXdFcnJvcikgewogICAgICByZXR1cm4gZmluYWxpemUodHJ1ZSwgbmV3RXJyb3IpOwogICAgIH0pOwogICAgfQogICB9CiAgIGZ1bmN0aW9uIHNodXRkb3duKGlzRXJyb3IsIGVycm9yKSB7CiAgICBpZiAoc2h1dHRpbmdEb3duID09PSB0cnVlKSB7CiAgICAgcmV0dXJuOwogICAgfQogICAgc2h1dHRpbmdEb3duID0gdHJ1ZTsKICAgIGlmIChkZXN0Ll9zdGF0ZSA9PT0gJ3dyaXRhYmxlJyAmJiBXcml0YWJsZVN0cmVhbUNsb3NlUXVldWVkT3JJbkZsaWdodChkZXN0KSA9PT0gZmFsc2UpIHsKICAgICB1cG9uRnVsZmlsbG1lbnQod2FpdEZvcldyaXRlc1RvRmluaXNoKCksIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGZpbmFsaXplKGlzRXJyb3IsIGVycm9yKTsKICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgZmluYWxpemUoaXNFcnJvciwgZXJyb3IpOwogICAgfQogICB9CiAgIGZ1bmN0aW9uIGZpbmFsaXplKGlzRXJyb3IsIGVycm9yKSB7CiAgICBXcml0YWJsZVN0cmVhbURlZmF1bHRXcml0ZXJSZWxlYXNlKHdyaXRlcik7CiAgICBSZWFkYWJsZVN0cmVhbVJlYWRlckdlbmVyaWNSZWxlYXNlKHJlYWRlcik7CiAgICBpZiAoc2lnbmFsICE9PSB1bmRlZmluZWQpIHsKICAgICBzaWduYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBhYm9ydEFsZ29yaXRobSk7CiAgICB9CiAgICBpZiAoaXNFcnJvcikgewogICAgIHJlamVjdChlcnJvcik7CiAgICB9IGVsc2UgewogICAgIHJlc29sdmUodW5kZWZpbmVkKTsKICAgIH0KICAgfQogIH0pOwogfQogdmFyIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcigpIHsKICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpOwogIH0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlci5wcm90b3R5cGUsICJkZXNpcmVkU2l6ZSIsIHsKICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoSXNSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyKHRoaXMpID09PSBmYWxzZSkgewogICAgIHRocm93IGRlZmF1bHRDb250cm9sbGVyQnJhbmRDaGVja0V4Y2VwdGlvbignZGVzaXJlZFNpemUnKTsKICAgIH0KICAgIHJldHVybiBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyR2V0RGVzaXJlZFNpemUodGhpcyk7CiAgIH0sCiAgIGVudW1lcmFibGU6IHRydWUsCiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwogIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkgewogICBpZiAoSXNSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyKHRoaXMpID09PSBmYWxzZSkgewogICAgdGhyb3cgZGVmYXVsdENvbnRyb2xsZXJCcmFuZENoZWNrRXhjZXB0aW9uKCdjbG9zZScpOwogICB9CiAgIGlmIChSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2FuQ2xvc2VPckVucXVldWUodGhpcykgPT09IGZhbHNlKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgc3RyZWFtIGlzIG5vdCBpbiBhIHN0YXRlIHRoYXQgcGVybWl0cyBjbG9zZScpOwogICB9CiAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbG9zZSh0aGlzKTsKICB9OwogIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIucHJvdG90eXBlLmVucXVldWUgPSBmdW5jdGlvbiAoY2h1bmspIHsKICAgaWYgKElzUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IGRlZmF1bHRDb250cm9sbGVyQnJhbmRDaGVja0V4Y2VwdGlvbignZW5xdWV1ZScpOwogICB9CiAgIGlmIChSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2FuQ2xvc2VPckVucXVldWUodGhpcykgPT09IGZhbHNlKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgc3RyZWFtIGlzIG5vdCBpbiBhIHN0YXRlIHRoYXQgcGVybWl0cyBlbnF1ZXVlJyk7CiAgIH0KICAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFbnF1ZXVlKHRoaXMsIGNodW5rKTsKICB9OwogIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsKICAgaWYgKElzUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IGRlZmF1bHRDb250cm9sbGVyQnJhbmRDaGVja0V4Y2VwdGlvbignZXJyb3InKTsKICAgfQogICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyRXJyb3IodGhpcywgZSk7CiAgfTsKICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZVtDYW5jZWxTdGVwc10gPSBmdW5jdGlvbiAocmVhc29uKSB7CiAgIFJlc2V0UXVldWUodGhpcyk7CiAgIHZhciByZXN1bHQgPSB0aGlzLl9jYW5jZWxBbGdvcml0aG0ocmVhc29uKTsKICAgUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckNsZWFyQWxnb3JpdGhtcyh0aGlzKTsKICAgcmV0dXJuIHJlc3VsdDsKICB9OwogIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIucHJvdG90eXBlW1B1bGxTdGVwc10gPSBmdW5jdGlvbiAoKSB7CiAgIHZhciBzdHJlYW0gPSB0aGlzLl9jb250cm9sbGVkUmVhZGFibGVTdHJlYW07CiAgIGlmICh0aGlzLl9xdWV1ZS5sZW5ndGggPiAwKSB7CiAgICB2YXIgY2h1bmsgPSBEZXF1ZXVlVmFsdWUodGhpcyk7CiAgICBpZiAodGhpcy5fY2xvc2VSZXF1ZXN0ZWQgPT09IHRydWUgJiYgdGhpcy5fcXVldWUubGVuZ3RoID09PSAwKSB7CiAgICAgUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckNsZWFyQWxnb3JpdGhtcyh0aGlzKTsKICAgICBSZWFkYWJsZVN0cmVhbUNsb3NlKHN0cmVhbSk7CiAgICB9IGVsc2UgewogICAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDYWxsUHVsbElmTmVlZGVkKHRoaXMpOwogICAgfQogICAgcmV0dXJuIHByb21pc2VSZXNvbHZlZFdpdGgoUmVhZGFibGVTdHJlYW1DcmVhdGVSZWFkUmVzdWx0KGNodW5rLCBmYWxzZSwgc3RyZWFtLl9yZWFkZXIuX2ZvckF1dGhvckNvZGUpKTsKICAgfQogICB2YXIgcGVuZGluZ1Byb21pc2UgPSBSZWFkYWJsZVN0cmVhbUFkZFJlYWRSZXF1ZXN0KHN0cmVhbSk7CiAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDYWxsUHVsbElmTmVlZGVkKHRoaXMpOwogICByZXR1cm4gcGVuZGluZ1Byb21pc2U7CiAgfTsKICByZXR1cm4gUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcjsKIH0oKTsKIGZ1bmN0aW9uIElzUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlcih4KSB7CiAgaWYgKCF0eXBlSXNPYmplY3QoeCkpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCAnX2NvbnRyb2xsZWRSZWFkYWJsZVN0cmVhbScpKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgcmV0dXJuIHRydWU7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2FsbFB1bGxJZk5lZWRlZChjb250cm9sbGVyKSB7CiAgdmFyIHNob3VsZFB1bGwgPSBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyU2hvdWxkQ2FsbFB1bGwoY29udHJvbGxlcik7CiAgaWYgKHNob3VsZFB1bGwgPT09IGZhbHNlKSB7CiAgIHJldHVybjsKICB9CiAgaWYgKGNvbnRyb2xsZXIuX3B1bGxpbmcgPT09IHRydWUpIHsKICAgY29udHJvbGxlci5fcHVsbEFnYWluID0gdHJ1ZTsKICAgcmV0dXJuOwogIH0KICBjb250cm9sbGVyLl9wdWxsaW5nID0gdHJ1ZTsKICB2YXIgcHVsbFByb21pc2UgPSBjb250cm9sbGVyLl9wdWxsQWxnb3JpdGhtKCk7CiAgdXBvblByb21pc2UocHVsbFByb21pc2UsIGZ1bmN0aW9uICgpIHsKICAgY29udHJvbGxlci5fcHVsbGluZyA9IGZhbHNlOwogICBpZiAoY29udHJvbGxlci5fcHVsbEFnYWluID09PSB0cnVlKSB7CiAgICBjb250cm9sbGVyLl9wdWxsQWdhaW4gPSBmYWxzZTsKICAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDYWxsUHVsbElmTmVlZGVkKGNvbnRyb2xsZXIpOwogICB9CiAgfSwgZnVuY3Rpb24gKGUpIHsKICAgUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckVycm9yKGNvbnRyb2xsZXIsIGUpOwogIH0pOwogfQogZnVuY3Rpb24gUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlclNob3VsZENhbGxQdWxsKGNvbnRyb2xsZXIpIHsKICB2YXIgc3RyZWFtID0gY29udHJvbGxlci5fY29udHJvbGxlZFJlYWRhYmxlU3RyZWFtOwogIGlmIChSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2FuQ2xvc2VPckVucXVldWUoY29udHJvbGxlcikgPT09IGZhbHNlKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYgKGNvbnRyb2xsZXIuX3N0YXJ0ZWQgPT09IGZhbHNlKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYgKElzUmVhZGFibGVTdHJlYW1Mb2NrZWQoc3RyZWFtKSA9PT0gdHJ1ZSAmJiBSZWFkYWJsZVN0cmVhbUdldE51bVJlYWRSZXF1ZXN0cyhzdHJlYW0pID4gMCkgewogICByZXR1cm4gdHJ1ZTsKICB9CiAgdmFyIGRlc2lyZWRTaXplID0gUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckdldERlc2lyZWRTaXplKGNvbnRyb2xsZXIpOwogIGlmIChkZXNpcmVkU2l6ZSA+IDApIHsKICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiBmYWxzZTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbGVhckFsZ29yaXRobXMoY29udHJvbGxlcikgewogIGNvbnRyb2xsZXIuX3B1bGxBbGdvcml0aG0gPSB1bmRlZmluZWQ7CiAgY29udHJvbGxlci5fY2FuY2VsQWxnb3JpdGhtID0gdW5kZWZpbmVkOwogIGNvbnRyb2xsZXIuX3N0cmF0ZWd5U2l6ZUFsZ29yaXRobSA9IHVuZGVmaW5lZDsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbG9zZShjb250cm9sbGVyKSB7CiAgdmFyIHN0cmVhbSA9IGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRSZWFkYWJsZVN0cmVhbTsKICBjb250cm9sbGVyLl9jbG9zZVJlcXVlc3RlZCA9IHRydWU7CiAgaWYgKGNvbnRyb2xsZXIuX3F1ZXVlLmxlbmd0aCA9PT0gMCkgewogICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2xlYXJBbGdvcml0aG1zKGNvbnRyb2xsZXIpOwogICBSZWFkYWJsZVN0cmVhbUNsb3NlKHN0cmVhbSk7CiAgfQogfQogZnVuY3Rpb24gUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckVucXVldWUoY29udHJvbGxlciwgY2h1bmspIHsKICB2YXIgc3RyZWFtID0gY29udHJvbGxlci5fY29udHJvbGxlZFJlYWRhYmxlU3RyZWFtOwogIGlmIChJc1JlYWRhYmxlU3RyZWFtTG9ja2VkKHN0cmVhbSkgPT09IHRydWUgJiYgUmVhZGFibGVTdHJlYW1HZXROdW1SZWFkUmVxdWVzdHMoc3RyZWFtKSA+IDApIHsKICAgUmVhZGFibGVTdHJlYW1GdWxmaWxsUmVhZFJlcXVlc3Qoc3RyZWFtLCBjaHVuaywgZmFsc2UpOwogIH0gZWxzZSB7CiAgIHZhciBjaHVua1NpemUgPSB2b2lkIDA7CiAgIHRyeSB7CiAgICBjaHVua1NpemUgPSBjb250cm9sbGVyLl9zdHJhdGVneVNpemVBbGdvcml0aG0oY2h1bmspOwogICB9IGNhdGNoIChjaHVua1NpemVFKSB7CiAgICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyRXJyb3IoY29udHJvbGxlciwgY2h1bmtTaXplRSk7CiAgICB0aHJvdyBjaHVua1NpemVFOwogICB9CiAgIHRyeSB7CiAgICBFbnF1ZXVlVmFsdWVXaXRoU2l6ZShjb250cm9sbGVyLCBjaHVuaywgY2h1bmtTaXplKTsKICAgfSBjYXRjaCAoZW5xdWV1ZUUpIHsKICAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFcnJvcihjb250cm9sbGVyLCBlbnF1ZXVlRSk7CiAgICB0aHJvdyBlbnF1ZXVlRTsKICAgfQogIH0KICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2FsbFB1bGxJZk5lZWRlZChjb250cm9sbGVyKTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFcnJvcihjb250cm9sbGVyLCBlKSB7CiAgdmFyIHN0cmVhbSA9IGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRSZWFkYWJsZVN0cmVhbTsKICBpZiAoc3RyZWFtLl9zdGF0ZSAhPT0gJ3JlYWRhYmxlJykgewogICByZXR1cm47CiAgfQogIFJlc2V0UXVldWUoY29udHJvbGxlcik7CiAgUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckNsZWFyQWxnb3JpdGhtcyhjb250cm9sbGVyKTsKICBSZWFkYWJsZVN0cmVhbUVycm9yKHN0cmVhbSwgZSk7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyR2V0RGVzaXJlZFNpemUoY29udHJvbGxlcikgewogIHZhciBzdHJlYW0gPSBjb250cm9sbGVyLl9jb250cm9sbGVkUmVhZGFibGVTdHJlYW07CiAgdmFyIHN0YXRlID0gc3RyZWFtLl9zdGF0ZTsKICBpZiAoc3RhdGUgPT09ICdlcnJvcmVkJykgewogICByZXR1cm4gbnVsbDsKICB9CiAgaWYgKHN0YXRlID09PSAnY2xvc2VkJykgewogICByZXR1cm4gMDsKICB9CiAgcmV0dXJuIGNvbnRyb2xsZXIuX3N0cmF0ZWd5SFdNIC0gY29udHJvbGxlci5fcXVldWVUb3RhbFNpemU7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVySGFzQmFja3ByZXNzdXJlKGNvbnRyb2xsZXIpIHsKICBpZiAoUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlclNob3VsZENhbGxQdWxsKGNvbnRyb2xsZXIpID09PSB0cnVlKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgcmV0dXJuIHRydWU7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2FuQ2xvc2VPckVucXVldWUoY29udHJvbGxlcikgewogIHZhciBzdGF0ZSA9IGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRSZWFkYWJsZVN0cmVhbS5fc3RhdGU7CiAgaWYgKGNvbnRyb2xsZXIuX2Nsb3NlUmVxdWVzdGVkID09PSBmYWxzZSAmJiBzdGF0ZSA9PT0gJ3JlYWRhYmxlJykgewogICByZXR1cm4gdHJ1ZTsKICB9CiAgcmV0dXJuIGZhbHNlOwogfQogZnVuY3Rpb24gU2V0VXBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyKHN0cmVhbSwgY29udHJvbGxlciwgc3RhcnRBbGdvcml0aG0sIHB1bGxBbGdvcml0aG0sIGNhbmNlbEFsZ29yaXRobSwgaGlnaFdhdGVyTWFyaywgc2l6ZUFsZ29yaXRobSkgewogIGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRSZWFkYWJsZVN0cmVhbSA9IHN0cmVhbTsKICBjb250cm9sbGVyLl9xdWV1ZSA9IHVuZGVmaW5lZDsKICBjb250cm9sbGVyLl9xdWV1ZVRvdGFsU2l6ZSA9IHVuZGVmaW5lZDsKICBSZXNldFF1ZXVlKGNvbnRyb2xsZXIpOwogIGNvbnRyb2xsZXIuX3N0YXJ0ZWQgPSBmYWxzZTsKICBjb250cm9sbGVyLl9jbG9zZVJlcXVlc3RlZCA9IGZhbHNlOwogIGNvbnRyb2xsZXIuX3B1bGxBZ2FpbiA9IGZhbHNlOwogIGNvbnRyb2xsZXIuX3B1bGxpbmcgPSBmYWxzZTsKICBjb250cm9sbGVyLl9zdHJhdGVneVNpemVBbGdvcml0aG0gPSBzaXplQWxnb3JpdGhtOwogIGNvbnRyb2xsZXIuX3N0cmF0ZWd5SFdNID0gaGlnaFdhdGVyTWFyazsKICBjb250cm9sbGVyLl9wdWxsQWxnb3JpdGhtID0gcHVsbEFsZ29yaXRobTsKICBjb250cm9sbGVyLl9jYW5jZWxBbGdvcml0aG0gPSBjYW5jZWxBbGdvcml0aG07CiAgc3RyZWFtLl9yZWFkYWJsZVN0cmVhbUNvbnRyb2xsZXIgPSBjb250cm9sbGVyOwogIHZhciBzdGFydFJlc3VsdCA9IHN0YXJ0QWxnb3JpdGhtKCk7CiAgdXBvblByb21pc2UocHJvbWlzZVJlc29sdmVkV2l0aChzdGFydFJlc3VsdCksIGZ1bmN0aW9uICgpIHsKICAgY29udHJvbGxlci5fc3RhcnRlZCA9IHRydWU7CiAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDYWxsUHVsbElmTmVlZGVkKGNvbnRyb2xsZXIpOwogIH0sIGZ1bmN0aW9uIChyKSB7CiAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFcnJvcihjb250cm9sbGVyLCByKTsKICB9KTsKIH0KIGZ1bmN0aW9uIFNldFVwUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckZyb21VbmRlcmx5aW5nU291cmNlKHN0cmVhbSwgdW5kZXJseWluZ1NvdXJjZSwgaGlnaFdhdGVyTWFyaywgc2l6ZUFsZ29yaXRobSkgewogIHZhciBjb250cm9sbGVyID0gT2JqZWN0LmNyZWF0ZShSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZSk7CiAgZnVuY3Rpb24gc3RhcnRBbGdvcml0aG0oKSB7CiAgIHJldHVybiBJbnZva2VPck5vb3AodW5kZXJseWluZ1NvdXJjZSwgJ3N0YXJ0JywgW2NvbnRyb2xsZXJdKTsKICB9CiAgdmFyIHB1bGxBbGdvcml0aG0gPSBDcmVhdGVBbGdvcml0aG1Gcm9tVW5kZXJseWluZ01ldGhvZCh1bmRlcmx5aW5nU291cmNlLCAncHVsbCcsIDAsIFtjb250cm9sbGVyXSk7CiAgdmFyIGNhbmNlbEFsZ29yaXRobSA9IENyZWF0ZUFsZ29yaXRobUZyb21VbmRlcmx5aW5nTWV0aG9kKHVuZGVybHlpbmdTb3VyY2UsICdjYW5jZWwnLCAxLCBbXSk7CiAgU2V0VXBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyKHN0cmVhbSwgY29udHJvbGxlciwgc3RhcnRBbGdvcml0aG0sIHB1bGxBbGdvcml0aG0sIGNhbmNlbEFsZ29yaXRobSwgaGlnaFdhdGVyTWFyaywgc2l6ZUFsZ29yaXRobSk7CiB9CiBmdW5jdGlvbiBkZWZhdWx0Q29udHJvbGxlckJyYW5kQ2hlY2tFeGNlcHRpb24obmFtZSkgewogIHJldHVybiBuZXcgVHlwZUVycm9yKCJSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZS4iICsgbmFtZSArICIgY2FuIG9ubHkgYmUgdXNlZCBvbiBhIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIiKTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtVGVlKHN0cmVhbSwgY2xvbmVGb3JCcmFuY2gyKSB7CiAgdmFyIHJlYWRlciA9IEFjcXVpcmVSZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXIoc3RyZWFtKTsKICB2YXIgcmVhZGluZyA9IGZhbHNlOwogIHZhciBjYW5jZWxlZDEgPSBmYWxzZTsKICB2YXIgY2FuY2VsZWQyID0gZmFsc2U7CiAgdmFyIHJlYXNvbjE7CiAgdmFyIHJlYXNvbjI7CiAgdmFyIGJyYW5jaDE7CiAgdmFyIGJyYW5jaDI7CiAgdmFyIHJlc29sdmVDYW5jZWxQcm9taXNlOwogIHZhciBjYW5jZWxQcm9taXNlID0gbmV3UHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICByZXNvbHZlQ2FuY2VsUHJvbWlzZSA9IHJlc29sdmU7CiAgfSk7CiAgZnVuY3Rpb24gcHVsbEFsZ29yaXRobSgpIHsKICAgaWYgKHJlYWRpbmcgPT09IHRydWUpIHsKICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKHVuZGVmaW5lZCk7CiAgIH0KICAgcmVhZGluZyA9IHRydWU7CiAgIHZhciByZWFkUHJvbWlzZSA9IHRyYW5zZm9ybVByb21pc2VXaXRoKFJlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlclJlYWQocmVhZGVyKSwgZnVuY3Rpb24gKHJlc3VsdCkgewogICAgcmVhZGluZyA9IGZhbHNlOwogICAgdmFyIGRvbmUgPSByZXN1bHQuZG9uZTsKICAgIGlmIChkb25lID09PSB0cnVlKSB7CiAgICAgaWYgKGNhbmNlbGVkMSA9PT0gZmFsc2UpIHsKICAgICAgUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckNsb3NlKGJyYW5jaDEuX3JlYWRhYmxlU3RyZWFtQ29udHJvbGxlcik7CiAgICAgfQogICAgIGlmIChjYW5jZWxlZDIgPT09IGZhbHNlKSB7CiAgICAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbG9zZShicmFuY2gyLl9yZWFkYWJsZVN0cmVhbUNvbnRyb2xsZXIpOwogICAgIH0KICAgICByZXR1cm47CiAgICB9CiAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7CiAgICB2YXIgdmFsdWUxID0gdmFsdWU7CiAgICB2YXIgdmFsdWUyID0gdmFsdWU7CiAgICBpZiAoY2FuY2VsZWQxID09PSBmYWxzZSkgewogICAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFbnF1ZXVlKGJyYW5jaDEuX3JlYWRhYmxlU3RyZWFtQ29udHJvbGxlciwgdmFsdWUxKTsKICAgIH0KICAgIGlmIChjYW5jZWxlZDIgPT09IGZhbHNlKSB7CiAgICAgUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckVucXVldWUoYnJhbmNoMi5fcmVhZGFibGVTdHJlYW1Db250cm9sbGVyLCB2YWx1ZTIpOwogICAgfQogICB9KTsKICAgc2V0UHJvbWlzZUlzSGFuZGxlZFRvVHJ1ZShyZWFkUHJvbWlzZSk7CiAgIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKHVuZGVmaW5lZCk7CiAgfQogIGZ1bmN0aW9uIGNhbmNlbDFBbGdvcml0aG0ocmVhc29uKSB7CiAgIGNhbmNlbGVkMSA9IHRydWU7CiAgIHJlYXNvbjEgPSByZWFzb247CiAgIGlmIChjYW5jZWxlZDIgPT09IHRydWUpIHsKICAgIHZhciBjb21wb3NpdGVSZWFzb24gPSBjcmVhdGVBcnJheUZyb21MaXN0KFsKICAgICByZWFzb24xLAogICAgIHJlYXNvbjIKICAgIF0pOwogICAgdmFyIGNhbmNlbFJlc3VsdCA9IFJlYWRhYmxlU3RyZWFtQ2FuY2VsKHN0cmVhbSwgY29tcG9zaXRlUmVhc29uKTsKICAgIHJlc29sdmVDYW5jZWxQcm9taXNlKGNhbmNlbFJlc3VsdCk7CiAgIH0KICAgcmV0dXJuIGNhbmNlbFByb21pc2U7CiAgfQogIGZ1bmN0aW9uIGNhbmNlbDJBbGdvcml0aG0ocmVhc29uKSB7CiAgIGNhbmNlbGVkMiA9IHRydWU7CiAgIHJlYXNvbjIgPSByZWFzb247CiAgIGlmIChjYW5jZWxlZDEgPT09IHRydWUpIHsKICAgIHZhciBjb21wb3NpdGVSZWFzb24gPSBjcmVhdGVBcnJheUZyb21MaXN0KFsKICAgICByZWFzb24xLAogICAgIHJlYXNvbjIKICAgIF0pOwogICAgdmFyIGNhbmNlbFJlc3VsdCA9IFJlYWRhYmxlU3RyZWFtQ2FuY2VsKHN0cmVhbSwgY29tcG9zaXRlUmVhc29uKTsKICAgIHJlc29sdmVDYW5jZWxQcm9taXNlKGNhbmNlbFJlc3VsdCk7CiAgIH0KICAgcmV0dXJuIGNhbmNlbFByb21pc2U7CiAgfQogIGZ1bmN0aW9uIHN0YXJ0QWxnb3JpdGhtKCkgewogIH0KICBicmFuY2gxID0gQ3JlYXRlUmVhZGFibGVTdHJlYW0oc3RhcnRBbGdvcml0aG0sIHB1bGxBbGdvcml0aG0sIGNhbmNlbDFBbGdvcml0aG0pOwogIGJyYW5jaDIgPSBDcmVhdGVSZWFkYWJsZVN0cmVhbShzdGFydEFsZ29yaXRobSwgcHVsbEFsZ29yaXRobSwgY2FuY2VsMkFsZ29yaXRobSk7CiAgdXBvblJlamVjdGlvbihyZWFkZXIuX2Nsb3NlZFByb21pc2UsIGZ1bmN0aW9uIChyKSB7CiAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFcnJvcihicmFuY2gxLl9yZWFkYWJsZVN0cmVhbUNvbnRyb2xsZXIsIHIpOwogICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyRXJyb3IoYnJhbmNoMi5fcmVhZGFibGVTdHJlYW1Db250cm9sbGVyLCByKTsKICB9KTsKICByZXR1cm4gWwogICBicmFuY2gxLAogICBicmFuY2gyCiAgXTsKIH0KIHZhciBOdW1iZXJJc0ludGVnZXIgPSBOdW1iZXIuaXNJbnRlZ2VyIHx8IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzRmluaXRlKHZhbHVlKSAmJiBNYXRoLmZsb29yKHZhbHVlKSA9PT0gdmFsdWU7CiB9OwogdmFyIFJlYWRhYmxlU3RyZWFtQllPQlJlcXVlc3QgPSBmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUmVhZGFibGVTdHJlYW1CWU9CUmVxdWVzdCgpIHsKICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUmVhZGFibGVTdHJlYW1CWU9CUmVxdWVzdCBjYW5ub3QgYmUgdXNlZCBkaXJlY3RseScpOwogIH0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVhZGFibGVTdHJlYW1CWU9CUmVxdWVzdC5wcm90b3R5cGUsICJ2aWV3IiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmIChJc1JlYWRhYmxlU3RyZWFtQllPQlJlcXVlc3QodGhpcykgPT09IGZhbHNlKSB7CiAgICAgdGhyb3cgYnlvYlJlcXVlc3RCcmFuZENoZWNrRXhjZXB0aW9uKCd2aWV3Jyk7CiAgICB9CiAgICByZXR1cm4gdGhpcy5fdmlldzsKICAgfSwKICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgY29uZmlndXJhYmxlOiB0cnVlCiAgfSk7CiAgUmVhZGFibGVTdHJlYW1CWU9CUmVxdWVzdC5wcm90b3R5cGUucmVzcG9uZCA9IGZ1bmN0aW9uIChieXRlc1dyaXR0ZW4pIHsKICAgaWYgKElzUmVhZGFibGVTdHJlYW1CWU9CUmVxdWVzdCh0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IGJ5b2JSZXF1ZXN0QnJhbmRDaGVja0V4Y2VwdGlvbigncmVzcG9uZCcpOwogICB9CiAgIGlmICh0aGlzLl9hc3NvY2lhdGVkUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlciA9PT0gdW5kZWZpbmVkKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGlzIEJZT0IgcmVxdWVzdCBoYXMgYmVlbiBpbnZhbGlkYXRlZCcpOwogICB9CiAgIGlmIChJc0RldGFjaGVkQnVmZmVyKHRoaXMuX3ZpZXcuYnVmZmVyKSA9PT0gdHJ1ZSk7CiAgIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJSZXNwb25kKHRoaXMuX2Fzc29jaWF0ZWRSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyLCBieXRlc1dyaXR0ZW4pOwogIH07CiAgUmVhZGFibGVTdHJlYW1CWU9CUmVxdWVzdC5wcm90b3R5cGUucmVzcG9uZFdpdGhOZXdWaWV3ID0gZnVuY3Rpb24gKHZpZXcpIHsKICAgaWYgKElzUmVhZGFibGVTdHJlYW1CWU9CUmVxdWVzdCh0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IGJ5b2JSZXF1ZXN0QnJhbmRDaGVja0V4Y2VwdGlvbigncmVzcG9uZCcpOwogICB9CiAgIGlmICh0aGlzLl9hc3NvY2lhdGVkUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlciA9PT0gdW5kZWZpbmVkKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGlzIEJZT0IgcmVxdWVzdCBoYXMgYmVlbiBpbnZhbGlkYXRlZCcpOwogICB9CiAgIGlmICghQXJyYXlCdWZmZXIuaXNWaWV3KHZpZXcpKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgY2FuIG9ubHkgcmVzcG9uZCB3aXRoIGFycmF5IGJ1ZmZlciB2aWV3cycpOwogICB9CiAgIGlmIChJc0RldGFjaGVkQnVmZmVyKHZpZXcuYnVmZmVyKSA9PT0gdHJ1ZSk7CiAgIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJSZXNwb25kV2l0aE5ld1ZpZXcodGhpcy5fYXNzb2NpYXRlZFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIsIHZpZXcpOwogIH07CiAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtQllPQlJlcXVlc3Q7CiB9KCk7CiB2YXIgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyKCkgewogICB0aHJvdyBuZXcgVHlwZUVycm9yKCdSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyIGNvbnN0cnVjdG9yIGNhbm5vdCBiZSB1c2VkIGRpcmVjdGx5Jyk7CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyLnByb3RvdHlwZSwgImJ5b2JSZXF1ZXN0IiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmIChJc1JlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIodGhpcykgPT09IGZhbHNlKSB7CiAgICAgdGhyb3cgYnl0ZVN0cmVhbUNvbnRyb2xsZXJCcmFuZENoZWNrRXhjZXB0aW9uKCdieW9iUmVxdWVzdCcpOwogICAgfQogICAgaWYgKHRoaXMuX2J5b2JSZXF1ZXN0ID09PSB1bmRlZmluZWQgJiYgdGhpcy5fcGVuZGluZ1B1bGxJbnRvcy5sZW5ndGggPiAwKSB7CiAgICAgdmFyIGZpcnN0RGVzY3JpcHRvciA9IHRoaXMuX3BlbmRpbmdQdWxsSW50b3MucGVlaygpOwogICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoZmlyc3REZXNjcmlwdG9yLmJ1ZmZlciwgZmlyc3REZXNjcmlwdG9yLmJ5dGVPZmZzZXQgKyBmaXJzdERlc2NyaXB0b3IuYnl0ZXNGaWxsZWQsIGZpcnN0RGVzY3JpcHRvci5ieXRlTGVuZ3RoIC0gZmlyc3REZXNjcmlwdG9yLmJ5dGVzRmlsbGVkKTsKICAgICB2YXIgYnlvYlJlcXVlc3QgPSBPYmplY3QuY3JlYXRlKFJlYWRhYmxlU3RyZWFtQllPQlJlcXVlc3QucHJvdG90eXBlKTsKICAgICBTZXRVcFJlYWRhYmxlU3RyZWFtQllPQlJlcXVlc3QoYnlvYlJlcXVlc3QsIHRoaXMsIHZpZXcpOwogICAgIHRoaXMuX2J5b2JSZXF1ZXN0ID0gYnlvYlJlcXVlc3Q7CiAgICB9CiAgICByZXR1cm4gdGhpcy5fYnlvYlJlcXVlc3Q7CiAgIH0sCiAgIGVudW1lcmFibGU6IHRydWUsCiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyLnByb3RvdHlwZSwgImRlc2lyZWRTaXplIiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmIChJc1JlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIodGhpcykgPT09IGZhbHNlKSB7CiAgICAgdGhyb3cgYnl0ZVN0cmVhbUNvbnRyb2xsZXJCcmFuZENoZWNrRXhjZXB0aW9uKCdkZXNpcmVkU2l6ZScpOwogICAgfQogICAgcmV0dXJuIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJHZXREZXNpcmVkU2l6ZSh0aGlzKTsKICAgfSwKICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgY29uZmlndXJhYmxlOiB0cnVlCiAgfSk7CiAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlci5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7CiAgIGlmIChJc1JlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIodGhpcykgPT09IGZhbHNlKSB7CiAgICB0aHJvdyBieXRlU3RyZWFtQ29udHJvbGxlckJyYW5kQ2hlY2tFeGNlcHRpb24oJ2Nsb3NlJyk7CiAgIH0KICAgaWYgKHRoaXMuX2Nsb3NlUmVxdWVzdGVkID09PSB0cnVlKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgc3RyZWFtIGhhcyBhbHJlYWR5IGJlZW4gY2xvc2VkOyBkbyBub3QgY2xvc2UgaXQgYWdhaW4hJyk7CiAgIH0KICAgdmFyIHN0YXRlID0gdGhpcy5fY29udHJvbGxlZFJlYWRhYmxlQnl0ZVN0cmVhbS5fc3RhdGU7CiAgIGlmIChzdGF0ZSAhPT0gJ3JlYWRhYmxlJykgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhlIHN0cmVhbSAoaW4gIiArIHN0YXRlICsgIiBzdGF0ZSkgaXMgbm90IGluIHRoZSByZWFkYWJsZSBzdGF0ZSBhbmQgY2Fubm90IGJlIGNsb3NlZCIpOwogICB9CiAgIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDbG9zZSh0aGlzKTsKICB9OwogIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIucHJvdG90eXBlLmVucXVldWUgPSBmdW5jdGlvbiAoY2h1bmspIHsKICAgaWYgKElzUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IGJ5dGVTdHJlYW1Db250cm9sbGVyQnJhbmRDaGVja0V4Y2VwdGlvbignZW5xdWV1ZScpOwogICB9CiAgIGlmICh0aGlzLl9jbG9zZVJlcXVlc3RlZCA9PT0gdHJ1ZSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignc3RyZWFtIGlzIGNsb3NlZCBvciBkcmFpbmluZycpOwogICB9CiAgIHZhciBzdGF0ZSA9IHRoaXMuX2NvbnRyb2xsZWRSZWFkYWJsZUJ5dGVTdHJlYW0uX3N0YXRlOwogICBpZiAoc3RhdGUgIT09ICdyZWFkYWJsZScpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIlRoZSBzdHJlYW0gKGluICIgKyBzdGF0ZSArICIgc3RhdGUpIGlzIG5vdCBpbiB0aGUgcmVhZGFibGUgc3RhdGUgYW5kIGNhbm5vdCBiZSBlbnF1ZXVlZCB0byIpOwogICB9CiAgIGlmICghQXJyYXlCdWZmZXIuaXNWaWV3KGNodW5rKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignWW91IGNhbiBvbmx5IGVucXVldWUgYXJyYXkgYnVmZmVyIHZpZXdzIHdoZW4gdXNpbmcgYSBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyJyk7CiAgIH0KICAgaWYgKElzRGV0YWNoZWRCdWZmZXIoY2h1bmsuYnVmZmVyKSA9PT0gdHJ1ZSk7CiAgIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJFbnF1ZXVlKHRoaXMsIGNodW5rKTsKICB9OwogIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsKICAgaWYgKElzUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IGJ5dGVTdHJlYW1Db250cm9sbGVyQnJhbmRDaGVja0V4Y2VwdGlvbignZXJyb3InKTsKICAgfQogICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRXJyb3IodGhpcywgZSk7CiAgfTsKICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyLnByb3RvdHlwZVtDYW5jZWxTdGVwc10gPSBmdW5jdGlvbiAocmVhc29uKSB7CiAgIGlmICh0aGlzLl9wZW5kaW5nUHVsbEludG9zLmxlbmd0aCA+IDApIHsKICAgIHZhciBmaXJzdERlc2NyaXB0b3IgPSB0aGlzLl9wZW5kaW5nUHVsbEludG9zLnBlZWsoKTsKICAgIGZpcnN0RGVzY3JpcHRvci5ieXRlc0ZpbGxlZCA9IDA7CiAgIH0KICAgUmVzZXRRdWV1ZSh0aGlzKTsKICAgdmFyIHJlc3VsdCA9IHRoaXMuX2NhbmNlbEFsZ29yaXRobShyZWFzb24pOwogICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyQ2xlYXJBbGdvcml0aG1zKHRoaXMpOwogICByZXR1cm4gcmVzdWx0OwogIH07CiAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlci5wcm90b3R5cGVbUHVsbFN0ZXBzXSA9IGZ1bmN0aW9uICgpIHsKICAgdmFyIHN0cmVhbSA9IHRoaXMuX2NvbnRyb2xsZWRSZWFkYWJsZUJ5dGVTdHJlYW07CiAgIGlmICh0aGlzLl9xdWV1ZVRvdGFsU2l6ZSA+IDApIHsKICAgIHZhciBlbnRyeSA9IHRoaXMuX3F1ZXVlLnNoaWZ0KCk7CiAgICB0aGlzLl9xdWV1ZVRvdGFsU2l6ZSAtPSBlbnRyeS5ieXRlTGVuZ3RoOwogICAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckhhbmRsZVF1ZXVlRHJhaW4odGhpcyk7CiAgICB2YXIgdmlldyA9IHZvaWQgMDsKICAgIHRyeSB7CiAgICAgdmlldyA9IG5ldyBVaW50OEFycmF5KGVudHJ5LmJ1ZmZlciwgZW50cnkuYnl0ZU9mZnNldCwgZW50cnkuYnl0ZUxlbmd0aCk7CiAgICB9IGNhdGNoICh2aWV3RSkgewogICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKHZpZXdFKTsKICAgIH0KICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKFJlYWRhYmxlU3RyZWFtQ3JlYXRlUmVhZFJlc3VsdCh2aWV3LCBmYWxzZSwgc3RyZWFtLl9yZWFkZXIuX2ZvckF1dGhvckNvZGUpKTsKICAgfQogICB2YXIgYXV0b0FsbG9jYXRlQ2h1bmtTaXplID0gdGhpcy5fYXV0b0FsbG9jYXRlQ2h1bmtTaXplOwogICBpZiAoYXV0b0FsbG9jYXRlQ2h1bmtTaXplICE9PSB1bmRlZmluZWQpIHsKICAgIHZhciBidWZmZXIgPSB2b2lkIDA7CiAgICB0cnkgewogICAgIGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihhdXRvQWxsb2NhdGVDaHVua1NpemUpOwogICAgfSBjYXRjaCAoYnVmZmVyRSkgewogICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKGJ1ZmZlckUpOwogICAgfQogICAgdmFyIHB1bGxJbnRvRGVzY3JpcHRvciA9IHsKICAgICBidWZmZXI6IGJ1ZmZlciwKICAgICBieXRlT2Zmc2V0OiAwLAogICAgIGJ5dGVMZW5ndGg6IGF1dG9BbGxvY2F0ZUNodW5rU2l6ZSwKICAgICBieXRlc0ZpbGxlZDogMCwKICAgICBlbGVtZW50U2l6ZTogMSwKICAgICBjdG9yOiBVaW50OEFycmF5LAogICAgIHJlYWRlclR5cGU6ICdkZWZhdWx0JwogICAgfTsKICAgIHRoaXMuX3BlbmRpbmdQdWxsSW50b3MucHVzaChwdWxsSW50b0Rlc2NyaXB0b3IpOwogICB9CiAgIHZhciBwcm9taXNlID0gUmVhZGFibGVTdHJlYW1BZGRSZWFkUmVxdWVzdChzdHJlYW0pOwogICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyQ2FsbFB1bGxJZk5lZWRlZCh0aGlzKTsKICAgcmV0dXJuIHByb21pc2U7CiAgfTsKICByZXR1cm4gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlcjsKIH0oKTsKIGZ1bmN0aW9uIElzUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlcih4KSB7CiAgaWYgKCF0eXBlSXNPYmplY3QoeCkpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCAnX2NvbnRyb2xsZWRSZWFkYWJsZUJ5dGVTdHJlYW0nKSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwogfQogZnVuY3Rpb24gSXNSZWFkYWJsZVN0cmVhbUJZT0JSZXF1ZXN0KHgpIHsKICBpZiAoIXR5cGVJc09iamVjdCh4KSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdfYXNzb2NpYXRlZFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXInKSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckNhbGxQdWxsSWZOZWVkZWQoY29udHJvbGxlcikgewogIHZhciBzaG91bGRQdWxsID0gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlclNob3VsZENhbGxQdWxsKGNvbnRyb2xsZXIpOwogIGlmIChzaG91bGRQdWxsID09PSBmYWxzZSkgewogICByZXR1cm47CiAgfQogIGlmIChjb250cm9sbGVyLl9wdWxsaW5nID09PSB0cnVlKSB7CiAgIGNvbnRyb2xsZXIuX3B1bGxBZ2FpbiA9IHRydWU7CiAgIHJldHVybjsKICB9CiAgY29udHJvbGxlci5fcHVsbGluZyA9IHRydWU7CiAgdmFyIHB1bGxQcm9taXNlID0gY29udHJvbGxlci5fcHVsbEFsZ29yaXRobSgpOwogIHVwb25Qcm9taXNlKHB1bGxQcm9taXNlLCBmdW5jdGlvbiAoKSB7CiAgIGNvbnRyb2xsZXIuX3B1bGxpbmcgPSBmYWxzZTsKICAgaWYgKGNvbnRyb2xsZXIuX3B1bGxBZ2FpbiA9PT0gdHJ1ZSkgewogICAgY29udHJvbGxlci5fcHVsbEFnYWluID0gZmFsc2U7CiAgICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyQ2FsbFB1bGxJZk5lZWRlZChjb250cm9sbGVyKTsKICAgfQogIH0sIGZ1bmN0aW9uIChlKSB7CiAgIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJFcnJvcihjb250cm9sbGVyLCBlKTsKICB9KTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDbGVhclBlbmRpbmdQdWxsSW50b3MoY29udHJvbGxlcikgewogIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJJbnZhbGlkYXRlQllPQlJlcXVlc3QoY29udHJvbGxlcik7CiAgY29udHJvbGxlci5fcGVuZGluZ1B1bGxJbnRvcyA9IG5ldyBTaW1wbGVRdWV1ZSgpOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckNvbW1pdFB1bGxJbnRvRGVzY3JpcHRvcihzdHJlYW0sIHB1bGxJbnRvRGVzY3JpcHRvcikgewogIHZhciBkb25lID0gZmFsc2U7CiAgaWYgKHN0cmVhbS5fc3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgIGRvbmUgPSB0cnVlOwogIH0KICB2YXIgZmlsbGVkVmlldyA9IFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDb252ZXJ0UHVsbEludG9EZXNjcmlwdG9yKHB1bGxJbnRvRGVzY3JpcHRvcik7CiAgaWYgKHB1bGxJbnRvRGVzY3JpcHRvci5yZWFkZXJUeXBlID09PSAnZGVmYXVsdCcpIHsKICAgUmVhZGFibGVTdHJlYW1GdWxmaWxsUmVhZFJlcXVlc3Qoc3RyZWFtLCBmaWxsZWRWaWV3LCBkb25lKTsKICB9IGVsc2UgewogICBSZWFkYWJsZVN0cmVhbUZ1bGZpbGxSZWFkSW50b1JlcXVlc3Qoc3RyZWFtLCBmaWxsZWRWaWV3LCBkb25lKTsKICB9CiB9CiBmdW5jdGlvbiBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyQ29udmVydFB1bGxJbnRvRGVzY3JpcHRvcihwdWxsSW50b0Rlc2NyaXB0b3IpIHsKICB2YXIgYnl0ZXNGaWxsZWQgPSBwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZXNGaWxsZWQ7CiAgdmFyIGVsZW1lbnRTaXplID0gcHVsbEludG9EZXNjcmlwdG9yLmVsZW1lbnRTaXplOwogIHJldHVybiBuZXcgcHVsbEludG9EZXNjcmlwdG9yLmN0b3IocHVsbEludG9EZXNjcmlwdG9yLmJ1ZmZlciwgcHVsbEludG9EZXNjcmlwdG9yLmJ5dGVPZmZzZXQsIGJ5dGVzRmlsbGVkIC8gZWxlbWVudFNpemUpOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckVucXVldWVDaHVua1RvUXVldWUoY29udHJvbGxlciwgYnVmZmVyLCBieXRlT2Zmc2V0LCBieXRlTGVuZ3RoKSB7CiAgY29udHJvbGxlci5fcXVldWUucHVzaCh7CiAgIGJ1ZmZlcjogYnVmZmVyLAogICBieXRlT2Zmc2V0OiBieXRlT2Zmc2V0LAogICBieXRlTGVuZ3RoOiBieXRlTGVuZ3RoCiAgfSk7CiAgY29udHJvbGxlci5fcXVldWVUb3RhbFNpemUgKz0gYnl0ZUxlbmd0aDsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJGaWxsUHVsbEludG9EZXNjcmlwdG9yRnJvbVF1ZXVlKGNvbnRyb2xsZXIsIHB1bGxJbnRvRGVzY3JpcHRvcikgewogIHZhciBlbGVtZW50U2l6ZSA9IHB1bGxJbnRvRGVzY3JpcHRvci5lbGVtZW50U2l6ZTsKICB2YXIgY3VycmVudEFsaWduZWRCeXRlcyA9IHB1bGxJbnRvRGVzY3JpcHRvci5ieXRlc0ZpbGxlZCAtIHB1bGxJbnRvRGVzY3JpcHRvci5ieXRlc0ZpbGxlZCAlIGVsZW1lbnRTaXplOwogIHZhciBtYXhCeXRlc1RvQ29weSA9IE1hdGgubWluKGNvbnRyb2xsZXIuX3F1ZXVlVG90YWxTaXplLCBwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZUxlbmd0aCAtIHB1bGxJbnRvRGVzY3JpcHRvci5ieXRlc0ZpbGxlZCk7CiAgdmFyIG1heEJ5dGVzRmlsbGVkID0gcHVsbEludG9EZXNjcmlwdG9yLmJ5dGVzRmlsbGVkICsgbWF4Qnl0ZXNUb0NvcHk7CiAgdmFyIG1heEFsaWduZWRCeXRlcyA9IG1heEJ5dGVzRmlsbGVkIC0gbWF4Qnl0ZXNGaWxsZWQgJSBlbGVtZW50U2l6ZTsKICB2YXIgdG90YWxCeXRlc1RvQ29weVJlbWFpbmluZyA9IG1heEJ5dGVzVG9Db3B5OwogIHZhciByZWFkeSA9IGZhbHNlOwogIGlmIChtYXhBbGlnbmVkQnl0ZXMgPiBjdXJyZW50QWxpZ25lZEJ5dGVzKSB7CiAgIHRvdGFsQnl0ZXNUb0NvcHlSZW1haW5pbmcgPSBtYXhBbGlnbmVkQnl0ZXMgLSBwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZXNGaWxsZWQ7CiAgIHJlYWR5ID0gdHJ1ZTsKICB9CiAgdmFyIHF1ZXVlID0gY29udHJvbGxlci5fcXVldWU7CiAgd2hpbGUgKHRvdGFsQnl0ZXNUb0NvcHlSZW1haW5pbmcgPiAwKSB7CiAgIHZhciBoZWFkT2ZRdWV1ZSA9IHF1ZXVlLnBlZWsoKTsKICAgdmFyIGJ5dGVzVG9Db3B5ID0gTWF0aC5taW4odG90YWxCeXRlc1RvQ29weVJlbWFpbmluZywgaGVhZE9mUXVldWUuYnl0ZUxlbmd0aCk7CiAgIHZhciBkZXN0U3RhcnQgPSBwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZU9mZnNldCArIHB1bGxJbnRvRGVzY3JpcHRvci5ieXRlc0ZpbGxlZDsKICAgQXJyYXlCdWZmZXJDb3B5KHB1bGxJbnRvRGVzY3JpcHRvci5idWZmZXIsIGRlc3RTdGFydCwgaGVhZE9mUXVldWUuYnVmZmVyLCBoZWFkT2ZRdWV1ZS5ieXRlT2Zmc2V0LCBieXRlc1RvQ29weSk7CiAgIGlmIChoZWFkT2ZRdWV1ZS5ieXRlTGVuZ3RoID09PSBieXRlc1RvQ29weSkgewogICAgcXVldWUuc2hpZnQoKTsKICAgfSBlbHNlIHsKICAgIGhlYWRPZlF1ZXVlLmJ5dGVPZmZzZXQgKz0gYnl0ZXNUb0NvcHk7CiAgICBoZWFkT2ZRdWV1ZS5ieXRlTGVuZ3RoIC09IGJ5dGVzVG9Db3B5OwogICB9CiAgIGNvbnRyb2xsZXIuX3F1ZXVlVG90YWxTaXplIC09IGJ5dGVzVG9Db3B5OwogICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRmlsbEhlYWRQdWxsSW50b0Rlc2NyaXB0b3IoY29udHJvbGxlciwgYnl0ZXNUb0NvcHksIHB1bGxJbnRvRGVzY3JpcHRvcik7CiAgIHRvdGFsQnl0ZXNUb0NvcHlSZW1haW5pbmcgLT0gYnl0ZXNUb0NvcHk7CiAgfQogIHJldHVybiByZWFkeTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJGaWxsSGVhZFB1bGxJbnRvRGVzY3JpcHRvcihjb250cm9sbGVyLCBzaXplLCBwdWxsSW50b0Rlc2NyaXB0b3IpIHsKICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVySW52YWxpZGF0ZUJZT0JSZXF1ZXN0KGNvbnRyb2xsZXIpOwogIHB1bGxJbnRvRGVzY3JpcHRvci5ieXRlc0ZpbGxlZCArPSBzaXplOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckhhbmRsZVF1ZXVlRHJhaW4oY29udHJvbGxlcikgewogIGlmIChjb250cm9sbGVyLl9xdWV1ZVRvdGFsU2l6ZSA9PT0gMCAmJiBjb250cm9sbGVyLl9jbG9zZVJlcXVlc3RlZCA9PT0gdHJ1ZSkgewogICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyQ2xlYXJBbGdvcml0aG1zKGNvbnRyb2xsZXIpOwogICBSZWFkYWJsZVN0cmVhbUNsb3NlKGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRSZWFkYWJsZUJ5dGVTdHJlYW0pOwogIH0gZWxzZSB7CiAgIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDYWxsUHVsbElmTmVlZGVkKGNvbnRyb2xsZXIpOwogIH0KIH0KIGZ1bmN0aW9uIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJJbnZhbGlkYXRlQllPQlJlcXVlc3QoY29udHJvbGxlcikgewogIGlmIChjb250cm9sbGVyLl9ieW9iUmVxdWVzdCA9PT0gdW5kZWZpbmVkKSB7CiAgIHJldHVybjsKICB9CiAgY29udHJvbGxlci5fYnlvYlJlcXVlc3QuX2Fzc29jaWF0ZWRSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyID0gdW5kZWZpbmVkOwogIGNvbnRyb2xsZXIuX2J5b2JSZXF1ZXN0Ll92aWV3ID0gdW5kZWZpbmVkOwogIGNvbnRyb2xsZXIuX2J5b2JSZXF1ZXN0ID0gdW5kZWZpbmVkOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlclByb2Nlc3NQdWxsSW50b0Rlc2NyaXB0b3JzVXNpbmdRdWV1ZShjb250cm9sbGVyKSB7CiAgd2hpbGUgKGNvbnRyb2xsZXIuX3BlbmRpbmdQdWxsSW50b3MubGVuZ3RoID4gMCkgewogICBpZiAoY29udHJvbGxlci5fcXVldWVUb3RhbFNpemUgPT09IDApIHsKICAgIHJldHVybjsKICAgfQogICB2YXIgcHVsbEludG9EZXNjcmlwdG9yID0gY29udHJvbGxlci5fcGVuZGluZ1B1bGxJbnRvcy5wZWVrKCk7CiAgIGlmIChSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRmlsbFB1bGxJbnRvRGVzY3JpcHRvckZyb21RdWV1ZShjb250cm9sbGVyLCBwdWxsSW50b0Rlc2NyaXB0b3IpID09PSB0cnVlKSB7CiAgICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyU2hpZnRQZW5kaW5nUHVsbEludG8oY29udHJvbGxlcik7CiAgICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyQ29tbWl0UHVsbEludG9EZXNjcmlwdG9yKGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRSZWFkYWJsZUJ5dGVTdHJlYW0sIHB1bGxJbnRvRGVzY3JpcHRvcik7CiAgIH0KICB9CiB9CiBmdW5jdGlvbiBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyUHVsbEludG8oY29udHJvbGxlciwgdmlldykgewogIHZhciBzdHJlYW0gPSBjb250cm9sbGVyLl9jb250cm9sbGVkUmVhZGFibGVCeXRlU3RyZWFtOwogIHZhciBlbGVtZW50U2l6ZSA9IDE7CiAgaWYgKHZpZXcuY29uc3RydWN0b3IgIT09IERhdGFWaWV3KSB7CiAgIGVsZW1lbnRTaXplID0gdmlldy5jb25zdHJ1Y3Rvci5CWVRFU19QRVJfRUxFTUVOVDsKICB9CiAgdmFyIGN0b3IgPSB2aWV3LmNvbnN0cnVjdG9yOwogIHZhciBidWZmZXIgPSBUcmFuc2ZlckFycmF5QnVmZmVyKHZpZXcuYnVmZmVyKTsKICB2YXIgcHVsbEludG9EZXNjcmlwdG9yID0gewogICBidWZmZXI6IGJ1ZmZlciwKICAgYnl0ZU9mZnNldDogdmlldy5ieXRlT2Zmc2V0LAogICBieXRlTGVuZ3RoOiB2aWV3LmJ5dGVMZW5ndGgsCiAgIGJ5dGVzRmlsbGVkOiAwLAogICBlbGVtZW50U2l6ZTogZWxlbWVudFNpemUsCiAgIGN0b3I6IGN0b3IsCiAgIHJlYWRlclR5cGU6ICdieW9iJwogIH07CiAgaWYgKGNvbnRyb2xsZXIuX3BlbmRpbmdQdWxsSW50b3MubGVuZ3RoID4gMCkgewogICBjb250cm9sbGVyLl9wZW5kaW5nUHVsbEludG9zLnB1c2gocHVsbEludG9EZXNjcmlwdG9yKTsKICAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtQWRkUmVhZEludG9SZXF1ZXN0KHN0cmVhbSk7CiAgfQogIGlmIChzdHJlYW0uX3N0YXRlID09PSAnY2xvc2VkJykgewogICB2YXIgZW1wdHlWaWV3ID0gbmV3IGN0b3IocHVsbEludG9EZXNjcmlwdG9yLmJ1ZmZlciwgcHVsbEludG9EZXNjcmlwdG9yLmJ5dGVPZmZzZXQsIDApOwogICByZXR1cm4gcHJvbWlzZVJlc29sdmVkV2l0aChSZWFkYWJsZVN0cmVhbUNyZWF0ZVJlYWRSZXN1bHQoZW1wdHlWaWV3LCB0cnVlLCBzdHJlYW0uX3JlYWRlci5fZm9yQXV0aG9yQ29kZSkpOwogIH0KICBpZiAoY29udHJvbGxlci5fcXVldWVUb3RhbFNpemUgPiAwKSB7CiAgIGlmIChSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRmlsbFB1bGxJbnRvRGVzY3JpcHRvckZyb21RdWV1ZShjb250cm9sbGVyLCBwdWxsSW50b0Rlc2NyaXB0b3IpID09PSB0cnVlKSB7CiAgICB2YXIgZmlsbGVkVmlldyA9IFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDb252ZXJ0UHVsbEludG9EZXNjcmlwdG9yKHB1bGxJbnRvRGVzY3JpcHRvcik7CiAgICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVySGFuZGxlUXVldWVEcmFpbihjb250cm9sbGVyKTsKICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKFJlYWRhYmxlU3RyZWFtQ3JlYXRlUmVhZFJlc3VsdChmaWxsZWRWaWV3LCBmYWxzZSwgc3RyZWFtLl9yZWFkZXIuX2ZvckF1dGhvckNvZGUpKTsKICAgfQogICBpZiAoY29udHJvbGxlci5fY2xvc2VSZXF1ZXN0ZWQgPT09IHRydWUpIHsKICAgIHZhciBlID0gbmV3IFR5cGVFcnJvcignSW5zdWZmaWNpZW50IGJ5dGVzIHRvIGZpbGwgZWxlbWVudHMgaW4gdGhlIGdpdmVuIGJ1ZmZlcicpOwogICAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckVycm9yKGNvbnRyb2xsZXIsIGUpOwogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgoZSk7CiAgIH0KICB9CiAgY29udHJvbGxlci5fcGVuZGluZ1B1bGxJbnRvcy5wdXNoKHB1bGxJbnRvRGVzY3JpcHRvcik7CiAgdmFyIHByb21pc2UgPSBSZWFkYWJsZVN0cmVhbUFkZFJlYWRJbnRvUmVxdWVzdChzdHJlYW0pOwogIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDYWxsUHVsbElmTmVlZGVkKGNvbnRyb2xsZXIpOwogIHJldHVybiBwcm9taXNlOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlclJlc3BvbmRJbkNsb3NlZFN0YXRlKGNvbnRyb2xsZXIsIGZpcnN0RGVzY3JpcHRvcikgewogIGZpcnN0RGVzY3JpcHRvci5idWZmZXIgPSBUcmFuc2ZlckFycmF5QnVmZmVyKGZpcnN0RGVzY3JpcHRvci5idWZmZXIpOwogIHZhciBzdHJlYW0gPSBjb250cm9sbGVyLl9jb250cm9sbGVkUmVhZGFibGVCeXRlU3RyZWFtOwogIGlmIChSZWFkYWJsZVN0cmVhbUhhc0JZT0JSZWFkZXIoc3RyZWFtKSA9PT0gdHJ1ZSkgewogICB3aGlsZSAoUmVhZGFibGVTdHJlYW1HZXROdW1SZWFkSW50b1JlcXVlc3RzKHN0cmVhbSkgPiAwKSB7CiAgICB2YXIgcHVsbEludG9EZXNjcmlwdG9yID0gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlclNoaWZ0UGVuZGluZ1B1bGxJbnRvKGNvbnRyb2xsZXIpOwogICAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckNvbW1pdFB1bGxJbnRvRGVzY3JpcHRvcihzdHJlYW0sIHB1bGxJbnRvRGVzY3JpcHRvcik7CiAgIH0KICB9CiB9CiBmdW5jdGlvbiBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyUmVzcG9uZEluUmVhZGFibGVTdGF0ZShjb250cm9sbGVyLCBieXRlc1dyaXR0ZW4sIHB1bGxJbnRvRGVzY3JpcHRvcikgewogIGlmIChwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZXNGaWxsZWQgKyBieXRlc1dyaXR0ZW4gPiBwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZUxlbmd0aCkgewogICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignYnl0ZXNXcml0dGVuIG91dCBvZiByYW5nZScpOwogIH0KICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRmlsbEhlYWRQdWxsSW50b0Rlc2NyaXB0b3IoY29udHJvbGxlciwgYnl0ZXNXcml0dGVuLCBwdWxsSW50b0Rlc2NyaXB0b3IpOwogIGlmIChwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZXNGaWxsZWQgPCBwdWxsSW50b0Rlc2NyaXB0b3IuZWxlbWVudFNpemUpIHsKICAgcmV0dXJuOwogIH0KICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyU2hpZnRQZW5kaW5nUHVsbEludG8oY29udHJvbGxlcik7CiAgdmFyIHJlbWFpbmRlclNpemUgPSBwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZXNGaWxsZWQgJSBwdWxsSW50b0Rlc2NyaXB0b3IuZWxlbWVudFNpemU7CiAgaWYgKHJlbWFpbmRlclNpemUgPiAwKSB7CiAgIHZhciBlbmQgPSBwdWxsSW50b0Rlc2NyaXB0b3IuYnl0ZU9mZnNldCArIHB1bGxJbnRvRGVzY3JpcHRvci5ieXRlc0ZpbGxlZDsKICAgdmFyIHJlbWFpbmRlciA9IHB1bGxJbnRvRGVzY3JpcHRvci5idWZmZXIuc2xpY2UoZW5kIC0gcmVtYWluZGVyU2l6ZSwgZW5kKTsKICAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckVucXVldWVDaHVua1RvUXVldWUoY29udHJvbGxlciwgcmVtYWluZGVyLCAwLCByZW1haW5kZXIuYnl0ZUxlbmd0aCk7CiAgfQogIHB1bGxJbnRvRGVzY3JpcHRvci5idWZmZXIgPSBUcmFuc2ZlckFycmF5QnVmZmVyKHB1bGxJbnRvRGVzY3JpcHRvci5idWZmZXIpOwogIHB1bGxJbnRvRGVzY3JpcHRvci5ieXRlc0ZpbGxlZCAtPSByZW1haW5kZXJTaXplOwogIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDb21taXRQdWxsSW50b0Rlc2NyaXB0b3IoY29udHJvbGxlci5fY29udHJvbGxlZFJlYWRhYmxlQnl0ZVN0cmVhbSwgcHVsbEludG9EZXNjcmlwdG9yKTsKICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyUHJvY2Vzc1B1bGxJbnRvRGVzY3JpcHRvcnNVc2luZ1F1ZXVlKGNvbnRyb2xsZXIpOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlclJlc3BvbmRJbnRlcm5hbChjb250cm9sbGVyLCBieXRlc1dyaXR0ZW4pIHsKICB2YXIgZmlyc3REZXNjcmlwdG9yID0gY29udHJvbGxlci5fcGVuZGluZ1B1bGxJbnRvcy5wZWVrKCk7CiAgdmFyIHN0cmVhbSA9IGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRSZWFkYWJsZUJ5dGVTdHJlYW07CiAgaWYgKHN0cmVhbS5fc3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgIGlmIChieXRlc1dyaXR0ZW4gIT09IDApIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2J5dGVzV3JpdHRlbiBtdXN0IGJlIDAgd2hlbiBjYWxsaW5nIHJlc3BvbmQoKSBvbiBhIGNsb3NlZCBzdHJlYW0nKTsKICAgfQogICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyUmVzcG9uZEluQ2xvc2VkU3RhdGUoY29udHJvbGxlciwgZmlyc3REZXNjcmlwdG9yKTsKICB9IGVsc2UgewogICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyUmVzcG9uZEluUmVhZGFibGVTdGF0ZShjb250cm9sbGVyLCBieXRlc1dyaXR0ZW4sIGZpcnN0RGVzY3JpcHRvcik7CiAgfQogIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDYWxsUHVsbElmTmVlZGVkKGNvbnRyb2xsZXIpOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlclNoaWZ0UGVuZGluZ1B1bGxJbnRvKGNvbnRyb2xsZXIpIHsKICB2YXIgZGVzY3JpcHRvciA9IGNvbnRyb2xsZXIuX3BlbmRpbmdQdWxsSW50b3Muc2hpZnQoKTsKICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVySW52YWxpZGF0ZUJZT0JSZXF1ZXN0KGNvbnRyb2xsZXIpOwogIHJldHVybiBkZXNjcmlwdG9yOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlclNob3VsZENhbGxQdWxsKGNvbnRyb2xsZXIpIHsKICB2YXIgc3RyZWFtID0gY29udHJvbGxlci5fY29udHJvbGxlZFJlYWRhYmxlQnl0ZVN0cmVhbTsKICBpZiAoc3RyZWFtLl9zdGF0ZSAhPT0gJ3JlYWRhYmxlJykgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmIChjb250cm9sbGVyLl9jbG9zZVJlcXVlc3RlZCA9PT0gdHJ1ZSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmIChjb250cm9sbGVyLl9zdGFydGVkID09PSBmYWxzZSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmIChSZWFkYWJsZVN0cmVhbUhhc0RlZmF1bHRSZWFkZXIoc3RyZWFtKSA9PT0gdHJ1ZSAmJiBSZWFkYWJsZVN0cmVhbUdldE51bVJlYWRSZXF1ZXN0cyhzdHJlYW0pID4gMCkgewogICByZXR1cm4gdHJ1ZTsKICB9CiAgaWYgKFJlYWRhYmxlU3RyZWFtSGFzQllPQlJlYWRlcihzdHJlYW0pID09PSB0cnVlICYmIFJlYWRhYmxlU3RyZWFtR2V0TnVtUmVhZEludG9SZXF1ZXN0cyhzdHJlYW0pID4gMCkgewogICByZXR1cm4gdHJ1ZTsKICB9CiAgdmFyIGRlc2lyZWRTaXplID0gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckdldERlc2lyZWRTaXplKGNvbnRyb2xsZXIpOwogIGlmIChkZXNpcmVkU2l6ZSA+IDApIHsKICAgcmV0dXJuIHRydWU7CiAgfQogIHJldHVybiBmYWxzZTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDbGVhckFsZ29yaXRobXMoY29udHJvbGxlcikgewogIGNvbnRyb2xsZXIuX3B1bGxBbGdvcml0aG0gPSB1bmRlZmluZWQ7CiAgY29udHJvbGxlci5fY2FuY2VsQWxnb3JpdGhtID0gdW5kZWZpbmVkOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckNsb3NlKGNvbnRyb2xsZXIpIHsKICB2YXIgc3RyZWFtID0gY29udHJvbGxlci5fY29udHJvbGxlZFJlYWRhYmxlQnl0ZVN0cmVhbTsKICBpZiAoY29udHJvbGxlci5fcXVldWVUb3RhbFNpemUgPiAwKSB7CiAgIGNvbnRyb2xsZXIuX2Nsb3NlUmVxdWVzdGVkID0gdHJ1ZTsKICAgcmV0dXJuOwogIH0KICBpZiAoY29udHJvbGxlci5fcGVuZGluZ1B1bGxJbnRvcy5sZW5ndGggPiAwKSB7CiAgIHZhciBmaXJzdFBlbmRpbmdQdWxsSW50byA9IGNvbnRyb2xsZXIuX3BlbmRpbmdQdWxsSW50b3MucGVlaygpOwogICBpZiAoZmlyc3RQZW5kaW5nUHVsbEludG8uYnl0ZXNGaWxsZWQgPiAwKSB7CiAgICB2YXIgZSA9IG5ldyBUeXBlRXJyb3IoJ0luc3VmZmljaWVudCBieXRlcyB0byBmaWxsIGVsZW1lbnRzIGluIHRoZSBnaXZlbiBidWZmZXInKTsKICAgIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJFcnJvcihjb250cm9sbGVyLCBlKTsKICAgIHRocm93IGU7CiAgIH0KICB9CiAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckNsZWFyQWxnb3JpdGhtcyhjb250cm9sbGVyKTsKICBSZWFkYWJsZVN0cmVhbUNsb3NlKHN0cmVhbSk7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRW5xdWV1ZShjb250cm9sbGVyLCBjaHVuaykgewogIHZhciBzdHJlYW0gPSBjb250cm9sbGVyLl9jb250cm9sbGVkUmVhZGFibGVCeXRlU3RyZWFtOwogIHZhciBidWZmZXIgPSBjaHVuay5idWZmZXI7CiAgdmFyIGJ5dGVPZmZzZXQgPSBjaHVuay5ieXRlT2Zmc2V0OwogIHZhciBieXRlTGVuZ3RoID0gY2h1bmsuYnl0ZUxlbmd0aDsKICB2YXIgdHJhbnNmZXJyZWRCdWZmZXIgPSBUcmFuc2ZlckFycmF5QnVmZmVyKGJ1ZmZlcik7CiAgaWYgKFJlYWRhYmxlU3RyZWFtSGFzRGVmYXVsdFJlYWRlcihzdHJlYW0pID09PSB0cnVlKSB7CiAgIGlmIChSZWFkYWJsZVN0cmVhbUdldE51bVJlYWRSZXF1ZXN0cyhzdHJlYW0pID09PSAwKSB7CiAgICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRW5xdWV1ZUNodW5rVG9RdWV1ZShjb250cm9sbGVyLCB0cmFuc2ZlcnJlZEJ1ZmZlciwgYnl0ZU9mZnNldCwgYnl0ZUxlbmd0aCk7CiAgIH0gZWxzZSB7CiAgICB2YXIgdHJhbnNmZXJyZWRWaWV3ID0gbmV3IFVpbnQ4QXJyYXkodHJhbnNmZXJyZWRCdWZmZXIsIGJ5dGVPZmZzZXQsIGJ5dGVMZW5ndGgpOwogICAgUmVhZGFibGVTdHJlYW1GdWxmaWxsUmVhZFJlcXVlc3Qoc3RyZWFtLCB0cmFuc2ZlcnJlZFZpZXcsIGZhbHNlKTsKICAgfQogIH0gZWxzZSBpZiAoUmVhZGFibGVTdHJlYW1IYXNCWU9CUmVhZGVyKHN0cmVhbSkgPT09IHRydWUpIHsKICAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckVucXVldWVDaHVua1RvUXVldWUoY29udHJvbGxlciwgdHJhbnNmZXJyZWRCdWZmZXIsIGJ5dGVPZmZzZXQsIGJ5dGVMZW5ndGgpOwogICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyUHJvY2Vzc1B1bGxJbnRvRGVzY3JpcHRvcnNVc2luZ1F1ZXVlKGNvbnRyb2xsZXIpOwogIH0gZWxzZSB7CiAgIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJFbnF1ZXVlQ2h1bmtUb1F1ZXVlKGNvbnRyb2xsZXIsIHRyYW5zZmVycmVkQnVmZmVyLCBieXRlT2Zmc2V0LCBieXRlTGVuZ3RoKTsKICB9CiAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckNhbGxQdWxsSWZOZWVkZWQoY29udHJvbGxlcik7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRXJyb3IoY29udHJvbGxlciwgZSkgewogIHZhciBzdHJlYW0gPSBjb250cm9sbGVyLl9jb250cm9sbGVkUmVhZGFibGVCeXRlU3RyZWFtOwogIGlmIChzdHJlYW0uX3N0YXRlICE9PSAncmVhZGFibGUnKSB7CiAgIHJldHVybjsKICB9CiAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckNsZWFyUGVuZGluZ1B1bGxJbnRvcyhjb250cm9sbGVyKTsKICBSZXNldFF1ZXVlKGNvbnRyb2xsZXIpOwogIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJDbGVhckFsZ29yaXRobXMoY29udHJvbGxlcik7CiAgUmVhZGFibGVTdHJlYW1FcnJvcihzdHJlYW0sIGUpOwogfQogZnVuY3Rpb24gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckdldERlc2lyZWRTaXplKGNvbnRyb2xsZXIpIHsKICB2YXIgc3RyZWFtID0gY29udHJvbGxlci5fY29udHJvbGxlZFJlYWRhYmxlQnl0ZVN0cmVhbTsKICB2YXIgc3RhdGUgPSBzdHJlYW0uX3N0YXRlOwogIGlmIChzdGF0ZSA9PT0gJ2Vycm9yZWQnKSB7CiAgIHJldHVybiBudWxsOwogIH0KICBpZiAoc3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgIHJldHVybiAwOwogIH0KICByZXR1cm4gY29udHJvbGxlci5fc3RyYXRlZ3lIV00gLSBjb250cm9sbGVyLl9xdWV1ZVRvdGFsU2l6ZTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJSZXNwb25kKGNvbnRyb2xsZXIsIGJ5dGVzV3JpdHRlbikgewogIGJ5dGVzV3JpdHRlbiA9IE51bWJlcihieXRlc1dyaXR0ZW4pOwogIGlmIChJc0Zpbml0ZU5vbk5lZ2F0aXZlTnVtYmVyKGJ5dGVzV3JpdHRlbikgPT09IGZhbHNlKSB7CiAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdieXRlc1dyaXR0ZW4gbXVzdCBiZSBhIGZpbml0ZScpOwogIH0KICBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyUmVzcG9uZEludGVybmFsKGNvbnRyb2xsZXIsIGJ5dGVzV3JpdHRlbik7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyUmVzcG9uZFdpdGhOZXdWaWV3KGNvbnRyb2xsZXIsIHZpZXcpIHsKICB2YXIgZmlyc3REZXNjcmlwdG9yID0gY29udHJvbGxlci5fcGVuZGluZ1B1bGxJbnRvcy5wZWVrKCk7CiAgaWYgKGZpcnN0RGVzY3JpcHRvci5ieXRlT2Zmc2V0ICsgZmlyc3REZXNjcmlwdG9yLmJ5dGVzRmlsbGVkICE9PSB2aWV3LmJ5dGVPZmZzZXQpIHsKICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSByZWdpb24gc3BlY2lmaWVkIGJ5IHZpZXcgZG9lcyBub3QgbWF0Y2ggYnlvYlJlcXVlc3QnKTsKICB9CiAgaWYgKGZpcnN0RGVzY3JpcHRvci5ieXRlTGVuZ3RoICE9PSB2aWV3LmJ5dGVMZW5ndGgpIHsKICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSBidWZmZXIgb2YgdmlldyBoYXMgZGlmZmVyZW50IGNhcGFjaXR5IHRoYW4gYnlvYlJlcXVlc3QnKTsKICB9CiAgZmlyc3REZXNjcmlwdG9yLmJ1ZmZlciA9IHZpZXcuYnVmZmVyOwogIFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJSZXNwb25kSW50ZXJuYWwoY29udHJvbGxlciwgdmlldy5ieXRlTGVuZ3RoKTsKIH0KIGZ1bmN0aW9uIFNldFVwUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlcihzdHJlYW0sIGNvbnRyb2xsZXIsIHN0YXJ0QWxnb3JpdGhtLCBwdWxsQWxnb3JpdGhtLCBjYW5jZWxBbGdvcml0aG0sIGhpZ2hXYXRlck1hcmssIGF1dG9BbGxvY2F0ZUNodW5rU2l6ZSkgewogIGNvbnRyb2xsZXIuX2NvbnRyb2xsZWRSZWFkYWJsZUJ5dGVTdHJlYW0gPSBzdHJlYW07CiAgY29udHJvbGxlci5fcHVsbEFnYWluID0gZmFsc2U7CiAgY29udHJvbGxlci5fcHVsbGluZyA9IGZhbHNlOwogIGNvbnRyb2xsZXIuX2J5b2JSZXF1ZXN0ID0gdW5kZWZpbmVkOwogIGNvbnRyb2xsZXIuX3F1ZXVlID0gY29udHJvbGxlci5fcXVldWVUb3RhbFNpemUgPSB1bmRlZmluZWQ7CiAgUmVzZXRRdWV1ZShjb250cm9sbGVyKTsKICBjb250cm9sbGVyLl9jbG9zZVJlcXVlc3RlZCA9IGZhbHNlOwogIGNvbnRyb2xsZXIuX3N0YXJ0ZWQgPSBmYWxzZTsKICBjb250cm9sbGVyLl9zdHJhdGVneUhXTSA9IFZhbGlkYXRlQW5kTm9ybWFsaXplSGlnaFdhdGVyTWFyayhoaWdoV2F0ZXJNYXJrKTsKICBjb250cm9sbGVyLl9wdWxsQWxnb3JpdGhtID0gcHVsbEFsZ29yaXRobTsKICBjb250cm9sbGVyLl9jYW5jZWxBbGdvcml0aG0gPSBjYW5jZWxBbGdvcml0aG07CiAgY29udHJvbGxlci5fYXV0b0FsbG9jYXRlQ2h1bmtTaXplID0gYXV0b0FsbG9jYXRlQ2h1bmtTaXplOwogIGNvbnRyb2xsZXIuX3BlbmRpbmdQdWxsSW50b3MgPSBuZXcgU2ltcGxlUXVldWUoKTsKICBzdHJlYW0uX3JlYWRhYmxlU3RyZWFtQ29udHJvbGxlciA9IGNvbnRyb2xsZXI7CiAgdmFyIHN0YXJ0UmVzdWx0ID0gc3RhcnRBbGdvcml0aG0oKTsKICB1cG9uUHJvbWlzZShwcm9taXNlUmVzb2x2ZWRXaXRoKHN0YXJ0UmVzdWx0KSwgZnVuY3Rpb24gKCkgewogICBjb250cm9sbGVyLl9zdGFydGVkID0gdHJ1ZTsKICAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckNhbGxQdWxsSWZOZWVkZWQoY29udHJvbGxlcik7CiAgfSwgZnVuY3Rpb24gKHIpIHsKICAgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlckVycm9yKGNvbnRyb2xsZXIsIHIpOwogIH0pOwogfQogZnVuY3Rpb24gU2V0VXBSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyRnJvbVVuZGVybHlpbmdTb3VyY2Uoc3RyZWFtLCB1bmRlcmx5aW5nQnl0ZVNvdXJjZSwgaGlnaFdhdGVyTWFyaykgewogIHZhciBjb250cm9sbGVyID0gT2JqZWN0LmNyZWF0ZShSZWFkYWJsZUJ5dGVTdHJlYW1Db250cm9sbGVyLnByb3RvdHlwZSk7CiAgZnVuY3Rpb24gc3RhcnRBbGdvcml0aG0oKSB7CiAgIHJldHVybiBJbnZva2VPck5vb3AodW5kZXJseWluZ0J5dGVTb3VyY2UsICdzdGFydCcsIFtjb250cm9sbGVyXSk7CiAgfQogIHZhciBwdWxsQWxnb3JpdGhtID0gQ3JlYXRlQWxnb3JpdGhtRnJvbVVuZGVybHlpbmdNZXRob2QodW5kZXJseWluZ0J5dGVTb3VyY2UsICdwdWxsJywgMCwgW2NvbnRyb2xsZXJdKTsKICB2YXIgY2FuY2VsQWxnb3JpdGhtID0gQ3JlYXRlQWxnb3JpdGhtRnJvbVVuZGVybHlpbmdNZXRob2QodW5kZXJseWluZ0J5dGVTb3VyY2UsICdjYW5jZWwnLCAxLCBbXSk7CiAgdmFyIGF1dG9BbGxvY2F0ZUNodW5rU2l6ZSA9IHVuZGVybHlpbmdCeXRlU291cmNlLmF1dG9BbGxvY2F0ZUNodW5rU2l6ZTsKICBpZiAoYXV0b0FsbG9jYXRlQ2h1bmtTaXplICE9PSB1bmRlZmluZWQpIHsKICAgYXV0b0FsbG9jYXRlQ2h1bmtTaXplID0gTnVtYmVyKGF1dG9BbGxvY2F0ZUNodW5rU2l6ZSk7CiAgIGlmIChOdW1iZXJJc0ludGVnZXIoYXV0b0FsbG9jYXRlQ2h1bmtTaXplKSA9PT0gZmFsc2UgfHwgYXV0b0FsbG9jYXRlQ2h1bmtTaXplIDw9IDApIHsKICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdhdXRvQWxsb2NhdGVDaHVua1NpemUgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXInKTsKICAgfQogIH0KICBTZXRVcFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIoc3RyZWFtLCBjb250cm9sbGVyLCBzdGFydEFsZ29yaXRobSwgcHVsbEFsZ29yaXRobSwgY2FuY2VsQWxnb3JpdGhtLCBoaWdoV2F0ZXJNYXJrLCBhdXRvQWxsb2NhdGVDaHVua1NpemUpOwogfQogZnVuY3Rpb24gU2V0VXBSZWFkYWJsZVN0cmVhbUJZT0JSZXF1ZXN0KHJlcXVlc3QsIGNvbnRyb2xsZXIsIHZpZXcpIHsKICByZXF1ZXN0Ll9hc3NvY2lhdGVkUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlciA9IGNvbnRyb2xsZXI7CiAgcmVxdWVzdC5fdmlldyA9IHZpZXc7CiB9CiBmdW5jdGlvbiBieW9iUmVxdWVzdEJyYW5kQ2hlY2tFeGNlcHRpb24obmFtZSkgewogIHJldHVybiBuZXcgVHlwZUVycm9yKCJSZWFkYWJsZVN0cmVhbUJZT0JSZXF1ZXN0LnByb3RvdHlwZS4iICsgbmFtZSArICIgY2FuIG9ubHkgYmUgdXNlZCBvbiBhIFJlYWRhYmxlU3RyZWFtQllPQlJlcXVlc3QiKTsKIH0KIGZ1bmN0aW9uIGJ5dGVTdHJlYW1Db250cm9sbGVyQnJhbmRDaGVja0V4Y2VwdGlvbihuYW1lKSB7CiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoIlJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIucHJvdG90eXBlLiIgKyBuYW1lICsgIiBjYW4gb25seSBiZSB1c2VkIG9uIGEgUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlciIpOwogfQogZnVuY3Rpb24gQWNxdWlyZVJlYWRhYmxlU3RyZWFtQllPQlJlYWRlcihzdHJlYW0sIGZvckF1dGhvckNvZGUpIHsKICBpZiAoZm9yQXV0aG9yQ29kZSA9PT0gdm9pZCAwKSB7CiAgIGZvckF1dGhvckNvZGUgPSBmYWxzZTsKICB9CiAgdmFyIHJlYWRlciA9IG5ldyBSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXIoc3RyZWFtKTsKICByZWFkZXIuX2ZvckF1dGhvckNvZGUgPSBmb3JBdXRob3JDb2RlOwogIHJldHVybiByZWFkZXI7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbUFkZFJlYWRJbnRvUmVxdWVzdChzdHJlYW0pIHsKICB2YXIgcHJvbWlzZSA9IG5ld1Byb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICB2YXIgcmVhZEludG9SZXF1ZXN0ID0gewogICAgX3Jlc29sdmU6IHJlc29sdmUsCiAgICBfcmVqZWN0OiByZWplY3QKICAgfTsKICAgc3RyZWFtLl9yZWFkZXIuX3JlYWRJbnRvUmVxdWVzdHMucHVzaChyZWFkSW50b1JlcXVlc3QpOwogIH0pOwogIHJldHVybiBwcm9taXNlOwogfQogZnVuY3Rpb24gUmVhZGFibGVTdHJlYW1GdWxmaWxsUmVhZEludG9SZXF1ZXN0KHN0cmVhbSwgY2h1bmssIGRvbmUpIHsKICB2YXIgcmVhZGVyID0gc3RyZWFtLl9yZWFkZXI7CiAgdmFyIHJlYWRJbnRvUmVxdWVzdCA9IHJlYWRlci5fcmVhZEludG9SZXF1ZXN0cy5zaGlmdCgpOwogIHJlYWRJbnRvUmVxdWVzdC5fcmVzb2x2ZShSZWFkYWJsZVN0cmVhbUNyZWF0ZVJlYWRSZXN1bHQoY2h1bmssIGRvbmUsIHJlYWRlci5fZm9yQXV0aG9yQ29kZSkpOwogfQogZnVuY3Rpb24gUmVhZGFibGVTdHJlYW1HZXROdW1SZWFkSW50b1JlcXVlc3RzKHN0cmVhbSkgewogIHJldHVybiBzdHJlYW0uX3JlYWRlci5fcmVhZEludG9SZXF1ZXN0cy5sZW5ndGg7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbUhhc0JZT0JSZWFkZXIoc3RyZWFtKSB7CiAgdmFyIHJlYWRlciA9IHN0cmVhbS5fcmVhZGVyOwogIGlmIChyZWFkZXIgPT09IHVuZGVmaW5lZCkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmICghSXNSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXIocmVhZGVyKSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwogfQogdmFyIFJlYWRhYmxlU3RyZWFtQllPQlJlYWRlciA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXIoc3RyZWFtKSB7CiAgIGlmICghSXNSZWFkYWJsZVN0cmVhbShzdHJlYW0pKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXIgY2FuIG9ubHkgYmUgY29uc3RydWN0ZWQgd2l0aCBhIFJlYWRhYmxlU3RyZWFtIGluc3RhbmNlIGdpdmVuIGEgJyArICdieXRlIHNvdXJjZScpOwogICB9CiAgIGlmIChJc1JlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXIoc3RyZWFtLl9yZWFkYWJsZVN0cmVhbUNvbnRyb2xsZXIpID09PSBmYWxzZSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnN0cnVjdCBhIFJlYWRhYmxlU3RyZWFtQllPQlJlYWRlciBmb3IgYSBzdHJlYW0gbm90IGNvbnN0cnVjdGVkIHdpdGggYSBieXRlICcgKyAnc291cmNlJyk7CiAgIH0KICAgaWYgKElzUmVhZGFibGVTdHJlYW1Mb2NrZWQoc3RyZWFtKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVGhpcyBzdHJlYW0gaGFzIGFscmVhZHkgYmVlbiBsb2NrZWQgZm9yIGV4Y2x1c2l2ZSByZWFkaW5nIGJ5IGFub3RoZXIgcmVhZGVyJyk7CiAgIH0KICAgUmVhZGFibGVTdHJlYW1SZWFkZXJHZW5lcmljSW5pdGlhbGl6ZSh0aGlzLCBzdHJlYW0pOwogICB0aGlzLl9yZWFkSW50b1JlcXVlc3RzID0gbmV3IFNpbXBsZVF1ZXVlKCk7CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXIucHJvdG90eXBlLCAiY2xvc2VkIiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmICghSXNSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXIodGhpcykpIHsKICAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChieW9iUmVhZGVyQnJhbmRDaGVja0V4Y2VwdGlvbignY2xvc2VkJykpOwogICAgfQogICAgcmV0dXJuIHRoaXMuX2Nsb3NlZFByb21pc2U7CiAgIH0sCiAgIGVudW1lcmFibGU6IHRydWUsCiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwogIFJlYWRhYmxlU3RyZWFtQllPQlJlYWRlci5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKHJlYXNvbikgewogICBpZiAoIUlzUmVhZGFibGVTdHJlYW1CWU9CUmVhZGVyKHRoaXMpKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChieW9iUmVhZGVyQnJhbmRDaGVja0V4Y2VwdGlvbignY2FuY2VsJykpOwogICB9CiAgIGlmICh0aGlzLl9vd25lclJlYWRhYmxlU3RyZWFtID09PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKHJlYWRlckxvY2tFeGNlcHRpb24oJ2NhbmNlbCcpKTsKICAgfQogICByZXR1cm4gUmVhZGFibGVTdHJlYW1SZWFkZXJHZW5lcmljQ2FuY2VsKHRoaXMsIHJlYXNvbik7CiAgfTsKICBSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXIucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbiAodmlldykgewogICBpZiAoIUlzUmVhZGFibGVTdHJlYW1CWU9CUmVhZGVyKHRoaXMpKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChieW9iUmVhZGVyQnJhbmRDaGVja0V4Y2VwdGlvbigncmVhZCcpKTsKICAgfQogICBpZiAodGhpcy5fb3duZXJSZWFkYWJsZVN0cmVhbSA9PT0gdW5kZWZpbmVkKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChyZWFkZXJMb2NrRXhjZXB0aW9uKCdyZWFkIGZyb20nKSk7CiAgIH0KICAgaWYgKCFBcnJheUJ1ZmZlci5pc1ZpZXcodmlldykpIHsKICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKG5ldyBUeXBlRXJyb3IoJ3ZpZXcgbXVzdCBiZSBhbiBhcnJheSBidWZmZXIgdmlldycpKTsKICAgfQogICBpZiAoSXNEZXRhY2hlZEJ1ZmZlcih2aWV3LmJ1ZmZlcikgPT09IHRydWUpOwogICBpZiAodmlldy5ieXRlTGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChuZXcgVHlwZUVycm9yKCd2aWV3IG11c3QgaGF2ZSBub24temVybyBieXRlTGVuZ3RoJykpOwogICB9CiAgIHJldHVybiBSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXJSZWFkKHRoaXMsIHZpZXcpOwogIH07CiAgUmVhZGFibGVTdHJlYW1CWU9CUmVhZGVyLnByb3RvdHlwZS5yZWxlYXNlTG9jayA9IGZ1bmN0aW9uICgpIHsKICAgaWYgKCFJc1JlYWRhYmxlU3RyZWFtQllPQlJlYWRlcih0aGlzKSkgewogICAgdGhyb3cgYnlvYlJlYWRlckJyYW5kQ2hlY2tFeGNlcHRpb24oJ3JlbGVhc2VMb2NrJyk7CiAgIH0KICAgaWYgKHRoaXMuX293bmVyUmVhZGFibGVTdHJlYW0gPT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuOwogICB9CiAgIGlmICh0aGlzLl9yZWFkSW50b1JlcXVlc3RzLmxlbmd0aCA+IDApIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RyaWVkIHRvIHJlbGVhc2UgYSByZWFkZXIgbG9jayB3aGVuIHRoYXQgcmVhZGVyIGhhcyBwZW5kaW5nIHJlYWQoKSBjYWxscyB1bi1zZXR0bGVkJyk7CiAgIH0KICAgUmVhZGFibGVTdHJlYW1SZWFkZXJHZW5lcmljUmVsZWFzZSh0aGlzKTsKICB9OwogIHJldHVybiBSZWFkYWJsZVN0cmVhbUJZT0JSZWFkZXI7CiB9KCk7CiBmdW5jdGlvbiBJc1JlYWRhYmxlU3RyZWFtQllPQlJlYWRlcih4KSB7CiAgaWYgKCF0eXBlSXNPYmplY3QoeCkpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCAnX3JlYWRJbnRvUmVxdWVzdHMnKSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIHJldHVybiB0cnVlOwogfQogZnVuY3Rpb24gUmVhZGFibGVTdHJlYW1CWU9CUmVhZGVyUmVhZChyZWFkZXIsIHZpZXcpIHsKICB2YXIgc3RyZWFtID0gcmVhZGVyLl9vd25lclJlYWRhYmxlU3RyZWFtOwogIHN0cmVhbS5fZGlzdHVyYmVkID0gdHJ1ZTsKICBpZiAoc3RyZWFtLl9zdGF0ZSA9PT0gJ2Vycm9yZWQnKSB7CiAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKHN0cmVhbS5fc3RvcmVkRXJyb3IpOwogIH0KICByZXR1cm4gUmVhZGFibGVCeXRlU3RyZWFtQ29udHJvbGxlclB1bGxJbnRvKHN0cmVhbS5fcmVhZGFibGVTdHJlYW1Db250cm9sbGVyLCB2aWV3KTsKIH0KIGZ1bmN0aW9uIGJ5b2JSZWFkZXJCcmFuZENoZWNrRXhjZXB0aW9uKG5hbWUpIHsKICByZXR1cm4gbmV3IFR5cGVFcnJvcigiUmVhZGFibGVTdHJlYW1CWU9CUmVhZGVyLnByb3RvdHlwZS4iICsgbmFtZSArICIgY2FuIG9ubHkgYmUgdXNlZCBvbiBhIFJlYWRhYmxlU3RyZWFtQllPQlJlYWRlciIpOwogfQogdmFyIFJlYWRhYmxlU3RyZWFtID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtKHVuZGVybHlpbmdTb3VyY2UsIHN0cmF0ZWd5KSB7CiAgIGlmICh1bmRlcmx5aW5nU291cmNlID09PSB2b2lkIDApIHsKICAgIHVuZGVybHlpbmdTb3VyY2UgPSB7fTsKICAgfQogICBpZiAoc3RyYXRlZ3kgPT09IHZvaWQgMCkgewogICAgc3RyYXRlZ3kgPSB7fTsKICAgfQogICBJbml0aWFsaXplUmVhZGFibGVTdHJlYW0odGhpcyk7CiAgIHZhciBzaXplID0gc3RyYXRlZ3kuc2l6ZTsKICAgdmFyIGhpZ2hXYXRlck1hcmsgPSBzdHJhdGVneS5oaWdoV2F0ZXJNYXJrOwogICB2YXIgdHlwZSA9IHVuZGVybHlpbmdTb3VyY2UudHlwZTsKICAgdmFyIHR5cGVTdHJpbmcgPSBTdHJpbmcodHlwZSk7CiAgIGlmICh0eXBlU3RyaW5nID09PSAnYnl0ZXMnKSB7CiAgICBpZiAoc2l6ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RoZSBzdHJhdGVneSBmb3IgYSBieXRlIHN0cmVhbSBjYW5ub3QgaGF2ZSBhIHNpemUgZnVuY3Rpb24nKTsKICAgIH0KICAgIGlmIChoaWdoV2F0ZXJNYXJrID09PSB1bmRlZmluZWQpIHsKICAgICBoaWdoV2F0ZXJNYXJrID0gMDsKICAgIH0KICAgIGhpZ2hXYXRlck1hcmsgPSBWYWxpZGF0ZUFuZE5vcm1hbGl6ZUhpZ2hXYXRlck1hcmsoaGlnaFdhdGVyTWFyayk7CiAgICBTZXRVcFJlYWRhYmxlQnl0ZVN0cmVhbUNvbnRyb2xsZXJGcm9tVW5kZXJseWluZ1NvdXJjZSh0aGlzLCB1bmRlcmx5aW5nU291cmNlLCBoaWdoV2F0ZXJNYXJrKTsKICAgfSBlbHNlIGlmICh0eXBlID09PSB1bmRlZmluZWQpIHsKICAgIHZhciBzaXplQWxnb3JpdGhtID0gTWFrZVNpemVBbGdvcml0aG1Gcm9tU2l6ZUZ1bmN0aW9uKHNpemUpOwogICAgaWYgKGhpZ2hXYXRlck1hcmsgPT09IHVuZGVmaW5lZCkgewogICAgIGhpZ2hXYXRlck1hcmsgPSAxOwogICAgfQogICAgaGlnaFdhdGVyTWFyayA9IFZhbGlkYXRlQW5kTm9ybWFsaXplSGlnaFdhdGVyTWFyayhoaWdoV2F0ZXJNYXJrKTsKICAgIFNldFVwUmVhZGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckZyb21VbmRlcmx5aW5nU291cmNlKHRoaXMsIHVuZGVybHlpbmdTb3VyY2UsIGhpZ2hXYXRlck1hcmssIHNpemVBbGdvcml0aG0pOwogICB9IGVsc2UgewogICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZSBpcyBzcGVjaWZpZWQnKTsKICAgfQogIH0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLCAibG9ja2VkIiwgewogICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmIChJc1JlYWRhYmxlU3RyZWFtKHRoaXMpID09PSBmYWxzZSkgewogICAgIHRocm93IHN0cmVhbUJyYW5kQ2hlY2tFeGNlcHRpb24kMSgnbG9ja2VkJyk7CiAgICB9CiAgICByZXR1cm4gSXNSZWFkYWJsZVN0cmVhbUxvY2tlZCh0aGlzKTsKICAgfSwKICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgY29uZmlndXJhYmxlOiB0cnVlCiAgfSk7CiAgUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uIChyZWFzb24pIHsKICAgaWYgKElzUmVhZGFibGVTdHJlYW0odGhpcykgPT09IGZhbHNlKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChzdHJlYW1CcmFuZENoZWNrRXhjZXB0aW9uJDEoJ2NhbmNlbCcpKTsKICAgfQogICBpZiAoSXNSZWFkYWJsZVN0cmVhbUxvY2tlZCh0aGlzKSA9PT0gdHJ1ZSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgobmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbmNlbCBhIHN0cmVhbSB0aGF0IGFscmVhZHkgaGFzIGEgcmVhZGVyJykpOwogICB9CiAgIHJldHVybiBSZWFkYWJsZVN0cmVhbUNhbmNlbCh0aGlzLCByZWFzb24pOwogIH07CiAgUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLmdldFJlYWRlciA9IGZ1bmN0aW9uIChfYSkgewogICB2YXIgbW9kZSA9IChfYSA9PT0gdm9pZCAwID8ge30gOiBfYSkubW9kZTsKICAgaWYgKElzUmVhZGFibGVTdHJlYW0odGhpcykgPT09IGZhbHNlKSB7CiAgICB0aHJvdyBzdHJlYW1CcmFuZENoZWNrRXhjZXB0aW9uJDEoJ2dldFJlYWRlcicpOwogICB9CiAgIGlmIChtb2RlID09PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBBY3F1aXJlUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyKHRoaXMsIHRydWUpOwogICB9CiAgIG1vZGUgPSBTdHJpbmcobW9kZSk7CiAgIGlmIChtb2RlID09PSAnYnlvYicpIHsKICAgIHJldHVybiBBY3F1aXJlUmVhZGFibGVTdHJlYW1CWU9CUmVhZGVyKHRoaXMsIHRydWUpOwogICB9CiAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIG1vZGUgaXMgc3BlY2lmaWVkJyk7CiAgfTsKICBSZWFkYWJsZVN0cmVhbS5wcm90b3R5cGUucGlwZVRocm91Z2ggPSBmdW5jdGlvbiAoX2EsIF9iKSB7CiAgIHZhciB3cml0YWJsZSA9IF9hLndyaXRhYmxlLCByZWFkYWJsZSA9IF9hLnJlYWRhYmxlOwogICB2YXIgX2MgPSBfYiA9PT0gdm9pZCAwID8ge30gOiBfYiwgcHJldmVudENsb3NlID0gX2MucHJldmVudENsb3NlLCBwcmV2ZW50QWJvcnQgPSBfYy5wcmV2ZW50QWJvcnQsIHByZXZlbnRDYW5jZWwgPSBfYy5wcmV2ZW50Q2FuY2VsLCBzaWduYWwgPSBfYy5zaWduYWw7CiAgIGlmIChJc1JlYWRhYmxlU3RyZWFtKHRoaXMpID09PSBmYWxzZSkgewogICAgdGhyb3cgc3RyZWFtQnJhbmRDaGVja0V4Y2VwdGlvbiQxKCdwaXBlVGhyb3VnaCcpOwogICB9CiAgIGlmIChJc1dyaXRhYmxlU3RyZWFtKHdyaXRhYmxlKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3dyaXRhYmxlIGFyZ3VtZW50IHRvIHBpcGVUaHJvdWdoIG11c3QgYmUgYSBXcml0YWJsZVN0cmVhbScpOwogICB9CiAgIGlmIChJc1JlYWRhYmxlU3RyZWFtKHJlYWRhYmxlKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3JlYWRhYmxlIGFyZ3VtZW50IHRvIHBpcGVUaHJvdWdoIG11c3QgYmUgYSBSZWFkYWJsZVN0cmVhbScpOwogICB9CiAgIHByZXZlbnRDbG9zZSA9IEJvb2xlYW4ocHJldmVudENsb3NlKTsKICAgcHJldmVudEFib3J0ID0gQm9vbGVhbihwcmV2ZW50QWJvcnQpOwogICBwcmV2ZW50Q2FuY2VsID0gQm9vbGVhbihwcmV2ZW50Q2FuY2VsKTsKICAgaWYgKHNpZ25hbCAhPT0gdW5kZWZpbmVkICYmICFpc0Fib3J0U2lnbmFsKHNpZ25hbCkpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1JlYWRhYmxlU3RyZWFtLnByb3RvdHlwZS5waXBlVGhyb3VnaFwncyBzaWduYWwgb3B0aW9uIG11c3QgYmUgYW4gQWJvcnRTaWduYWwnKTsKICAgfQogICBpZiAoSXNSZWFkYWJsZVN0cmVhbUxvY2tlZCh0aGlzKSA9PT0gdHJ1ZSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLnBpcGVUaHJvdWdoIGNhbm5vdCBiZSB1c2VkIG9uIGEgbG9ja2VkIFJlYWRhYmxlU3RyZWFtJyk7CiAgIH0KICAgaWYgKElzV3JpdGFibGVTdHJlYW1Mb2NrZWQod3JpdGFibGUpID09PSB0cnVlKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdSZWFkYWJsZVN0cmVhbS5wcm90b3R5cGUucGlwZVRocm91Z2ggY2Fubm90IGJlIHVzZWQgb24gYSBsb2NrZWQgV3JpdGFibGVTdHJlYW0nKTsKICAgfQogICB2YXIgcHJvbWlzZSA9IFJlYWRhYmxlU3RyZWFtUGlwZVRvKHRoaXMsIHdyaXRhYmxlLCBwcmV2ZW50Q2xvc2UsIHByZXZlbnRBYm9ydCwgcHJldmVudENhbmNlbCwgc2lnbmFsKTsKICAgc2V0UHJvbWlzZUlzSGFuZGxlZFRvVHJ1ZShwcm9taXNlKTsKICAgcmV0dXJuIHJlYWRhYmxlOwogIH07CiAgUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLnBpcGVUbyA9IGZ1bmN0aW9uIChkZXN0LCBfYSkgewogICB2YXIgX2IgPSBfYSA9PT0gdm9pZCAwID8ge30gOiBfYSwgcHJldmVudENsb3NlID0gX2IucHJldmVudENsb3NlLCBwcmV2ZW50QWJvcnQgPSBfYi5wcmV2ZW50QWJvcnQsIHByZXZlbnRDYW5jZWwgPSBfYi5wcmV2ZW50Q2FuY2VsLCBzaWduYWwgPSBfYi5zaWduYWw7CiAgIGlmIChJc1JlYWRhYmxlU3RyZWFtKHRoaXMpID09PSBmYWxzZSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgoc3RyZWFtQnJhbmRDaGVja0V4Y2VwdGlvbiQxKCdwaXBlVG8nKSk7CiAgIH0KICAgaWYgKElzV3JpdGFibGVTdHJlYW0oZGVzdCkgPT09IGZhbHNlKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChuZXcgVHlwZUVycm9yKCdSZWFkYWJsZVN0cmVhbS5wcm90b3R5cGUucGlwZVRvXCdzIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBXcml0YWJsZVN0cmVhbScpKTsKICAgfQogICBwcmV2ZW50Q2xvc2UgPSBCb29sZWFuKHByZXZlbnRDbG9zZSk7CiAgIHByZXZlbnRBYm9ydCA9IEJvb2xlYW4ocHJldmVudEFib3J0KTsKICAgcHJldmVudENhbmNlbCA9IEJvb2xlYW4ocHJldmVudENhbmNlbCk7CiAgIGlmIChzaWduYWwgIT09IHVuZGVmaW5lZCAmJiAhaXNBYm9ydFNpZ25hbChzaWduYWwpKSB7CiAgICByZXR1cm4gcHJvbWlzZVJlamVjdGVkV2l0aChuZXcgVHlwZUVycm9yKCdSZWFkYWJsZVN0cmVhbS5wcm90b3R5cGUucGlwZVRvXCdzIHNpZ25hbCBvcHRpb24gbXVzdCBiZSBhbiBBYm9ydFNpZ25hbCcpKTsKICAgfQogICBpZiAoSXNSZWFkYWJsZVN0cmVhbUxvY2tlZCh0aGlzKSA9PT0gdHJ1ZSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgobmV3IFR5cGVFcnJvcignUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLnBpcGVUbyBjYW5ub3QgYmUgdXNlZCBvbiBhIGxvY2tlZCBSZWFkYWJsZVN0cmVhbScpKTsKICAgfQogICBpZiAoSXNXcml0YWJsZVN0cmVhbUxvY2tlZChkZXN0KSA9PT0gdHJ1ZSkgewogICAgcmV0dXJuIHByb21pc2VSZWplY3RlZFdpdGgobmV3IFR5cGVFcnJvcignUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLnBpcGVUbyBjYW5ub3QgYmUgdXNlZCBvbiBhIGxvY2tlZCBXcml0YWJsZVN0cmVhbScpKTsKICAgfQogICByZXR1cm4gUmVhZGFibGVTdHJlYW1QaXBlVG8odGhpcywgZGVzdCwgcHJldmVudENsb3NlLCBwcmV2ZW50QWJvcnQsIHByZXZlbnRDYW5jZWwsIHNpZ25hbCk7CiAgfTsKICBSZWFkYWJsZVN0cmVhbS5wcm90b3R5cGUudGVlID0gZnVuY3Rpb24gKCkgewogICBpZiAoSXNSZWFkYWJsZVN0cmVhbSh0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IHN0cmVhbUJyYW5kQ2hlY2tFeGNlcHRpb24kMSgndGVlJyk7CiAgIH0KICAgdmFyIGJyYW5jaGVzID0gUmVhZGFibGVTdHJlYW1UZWUodGhpcyk7CiAgIHJldHVybiBjcmVhdGVBcnJheUZyb21MaXN0KGJyYW5jaGVzKTsKICB9OwogIFJlYWRhYmxlU3RyZWFtLnByb3RvdHlwZS5nZXRJdGVyYXRvciA9IGZ1bmN0aW9uIChfYSkgewogICB2YXIgX2IgPSAoX2EgPT09IHZvaWQgMCA/IHt9IDogX2EpLnByZXZlbnRDYW5jZWwsIHByZXZlbnRDYW5jZWwgPSBfYiA9PT0gdm9pZCAwID8gZmFsc2UgOiBfYjsKICAgaWYgKElzUmVhZGFibGVTdHJlYW0odGhpcykgPT09IGZhbHNlKSB7CiAgICB0aHJvdyBzdHJlYW1CcmFuZENoZWNrRXhjZXB0aW9uJDEoJ2dldEl0ZXJhdG9yJyk7CiAgIH0KICAgcmV0dXJuIEFjcXVpcmVSZWFkYWJsZVN0cmVhbUFzeW5jSXRlcmF0b3IodGhpcywgcHJldmVudENhbmNlbCk7CiAgfTsKICByZXR1cm4gUmVhZGFibGVTdHJlYW07CiB9KCk7CiBpZiAodHlwZW9mIFN5bWJvbFBvbHlmaWxsLmFzeW5jSXRlcmF0b3IgPT09ICdzeW1ib2wnKSB7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlYWRhYmxlU3RyZWFtLnByb3RvdHlwZSwgU3ltYm9sUG9seWZpbGwuYXN5bmNJdGVyYXRvciwgewogICB2YWx1ZTogUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLmdldEl0ZXJhdG9yLAogICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgd3JpdGFibGU6IHRydWUsCiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwogfQogZnVuY3Rpb24gQ3JlYXRlUmVhZGFibGVTdHJlYW0oc3RhcnRBbGdvcml0aG0sIHB1bGxBbGdvcml0aG0sIGNhbmNlbEFsZ29yaXRobSwgaGlnaFdhdGVyTWFyaywgc2l6ZUFsZ29yaXRobSkgewogIGlmIChoaWdoV2F0ZXJNYXJrID09PSB2b2lkIDApIHsKICAgaGlnaFdhdGVyTWFyayA9IDE7CiAgfQogIGlmIChzaXplQWxnb3JpdGhtID09PSB2b2lkIDApIHsKICAgc2l6ZUFsZ29yaXRobSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAxOwogICB9OwogIH0KICB2YXIgc3RyZWFtID0gT2JqZWN0LmNyZWF0ZShSZWFkYWJsZVN0cmVhbS5wcm90b3R5cGUpOwogIEluaXRpYWxpemVSZWFkYWJsZVN0cmVhbShzdHJlYW0pOwogIHZhciBjb250cm9sbGVyID0gT2JqZWN0LmNyZWF0ZShSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZSk7CiAgU2V0VXBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyKHN0cmVhbSwgY29udHJvbGxlciwgc3RhcnRBbGdvcml0aG0sIHB1bGxBbGdvcml0aG0sIGNhbmNlbEFsZ29yaXRobSwgaGlnaFdhdGVyTWFyaywgc2l6ZUFsZ29yaXRobSk7CiAgcmV0dXJuIHN0cmVhbTsKIH0KIGZ1bmN0aW9uIEluaXRpYWxpemVSZWFkYWJsZVN0cmVhbShzdHJlYW0pIHsKICBzdHJlYW0uX3N0YXRlID0gJ3JlYWRhYmxlJzsKICBzdHJlYW0uX3JlYWRlciA9IHVuZGVmaW5lZDsKICBzdHJlYW0uX3N0b3JlZEVycm9yID0gdW5kZWZpbmVkOwogIHN0cmVhbS5fZGlzdHVyYmVkID0gZmFsc2U7CiB9CiBmdW5jdGlvbiBJc1JlYWRhYmxlU3RyZWFtKHgpIHsKICBpZiAoIXR5cGVJc09iamVjdCh4KSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdfcmVhZGFibGVTdHJlYW1Db250cm9sbGVyJykpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKIH0KIGZ1bmN0aW9uIElzUmVhZGFibGVTdHJlYW1Mb2NrZWQoc3RyZWFtKSB7CiAgaWYgKHN0cmVhbS5fcmVhZGVyID09PSB1bmRlZmluZWQpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKIH0KIGZ1bmN0aW9uIFJlYWRhYmxlU3RyZWFtQ2FuY2VsKHN0cmVhbSwgcmVhc29uKSB7CiAgc3RyZWFtLl9kaXN0dXJiZWQgPSB0cnVlOwogIGlmIChzdHJlYW0uX3N0YXRlID09PSAnY2xvc2VkJykgewogICByZXR1cm4gcHJvbWlzZVJlc29sdmVkV2l0aCh1bmRlZmluZWQpOwogIH0KICBpZiAoc3RyZWFtLl9zdGF0ZSA9PT0gJ2Vycm9yZWQnKSB7CiAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKHN0cmVhbS5fc3RvcmVkRXJyb3IpOwogIH0KICBSZWFkYWJsZVN0cmVhbUNsb3NlKHN0cmVhbSk7CiAgdmFyIHNvdXJjZUNhbmNlbFByb21pc2UgPSBzdHJlYW0uX3JlYWRhYmxlU3RyZWFtQ29udHJvbGxlcltDYW5jZWxTdGVwc10ocmVhc29uKTsKICByZXR1cm4gdHJhbnNmb3JtUHJvbWlzZVdpdGgoc291cmNlQ2FuY2VsUHJvbWlzZSwgbm9vcCk7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbUNsb3NlKHN0cmVhbSkgewogIHN0cmVhbS5fc3RhdGUgPSAnY2xvc2VkJzsKICB2YXIgcmVhZGVyID0gc3RyZWFtLl9yZWFkZXI7CiAgaWYgKHJlYWRlciA9PT0gdW5kZWZpbmVkKSB7CiAgIHJldHVybjsKICB9CiAgaWYgKElzUmVhZGFibGVTdHJlYW1EZWZhdWx0UmVhZGVyKHJlYWRlcikpIHsKICAgcmVhZGVyLl9yZWFkUmVxdWVzdHMuZm9yRWFjaChmdW5jdGlvbiAocmVhZFJlcXVlc3QpIHsKICAgIHJlYWRSZXF1ZXN0Ll9yZXNvbHZlKFJlYWRhYmxlU3RyZWFtQ3JlYXRlUmVhZFJlc3VsdCh1bmRlZmluZWQsIHRydWUsIHJlYWRlci5fZm9yQXV0aG9yQ29kZSkpOwogICB9KTsKICAgcmVhZGVyLl9yZWFkUmVxdWVzdHMgPSBuZXcgU2ltcGxlUXVldWUoKTsKICB9CiAgZGVmYXVsdFJlYWRlckNsb3NlZFByb21pc2VSZXNvbHZlKHJlYWRlcik7CiB9CiBmdW5jdGlvbiBSZWFkYWJsZVN0cmVhbUVycm9yKHN0cmVhbSwgZSkgewogIHN0cmVhbS5fc3RhdGUgPSAnZXJyb3JlZCc7CiAgc3RyZWFtLl9zdG9yZWRFcnJvciA9IGU7CiAgdmFyIHJlYWRlciA9IHN0cmVhbS5fcmVhZGVyOwogIGlmIChyZWFkZXIgPT09IHVuZGVmaW5lZCkgewogICByZXR1cm47CiAgfQogIGlmIChJc1JlYWRhYmxlU3RyZWFtRGVmYXVsdFJlYWRlcihyZWFkZXIpKSB7CiAgIHJlYWRlci5fcmVhZFJlcXVlc3RzLmZvckVhY2goZnVuY3Rpb24gKHJlYWRSZXF1ZXN0KSB7CiAgICByZWFkUmVxdWVzdC5fcmVqZWN0KGUpOwogICB9KTsKICAgcmVhZGVyLl9yZWFkUmVxdWVzdHMgPSBuZXcgU2ltcGxlUXVldWUoKTsKICB9IGVsc2UgewogICByZWFkZXIuX3JlYWRJbnRvUmVxdWVzdHMuZm9yRWFjaChmdW5jdGlvbiAocmVhZEludG9SZXF1ZXN0KSB7CiAgICByZWFkSW50b1JlcXVlc3QuX3JlamVjdChlKTsKICAgfSk7CiAgIHJlYWRlci5fcmVhZEludG9SZXF1ZXN0cyA9IG5ldyBTaW1wbGVRdWV1ZSgpOwogIH0KICBkZWZhdWx0UmVhZGVyQ2xvc2VkUHJvbWlzZVJlamVjdChyZWFkZXIsIGUpOwogfQogZnVuY3Rpb24gc3RyZWFtQnJhbmRDaGVja0V4Y2VwdGlvbiQxKG5hbWUpIHsKICByZXR1cm4gbmV3IFR5cGVFcnJvcigiUmVhZGFibGVTdHJlYW0ucHJvdG90eXBlLiIgKyBuYW1lICsgIiBjYW4gb25seSBiZSB1c2VkIG9uIGEgUmVhZGFibGVTdHJlYW0iKTsKIH0KIHZhciBCeXRlTGVuZ3RoUXVldWluZ1N0cmF0ZWd5ID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEJ5dGVMZW5ndGhRdWV1aW5nU3RyYXRlZ3koX2EpIHsKICAgdmFyIGhpZ2hXYXRlck1hcmsgPSBfYS5oaWdoV2F0ZXJNYXJrOwogICB0aGlzLmhpZ2hXYXRlck1hcmsgPSBoaWdoV2F0ZXJNYXJrOwogIH0KICBCeXRlTGVuZ3RoUXVldWluZ1N0cmF0ZWd5LnByb3RvdHlwZS5zaXplID0gZnVuY3Rpb24gKGNodW5rKSB7CiAgIHJldHVybiBjaHVuay5ieXRlTGVuZ3RoOwogIH07CiAgcmV0dXJuIEJ5dGVMZW5ndGhRdWV1aW5nU3RyYXRlZ3k7CiB9KCk7CiB2YXIgQ291bnRRdWV1aW5nU3RyYXRlZ3kgPSBmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQ291bnRRdWV1aW5nU3RyYXRlZ3koX2EpIHsKICAgdmFyIGhpZ2hXYXRlck1hcmsgPSBfYS5oaWdoV2F0ZXJNYXJrOwogICB0aGlzLmhpZ2hXYXRlck1hcmsgPSBoaWdoV2F0ZXJNYXJrOwogIH0KICBDb3VudFF1ZXVpbmdTdHJhdGVneS5wcm90b3R5cGUuc2l6ZSA9IGZ1bmN0aW9uICgpIHsKICAgcmV0dXJuIDE7CiAgfTsKICByZXR1cm4gQ291bnRRdWV1aW5nU3RyYXRlZ3k7CiB9KCk7CiB2YXIgVHJhbnNmb3JtU3RyZWFtID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFRyYW5zZm9ybVN0cmVhbSh0cmFuc2Zvcm1lciwgd3JpdGFibGVTdHJhdGVneSwgcmVhZGFibGVTdHJhdGVneSkgewogICBpZiAodHJhbnNmb3JtZXIgPT09IHZvaWQgMCkgewogICAgdHJhbnNmb3JtZXIgPSB7fTsKICAgfQogICBpZiAod3JpdGFibGVTdHJhdGVneSA9PT0gdm9pZCAwKSB7CiAgICB3cml0YWJsZVN0cmF0ZWd5ID0ge307CiAgIH0KICAgaWYgKHJlYWRhYmxlU3RyYXRlZ3kgPT09IHZvaWQgMCkgewogICAgcmVhZGFibGVTdHJhdGVneSA9IHt9OwogICB9CiAgIHZhciB3cml0YWJsZVNpemVGdW5jdGlvbiA9IHdyaXRhYmxlU3RyYXRlZ3kuc2l6ZTsKICAgdmFyIHdyaXRhYmxlSGlnaFdhdGVyTWFyayA9IHdyaXRhYmxlU3RyYXRlZ3kuaGlnaFdhdGVyTWFyazsKICAgdmFyIHJlYWRhYmxlU2l6ZUZ1bmN0aW9uID0gcmVhZGFibGVTdHJhdGVneS5zaXplOwogICB2YXIgcmVhZGFibGVIaWdoV2F0ZXJNYXJrID0gcmVhZGFibGVTdHJhdGVneS5oaWdoV2F0ZXJNYXJrOwogICB2YXIgd3JpdGFibGVUeXBlID0gdHJhbnNmb3JtZXIud3JpdGFibGVUeXBlOwogICBpZiAod3JpdGFibGVUeXBlICE9PSB1bmRlZmluZWQpIHsKICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHdyaXRhYmxlIHR5cGUgc3BlY2lmaWVkJyk7CiAgIH0KICAgdmFyIHdyaXRhYmxlU2l6ZUFsZ29yaXRobSA9IE1ha2VTaXplQWxnb3JpdGhtRnJvbVNpemVGdW5jdGlvbih3cml0YWJsZVNpemVGdW5jdGlvbik7CiAgIGlmICh3cml0YWJsZUhpZ2hXYXRlck1hcmsgPT09IHVuZGVmaW5lZCkgewogICAgd3JpdGFibGVIaWdoV2F0ZXJNYXJrID0gMTsKICAgfQogICB3cml0YWJsZUhpZ2hXYXRlck1hcmsgPSBWYWxpZGF0ZUFuZE5vcm1hbGl6ZUhpZ2hXYXRlck1hcmsod3JpdGFibGVIaWdoV2F0ZXJNYXJrKTsKICAgdmFyIHJlYWRhYmxlVHlwZSA9IHRyYW5zZm9ybWVyLnJlYWRhYmxlVHlwZTsKICAgaWYgKHJlYWRhYmxlVHlwZSAhPT0gdW5kZWZpbmVkKSB7CiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW52YWxpZCByZWFkYWJsZSB0eXBlIHNwZWNpZmllZCcpOwogICB9CiAgIHZhciByZWFkYWJsZVNpemVBbGdvcml0aG0gPSBNYWtlU2l6ZUFsZ29yaXRobUZyb21TaXplRnVuY3Rpb24ocmVhZGFibGVTaXplRnVuY3Rpb24pOwogICBpZiAocmVhZGFibGVIaWdoV2F0ZXJNYXJrID09PSB1bmRlZmluZWQpIHsKICAgIHJlYWRhYmxlSGlnaFdhdGVyTWFyayA9IDA7CiAgIH0KICAgcmVhZGFibGVIaWdoV2F0ZXJNYXJrID0gVmFsaWRhdGVBbmROb3JtYWxpemVIaWdoV2F0ZXJNYXJrKHJlYWRhYmxlSGlnaFdhdGVyTWFyayk7CiAgIHZhciBzdGFydFByb21pc2VfcmVzb2x2ZTsKICAgdmFyIHN0YXJ0UHJvbWlzZSA9IG5ld1Byb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgIHN0YXJ0UHJvbWlzZV9yZXNvbHZlID0gcmVzb2x2ZTsKICAgfSk7CiAgIEluaXRpYWxpemVUcmFuc2Zvcm1TdHJlYW0odGhpcywgc3RhcnRQcm9taXNlLCB3cml0YWJsZUhpZ2hXYXRlck1hcmssIHdyaXRhYmxlU2l6ZUFsZ29yaXRobSwgcmVhZGFibGVIaWdoV2F0ZXJNYXJrLCByZWFkYWJsZVNpemVBbGdvcml0aG0pOwogICBTZXRVcFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyRnJvbVRyYW5zZm9ybWVyKHRoaXMsIHRyYW5zZm9ybWVyKTsKICAgdmFyIHN0YXJ0UmVzdWx0ID0gSW52b2tlT3JOb29wKHRyYW5zZm9ybWVyLCAnc3RhcnQnLCBbdGhpcy5fdHJhbnNmb3JtU3RyZWFtQ29udHJvbGxlcl0pOwogICBzdGFydFByb21pc2VfcmVzb2x2ZShzdGFydFJlc3VsdCk7CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUcmFuc2Zvcm1TdHJlYW0ucHJvdG90eXBlLCAicmVhZGFibGUiLCB7CiAgIGdldDogZnVuY3Rpb24gKCkgewogICAgaWYgKElzVHJhbnNmb3JtU3RyZWFtKHRoaXMpID09PSBmYWxzZSkgewogICAgIHRocm93IHN0cmVhbUJyYW5kQ2hlY2tFeGNlcHRpb24kMigncmVhZGFibGUnKTsKICAgIH0KICAgIHJldHVybiB0aGlzLl9yZWFkYWJsZTsKICAgfSwKICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgY29uZmlndXJhYmxlOiB0cnVlCiAgfSk7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRyYW5zZm9ybVN0cmVhbS5wcm90b3R5cGUsICJ3cml0YWJsZSIsIHsKICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoSXNUcmFuc2Zvcm1TdHJlYW0odGhpcykgPT09IGZhbHNlKSB7CiAgICAgdGhyb3cgc3RyZWFtQnJhbmRDaGVja0V4Y2VwdGlvbiQyKCd3cml0YWJsZScpOwogICAgfQogICAgcmV0dXJuIHRoaXMuX3dyaXRhYmxlOwogICB9LAogICBlbnVtZXJhYmxlOiB0cnVlLAogICBjb25maWd1cmFibGU6IHRydWUKICB9KTsKICByZXR1cm4gVHJhbnNmb3JtU3RyZWFtOwogfSgpOwogZnVuY3Rpb24gSW5pdGlhbGl6ZVRyYW5zZm9ybVN0cmVhbShzdHJlYW0sIHN0YXJ0UHJvbWlzZSwgd3JpdGFibGVIaWdoV2F0ZXJNYXJrLCB3cml0YWJsZVNpemVBbGdvcml0aG0sIHJlYWRhYmxlSGlnaFdhdGVyTWFyaywgcmVhZGFibGVTaXplQWxnb3JpdGhtKSB7CiAgZnVuY3Rpb24gc3RhcnRBbGdvcml0aG0oKSB7CiAgIHJldHVybiBzdGFydFByb21pc2U7CiAgfQogIGZ1bmN0aW9uIHdyaXRlQWxnb3JpdGhtKGNodW5rKSB7CiAgIHJldHVybiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0U2lua1dyaXRlQWxnb3JpdGhtKHN0cmVhbSwgY2h1bmspOwogIH0KICBmdW5jdGlvbiBhYm9ydEFsZ29yaXRobShyZWFzb24pIHsKICAgcmV0dXJuIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRTaW5rQWJvcnRBbGdvcml0aG0oc3RyZWFtLCByZWFzb24pOwogIH0KICBmdW5jdGlvbiBjbG9zZUFsZ29yaXRobSgpIHsKICAgcmV0dXJuIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRTaW5rQ2xvc2VBbGdvcml0aG0oc3RyZWFtKTsKICB9CiAgc3RyZWFtLl93cml0YWJsZSA9IENyZWF0ZVdyaXRhYmxlU3RyZWFtKHN0YXJ0QWxnb3JpdGhtLCB3cml0ZUFsZ29yaXRobSwgY2xvc2VBbGdvcml0aG0sIGFib3J0QWxnb3JpdGhtLCB3cml0YWJsZUhpZ2hXYXRlck1hcmssIHdyaXRhYmxlU2l6ZUFsZ29yaXRobSk7CiAgZnVuY3Rpb24gcHVsbEFsZ29yaXRobSgpIHsKICAgcmV0dXJuIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRTb3VyY2VQdWxsQWxnb3JpdGhtKHN0cmVhbSk7CiAgfQogIGZ1bmN0aW9uIGNhbmNlbEFsZ29yaXRobShyZWFzb24pIHsKICAgVHJhbnNmb3JtU3RyZWFtRXJyb3JXcml0YWJsZUFuZFVuYmxvY2tXcml0ZShzdHJlYW0sIHJlYXNvbik7CiAgIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKHVuZGVmaW5lZCk7CiAgfQogIHN0cmVhbS5fcmVhZGFibGUgPSBDcmVhdGVSZWFkYWJsZVN0cmVhbShzdGFydEFsZ29yaXRobSwgcHVsbEFsZ29yaXRobSwgY2FuY2VsQWxnb3JpdGhtLCByZWFkYWJsZUhpZ2hXYXRlck1hcmssIHJlYWRhYmxlU2l6ZUFsZ29yaXRobSk7CiAgc3RyZWFtLl9iYWNrcHJlc3N1cmUgPSB1bmRlZmluZWQ7CiAgc3RyZWFtLl9iYWNrcHJlc3N1cmVDaGFuZ2VQcm9taXNlID0gdW5kZWZpbmVkOwogIHN0cmVhbS5fYmFja3ByZXNzdXJlQ2hhbmdlUHJvbWlzZV9yZXNvbHZlID0gdW5kZWZpbmVkOwogIFRyYW5zZm9ybVN0cmVhbVNldEJhY2twcmVzc3VyZShzdHJlYW0sIHRydWUpOwogIHN0cmVhbS5fdHJhbnNmb3JtU3RyZWFtQ29udHJvbGxlciA9IHVuZGVmaW5lZDsKIH0KIGZ1bmN0aW9uIElzVHJhbnNmb3JtU3RyZWFtKHgpIHsKICBpZiAoIXR5cGVJc09iamVjdCh4KSkgewogICByZXR1cm4gZmFsc2U7CiAgfQogIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHgsICdfdHJhbnNmb3JtU3RyZWFtQ29udHJvbGxlcicpKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgcmV0dXJuIHRydWU7CiB9CiBmdW5jdGlvbiBUcmFuc2Zvcm1TdHJlYW1FcnJvcihzdHJlYW0sIGUpIHsKICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyRXJyb3Ioc3RyZWFtLl9yZWFkYWJsZS5fcmVhZGFibGVTdHJlYW1Db250cm9sbGVyLCBlKTsKICBUcmFuc2Zvcm1TdHJlYW1FcnJvcldyaXRhYmxlQW5kVW5ibG9ja1dyaXRlKHN0cmVhbSwgZSk7CiB9CiBmdW5jdGlvbiBUcmFuc2Zvcm1TdHJlYW1FcnJvcldyaXRhYmxlQW5kVW5ibG9ja1dyaXRlKHN0cmVhbSwgZSkgewogIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2xlYXJBbGdvcml0aG1zKHN0cmVhbS5fdHJhbnNmb3JtU3RyZWFtQ29udHJvbGxlcik7CiAgV3JpdGFibGVTdHJlYW1EZWZhdWx0Q29udHJvbGxlckVycm9ySWZOZWVkZWQoc3RyZWFtLl93cml0YWJsZS5fd3JpdGFibGVTdHJlYW1Db250cm9sbGVyLCBlKTsKICBpZiAoc3RyZWFtLl9iYWNrcHJlc3N1cmUgPT09IHRydWUpIHsKICAgVHJhbnNmb3JtU3RyZWFtU2V0QmFja3ByZXNzdXJlKHN0cmVhbSwgZmFsc2UpOwogIH0KIH0KIGZ1bmN0aW9uIFRyYW5zZm9ybVN0cmVhbVNldEJhY2twcmVzc3VyZShzdHJlYW0sIGJhY2twcmVzc3VyZSkgewogIGlmIChzdHJlYW0uX2JhY2twcmVzc3VyZUNoYW5nZVByb21pc2UgIT09IHVuZGVmaW5lZCkgewogICBzdHJlYW0uX2JhY2twcmVzc3VyZUNoYW5nZVByb21pc2VfcmVzb2x2ZSgpOwogIH0KICBzdHJlYW0uX2JhY2twcmVzc3VyZUNoYW5nZVByb21pc2UgPSBuZXdQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgIHN0cmVhbS5fYmFja3ByZXNzdXJlQ2hhbmdlUHJvbWlzZV9yZXNvbHZlID0gcmVzb2x2ZTsKICB9KTsKICBzdHJlYW0uX2JhY2twcmVzc3VyZSA9IGJhY2twcmVzc3VyZTsKIH0KIHZhciBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlcigpIHsKICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIgaW5zdGFuY2VzIGNhbm5vdCBiZSBjcmVhdGVkIGRpcmVjdGx5Jyk7CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlci5wcm90b3R5cGUsICJkZXNpcmVkU2l6ZSIsIHsKICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoSXNUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgICB0aHJvdyBkZWZhdWx0Q29udHJvbGxlckJyYW5kQ2hlY2tFeGNlcHRpb24kMSgnZGVzaXJlZFNpemUnKTsKICAgIH0KICAgIHZhciByZWFkYWJsZUNvbnRyb2xsZXIgPSB0aGlzLl9jb250cm9sbGVkVHJhbnNmb3JtU3RyZWFtLl9yZWFkYWJsZS5fcmVhZGFibGVTdHJlYW1Db250cm9sbGVyOwogICAgcmV0dXJuIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJHZXREZXNpcmVkU2l6ZShyZWFkYWJsZUNvbnRyb2xsZXIpOwogICB9LAogICBlbnVtZXJhYmxlOiB0cnVlLAogICBjb25maWd1cmFibGU6IHRydWUKICB9KTsKICBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlci5wcm90b3R5cGUuZW5xdWV1ZSA9IGZ1bmN0aW9uIChjaHVuaykgewogICBpZiAoSXNUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IGRlZmF1bHRDb250cm9sbGVyQnJhbmRDaGVja0V4Y2VwdGlvbiQxKCdlbnF1ZXVlJyk7CiAgIH0KICAgVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFbnF1ZXVlKHRoaXMsIGNodW5rKTsKICB9OwogIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChyZWFzb24pIHsKICAgaWYgKElzVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIodGhpcykgPT09IGZhbHNlKSB7CiAgICB0aHJvdyBkZWZhdWx0Q29udHJvbGxlckJyYW5kQ2hlY2tFeGNlcHRpb24kMSgnZXJyb3InKTsKICAgfQogICBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlckVycm9yKHRoaXMsIHJlYXNvbik7CiAgfTsKICBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlci5wcm90b3R5cGUudGVybWluYXRlID0gZnVuY3Rpb24gKCkgewogICBpZiAoSXNUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlcih0aGlzKSA9PT0gZmFsc2UpIHsKICAgIHRocm93IGRlZmF1bHRDb250cm9sbGVyQnJhbmRDaGVja0V4Y2VwdGlvbiQxKCd0ZXJtaW5hdGUnKTsKICAgfQogICBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlclRlcm1pbmF0ZSh0aGlzKTsKICB9OwogIHJldHVybiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlcjsKIH0oKTsKIGZ1bmN0aW9uIElzVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIoeCkgewogIGlmICghdHlwZUlzT2JqZWN0KHgpKSB7CiAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoeCwgJ19jb250cm9sbGVkVHJhbnNmb3JtU3RyZWFtJykpIHsKICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKIH0KIGZ1bmN0aW9uIFNldFVwVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXIoc3RyZWFtLCBjb250cm9sbGVyLCB0cmFuc2Zvcm1BbGdvcml0aG0sIGZsdXNoQWxnb3JpdGhtKSB7CiAgY29udHJvbGxlci5fY29udHJvbGxlZFRyYW5zZm9ybVN0cmVhbSA9IHN0cmVhbTsKICBzdHJlYW0uX3RyYW5zZm9ybVN0cmVhbUNvbnRyb2xsZXIgPSBjb250cm9sbGVyOwogIGNvbnRyb2xsZXIuX3RyYW5zZm9ybUFsZ29yaXRobSA9IHRyYW5zZm9ybUFsZ29yaXRobTsKICBjb250cm9sbGVyLl9mbHVzaEFsZ29yaXRobSA9IGZsdXNoQWxnb3JpdGhtOwogfQogZnVuY3Rpb24gU2V0VXBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlckZyb21UcmFuc2Zvcm1lcihzdHJlYW0sIHRyYW5zZm9ybWVyKSB7CiAgdmFyIGNvbnRyb2xsZXIgPSBPYmplY3QuY3JlYXRlKFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyLnByb3RvdHlwZSk7CiAgdmFyIHRyYW5zZm9ybUFsZ29yaXRobSA9IGZ1bmN0aW9uIChjaHVuaykgewogICB0cnkgewogICAgVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFbnF1ZXVlKGNvbnRyb2xsZXIsIGNodW5rKTsKICAgIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKHVuZGVmaW5lZCk7CiAgIH0gY2F0Y2ggKHRyYW5zZm9ybVJlc3VsdEUpIHsKICAgIHJldHVybiBwcm9taXNlUmVqZWN0ZWRXaXRoKHRyYW5zZm9ybVJlc3VsdEUpOwogICB9CiAgfTsKICB2YXIgdHJhbnNmb3JtTWV0aG9kID0gdHJhbnNmb3JtZXIudHJhbnNmb3JtOwogIGlmICh0cmFuc2Zvcm1NZXRob2QgIT09IHVuZGVmaW5lZCkgewogICBpZiAodHlwZW9mIHRyYW5zZm9ybU1ldGhvZCAhPT0gJ2Z1bmN0aW9uJykgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigndHJhbnNmb3JtIGlzIG5vdCBhIG1ldGhvZCcpOwogICB9CiAgIHRyYW5zZm9ybUFsZ29yaXRobSA9IGZ1bmN0aW9uIChjaHVuaykgewogICAgcmV0dXJuIFByb21pc2VDYWxsKHRyYW5zZm9ybU1ldGhvZCwgdHJhbnNmb3JtZXIsIFsKICAgICBjaHVuaywKICAgICBjb250cm9sbGVyCiAgICBdKTsKICAgfTsKICB9CiAgdmFyIGZsdXNoQWxnb3JpdGhtID0gQ3JlYXRlQWxnb3JpdGhtRnJvbVVuZGVybHlpbmdNZXRob2QodHJhbnNmb3JtZXIsICdmbHVzaCcsIDAsIFtjb250cm9sbGVyXSk7CiAgU2V0VXBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlcihzdHJlYW0sIGNvbnRyb2xsZXIsIHRyYW5zZm9ybUFsZ29yaXRobSwgZmx1c2hBbGdvcml0aG0pOwogfQogZnVuY3Rpb24gVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbGVhckFsZ29yaXRobXMoY29udHJvbGxlcikgewogIGNvbnRyb2xsZXIuX3RyYW5zZm9ybUFsZ29yaXRobSA9IHVuZGVmaW5lZDsKICBjb250cm9sbGVyLl9mbHVzaEFsZ29yaXRobSA9IHVuZGVmaW5lZDsKIH0KIGZ1bmN0aW9uIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyRW5xdWV1ZShjb250cm9sbGVyLCBjaHVuaykgewogIHZhciBzdHJlYW0gPSBjb250cm9sbGVyLl9jb250cm9sbGVkVHJhbnNmb3JtU3RyZWFtOwogIHZhciByZWFkYWJsZUNvbnRyb2xsZXIgPSBzdHJlYW0uX3JlYWRhYmxlLl9yZWFkYWJsZVN0cmVhbUNvbnRyb2xsZXI7CiAgaWYgKFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDYW5DbG9zZU9yRW5xdWV1ZShyZWFkYWJsZUNvbnRyb2xsZXIpID09PSBmYWxzZSkgewogICB0aHJvdyBuZXcgVHlwZUVycm9yKCdSZWFkYWJsZSBzaWRlIGlzIG5vdCBpbiBhIHN0YXRlIHRoYXQgcGVybWl0cyBlbnF1ZXVlJyk7CiAgfQogIHRyeSB7CiAgIFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJFbnF1ZXVlKHJlYWRhYmxlQ29udHJvbGxlciwgY2h1bmspOwogIH0gY2F0Y2ggKGUpIHsKICAgVHJhbnNmb3JtU3RyZWFtRXJyb3JXcml0YWJsZUFuZFVuYmxvY2tXcml0ZShzdHJlYW0sIGUpOwogICB0aHJvdyBzdHJlYW0uX3JlYWRhYmxlLl9zdG9yZWRFcnJvcjsKICB9CiAgdmFyIGJhY2twcmVzc3VyZSA9IFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJIYXNCYWNrcHJlc3N1cmUocmVhZGFibGVDb250cm9sbGVyKTsKICBpZiAoYmFja3ByZXNzdXJlICE9PSBzdHJlYW0uX2JhY2twcmVzc3VyZSkgewogICBUcmFuc2Zvcm1TdHJlYW1TZXRCYWNrcHJlc3N1cmUoc3RyZWFtLCB0cnVlKTsKICB9CiB9CiBmdW5jdGlvbiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlckVycm9yKGNvbnRyb2xsZXIsIGUpIHsKICBUcmFuc2Zvcm1TdHJlYW1FcnJvcihjb250cm9sbGVyLl9jb250cm9sbGVkVHJhbnNmb3JtU3RyZWFtLCBlKTsKIH0KIGZ1bmN0aW9uIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyUGVyZm9ybVRyYW5zZm9ybShjb250cm9sbGVyLCBjaHVuaykgewogIHZhciB0cmFuc2Zvcm1Qcm9taXNlID0gY29udHJvbGxlci5fdHJhbnNmb3JtQWxnb3JpdGhtKGNodW5rKTsKICByZXR1cm4gdHJhbnNmb3JtUHJvbWlzZVdpdGgodHJhbnNmb3JtUHJvbWlzZSwgdW5kZWZpbmVkLCBmdW5jdGlvbiAocikgewogICBUcmFuc2Zvcm1TdHJlYW1FcnJvcihjb250cm9sbGVyLl9jb250cm9sbGVkVHJhbnNmb3JtU3RyZWFtLCByKTsKICAgdGhyb3cgcjsKICB9KTsKIH0KIGZ1bmN0aW9uIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyVGVybWluYXRlKGNvbnRyb2xsZXIpIHsKICB2YXIgc3RyZWFtID0gY29udHJvbGxlci5fY29udHJvbGxlZFRyYW5zZm9ybVN0cmVhbTsKICB2YXIgcmVhZGFibGVDb250cm9sbGVyID0gc3RyZWFtLl9yZWFkYWJsZS5fcmVhZGFibGVTdHJlYW1Db250cm9sbGVyOwogIGlmIChSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2FuQ2xvc2VPckVucXVldWUocmVhZGFibGVDb250cm9sbGVyKSA9PT0gdHJ1ZSkgewogICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2xvc2UocmVhZGFibGVDb250cm9sbGVyKTsKICB9CiAgdmFyIGVycm9yID0gbmV3IFR5cGVFcnJvcignVHJhbnNmb3JtU3RyZWFtIHRlcm1pbmF0ZWQnKTsKICBUcmFuc2Zvcm1TdHJlYW1FcnJvcldyaXRhYmxlQW5kVW5ibG9ja1dyaXRlKHN0cmVhbSwgZXJyb3IpOwogfQogZnVuY3Rpb24gVHJhbnNmb3JtU3RyZWFtRGVmYXVsdFNpbmtXcml0ZUFsZ29yaXRobShzdHJlYW0sIGNodW5rKSB7CiAgdmFyIGNvbnRyb2xsZXIgPSBzdHJlYW0uX3RyYW5zZm9ybVN0cmVhbUNvbnRyb2xsZXI7CiAgaWYgKHN0cmVhbS5fYmFja3ByZXNzdXJlID09PSB0cnVlKSB7CiAgIHZhciBiYWNrcHJlc3N1cmVDaGFuZ2VQcm9taXNlID0gc3RyZWFtLl9iYWNrcHJlc3N1cmVDaGFuZ2VQcm9taXNlOwogICByZXR1cm4gdHJhbnNmb3JtUHJvbWlzZVdpdGgoYmFja3ByZXNzdXJlQ2hhbmdlUHJvbWlzZSwgZnVuY3Rpb24gKCkgewogICAgdmFyIHdyaXRhYmxlID0gc3RyZWFtLl93cml0YWJsZTsKICAgIHZhciBzdGF0ZSA9IHdyaXRhYmxlLl9zdGF0ZTsKICAgIGlmIChzdGF0ZSA9PT0gJ2Vycm9yaW5nJykgewogICAgIHRocm93IHdyaXRhYmxlLl9zdG9yZWRFcnJvcjsKICAgIH0KICAgIHJldHVybiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlclBlcmZvcm1UcmFuc2Zvcm0oY29udHJvbGxlciwgY2h1bmspOwogICB9KTsKICB9CiAgcmV0dXJuIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyUGVyZm9ybVRyYW5zZm9ybShjb250cm9sbGVyLCBjaHVuayk7CiB9CiBmdW5jdGlvbiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0U2lua0Fib3J0QWxnb3JpdGhtKHN0cmVhbSwgcmVhc29uKSB7CiAgVHJhbnNmb3JtU3RyZWFtRXJyb3Ioc3RyZWFtLCByZWFzb24pOwogIHJldHVybiBwcm9taXNlUmVzb2x2ZWRXaXRoKHVuZGVmaW5lZCk7CiB9CiBmdW5jdGlvbiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0U2lua0Nsb3NlQWxnb3JpdGhtKHN0cmVhbSkgewogIHZhciByZWFkYWJsZSA9IHN0cmVhbS5fcmVhZGFibGU7CiAgdmFyIGNvbnRyb2xsZXIgPSBzdHJlYW0uX3RyYW5zZm9ybVN0cmVhbUNvbnRyb2xsZXI7CiAgdmFyIGZsdXNoUHJvbWlzZSA9IGNvbnRyb2xsZXIuX2ZsdXNoQWxnb3JpdGhtKCk7CiAgVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDbGVhckFsZ29yaXRobXMoY29udHJvbGxlcik7CiAgcmV0dXJuIHRyYW5zZm9ybVByb21pc2VXaXRoKGZsdXNoUHJvbWlzZSwgZnVuY3Rpb24gKCkgewogICBpZiAocmVhZGFibGUuX3N0YXRlID09PSAnZXJyb3JlZCcpIHsKICAgIHRocm93IHJlYWRhYmxlLl9zdG9yZWRFcnJvcjsKICAgfQogICB2YXIgcmVhZGFibGVDb250cm9sbGVyID0gcmVhZGFibGUuX3JlYWRhYmxlU3RyZWFtQ29udHJvbGxlcjsKICAgaWYgKFJlYWRhYmxlU3RyZWFtRGVmYXVsdENvbnRyb2xsZXJDYW5DbG9zZU9yRW5xdWV1ZShyZWFkYWJsZUNvbnRyb2xsZXIpID09PSB0cnVlKSB7CiAgICBSZWFkYWJsZVN0cmVhbURlZmF1bHRDb250cm9sbGVyQ2xvc2UocmVhZGFibGVDb250cm9sbGVyKTsKICAgfQogIH0sIGZ1bmN0aW9uIChyKSB7CiAgIFRyYW5zZm9ybVN0cmVhbUVycm9yKHN0cmVhbSwgcik7CiAgIHRocm93IHJlYWRhYmxlLl9zdG9yZWRFcnJvcjsKICB9KTsKIH0KIGZ1bmN0aW9uIFRyYW5zZm9ybVN0cmVhbURlZmF1bHRTb3VyY2VQdWxsQWxnb3JpdGhtKHN0cmVhbSkgewogIFRyYW5zZm9ybVN0cmVhbVNldEJhY2twcmVzc3VyZShzdHJlYW0sIGZhbHNlKTsKICByZXR1cm4gc3RyZWFtLl9iYWNrcHJlc3N1cmVDaGFuZ2VQcm9taXNlOwogfQogZnVuY3Rpb24gZGVmYXVsdENvbnRyb2xsZXJCcmFuZENoZWNrRXhjZXB0aW9uJDEobmFtZSkgewogIHJldHVybiBuZXcgVHlwZUVycm9yKCJUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlci5wcm90b3R5cGUuIiArIG5hbWUgKyAiIGNhbiBvbmx5IGJlIHVzZWQgb24gYSBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlciIpOwogfQogZnVuY3Rpb24gc3RyZWFtQnJhbmRDaGVja0V4Y2VwdGlvbiQyKG5hbWUpIHsKICByZXR1cm4gbmV3IFR5cGVFcnJvcigiVHJhbnNmb3JtU3RyZWFtLnByb3RvdHlwZS4iICsgbmFtZSArICIgY2FuIG9ubHkgYmUgdXNlZCBvbiBhIFRyYW5zZm9ybVN0cmVhbSIpOwogfQogZXhwb3J0cy5CeXRlTGVuZ3RoUXVldWluZ1N0cmF0ZWd5ID0gQnl0ZUxlbmd0aFF1ZXVpbmdTdHJhdGVneTsKIGV4cG9ydHMuQ291bnRRdWV1aW5nU3RyYXRlZ3kgPSBDb3VudFF1ZXVpbmdTdHJhdGVneTsKIGV4cG9ydHMuUmVhZGFibGVTdHJlYW0gPSBSZWFkYWJsZVN0cmVhbTsKIGV4cG9ydHMuVHJhbnNmb3JtU3RyZWFtID0gVHJhbnNmb3JtU3RyZWFtOwogZXhwb3J0cy5Xcml0YWJsZVN0cmVhbSA9IFdyaXRhYmxlU3RyZWFtOwogT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTsKfSkpOwoKLyoqKi8gfSksCi8qIDE0NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDE0NSk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTE0KTsKX193X3BkZmpzX3JlcXVpcmVfXyg3Nyk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTE2KTsKdmFyIHBhdGggPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQzKTsKbW9kdWxlLmV4cG9ydHMgPSBwYXRoLk1hcDsKCi8qKiovIH0pLAovKiAxNDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGNvbGxlY3Rpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0Nik7CnZhciBjb2xsZWN0aW9uU3Ryb25nID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTApOwptb2R1bGUuZXhwb3J0cyA9IGNvbGxlY3Rpb24oJ01hcCcsIGZ1bmN0aW9uIChpbml0KSB7CiByZXR1cm4gZnVuY3Rpb24gTWFwKCkgewogIHJldHVybiBpbml0KHRoaXMsIGFyZ3VtZW50cy5sZW5ndGggPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpOwogfTsKfSwgY29sbGVjdGlvblN0cm9uZyk7CgovKioqLyB9KSwKLyogMTQ2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIGlzRm9yY2VkID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Mik7CnZhciByZWRlZmluZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjkpOwp2YXIgSW50ZXJuYWxNZXRhZGF0YU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ3KTsKdmFyIGl0ZXJhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyNCk7CnZhciBhbkluc3RhbmNlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjMpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7CnZhciBjaGVja0NvcnJlY3RuZXNzT2ZJdGVyYXRpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDk3KTsKdmFyIHNldFRvU3RyaW5nVGFnID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7CnZhciBpbmhlcml0SWZSZXF1aXJlZCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ5KTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoQ09OU1RSVUNUT1JfTkFNRSwgd3JhcHBlciwgY29tbW9uKSB7CiB2YXIgSVNfTUFQID0gQ09OU1RSVUNUT1JfTkFNRS5pbmRleE9mKCdNYXAnKSAhPT0gLTE7CiB2YXIgSVNfV0VBSyA9IENPTlNUUlVDVE9SX05BTUUuaW5kZXhPZignV2VhaycpICE9PSAtMTsKIHZhciBBRERFUiA9IElTX01BUCA/ICdzZXQnIDogJ2FkZCc7CiB2YXIgTmF0aXZlQ29uc3RydWN0b3IgPSBnbG9iYWxbQ09OU1RSVUNUT1JfTkFNRV07CiB2YXIgTmF0aXZlUHJvdG90eXBlID0gTmF0aXZlQ29uc3RydWN0b3IgJiYgTmF0aXZlQ29uc3RydWN0b3IucHJvdG90eXBlOwogdmFyIENvbnN0cnVjdG9yID0gTmF0aXZlQ29uc3RydWN0b3I7CiB2YXIgZXhwb3J0ZWQgPSB7fTsKIHZhciBmaXhNZXRob2QgPSBmdW5jdGlvbiAoS0VZKSB7CiAgdmFyIG5hdGl2ZU1ldGhvZCA9IE5hdGl2ZVByb3RvdHlwZVtLRVldOwogIHJlZGVmaW5lKE5hdGl2ZVByb3RvdHlwZSwgS0VZLCBLRVkgPT0gJ2FkZCcgPyBmdW5jdGlvbiBhZGQodmFsdWUpIHsKICAgbmF0aXZlTWV0aG9kLmNhbGwodGhpcywgdmFsdWUgPT09IDAgPyAwIDogdmFsdWUpOwogICByZXR1cm4gdGhpczsKICB9IDogS0VZID09ICdkZWxldGUnID8gZnVuY3Rpb24gKGtleSkgewogICByZXR1cm4gSVNfV0VBSyAmJiAhaXNPYmplY3Qoa2V5KSA/IGZhbHNlIDogbmF0aXZlTWV0aG9kLmNhbGwodGhpcywga2V5ID09PSAwID8gMCA6IGtleSk7CiAgfSA6IEtFWSA9PSAnZ2V0JyA/IGZ1bmN0aW9uIGdldChrZXkpIHsKICAgcmV0dXJuIElTX1dFQUsgJiYgIWlzT2JqZWN0KGtleSkgPyB1bmRlZmluZWQgOiBuYXRpdmVNZXRob2QuY2FsbCh0aGlzLCBrZXkgPT09IDAgPyAwIDoga2V5KTsKICB9IDogS0VZID09ICdoYXMnID8gZnVuY3Rpb24gaGFzKGtleSkgewogICByZXR1cm4gSVNfV0VBSyAmJiAhaXNPYmplY3Qoa2V5KSA/IGZhbHNlIDogbmF0aXZlTWV0aG9kLmNhbGwodGhpcywga2V5ID09PSAwID8gMCA6IGtleSk7CiAgfSA6IGZ1bmN0aW9uIHNldChrZXksIHZhbHVlKSB7CiAgIG5hdGl2ZU1ldGhvZC5jYWxsKHRoaXMsIGtleSA9PT0gMCA/IDAgOiBrZXksIHZhbHVlKTsKICAgcmV0dXJuIHRoaXM7CiAgfSk7CiB9OwogaWYgKGlzRm9yY2VkKENPTlNUUlVDVE9SX05BTUUsIHR5cGVvZiBOYXRpdmVDb25zdHJ1Y3RvciAhPSAnZnVuY3Rpb24nIHx8ICEoSVNfV0VBSyB8fCBOYXRpdmVQcm90b3R5cGUuZm9yRWFjaCAmJiAhZmFpbHMoZnVuY3Rpb24gKCkgewogICBuZXcgTmF0aXZlQ29uc3RydWN0b3IoKS5lbnRyaWVzKCkubmV4dCgpOwogIH0pKSkpIHsKICBDb25zdHJ1Y3RvciA9IGNvbW1vbi5nZXRDb25zdHJ1Y3Rvcih3cmFwcGVyLCBDT05TVFJVQ1RPUl9OQU1FLCBJU19NQVAsIEFEREVSKTsKICBJbnRlcm5hbE1ldGFkYXRhTW9kdWxlLlJFUVVJUkVEID0gdHJ1ZTsKIH0gZWxzZSBpZiAoaXNGb3JjZWQoQ09OU1RSVUNUT1JfTkFNRSwgdHJ1ZSkpIHsKICB2YXIgaW5zdGFuY2UgPSBuZXcgQ29uc3RydWN0b3IoKTsKICB2YXIgSEFTTlRfQ0hBSU5JTkcgPSBpbnN0YW5jZVtBRERFUl0oSVNfV0VBSyA/IHt9IDogLTAsIDEpICE9IGluc3RhbmNlOwogIHZhciBUSFJPV1NfT05fUFJJTUlUSVZFUyA9IGZhaWxzKGZ1bmN0aW9uICgpIHsKICAgaW5zdGFuY2UuaGFzKDEpOwogIH0pOwogIHZhciBBQ0NFUFRfSVRFUkFCTEVTID0gY2hlY2tDb3JyZWN0bmVzc09mSXRlcmF0aW9uKGZ1bmN0aW9uIChpdGVyYWJsZSkgewogICBuZXcgTmF0aXZlQ29uc3RydWN0b3IoaXRlcmFibGUpOwogIH0pOwogIHZhciBCVUdHWV9aRVJPID0gIUlTX1dFQUsgJiYgZmFpbHMoZnVuY3Rpb24gKCkgewogICB2YXIgJGluc3RhbmNlID0gbmV3IE5hdGl2ZUNvbnN0cnVjdG9yKCk7CiAgIHZhciBpbmRleCA9IDU7CiAgIHdoaWxlIChpbmRleC0tKQogICAgJGluc3RhbmNlW0FEREVSXShpbmRleCwgaW5kZXgpOwogICByZXR1cm4gISRpbnN0YW5jZS5oYXMoLTApOwogIH0pOwogIGlmICghQUNDRVBUX0lURVJBQkxFUykgewogICBDb25zdHJ1Y3RvciA9IHdyYXBwZXIoZnVuY3Rpb24gKGR1bW15LCBpdGVyYWJsZSkgewogICAgYW5JbnN0YW5jZShkdW1teSwgQ29uc3RydWN0b3IsIENPTlNUUlVDVE9SX05BTUUpOwogICAgdmFyIHRoYXQgPSBpbmhlcml0SWZSZXF1aXJlZChuZXcgTmF0aXZlQ29uc3RydWN0b3IoKSwgZHVtbXksIENvbnN0cnVjdG9yKTsKICAgIGlmIChpdGVyYWJsZSAhPSB1bmRlZmluZWQpCiAgICAgaXRlcmF0ZShpdGVyYWJsZSwgdGhhdFtBRERFUl0sIHRoYXQsIElTX01BUCk7CiAgICByZXR1cm4gdGhhdDsKICAgfSk7CiAgIENvbnN0cnVjdG9yLnByb3RvdHlwZSA9IE5hdGl2ZVByb3RvdHlwZTsKICAgTmF0aXZlUHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ29uc3RydWN0b3I7CiAgfQogIGlmIChUSFJPV1NfT05fUFJJTUlUSVZFUyB8fCBCVUdHWV9aRVJPKSB7CiAgIGZpeE1ldGhvZCgnZGVsZXRlJyk7CiAgIGZpeE1ldGhvZCgnaGFzJyk7CiAgIElTX01BUCAmJiBmaXhNZXRob2QoJ2dldCcpOwogIH0KICBpZiAoQlVHR1lfWkVSTyB8fCBIQVNOVF9DSEFJTklORykKICAgZml4TWV0aG9kKEFEREVSKTsKICBpZiAoSVNfV0VBSyAmJiBOYXRpdmVQcm90b3R5cGUuY2xlYXIpCiAgIGRlbGV0ZSBOYXRpdmVQcm90b3R5cGUuY2xlYXI7CiB9CiBleHBvcnRlZFtDT05TVFJVQ1RPUl9OQU1FXSA9IENvbnN0cnVjdG9yOwogJCh7CiAgZ2xvYmFsOiB0cnVlLAogIGZvcmNlZDogQ29uc3RydWN0b3IgIT0gTmF0aXZlQ29uc3RydWN0b3IKIH0sIGV4cG9ydGVkKTsKIHNldFRvU3RyaW5nVGFnKENvbnN0cnVjdG9yLCBDT05TVFJVQ1RPUl9OQU1FKTsKIGlmICghSVNfV0VBSykKICBjb21tb24uc2V0U3Ryb25nKENvbnN0cnVjdG9yLCBDT05TVFJVQ1RPUl9OQU1FLCBJU19NQVApOwogcmV0dXJuIENvbnN0cnVjdG9yOwp9OwoKLyoqKi8gfSksCi8qIDE0NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgaGlkZGVuS2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oMzkpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgZGVmaW5lUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI3KS5mOwp2YXIgdWlkID0gX193X3BkZmpzX3JlcXVpcmVfXygzOCk7CnZhciBGUkVFWklORyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ4KTsKdmFyIE1FVEFEQVRBID0gdWlkKCdtZXRhJyk7CnZhciBpZCA9IDA7CnZhciBpc0V4dGVuc2libGUgPSBPYmplY3QuaXNFeHRlbnNpYmxlIHx8IGZ1bmN0aW9uICgpIHsKIHJldHVybiB0cnVlOwp9Owp2YXIgc2V0TWV0YWRhdGEgPSBmdW5jdGlvbiAoaXQpIHsKIGRlZmluZVByb3BlcnR5KGl0LCBNRVRBREFUQSwgewogIHZhbHVlOiB7CiAgIG9iamVjdElEOiAnTycgKyArK2lkLAogICB3ZWFrRGF0YToge30KICB9CiB9KTsKfTsKdmFyIGZhc3RLZXkgPSBmdW5jdGlvbiAoaXQsIGNyZWF0ZSkgewogaWYgKCFpc09iamVjdChpdCkpCiAgcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJyA/IGl0IDogKHR5cGVvZiBpdCA9PSAnc3RyaW5nJyA/ICdTJyA6ICdQJykgKyBpdDsKIGlmICghaGFzKGl0LCBNRVRBREFUQSkpIHsKICBpZiAoIWlzRXh0ZW5zaWJsZShpdCkpCiAgIHJldHVybiAnRic7CiAgaWYgKCFjcmVhdGUpCiAgIHJldHVybiAnRSc7CiAgc2V0TWV0YWRhdGEoaXQpOwogfQogcmV0dXJuIGl0W01FVEFEQVRBXS5vYmplY3RJRDsKfTsKdmFyIGdldFdlYWtEYXRhID0gZnVuY3Rpb24gKGl0LCBjcmVhdGUpIHsKIGlmICghaGFzKGl0LCBNRVRBREFUQSkpIHsKICBpZiAoIWlzRXh0ZW5zaWJsZShpdCkpCiAgIHJldHVybiB0cnVlOwogIGlmICghY3JlYXRlKQogICByZXR1cm4gZmFsc2U7CiAgc2V0TWV0YWRhdGEoaXQpOwogfQogcmV0dXJuIGl0W01FVEFEQVRBXS53ZWFrRGF0YTsKfTsKdmFyIG9uRnJlZXplID0gZnVuY3Rpb24gKGl0KSB7CiBpZiAoRlJFRVpJTkcgJiYgbWV0YS5SRVFVSVJFRCAmJiBpc0V4dGVuc2libGUoaXQpICYmICFoYXMoaXQsIE1FVEFEQVRBKSkKICBzZXRNZXRhZGF0YShpdCk7CiByZXR1cm4gaXQ7Cn07CnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7CiBSRVFVSVJFRDogZmFsc2UsCiBmYXN0S2V5OiBmYXN0S2V5LAogZ2V0V2Vha0RhdGE6IGdldFdlYWtEYXRhLAogb25GcmVlemU6IG9uRnJlZXplCn07CmhpZGRlbktleXNbTUVUQURBVEFdID0gdHJ1ZTsKCi8qKiovIH0pLAovKiAxNDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7Cm1vZHVsZS5leHBvcnRzID0gIWZhaWxzKGZ1bmN0aW9uICgpIHsKIHJldHVybiBPYmplY3QuaXNFeHRlbnNpYmxlKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpOwp9KTsKCi8qKiovIH0pLAovKiAxNDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGlzT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMik7CnZhciBzZXRQcm90b3R5cGVPZiA9IF9fd19wZGZqc19yZXF1aXJlX18oODcpOwptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgkdGhpcywgZHVtbXksIFdyYXBwZXIpIHsKIHZhciBOZXdUYXJnZXQsIE5ld1RhcmdldFByb3RvdHlwZTsKIGlmIChzZXRQcm90b3R5cGVPZiAmJiB0eXBlb2YgKE5ld1RhcmdldCA9IGR1bW15LmNvbnN0cnVjdG9yKSA9PSAnZnVuY3Rpb24nICYmIE5ld1RhcmdldCAhPT0gV3JhcHBlciAmJiBpc09iamVjdChOZXdUYXJnZXRQcm90b3R5cGUgPSBOZXdUYXJnZXQucHJvdG90eXBlKSAmJiBOZXdUYXJnZXRQcm90b3R5cGUgIT09IFdyYXBwZXIucHJvdG90eXBlKQogIHNldFByb3RvdHlwZU9mKCR0aGlzLCBOZXdUYXJnZXRQcm90b3R5cGUpOwogcmV0dXJuICR0aGlzOwp9OwoKLyoqKi8gfSksCi8qIDE1MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZGVmaW5lUHJvcGVydHkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI3KS5mOwp2YXIgY3JlYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXyg3MSk7CnZhciByZWRlZmluZUFsbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTIxKTsKdmFyIGJpbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYyKTsKdmFyIGFuSW5zdGFuY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyMyk7CnZhciBpdGVyYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjQpOwp2YXIgZGVmaW5lSXRlcmF0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc5KTsKdmFyIHNldFNwZWNpZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyMik7CnZhciBERVNDUklQVE9SUyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMpOwp2YXIgZmFzdEtleSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ3KS5mYXN0S2V5Owp2YXIgSW50ZXJuYWxTdGF0ZU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMzMpOwp2YXIgc2V0SW50ZXJuYWxTdGF0ZSA9IEludGVybmFsU3RhdGVNb2R1bGUuc2V0Owp2YXIgaW50ZXJuYWxTdGF0ZUdldHRlckZvciA9IEludGVybmFsU3RhdGVNb2R1bGUuZ2V0dGVyRm9yOwptb2R1bGUuZXhwb3J0cyA9IHsKIGdldENvbnN0cnVjdG9yOiBmdW5jdGlvbiAod3JhcHBlciwgQ09OU1RSVUNUT1JfTkFNRSwgSVNfTUFQLCBBRERFUikgewogIHZhciBDID0gd3JhcHBlcihmdW5jdGlvbiAodGhhdCwgaXRlcmFibGUpIHsKICAgYW5JbnN0YW5jZSh0aGF0LCBDLCBDT05TVFJVQ1RPUl9OQU1FKTsKICAgc2V0SW50ZXJuYWxTdGF0ZSh0aGF0LCB7CiAgICB0eXBlOiBDT05TVFJVQ1RPUl9OQU1FLAogICAgaW5kZXg6IGNyZWF0ZShudWxsKSwKICAgIGZpcnN0OiB1bmRlZmluZWQsCiAgICBsYXN0OiB1bmRlZmluZWQsCiAgICBzaXplOiAwCiAgIH0pOwogICBpZiAoIURFU0NSSVBUT1JTKQogICAgdGhhdC5zaXplID0gMDsKICAgaWYgKGl0ZXJhYmxlICE9IHVuZGVmaW5lZCkKICAgIGl0ZXJhdGUoaXRlcmFibGUsIHRoYXRbQURERVJdLCB0aGF0LCBJU19NQVApOwogIH0pOwogIHZhciBnZXRJbnRlcm5hbFN0YXRlID0gaW50ZXJuYWxTdGF0ZUdldHRlckZvcihDT05TVFJVQ1RPUl9OQU1FKTsKICB2YXIgZGVmaW5lID0gZnVuY3Rpb24gKHRoYXQsIGtleSwgdmFsdWUpIHsKICAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZSh0aGF0KTsKICAgdmFyIGVudHJ5ID0gZ2V0RW50cnkodGhhdCwga2V5KTsKICAgdmFyIHByZXZpb3VzLCBpbmRleDsKICAgaWYgKGVudHJ5KSB7CiAgICBlbnRyeS52YWx1ZSA9IHZhbHVlOwogICB9IGVsc2UgewogICAgc3RhdGUubGFzdCA9IGVudHJ5ID0gewogICAgIGluZGV4OiBpbmRleCA9IGZhc3RLZXkoa2V5LCB0cnVlKSwKICAgICBrZXk6IGtleSwKICAgICB2YWx1ZTogdmFsdWUsCiAgICAgcHJldmlvdXM6IHByZXZpb3VzID0gc3RhdGUubGFzdCwKICAgICBuZXh0OiB1bmRlZmluZWQsCiAgICAgcmVtb3ZlZDogZmFsc2UKICAgIH07CiAgICBpZiAoIXN0YXRlLmZpcnN0KQogICAgIHN0YXRlLmZpcnN0ID0gZW50cnk7CiAgICBpZiAocHJldmlvdXMpCiAgICAgcHJldmlvdXMubmV4dCA9IGVudHJ5OwogICAgaWYgKERFU0NSSVBUT1JTKQogICAgIHN0YXRlLnNpemUrKzsKICAgIGVsc2UKICAgICB0aGF0LnNpemUrKzsKICAgIGlmIChpbmRleCAhPT0gJ0YnKQogICAgIHN0YXRlLmluZGV4W2luZGV4XSA9IGVudHJ5OwogICB9CiAgIHJldHVybiB0aGF0OwogIH07CiAgdmFyIGdldEVudHJ5ID0gZnVuY3Rpb24gKHRoYXQsIGtleSkgewogICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoYXQpOwogICB2YXIgaW5kZXggPSBmYXN0S2V5KGtleSk7CiAgIHZhciBlbnRyeTsKICAgaWYgKGluZGV4ICE9PSAnRicpCiAgICByZXR1cm4gc3RhdGUuaW5kZXhbaW5kZXhdOwogICBmb3IgKGVudHJ5ID0gc3RhdGUuZmlyc3Q7IGVudHJ5OyBlbnRyeSA9IGVudHJ5Lm5leHQpIHsKICAgIGlmIChlbnRyeS5rZXkgPT0ga2V5KQogICAgIHJldHVybiBlbnRyeTsKICAgfQogIH07CiAgcmVkZWZpbmVBbGwoQy5wcm90b3R5cGUsIHsKICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkgewogICAgdmFyIHRoYXQgPSB0aGlzOwogICAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxTdGF0ZSh0aGF0KTsKICAgIHZhciBkYXRhID0gc3RhdGUuaW5kZXg7CiAgICB2YXIgZW50cnkgPSBzdGF0ZS5maXJzdDsKICAgIHdoaWxlIChlbnRyeSkgewogICAgIGVudHJ5LnJlbW92ZWQgPSB0cnVlOwogICAgIGlmIChlbnRyeS5wcmV2aW91cykKICAgICAgZW50cnkucHJldmlvdXMgPSBlbnRyeS5wcmV2aW91cy5uZXh0ID0gdW5kZWZpbmVkOwogICAgIGRlbGV0ZSBkYXRhW2VudHJ5LmluZGV4XTsKICAgICBlbnRyeSA9IGVudHJ5Lm5leHQ7CiAgICB9CiAgICBzdGF0ZS5maXJzdCA9IHN0YXRlLmxhc3QgPSB1bmRlZmluZWQ7CiAgICBpZiAoREVTQ1JJUFRPUlMpCiAgICAgc3RhdGUuc2l6ZSA9IDA7CiAgICBlbHNlCiAgICAgdGhhdC5zaXplID0gMDsKICAgfSwKICAgJ2RlbGV0ZSc6IGZ1bmN0aW9uIChrZXkpIHsKICAgIHZhciB0aGF0ID0gdGhpczsKICAgIHZhciBzdGF0ZSA9IGdldEludGVybmFsU3RhdGUodGhhdCk7CiAgICB2YXIgZW50cnkgPSBnZXRFbnRyeSh0aGF0LCBrZXkpOwogICAgaWYgKGVudHJ5KSB7CiAgICAgdmFyIG5leHQgPSBlbnRyeS5uZXh0OwogICAgIHZhciBwcmV2ID0gZW50cnkucHJldmlvdXM7CiAgICAgZGVsZXRlIHN0YXRlLmluZGV4W2VudHJ5LmluZGV4XTsKICAgICBlbnRyeS5yZW1vdmVkID0gdHJ1ZTsKICAgICBpZiAocHJldikKICAgICAgcHJldi5uZXh0ID0gbmV4dDsKICAgICBpZiAobmV4dCkKICAgICAgbmV4dC5wcmV2aW91cyA9IHByZXY7CiAgICAgaWYgKHN0YXRlLmZpcnN0ID09IGVudHJ5KQogICAgICBzdGF0ZS5maXJzdCA9IG5leHQ7CiAgICAgaWYgKHN0YXRlLmxhc3QgPT0gZW50cnkpCiAgICAgIHN0YXRlLmxhc3QgPSBwcmV2OwogICAgIGlmIChERVNDUklQVE9SUykKICAgICAgc3RhdGUuc2l6ZS0tOwogICAgIGVsc2UKICAgICAgdGhhdC5zaXplLS07CiAgICB9CiAgICByZXR1cm4gISFlbnRyeTsKICAgfSwKICAgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChjYWxsYmFja2ZuKSB7CiAgICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpOwogICAgdmFyIGJvdW5kRnVuY3Rpb24gPSBiaW5kKGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkLCAzKTsKICAgIHZhciBlbnRyeTsKICAgIHdoaWxlIChlbnRyeSA9IGVudHJ5ID8gZW50cnkubmV4dCA6IHN0YXRlLmZpcnN0KSB7CiAgICAgYm91bmRGdW5jdGlvbihlbnRyeS52YWx1ZSwgZW50cnkua2V5LCB0aGlzKTsKICAgICB3aGlsZSAoZW50cnkgJiYgZW50cnkucmVtb3ZlZCkKICAgICAgZW50cnkgPSBlbnRyeS5wcmV2aW91czsKICAgIH0KICAgfSwKICAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KSB7CiAgICByZXR1cm4gISFnZXRFbnRyeSh0aGlzLCBrZXkpOwogICB9CiAgfSk7CiAgcmVkZWZpbmVBbGwoQy5wcm90b3R5cGUsIElTX01BUCA/IHsKICAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7CiAgICB2YXIgZW50cnkgPSBnZXRFbnRyeSh0aGlzLCBrZXkpOwogICAgcmV0dXJuIGVudHJ5ICYmIGVudHJ5LnZhbHVlOwogICB9LAogICBzZXQ6IGZ1bmN0aW9uIHNldChrZXksIHZhbHVlKSB7CiAgICByZXR1cm4gZGVmaW5lKHRoaXMsIGtleSA9PT0gMCA/IDAgOiBrZXksIHZhbHVlKTsKICAgfQogIH0gOiB7CiAgIGFkZDogZnVuY3Rpb24gYWRkKHZhbHVlKSB7CiAgICByZXR1cm4gZGVmaW5lKHRoaXMsIHZhbHVlID0gdmFsdWUgPT09IDAgPyAwIDogdmFsdWUsIHZhbHVlKTsKICAgfQogIH0pOwogIGlmIChERVNDUklQVE9SUykKICAgZGVmaW5lUHJvcGVydHkoQy5wcm90b3R5cGUsICdzaXplJywgewogICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgcmV0dXJuIGdldEludGVybmFsU3RhdGUodGhpcykuc2l6ZTsKICAgIH0KICAgfSk7CiAgcmV0dXJuIEM7CiB9LAogc2V0U3Ryb25nOiBmdW5jdGlvbiAoQywgQ09OU1RSVUNUT1JfTkFNRSwgSVNfTUFQKSB7CiAgdmFyIElURVJBVE9SX05BTUUgPSBDT05TVFJVQ1RPUl9OQU1FICsgJyBJdGVyYXRvcic7CiAgdmFyIGdldEludGVybmFsQ29sbGVjdGlvblN0YXRlID0gaW50ZXJuYWxTdGF0ZUdldHRlckZvcihDT05TVFJVQ1RPUl9OQU1FKTsKICB2YXIgZ2V0SW50ZXJuYWxJdGVyYXRvclN0YXRlID0gaW50ZXJuYWxTdGF0ZUdldHRlckZvcihJVEVSQVRPUl9OQU1FKTsKICBkZWZpbmVJdGVyYXRvcihDLCBDT05TVFJVQ1RPUl9OQU1FLCBmdW5jdGlvbiAoaXRlcmF0ZWQsIGtpbmQpIHsKICAgc2V0SW50ZXJuYWxTdGF0ZSh0aGlzLCB7CiAgICB0eXBlOiBJVEVSQVRPUl9OQU1FLAogICAgdGFyZ2V0OiBpdGVyYXRlZCwKICAgIHN0YXRlOiBnZXRJbnRlcm5hbENvbGxlY3Rpb25TdGF0ZShpdGVyYXRlZCksCiAgICBraW5kOiBraW5kLAogICAgbGFzdDogdW5kZWZpbmVkCiAgIH0pOwogIH0sIGZ1bmN0aW9uICgpIHsKICAgdmFyIHN0YXRlID0gZ2V0SW50ZXJuYWxJdGVyYXRvclN0YXRlKHRoaXMpOwogICB2YXIga2luZCA9IHN0YXRlLmtpbmQ7CiAgIHZhciBlbnRyeSA9IHN0YXRlLmxhc3Q7CiAgIHdoaWxlIChlbnRyeSAmJiBlbnRyeS5yZW1vdmVkKQogICAgZW50cnkgPSBlbnRyeS5wcmV2aW91czsKICAgaWYgKCFzdGF0ZS50YXJnZXQgfHwgIShzdGF0ZS5sYXN0ID0gZW50cnkgPSBlbnRyeSA/IGVudHJ5Lm5leHQgOiBzdGF0ZS5zdGF0ZS5maXJzdCkpIHsKICAgIHN0YXRlLnRhcmdldCA9IHVuZGVmaW5lZDsKICAgIHJldHVybiB7CiAgICAgdmFsdWU6IHVuZGVmaW5lZCwKICAgICBkb25lOiB0cnVlCiAgICB9OwogICB9CiAgIGlmIChraW5kID09ICdrZXlzJykKICAgIHJldHVybiB7CiAgICAgdmFsdWU6IGVudHJ5LmtleSwKICAgICBkb25lOiBmYWxzZQogICAgfTsKICAgaWYgKGtpbmQgPT0gJ3ZhbHVlcycpCiAgICByZXR1cm4gewogICAgIHZhbHVlOiBlbnRyeS52YWx1ZSwKICAgICBkb25lOiBmYWxzZQogICAgfTsKICAgcmV0dXJuIHsKICAgIHZhbHVlOiBbCiAgICAgZW50cnkua2V5LAogICAgIGVudHJ5LnZhbHVlCiAgICBdLAogICAgZG9uZTogZmFsc2UKICAgfTsKICB9LCBJU19NQVAgPyAnZW50cmllcycgOiAndmFsdWVzJywgIUlTX01BUCwgdHJ1ZSk7CiAgc2V0U3BlY2llcyhDT05TVFJVQ1RPUl9OQU1FKTsKIH0KfTsKCi8qKiovIH0pLAovKiAxNTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKX193X3BkZmpzX3JlcXVpcmVfXygxNTIpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDExNCk7Cl9fd19wZGZqc19yZXF1aXJlX18oNzcpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDExNik7CnZhciBwYXRoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7Cm1vZHVsZS5leHBvcnRzID0gcGF0aC5TZXQ7CgovKioqLyB9KSwKLyogMTUyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBjb2xsZWN0aW9uID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDYpOwp2YXIgY29sbGVjdGlvblN0cm9uZyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUwKTsKbW9kdWxlLmV4cG9ydHMgPSBjb2xsZWN0aW9uKCdTZXQnLCBmdW5jdGlvbiAoaW5pdCkgewogcmV0dXJuIGZ1bmN0aW9uIFNldCgpIHsKICByZXR1cm4gaW5pdCh0aGlzLCBhcmd1bWVudHMubGVuZ3RoID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsKIH07Cn0sIGNvbGxlY3Rpb25TdHJvbmcpOwoKLyoqKi8gfSksCi8qIDE1MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDExNCk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTU0KTsKX193X3BkZmpzX3JlcXVpcmVfXygxMTYpOwp2YXIgcGF0aCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDMpOwptb2R1bGUuZXhwb3J0cyA9IHBhdGguV2Vha01hcDsKCi8qKiovIH0pLAovKiAxNTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGdsb2JhbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTEpOwp2YXIgcmVkZWZpbmVBbGwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyMSk7CnZhciBJbnRlcm5hbE1ldGFkYXRhTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNDcpOwp2YXIgY29sbGVjdGlvbiA9IF9fd19wZGZqc19yZXF1aXJlX18oMTQ2KTsKdmFyIGNvbGxlY3Rpb25XZWFrID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTUpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGVuZm9yY2VJdGVybmFsU3RhdGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDMzKS5lbmZvcmNlOwp2YXIgTkFUSVZFX1dFQUtfTUFQID0gX193X3BkZmpzX3JlcXVpcmVfXygzNCk7CnZhciBJU19JRTExID0gIWdsb2JhbC5BY3RpdmVYT2JqZWN0ICYmICdBY3RpdmVYT2JqZWN0JyBpbiBnbG9iYWw7CnZhciBpc0V4dGVuc2libGUgPSBPYmplY3QuaXNFeHRlbnNpYmxlOwp2YXIgSW50ZXJuYWxXZWFrTWFwOwp2YXIgd3JhcHBlciA9IGZ1bmN0aW9uIChpbml0KSB7CiByZXR1cm4gZnVuY3Rpb24gV2Vha01hcCgpIHsKICByZXR1cm4gaW5pdCh0aGlzLCBhcmd1bWVudHMubGVuZ3RoID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsKIH07Cn07CnZhciAkV2Vha01hcCA9IG1vZHVsZS5leHBvcnRzID0gY29sbGVjdGlvbignV2Vha01hcCcsIHdyYXBwZXIsIGNvbGxlY3Rpb25XZWFrKTsKaWYgKE5BVElWRV9XRUFLX01BUCAmJiBJU19JRTExKSB7CiBJbnRlcm5hbFdlYWtNYXAgPSBjb2xsZWN0aW9uV2Vhay5nZXRDb25zdHJ1Y3Rvcih3cmFwcGVyLCAnV2Vha01hcCcsIHRydWUpOwogSW50ZXJuYWxNZXRhZGF0YU1vZHVsZS5SRVFVSVJFRCA9IHRydWU7CiB2YXIgV2Vha01hcFByb3RvdHlwZSA9ICRXZWFrTWFwLnByb3RvdHlwZTsKIHZhciBuYXRpdmVEZWxldGUgPSBXZWFrTWFwUHJvdG90eXBlWydkZWxldGUnXTsKIHZhciBuYXRpdmVIYXMgPSBXZWFrTWFwUHJvdG90eXBlLmhhczsKIHZhciBuYXRpdmVHZXQgPSBXZWFrTWFwUHJvdG90eXBlLmdldDsKIHZhciBuYXRpdmVTZXQgPSBXZWFrTWFwUHJvdG90eXBlLnNldDsKIHJlZGVmaW5lQWxsKFdlYWtNYXBQcm90b3R5cGUsIHsKICAnZGVsZXRlJzogZnVuY3Rpb24gKGtleSkgewogICBpZiAoaXNPYmplY3Qoa2V5KSAmJiAhaXNFeHRlbnNpYmxlKGtleSkpIHsKICAgIHZhciBzdGF0ZSA9IGVuZm9yY2VJdGVybmFsU3RhdGUodGhpcyk7CiAgICBpZiAoIXN0YXRlLmZyb3plbikKICAgICBzdGF0ZS5mcm96ZW4gPSBuZXcgSW50ZXJuYWxXZWFrTWFwKCk7CiAgICByZXR1cm4gbmF0aXZlRGVsZXRlLmNhbGwodGhpcywga2V5KSB8fCBzdGF0ZS5mcm96ZW5bJ2RlbGV0ZSddKGtleSk7CiAgIH0KICAgcmV0dXJuIG5hdGl2ZURlbGV0ZS5jYWxsKHRoaXMsIGtleSk7CiAgfSwKICBoYXM6IGZ1bmN0aW9uIGhhcyhrZXkpIHsKICAgaWYgKGlzT2JqZWN0KGtleSkgJiYgIWlzRXh0ZW5zaWJsZShrZXkpKSB7CiAgICB2YXIgc3RhdGUgPSBlbmZvcmNlSXRlcm5hbFN0YXRlKHRoaXMpOwogICAgaWYgKCFzdGF0ZS5mcm96ZW4pCiAgICAgc3RhdGUuZnJvemVuID0gbmV3IEludGVybmFsV2Vha01hcCgpOwogICAgcmV0dXJuIG5hdGl2ZUhhcy5jYWxsKHRoaXMsIGtleSkgfHwgc3RhdGUuZnJvemVuLmhhcyhrZXkpOwogICB9CiAgIHJldHVybiBuYXRpdmVIYXMuY2FsbCh0aGlzLCBrZXkpOwogIH0sCiAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7CiAgIGlmIChpc09iamVjdChrZXkpICYmICFpc0V4dGVuc2libGUoa2V5KSkgewogICAgdmFyIHN0YXRlID0gZW5mb3JjZUl0ZXJuYWxTdGF0ZSh0aGlzKTsKICAgIGlmICghc3RhdGUuZnJvemVuKQogICAgIHN0YXRlLmZyb3plbiA9IG5ldyBJbnRlcm5hbFdlYWtNYXAoKTsKICAgIHJldHVybiBuYXRpdmVIYXMuY2FsbCh0aGlzLCBrZXkpID8gbmF0aXZlR2V0LmNhbGwodGhpcywga2V5KSA6IHN0YXRlLmZyb3plbi5nZXQoa2V5KTsKICAgfQogICByZXR1cm4gbmF0aXZlR2V0LmNhbGwodGhpcywga2V5KTsKICB9LAogIHNldDogZnVuY3Rpb24gc2V0KGtleSwgdmFsdWUpIHsKICAgaWYgKGlzT2JqZWN0KGtleSkgJiYgIWlzRXh0ZW5zaWJsZShrZXkpKSB7CiAgICB2YXIgc3RhdGUgPSBlbmZvcmNlSXRlcm5hbFN0YXRlKHRoaXMpOwogICAgaWYgKCFzdGF0ZS5mcm96ZW4pCiAgICAgc3RhdGUuZnJvemVuID0gbmV3IEludGVybmFsV2Vha01hcCgpOwogICAgbmF0aXZlSGFzLmNhbGwodGhpcywga2V5KSA/IG5hdGl2ZVNldC5jYWxsKHRoaXMsIGtleSwgdmFsdWUpIDogc3RhdGUuZnJvemVuLnNldChrZXksIHZhbHVlKTsKICAgfSBlbHNlCiAgICBuYXRpdmVTZXQuY2FsbCh0aGlzLCBrZXksIHZhbHVlKTsKICAgcmV0dXJuIHRoaXM7CiAgfQogfSk7Cn0KCi8qKiovIH0pLAovKiAxNTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIHJlZGVmaW5lQWxsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjEpOwp2YXIgZ2V0V2Vha0RhdGEgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0NykuZ2V0V2Vha0RhdGE7CnZhciBhbk9iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjgpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGFuSW5zdGFuY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyMyk7CnZhciBpdGVyYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXygxMjQpOwp2YXIgQXJyYXlJdGVyYXRpb25Nb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1Nik7CnZhciAkaGFzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMyk7CnZhciBJbnRlcm5hbFN0YXRlTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygzMyk7CnZhciBzZXRJbnRlcm5hbFN0YXRlID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5zZXQ7CnZhciBpbnRlcm5hbFN0YXRlR2V0dGVyRm9yID0gSW50ZXJuYWxTdGF0ZU1vZHVsZS5nZXR0ZXJGb3I7CnZhciBmaW5kID0gQXJyYXlJdGVyYXRpb25Nb2R1bGUuZmluZDsKdmFyIGZpbmRJbmRleCA9IEFycmF5SXRlcmF0aW9uTW9kdWxlLmZpbmRJbmRleDsKdmFyIGlkID0gMDsKdmFyIHVuY2F1Z2h0RnJvemVuU3RvcmUgPSBmdW5jdGlvbiAoc3RvcmUpIHsKIHJldHVybiBzdG9yZS5mcm96ZW4gfHwgKHN0b3JlLmZyb3plbiA9IG5ldyBVbmNhdWdodEZyb3plblN0b3JlKCkpOwp9Owp2YXIgVW5jYXVnaHRGcm96ZW5TdG9yZSA9IGZ1bmN0aW9uICgpIHsKIHRoaXMuZW50cmllcyA9IFtdOwp9Owp2YXIgZmluZFVuY2F1Z2h0RnJvemVuID0gZnVuY3Rpb24gKHN0b3JlLCBrZXkpIHsKIHJldHVybiBmaW5kKHN0b3JlLmVudHJpZXMsIGZ1bmN0aW9uIChpdCkgewogIHJldHVybiBpdFswXSA9PT0ga2V5OwogfSk7Cn07ClVuY2F1Z2h0RnJvemVuU3RvcmUucHJvdG90eXBlID0gewogZ2V0OiBmdW5jdGlvbiAoa2V5KSB7CiAgdmFyIGVudHJ5ID0gZmluZFVuY2F1Z2h0RnJvemVuKHRoaXMsIGtleSk7CiAgaWYgKGVudHJ5KQogICByZXR1cm4gZW50cnlbMV07CiB9LAogaGFzOiBmdW5jdGlvbiAoa2V5KSB7CiAgcmV0dXJuICEhZmluZFVuY2F1Z2h0RnJvemVuKHRoaXMsIGtleSk7CiB9LAogc2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogIHZhciBlbnRyeSA9IGZpbmRVbmNhdWdodEZyb3plbih0aGlzLCBrZXkpOwogIGlmIChlbnRyeSkKICAgZW50cnlbMV0gPSB2YWx1ZTsKICBlbHNlCiAgIHRoaXMuZW50cmllcy5wdXNoKFsKICAgIGtleSwKICAgIHZhbHVlCiAgIF0pOwogfSwKICdkZWxldGUnOiBmdW5jdGlvbiAoa2V5KSB7CiAgdmFyIGluZGV4ID0gZmluZEluZGV4KHRoaXMuZW50cmllcywgZnVuY3Rpb24gKGl0KSB7CiAgIHJldHVybiBpdFswXSA9PT0ga2V5OwogIH0pOwogIGlmICh+aW5kZXgpCiAgIHRoaXMuZW50cmllcy5zcGxpY2UoaW5kZXgsIDEpOwogIHJldHVybiAhIX5pbmRleDsKIH0KfTsKbW9kdWxlLmV4cG9ydHMgPSB7CiBnZXRDb25zdHJ1Y3RvcjogZnVuY3Rpb24gKHdyYXBwZXIsIENPTlNUUlVDVE9SX05BTUUsIElTX01BUCwgQURERVIpIHsKICB2YXIgQyA9IHdyYXBwZXIoZnVuY3Rpb24gKHRoYXQsIGl0ZXJhYmxlKSB7CiAgIGFuSW5zdGFuY2UodGhhdCwgQywgQ09OU1RSVUNUT1JfTkFNRSk7CiAgIHNldEludGVybmFsU3RhdGUodGhhdCwgewogICAgdHlwZTogQ09OU1RSVUNUT1JfTkFNRSwKICAgIGlkOiBpZCsrLAogICAgZnJvemVuOiB1bmRlZmluZWQKICAgfSk7CiAgIGlmIChpdGVyYWJsZSAhPSB1bmRlZmluZWQpCiAgICBpdGVyYXRlKGl0ZXJhYmxlLCB0aGF0W0FEREVSXSwgdGhhdCwgSVNfTUFQKTsKICB9KTsKICB2YXIgZ2V0SW50ZXJuYWxTdGF0ZSA9IGludGVybmFsU3RhdGVHZXR0ZXJGb3IoQ09OU1RSVUNUT1JfTkFNRSk7CiAgdmFyIGRlZmluZSA9IGZ1bmN0aW9uICh0aGF0LCBrZXksIHZhbHVlKSB7CiAgIHZhciBzdGF0ZSA9IGdldEludGVybmFsU3RhdGUodGhhdCk7CiAgIHZhciBkYXRhID0gZ2V0V2Vha0RhdGEoYW5PYmplY3Qoa2V5KSwgdHJ1ZSk7CiAgIGlmIChkYXRhID09PSB0cnVlKQogICAgdW5jYXVnaHRGcm96ZW5TdG9yZShzdGF0ZSkuc2V0KGtleSwgdmFsdWUpOwogICBlbHNlCiAgICBkYXRhW3N0YXRlLmlkXSA9IHZhbHVlOwogICByZXR1cm4gdGhhdDsKICB9OwogIHJlZGVmaW5lQWxsKEMucHJvdG90eXBlLCB7CiAgICdkZWxldGUnOiBmdW5jdGlvbiAoa2V5KSB7CiAgICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpOwogICAgaWYgKCFpc09iamVjdChrZXkpKQogICAgIHJldHVybiBmYWxzZTsKICAgIHZhciBkYXRhID0gZ2V0V2Vha0RhdGEoa2V5KTsKICAgIGlmIChkYXRhID09PSB0cnVlKQogICAgIHJldHVybiB1bmNhdWdodEZyb3plblN0b3JlKHN0YXRlKVsnZGVsZXRlJ10oa2V5KTsKICAgIHJldHVybiBkYXRhICYmICRoYXMoZGF0YSwgc3RhdGUuaWQpICYmIGRlbGV0ZSBkYXRhW3N0YXRlLmlkXTsKICAgfSwKICAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KSB7CiAgICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpOwogICAgaWYgKCFpc09iamVjdChrZXkpKQogICAgIHJldHVybiBmYWxzZTsKICAgIHZhciBkYXRhID0gZ2V0V2Vha0RhdGEoa2V5KTsKICAgIGlmIChkYXRhID09PSB0cnVlKQogICAgIHJldHVybiB1bmNhdWdodEZyb3plblN0b3JlKHN0YXRlKS5oYXMoa2V5KTsKICAgIHJldHVybiBkYXRhICYmICRoYXMoZGF0YSwgc3RhdGUuaWQpOwogICB9CiAgfSk7CiAgcmVkZWZpbmVBbGwoQy5wcm90b3R5cGUsIElTX01BUCA/IHsKICAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7CiAgICB2YXIgc3RhdGUgPSBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpOwogICAgaWYgKGlzT2JqZWN0KGtleSkpIHsKICAgICB2YXIgZGF0YSA9IGdldFdlYWtEYXRhKGtleSk7CiAgICAgaWYgKGRhdGEgPT09IHRydWUpCiAgICAgIHJldHVybiB1bmNhdWdodEZyb3plblN0b3JlKHN0YXRlKS5nZXQoa2V5KTsKICAgICByZXR1cm4gZGF0YSA/IGRhdGFbc3RhdGUuaWRdIDogdW5kZWZpbmVkOwogICAgfQogICB9LAogICBzZXQ6IGZ1bmN0aW9uIHNldChrZXksIHZhbHVlKSB7CiAgICByZXR1cm4gZGVmaW5lKHRoaXMsIGtleSwgdmFsdWUpOwogICB9CiAgfSA6IHsKICAgYWRkOiBmdW5jdGlvbiBhZGQodmFsdWUpIHsKICAgIHJldHVybiBkZWZpbmUodGhpcywgdmFsdWUsIHRydWUpOwogICB9CiAgfSk7CiAgcmV0dXJuIEM7CiB9Cn07CgovKioqLyB9KSwKLyogMTU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBiaW5kID0gX193X3BkZmpzX3JlcXVpcmVfXyg2Mik7CnZhciBJbmRleGVkT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygxOCk7CnZhciB0b09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oODMpOwp2YXIgdG9MZW5ndGggPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ3KTsKdmFyIGFycmF5U3BlY2llc0NyZWF0ZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTU3KTsKdmFyIHB1c2ggPSBbXS5wdXNoOwp2YXIgY3JlYXRlTWV0aG9kID0gZnVuY3Rpb24gKFRZUEUpIHsKIHZhciBJU19NQVAgPSBUWVBFID09IDE7CiB2YXIgSVNfRklMVEVSID0gVFlQRSA9PSAyOwogdmFyIElTX1NPTUUgPSBUWVBFID09IDM7CiB2YXIgSVNfRVZFUlkgPSBUWVBFID09IDQ7CiB2YXIgSVNfRklORF9JTkRFWCA9IFRZUEUgPT0gNjsKIHZhciBOT19IT0xFUyA9IFRZUEUgPT0gNSB8fCBJU19GSU5EX0lOREVYOwogcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgY2FsbGJhY2tmbiwgdGhhdCwgc3BlY2lmaWNDcmVhdGUpIHsKICB2YXIgTyA9IHRvT2JqZWN0KCR0aGlzKTsKICB2YXIgc2VsZiA9IEluZGV4ZWRPYmplY3QoTyk7CiAgdmFyIGJvdW5kRnVuY3Rpb24gPSBiaW5kKGNhbGxiYWNrZm4sIHRoYXQsIDMpOwogIHZhciBsZW5ndGggPSB0b0xlbmd0aChzZWxmLmxlbmd0aCk7CiAgdmFyIGluZGV4ID0gMDsKICB2YXIgY3JlYXRlID0gc3BlY2lmaWNDcmVhdGUgfHwgYXJyYXlTcGVjaWVzQ3JlYXRlOwogIHZhciB0YXJnZXQgPSBJU19NQVAgPyBjcmVhdGUoJHRoaXMsIGxlbmd0aCkgOiBJU19GSUxURVIgPyBjcmVhdGUoJHRoaXMsIDApIDogdW5kZWZpbmVkOwogIHZhciB2YWx1ZSwgcmVzdWx0OwogIGZvciAoOyBsZW5ndGggPiBpbmRleDsgaW5kZXgrKykKICAgaWYgKE5PX0hPTEVTIHx8IGluZGV4IGluIHNlbGYpIHsKICAgIHZhbHVlID0gc2VsZltpbmRleF07CiAgICByZXN1bHQgPSBib3VuZEZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgTyk7CiAgICBpZiAoVFlQRSkgewogICAgIGlmIChJU19NQVApCiAgICAgIHRhcmdldFtpbmRleF0gPSByZXN1bHQ7CiAgICAgZWxzZSBpZiAocmVzdWx0KQogICAgICBzd2l0Y2ggKFRZUEUpIHsKICAgICAgY2FzZSAzOgogICAgICAgcmV0dXJuIHRydWU7CiAgICAgIGNhc2UgNToKICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgY2FzZSA2OgogICAgICAgcmV0dXJuIGluZGV4OwogICAgICBjYXNlIDI6CiAgICAgICBwdXNoLmNhbGwodGFyZ2V0LCB2YWx1ZSk7CiAgICAgIH0KICAgICBlbHNlIGlmIChJU19FVkVSWSkKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICB9CiAgcmV0dXJuIElTX0ZJTkRfSU5ERVggPyAtMSA6IElTX1NPTUUgfHwgSVNfRVZFUlkgPyBJU19FVkVSWSA6IHRhcmdldDsKIH07Cn07Cm1vZHVsZS5leHBvcnRzID0gewogZm9yRWFjaDogY3JlYXRlTWV0aG9kKDApLAogbWFwOiBjcmVhdGVNZXRob2QoMSksCiBmaWx0ZXI6IGNyZWF0ZU1ldGhvZCgyKSwKIHNvbWU6IGNyZWF0ZU1ldGhvZCgzKSwKIGV2ZXJ5OiBjcmVhdGVNZXRob2QoNCksCiBmaW5kOiBjcmVhdGVNZXRob2QoNSksCiBmaW5kSW5kZXg6IGNyZWF0ZU1ldGhvZCg2KQp9OwoKLyoqKi8gfSksCi8qIDE1NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGlzQXJyYXkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1OCk7CnZhciB3ZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU3KTsKdmFyIFNQRUNJRVMgPSB3ZWxsS25vd25TeW1ib2woJ3NwZWNpZXMnKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob3JpZ2luYWxBcnJheSwgbGVuZ3RoKSB7CiB2YXIgQzsKIGlmIChpc0FycmF5KG9yaWdpbmFsQXJyYXkpKSB7CiAgQyA9IG9yaWdpbmFsQXJyYXkuY29uc3RydWN0b3I7CiAgaWYgKHR5cGVvZiBDID09ICdmdW5jdGlvbicgJiYgKEMgPT09IEFycmF5IHx8IGlzQXJyYXkoQy5wcm90b3R5cGUpKSkKICAgQyA9IHVuZGVmaW5lZDsKICBlbHNlIGlmIChpc09iamVjdChDKSkgewogICBDID0gQ1tTUEVDSUVTXTsKICAgaWYgKEMgPT09IG51bGwpCiAgICBDID0gdW5kZWZpbmVkOwogIH0KIH0KIHJldHVybiBuZXcgKEMgPT09IHVuZGVmaW5lZCA/IEFycmF5IDogQykobGVuZ3RoID09PSAwID8gMCA6IGxlbmd0aCk7Cn07CgovKioqLyB9KSwKLyogMTU4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBjbGFzc29mID0gX193X3BkZmpzX3JlcXVpcmVfXygxOSk7Cm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZykgewogcmV0dXJuIGNsYXNzb2YoYXJnKSA9PSAnQXJyYXknOwp9OwoKLyoqKi8gfSksCi8qIDE1OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDExNCk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTYwKTsKX193X3BkZmpzX3JlcXVpcmVfXygxMTYpOwp2YXIgcGF0aCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDMpOwptb2R1bGUuZXhwb3J0cyA9IHBhdGguV2Vha1NldDsKCi8qKiovIH0pLAovKiAxNjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIGNvbGxlY3Rpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0Nik7CnZhciBjb2xsZWN0aW9uV2VhayA9IF9fd19wZGZqc19yZXF1aXJlX18oMTU1KTsKY29sbGVjdGlvbignV2Vha1NldCcsIGZ1bmN0aW9uIChpbml0KSB7CiByZXR1cm4gZnVuY3Rpb24gV2Vha1NldCgpIHsKICByZXR1cm4gaW5pdCh0aGlzLCBhcmd1bWVudHMubGVuZ3RoID8gYXJndW1lbnRzWzBdIDogdW5kZWZpbmVkKTsKIH07Cn0sIGNvbGxlY3Rpb25XZWFrKTsKCi8qKiovIH0pLAovKiAxNjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKX193X3BkZmpzX3JlcXVpcmVfXygxNjIpOwp2YXIgZW50cnlVbmJpbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDYxKTsKbW9kdWxlLmV4cG9ydHMgPSBlbnRyeVVuYmluZCgnU3RyaW5nJywgJ2NvZGVQb2ludEF0Jyk7CgovKioqLyB9KSwKLyogMTYyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciAkID0gX193X3BkZmpzX3JlcXVpcmVfXygxMCk7CnZhciBjb2RlQXQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDc4KS5jb2RlQXQ7CiQoewogdGFyZ2V0OiAnU3RyaW5nJywKIHByb3RvOiB0cnVlCn0sIHsKIGNvZGVQb2ludEF0OiBmdW5jdGlvbiBjb2RlUG9pbnRBdChwb3MpIHsKICByZXR1cm4gY29kZUF0KHRoaXMsIHBvcyk7CiB9Cn0pOwoKLyoqKi8gfSksCi8qIDE2MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDE2NCk7CnZhciBwYXRoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7Cm1vZHVsZS5leHBvcnRzID0gcGF0aC5TdHJpbmcuZnJvbUNvZGVQb2ludDsKCi8qKiovIH0pLAovKiAxNjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIHRvQWJzb2x1dGVJbmRleCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDkpOwp2YXIgZnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZTsKdmFyIG5hdGl2ZUZyb21Db2RlUG9pbnQgPSBTdHJpbmcuZnJvbUNvZGVQb2ludDsKdmFyIElOQ09SUkVDVF9MRU5HVEggPSAhIW5hdGl2ZUZyb21Db2RlUG9pbnQgJiYgbmF0aXZlRnJvbUNvZGVQb2ludC5sZW5ndGggIT0gMTsKJCh7CiB0YXJnZXQ6ICdTdHJpbmcnLAogc3RhdDogdHJ1ZSwKIGZvcmNlZDogSU5DT1JSRUNUX0xFTkdUSAp9LCB7CiBmcm9tQ29kZVBvaW50OiBmdW5jdGlvbiBmcm9tQ29kZVBvaW50KHgpIHsKICB2YXIgZWxlbWVudHMgPSBbXTsKICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsKICB2YXIgaSA9IDA7CiAgdmFyIGNvZGU7CiAgd2hpbGUgKGxlbmd0aCA+IGkpIHsKICAgY29kZSA9ICthcmd1bWVudHNbaSsrXTsKICAgaWYgKHRvQWJzb2x1dGVJbmRleChjb2RlLCAweDEwRkZGRikgIT09IGNvZGUpCiAgICB0aHJvdyBSYW5nZUVycm9yKGNvZGUgKyAnIGlzIG5vdCBhIHZhbGlkIGNvZGUgcG9pbnQnKTsKICAgZWxlbWVudHMucHVzaChjb2RlIDwgMHgxMDAwMCA/IGZyb21DaGFyQ29kZShjb2RlKSA6IGZyb21DaGFyQ29kZSgoKGNvZGUgLT0gMHgxMDAwMCkgPj4gMTApICsgMHhEODAwLCBjb2RlICUgMHg0MDAgKyAweERDMDApKTsKICB9CiAgcmV0dXJuIGVsZW1lbnRzLmpvaW4oJycpOwogfQp9KTsKCi8qKiovIH0pLAovKiAxNjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKX193X3BkZmpzX3JlcXVpcmVfXygxNjYpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDExNCk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTY4KTsKX193X3BkZmpzX3JlcXVpcmVfXygxNzIpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDE3Myk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTc0KTsKX193X3BkZmpzX3JlcXVpcmVfXygxNzUpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDE3Nik7Cl9fd19wZGZqc19yZXF1aXJlX18oMTc3KTsKX193X3BkZmpzX3JlcXVpcmVfXygxNzgpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDE3OSk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTgwKTsKX193X3BkZmpzX3JlcXVpcmVfXygxODEpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDE4Mik7Cl9fd19wZGZqc19yZXF1aXJlX18oMTgzKTsKX193X3BkZmpzX3JlcXVpcmVfXygxODQpOwpfX3dfcGRmanNfcmVxdWlyZV9fKDE4NSk7Cl9fd19wZGZqc19yZXF1aXJlX18oMTg2KTsKX193X3BkZmpzX3JlcXVpcmVfXygxODcpOwp2YXIgcGF0aCA9IF9fd19wZGZqc19yZXF1aXJlX18oNDMpOwptb2R1bGUuZXhwb3J0cyA9IHBhdGguU3ltYm9sOwoKLyoqKi8gfSksCi8qIDE2NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgZmFpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKdmFyIGlzQXJyYXkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1OCk7CnZhciBpc09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjIpOwp2YXIgdG9PYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDgzKTsKdmFyIHRvTGVuZ3RoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Nyk7CnZhciBjcmVhdGVQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oOTMpOwp2YXIgYXJyYXlTcGVjaWVzQ3JlYXRlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTcpOwp2YXIgYXJyYXlNZXRob2RIYXNTcGVjaWVzU3VwcG9ydCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTY3KTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgVjhfVkVSU0lPTiA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMzKTsKdmFyIElTX0NPTkNBVF9TUFJFQURBQkxFID0gd2VsbEtub3duU3ltYm9sKCdpc0NvbmNhdFNwcmVhZGFibGUnKTsKdmFyIE1BWF9TQUZFX0lOVEVHRVIgPSAweDFGRkZGRkZGRkZGRkZGOwp2YXIgTUFYSU1VTV9BTExPV0VEX0lOREVYX0VYQ0VFREVEID0gJ01heGltdW0gYWxsb3dlZCBpbmRleCBleGNlZWRlZCc7CnZhciBJU19DT05DQVRfU1BSRUFEQUJMRV9TVVBQT1JUID0gVjhfVkVSU0lPTiA+PSA1MSB8fCAhZmFpbHMoZnVuY3Rpb24gKCkgewogdmFyIGFycmF5ID0gW107CiBhcnJheVtJU19DT05DQVRfU1BSRUFEQUJMRV0gPSBmYWxzZTsKIHJldHVybiBhcnJheS5jb25jYXQoKVswXSAhPT0gYXJyYXk7Cn0pOwp2YXIgU1BFQ0lFU19TVVBQT1JUID0gYXJyYXlNZXRob2RIYXNTcGVjaWVzU3VwcG9ydCgnY29uY2F0Jyk7CnZhciBpc0NvbmNhdFNwcmVhZGFibGUgPSBmdW5jdGlvbiAoTykgewogaWYgKCFpc09iamVjdChPKSkKICByZXR1cm4gZmFsc2U7CiB2YXIgc3ByZWFkYWJsZSA9IE9bSVNfQ09OQ0FUX1NQUkVBREFCTEVdOwogcmV0dXJuIHNwcmVhZGFibGUgIT09IHVuZGVmaW5lZCA/ICEhc3ByZWFkYWJsZSA6IGlzQXJyYXkoTyk7Cn07CnZhciBGT1JDRUQgPSAhSVNfQ09OQ0FUX1NQUkVBREFCTEVfU1VQUE9SVCB8fCAhU1BFQ0lFU19TVVBQT1JUOwokKHsKIHRhcmdldDogJ0FycmF5JywKIHByb3RvOiB0cnVlLAogZm9yY2VkOiBGT1JDRUQKfSwgewogY29uY2F0OiBmdW5jdGlvbiBjb25jYXQoYXJnKSB7CiAgdmFyIE8gPSB0b09iamVjdCh0aGlzKTsKICB2YXIgQSA9IGFycmF5U3BlY2llc0NyZWF0ZShPLCAwKTsKICB2YXIgbiA9IDA7CiAgdmFyIGksIGssIGxlbmd0aCwgbGVuLCBFOwogIGZvciAoaSA9IC0xLCBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgRSA9IGkgPT09IC0xID8gTyA6IGFyZ3VtZW50c1tpXTsKICAgaWYgKGlzQ29uY2F0U3ByZWFkYWJsZShFKSkgewogICAgbGVuID0gdG9MZW5ndGgoRS5sZW5ndGgpOwogICAgaWYgKG4gKyBsZW4gPiBNQVhfU0FGRV9JTlRFR0VSKQogICAgIHRocm93IFR5cGVFcnJvcihNQVhJTVVNX0FMTE9XRURfSU5ERVhfRVhDRUVERUQpOwogICAgZm9yIChrID0gMDsgayA8IGxlbjsgaysrLCBuKyspCiAgICAgaWYgKGsgaW4gRSkKICAgICAgY3JlYXRlUHJvcGVydHkoQSwgbiwgRVtrXSk7CiAgIH0gZWxzZSB7CiAgICBpZiAobiA+PSBNQVhfU0FGRV9JTlRFR0VSKQogICAgIHRocm93IFR5cGVFcnJvcihNQVhJTVVNX0FMTE9XRURfSU5ERVhfRVhDRUVERUQpOwogICAgY3JlYXRlUHJvcGVydHkoQSwgbisrLCBFKTsKICAgfQogIH0KICBBLmxlbmd0aCA9IG47CiAgcmV0dXJuIEE7CiB9Cn0pOwoKLyoqKi8gfSksCi8qIDE2NyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZmFpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE0KTsKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwp2YXIgVjhfVkVSU0lPTiA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMzKTsKdmFyIFNQRUNJRVMgPSB3ZWxsS25vd25TeW1ib2woJ3NwZWNpZXMnKTsKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoTUVUSE9EX05BTUUpIHsKIHJldHVybiBWOF9WRVJTSU9OID49IDUxIHx8ICFmYWlscyhmdW5jdGlvbiAoKSB7CiAgdmFyIGFycmF5ID0gW107CiAgdmFyIGNvbnN0cnVjdG9yID0gYXJyYXkuY29uc3RydWN0b3IgPSB7fTsKICBjb25zdHJ1Y3RvcltTUEVDSUVTXSA9IGZ1bmN0aW9uICgpIHsKICAgcmV0dXJuIHsgZm9vOiAxIH07CiAgfTsKICByZXR1cm4gYXJyYXlbTUVUSE9EX05BTUVdKEJvb2xlYW4pLmZvbyAhPT0gMTsKIH0pOwp9OwoKLyoqKi8gfSksCi8qIDE2OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgJCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgZ2xvYmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygxMSk7CnZhciBnZXRCdWlsdEluID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Mik7CnZhciBJU19QVVJFID0gX193X3BkZmpzX3JlcXVpcmVfXygzNyk7CnZhciBERVNDUklQVE9SUyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTMpOwp2YXIgTkFUSVZFX1NZTUJPTCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTgpOwp2YXIgVVNFX1NZTUJPTF9BU19VSUQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDU5KTsKdmFyIGZhaWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygxNCk7CnZhciBoYXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIGlzQXJyYXkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE1OCk7CnZhciBpc09iamVjdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjIpOwp2YXIgYW5PYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDI4KTsKdmFyIHRvT2JqZWN0ID0gX193X3BkZmpzX3JlcXVpcmVfXyg4Myk7CnZhciB0b0luZGV4ZWRPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3KTsKdmFyIHRvUHJpbWl0aXZlID0gX193X3BkZmpzX3JlcXVpcmVfXygyMSk7CnZhciBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE2KTsKdmFyIG5hdGl2ZU9iamVjdENyZWF0ZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNzEpOwp2YXIgb2JqZWN0S2V5cyA9IF9fd19wZGZqc19yZXF1aXJlX18oNzMpOwp2YXIgZ2V0T3duUHJvcGVydHlOYW1lc01vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oNDQpOwp2YXIgZ2V0T3duUHJvcGVydHlOYW1lc0V4dGVybmFsID0gX193X3BkZmpzX3JlcXVpcmVfXygxNjkpOwp2YXIgZ2V0T3duUHJvcGVydHlTeW1ib2xzTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXyg1MSk7CnZhciBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEyKTsKdmFyIGRlZmluZVByb3BlcnR5TW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygyNyk7CnZhciBwcm9wZXJ0eUlzRW51bWVyYWJsZU1vZHVsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMTUpOwp2YXIgY3JlYXRlTm9uRW51bWVyYWJsZVByb3BlcnR5ID0gX193X3BkZmpzX3JlcXVpcmVfXygyNik7CnZhciByZWRlZmluZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjkpOwp2YXIgc2hhcmVkID0gX193X3BkZmpzX3JlcXVpcmVfXygzNik7CnZhciBzaGFyZWRLZXkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM1KTsKdmFyIGhpZGRlbktleXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDM5KTsKdmFyIHVpZCA9IF9fd19wZGZqc19yZXF1aXJlX18oMzgpOwp2YXIgd2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXyg1Nyk7CnZhciB3cmFwcGVkV2VsbEtub3duU3ltYm9sTW9kdWxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzApOwp2YXIgZGVmaW5lV2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzEpOwp2YXIgc2V0VG9TdHJpbmdUYWcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDg1KTsKdmFyIEludGVybmFsU3RhdGVNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDMzKTsKdmFyICRmb3JFYWNoID0gX193X3BkZmpzX3JlcXVpcmVfXygxNTYpLmZvckVhY2g7CnZhciBISURERU4gPSBzaGFyZWRLZXkoJ2hpZGRlbicpOwp2YXIgU1lNQk9MID0gJ1N5bWJvbCc7CnZhciBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsKdmFyIFRPX1BSSU1JVElWRSA9IHdlbGxLbm93blN5bWJvbCgndG9QcmltaXRpdmUnKTsKdmFyIHNldEludGVybmFsU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLnNldDsKdmFyIGdldEludGVybmFsU3RhdGUgPSBJbnRlcm5hbFN0YXRlTW9kdWxlLmdldHRlckZvcihTWU1CT0wpOwp2YXIgT2JqZWN0UHJvdG90eXBlID0gT2JqZWN0W1BST1RPVFlQRV07CnZhciAkU3ltYm9sID0gZ2xvYmFsLlN5bWJvbDsKdmFyICRzdHJpbmdpZnkgPSBnZXRCdWlsdEluKCdKU09OJywgJ3N0cmluZ2lmeScpOwp2YXIgbmF0aXZlR2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yTW9kdWxlLmY7CnZhciBuYXRpdmVEZWZpbmVQcm9wZXJ0eSA9IGRlZmluZVByb3BlcnR5TW9kdWxlLmY7CnZhciBuYXRpdmVHZXRPd25Qcm9wZXJ0eU5hbWVzID0gZ2V0T3duUHJvcGVydHlOYW1lc0V4dGVybmFsLmY7CnZhciBuYXRpdmVQcm9wZXJ0eUlzRW51bWVyYWJsZSA9IHByb3BlcnR5SXNFbnVtZXJhYmxlTW9kdWxlLmY7CnZhciBBbGxTeW1ib2xzID0gc2hhcmVkKCdzeW1ib2xzJyk7CnZhciBPYmplY3RQcm90b3R5cGVTeW1ib2xzID0gc2hhcmVkKCdvcC1zeW1ib2xzJyk7CnZhciBTdHJpbmdUb1N5bWJvbFJlZ2lzdHJ5ID0gc2hhcmVkKCdzdHJpbmctdG8tc3ltYm9sLXJlZ2lzdHJ5Jyk7CnZhciBTeW1ib2xUb1N0cmluZ1JlZ2lzdHJ5ID0gc2hhcmVkKCdzeW1ib2wtdG8tc3RyaW5nLXJlZ2lzdHJ5Jyk7CnZhciBXZWxsS25vd25TeW1ib2xzU3RvcmUgPSBzaGFyZWQoJ3drcycpOwp2YXIgUU9iamVjdCA9IGdsb2JhbC5RT2JqZWN0Owp2YXIgVVNFX1NFVFRFUiA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7CnZhciBzZXRTeW1ib2xEZXNjcmlwdG9yID0gREVTQ1JJUFRPUlMgJiYgZmFpbHMoZnVuY3Rpb24gKCkgewogcmV0dXJuIG5hdGl2ZU9iamVjdENyZWF0ZShuYXRpdmVEZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7CiAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgIHJldHVybiBuYXRpdmVEZWZpbmVQcm9wZXJ0eSh0aGlzLCAnYScsIHsgdmFsdWU6IDcgfSkuYTsKICB9CiB9KSkuYSAhPSA3Owp9KSA/IGZ1bmN0aW9uIChPLCBQLCBBdHRyaWJ1dGVzKSB7CiB2YXIgT2JqZWN0UHJvdG90eXBlRGVzY3JpcHRvciA9IG5hdGl2ZUdldE93blByb3BlcnR5RGVzY3JpcHRvcihPYmplY3RQcm90b3R5cGUsIFApOwogaWYgKE9iamVjdFByb3RvdHlwZURlc2NyaXB0b3IpCiAgZGVsZXRlIE9iamVjdFByb3RvdHlwZVtQXTsKIG5hdGl2ZURlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpOwogaWYgKE9iamVjdFByb3RvdHlwZURlc2NyaXB0b3IgJiYgTyAhPT0gT2JqZWN0UHJvdG90eXBlKSB7CiAgbmF0aXZlRGVmaW5lUHJvcGVydHkoT2JqZWN0UHJvdG90eXBlLCBQLCBPYmplY3RQcm90b3R5cGVEZXNjcmlwdG9yKTsKIH0KfSA6IG5hdGl2ZURlZmluZVByb3BlcnR5Owp2YXIgd3JhcCA9IGZ1bmN0aW9uICh0YWcsIGRlc2NyaXB0aW9uKSB7CiB2YXIgc3ltYm9sID0gQWxsU3ltYm9sc1t0YWddID0gbmF0aXZlT2JqZWN0Q3JlYXRlKCRTeW1ib2xbUFJPVE9UWVBFXSk7CiBzZXRJbnRlcm5hbFN0YXRlKHN5bWJvbCwgewogIHR5cGU6IFNZTUJPTCwKICB0YWc6IHRhZywKICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24KIH0pOwogaWYgKCFERVNDUklQVE9SUykKICBzeW1ib2wuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjsKIHJldHVybiBzeW1ib2w7Cn07CnZhciBpc1N5bWJvbCA9IFVTRV9TWU1CT0xfQVNfVUlEID8gZnVuY3Rpb24gKGl0KSB7CiByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOwp9IDogZnVuY3Rpb24gKGl0KSB7CiByZXR1cm4gT2JqZWN0KGl0KSBpbnN0YW5jZW9mICRTeW1ib2w7Cn07CnZhciAkZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKSB7CiBpZiAoTyA9PT0gT2JqZWN0UHJvdG90eXBlKQogICRkZWZpbmVQcm9wZXJ0eShPYmplY3RQcm90b3R5cGVTeW1ib2xzLCBQLCBBdHRyaWJ1dGVzKTsKIGFuT2JqZWN0KE8pOwogdmFyIGtleSA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOwogYW5PYmplY3QoQXR0cmlidXRlcyk7CiBpZiAoaGFzKEFsbFN5bWJvbHMsIGtleSkpIHsKICBpZiAoIUF0dHJpYnV0ZXMuZW51bWVyYWJsZSkgewogICBpZiAoIWhhcyhPLCBISURERU4pKQogICAgbmF0aXZlRGVmaW5lUHJvcGVydHkoTywgSElEREVOLCBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IoMSwge30pKTsKICAgT1tISURERU5dW2tleV0gPSB0cnVlOwogIH0gZWxzZSB7CiAgIGlmIChoYXMoTywgSElEREVOKSAmJiBPW0hJRERFTl1ba2V5XSkKICAgIE9bSElEREVOXVtrZXldID0gZmFsc2U7CiAgIEF0dHJpYnV0ZXMgPSBuYXRpdmVPYmplY3RDcmVhdGUoQXR0cmlidXRlcywgeyBlbnVtZXJhYmxlOiBjcmVhdGVQcm9wZXJ0eURlc2NyaXB0b3IoMCwgZmFsc2UpIH0pOwogIH0KICByZXR1cm4gc2V0U3ltYm9sRGVzY3JpcHRvcihPLCBrZXksIEF0dHJpYnV0ZXMpOwogfQogcmV0dXJuIG5hdGl2ZURlZmluZVByb3BlcnR5KE8sIGtleSwgQXR0cmlidXRlcyk7Cn07CnZhciAkZGVmaW5lUHJvcGVydGllcyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcykgewogYW5PYmplY3QoTyk7CiB2YXIgcHJvcGVydGllcyA9IHRvSW5kZXhlZE9iamVjdChQcm9wZXJ0aWVzKTsKIHZhciBrZXlzID0gb2JqZWN0S2V5cyhwcm9wZXJ0aWVzKS5jb25jYXQoJGdldE93blByb3BlcnR5U3ltYm9scyhwcm9wZXJ0aWVzKSk7CiAkZm9yRWFjaChrZXlzLCBmdW5jdGlvbiAoa2V5KSB7CiAgaWYgKCFERVNDUklQVE9SUyB8fCAkcHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChwcm9wZXJ0aWVzLCBrZXkpKQogICAkZGVmaW5lUHJvcGVydHkoTywga2V5LCBwcm9wZXJ0aWVzW2tleV0pOwogfSk7CiByZXR1cm4gTzsKfTsKdmFyICRjcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoTywgUHJvcGVydGllcykgewogcmV0dXJuIFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCA/IG5hdGl2ZU9iamVjdENyZWF0ZShPKSA6ICRkZWZpbmVQcm9wZXJ0aWVzKG5hdGl2ZU9iamVjdENyZWF0ZShPKSwgUHJvcGVydGllcyk7Cn07CnZhciAkcHJvcGVydHlJc0VudW1lcmFibGUgPSBmdW5jdGlvbiBwcm9wZXJ0eUlzRW51bWVyYWJsZShWKSB7CiB2YXIgUCA9IHRvUHJpbWl0aXZlKFYsIHRydWUpOwogdmFyIGVudW1lcmFibGUgPSBuYXRpdmVQcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHRoaXMsIFApOwogaWYgKHRoaXMgPT09IE9iamVjdFByb3RvdHlwZSAmJiBoYXMoQWxsU3ltYm9scywgUCkgJiYgIWhhcyhPYmplY3RQcm90b3R5cGVTeW1ib2xzLCBQKSkKICByZXR1cm4gZmFsc2U7CiByZXR1cm4gZW51bWVyYWJsZSB8fCAhaGFzKHRoaXMsIFApIHx8ICFoYXMoQWxsU3ltYm9scywgUCkgfHwgaGFzKHRoaXMsIEhJRERFTikgJiYgdGhpc1tISURERU5dW1BdID8gZW51bWVyYWJsZSA6IHRydWU7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApIHsKIHZhciBpdCA9IHRvSW5kZXhlZE9iamVjdChPKTsKIHZhciBrZXkgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKTsKIGlmIChpdCA9PT0gT2JqZWN0UHJvdG90eXBlICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoT2JqZWN0UHJvdG90eXBlU3ltYm9scywga2V5KSkKICByZXR1cm47CiB2YXIgZGVzY3JpcHRvciA9IG5hdGl2ZUdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KTsKIGlmIChkZXNjcmlwdG9yICYmIGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICEoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSkpIHsKICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSB0cnVlOwogfQogcmV0dXJuIGRlc2NyaXB0b3I7Cn07CnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoTykgewogdmFyIG5hbWVzID0gbmF0aXZlR2V0T3duUHJvcGVydHlOYW1lcyh0b0luZGV4ZWRPYmplY3QoTykpOwogdmFyIHJlc3VsdCA9IFtdOwogJGZvckVhY2gobmFtZXMsIGZ1bmN0aW9uIChrZXkpIHsKICBpZiAoIWhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFoYXMoaGlkZGVuS2V5cywga2V5KSkKICAgcmVzdWx0LnB1c2goa2V5KTsKIH0pOwogcmV0dXJuIHJlc3VsdDsKfTsKdmFyICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMoTykgewogdmFyIElTX09CSkVDVF9QUk9UT1RZUEUgPSBPID09PSBPYmplY3RQcm90b3R5cGU7CiB2YXIgbmFtZXMgPSBuYXRpdmVHZXRPd25Qcm9wZXJ0eU5hbWVzKElTX09CSkVDVF9QUk9UT1RZUEUgPyBPYmplY3RQcm90b3R5cGVTeW1ib2xzIDogdG9JbmRleGVkT2JqZWN0KE8pKTsKIHZhciByZXN1bHQgPSBbXTsKICRmb3JFYWNoKG5hbWVzLCBmdW5jdGlvbiAoa2V5KSB7CiAgaWYgKGhhcyhBbGxTeW1ib2xzLCBrZXkpICYmICghSVNfT0JKRUNUX1BST1RPVFlQRSB8fCBoYXMoT2JqZWN0UHJvdG90eXBlLCBrZXkpKSkgewogICByZXN1bHQucHVzaChBbGxTeW1ib2xzW2tleV0pOwogIH0KIH0pOwogcmV0dXJuIHJlc3VsdDsKfTsKaWYgKCFOQVRJVkVfU1lNQk9MKSB7CiAkU3ltYm9sID0gZnVuY3Rpb24gU3ltYm9sKCkgewogIGlmICh0aGlzIGluc3RhbmNlb2YgJFN5bWJvbCkKICAgdGhyb3cgVHlwZUVycm9yKCdTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3InKTsKICB2YXIgZGVzY3JpcHRpb24gPSAhYXJndW1lbnRzLmxlbmd0aCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IFN0cmluZyhhcmd1bWVudHNbMF0pOwogIHZhciB0YWcgPSB1aWQoZGVzY3JpcHRpb24pOwogIHZhciBzZXR0ZXIgPSBmdW5jdGlvbiAodmFsdWUpIHsKICAgaWYgKHRoaXMgPT09IE9iamVjdFByb3RvdHlwZSkKICAgIHNldHRlci5jYWxsKE9iamVjdFByb3RvdHlwZVN5bWJvbHMsIHZhbHVlKTsKICAgaWYgKGhhcyh0aGlzLCBISURERU4pICYmIGhhcyh0aGlzW0hJRERFTl0sIHRhZykpCiAgICB0aGlzW0hJRERFTl1bdGFnXSA9IGZhbHNlOwogICBzZXRTeW1ib2xEZXNjcmlwdG9yKHRoaXMsIHRhZywgY3JlYXRlUHJvcGVydHlEZXNjcmlwdG9yKDEsIHZhbHVlKSk7CiAgfTsKICBpZiAoREVTQ1JJUFRPUlMgJiYgVVNFX1NFVFRFUikKICAgc2V0U3ltYm9sRGVzY3JpcHRvcihPYmplY3RQcm90b3R5cGUsIHRhZywgewogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgc2V0OiBzZXR0ZXIKICAgfSk7CiAgcmV0dXJuIHdyYXAodGFnLCBkZXNjcmlwdGlvbik7CiB9OwogcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpIHsKICByZXR1cm4gZ2V0SW50ZXJuYWxTdGF0ZSh0aGlzKS50YWc7CiB9KTsKIHJlZGVmaW5lKCRTeW1ib2wsICd3aXRob3V0U2V0dGVyJywgZnVuY3Rpb24gKGRlc2NyaXB0aW9uKSB7CiAgcmV0dXJuIHdyYXAodWlkKGRlc2NyaXB0aW9uKSwgZGVzY3JpcHRpb24pOwogfSk7CiBwcm9wZXJ0eUlzRW51bWVyYWJsZU1vZHVsZS5mID0gJHByb3BlcnR5SXNFbnVtZXJhYmxlOwogZGVmaW5lUHJvcGVydHlNb2R1bGUuZiA9ICRkZWZpbmVQcm9wZXJ0eTsKIGdldE93blByb3BlcnR5RGVzY3JpcHRvck1vZHVsZS5mID0gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKIGdldE93blByb3BlcnR5TmFtZXNNb2R1bGUuZiA9IGdldE93blByb3BlcnR5TmFtZXNFeHRlcm5hbC5mID0gJGdldE93blByb3BlcnR5TmFtZXM7CiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHNNb2R1bGUuZiA9ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHM7CiB3cmFwcGVkV2VsbEtub3duU3ltYm9sTW9kdWxlLmYgPSBmdW5jdGlvbiAobmFtZSkgewogIHJldHVybiB3cmFwKHdlbGxLbm93blN5bWJvbChuYW1lKSwgbmFtZSk7CiB9OwogaWYgKERFU0NSSVBUT1JTKSB7CiAgbmF0aXZlRGVmaW5lUHJvcGVydHkoJFN5bWJvbFtQUk9UT1RZUEVdLCAnZGVzY3JpcHRpb24nLCB7CiAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgZ2V0OiBmdW5jdGlvbiBkZXNjcmlwdGlvbigpIHsKICAgIHJldHVybiBnZXRJbnRlcm5hbFN0YXRlKHRoaXMpLmRlc2NyaXB0aW9uOwogICB9CiAgfSk7CiAgaWYgKCFJU19QVVJFKSB7CiAgIHJlZGVmaW5lKE9iamVjdFByb3RvdHlwZSwgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJywgJHByb3BlcnR5SXNFbnVtZXJhYmxlLCB7IHVuc2FmZTogdHJ1ZSB9KTsKICB9CiB9Cn0KJCh7CiBnbG9iYWw6IHRydWUsCiB3cmFwOiB0cnVlLAogZm9yY2VkOiAhTkFUSVZFX1NZTUJPTCwKIHNoYW06ICFOQVRJVkVfU1lNQk9MCn0sIHsgU3ltYm9sOiAkU3ltYm9sIH0pOwokZm9yRWFjaChvYmplY3RLZXlzKFdlbGxLbm93blN5bWJvbHNTdG9yZSksIGZ1bmN0aW9uIChuYW1lKSB7CiBkZWZpbmVXZWxsS25vd25TeW1ib2wobmFtZSk7Cn0pOwokKHsKIHRhcmdldDogU1lNQk9MLAogc3RhdDogdHJ1ZSwKIGZvcmNlZDogIU5BVElWRV9TWU1CT0wKfSwgewogJ2Zvcic6IGZ1bmN0aW9uIChrZXkpIHsKICB2YXIgc3RyaW5nID0gU3RyaW5nKGtleSk7CiAgaWYgKGhhcyhTdHJpbmdUb1N5bWJvbFJlZ2lzdHJ5LCBzdHJpbmcpKQogICByZXR1cm4gU3RyaW5nVG9TeW1ib2xSZWdpc3RyeVtzdHJpbmddOwogIHZhciBzeW1ib2wgPSAkU3ltYm9sKHN0cmluZyk7CiAgU3RyaW5nVG9TeW1ib2xSZWdpc3RyeVtzdHJpbmddID0gc3ltYm9sOwogIFN5bWJvbFRvU3RyaW5nUmVnaXN0cnlbc3ltYm9sXSA9IHN0cmluZzsKICByZXR1cm4gc3ltYm9sOwogfSwKIGtleUZvcjogZnVuY3Rpb24ga2V5Rm9yKHN5bSkgewogIGlmICghaXNTeW1ib2woc3ltKSkKICAgdGhyb3cgVHlwZUVycm9yKHN5bSArICcgaXMgbm90IGEgc3ltYm9sJyk7CiAgaWYgKGhhcyhTeW1ib2xUb1N0cmluZ1JlZ2lzdHJ5LCBzeW0pKQogICByZXR1cm4gU3ltYm9sVG9TdHJpbmdSZWdpc3RyeVtzeW1dOwogfSwKIHVzZVNldHRlcjogZnVuY3Rpb24gKCkgewogIFVTRV9TRVRURVIgPSB0cnVlOwogfSwKIHVzZVNpbXBsZTogZnVuY3Rpb24gKCkgewogIFVTRV9TRVRURVIgPSBmYWxzZTsKIH0KfSk7CiQoewogdGFyZ2V0OiAnT2JqZWN0JywKIHN0YXQ6IHRydWUsCiBmb3JjZWQ6ICFOQVRJVkVfU1lNQk9MLAogc2hhbTogIURFU0NSSVBUT1JTCn0sIHsKIGNyZWF0ZTogJGNyZWF0ZSwKIGRlZmluZVByb3BlcnR5OiAkZGVmaW5lUHJvcGVydHksCiBkZWZpbmVQcm9wZXJ0aWVzOiAkZGVmaW5lUHJvcGVydGllcywKIGdldE93blByb3BlcnR5RGVzY3JpcHRvcjogJGdldE93blByb3BlcnR5RGVzY3JpcHRvcgp9KTsKJCh7CiB0YXJnZXQ6ICdPYmplY3QnLAogc3RhdDogdHJ1ZSwKIGZvcmNlZDogIU5BVElWRV9TWU1CT0wKfSwgewogZ2V0T3duUHJvcGVydHlOYW1lczogJGdldE93blByb3BlcnR5TmFtZXMsCiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMKfSk7CiQoewogdGFyZ2V0OiAnT2JqZWN0JywKIHN0YXQ6IHRydWUsCiBmb3JjZWQ6IGZhaWxzKGZ1bmN0aW9uICgpIHsKICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHNNb2R1bGUuZigxKTsKIH0pCn0sIHsKIGdldE93blByb3BlcnR5U3ltYm9sczogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlTeW1ib2xzKGl0KSB7CiAgcmV0dXJuIGdldE93blByb3BlcnR5U3ltYm9sc01vZHVsZS5mKHRvT2JqZWN0KGl0KSk7CiB9Cn0pOwppZiAoJHN0cmluZ2lmeSkgewogdmFyIEZPUkNFRF9KU09OX1NUUklOR0lGWSA9ICFOQVRJVkVfU1lNQk9MIHx8IGZhaWxzKGZ1bmN0aW9uICgpIHsKICB2YXIgc3ltYm9sID0gJFN5bWJvbCgpOwogIHJldHVybiAkc3RyaW5naWZ5KFtzeW1ib2xdKSAhPSAnW251bGxdJyB8fCAkc3RyaW5naWZ5KHsgYTogc3ltYm9sIH0pICE9ICd7fScgfHwgJHN0cmluZ2lmeShPYmplY3Qoc3ltYm9sKSkgIT0gJ3t9JzsKIH0pOwogJCh7CiAgdGFyZ2V0OiAnSlNPTicsCiAgc3RhdDogdHJ1ZSwKICBmb3JjZWQ6IEZPUkNFRF9KU09OX1NUUklOR0lGWQogfSwgewogIHN0cmluZ2lmeTogZnVuY3Rpb24gc3RyaW5naWZ5KGl0LCByZXBsYWNlciwgc3BhY2UpIHsKICAgdmFyIGFyZ3MgPSBbaXRdOwogICB2YXIgaW5kZXggPSAxOwogICB2YXIgJHJlcGxhY2VyOwogICB3aGlsZSAoYXJndW1lbnRzLmxlbmd0aCA+IGluZGV4KQogICAgYXJncy5wdXNoKGFyZ3VtZW50c1tpbmRleCsrXSk7CiAgICRyZXBsYWNlciA9IHJlcGxhY2VyOwogICBpZiAoIWlzT2JqZWN0KHJlcGxhY2VyKSAmJiBpdCA9PT0gdW5kZWZpbmVkIHx8IGlzU3ltYm9sKGl0KSkKICAgIHJldHVybjsKICAgaWYgKCFpc0FycmF5KHJlcGxhY2VyKSkKICAgIHJlcGxhY2VyID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICBpZiAodHlwZW9mICRyZXBsYWNlciA9PSAnZnVuY3Rpb24nKQogICAgICB2YWx1ZSA9ICRyZXBsYWNlci5jYWxsKHRoaXMsIGtleSwgdmFsdWUpOwogICAgIGlmICghaXNTeW1ib2wodmFsdWUpKQogICAgICByZXR1cm4gdmFsdWU7CiAgICB9OwogICBhcmdzWzFdID0gcmVwbGFjZXI7CiAgIHJldHVybiAkc3RyaW5naWZ5LmFwcGx5KG51bGwsIGFyZ3MpOwogIH0KIH0pOwp9CmlmICghJFN5bWJvbFtQUk9UT1RZUEVdW1RPX1BSSU1JVElWRV0pIHsKIGNyZWF0ZU5vbkVudW1lcmFibGVQcm9wZXJ0eSgkU3ltYm9sW1BST1RPVFlQRV0sIFRPX1BSSU1JVElWRSwgJFN5bWJvbFtQUk9UT1RZUEVdLnZhbHVlT2YpOwp9CnNldFRvU3RyaW5nVGFnKCRTeW1ib2wsIFNZTUJPTCk7CmhpZGRlbktleXNbSElEREVOXSA9IHRydWU7CgovKioqLyB9KSwKLyogMTY5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciB0b0luZGV4ZWRPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3KTsKdmFyIG5hdGl2ZUdldE93blByb3BlcnR5TmFtZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQ0KS5mOwp2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZzsKdmFyIHdpbmRvd05hbWVzID0gdHlwZW9mIHdpbmRvdyA9PSAnb2JqZWN0JyAmJiB3aW5kb3cgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW107CnZhciBnZXRXaW5kb3dOYW1lcyA9IGZ1bmN0aW9uIChpdCkgewogdHJ5IHsKICByZXR1cm4gbmF0aXZlR2V0T3duUHJvcGVydHlOYW1lcyhpdCk7CiB9IGNhdGNoIChlcnJvcikgewogIHJldHVybiB3aW5kb3dOYW1lcy5zbGljZSgpOwogfQp9Owptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCkgewogcmV0dXJuIHdpbmRvd05hbWVzICYmIHRvU3RyaW5nLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogbmF0aXZlR2V0T3duUHJvcGVydHlOYW1lcyh0b0luZGV4ZWRPYmplY3QoaXQpKTsKfTsKCi8qKiovIH0pLAovKiAxNzAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNTcpOwpleHBvcnRzLmYgPSB3ZWxsS25vd25TeW1ib2w7CgovKioqLyB9KSwKLyogMTcxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBwYXRoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7CnZhciBoYXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzKTsKdmFyIHdyYXBwZWRXZWxsS25vd25TeW1ib2xNb2R1bGUgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3MCk7CnZhciBkZWZpbmVQcm9wZXJ0eSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjcpLmY7Cm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKE5BTUUpIHsKIHZhciBTeW1ib2wgPSBwYXRoLlN5bWJvbCB8fCAocGF0aC5TeW1ib2wgPSB7fSk7CiBpZiAoIWhhcyhTeW1ib2wsIE5BTUUpKQogIGRlZmluZVByb3BlcnR5KFN5bWJvbCwgTkFNRSwgeyB2YWx1ZTogd3JhcHBlZFdlbGxLbm93blN5bWJvbE1vZHVsZS5mKE5BTUUpIH0pOwp9OwoKLyoqKi8gfSksCi8qIDE3MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZGVmaW5lV2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzEpOwpkZWZpbmVXZWxsS25vd25TeW1ib2woJ2FzeW5jSXRlcmF0b3InKTsKCi8qKiovIH0pLAovKiAxNzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMyk7CnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIGhhcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMpOwp2YXIgaXNPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyKTsKdmFyIGRlZmluZVByb3BlcnR5ID0gX193X3BkZmpzX3JlcXVpcmVfXygyNykuZjsKdmFyIGNvcHlDb25zdHJ1Y3RvclByb3BlcnRpZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDQwKTsKdmFyIE5hdGl2ZVN5bWJvbCA9IGdsb2JhbC5TeW1ib2w7CmlmIChERVNDUklQVE9SUyAmJiB0eXBlb2YgTmF0aXZlU3ltYm9sID09ICdmdW5jdGlvbicgJiYgKCEoJ2Rlc2NyaXB0aW9uJyBpbiBOYXRpdmVTeW1ib2wucHJvdG90eXBlKSB8fCBOYXRpdmVTeW1ib2woKS5kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSkgewogdmFyIEVtcHR5U3RyaW5nRGVzY3JpcHRpb25TdG9yZSA9IHt9OwogdmFyIFN5bWJvbFdyYXBwZXIgPSBmdW5jdGlvbiBTeW1ib2woKSB7CiAgdmFyIGRlc2NyaXB0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA8IDEgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBTdHJpbmcoYXJndW1lbnRzWzBdKTsKICB2YXIgcmVzdWx0ID0gdGhpcyBpbnN0YW5jZW9mIFN5bWJvbFdyYXBwZXIgPyBuZXcgTmF0aXZlU3ltYm9sKGRlc2NyaXB0aW9uKSA6IGRlc2NyaXB0aW9uID09PSB1bmRlZmluZWQgPyBOYXRpdmVTeW1ib2woKSA6IE5hdGl2ZVN5bWJvbChkZXNjcmlwdGlvbik7CiAgaWYgKGRlc2NyaXB0aW9uID09PSAnJykKICAgRW1wdHlTdHJpbmdEZXNjcmlwdGlvblN0b3JlW3Jlc3VsdF0gPSB0cnVlOwogIHJldHVybiByZXN1bHQ7CiB9OwogY29weUNvbnN0cnVjdG9yUHJvcGVydGllcyhTeW1ib2xXcmFwcGVyLCBOYXRpdmVTeW1ib2wpOwogdmFyIHN5bWJvbFByb3RvdHlwZSA9IFN5bWJvbFdyYXBwZXIucHJvdG90eXBlID0gTmF0aXZlU3ltYm9sLnByb3RvdHlwZTsKIHN5bWJvbFByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFN5bWJvbFdyYXBwZXI7CiB2YXIgc3ltYm9sVG9TdHJpbmcgPSBzeW1ib2xQcm90b3R5cGUudG9TdHJpbmc7CiB2YXIgbmF0aXZlID0gU3RyaW5nKE5hdGl2ZVN5bWJvbCgndGVzdCcpKSA9PSAnU3ltYm9sKHRlc3QpJzsKIHZhciByZWdleHAgPSAvXlN5bWJvbFwoKC4qKVwpW14pXSskLzsKIGRlZmluZVByb3BlcnR5KHN5bWJvbFByb3RvdHlwZSwgJ2Rlc2NyaXB0aW9uJywgewogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICBnZXQ6IGZ1bmN0aW9uIGRlc2NyaXB0aW9uKCkgewogICB2YXIgc3ltYm9sID0gaXNPYmplY3QodGhpcykgPyB0aGlzLnZhbHVlT2YoKSA6IHRoaXM7CiAgIHZhciBzdHJpbmcgPSBzeW1ib2xUb1N0cmluZy5jYWxsKHN5bWJvbCk7CiAgIGlmIChoYXMoRW1wdHlTdHJpbmdEZXNjcmlwdGlvblN0b3JlLCBzeW1ib2wpKQogICAgcmV0dXJuICcnOwogICB2YXIgZGVzYyA9IG5hdGl2ZSA/IHN0cmluZy5zbGljZSg3LCAtMSkgOiBzdHJpbmcucmVwbGFjZShyZWdleHAsICckMScpOwogICByZXR1cm4gZGVzYyA9PT0gJycgPyB1bmRlZmluZWQgOiBkZXNjOwogIH0KIH0pOwogJCh7CiAgZ2xvYmFsOiB0cnVlLAogIGZvcmNlZDogdHJ1ZQogfSwgeyBTeW1ib2w6IFN5bWJvbFdyYXBwZXIgfSk7Cn0KCi8qKiovIH0pLAovKiAxNzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGRlZmluZVdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcxKTsKZGVmaW5lV2VsbEtub3duU3ltYm9sKCdoYXNJbnN0YW5jZScpOwoKLyoqKi8gfSksCi8qIDE3NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZGVmaW5lV2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzEpOwpkZWZpbmVXZWxsS25vd25TeW1ib2woJ2lzQ29uY2F0U3ByZWFkYWJsZScpOwoKLyoqKi8gfSksCi8qIDE3NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZGVmaW5lV2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzEpOwpkZWZpbmVXZWxsS25vd25TeW1ib2woJ2l0ZXJhdG9yJyk7CgovKioqLyB9KSwKLyogMTc3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBkZWZpbmVXZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3MSk7CmRlZmluZVdlbGxLbm93blN5bWJvbCgnbWF0Y2gnKTsKCi8qKiovIH0pLAovKiAxNzggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGRlZmluZVdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcxKTsKZGVmaW5lV2VsbEtub3duU3ltYm9sKCdtYXRjaEFsbCcpOwoKLyoqKi8gfSksCi8qIDE3OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZGVmaW5lV2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzEpOwpkZWZpbmVXZWxsS25vd25TeW1ib2woJ3JlcGxhY2UnKTsKCi8qKiovIH0pLAovKiAxODAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGRlZmluZVdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcxKTsKZGVmaW5lV2VsbEtub3duU3ltYm9sKCdzZWFyY2gnKTsKCi8qKiovIH0pLAovKiAxODEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGRlZmluZVdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcxKTsKZGVmaW5lV2VsbEtub3duU3ltYm9sKCdzcGVjaWVzJyk7CgovKioqLyB9KSwKLyogMTgyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBkZWZpbmVXZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3MSk7CmRlZmluZVdlbGxLbm93blN5bWJvbCgnc3BsaXQnKTsKCi8qKiovIH0pLAovKiAxODMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIGRlZmluZVdlbGxLbm93blN5bWJvbCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTcxKTsKZGVmaW5lV2VsbEtub3duU3ltYm9sKCd0b1ByaW1pdGl2ZScpOwoKLyoqKi8gfSksCi8qIDE4NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZGVmaW5lV2VsbEtub3duU3ltYm9sID0gX193X3BkZmpzX3JlcXVpcmVfXygxNzEpOwpkZWZpbmVXZWxsS25vd25TeW1ib2woJ3RvU3RyaW5nVGFnJyk7CgovKioqLyB9KSwKLyogMTg1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBkZWZpbmVXZWxsS25vd25TeW1ib2wgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3MSk7CmRlZmluZVdlbGxLbm93blN5bWJvbCgndW5zY29wYWJsZXMnKTsKCi8qKiovIH0pLAovKiAxODYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHNldFRvU3RyaW5nVGFnID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7CnNldFRvU3RyaW5nVGFnKE1hdGgsICdNYXRoJywgdHJ1ZSk7CgovKioqLyB9KSwKLyogMTg3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnbG9iYWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDExKTsKdmFyIHNldFRvU3RyaW5nVGFnID0gX193X3BkZmpzX3JlcXVpcmVfXyg4NSk7CnNldFRvU3RyaW5nVGFnKGdsb2JhbC5KU09OLCAnSlNPTicsIHRydWUpOwoKLyoqKi8gfSksCi8qIDE4OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDE4OSk7CnZhciBlbnRyeVVuYmluZCA9IF9fd19wZGZqc19yZXF1aXJlX18oNjEpOwptb2R1bGUuZXhwb3J0cyA9IGVudHJ5VW5iaW5kKCdTdHJpbmcnLCAncGFkU3RhcnQnKTsKCi8qKiovIH0pLAovKiAxODkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyICRwYWRTdGFydCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkwKS5zdGFydDsKdmFyIFdFQktJVF9CVUcgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5Mik7CiQoewogdGFyZ2V0OiAnU3RyaW5nJywKIHByb3RvOiB0cnVlLAogZm9yY2VkOiBXRUJLSVRfQlVHCn0sIHsKIHBhZFN0YXJ0OiBmdW5jdGlvbiBwYWRTdGFydChtYXhMZW5ndGgpIHsKICByZXR1cm4gJHBhZFN0YXJ0KHRoaXMsIG1heExlbmd0aCwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpOwogfQp9KTsKCi8qKiovIH0pLAovKiAxOTAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHRvTGVuZ3RoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Nyk7CnZhciByZXBlYXQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5MSk7CnZhciByZXF1aXJlT2JqZWN0Q29lcmNpYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygyMCk7CnZhciBjZWlsID0gTWF0aC5jZWlsOwp2YXIgY3JlYXRlTWV0aG9kID0gZnVuY3Rpb24gKElTX0VORCkgewogcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgbWF4TGVuZ3RoLCBmaWxsU3RyaW5nKSB7CiAgdmFyIFMgPSBTdHJpbmcocmVxdWlyZU9iamVjdENvZXJjaWJsZSgkdGhpcykpOwogIHZhciBzdHJpbmdMZW5ndGggPSBTLmxlbmd0aDsKICB2YXIgZmlsbFN0ciA9IGZpbGxTdHJpbmcgPT09IHVuZGVmaW5lZCA/ICcgJyA6IFN0cmluZyhmaWxsU3RyaW5nKTsKICB2YXIgaW50TWF4TGVuZ3RoID0gdG9MZW5ndGgobWF4TGVuZ3RoKTsKICB2YXIgZmlsbExlbiwgc3RyaW5nRmlsbGVyOwogIGlmIChpbnRNYXhMZW5ndGggPD0gc3RyaW5nTGVuZ3RoIHx8IGZpbGxTdHIgPT0gJycpCiAgIHJldHVybiBTOwogIGZpbGxMZW4gPSBpbnRNYXhMZW5ndGggLSBzdHJpbmdMZW5ndGg7CiAgc3RyaW5nRmlsbGVyID0gcmVwZWF0LmNhbGwoZmlsbFN0ciwgY2VpbChmaWxsTGVuIC8gZmlsbFN0ci5sZW5ndGgpKTsKICBpZiAoc3RyaW5nRmlsbGVyLmxlbmd0aCA+IGZpbGxMZW4pCiAgIHN0cmluZ0ZpbGxlciA9IHN0cmluZ0ZpbGxlci5zbGljZSgwLCBmaWxsTGVuKTsKICByZXR1cm4gSVNfRU5EID8gUyArIHN0cmluZ0ZpbGxlciA6IHN0cmluZ0ZpbGxlciArIFM7CiB9Owp9Owptb2R1bGUuZXhwb3J0cyA9IHsKIHN0YXJ0OiBjcmVhdGVNZXRob2QoZmFsc2UpLAogZW5kOiBjcmVhdGVNZXRob2QodHJ1ZSkKfTsKCi8qKiovIH0pLAovKiAxOTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIHRvSW50ZWdlciA9IF9fd19wZGZqc19yZXF1aXJlX18oNDgpOwp2YXIgcmVxdWlyZU9iamVjdENvZXJjaWJsZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjApOwptb2R1bGUuZXhwb3J0cyA9ICcnLnJlcGVhdCB8fCBmdW5jdGlvbiByZXBlYXQoY291bnQpIHsKIHZhciBzdHIgPSBTdHJpbmcocmVxdWlyZU9iamVjdENvZXJjaWJsZSh0aGlzKSk7CiB2YXIgcmVzdWx0ID0gJyc7CiB2YXIgbiA9IHRvSW50ZWdlcihjb3VudCk7CiBpZiAobiA8IDAgfHwgbiA9PSBJbmZpbml0eSkKICB0aHJvdyBSYW5nZUVycm9yKCdXcm9uZyBudW1iZXIgb2YgcmVwZXRpdGlvbnMnKTsKIGZvciAoOyBuID4gMDsgKG4gPj4+PSAxKSAmJiAoc3RyICs9IHN0cikpCiAgaWYgKG4gJiAxKQogICByZXN1bHQgKz0gc3RyOwogcmV0dXJuIHJlc3VsdDsKfTsKCi8qKiovIH0pLAovKiAxOTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIHVzZXJBZ2VudCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTI3KTsKbW9kdWxlLmV4cG9ydHMgPSAvVmVyc2lvblwvMTBcLlxkKyhcLlxkKyk/KCBNb2JpbGVcL1x3Kyk/IFNhZmFyaVwvLy50ZXN0KHVzZXJBZ2VudCk7CgovKioqLyB9KSwKLyogMTkzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCl9fd19wZGZqc19yZXF1aXJlX18oMTk0KTsKdmFyIGVudHJ5VW5iaW5kID0gX193X3BkZmpzX3JlcXVpcmVfXyg2MSk7Cm1vZHVsZS5leHBvcnRzID0gZW50cnlVbmJpbmQoJ1N0cmluZycsICdwYWRFbmQnKTsKCi8qKiovIH0pLAovKiAxOTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyICQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDEwKTsKdmFyICRwYWRFbmQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5MCkuZW5kOwp2YXIgV0VCS0lUX0JVRyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTkyKTsKJCh7CiB0YXJnZXQ6ICdTdHJpbmcnLAogcHJvdG86IHRydWUsCiBmb3JjZWQ6IFdFQktJVF9CVUcKfSwgewogcGFkRW5kOiBmdW5jdGlvbiBwYWRFbmQobWF4TGVuZ3RoKSB7CiAgcmV0dXJuICRwYWRFbmQodGhpcywgbWF4TGVuZ3RoLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7CiB9Cn0pOwoKLyoqKi8gfSksCi8qIDE5NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgpfX3dfcGRmanNfcmVxdWlyZV9fKDE5Nik7CnZhciBwYXRoID0gX193X3BkZmpzX3JlcXVpcmVfXyg0Myk7Cm1vZHVsZS5leHBvcnRzID0gcGF0aC5PYmplY3QudmFsdWVzOwoKLyoqKi8gfSksCi8qIDE5NiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgJCA9IF9fd19wZGZqc19yZXF1aXJlX18oMTApOwp2YXIgJHZhbHVlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk3KS52YWx1ZXM7CiQoewogdGFyZ2V0OiAnT2JqZWN0JywKIHN0YXQ6IHRydWUKfSwgewogdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoTykgewogIHJldHVybiAkdmFsdWVzKE8pOwogfQp9KTsKCi8qKiovIH0pLAovKiAxOTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKdmFyIERFU0NSSVBUT1JTID0gX193X3BkZmpzX3JlcXVpcmVfXygxMyk7CnZhciBvYmplY3RLZXlzID0gX193X3BkZmpzX3JlcXVpcmVfXyg3Myk7CnZhciB0b0luZGV4ZWRPYmplY3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE3KTsKdmFyIHByb3BlcnR5SXNFbnVtZXJhYmxlID0gX193X3BkZmpzX3JlcXVpcmVfXygxNSkuZjsKdmFyIGNyZWF0ZU1ldGhvZCA9IGZ1bmN0aW9uIChUT19FTlRSSUVTKSB7CiByZXR1cm4gZnVuY3Rpb24gKGl0KSB7CiAgdmFyIE8gPSB0b0luZGV4ZWRPYmplY3QoaXQpOwogIHZhciBrZXlzID0gb2JqZWN0S2V5cyhPKTsKICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7CiAgdmFyIGkgPSAwOwogIHZhciByZXN1bHQgPSBbXTsKICB2YXIga2V5OwogIHdoaWxlIChsZW5ndGggPiBpKSB7CiAgIGtleSA9IGtleXNbaSsrXTsKICAgaWYgKCFERVNDUklQVE9SUyB8fCBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKE8sIGtleSkpIHsKICAgIHJlc3VsdC5wdXNoKFRPX0VOVFJJRVMgPyBbCiAgICAga2V5LAogICAgIE9ba2V5XQogICAgXSA6IE9ba2V5XSk7CiAgIH0KICB9CiAgcmV0dXJuIHJlc3VsdDsKIH07Cn07Cm1vZHVsZS5leHBvcnRzID0gewogZW50cmllczogY3JlYXRlTWV0aG9kKHRydWUpLAogdmFsdWVzOiBjcmVhdGVNZXRob2QoZmFsc2UpCn07CgovKioqLyB9KSwKLyogMTk4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuY2xlYXJQcmltaXRpdmVDYWNoZXMgPSBjbGVhclByaW1pdGl2ZUNhY2hlczsKZXhwb3J0cy5pc0VPRiA9IGlzRU9GOwpleHBvcnRzLmlzQ21kID0gaXNDbWQ7CmV4cG9ydHMuaXNEaWN0ID0gaXNEaWN0OwpleHBvcnRzLmlzTmFtZSA9IGlzTmFtZTsKZXhwb3J0cy5pc1JlZiA9IGlzUmVmOwpleHBvcnRzLmlzUmVmc0VxdWFsID0gaXNSZWZzRXF1YWw7CmV4cG9ydHMuaXNTdHJlYW0gPSBpc1N0cmVhbTsKZXhwb3J0cy5SZWZTZXRDYWNoZSA9IGV4cG9ydHMuUmVmU2V0ID0gZXhwb3J0cy5SZWYgPSBleHBvcnRzLk5hbWUgPSBleHBvcnRzLkRpY3QgPSBleHBvcnRzLkNtZCA9IGV4cG9ydHMuRU9GID0gdm9pZCAwOwoKdmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX193X3BkZmpzX3JlcXVpcmVfXygyKSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgImRlZmF1bHQiOiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKdmFyIEVPRiA9IHt9OwpleHBvcnRzLkVPRiA9IEVPRjsKCnZhciBOYW1lID0gZnVuY3Rpb24gTmFtZUNsb3N1cmUoKSB7CiAgdmFyIG5hbWVDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIGZ1bmN0aW9uIE5hbWUobmFtZSkgewogICAgdGhpcy5uYW1lID0gbmFtZTsKICB9CgogIE5hbWUucHJvdG90eXBlID0ge307CgogIE5hbWUuZ2V0ID0gZnVuY3Rpb24gTmFtZV9nZXQobmFtZSkgewogICAgdmFyIG5hbWVWYWx1ZSA9IG5hbWVDYWNoZVtuYW1lXTsKICAgIHJldHVybiBuYW1lVmFsdWUgPyBuYW1lVmFsdWUgOiBuYW1lQ2FjaGVbbmFtZV0gPSBuZXcgTmFtZShuYW1lKTsKICB9OwoKICBOYW1lLl9jbGVhckNhY2hlID0gZnVuY3Rpb24gKCkgewogICAgbmFtZUNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICB9OwoKICByZXR1cm4gTmFtZTsKfSgpOwoKZXhwb3J0cy5OYW1lID0gTmFtZTsKCnZhciBDbWQgPSBmdW5jdGlvbiBDbWRDbG9zdXJlKCkgewogIHZhciBjbWRDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIGZ1bmN0aW9uIENtZChjbWQpIHsKICAgIHRoaXMuY21kID0gY21kOwogIH0KCiAgQ21kLnByb3RvdHlwZSA9IHt9OwoKICBDbWQuZ2V0ID0gZnVuY3Rpb24gQ21kX2dldChjbWQpIHsKICAgIHZhciBjbWRWYWx1ZSA9IGNtZENhY2hlW2NtZF07CiAgICByZXR1cm4gY21kVmFsdWUgPyBjbWRWYWx1ZSA6IGNtZENhY2hlW2NtZF0gPSBuZXcgQ21kKGNtZCk7CiAgfTsKCiAgQ21kLl9jbGVhckNhY2hlID0gZnVuY3Rpb24gKCkgewogICAgY21kQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH07CgogIHJldHVybiBDbWQ7Cn0oKTsKCmV4cG9ydHMuQ21kID0gQ21kOwoKdmFyIERpY3QgPSBmdW5jdGlvbiBEaWN0Q2xvc3VyZSgpIHsKICB2YXIgbm9uU2VyaWFsaXphYmxlID0gZnVuY3Rpb24gbm9uU2VyaWFsaXphYmxlQ2xvc3VyZSgpIHsKICAgIHJldHVybiBub25TZXJpYWxpemFibGU7CiAgfTsKCiAgZnVuY3Rpb24gRGljdCh4cmVmKSB7CiAgICB0aGlzLl9tYXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMub2JqSWQgPSBudWxsOwogICAgdGhpcy5zdXBwcmVzc0VuY3J5cHRpb24gPSBmYWxzZTsKICAgIHRoaXMuX19ub25TZXJpYWxpemFibGVfXyA9IG5vblNlcmlhbGl6YWJsZTsKICB9CgogIERpY3QucHJvdG90eXBlID0gewogICAgYXNzaWduWHJlZjogZnVuY3Rpb24gRGljdF9hc3NpZ25YcmVmKG5ld1hyZWYpIHsKICAgICAgdGhpcy54cmVmID0gbmV3WHJlZjsKICAgIH0sCiAgICBnZXQ6IGZ1bmN0aW9uIGdldChrZXkxLCBrZXkyLCBrZXkzKSB7CiAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX21hcFtrZXkxXTsKCiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkICYmIGtleTIgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHZhbHVlID0gdGhpcy5fbWFwW2tleTJdOwoKICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBrZXkzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHZhbHVlID0gdGhpcy5fbWFwW2tleTNdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgUmVmICYmIHRoaXMueHJlZikgewogICAgICAgIHJldHVybiB0aGlzLnhyZWYuZmV0Y2godmFsdWUsIHRoaXMuc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfSwKICAgIGdldEFzeW5jOiBmdW5jdGlvbiBnZXRBc3luYyhrZXkxLCBrZXkyLCBrZXkzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JbImRlZmF1bHQiXS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHZhbHVlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JbImRlZmF1bHQiXS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdmFsdWUgPSBfdGhpcy5fbWFwW2tleTFdOwoKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkICYmIGtleTIgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICB2YWx1ZSA9IF90aGlzLl9tYXBba2V5Ml07CgogICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBrZXkzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IF90aGlzLl9tYXBba2V5M107CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIFJlZiAmJiBfdGhpcy54cmVmKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX3RoaXMueHJlZi5mZXRjaEFzeW5jKHZhbHVlLCBfdGhpcy5zdXBwcmVzc0VuY3J5cHRpb24pKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdmFsdWUpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZ2V0QXJyYXk6IGZ1bmN0aW9uIGdldEFycmF5KGtleTEsIGtleTIsIGtleTMpIHsKICAgICAgdmFyIHZhbHVlID0gdGhpcy5nZXQoa2V5MSwga2V5Miwga2V5Myk7CgogICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpIHx8ICF0aGlzLnhyZWYpIHsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgIH0KCiAgICAgIHZhbHVlID0gdmFsdWUuc2xpY2UoKTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHZhbHVlLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBpZiAoISh2YWx1ZVtpXSBpbnN0YW5jZW9mIFJlZikpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFsdWVbaV0gPSB0aGlzLnhyZWYuZmV0Y2godmFsdWVbaV0sIHRoaXMuc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfSwKICAgIGdldFJhdzogZnVuY3Rpb24gRGljdF9nZXRSYXcoa2V5KSB7CiAgICAgIHJldHVybiB0aGlzLl9tYXBba2V5XTsKICAgIH0sCiAgICBnZXRLZXlzOiBmdW5jdGlvbiBEaWN0X2dldEtleXMoKSB7CiAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9tYXApOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gRGljdF9zZXQoa2V5LCB2YWx1ZSkgewogICAgICB0aGlzLl9tYXBba2V5XSA9IHZhbHVlOwogICAgfSwKICAgIGhhczogZnVuY3Rpb24gRGljdF9oYXMoa2V5KSB7CiAgICAgIHJldHVybiB0aGlzLl9tYXBba2V5XSAhPT0gdW5kZWZpbmVkOwogICAgfSwKICAgIGZvckVhY2g6IGZ1bmN0aW9uIERpY3RfZm9yRWFjaChjYWxsYmFjaykgewogICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5fbWFwKSB7CiAgICAgICAgY2FsbGJhY2soa2V5LCB0aGlzLmdldChrZXkpKTsKICAgICAgfQogICAgfQogIH07CiAgRGljdC5lbXB0eSA9IG5ldyBEaWN0KG51bGwpOwoKICBEaWN0Lm1lcmdlID0gZnVuY3Rpb24gKHhyZWYsIGRpY3RBcnJheSkgewogICAgdmFyIG1lcmdlZERpY3QgPSBuZXcgRGljdCh4cmVmKTsKCiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBkaWN0QXJyYXkubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICB2YXIgZGljdCA9IGRpY3RBcnJheVtpXTsKCiAgICAgIGlmICghaXNEaWN0KGRpY3QpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGtleU5hbWUgaW4gZGljdC5fbWFwKSB7CiAgICAgICAgaWYgKG1lcmdlZERpY3QuX21hcFtrZXlOYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIG1lcmdlZERpY3QuX21hcFtrZXlOYW1lXSA9IGRpY3QuX21hcFtrZXlOYW1lXTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBtZXJnZWREaWN0OwogIH07CgogIHJldHVybiBEaWN0Owp9KCk7CgpleHBvcnRzLkRpY3QgPSBEaWN0OwoKdmFyIFJlZiA9IGZ1bmN0aW9uIFJlZkNsb3N1cmUoKSB7CiAgdmFyIHJlZkNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgZnVuY3Rpb24gUmVmKG51bSwgZ2VuKSB7CiAgICB0aGlzLm51bSA9IG51bTsKICAgIHRoaXMuZ2VuID0gZ2VuOwogIH0KCiAgUmVmLnByb3RvdHlwZSA9IHsKICAgIHRvU3RyaW5nOiBmdW5jdGlvbiBSZWZfdG9TdHJpbmcoKSB7CiAgICAgIGlmICh0aGlzLmdlbiA9PT0gMCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy5udW0sICJSIik7CiAgICAgIH0KCiAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy5udW0sICJSIikuY29uY2F0KHRoaXMuZ2VuKTsKICAgIH0KICB9OwoKICBSZWYuZ2V0ID0gZnVuY3Rpb24gKG51bSwgZ2VuKSB7CiAgICB2YXIga2V5ID0gZ2VuID09PSAwID8gIiIuY29uY2F0KG51bSwgIlIiKSA6ICIiLmNvbmNhdChudW0sICJSIikuY29uY2F0KGdlbik7CiAgICB2YXIgcmVmVmFsdWUgPSByZWZDYWNoZVtrZXldOwogICAgcmV0dXJuIHJlZlZhbHVlID8gcmVmVmFsdWUgOiByZWZDYWNoZVtrZXldID0gbmV3IFJlZihudW0sIGdlbik7CiAgfTsKCiAgUmVmLl9jbGVhckNhY2hlID0gZnVuY3Rpb24gKCkgewogICAgcmVmQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH07CgogIHJldHVybiBSZWY7Cn0oKTsKCmV4cG9ydHMuUmVmID0gUmVmOwoKdmFyIFJlZlNldCA9IGZ1bmN0aW9uIFJlZlNldENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gUmVmU2V0KCkgewogICAgdGhpcy5kaWN0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICB9CgogIFJlZlNldC5wcm90b3R5cGUgPSB7CiAgICBoYXM6IGZ1bmN0aW9uIFJlZlNldF9oYXMocmVmKSB7CiAgICAgIHJldHVybiByZWYudG9TdHJpbmcoKSBpbiB0aGlzLmRpY3Q7CiAgICB9LAogICAgcHV0OiBmdW5jdGlvbiBSZWZTZXRfcHV0KHJlZikgewogICAgICB0aGlzLmRpY3RbcmVmLnRvU3RyaW5nKCldID0gdHJ1ZTsKICAgIH0sCiAgICByZW1vdmU6IGZ1bmN0aW9uIFJlZlNldF9yZW1vdmUocmVmKSB7CiAgICAgIGRlbGV0ZSB0aGlzLmRpY3RbcmVmLnRvU3RyaW5nKCldOwogICAgfQogIH07CiAgcmV0dXJuIFJlZlNldDsKfSgpOwoKZXhwb3J0cy5SZWZTZXQgPSBSZWZTZXQ7Cgp2YXIgUmVmU2V0Q2FjaGUgPSBmdW5jdGlvbiBSZWZTZXRDYWNoZUNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gUmVmU2V0Q2FjaGUoKSB7CiAgICB0aGlzLmRpY3QgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH0KCiAgUmVmU2V0Q2FjaGUucHJvdG90eXBlID0gewogICAgZ2V0IHNpemUoKSB7CiAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLmRpY3QpLmxlbmd0aDsKICAgIH0sCgogICAgZ2V0OiBmdW5jdGlvbiBSZWZTZXRDYWNoZV9nZXQocmVmKSB7CiAgICAgIHJldHVybiB0aGlzLmRpY3RbcmVmLnRvU3RyaW5nKCldOwogICAgfSwKICAgIGhhczogZnVuY3Rpb24gUmVmU2V0Q2FjaGVfaGFzKHJlZikgewogICAgICByZXR1cm4gcmVmLnRvU3RyaW5nKCkgaW4gdGhpcy5kaWN0OwogICAgfSwKICAgIHB1dDogZnVuY3Rpb24gUmVmU2V0Q2FjaGVfcHV0KHJlZiwgb2JqKSB7CiAgICAgIHRoaXMuZGljdFtyZWYudG9TdHJpbmcoKV0gPSBvYmo7CiAgICB9LAogICAgcHV0QWxpYXM6IGZ1bmN0aW9uIFJlZlNldENhY2hlX3B1dEFsaWFzKHJlZiwgYWxpYXNSZWYpIHsKICAgICAgdGhpcy5kaWN0W3JlZi50b1N0cmluZygpXSA9IHRoaXMuZ2V0KGFsaWFzUmVmKTsKICAgIH0sCiAgICBmb3JFYWNoOiBmdW5jdGlvbiBSZWZTZXRDYWNoZV9mb3JFYWNoKGNhbGxiYWNrKSB7CiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5kaWN0KSB7CiAgICAgICAgY2FsbGJhY2sodGhpcy5kaWN0W2ldKTsKICAgICAgfQogICAgfSwKICAgIGNsZWFyOiBmdW5jdGlvbiBSZWZTZXRDYWNoZV9jbGVhcigpIHsKICAgICAgdGhpcy5kaWN0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KICB9OwogIHJldHVybiBSZWZTZXRDYWNoZTsKfSgpOwoKZXhwb3J0cy5SZWZTZXRDYWNoZSA9IFJlZlNldENhY2hlOwoKZnVuY3Rpb24gaXNFT0YodikgewogIHJldHVybiB2ID09PSBFT0Y7Cn0KCmZ1bmN0aW9uIGlzTmFtZSh2LCBuYW1lKSB7CiAgcmV0dXJuIHYgaW5zdGFuY2VvZiBOYW1lICYmIChuYW1lID09PSB1bmRlZmluZWQgfHwgdi5uYW1lID09PSBuYW1lKTsKfQoKZnVuY3Rpb24gaXNDbWQodiwgY21kKSB7CiAgcmV0dXJuIHYgaW5zdGFuY2VvZiBDbWQgJiYgKGNtZCA9PT0gdW5kZWZpbmVkIHx8IHYuY21kID09PSBjbWQpOwp9CgpmdW5jdGlvbiBpc0RpY3QodiwgdHlwZSkgewogIHJldHVybiB2IGluc3RhbmNlb2YgRGljdCAmJiAodHlwZSA9PT0gdW5kZWZpbmVkIHx8IGlzTmFtZSh2LmdldCgiVHlwZSIpLCB0eXBlKSk7Cn0KCmZ1bmN0aW9uIGlzUmVmKHYpIHsKICByZXR1cm4gdiBpbnN0YW5jZW9mIFJlZjsKfQoKZnVuY3Rpb24gaXNSZWZzRXF1YWwodjEsIHYyKSB7CiAgcmV0dXJuIHYxLm51bSA9PT0gdjIubnVtICYmIHYxLmdlbiA9PT0gdjIuZ2VuOwp9CgpmdW5jdGlvbiBpc1N0cmVhbSh2KSB7CiAgcmV0dXJuIF90eXBlb2YodikgPT09ICJvYmplY3QiICYmIHYgIT09IG51bGwgJiYgdi5nZXRCeXRlcyAhPT0gdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBjbGVhclByaW1pdGl2ZUNhY2hlcygpIHsKICBDbWQuX2NsZWFyQ2FjaGUoKTsKCiAgTmFtZS5fY2xlYXJDYWNoZSgpOwoKICBSZWYuX2NsZWFyQ2FjaGUoKTsKfQoKLyoqKi8gfSksCi8qIDE5OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLk5ldHdvcmtQZGZNYW5hZ2VyID0gZXhwb3J0cy5Mb2NhbFBkZk1hbmFnZXIgPSB2b2lkIDA7Cgp2YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfX3dfcGRmanNfcmVxdWlyZV9fKDIpKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2NodW5rZWRfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDApOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpOwoKdmFyIF9kb2N1bWVudCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAyKTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDUpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgImRlZmF1bHQiOiBvYmogfTsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IERhdGUucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoRGF0ZSwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCnZhciBCYXNlUGRmTWFuYWdlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQmFzZVBkZk1hbmFnZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZVBkZk1hbmFnZXIpOwoKICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBCYXNlUGRmTWFuYWdlcikgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBCYXNlUGRmTWFuYWdlci4iKTsKICAgIH0KICB9CgogIF9jcmVhdGVDbGFzcyhCYXNlUGRmTWFuYWdlciwgW3sKICAgIGtleTogIm9uTG9hZGVkU3RyZWFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkxvYWRlZFN0cmVhbSgpIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGBvbkxvYWRlZFN0cmVhbWAgY2FsbGVkIik7CiAgICB9CiAgfSwgewogICAga2V5OiAiZW5zdXJlRG9jIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlbnN1cmVEb2MocHJvcCwgYXJncykgewogICAgICByZXR1cm4gdGhpcy5lbnN1cmUodGhpcy5wZGZEb2N1bWVudCwgcHJvcCwgYXJncyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZW5zdXJlWFJlZiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZW5zdXJlWFJlZihwcm9wLCBhcmdzKSB7CiAgICAgIHJldHVybiB0aGlzLmVuc3VyZSh0aGlzLnBkZkRvY3VtZW50LnhyZWYsIHByb3AsIGFyZ3MpOwogICAgfQogIH0sIHsKICAgIGtleTogImVuc3VyZUNhdGFsb2ciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVuc3VyZUNhdGFsb2cocHJvcCwgYXJncykgewogICAgICByZXR1cm4gdGhpcy5lbnN1cmUodGhpcy5wZGZEb2N1bWVudC5jYXRhbG9nLCBwcm9wLCBhcmdzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQYWdlKHBhZ2VJbmRleCkgewogICAgICByZXR1cm4gdGhpcy5wZGZEb2N1bWVudC5nZXRQYWdlKHBhZ2VJbmRleCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZm9udEZhbGxiYWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmb250RmFsbGJhY2soaWQsIGhhbmRsZXIpIHsKICAgICAgcmV0dXJuIHRoaXMucGRmRG9jdW1lbnQuZm9udEZhbGxiYWNrKGlkLCBoYW5kbGVyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbGVhbnVwIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhbnVwKCkgewogICAgICB2YXIgbWFudWFsbHlUcmlnZ2VyZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgICByZXR1cm4gdGhpcy5wZGZEb2N1bWVudC5jbGVhbnVwKG1hbnVhbGx5VHJpZ2dlcmVkKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJlbnN1cmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9lbnN1cmUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShvYmosIHByb3AsIGFyZ3MpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgZW5zdXJlYCBjYWxsZWQiKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGVuc3VyZShfeCwgX3gyLCBfeDMpIHsKICAgICAgICByZXR1cm4gX2Vuc3VyZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZW5zdXJlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAicmVxdWVzdFJhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXF1ZXN0UmFuZ2UoYmVnaW4sIGVuZCkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJBYnN0cmFjdCBtZXRob2QgYHJlcXVlc3RSYW5nZWAgY2FsbGVkIik7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVxdWVzdExvYWRlZFN0cmVhbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVxdWVzdExvYWRlZFN0cmVhbSgpIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiQWJzdHJhY3QgbWV0aG9kIGByZXF1ZXN0TG9hZGVkU3RyZWFtYCBjYWxsZWQiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZW5kUHJvZ3Jlc3NpdmVEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kUHJvZ3Jlc3NpdmVEYXRhKGNodW5rKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgc2VuZFByb2dyZXNzaXZlRGF0YWAgY2FsbGVkIik7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlUGFzc3dvcmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVBhc3N3b3JkKHBhc3N3b3JkKSB7CiAgICAgIHRoaXMuX3Bhc3N3b3JkID0gcGFzc3dvcmQ7CiAgICB9CiAgfSwgewogICAga2V5OiAidGVybWluYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0ZXJtaW5hdGUocmVhc29uKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkFic3RyYWN0IG1ldGhvZCBgdGVybWluYXRlYCBjYWxsZWQiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkb2NJZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2RvY0lkOwogICAgfQogIH0sIHsKICAgIGtleTogInBhc3N3b3JkIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fcGFzc3dvcmQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZG9jQmFzZVVybCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIGRvY0Jhc2VVcmwgPSBudWxsOwoKICAgICAgaWYgKHRoaXMuX2RvY0Jhc2VVcmwpIHsKICAgICAgICB2YXIgYWJzb2x1dGVVcmwgPSAoMCwgX3V0aWwuY3JlYXRlVmFsaWRBYnNvbHV0ZVVybCkodGhpcy5fZG9jQmFzZVVybCk7CgogICAgICAgIGlmIChhYnNvbHV0ZVVybCkgewogICAgICAgICAgZG9jQmFzZVVybCA9IGFic29sdXRlVXJsLmhyZWY7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW52YWxpZCBhYnNvbHV0ZSBkb2NCYXNlVXJsOiBcIiIuY29uY2F0KHRoaXMuX2RvY0Jhc2VVcmwsICJcIi4iKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImRvY0Jhc2VVcmwiLCBkb2NCYXNlVXJsKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBCYXNlUGRmTWFuYWdlcjsKfSgpOwoKdmFyIExvY2FsUGRmTWFuYWdlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VQZGZNYW5hZ2VyKSB7CiAgX2luaGVyaXRzKExvY2FsUGRmTWFuYWdlciwgX0Jhc2VQZGZNYW5hZ2VyKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihMb2NhbFBkZk1hbmFnZXIpOwoKICBmdW5jdGlvbiBMb2NhbFBkZk1hbmFnZXIoZG9jSWQsIGRhdGEsIHBhc3N3b3JkLCBldmFsdWF0b3JPcHRpb25zLCBkb2NCYXNlVXJsKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvY2FsUGRmTWFuYWdlcik7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKTsKICAgIF90aGlzLl9kb2NJZCA9IGRvY0lkOwogICAgX3RoaXMuX3Bhc3N3b3JkID0gcGFzc3dvcmQ7CiAgICBfdGhpcy5fZG9jQmFzZVVybCA9IGRvY0Jhc2VVcmw7CiAgICBfdGhpcy5ldmFsdWF0b3JPcHRpb25zID0gZXZhbHVhdG9yT3B0aW9uczsKICAgIHZhciBzdHJlYW0gPSBuZXcgX3N0cmVhbS5TdHJlYW0oZGF0YSk7CiAgICBfdGhpcy5wZGZEb2N1bWVudCA9IG5ldyBfZG9jdW1lbnQuUERGRG9jdW1lbnQoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksIHN0cmVhbSk7CiAgICBfdGhpcy5fbG9hZGVkU3RyZWFtUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShzdHJlYW0pOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKExvY2FsUGRmTWFuYWdlciwgW3sKICAgIGtleTogImVuc3VyZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2Vuc3VyZTIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIob2JqLCBwcm9wLCBhcmdzKSB7CiAgICAgICAgdmFyIHZhbHVlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JbImRlZmF1bHQiXS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHZhbHVlID0gb2JqW3Byb3BdOwoKICAgICAgICAgICAgICAgIGlmICghKHR5cGVvZiB2YWx1ZSA9PT0gImZ1bmN0aW9uIikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgdmFsdWUuYXBwbHkob2JqLCBhcmdzKSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCB2YWx1ZSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGVuc3VyZShfeDQsIF94NSwgX3g2KSB7CiAgICAgICAgcmV0dXJuIF9lbnN1cmUyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBlbnN1cmU7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJyZXF1ZXN0UmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKSB7CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXF1ZXN0TG9hZGVkU3RyZWFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXF1ZXN0TG9hZGVkU3RyZWFtKCkge30KICB9LCB7CiAgICBrZXk6ICJvbkxvYWRlZFN0cmVhbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Mb2FkZWRTdHJlYW0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9sb2FkZWRTdHJlYW1Qcm9taXNlOwogICAgfQogIH0sIHsKICAgIGtleTogInRlcm1pbmF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdGVybWluYXRlKHJlYXNvbikge30KICB9XSk7CgogIHJldHVybiBMb2NhbFBkZk1hbmFnZXI7Cn0oQmFzZVBkZk1hbmFnZXIpOwoKZXhwb3J0cy5Mb2NhbFBkZk1hbmFnZXIgPSBMb2NhbFBkZk1hbmFnZXI7Cgp2YXIgTmV0d29ya1BkZk1hbmFnZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlUGRmTWFuYWdlcjIpIHsKICBfaW5oZXJpdHMoTmV0d29ya1BkZk1hbmFnZXIsIF9CYXNlUGRmTWFuYWdlcjIpOwoKICB2YXIgX3N1cGVyMiA9IF9jcmVhdGVTdXBlcihOZXR3b3JrUGRmTWFuYWdlcik7CgogIGZ1bmN0aW9uIE5ldHdvcmtQZGZNYW5hZ2VyKGRvY0lkLCBwZGZOZXR3b3JrU3RyZWFtLCBhcmdzLCBldmFsdWF0b3JPcHRpb25zLCBkb2NCYXNlVXJsKSB7CiAgICB2YXIgX3RoaXMyOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOZXR3b3JrUGRmTWFuYWdlcik7CgogICAgX3RoaXMyID0gX3N1cGVyMi5jYWxsKHRoaXMpOwogICAgX3RoaXMyLl9kb2NJZCA9IGRvY0lkOwogICAgX3RoaXMyLl9wYXNzd29yZCA9IGFyZ3MucGFzc3dvcmQ7CiAgICBfdGhpczIuX2RvY0Jhc2VVcmwgPSBkb2NCYXNlVXJsOwogICAgX3RoaXMyLm1zZ0hhbmRsZXIgPSBhcmdzLm1zZ0hhbmRsZXI7CiAgICBfdGhpczIuZXZhbHVhdG9yT3B0aW9ucyA9IGV2YWx1YXRvck9wdGlvbnM7CiAgICBfdGhpczIuc3RyZWFtTWFuYWdlciA9IG5ldyBfY2h1bmtlZF9zdHJlYW0uQ2h1bmtlZFN0cmVhbU1hbmFnZXIocGRmTmV0d29ya1N0cmVhbSwgewogICAgICBtc2dIYW5kbGVyOiBhcmdzLm1zZ0hhbmRsZXIsCiAgICAgIGxlbmd0aDogYXJncy5sZW5ndGgsCiAgICAgIGRpc2FibGVBdXRvRmV0Y2g6IGFyZ3MuZGlzYWJsZUF1dG9GZXRjaCwKICAgICAgcmFuZ2VDaHVua1NpemU6IGFyZ3MucmFuZ2VDaHVua1NpemUKICAgIH0pOwogICAgX3RoaXMyLnBkZkRvY3VtZW50ID0gbmV3IF9kb2N1bWVudC5QREZEb2N1bWVudChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMiksIF90aGlzMi5zdHJlYW1NYW5hZ2VyLmdldFN0cmVhbSgpKTsKICAgIHJldHVybiBfdGhpczI7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTmV0d29ya1BkZk1hbmFnZXIsIFt7CiAgICBrZXk6ICJlbnN1cmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9lbnN1cmUzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JbImRlZmF1bHQiXS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKG9iaiwgcHJvcCwgYXJncykgewogICAgICAgIHZhciB2YWx1ZTsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDA7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IG9ialtwcm9wXTsKCiAgICAgICAgICAgICAgICBpZiAoISh0eXBlb2YgdmFsdWUgPT09ICJmdW5jdGlvbiIpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHZhbHVlLmFwcGx5KG9iaiwgYXJncykpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgdmFsdWUpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDc7CiAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgaWYgKF9jb250ZXh0My50MCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRocm93IF9jb250ZXh0My50MDsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0UmFuZ2UoX2NvbnRleHQzLnQwLmJlZ2luLCBfY29udGV4dDMudDAuZW5kKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCB0aGlzLmVuc3VyZShvYmosIHByb3AsIGFyZ3MpKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcywgW1swLCA3XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBlbnN1cmUoX3g3LCBfeDgsIF94OSkgewogICAgICAgIHJldHVybiBfZW5zdXJlMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZW5zdXJlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAicmVxdWVzdFJhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXF1ZXN0UmFuZ2UoYmVnaW4sIGVuZCkgewogICAgICByZXR1cm4gdGhpcy5zdHJlYW1NYW5hZ2VyLnJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXF1ZXN0TG9hZGVkU3RyZWFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXF1ZXN0TG9hZGVkU3RyZWFtKCkgewogICAgICB0aGlzLnN0cmVhbU1hbmFnZXIucmVxdWVzdEFsbENodW5rcygpOwogICAgfQogIH0sIHsKICAgIGtleTogInNlbmRQcm9ncmVzc2l2ZURhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRQcm9ncmVzc2l2ZURhdGEoY2h1bmspIHsKICAgICAgdGhpcy5zdHJlYW1NYW5hZ2VyLm9uUmVjZWl2ZURhdGEoewogICAgICAgIGNodW5rOiBjaHVuawogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkxvYWRlZFN0cmVhbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Mb2FkZWRTdHJlYW0oKSB7CiAgICAgIHJldHVybiB0aGlzLnN0cmVhbU1hbmFnZXIub25Mb2FkZWRTdHJlYW0oKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0ZXJtaW5hdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRlcm1pbmF0ZShyZWFzb24pIHsKICAgICAgdGhpcy5zdHJlYW1NYW5hZ2VyLmFib3J0KHJlYXNvbik7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTmV0d29ya1BkZk1hbmFnZXI7Cn0oQmFzZVBkZk1hbmFnZXIpOwoKZXhwb3J0cy5OZXR3b3JrUGRmTWFuYWdlciA9IE5ldHdvcmtQZGZNYW5hZ2VyOwoKLyoqKi8gfSksCi8qIDIwMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkNodW5rZWRTdHJlYW1NYW5hZ2VyID0gZXhwb3J0cy5DaHVua2VkU3RyZWFtID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7IHZhciBpdDsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJ1bmRlZmluZWQiIHx8IG9bU3ltYm9sLml0ZXJhdG9yXSA9PSBudWxsKSB7IGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSB7IGlmIChpdCkgbyA9IGl0OyB2YXIgaSA9IDA7IHZhciBGID0gZnVuY3Rpb24gRigpIHt9OyByZXR1cm4geyBzOiBGLCBuOiBmdW5jdGlvbiBuKCkgeyBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHsgZG9uZTogdHJ1ZSB9OyByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IG9baSsrXSB9OyB9LCBlOiBmdW5jdGlvbiBlKF9lKSB7IHRocm93IF9lOyB9LCBmOiBGIH07IH0gdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9IHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSwgZGlkRXJyID0gZmFsc2UsIGVycjsgcmV0dXJuIHsgczogZnVuY3Rpb24gcygpIHsgaXQgPSBvW1N5bWJvbC5pdGVyYXRvcl0oKTsgfSwgbjogZnVuY3Rpb24gbigpIHsgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7IG5vcm1hbENvbXBsZXRpb24gPSBzdGVwLmRvbmU7IHJldHVybiBzdGVwOyB9LCBlOiBmdW5jdGlvbiBlKF9lMikgeyBkaWRFcnIgPSB0cnVlOyBlcnIgPSBfZTI7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGlmICghbm9ybWFsQ29tcGxldGlvbiAmJiBpdFsicmV0dXJuIl0gIT0gbnVsbCkgaXRbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChkaWRFcnIpIHRocm93IGVycjsgfSB9IH07IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9Cgp2YXIgQ2h1bmtlZFN0cmVhbSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQ2h1bmtlZFN0cmVhbShsZW5ndGgsIGNodW5rU2l6ZSwgbWFuYWdlcikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENodW5rZWRTdHJlYW0pOwoKICAgIHRoaXMuYnl0ZXMgPSBuZXcgVWludDhBcnJheShsZW5ndGgpOwogICAgdGhpcy5zdGFydCA9IDA7CiAgICB0aGlzLnBvcyA9IDA7CiAgICB0aGlzLmVuZCA9IGxlbmd0aDsKICAgIHRoaXMuY2h1bmtTaXplID0gY2h1bmtTaXplOwogICAgdGhpcy5sb2FkZWRDaHVua3MgPSBbXTsKICAgIHRoaXMubnVtQ2h1bmtzTG9hZGVkID0gMDsKICAgIHRoaXMubnVtQ2h1bmtzID0gTWF0aC5jZWlsKGxlbmd0aCAvIGNodW5rU2l6ZSk7CiAgICB0aGlzLm1hbmFnZXIgPSBtYW5hZ2VyOwogICAgdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGggPSAwOwogICAgdGhpcy5sYXN0U3VjY2Vzc2Z1bEVuc3VyZUJ5dGVDaHVuayA9IC0xOwogIH0KCiAgX2NyZWF0ZUNsYXNzKENodW5rZWRTdHJlYW0sIFt7CiAgICBrZXk6ICJnZXRNaXNzaW5nQ2h1bmtzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRNaXNzaW5nQ2h1bmtzKCkgewogICAgICB2YXIgY2h1bmtzID0gW107CgogICAgICBmb3IgKHZhciBjaHVuayA9IDAsIG4gPSB0aGlzLm51bUNodW5rczsgY2h1bmsgPCBuOyArK2NodW5rKSB7CiAgICAgICAgaWYgKCF0aGlzLmxvYWRlZENodW5rc1tjaHVua10pIHsKICAgICAgICAgIGNodW5rcy5wdXNoKGNodW5rKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBjaHVua3M7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QmFzZVN0cmVhbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJhc2VTdHJlYW1zKCkgewogICAgICByZXR1cm4gW3RoaXNdOwogICAgfQogIH0sIHsKICAgIGtleTogImFsbENodW5rc0xvYWRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWxsQ2h1bmtzTG9hZGVkKCkgewogICAgICByZXR1cm4gdGhpcy5udW1DaHVua3NMb2FkZWQgPT09IHRoaXMubnVtQ2h1bmtzOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uUmVjZWl2ZURhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVjZWl2ZURhdGEoYmVnaW4sIGNodW5rKSB7CiAgICAgIHZhciBjaHVua1NpemUgPSB0aGlzLmNodW5rU2l6ZTsKCiAgICAgIGlmIChiZWdpbiAlIGNodW5rU2l6ZSAhPT0gMCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiQmFkIGJlZ2luIG9mZnNldDogIi5jb25jYXQoYmVnaW4pKTsKICAgICAgfQoKICAgICAgdmFyIGVuZCA9IGJlZ2luICsgY2h1bmsuYnl0ZUxlbmd0aDsKCiAgICAgIGlmIChlbmQgJSBjaHVua1NpemUgIT09IDAgJiYgZW5kICE9PSB0aGlzLmJ5dGVzLmxlbmd0aCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiQmFkIGVuZCBvZmZzZXQ6ICIuY29uY2F0KGVuZCkpOwogICAgICB9CgogICAgICB0aGlzLmJ5dGVzLnNldChuZXcgVWludDhBcnJheShjaHVuayksIGJlZ2luKTsKICAgICAgdmFyIGJlZ2luQ2h1bmsgPSBNYXRoLmZsb29yKGJlZ2luIC8gY2h1bmtTaXplKTsKICAgICAgdmFyIGVuZENodW5rID0gTWF0aC5mbG9vcigoZW5kIC0gMSkgLyBjaHVua1NpemUpICsgMTsKCiAgICAgIGZvciAodmFyIGN1ckNodW5rID0gYmVnaW5DaHVuazsgY3VyQ2h1bmsgPCBlbmRDaHVuazsgKytjdXJDaHVuaykgewogICAgICAgIGlmICghdGhpcy5sb2FkZWRDaHVua3NbY3VyQ2h1bmtdKSB7CiAgICAgICAgICB0aGlzLmxvYWRlZENodW5rc1tjdXJDaHVua10gPSB0cnVlOwogICAgICAgICAgKyt0aGlzLm51bUNodW5rc0xvYWRlZDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJvblJlY2VpdmVQcm9ncmVzc2l2ZURhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUmVjZWl2ZVByb2dyZXNzaXZlRGF0YShkYXRhKSB7CiAgICAgIHZhciBwb3NpdGlvbiA9IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoOwogICAgICB2YXIgYmVnaW5DaHVuayA9IE1hdGguZmxvb3IocG9zaXRpb24gLyB0aGlzLmNodW5rU2l6ZSk7CiAgICAgIHRoaXMuYnl0ZXMuc2V0KG5ldyBVaW50OEFycmF5KGRhdGEpLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IGRhdGEuYnl0ZUxlbmd0aDsKICAgICAgdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGggPSBwb3NpdGlvbjsKICAgICAgdmFyIGVuZENodW5rID0gcG9zaXRpb24gPj0gdGhpcy5lbmQgPyB0aGlzLm51bUNodW5rcyA6IE1hdGguZmxvb3IocG9zaXRpb24gLyB0aGlzLmNodW5rU2l6ZSk7CgogICAgICBmb3IgKHZhciBjdXJDaHVuayA9IGJlZ2luQ2h1bms7IGN1ckNodW5rIDwgZW5kQ2h1bms7ICsrY3VyQ2h1bmspIHsKICAgICAgICBpZiAoIXRoaXMubG9hZGVkQ2h1bmtzW2N1ckNodW5rXSkgewogICAgICAgICAgdGhpcy5sb2FkZWRDaHVua3NbY3VyQ2h1bmtdID0gdHJ1ZTsKICAgICAgICAgICsrdGhpcy5udW1DaHVua3NMb2FkZWQ7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZW5zdXJlQnl0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZW5zdXJlQnl0ZShwb3MpIHsKICAgICAgaWYgKHBvcyA8IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgY2h1bmsgPSBNYXRoLmZsb29yKHBvcyAvIHRoaXMuY2h1bmtTaXplKTsKCiAgICAgIGlmIChjaHVuayA9PT0gdGhpcy5sYXN0U3VjY2Vzc2Z1bEVuc3VyZUJ5dGVDaHVuaykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmxvYWRlZENodW5rc1tjaHVua10pIHsKICAgICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24ocG9zLCBwb3MgKyAxKTsKICAgICAgfQoKICAgICAgdGhpcy5sYXN0U3VjY2Vzc2Z1bEVuc3VyZUJ5dGVDaHVuayA9IGNodW5rOwogICAgfQogIH0sIHsKICAgIGtleTogImVuc3VyZVJhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlbnN1cmVSYW5nZShiZWdpbiwgZW5kKSB7CiAgICAgIGlmIChiZWdpbiA+PSBlbmQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChlbmQgPD0gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBjaHVua1NpemUgPSB0aGlzLmNodW5rU2l6ZTsKICAgICAgdmFyIGJlZ2luQ2h1bmsgPSBNYXRoLmZsb29yKGJlZ2luIC8gY2h1bmtTaXplKTsKICAgICAgdmFyIGVuZENodW5rID0gTWF0aC5mbG9vcigoZW5kIC0gMSkgLyBjaHVua1NpemUpICsgMTsKCiAgICAgIGZvciAodmFyIGNodW5rID0gYmVnaW5DaHVuazsgY2h1bmsgPCBlbmRDaHVuazsgKytjaHVuaykgewogICAgICAgIGlmICghdGhpcy5sb2FkZWRDaHVua3NbY2h1bmtdKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24oYmVnaW4sIGVuZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAibmV4dEVtcHR5Q2h1bmsiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5leHRFbXB0eUNodW5rKGJlZ2luQ2h1bmspIHsKICAgICAgdmFyIG51bUNodW5rcyA9IHRoaXMubnVtQ2h1bmtzOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1DaHVua3M7ICsraSkgewogICAgICAgIHZhciBjaHVuayA9IChiZWdpbkNodW5rICsgaSkgJSBudW1DaHVua3M7CgogICAgICAgIGlmICghdGhpcy5sb2FkZWRDaHVua3NbY2h1bmtdKSB7CiAgICAgICAgICByZXR1cm4gY2h1bms7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYXNDaHVuayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzQ2h1bmsoY2h1bmspIHsKICAgICAgcmV0dXJuICEhdGhpcy5sb2FkZWRDaHVua3NbY2h1bmtdOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEJ5dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJ5dGUoKSB7CiAgICAgIHZhciBwb3MgPSB0aGlzLnBvczsKCiAgICAgIGlmIChwb3MgPj0gdGhpcy5lbmQpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIGlmIChwb3MgPj0gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgICB0aGlzLmVuc3VyZUJ5dGUocG9zKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuYnl0ZXNbdGhpcy5wb3MrK107CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VWludDE2IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRVaW50MTYoKSB7CiAgICAgIHZhciBiMCA9IHRoaXMuZ2V0Qnl0ZSgpOwogICAgICB2YXIgYjEgPSB0aGlzLmdldEJ5dGUoKTsKCiAgICAgIGlmIChiMCA9PT0gLTEgfHwgYjEgPT09IC0xKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CgogICAgICByZXR1cm4gKGIwIDw8IDgpICsgYjE7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0SW50MzIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEludDMyKCkgewogICAgICB2YXIgYjAgPSB0aGlzLmdldEJ5dGUoKTsKICAgICAgdmFyIGIxID0gdGhpcy5nZXRCeXRlKCk7CiAgICAgIHZhciBiMiA9IHRoaXMuZ2V0Qnl0ZSgpOwogICAgICB2YXIgYjMgPSB0aGlzLmdldEJ5dGUoKTsKICAgICAgcmV0dXJuIChiMCA8PCAyNCkgKyAoYjEgPDwgMTYpICsgKGIyIDw8IDgpICsgYjM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Qnl0ZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJ5dGVzKGxlbmd0aCkgewogICAgICB2YXIgZm9yY2VDbGFtcGVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKICAgICAgdmFyIHBvcyA9IHRoaXMucG9zOwogICAgICB2YXIgc3RyRW5kID0gdGhpcy5lbmQ7CgogICAgICBpZiAoIWxlbmd0aCkgewogICAgICAgIGlmIChzdHJFbmQgPiB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCkgewogICAgICAgICAgdGhpcy5lbnN1cmVSYW5nZShwb3MsIHN0ckVuZCk7CiAgICAgICAgfQoKICAgICAgICB2YXIgX3N1YmFycmF5ID0gYnl0ZXMuc3ViYXJyYXkocG9zLCBzdHJFbmQpOwoKICAgICAgICByZXR1cm4gZm9yY2VDbGFtcGVkID8gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KF9zdWJhcnJheSkgOiBfc3ViYXJyYXk7CiAgICAgIH0KCiAgICAgIHZhciBlbmQgPSBwb3MgKyBsZW5ndGg7CgogICAgICBpZiAoZW5kID4gc3RyRW5kKSB7CiAgICAgICAgZW5kID0gc3RyRW5kOwogICAgICB9CgogICAgICBpZiAoZW5kID4gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgICB0aGlzLmVuc3VyZVJhbmdlKHBvcywgZW5kKTsKICAgICAgfQoKICAgICAgdGhpcy5wb3MgPSBlbmQ7CiAgICAgIHZhciBzdWJhcnJheSA9IGJ5dGVzLnN1YmFycmF5KHBvcywgZW5kKTsKICAgICAgcmV0dXJuIGZvcmNlQ2xhbXBlZCA/IG5ldyBVaW50OENsYW1wZWRBcnJheShzdWJhcnJheSkgOiBzdWJhcnJheTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwZWVrQnl0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGVla0J5dGUoKSB7CiAgICAgIHZhciBwZWVrZWRCeXRlID0gdGhpcy5nZXRCeXRlKCk7CgogICAgICBpZiAocGVla2VkQnl0ZSAhPT0gLTEpIHsKICAgICAgICB0aGlzLnBvcy0tOwogICAgICB9CgogICAgICByZXR1cm4gcGVla2VkQnl0ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwZWVrQnl0ZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBlZWtCeXRlcyhsZW5ndGgpIHsKICAgICAgdmFyIGZvcmNlQ2xhbXBlZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBieXRlcyA9IHRoaXMuZ2V0Qnl0ZXMobGVuZ3RoLCBmb3JjZUNsYW1wZWQpOwogICAgICB0aGlzLnBvcyAtPSBieXRlcy5sZW5ndGg7CiAgICAgIHJldHVybiBieXRlczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRCeXRlUmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJ5dGVSYW5nZShiZWdpbiwgZW5kKSB7CiAgICAgIGlmIChiZWdpbiA8IDApIHsKICAgICAgICBiZWdpbiA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChlbmQgPiB0aGlzLmVuZCkgewogICAgICAgIGVuZCA9IHRoaXMuZW5kOwogICAgICB9CgogICAgICBpZiAoZW5kID4gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGgpIHsKICAgICAgICB0aGlzLmVuc3VyZVJhbmdlKGJlZ2luLCBlbmQpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5ieXRlcy5zdWJhcnJheShiZWdpbiwgZW5kKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJza2lwIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBza2lwKG4pIHsKICAgICAgaWYgKCFuKSB7CiAgICAgICAgbiA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMucG9zICs9IG47CiAgICB9CiAgfSwgewogICAga2V5OiAicmVzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0KCkgewogICAgICB0aGlzLnBvcyA9IHRoaXMuc3RhcnQ7CiAgICB9CiAgfSwgewogICAga2V5OiAibW92ZVN0YXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlU3RhcnQoKSB7CiAgICAgIHRoaXMuc3RhcnQgPSB0aGlzLnBvczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYWtlU3ViU3RyZWFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYWtlU3ViU3RyZWFtKHN0YXJ0LCBsZW5ndGgsIGRpY3QpIHsKICAgICAgaWYgKGxlbmd0aCkgewogICAgICAgIGlmIChzdGFydCArIGxlbmd0aCA+IHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmVuc3VyZVJhbmdlKHN0YXJ0LCBzdGFydCArIGxlbmd0aCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChzdGFydCA+PSB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCkgewogICAgICAgICAgdGhpcy5lbnN1cmVCeXRlKHN0YXJ0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIENodW5rZWRTdHJlYW1TdWJzdHJlYW0oKSB7fQoKICAgICAgQ2h1bmtlZFN0cmVhbVN1YnN0cmVhbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHRoaXMpOwoKICAgICAgQ2h1bmtlZFN0cmVhbVN1YnN0cmVhbS5wcm90b3R5cGUuZ2V0TWlzc2luZ0NodW5rcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgY2h1bmtTaXplID0gdGhpcy5jaHVua1NpemU7CiAgICAgICAgdmFyIGJlZ2luQ2h1bmsgPSBNYXRoLmZsb29yKHRoaXMuc3RhcnQgLyBjaHVua1NpemUpOwogICAgICAgIHZhciBlbmRDaHVuayA9IE1hdGguZmxvb3IoKHRoaXMuZW5kIC0gMSkgLyBjaHVua1NpemUpICsgMTsKICAgICAgICB2YXIgbWlzc2luZ0NodW5rcyA9IFtdOwoKICAgICAgICBmb3IgKHZhciBjaHVuayA9IGJlZ2luQ2h1bms7IGNodW5rIDwgZW5kQ2h1bms7ICsrY2h1bmspIHsKICAgICAgICAgIGlmICghdGhpcy5sb2FkZWRDaHVua3NbY2h1bmtdKSB7CiAgICAgICAgICAgIG1pc3NpbmdDaHVua3MucHVzaChjaHVuayk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbWlzc2luZ0NodW5rczsKICAgICAgfTsKCiAgICAgIENodW5rZWRTdHJlYW1TdWJzdHJlYW0ucHJvdG90eXBlLmFsbENodW5rc0xvYWRlZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5udW1DaHVua3NMb2FkZWQgPT09IHRoaXMubnVtQ2h1bmtzKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzLmdldE1pc3NpbmdDaHVua3MoKS5sZW5ndGggPT09IDA7CiAgICAgIH07CgogICAgICB2YXIgc3ViU3RyZWFtID0gbmV3IENodW5rZWRTdHJlYW1TdWJzdHJlYW0oKTsKICAgICAgc3ViU3RyZWFtLnBvcyA9IHN1YlN0cmVhbS5zdGFydCA9IHN0YXJ0OwogICAgICBzdWJTdHJlYW0uZW5kID0gc3RhcnQgKyBsZW5ndGggfHwgdGhpcy5lbmQ7CiAgICAgIHN1YlN0cmVhbS5kaWN0ID0gZGljdDsKICAgICAgcmV0dXJuIHN1YlN0cmVhbTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsZW5ndGgiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLmVuZCAtIHRoaXMuc3RhcnQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNFbXB0eSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoID09PSAwOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENodW5rZWRTdHJlYW07Cn0oKTsKCmV4cG9ydHMuQ2h1bmtlZFN0cmVhbSA9IENodW5rZWRTdHJlYW07Cgp2YXIgQ2h1bmtlZFN0cmVhbU1hbmFnZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENodW5rZWRTdHJlYW1NYW5hZ2VyKHBkZk5ldHdvcmtTdHJlYW0sIGFyZ3MpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDaHVua2VkU3RyZWFtTWFuYWdlcik7CgogICAgdGhpcy5sZW5ndGggPSBhcmdzLmxlbmd0aDsKICAgIHRoaXMuY2h1bmtTaXplID0gYXJncy5yYW5nZUNodW5rU2l6ZTsKICAgIHRoaXMuc3RyZWFtID0gbmV3IENodW5rZWRTdHJlYW0odGhpcy5sZW5ndGgsIHRoaXMuY2h1bmtTaXplLCB0aGlzKTsKICAgIHRoaXMucGRmTmV0d29ya1N0cmVhbSA9IHBkZk5ldHdvcmtTdHJlYW07CiAgICB0aGlzLmRpc2FibGVBdXRvRmV0Y2ggPSBhcmdzLmRpc2FibGVBdXRvRmV0Y2g7CiAgICB0aGlzLm1zZ0hhbmRsZXIgPSBhcmdzLm1zZ0hhbmRsZXI7CiAgICB0aGlzLmN1cnJSZXF1ZXN0SWQgPSAwOwogICAgdGhpcy5jaHVua3NOZWVkZWRCeVJlcXVlc3QgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5yZXF1ZXN0c0J5Q2h1bmsgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5wcm9taXNlc0J5UmVxdWVzdCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB0aGlzLnByb2dyZXNzaXZlRGF0YUxlbmd0aCA9IDA7CiAgICB0aGlzLmFib3J0ZWQgPSBmYWxzZTsKICAgIHRoaXMuX2xvYWRlZFN0cmVhbUNhcGFiaWxpdHkgPSAoMCwgX3V0aWwuY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHkpKCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQ2h1bmtlZFN0cmVhbU1hbmFnZXIsIFt7CiAgICBrZXk6ICJvbkxvYWRlZFN0cmVhbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Mb2FkZWRTdHJlYW0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9sb2FkZWRTdHJlYW1DYXBhYmlsaXR5LnByb21pc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAic2VuZFJlcXVlc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRSZXF1ZXN0KGJlZ2luLCBlbmQpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciByYW5nZVJlYWRlciA9IHRoaXMucGRmTmV0d29ya1N0cmVhbS5nZXRSYW5nZVJlYWRlcihiZWdpbiwgZW5kKTsKCiAgICAgIGlmICghcmFuZ2VSZWFkZXIuaXNTdHJlYW1pbmdTdXBwb3J0ZWQpIHsKICAgICAgICByYW5nZVJlYWRlci5vblByb2dyZXNzID0gdGhpcy5vblByb2dyZXNzLmJpbmQodGhpcyk7CiAgICAgIH0KCiAgICAgIHZhciBjaHVua3MgPSBbXSwKICAgICAgICAgIGxvYWRlZCA9IDA7CiAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciByZWFkQ2h1bmsgPSBmdW5jdGlvbiByZWFkQ2h1bmsoY2h1bmspIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICghY2h1bmsuZG9uZSkgewogICAgICAgICAgICAgIHZhciBkYXRhID0gY2h1bmsudmFsdWU7CiAgICAgICAgICAgICAgY2h1bmtzLnB1c2goZGF0YSk7CiAgICAgICAgICAgICAgbG9hZGVkICs9ICgwLCBfdXRpbC5hcnJheUJ5dGVMZW5ndGgpKGRhdGEpOwoKICAgICAgICAgICAgICBpZiAocmFuZ2VSZWFkZXIuaXNTdHJlYW1pbmdTdXBwb3J0ZWQpIHsKICAgICAgICAgICAgICAgIF90aGlzLm9uUHJvZ3Jlc3MoewogICAgICAgICAgICAgICAgICBsb2FkZWQ6IGxvYWRlZAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByYW5nZVJlYWRlci5yZWFkKCkudGhlbihyZWFkQ2h1bmssIHJlamVjdCk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY2h1bmtEYXRhID0gKDAsIF91dGlsLmFycmF5c1RvQnl0ZXMpKGNodW5rcyk7CiAgICAgICAgICAgIGNodW5rcyA9IG51bGw7CiAgICAgICAgICAgIHJlc29sdmUoY2h1bmtEYXRhKTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIHJhbmdlUmVhZGVyLnJlYWQoKS50aGVuKHJlYWRDaHVuaywgcmVqZWN0KTsKICAgICAgfSk7CiAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIGlmIChfdGhpcy5hYm9ydGVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5vblJlY2VpdmVEYXRhKHsKICAgICAgICAgIGNodW5rOiBkYXRhLAogICAgICAgICAgYmVnaW46IGJlZ2luCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlcXVlc3RBbGxDaHVua3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcXVlc3RBbGxDaHVua3MoKSB7CiAgICAgIHZhciBtaXNzaW5nQ2h1bmtzID0gdGhpcy5zdHJlYW0uZ2V0TWlzc2luZ0NodW5rcygpOwoKICAgICAgdGhpcy5fcmVxdWVzdENodW5rcyhtaXNzaW5nQ2h1bmtzKTsKCiAgICAgIHJldHVybiB0aGlzLl9sb2FkZWRTdHJlYW1DYXBhYmlsaXR5LnByb21pc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlcXVlc3RDaHVua3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZXF1ZXN0Q2h1bmtzKGNodW5rcykgewogICAgICB2YXIgcmVxdWVzdElkID0gdGhpcy5jdXJyUmVxdWVzdElkKys7CiAgICAgIHZhciBjaHVua3NOZWVkZWQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB0aGlzLmNodW5rc05lZWRlZEJ5UmVxdWVzdFtyZXF1ZXN0SWRdID0gY2h1bmtzTmVlZGVkOwoKICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGNodW5rcyksCiAgICAgICAgICBfc3RlcDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBfY2h1bmsgPSBfc3RlcC52YWx1ZTsKCiAgICAgICAgICBpZiAoIXRoaXMuc3RyZWFtLmhhc0NodW5rKF9jaHVuaykpIHsKICAgICAgICAgICAgY2h1bmtzTmVlZGVkW19jaHVua10gPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICB9CgogICAgICBpZiAoKDAsIF91dGlsLmlzRW1wdHlPYmopKGNodW5rc05lZWRlZCkpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7CiAgICAgIH0KCiAgICAgIHZhciBjYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICB0aGlzLnByb21pc2VzQnlSZXF1ZXN0W3JlcXVlc3RJZF0gPSBjYXBhYmlsaXR5OwogICAgICB2YXIgY2h1bmtzVG9SZXF1ZXN0ID0gW107CgogICAgICBmb3IgKHZhciBjaHVuayBpbiBjaHVua3NOZWVkZWQpIHsKICAgICAgICBjaHVuayA9IGNodW5rIHwgMDsKCiAgICAgICAgaWYgKCEoY2h1bmsgaW4gdGhpcy5yZXF1ZXN0c0J5Q2h1bmspKSB7CiAgICAgICAgICB0aGlzLnJlcXVlc3RzQnlDaHVua1tjaHVua10gPSBbXTsKICAgICAgICAgIGNodW5rc1RvUmVxdWVzdC5wdXNoKGNodW5rKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucmVxdWVzdHNCeUNodW5rW2NodW5rXS5wdXNoKHJlcXVlc3RJZCk7CiAgICAgIH0KCiAgICAgIGlmICghY2h1bmtzVG9SZXF1ZXN0Lmxlbmd0aCkgewogICAgICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgICAgIH0KCiAgICAgIHZhciBncm91cGVkQ2h1bmtzVG9SZXF1ZXN0ID0gdGhpcy5ncm91cENodW5rcyhjaHVua3NUb1JlcXVlc3QpOwoKICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihncm91cGVkQ2h1bmtzVG9SZXF1ZXN0KSwKICAgICAgICAgIF9zdGVwMjsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBncm91cGVkQ2h1bmsgPSBfc3RlcDIudmFsdWU7CiAgICAgICAgICB2YXIgYmVnaW4gPSBncm91cGVkQ2h1bmsuYmVnaW5DaHVuayAqIHRoaXMuY2h1bmtTaXplOwogICAgICAgICAgdmFyIGVuZCA9IE1hdGgubWluKGdyb3VwZWRDaHVuay5lbmRDaHVuayAqIHRoaXMuY2h1bmtTaXplLCB0aGlzLmxlbmd0aCk7CiAgICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KGJlZ2luLCBlbmQpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U3RyZWFtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdHJlYW0oKSB7CiAgICAgIHJldHVybiB0aGlzLnN0cmVhbTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXF1ZXN0UmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcXVlc3RSYW5nZShiZWdpbiwgZW5kKSB7CiAgICAgIGVuZCA9IE1hdGgubWluKGVuZCwgdGhpcy5sZW5ndGgpOwogICAgICB2YXIgYmVnaW5DaHVuayA9IHRoaXMuZ2V0QmVnaW5DaHVuayhiZWdpbik7CiAgICAgIHZhciBlbmRDaHVuayA9IHRoaXMuZ2V0RW5kQ2h1bmsoZW5kKTsKICAgICAgdmFyIGNodW5rcyA9IFtdOwoKICAgICAgZm9yICh2YXIgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgICAgY2h1bmtzLnB1c2goY2h1bmspOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdENodW5rcyhjaHVua3MpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlcXVlc3RSYW5nZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcXVlc3RSYW5nZXMoKSB7CiAgICAgIHZhciByYW5nZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdOwogICAgICB2YXIgY2h1bmtzVG9SZXF1ZXN0ID0gW107CgogICAgICB2YXIgX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHJhbmdlcyksCiAgICAgICAgICBfc3RlcDM7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMy5zKCk7ICEoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcmFuZ2UgPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICB2YXIgYmVnaW5DaHVuayA9IHRoaXMuZ2V0QmVnaW5DaHVuayhyYW5nZS5iZWdpbik7CiAgICAgICAgICB2YXIgZW5kQ2h1bmsgPSB0aGlzLmdldEVuZENodW5rKHJhbmdlLmVuZCk7CgogICAgICAgICAgZm9yICh2YXIgY2h1bmsgPSBiZWdpbkNodW5rOyBjaHVuayA8IGVuZENodW5rOyArK2NodW5rKSB7CiAgICAgICAgICAgIGlmICghY2h1bmtzVG9SZXF1ZXN0LmluY2x1ZGVzKGNodW5rKSkgewogICAgICAgICAgICAgIGNodW5rc1RvUmVxdWVzdC5wdXNoKGNodW5rKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMy5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yMy5mKCk7CiAgICAgIH0KCiAgICAgIGNodW5rc1RvUmVxdWVzdC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgcmV0dXJuIGEgLSBiOwogICAgICB9KTsKICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3RDaHVua3MoY2h1bmtzVG9SZXF1ZXN0KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJncm91cENodW5rcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ3JvdXBDaHVua3MoY2h1bmtzKSB7CiAgICAgIHZhciBncm91cGVkQ2h1bmtzID0gW107CiAgICAgIHZhciBiZWdpbkNodW5rID0gLTE7CiAgICAgIHZhciBwcmV2Q2h1bmsgPSAtMTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGNodW5rcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgdmFyIGNodW5rID0gY2h1bmtzW2ldOwoKICAgICAgICBpZiAoYmVnaW5DaHVuayA8IDApIHsKICAgICAgICAgIGJlZ2luQ2h1bmsgPSBjaHVuazsKICAgICAgICB9CgogICAgICAgIGlmIChwcmV2Q2h1bmsgPj0gMCAmJiBwcmV2Q2h1bmsgKyAxICE9PSBjaHVuaykgewogICAgICAgICAgZ3JvdXBlZENodW5rcy5wdXNoKHsKICAgICAgICAgICAgYmVnaW5DaHVuazogYmVnaW5DaHVuaywKICAgICAgICAgICAgZW5kQ2h1bms6IHByZXZDaHVuayArIDEKICAgICAgICAgIH0pOwogICAgICAgICAgYmVnaW5DaHVuayA9IGNodW5rOwogICAgICAgIH0KCiAgICAgICAgaWYgKGkgKyAxID09PSBjaHVua3MubGVuZ3RoKSB7CiAgICAgICAgICBncm91cGVkQ2h1bmtzLnB1c2goewogICAgICAgICAgICBiZWdpbkNodW5rOiBiZWdpbkNodW5rLAogICAgICAgICAgICBlbmRDaHVuazogY2h1bmsgKyAxCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHByZXZDaHVuayA9IGNodW5rOwogICAgICB9CgogICAgICByZXR1cm4gZ3JvdXBlZENodW5rczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvblByb2dyZXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblByb2dyZXNzKGFyZ3MpIHsKICAgICAgdGhpcy5tc2dIYW5kbGVyLnNlbmQoIkRvY1Byb2dyZXNzIiwgewogICAgICAgIGxvYWRlZDogdGhpcy5zdHJlYW0ubnVtQ2h1bmtzTG9hZGVkICogdGhpcy5jaHVua1NpemUgKyBhcmdzLmxvYWRlZCwKICAgICAgICB0b3RhbDogdGhpcy5sZW5ndGgKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25SZWNlaXZlRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZWNlaXZlRGF0YShhcmdzKSB7CiAgICAgIHZhciBjaHVuayA9IGFyZ3MuY2h1bms7CiAgICAgIHZhciBpc1Byb2dyZXNzaXZlID0gYXJncy5iZWdpbiA9PT0gdW5kZWZpbmVkOwogICAgICB2YXIgYmVnaW4gPSBpc1Byb2dyZXNzaXZlID8gdGhpcy5wcm9ncmVzc2l2ZURhdGFMZW5ndGggOiBhcmdzLmJlZ2luOwogICAgICB2YXIgZW5kID0gYmVnaW4gKyBjaHVuay5ieXRlTGVuZ3RoOwogICAgICB2YXIgYmVnaW5DaHVuayA9IE1hdGguZmxvb3IoYmVnaW4gLyB0aGlzLmNodW5rU2l6ZSk7CiAgICAgIHZhciBlbmRDaHVuayA9IGVuZCA8IHRoaXMubGVuZ3RoID8gTWF0aC5mbG9vcihlbmQgLyB0aGlzLmNodW5rU2l6ZSkgOiBNYXRoLmNlaWwoZW5kIC8gdGhpcy5jaHVua1NpemUpOwoKICAgICAgaWYgKGlzUHJvZ3Jlc3NpdmUpIHsKICAgICAgICB0aGlzLnN0cmVhbS5vblJlY2VpdmVQcm9ncmVzc2l2ZURhdGEoY2h1bmspOwogICAgICAgIHRoaXMucHJvZ3Jlc3NpdmVEYXRhTGVuZ3RoID0gZW5kOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc3RyZWFtLm9uUmVjZWl2ZURhdGEoYmVnaW4sIGNodW5rKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuc3RyZWFtLmFsbENodW5rc0xvYWRlZCgpKSB7CiAgICAgICAgdGhpcy5fbG9hZGVkU3RyZWFtQ2FwYWJpbGl0eS5yZXNvbHZlKHRoaXMuc3RyZWFtKTsKICAgICAgfQoKICAgICAgdmFyIGxvYWRlZFJlcXVlc3RzID0gW107CgogICAgICBmb3IgKHZhciBjdXJDaHVuayA9IGJlZ2luQ2h1bms7IGN1ckNodW5rIDwgZW5kQ2h1bms7ICsrY3VyQ2h1bmspIHsKICAgICAgICB2YXIgcmVxdWVzdElkcyA9IHRoaXMucmVxdWVzdHNCeUNodW5rW2N1ckNodW5rXSB8fCBbXTsKICAgICAgICBkZWxldGUgdGhpcy5yZXF1ZXN0c0J5Q2h1bmtbY3VyQ2h1bmtdOwoKICAgICAgICB2YXIgX2l0ZXJhdG9yNCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHJlcXVlc3RJZHMpLAogICAgICAgICAgICBfc3RlcDQ7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgcmVxdWVzdElkID0gX3N0ZXA0LnZhbHVlOwogICAgICAgICAgICB2YXIgY2h1bmtzTmVlZGVkID0gdGhpcy5jaHVua3NOZWVkZWRCeVJlcXVlc3RbcmVxdWVzdElkXTsKCiAgICAgICAgICAgIGlmIChjdXJDaHVuayBpbiBjaHVua3NOZWVkZWQpIHsKICAgICAgICAgICAgICBkZWxldGUgY2h1bmtzTmVlZGVkW2N1ckNodW5rXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCEoMCwgX3V0aWwuaXNFbXB0eU9iaikoY2h1bmtzTmVlZGVkKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsb2FkZWRSZXF1ZXN0cy5wdXNoKHJlcXVlc3RJZCk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yNC5mKCk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRoaXMuZGlzYWJsZUF1dG9GZXRjaCAmJiAoMCwgX3V0aWwuaXNFbXB0eU9iaikodGhpcy5yZXF1ZXN0c0J5Q2h1bmspKSB7CiAgICAgICAgdmFyIG5leHRFbXB0eUNodW5rOwoKICAgICAgICBpZiAodGhpcy5zdHJlYW0ubnVtQ2h1bmtzTG9hZGVkID09PSAxKSB7CiAgICAgICAgICB2YXIgbGFzdENodW5rID0gdGhpcy5zdHJlYW0ubnVtQ2h1bmtzIC0gMTsKCiAgICAgICAgICBpZiAoIXRoaXMuc3RyZWFtLmhhc0NodW5rKGxhc3RDaHVuaykpIHsKICAgICAgICAgICAgbmV4dEVtcHR5Q2h1bmsgPSBsYXN0Q2h1bms7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5leHRFbXB0eUNodW5rID0gdGhpcy5zdHJlYW0ubmV4dEVtcHR5Q2h1bmsoZW5kQ2h1bmspOwogICAgICAgIH0KCiAgICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIobmV4dEVtcHR5Q2h1bmspKSB7CiAgICAgICAgICB0aGlzLl9yZXF1ZXN0Q2h1bmtzKFtuZXh0RW1wdHlDaHVua10pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yICh2YXIgX2kgPSAwLCBfbG9hZGVkUmVxdWVzdHMgPSBsb2FkZWRSZXF1ZXN0czsgX2kgPCBfbG9hZGVkUmVxdWVzdHMubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgdmFyIF9yZXF1ZXN0SWQgPSBfbG9hZGVkUmVxdWVzdHNbX2ldOwogICAgICAgIHZhciBjYXBhYmlsaXR5ID0gdGhpcy5wcm9taXNlc0J5UmVxdWVzdFtfcmVxdWVzdElkXTsKICAgICAgICBkZWxldGUgdGhpcy5wcm9taXNlc0J5UmVxdWVzdFtfcmVxdWVzdElkXTsKICAgICAgICBjYXBhYmlsaXR5LnJlc29sdmUoKTsKICAgICAgfQoKICAgICAgdGhpcy5tc2dIYW5kbGVyLnNlbmQoIkRvY1Byb2dyZXNzIiwgewogICAgICAgIGxvYWRlZDogdGhpcy5zdHJlYW0ubnVtQ2h1bmtzTG9hZGVkICogdGhpcy5jaHVua1NpemUsCiAgICAgICAgdG90YWw6IHRoaXMubGVuZ3RoCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRXJyb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRXJyb3IoZXJyKSB7CiAgICAgIHRoaXMuX2xvYWRlZFN0cmVhbUNhcGFiaWxpdHkucmVqZWN0KGVycik7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QmVnaW5DaHVuayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QmVnaW5DaHVuayhiZWdpbikgewogICAgICByZXR1cm4gTWF0aC5mbG9vcihiZWdpbiAvIHRoaXMuY2h1bmtTaXplKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRFbmRDaHVuayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RW5kQ2h1bmsoZW5kKSB7CiAgICAgIHJldHVybiBNYXRoLmZsb29yKChlbmQgLSAxKSAvIHRoaXMuY2h1bmtTaXplKSArIDE7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWJvcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KHJlYXNvbikgewogICAgICB0aGlzLmFib3J0ZWQgPSB0cnVlOwoKICAgICAgaWYgKHRoaXMucGRmTmV0d29ya1N0cmVhbSkgewogICAgICAgIHRoaXMucGRmTmV0d29ya1N0cmVhbS5jYW5jZWxBbGxSZXF1ZXN0cyhyZWFzb24pOwogICAgICB9CgogICAgICBmb3IgKHZhciByZXF1ZXN0SWQgaW4gdGhpcy5wcm9taXNlc0J5UmVxdWVzdCkgewogICAgICAgIHRoaXMucHJvbWlzZXNCeVJlcXVlc3RbcmVxdWVzdElkXS5yZWplY3QocmVhc29uKTsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIENodW5rZWRTdHJlYW1NYW5hZ2VyOwp9KCk7CgpleHBvcnRzLkNodW5rZWRTdHJlYW1NYW5hZ2VyID0gQ2h1bmtlZFN0cmVhbU1hbmFnZXI7CgovKioqLyB9KSwKLyogMjAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5ID0gZ2V0TG9va3VwVGFibGVGYWN0b3J5OwpleHBvcnRzLmdldEluaGVyaXRhYmxlUHJvcGVydHkgPSBnZXRJbmhlcml0YWJsZVByb3BlcnR5OwpleHBvcnRzLnRvUm9tYW5OdW1lcmFscyA9IHRvUm9tYW5OdW1lcmFsczsKZXhwb3J0cy5sb2cyID0gbG9nMjsKZXhwb3J0cy5yZWFkSW50OCA9IHJlYWRJbnQ4OwpleHBvcnRzLnJlYWRVaW50MTYgPSByZWFkVWludDE2OwpleHBvcnRzLnJlYWRVaW50MzIgPSByZWFkVWludDMyOwpleHBvcnRzLmlzV2hpdGVTcGFjZSA9IGlzV2hpdGVTcGFjZTsKZXhwb3J0cy5YUmVmUGFyc2VFeGNlcHRpb24gPSBleHBvcnRzLlhSZWZFbnRyeUV4Y2VwdGlvbiA9IGV4cG9ydHMuTWlzc2luZ0RhdGFFeGNlcHRpb24gPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIGdldExvb2t1cFRhYmxlRmFjdG9yeShpbml0aWFsaXplcikgewogIHZhciBsb29rdXA7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIGlmIChpbml0aWFsaXplcikgewogICAgICBsb29rdXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICBpbml0aWFsaXplcihsb29rdXApOwogICAgICBpbml0aWFsaXplciA9IG51bGw7CiAgICB9CgogICAgcmV0dXJuIGxvb2t1cDsKICB9Owp9Cgp2YXIgTWlzc2luZ0RhdGFFeGNlcHRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlRXhjZXB0aW9uKSB7CiAgX2luaGVyaXRzKE1pc3NpbmdEYXRhRXhjZXB0aW9uLCBfQmFzZUV4Y2VwdGlvbik7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoTWlzc2luZ0RhdGFFeGNlcHRpb24pOwoKICBmdW5jdGlvbiBNaXNzaW5nRGF0YUV4Y2VwdGlvbihiZWdpbiwgZW5kKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1pc3NpbmdEYXRhRXhjZXB0aW9uKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsICJNaXNzaW5nIGRhdGEgWyIuY29uY2F0KGJlZ2luLCAiLCAiKS5jb25jYXQoZW5kLCAiKSIpKTsKICAgIF90aGlzLmJlZ2luID0gYmVnaW47CiAgICBfdGhpcy5lbmQgPSBlbmQ7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICByZXR1cm4gTWlzc2luZ0RhdGFFeGNlcHRpb247Cn0oX3V0aWwuQmFzZUV4Y2VwdGlvbik7CgpleHBvcnRzLk1pc3NpbmdEYXRhRXhjZXB0aW9uID0gTWlzc2luZ0RhdGFFeGNlcHRpb247Cgp2YXIgWFJlZkVudHJ5RXhjZXB0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZUV4Y2VwdGlvbjIpIHsKICBfaW5oZXJpdHMoWFJlZkVudHJ5RXhjZXB0aW9uLCBfQmFzZUV4Y2VwdGlvbjIpOwoKICB2YXIgX3N1cGVyMiA9IF9jcmVhdGVTdXBlcihYUmVmRW50cnlFeGNlcHRpb24pOwoKICBmdW5jdGlvbiBYUmVmRW50cnlFeGNlcHRpb24oKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgWFJlZkVudHJ5RXhjZXB0aW9uKTsKCiAgICByZXR1cm4gX3N1cGVyMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0KCiAgcmV0dXJuIFhSZWZFbnRyeUV4Y2VwdGlvbjsKfShfdXRpbC5CYXNlRXhjZXB0aW9uKTsKCmV4cG9ydHMuWFJlZkVudHJ5RXhjZXB0aW9uID0gWFJlZkVudHJ5RXhjZXB0aW9uOwoKdmFyIFhSZWZQYXJzZUV4Y2VwdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VFeGNlcHRpb24zKSB7CiAgX2luaGVyaXRzKFhSZWZQYXJzZUV4Y2VwdGlvbiwgX0Jhc2VFeGNlcHRpb24zKTsKCiAgdmFyIF9zdXBlcjMgPSBfY3JlYXRlU3VwZXIoWFJlZlBhcnNlRXhjZXB0aW9uKTsKCiAgZnVuY3Rpb24gWFJlZlBhcnNlRXhjZXB0aW9uKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFhSZWZQYXJzZUV4Y2VwdGlvbik7CgogICAgcmV0dXJuIF9zdXBlcjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CgogIHJldHVybiBYUmVmUGFyc2VFeGNlcHRpb247Cn0oX3V0aWwuQmFzZUV4Y2VwdGlvbik7CgpleHBvcnRzLlhSZWZQYXJzZUV4Y2VwdGlvbiA9IFhSZWZQYXJzZUV4Y2VwdGlvbjsKCmZ1bmN0aW9uIGdldEluaGVyaXRhYmxlUHJvcGVydHkoX3JlZikgewogIHZhciBkaWN0ID0gX3JlZi5kaWN0LAogICAgICBrZXkgPSBfcmVmLmtleSwKICAgICAgX3JlZiRnZXRBcnJheSA9IF9yZWYuZ2V0QXJyYXksCiAgICAgIGdldEFycmF5ID0gX3JlZiRnZXRBcnJheSA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmJGdldEFycmF5LAogICAgICBfcmVmJHN0b3BXaGVuRm91bmQgPSBfcmVmLnN0b3BXaGVuRm91bmQsCiAgICAgIHN0b3BXaGVuRm91bmQgPSBfcmVmJHN0b3BXaGVuRm91bmQgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmJHN0b3BXaGVuRm91bmQ7CiAgdmFyIExPT1BfTElNSVQgPSAxMDA7CiAgdmFyIGxvb3BDb3VudCA9IDA7CiAgdmFyIHZhbHVlczsKCiAgd2hpbGUgKGRpY3QpIHsKICAgIHZhciB2YWx1ZSA9IGdldEFycmF5ID8gZGljdC5nZXRBcnJheShrZXkpIDogZGljdC5nZXQoa2V5KTsKCiAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICBpZiAoc3RvcFdoZW5Gb3VuZCkgewogICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgfQoKICAgICAgaWYgKCF2YWx1ZXMpIHsKICAgICAgICB2YWx1ZXMgPSBbXTsKICAgICAgfQoKICAgICAgdmFsdWVzLnB1c2godmFsdWUpOwogICAgfQoKICAgIGlmICgrK2xvb3BDb3VudCA+IExPT1BfTElNSVQpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJnZXRJbmhlcml0YWJsZVByb3BlcnR5OiBtYXhpbXVtIGxvb3AgY291bnQgZXhjZWVkZWQgZm9yIFwiIi5jb25jYXQoa2V5LCAiXCIiKSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGRpY3QgPSBkaWN0LmdldCgiUGFyZW50Iik7CiAgfQoKICByZXR1cm4gdmFsdWVzOwp9Cgp2YXIgUk9NQU5fTlVNQkVSX01BUCA9IFsiIiwgIkMiLCAiQ0MiLCAiQ0NDIiwgIkNEIiwgIkQiLCAiREMiLCAiRENDIiwgIkRDQ0MiLCAiQ00iLCAiIiwgIlgiLCAiWFgiLCAiWFhYIiwgIlhMIiwgIkwiLCAiTFgiLCAiTFhYIiwgIkxYWFgiLCAiWEMiLCAiIiwgIkkiLCAiSUkiLCAiSUlJIiwgIklWIiwgIlYiLCAiVkkiLCAiVklJIiwgIlZJSUkiLCAiSVgiXTsKCmZ1bmN0aW9uIHRvUm9tYW5OdW1lcmFscyhudW1iZXIpIHsKICB2YXIgbG93ZXJDYXNlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAoMCwgX3V0aWwuYXNzZXJ0KShOdW1iZXIuaXNJbnRlZ2VyKG51bWJlcikgJiYgbnVtYmVyID4gMCwgIlRoZSBudW1iZXIgc2hvdWxkIGJlIGEgcG9zaXRpdmUgaW50ZWdlci4iKTsKICB2YXIgcm9tYW5CdWYgPSBbXTsKICB2YXIgcG9zOwoKICB3aGlsZSAobnVtYmVyID49IDEwMDApIHsKICAgIG51bWJlciAtPSAxMDAwOwogICAgcm9tYW5CdWYucHVzaCgiTSIpOwogIH0KCiAgcG9zID0gbnVtYmVyIC8gMTAwIHwgMDsKICBudW1iZXIgJT0gMTAwOwogIHJvbWFuQnVmLnB1c2goUk9NQU5fTlVNQkVSX01BUFtwb3NdKTsKICBwb3MgPSBudW1iZXIgLyAxMCB8IDA7CiAgbnVtYmVyICU9IDEwOwogIHJvbWFuQnVmLnB1c2goUk9NQU5fTlVNQkVSX01BUFsxMCArIHBvc10pOwogIHJvbWFuQnVmLnB1c2goUk9NQU5fTlVNQkVSX01BUFsyMCArIG51bWJlcl0pOwogIHZhciByb21hblN0ciA9IHJvbWFuQnVmLmpvaW4oIiIpOwogIHJldHVybiBsb3dlckNhc2UgPyByb21hblN0ci50b0xvd2VyQ2FzZSgpIDogcm9tYW5TdHI7Cn0KCmZ1bmN0aW9uIGxvZzIoeCkgewogIGlmICh4IDw9IDApIHsKICAgIHJldHVybiAwOwogIH0KCiAgcmV0dXJuIE1hdGguY2VpbChNYXRoLmxvZzIoeCkpOwp9CgpmdW5jdGlvbiByZWFkSW50OChkYXRhLCBvZmZzZXQpIHsKICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDI0ID4+IDI0Owp9CgpmdW5jdGlvbiByZWFkVWludDE2KGRhdGEsIG9mZnNldCkgewogIHJldHVybiBkYXRhW29mZnNldF0gPDwgOCB8IGRhdGFbb2Zmc2V0ICsgMV07Cn0KCmZ1bmN0aW9uIHJlYWRVaW50MzIoZGF0YSwgb2Zmc2V0KSB7CiAgcmV0dXJuIChkYXRhW29mZnNldF0gPDwgMjQgfCBkYXRhW29mZnNldCArIDFdIDw8IDE2IHwgZGF0YVtvZmZzZXQgKyAyXSA8PCA4IHwgZGF0YVtvZmZzZXQgKyAzXSkgPj4+IDA7Cn0KCmZ1bmN0aW9uIGlzV2hpdGVTcGFjZShjaCkgewogIHJldHVybiBjaCA9PT0gMHgyMCB8fCBjaCA9PT0gMHgwOSB8fCBjaCA9PT0gMHgwZCB8fCBjaCA9PT0gMHgwYTsKfQoKLyoqKi8gfSksCi8qIDIwMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlBERkRvY3VtZW50ID0gZXhwb3J0cy5QYWdlID0gdm9pZCAwOwoKdmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX193X3BkZmpzX3JlcXVpcmVfXygyKSk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9vYmogPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMyk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5OCk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMSk7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA1KTsKCnZhciBfYW5ub3RhdGlvbiA9IF9fd19wZGZqc19yZXF1aXJlX18oMjE4KTsKCnZhciBfY3J5cHRvID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTUpOwoKdmFyIF9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNCk7Cgp2YXIgX29wZXJhdG9yX2xpc3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxOSk7Cgp2YXIgX2V2YWx1YXRvciA9IF9fd19wZGZqc19yZXF1aXJlX18oMjIwKTsKCnZhciBfZnVuY3Rpb24gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzNCk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAidW5kZWZpbmVkIiB8fCAhKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoYXJyKSkpIHJldHVybjsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobywgYWxsb3dBcnJheUxpa2UpIHsgdmFyIGl0OyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gInVuZGVmaW5lZCIgfHwgb1tTeW1ib2wuaXRlcmF0b3JdID09IG51bGwpIHsgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHsgaWYgKGl0KSBvID0gaXQ7IHZhciBpID0gMDsgdmFyIEYgPSBmdW5jdGlvbiBGKCkge307IHJldHVybiB7IHM6IEYsIG46IGZ1bmN0aW9uIG4oKSB7IGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4geyBkb25lOiB0cnVlIH07IHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogb1tpKytdIH07IH0sIGU6IGZ1bmN0aW9uIGUoX2UyKSB7IHRocm93IF9lMjsgfSwgZjogRiB9OyB9IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBpdGVyYXRlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKTsgfSB2YXIgbm9ybWFsQ29tcGxldGlvbiA9IHRydWUsIGRpZEVyciA9IGZhbHNlLCBlcnI7IHJldHVybiB7IHM6IGZ1bmN0aW9uIHMoKSB7IGl0ID0gb1tTeW1ib2wuaXRlcmF0b3JdKCk7IH0sIG46IGZ1bmN0aW9uIG4oKSB7IHZhciBzdGVwID0gaXQubmV4dCgpOyBub3JtYWxDb21wbGV0aW9uID0gc3RlcC5kb25lOyByZXR1cm4gc3RlcDsgfSwgZTogZnVuY3Rpb24gZShfZTMpIHsgZGlkRXJyID0gdHJ1ZTsgZXJyID0gX2UzOyB9LCBmOiBmdW5jdGlvbiBmKCkgeyB0cnkgeyBpZiAoIW5vcm1hbENvbXBsZXRpb24gJiYgaXRbInJldHVybiJdICE9IG51bGwpIGl0WyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoZGlkRXJyKSB0aHJvdyBlcnI7IH0gfSB9OyB9CgpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQoKZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKdmFyIERFRkFVTFRfVVNFUl9VTklUID0gMS4wOwp2YXIgTEVUVEVSX1NJWkVfTUVESUFCT1ggPSBbMCwgMCwgNjEyLCA3OTJdOwoKZnVuY3Rpb24gaXNBbm5vdGF0aW9uUmVuZGVyYWJsZShhbm5vdGF0aW9uLCBpbnRlbnQpIHsKICByZXR1cm4gaW50ZW50ID09PSAiZGlzcGxheSIgJiYgYW5ub3RhdGlvbi52aWV3YWJsZSB8fCBpbnRlbnQgPT09ICJwcmludCIgJiYgYW5ub3RhdGlvbi5wcmludGFibGU7Cn0KCnZhciBQYWdlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBQYWdlKF9yZWYpIHsKICAgIHZhciBwZGZNYW5hZ2VyID0gX3JlZi5wZGZNYW5hZ2VyLAogICAgICAgIHhyZWYgPSBfcmVmLnhyZWYsCiAgICAgICAgcGFnZUluZGV4ID0gX3JlZi5wYWdlSW5kZXgsCiAgICAgICAgcGFnZURpY3QgPSBfcmVmLnBhZ2VEaWN0LAogICAgICAgIHJlZiA9IF9yZWYucmVmLAogICAgICAgIGZvbnRDYWNoZSA9IF9yZWYuZm9udENhY2hlLAogICAgICAgIGJ1aWx0SW5DTWFwQ2FjaGUgPSBfcmVmLmJ1aWx0SW5DTWFwQ2FjaGUsCiAgICAgICAgZ2xvYmFsSW1hZ2VDYWNoZSA9IF9yZWYuZ2xvYmFsSW1hZ2VDYWNoZSwKICAgICAgICBwZGZGdW5jdGlvbkZhY3RvcnkgPSBfcmVmLnBkZkZ1bmN0aW9uRmFjdG9yeTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGFnZSk7CgogICAgdGhpcy5wZGZNYW5hZ2VyID0gcGRmTWFuYWdlcjsKICAgIHRoaXMucGFnZUluZGV4ID0gcGFnZUluZGV4OwogICAgdGhpcy5wYWdlRGljdCA9IHBhZ2VEaWN0OwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMucmVmID0gcmVmOwogICAgdGhpcy5mb250Q2FjaGUgPSBmb250Q2FjaGU7CiAgICB0aGlzLmJ1aWx0SW5DTWFwQ2FjaGUgPSBidWlsdEluQ01hcENhY2hlOwogICAgdGhpcy5nbG9iYWxJbWFnZUNhY2hlID0gZ2xvYmFsSW1hZ2VDYWNoZTsKICAgIHRoaXMucGRmRnVuY3Rpb25GYWN0b3J5ID0gcGRmRnVuY3Rpb25GYWN0b3J5OwogICAgdGhpcy5ldmFsdWF0b3JPcHRpb25zID0gcGRmTWFuYWdlci5ldmFsdWF0b3JPcHRpb25zOwogICAgdGhpcy5yZXNvdXJjZXNQcm9taXNlID0gbnVsbDsKICAgIHZhciBpZENvdW50ZXJzID0gewogICAgICBvYmo6IDAKICAgIH07CiAgICB0aGlzLmlkRmFjdG9yeSA9IHsKICAgICAgY3JlYXRlT2JqSWQ6IGZ1bmN0aW9uIGNyZWF0ZU9iaklkKCkgewogICAgICAgIHJldHVybiAicCIuY29uY2F0KHBhZ2VJbmRleCwgIl8iKS5jb25jYXQoKytpZENvdW50ZXJzLm9iaik7CiAgICAgIH0sCiAgICAgIGdldERvY0lkOiBmdW5jdGlvbiBnZXREb2NJZCgpIHsKICAgICAgICByZXR1cm4gImdfIi5jb25jYXQocGRmTWFuYWdlci5kb2NJZCk7CiAgICAgIH0KICAgIH07CiAgfQoKICBfY3JlYXRlQ2xhc3MoUGFnZSwgW3sKICAgIGtleTogIl9nZXRJbmhlcml0YWJsZVByb3BlcnR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eShrZXkpIHsKICAgICAgdmFyIGdldEFycmF5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgICAgdmFyIHZhbHVlID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgICBkaWN0OiB0aGlzLnBhZ2VEaWN0LAogICAgICAgIGtleToga2V5LAogICAgICAgIGdldEFycmF5OiBnZXRBcnJheSwKICAgICAgICBzdG9wV2hlbkZvdW5kOiBmYWxzZQogICAgICB9KTsKCiAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDEgfHwgISgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKHZhbHVlWzBdKSkgewogICAgICAgIHJldHVybiB2YWx1ZVswXTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkRpY3QubWVyZ2UodGhpcy54cmVmLCB2YWx1ZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2dldEJvdW5kaW5nQm94IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0Qm91bmRpbmdCb3gobmFtZSkgewogICAgICB2YXIgYm94ID0gdGhpcy5fZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eShuYW1lLCB0cnVlKTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGJveCkgJiYgYm94Lmxlbmd0aCA9PT0gNCkgewogICAgICAgIGlmIChib3hbMl0gLSBib3hbMF0gIT09IDAgJiYgYm94WzNdIC0gYm94WzFdICE9PSAwKSB7CiAgICAgICAgICByZXR1cm4gYm94OwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJFbXB0eSAvIi5jb25jYXQobmFtZSwgIiBlbnRyeS4iKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogImdldENvbnRlbnRTdHJlYW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbnRlbnRTdHJlYW0oKSB7CiAgICAgIHZhciBjb250ZW50ID0gdGhpcy5jb250ZW50OwogICAgICB2YXIgc3RyZWFtOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29udGVudCkpIHsKICAgICAgICB2YXIgeHJlZiA9IHRoaXMueHJlZjsKICAgICAgICB2YXIgc3RyZWFtcyA9IFtdOwoKICAgICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoY29udGVudCksCiAgICAgICAgICAgIF9zdGVwOwoKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIHN1YlN0cmVhbSA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICBzdHJlYW1zLnB1c2goeHJlZi5mZXRjaElmUmVmKHN1YlN0cmVhbSkpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICB9CgogICAgICAgIHN0cmVhbSA9IG5ldyBfc3RyZWFtLlN0cmVhbXNTZXF1ZW5jZVN0cmVhbShzdHJlYW1zKTsKICAgICAgfSBlbHNlIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKGNvbnRlbnQpKSB7CiAgICAgICAgc3RyZWFtID0gY29udGVudDsKICAgICAgfSBlbHNlIHsKICAgICAgICBzdHJlYW0gPSBuZXcgX3N0cmVhbS5OdWxsU3RyZWFtKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBzdHJlYW07CiAgICB9CiAgfSwgewogICAga2V5OiAibG9hZFJlc291cmNlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFJlc291cmNlcyhrZXlzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMucmVzb3VyY2VzUHJvbWlzZSkgewogICAgICAgIHRoaXMucmVzb3VyY2VzUHJvbWlzZSA9IHRoaXMucGRmTWFuYWdlci5lbnN1cmUodGhpcywgInJlc291cmNlcyIpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5yZXNvdXJjZXNQcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBvYmplY3RMb2FkZXIgPSBuZXcgX29iai5PYmplY3RMb2FkZXIoX3RoaXMucmVzb3VyY2VzLCBrZXlzLCBfdGhpcy54cmVmKTsKICAgICAgICByZXR1cm4gb2JqZWN0TG9hZGVyLmxvYWQoKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0T3BlcmF0b3JMaXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPcGVyYXRvckxpc3QoX3JlZjIpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgaGFuZGxlciA9IF9yZWYyLmhhbmRsZXIsCiAgICAgICAgICBzaW5rID0gX3JlZjIuc2luaywKICAgICAgICAgIHRhc2sgPSBfcmVmMi50YXNrLAogICAgICAgICAgaW50ZW50ID0gX3JlZjIuaW50ZW50LAogICAgICAgICAgcmVuZGVySW50ZXJhY3RpdmVGb3JtcyA9IF9yZWYyLnJlbmRlckludGVyYWN0aXZlRm9ybXM7CiAgICAgIHZhciBjb250ZW50U3RyZWFtUHJvbWlzZSA9IHRoaXMucGRmTWFuYWdlci5lbnN1cmUodGhpcywgImdldENvbnRlbnRTdHJlYW0iKTsKICAgICAgdmFyIHJlc291cmNlc1Byb21pc2UgPSB0aGlzLmxvYWRSZXNvdXJjZXMoWyJFeHRHU3RhdGUiLCAiQ29sb3JTcGFjZSIsICJQYXR0ZXJuIiwgIlNoYWRpbmciLCAiWE9iamVjdCIsICJGb250Il0pOwogICAgICB2YXIgcGFydGlhbEV2YWx1YXRvciA9IG5ldyBfZXZhbHVhdG9yLlBhcnRpYWxFdmFsdWF0b3IoewogICAgICAgIHhyZWY6IHRoaXMueHJlZiwKICAgICAgICBoYW5kbGVyOiBoYW5kbGVyLAogICAgICAgIHBhZ2VJbmRleDogdGhpcy5wYWdlSW5kZXgsCiAgICAgICAgaWRGYWN0b3J5OiB0aGlzLmlkRmFjdG9yeSwKICAgICAgICBmb250Q2FjaGU6IHRoaXMuZm9udENhY2hlLAogICAgICAgIGJ1aWx0SW5DTWFwQ2FjaGU6IHRoaXMuYnVpbHRJbkNNYXBDYWNoZSwKICAgICAgICBnbG9iYWxJbWFnZUNhY2hlOiB0aGlzLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgICAgb3B0aW9uczogdGhpcy5ldmFsdWF0b3JPcHRpb25zLAogICAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeTogdGhpcy5wZGZGdW5jdGlvbkZhY3RvcnkKICAgICAgfSk7CiAgICAgIHZhciBkYXRhUHJvbWlzZXMgPSBQcm9taXNlLmFsbChbY29udGVudFN0cmVhbVByb21pc2UsIHJlc291cmNlc1Byb21pc2VdKTsKICAgICAgdmFyIHBhZ2VMaXN0UHJvbWlzZSA9IGRhdGFQcm9taXNlcy50aGVuKGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgIHZhciBfcmVmNCA9IF9zbGljZWRUb0FycmF5KF9yZWYzLCAxKSwKICAgICAgICAgICAgY29udGVudFN0cmVhbSA9IF9yZWY0WzBdOwoKICAgICAgICB2YXIgb3BMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdChpbnRlbnQsIHNpbmssIF90aGlzMi5wYWdlSW5kZXgpOwogICAgICAgIGhhbmRsZXIuc2VuZCgiU3RhcnRSZW5kZXJQYWdlIiwgewogICAgICAgICAgdHJhbnNwYXJlbmN5OiBwYXJ0aWFsRXZhbHVhdG9yLmhhc0JsZW5kTW9kZXMoX3RoaXMyLnJlc291cmNlcyksCiAgICAgICAgICBwYWdlSW5kZXg6IF90aGlzMi5wYWdlSW5kZXgsCiAgICAgICAgICBpbnRlbnQ6IGludGVudAogICAgICAgIH0pOwogICAgICAgIHJldHVybiBwYXJ0aWFsRXZhbHVhdG9yLmdldE9wZXJhdG9yTGlzdCh7CiAgICAgICAgICBzdHJlYW06IGNvbnRlbnRTdHJlYW0sCiAgICAgICAgICB0YXNrOiB0YXNrLAogICAgICAgICAgcmVzb3VyY2VzOiBfdGhpczIucmVzb3VyY2VzLAogICAgICAgICAgb3BlcmF0b3JMaXN0OiBvcExpc3QKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBvcExpc3Q7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3BhZ2VMaXN0UHJvbWlzZSwgdGhpcy5fcGFyc2VkQW5ub3RhdGlvbnNdKS50aGVuKGZ1bmN0aW9uIChfcmVmNSkgewogICAgICAgIHZhciBfcmVmNiA9IF9zbGljZWRUb0FycmF5KF9yZWY1LCAyKSwKICAgICAgICAgICAgcGFnZU9wTGlzdCA9IF9yZWY2WzBdLAogICAgICAgICAgICBhbm5vdGF0aW9ucyA9IF9yZWY2WzFdOwoKICAgICAgICBpZiAoYW5ub3RhdGlvbnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICBwYWdlT3BMaXN0LmZsdXNoKHRydWUpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbGVuZ3RoOiBwYWdlT3BMaXN0LnRvdGFsTGVuZ3RoCiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgdmFyIG9wTGlzdFByb21pc2VzID0gW107CgogICAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoYW5ub3RhdGlvbnMpLAogICAgICAgICAgICBfc3RlcDI7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgYW5ub3RhdGlvbiA9IF9zdGVwMi52YWx1ZTsKCiAgICAgICAgICAgIGlmIChpc0Fubm90YXRpb25SZW5kZXJhYmxlKGFubm90YXRpb24sIGludGVudCkpIHsKICAgICAgICAgICAgICBvcExpc3RQcm9taXNlcy5wdXNoKGFubm90YXRpb24uZ2V0T3BlcmF0b3JMaXN0KHBhcnRpYWxFdmFsdWF0b3IsIHRhc2ssIHJlbmRlckludGVyYWN0aXZlRm9ybXMpWyJjYXRjaCJdKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiZ2V0T3BlcmF0b3JMaXN0IC0gaWdub3JpbmcgYW5ub3RhdGlvbiBkYXRhIGR1cmluZyAiICsgIlwiIi5jb25jYXQodGFzay5uYW1lLCAiXCIgdGFzazogXCIiKS5jb25jYXQocmVhc29uLCAiXCIuIikpOwogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwob3BMaXN0UHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKG9wTGlzdHMpIHsKICAgICAgICAgIHBhZ2VPcExpc3QuYWRkT3AoX3V0aWwuT1BTLmJlZ2luQW5ub3RhdGlvbnMsIFtdKTsKCiAgICAgICAgICB2YXIgX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG9wTGlzdHMpLAogICAgICAgICAgICAgIF9zdGVwMzsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgICAgICAgIHZhciBvcExpc3QgPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICAgICAgcGFnZU9wTGlzdC5hZGRPcExpc3Qob3BMaXN0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2l0ZXJhdG9yMy5mKCk7CiAgICAgICAgICB9CgogICAgICAgICAgcGFnZU9wTGlzdC5hZGRPcChfdXRpbC5PUFMuZW5kQW5ub3RhdGlvbnMsIFtdKTsKICAgICAgICAgIHBhZ2VPcExpc3QuZmx1c2godHJ1ZSk7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBsZW5ndGg6IHBhZ2VPcExpc3QudG90YWxMZW5ndGgKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImV4dHJhY3RUZXh0Q29udGVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZXh0cmFjdFRleHRDb250ZW50KF9yZWY3KSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIGhhbmRsZXIgPSBfcmVmNy5oYW5kbGVyLAogICAgICAgICAgdGFzayA9IF9yZWY3LnRhc2ssCiAgICAgICAgICBub3JtYWxpemVXaGl0ZXNwYWNlID0gX3JlZjcubm9ybWFsaXplV2hpdGVzcGFjZSwKICAgICAgICAgIHNpbmsgPSBfcmVmNy5zaW5rLAogICAgICAgICAgY29tYmluZVRleHRJdGVtcyA9IF9yZWY3LmNvbWJpbmVUZXh0SXRlbXM7CiAgICAgIHZhciBjb250ZW50U3RyZWFtUHJvbWlzZSA9IHRoaXMucGRmTWFuYWdlci5lbnN1cmUodGhpcywgImdldENvbnRlbnRTdHJlYW0iKTsKICAgICAgdmFyIHJlc291cmNlc1Byb21pc2UgPSB0aGlzLmxvYWRSZXNvdXJjZXMoWyJFeHRHU3RhdGUiLCAiWE9iamVjdCIsICJGb250Il0pOwogICAgICB2YXIgZGF0YVByb21pc2VzID0gUHJvbWlzZS5hbGwoW2NvbnRlbnRTdHJlYW1Qcm9taXNlLCByZXNvdXJjZXNQcm9taXNlXSk7CiAgICAgIHJldHVybiBkYXRhUHJvbWlzZXMudGhlbihmdW5jdGlvbiAoX3JlZjgpIHsKICAgICAgICB2YXIgX3JlZjkgPSBfc2xpY2VkVG9BcnJheShfcmVmOCwgMSksCiAgICAgICAgICAgIGNvbnRlbnRTdHJlYW0gPSBfcmVmOVswXTsKCiAgICAgICAgdmFyIHBhcnRpYWxFdmFsdWF0b3IgPSBuZXcgX2V2YWx1YXRvci5QYXJ0aWFsRXZhbHVhdG9yKHsKICAgICAgICAgIHhyZWY6IF90aGlzMy54cmVmLAogICAgICAgICAgaGFuZGxlcjogaGFuZGxlciwKICAgICAgICAgIHBhZ2VJbmRleDogX3RoaXMzLnBhZ2VJbmRleCwKICAgICAgICAgIGlkRmFjdG9yeTogX3RoaXMzLmlkRmFjdG9yeSwKICAgICAgICAgIGZvbnRDYWNoZTogX3RoaXMzLmZvbnRDYWNoZSwKICAgICAgICAgIGJ1aWx0SW5DTWFwQ2FjaGU6IF90aGlzMy5idWlsdEluQ01hcENhY2hlLAogICAgICAgICAgZ2xvYmFsSW1hZ2VDYWNoZTogX3RoaXMzLmdsb2JhbEltYWdlQ2FjaGUsCiAgICAgICAgICBvcHRpb25zOiBfdGhpczMuZXZhbHVhdG9yT3B0aW9ucywKICAgICAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeTogX3RoaXMzLnBkZkZ1bmN0aW9uRmFjdG9yeQogICAgICAgIH0pOwogICAgICAgIHJldHVybiBwYXJ0aWFsRXZhbHVhdG9yLmdldFRleHRDb250ZW50KHsKICAgICAgICAgIHN0cmVhbTogY29udGVudFN0cmVhbSwKICAgICAgICAgIHRhc2s6IHRhc2ssCiAgICAgICAgICByZXNvdXJjZXM6IF90aGlzMy5yZXNvdXJjZXMsCiAgICAgICAgICBub3JtYWxpemVXaGl0ZXNwYWNlOiBub3JtYWxpemVXaGl0ZXNwYWNlLAogICAgICAgICAgY29tYmluZVRleHRJdGVtczogY29tYmluZVRleHRJdGVtcywKICAgICAgICAgIHNpbms6IHNpbmsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QW5ub3RhdGlvbnNEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbm5vdGF0aW9uc0RhdGEoaW50ZW50KSB7CiAgICAgIHJldHVybiB0aGlzLl9wYXJzZWRBbm5vdGF0aW9ucy50aGVuKGZ1bmN0aW9uIChhbm5vdGF0aW9ucykgewogICAgICAgIHZhciBhbm5vdGF0aW9uc0RhdGEgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gYW5ub3RhdGlvbnMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgaWYgKCFpbnRlbnQgfHwgaXNBbm5vdGF0aW9uUmVuZGVyYWJsZShhbm5vdGF0aW9uc1tpXSwgaW50ZW50KSkgewogICAgICAgICAgICBhbm5vdGF0aW9uc0RhdGEucHVzaChhbm5vdGF0aW9uc1tpXS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiBhbm5vdGF0aW9uc0RhdGE7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNvbnRlbnQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLnBhZ2VEaWN0LmdldCgiQ29udGVudHMiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXNvdXJjZXMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicmVzb3VyY2VzIiwgdGhpcy5fZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eSgiUmVzb3VyY2VzIikgfHwgX3ByaW1pdGl2ZXMuRGljdC5lbXB0eSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibWVkaWFCb3giLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibWVkaWFCb3giLCB0aGlzLl9nZXRCb3VuZGluZ0JveCgiTWVkaWFCb3giKSB8fCBMRVRURVJfU0laRV9NRURJQUJPWCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JvcEJveCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjcm9wQm94IiwgdGhpcy5fZ2V0Qm91bmRpbmdCb3goIkNyb3BCb3giKSB8fCB0aGlzLm1lZGlhQm94KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1c2VyVW5pdCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG9iaiA9IHRoaXMucGFnZURpY3QuZ2V0KCJVc2VyVW5pdCIpOwoKICAgICAgaWYgKCEoMCwgX3V0aWwuaXNOdW0pKG9iaikgfHwgb2JqIDw9IDApIHsKICAgICAgICBvYmogPSBERUZBVUxUX1VTRVJfVU5JVDsKICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJ1c2VyVW5pdCIsIG9iaik7CiAgICB9CiAgfSwgewogICAga2V5OiAidmlldyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIGNyb3BCb3ggPSB0aGlzLmNyb3BCb3gsCiAgICAgICAgICBtZWRpYUJveCA9IHRoaXMubWVkaWFCb3g7CiAgICAgIHZhciB2aWV3OwoKICAgICAgaWYgKGNyb3BCb3ggPT09IG1lZGlhQm94IHx8ICgwLCBfdXRpbC5pc0FycmF5RXF1YWwpKGNyb3BCb3gsIG1lZGlhQm94KSkgewogICAgICAgIHZpZXcgPSBtZWRpYUJveDsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgYm94ID0gX3V0aWwuVXRpbC5pbnRlcnNlY3QoY3JvcEJveCwgbWVkaWFCb3gpOwoKICAgICAgICBpZiAoYm94ICYmIGJveFsyXSAtIGJveFswXSAhPT0gMCAmJiBib3hbM10gLSBib3hbMV0gIT09IDApIHsKICAgICAgICAgIHZpZXcgPSBib3g7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiRW1wdHkgL0Nyb3BCb3ggYW5kIC9NZWRpYUJveCBpbnRlcnNlY3Rpb24uIik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInZpZXciLCB2aWV3IHx8IG1lZGlhQm94KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyb3RhdGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciByb3RhdGUgPSB0aGlzLl9nZXRJbmhlcml0YWJsZVByb3BlcnR5KCJSb3RhdGUiKSB8fCAwOwoKICAgICAgaWYgKHJvdGF0ZSAlIDkwICE9PSAwKSB7CiAgICAgICAgcm90YXRlID0gMDsKICAgICAgfSBlbHNlIGlmIChyb3RhdGUgPj0gMzYwKSB7CiAgICAgICAgcm90YXRlID0gcm90YXRlICUgMzYwOwogICAgICB9IGVsc2UgaWYgKHJvdGF0ZSA8IDApIHsKICAgICAgICByb3RhdGUgPSAocm90YXRlICUgMzYwICsgMzYwKSAlIDM2MDsKICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJyb3RhdGUiLCByb3RhdGUpOwogICAgfQogIH0sIHsKICAgIGtleTogImFubm90YXRpb25zIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImFubm90YXRpb25zIiwgdGhpcy5fZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eSgiQW5ub3RzIikgfHwgW10pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9wYXJzZWRBbm5vdGF0aW9ucyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgcGFyc2VkQW5ub3RhdGlvbnMgPSB0aGlzLnBkZk1hbmFnZXIuZW5zdXJlKHRoaXMsICJhbm5vdGF0aW9ucyIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBhbm5vdGF0aW9uUHJvbWlzZXMgPSBbXTsKCiAgICAgICAgdmFyIF9pdGVyYXRvcjQgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihfdGhpczQuYW5ub3RhdGlvbnMpLAogICAgICAgICAgICBfc3RlcDQ7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgYW5ub3RhdGlvblJlZiA9IF9zdGVwNC52YWx1ZTsKICAgICAgICAgICAgYW5ub3RhdGlvblByb21pc2VzLnB1c2goX2Fubm90YXRpb24uQW5ub3RhdGlvbkZhY3RvcnkuY3JlYXRlKF90aGlzNC54cmVmLCBhbm5vdGF0aW9uUmVmLCBfdGhpczQucGRmTWFuYWdlciwgX3RoaXM0LmlkRmFjdG9yeSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiX3BhcnNlZEFubm90YXRpb25zOiBcIiIuY29uY2F0KHJlYXNvbiwgIlwiLiIpKTsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfSkpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yNC5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvcjQuZigpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGFubm90YXRpb25Qcm9taXNlcykudGhlbihmdW5jdGlvbiAoYW5ub3RhdGlvbnMpIHsKICAgICAgICAgIHJldHVybiBhbm5vdGF0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKGFubm90YXRpb24pIHsKICAgICAgICAgICAgcmV0dXJuICEhYW5ub3RhdGlvbjsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJfcGFyc2VkQW5ub3RhdGlvbnMiLCBwYXJzZWRBbm5vdGF0aW9ucyk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUGFnZTsKfSgpOwoKZXhwb3J0cy5QYWdlID0gUGFnZTsKdmFyIFBERl9IRUFERVJfU0lHTkFUVVJFID0gbmV3IFVpbnQ4QXJyYXkoWzB4MjUsIDB4NTAsIDB4NDQsIDB4NDYsIDB4MmRdKTsKdmFyIFNUQVJUWFJFRl9TSUdOQVRVUkUgPSBuZXcgVWludDhBcnJheShbMHg3MywgMHg3NCwgMHg2MSwgMHg3MiwgMHg3NCwgMHg3OCwgMHg3MiwgMHg2NSwgMHg2Nl0pOwp2YXIgRU5ET0JKX1NJR05BVFVSRSA9IG5ldyBVaW50OEFycmF5KFsweDY1LCAweDZlLCAweDY0LCAweDZmLCAweDYyLCAweDZhXSk7CnZhciBGSU5HRVJQUklOVF9GSVJTVF9CWVRFUyA9IDEwMjQ7CnZhciBFTVBUWV9GSU5HRVJQUklOVCA9ICJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwIjsKdmFyIFBERl9IRUFERVJfVkVSU0lPTl9SRUdFWFAgPSAvXlsxLTldXC5bMC05XSQvOwoKZnVuY3Rpb24gZmluZChzdHJlYW0sIHNpZ25hdHVyZSkgewogIHZhciBsaW1pdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMTAyNDsKICB2YXIgYmFja3dhcmRzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICB2YXIgc2lnbmF0dXJlTGVuZ3RoID0gc2lnbmF0dXJlLmxlbmd0aDsKICB2YXIgc2NhbkJ5dGVzID0gc3RyZWFtLnBlZWtCeXRlcyhsaW1pdCk7CiAgdmFyIHNjYW5MZW5ndGggPSBzY2FuQnl0ZXMubGVuZ3RoIC0gc2lnbmF0dXJlTGVuZ3RoOwoKICBpZiAoc2Nhbkxlbmd0aCA8PSAwKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBpZiAoYmFja3dhcmRzKSB7CiAgICB2YXIgc2lnbmF0dXJlRW5kID0gc2lnbmF0dXJlTGVuZ3RoIC0gMTsKICAgIHZhciBwb3MgPSBzY2FuQnl0ZXMubGVuZ3RoIC0gMTsKCiAgICB3aGlsZSAocG9zID49IHNpZ25hdHVyZUVuZCkgewogICAgICB2YXIgaiA9IDA7CgogICAgICB3aGlsZSAoaiA8IHNpZ25hdHVyZUxlbmd0aCAmJiBzY2FuQnl0ZXNbcG9zIC0gal0gPT09IHNpZ25hdHVyZVtzaWduYXR1cmVFbmQgLSBqXSkgewogICAgICAgIGorKzsKICAgICAgfQoKICAgICAgaWYgKGogPj0gc2lnbmF0dXJlTGVuZ3RoKSB7CiAgICAgICAgc3RyZWFtLnBvcyArPSBwb3MgLSBzaWduYXR1cmVFbmQ7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHBvcy0tOwogICAgfQogIH0gZWxzZSB7CiAgICB2YXIgX3BvcyA9IDA7CgogICAgd2hpbGUgKF9wb3MgPD0gc2Nhbkxlbmd0aCkgewogICAgICB2YXIgX2ogPSAwOwoKICAgICAgd2hpbGUgKF9qIDwgc2lnbmF0dXJlTGVuZ3RoICYmIHNjYW5CeXRlc1tfcG9zICsgX2pdID09PSBzaWduYXR1cmVbX2pdKSB7CiAgICAgICAgX2orKzsKICAgICAgfQoKICAgICAgaWYgKF9qID49IHNpZ25hdHVyZUxlbmd0aCkgewogICAgICAgIHN0cmVhbS5wb3MgKz0gX3BvczsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgX3BvcysrOwogICAgfQogIH0KCiAgcmV0dXJuIGZhbHNlOwp9Cgp2YXIgUERGRG9jdW1lbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFBERkRvY3VtZW50KHBkZk1hbmFnZXIsIGFyZykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBERkRvY3VtZW50KTsKCiAgICB2YXIgc3RyZWFtOwoKICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKGFyZykpIHsKICAgICAgc3RyZWFtID0gYXJnOwogICAgfSBlbHNlIGlmICgoMCwgX3V0aWwuaXNBcnJheUJ1ZmZlcikoYXJnKSkgewogICAgICBzdHJlYW0gPSBuZXcgX3N0cmVhbS5TdHJlYW0oYXJnKTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiUERGRG9jdW1lbnQ6IFVua25vd24gYXJndW1lbnQgdHlwZSIpOwogICAgfQoKICAgIGlmIChzdHJlYW0ubGVuZ3RoIDw9IDApIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkludmFsaWRQREZFeGNlcHRpb24oIlRoZSBQREYgZmlsZSBpcyBlbXB0eSwgaS5lLiBpdHMgc2l6ZSBpcyB6ZXJvIGJ5dGVzLiIpOwogICAgfQoKICAgIHRoaXMucGRmTWFuYWdlciA9IHBkZk1hbmFnZXI7CiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMueHJlZiA9IG5ldyBfb2JqLlhSZWYoc3RyZWFtLCBwZGZNYW5hZ2VyKTsKICAgIHRoaXMucGRmRnVuY3Rpb25GYWN0b3J5ID0gbmV3IF9mdW5jdGlvbi5QREZGdW5jdGlvbkZhY3RvcnkoewogICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgIGlzRXZhbFN1cHBvcnRlZDogcGRmTWFuYWdlci5ldmFsdWF0b3JPcHRpb25zLmlzRXZhbFN1cHBvcnRlZAogICAgfSk7CiAgICB0aGlzLl9wYWdlUHJvbWlzZXMgPSBbXTsKICB9CgogIF9jcmVhdGVDbGFzcyhQREZEb2N1bWVudCwgW3sKICAgIGtleTogInBhcnNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZShyZWNvdmVyeU1vZGUpIHsKICAgICAgdGhpcy5zZXR1cChyZWNvdmVyeU1vZGUpOwogICAgICB2YXIgdmVyc2lvbiA9IHRoaXMuY2F0YWxvZy5jYXREaWN0LmdldCgiVmVyc2lvbiIpOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHZlcnNpb24pKSB7CiAgICAgICAgdGhpcy5wZGZGb3JtYXRWZXJzaW9uID0gdmVyc2lvbi5uYW1lOwogICAgICB9CgogICAgICB0cnkgewogICAgICAgIHRoaXMuYWNyb0Zvcm0gPSB0aGlzLmNhdGFsb2cuY2F0RGljdC5nZXQoIkFjcm9Gb3JtIik7CgogICAgICAgIGlmICh0aGlzLmFjcm9Gb3JtKSB7CiAgICAgICAgICB0aGlzLnhmYSA9IHRoaXMuYWNyb0Zvcm0uZ2V0KCJYRkEiKTsKICAgICAgICAgIHZhciBmaWVsZHMgPSB0aGlzLmFjcm9Gb3JtLmdldCgiRmllbGRzIik7CgogICAgICAgICAgaWYgKCghQXJyYXkuaXNBcnJheShmaWVsZHMpIHx8IGZpZWxkcy5sZW5ndGggPT09IDApICYmICF0aGlzLnhmYSkgewogICAgICAgICAgICB0aGlzLmFjcm9Gb3JtID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICAgIHRocm93IGV4OwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLmluZm8pKCJDYW5ub3QgZmV0Y2ggQWNyb0Zvcm0gZW50cnk7IGFzc3VtaW5nIG5vIEFjcm9Gb3JtcyBhcmUgcHJlc2VudCIpOwogICAgICAgIHRoaXMuYWNyb0Zvcm0gPSBudWxsOwogICAgICB9CgogICAgICB0cnkgewogICAgICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcy5jYXRhbG9nLmNhdERpY3QuZ2V0KCJDb2xsZWN0aW9uIik7CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShjb2xsZWN0aW9uKSAmJiBjb2xsZWN0aW9uLmdldEtleXMoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkNhbm5vdCBmZXRjaCBDb2xsZWN0aW9uIGRpY3Rpb25hcnkuIik7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjaGVja0hlYWRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tIZWFkZXIoKSB7CiAgICAgIHZhciBzdHJlYW0gPSB0aGlzLnN0cmVhbTsKICAgICAgc3RyZWFtLnJlc2V0KCk7CgogICAgICBpZiAoIWZpbmQoc3RyZWFtLCBQREZfSEVBREVSX1NJR05BVFVSRSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHN0cmVhbS5tb3ZlU3RhcnQoKTsKICAgICAgdmFyIE1BWF9QREZfVkVSU0lPTl9MRU5HVEggPSAxMjsKICAgICAgdmFyIHZlcnNpb24gPSAiIiwKICAgICAgICAgIGNoOwoKICAgICAgd2hpbGUgKChjaCA9IHN0cmVhbS5nZXRCeXRlKCkpID4gMHgyMCkgewogICAgICAgIGlmICh2ZXJzaW9uLmxlbmd0aCA+PSBNQVhfUERGX1ZFUlNJT05fTEVOR1RIKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHZlcnNpb24gKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5wZGZGb3JtYXRWZXJzaW9uKSB7CiAgICAgICAgdGhpcy5wZGZGb3JtYXRWZXJzaW9uID0gdmVyc2lvbi5zdWJzdHJpbmcoNSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJwYXJzZVN0YXJ0WFJlZiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VTdGFydFhSZWYoKSB7CiAgICAgIHRoaXMueHJlZi5zZXRTdGFydFhSZWYodGhpcy5zdGFydFhSZWYpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldHVwIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXR1cChyZWNvdmVyeU1vZGUpIHsKICAgICAgdGhpcy54cmVmLnBhcnNlKHJlY292ZXJ5TW9kZSk7CiAgICAgIHRoaXMuY2F0YWxvZyA9IG5ldyBfb2JqLkNhdGFsb2codGhpcy5wZGZNYW5hZ2VyLCB0aGlzLnhyZWYpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9nZXRMaW5lYXJpemF0aW9uUGFnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldExpbmVhcml6YXRpb25QYWdlKHBhZ2VJbmRleCkgewogICAgICB2YXIgY2F0YWxvZyA9IHRoaXMuY2F0YWxvZywKICAgICAgICAgIGxpbmVhcml6YXRpb24gPSB0aGlzLmxpbmVhcml6YXRpb247CgogICAgICB2YXIgcmVmID0gX3ByaW1pdGl2ZXMuUmVmLmdldChsaW5lYXJpemF0aW9uLm9iamVjdE51bWJlckZpcnN0LCAwKTsKCiAgICAgIHJldHVybiB0aGlzLnhyZWYuZmV0Y2hBc3luYyhyZWYpLnRoZW4oZnVuY3Rpb24gKG9iaikgewogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShvYmosICJQYWdlIikgfHwgKDAsIF9wcmltaXRpdmVzLmlzRGljdCkob2JqKSAmJiAhb2JqLmhhcygiVHlwZSIpICYmIG9iai5oYXMoIkNvbnRlbnRzIikpIHsKICAgICAgICAgIGlmIChyZWYgJiYgIWNhdGFsb2cucGFnZUtpZHNDb3VudENhY2hlLmhhcyhyZWYpKSB7CiAgICAgICAgICAgIGNhdGFsb2cucGFnZUtpZHNDb3VudENhY2hlLnB1dChyZWYsIDEpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBbb2JqLCByZWZdOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJUaGUgTGluZWFyaXphdGlvbiBkaWN0aW9uYXJ5IGRvZXNuJ3QgcG9pbnQgIiArICJ0byBhIHZhbGlkIFBhZ2UgZGljdGlvbmFyeS4iKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICgwLCBfdXRpbC5pbmZvKShyZWFzb24pOwogICAgICAgIHJldHVybiBjYXRhbG9nLmdldFBhZ2VEaWN0KHBhZ2VJbmRleCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFBhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBhZ2UocGFnZUluZGV4KSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuX3BhZ2VQcm9taXNlc1twYWdlSW5kZXhdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpcy5fcGFnZVByb21pc2VzW3BhZ2VJbmRleF07CiAgICAgIH0KCiAgICAgIHZhciBjYXRhbG9nID0gdGhpcy5jYXRhbG9nLAogICAgICAgICAgbGluZWFyaXphdGlvbiA9IHRoaXMubGluZWFyaXphdGlvbjsKICAgICAgdmFyIHByb21pc2UgPSBsaW5lYXJpemF0aW9uICYmIGxpbmVhcml6YXRpb24ucGFnZUZpcnN0ID09PSBwYWdlSW5kZXggPyB0aGlzLl9nZXRMaW5lYXJpemF0aW9uUGFnZShwYWdlSW5kZXgpIDogY2F0YWxvZy5nZXRQYWdlRGljdChwYWdlSW5kZXgpOwogICAgICByZXR1cm4gdGhpcy5fcGFnZVByb21pc2VzW3BhZ2VJbmRleF0gPSBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKF9yZWYxMCkgewogICAgICAgIHZhciBfcmVmMTEgPSBfc2xpY2VkVG9BcnJheShfcmVmMTAsIDIpLAogICAgICAgICAgICBwYWdlRGljdCA9IF9yZWYxMVswXSwKICAgICAgICAgICAgcmVmID0gX3JlZjExWzFdOwoKICAgICAgICByZXR1cm4gbmV3IFBhZ2UoewogICAgICAgICAgcGRmTWFuYWdlcjogX3RoaXM1LnBkZk1hbmFnZXIsCiAgICAgICAgICB4cmVmOiBfdGhpczUueHJlZiwKICAgICAgICAgIHBhZ2VJbmRleDogcGFnZUluZGV4LAogICAgICAgICAgcGFnZURpY3Q6IHBhZ2VEaWN0LAogICAgICAgICAgcmVmOiByZWYsCiAgICAgICAgICBmb250Q2FjaGU6IGNhdGFsb2cuZm9udENhY2hlLAogICAgICAgICAgYnVpbHRJbkNNYXBDYWNoZTogY2F0YWxvZy5idWlsdEluQ01hcENhY2hlLAogICAgICAgICAgZ2xvYmFsSW1hZ2VDYWNoZTogY2F0YWxvZy5nbG9iYWxJbWFnZUNhY2hlLAogICAgICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5OiBfdGhpczUucGRmRnVuY3Rpb25GYWN0b3J5CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNoZWNrRmlyc3RQYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja0ZpcnN0UGFnZSgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICByZXR1cm4gdGhpcy5nZXRQYWdlKDApWyJjYXRjaCJdKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfcmVmMTIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZWFzb24pIHsKICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JbImRlZmF1bHQiXS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICBpZiAoIShyZWFzb24gaW5zdGFuY2VvZiBfY29yZV91dGlscy5YUmVmRW50cnlFeGNlcHRpb24pKSB7CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIF90aGlzNi5fcGFnZVByb21pc2VzLmxlbmd0aCA9IDA7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2LmNsZWFudXAoKTsKCiAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfY29yZV91dGlscy5YUmVmUGFyc2VFeGNlcHRpb24oKTsKCiAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgfSkpOwoKICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgICByZXR1cm4gX3JlZjEyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSgpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmb250RmFsbGJhY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZvbnRGYWxsYmFjayhpZCwgaGFuZGxlcikgewogICAgICByZXR1cm4gdGhpcy5jYXRhbG9nLmZvbnRGYWxsYmFjayhpZCwgaGFuZGxlcik7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xlYW51cCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2NsZWFudXAgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIG1hbnVhbGx5VHJpZ2dlcmVkLAogICAgICAgICAgICBfYXJnczIgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclsiZGVmYXVsdCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbWFudWFsbHlUcmlnZ2VyZWQgPSBfYXJnczIubGVuZ3RoID4gMCAmJiBfYXJnczJbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMlswXSA6IGZhbHNlOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHRoaXMuY2F0YWxvZyA/IHRoaXMuY2F0YWxvZy5jbGVhbnVwKG1hbnVhbGx5VHJpZ2dlcmVkKSA6ICgwLCBfcHJpbWl0aXZlcy5jbGVhclByaW1pdGl2ZUNhY2hlcykoKSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7CiAgICAgICAgcmV0dXJuIF9jbGVhbnVwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjbGVhbnVwOwogICAgfSgpCiAgfSwgewogICAga2V5OiAibGluZWFyaXphdGlvbiIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIGxpbmVhcml6YXRpb24gPSBudWxsOwoKICAgICAgdHJ5IHsKICAgICAgICBsaW5lYXJpemF0aW9uID0gX3BhcnNlci5MaW5lYXJpemF0aW9uLmNyZWF0ZSh0aGlzLnN0cmVhbSk7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLmluZm8pKGVycik7CiAgICAgIH0KCiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibGluZWFyaXphdGlvbiIsIGxpbmVhcml6YXRpb24pOwogICAgfQogIH0sIHsKICAgIGtleTogInN0YXJ0WFJlZiIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgICB2YXIgc3RhcnRYUmVmID0gMDsKCiAgICAgIGlmICh0aGlzLmxpbmVhcml6YXRpb24pIHsKICAgICAgICBzdHJlYW0ucmVzZXQoKTsKCiAgICAgICAgaWYgKGZpbmQoc3RyZWFtLCBFTkRPQkpfU0lHTkFUVVJFKSkgewogICAgICAgICAgc3RhcnRYUmVmID0gc3RyZWFtLnBvcyArIDYgLSBzdHJlYW0uc3RhcnQ7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBzdGVwID0gMTAyNDsKICAgICAgICB2YXIgc3RhcnRYUmVmTGVuZ3RoID0gU1RBUlRYUkVGX1NJR05BVFVSRS5sZW5ndGg7CiAgICAgICAgdmFyIGZvdW5kID0gZmFsc2UsCiAgICAgICAgICAgIHBvcyA9IHN0cmVhbS5lbmQ7CgogICAgICAgIHdoaWxlICghZm91bmQgJiYgcG9zID4gMCkgewogICAgICAgICAgcG9zIC09IHN0ZXAgLSBzdGFydFhSZWZMZW5ndGg7CgogICAgICAgICAgaWYgKHBvcyA8IDApIHsKICAgICAgICAgICAgcG9zID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHJlYW0ucG9zID0gcG9zOwogICAgICAgICAgZm91bmQgPSBmaW5kKHN0cmVhbSwgU1RBUlRYUkVGX1NJR05BVFVSRSwgc3RlcCwgdHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgIHN0cmVhbS5za2lwKDkpOwogICAgICAgICAgdmFyIGNoOwoKICAgICAgICAgIGRvIHsKICAgICAgICAgICAgY2ggPSBzdHJlYW0uZ2V0Qnl0ZSgpOwogICAgICAgICAgfSB3aGlsZSAoKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoY2gpKTsKCiAgICAgICAgICB2YXIgc3RyID0gIiI7CgogICAgICAgICAgd2hpbGUgKGNoID49IDB4MjAgJiYgY2ggPD0gMHgzOSkgewogICAgICAgICAgICBzdHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CiAgICAgICAgICAgIGNoID0gc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdGFydFhSZWYgPSBwYXJzZUludChzdHIsIDEwKTsKCiAgICAgICAgICBpZiAoaXNOYU4oc3RhcnRYUmVmKSkgewogICAgICAgICAgICBzdGFydFhSZWYgPSAwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJzdGFydFhSZWYiLCBzdGFydFhSZWYpOwogICAgfQogIH0sIHsKICAgIGtleTogIm51bVBhZ2VzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgbGluZWFyaXphdGlvbiA9IHRoaXMubGluZWFyaXphdGlvbjsKICAgICAgdmFyIG51bSA9IGxpbmVhcml6YXRpb24gPyBsaW5lYXJpemF0aW9uLm51bVBhZ2VzIDogdGhpcy5jYXRhbG9nLm51bVBhZ2VzOwogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm51bVBhZ2VzIiwgbnVtKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkb2N1bWVudEluZm8iLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBEb2N1bWVudEluZm9WYWxpZGF0b3JzID0gewogICAgICAgIFRpdGxlOiBfdXRpbC5pc1N0cmluZywKICAgICAgICBBdXRob3I6IF91dGlsLmlzU3RyaW5nLAogICAgICAgIFN1YmplY3Q6IF91dGlsLmlzU3RyaW5nLAogICAgICAgIEtleXdvcmRzOiBfdXRpbC5pc1N0cmluZywKICAgICAgICBDcmVhdG9yOiBfdXRpbC5pc1N0cmluZywKICAgICAgICBQcm9kdWNlcjogX3V0aWwuaXNTdHJpbmcsCiAgICAgICAgQ3JlYXRpb25EYXRlOiBfdXRpbC5pc1N0cmluZywKICAgICAgICBNb2REYXRlOiBfdXRpbC5pc1N0cmluZywKICAgICAgICBUcmFwcGVkOiBfcHJpbWl0aXZlcy5pc05hbWUKICAgICAgfTsKICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnBkZkZvcm1hdFZlcnNpb247CgogICAgICBpZiAodHlwZW9mIHZlcnNpb24gIT09ICJzdHJpbmciIHx8ICFQREZfSEVBREVSX1ZFUlNJT05fUkVHRVhQLnRlc3QodmVyc2lvbikpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgUERGIGhlYWRlciB2ZXJzaW9uIG51bWJlcjogIi5jb25jYXQodmVyc2lvbikpOwogICAgICAgIHZlcnNpb24gPSBudWxsOwogICAgICB9CgogICAgICB2YXIgZG9jSW5mbyA9IHsKICAgICAgICBQREZGb3JtYXRWZXJzaW9uOiB2ZXJzaW9uLAogICAgICAgIElzTGluZWFyaXplZDogISF0aGlzLmxpbmVhcml6YXRpb24sCiAgICAgICAgSXNBY3JvRm9ybVByZXNlbnQ6ICEhdGhpcy5hY3JvRm9ybSwKICAgICAgICBJc1hGQVByZXNlbnQ6ICEhdGhpcy54ZmEsCiAgICAgICAgSXNDb2xsZWN0aW9uUHJlc2VudDogISF0aGlzLmNvbGxlY3Rpb24KICAgICAgfTsKICAgICAgdmFyIGluZm9EaWN0OwoKICAgICAgdHJ5IHsKICAgICAgICBpbmZvRGljdCA9IHRoaXMueHJlZi50cmFpbGVyLmdldCgiSW5mbyIpOwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICAgIHRocm93IGVycjsKICAgICAgICB9CgogICAgICAgICgwLCBfdXRpbC5pbmZvKSgiVGhlIGRvY3VtZW50IGluZm9ybWF0aW9uIGRpY3Rpb25hcnkgaXMgaW52YWxpZC4iKTsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGluZm9EaWN0KSkgewogICAgICAgIHZhciBfaXRlcmF0b3I1ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoaW5mb0RpY3QuZ2V0S2V5cygpKSwKICAgICAgICAgICAgX3N0ZXA1OwoKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3I1LnMoKTsgIShfc3RlcDUgPSBfaXRlcmF0b3I1Lm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIGtleSA9IF9zdGVwNS52YWx1ZTsKICAgICAgICAgICAgdmFyIHZhbHVlID0gaW5mb0RpY3QuZ2V0KGtleSk7CgogICAgICAgICAgICBpZiAoRG9jdW1lbnRJbmZvVmFsaWRhdG9yc1trZXldKSB7CiAgICAgICAgICAgICAgaWYgKERvY3VtZW50SW5mb1ZhbGlkYXRvcnNba2V5XSh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIGRvY0luZm9ba2V5XSA9IHR5cGVvZiB2YWx1ZSAhPT0gInN0cmluZyIgPyB2YWx1ZSA6ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykodmFsdWUpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkJhZCB2YWx1ZSBpbiBkb2N1bWVudCBpbmZvIGZvciBcIiIuY29uY2F0KGtleSwgIlwiLiIpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGtleSA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICB2YXIgY3VzdG9tVmFsdWUgPSB2b2lkIDA7CgogICAgICAgICAgICAgIGlmICgoMCwgX3V0aWwuaXNTdHJpbmcpKHZhbHVlKSkgewogICAgICAgICAgICAgICAgY3VzdG9tVmFsdWUgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKHZhbHVlKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHZhbHVlKSB8fCAoMCwgX3V0aWwuaXNOdW0pKHZhbHVlKSB8fCAoMCwgX3V0aWwuaXNCb29sKSh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIGN1c3RvbVZhbHVlID0gdmFsdWU7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiVW5zdXBwb3J0ZWQgdmFsdWUgaW4gZG9jdW1lbnQgaW5mbyBmb3IgKGN1c3RvbSkgXCIiLmNvbmNhdChrZXksICJcIi4iKSk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICghZG9jSW5mby5DdXN0b20pIHsKICAgICAgICAgICAgICAgIGRvY0luZm8uQ3VzdG9tID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGRvY0luZm8uQ3VzdG9tW2tleV0gPSBjdXN0b21WYWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yNS5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvcjUuZigpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJkb2N1bWVudEluZm8iLCBkb2NJbmZvKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaW5nZXJwcmludCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIGhhc2g7CiAgICAgIHZhciBpZEFycmF5ID0gdGhpcy54cmVmLnRyYWlsZXIuZ2V0KCJJRCIpOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaWRBcnJheSkgJiYgaWRBcnJheVswXSAmJiAoMCwgX3V0aWwuaXNTdHJpbmcpKGlkQXJyYXlbMF0pICYmIGlkQXJyYXlbMF0gIT09IEVNUFRZX0ZJTkdFUlBSSU5UKSB7CiAgICAgICAgaGFzaCA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShpZEFycmF5WzBdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBoYXNoID0gKDAsIF9jcnlwdG8uY2FsY3VsYXRlTUQ1KSh0aGlzLnN0cmVhbS5nZXRCeXRlUmFuZ2UoMCwgRklOR0VSUFJJTlRfRklSU1RfQllURVMpLCAwLCBGSU5HRVJQUklOVF9GSVJTVF9CWVRFUyk7CiAgICAgIH0KCiAgICAgIHZhciBmaW5nZXJwcmludEJ1ZiA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gaGFzaC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgdmFyIGhleCA9IGhhc2hbaV0udG9TdHJpbmcoMTYpOwogICAgICAgIGZpbmdlcnByaW50QnVmLnB1c2goaGV4LnBhZFN0YXJ0KDIsICIwIikpOwogICAgICB9CgogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImZpbmdlcnByaW50IiwgZmluZ2VycHJpbnRCdWYuam9pbigiIikpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFBERkRvY3VtZW50Owp9KCk7CgpleHBvcnRzLlBERkRvY3VtZW50ID0gUERGRG9jdW1lbnQ7CgovKioqLyB9KSwKLyogMjAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRmlsZVNwZWMgPSBleHBvcnRzLlhSZWYgPSBleHBvcnRzLk9iamVjdExvYWRlciA9IGV4cG9ydHMuQ2F0YWxvZyA9IHZvaWQgMDsKCnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9fd19wZGZqc19yZXF1aXJlX18oMikpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDQpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpOwoKdmFyIF9jcnlwdG8gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxNSk7Cgp2YXIgX2NvbG9yc3BhY2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIxNik7Cgp2YXIgX2ltYWdlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTcpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgImRlZmF1bHQiOiBvYmogfTsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOyB0cnkgeyBEYXRlLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKFJlZmxlY3QuY29uc3RydWN0KERhdGUsIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAidW5kZWZpbmVkIiB8fCAhKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoYXJyKSkpIHJldHVybjsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkgeyB2YXIgaXQ7IGlmICh0eXBlb2YgU3ltYm9sID09PSAidW5kZWZpbmVkIiB8fCBvW1N5bWJvbC5pdGVyYXRvcl0gPT0gbnVsbCkgeyBpZiAoQXJyYXkuaXNBcnJheShvKSB8fCAoaXQgPSBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobykpIHx8IGFsbG93QXJyYXlMaWtlICYmIG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgeyBpZiAoaXQpIG8gPSBpdDsgdmFyIGkgPSAwOyB2YXIgRiA9IGZ1bmN0aW9uIEYoKSB7fTsgcmV0dXJuIHsgczogRiwgbjogZnVuY3Rpb24gbigpIHsgaWYgKGkgPj0gby5sZW5ndGgpIHJldHVybiB7IGRvbmU6IHRydWUgfTsgcmV0dXJuIHsgZG9uZTogZmFsc2UsIHZhbHVlOiBvW2krK10gfTsgfSwgZTogZnVuY3Rpb24gZShfZTIpIHsgdGhyb3cgX2UyOyB9LCBmOiBGIH07IH0gdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9IHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSwgZGlkRXJyID0gZmFsc2UsIGVycjsgcmV0dXJuIHsgczogZnVuY3Rpb24gcygpIHsgaXQgPSBvW1N5bWJvbC5pdGVyYXRvcl0oKTsgfSwgbjogZnVuY3Rpb24gbigpIHsgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7IG5vcm1hbENvbXBsZXRpb24gPSBzdGVwLmRvbmU7IHJldHVybiBzdGVwOyB9LCBlOiBmdW5jdGlvbiBlKF9lMykgeyBkaWRFcnIgPSB0cnVlOyBlcnIgPSBfZTM7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGlmICghbm9ybWFsQ29tcGxldGlvbiAmJiBpdFsicmV0dXJuIl0gIT0gbnVsbCkgaXRbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChkaWRFcnIpIHRocm93IGVycjsgfSB9IH07IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9CgpmdW5jdGlvbiBmZXRjaERlc3RpbmF0aW9uKGRlc3QpIHsKICByZXR1cm4gKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoZGVzdCkgPyBkZXN0LmdldCgiRCIpIDogZGVzdDsKfQoKdmFyIENhdGFsb2cgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENhdGFsb2cocGRmTWFuYWdlciwgeHJlZikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhdGFsb2cpOwoKICAgIHRoaXMucGRmTWFuYWdlciA9IHBkZk1hbmFnZXI7CiAgICB0aGlzLnhyZWYgPSB4cmVmOwogICAgdGhpcy5jYXREaWN0ID0geHJlZi5nZXRDYXRhbG9nT2JqKCk7CgogICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KSh0aGlzLmNhdERpY3QpKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQ2F0YWxvZyBvYmplY3QgaXMgbm90IGEgZGljdGlvbmFyeS4iKTsKICAgIH0KCiAgICB0aGlzLmZvbnRDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogICAgdGhpcy5idWlsdEluQ01hcENhY2hlID0gbmV3IE1hcCgpOwogICAgdGhpcy5nbG9iYWxJbWFnZUNhY2hlID0gbmV3IF9pbWFnZV91dGlscy5HbG9iYWxJbWFnZUNhY2hlKCk7CiAgICB0aGlzLnBhZ2VLaWRzQ291bnRDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKENhdGFsb2csIFt7CiAgICBrZXk6ICJfcmVhZERvY3VtZW50T3V0bGluZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlYWREb2N1bWVudE91dGxpbmUoKSB7CiAgICAgIHZhciBvYmogPSB0aGlzLmNhdERpY3QuZ2V0KCJPdXRsaW5lcyIpOwoKICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShvYmopKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIG9iaiA9IG9iai5nZXRSYXcoIkZpcnN0Iik7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc1JlZikob2JqKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgcm9vdCA9IHsKICAgICAgICBpdGVtczogW10KICAgICAgfTsKICAgICAgdmFyIHF1ZXVlID0gW3sKICAgICAgICBvYmo6IG9iaiwKICAgICAgICBwYXJlbnQ6IHJvb3QKICAgICAgfV07CiAgICAgIHZhciBwcm9jZXNzZWQgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0KCk7CiAgICAgIHByb2Nlc3NlZC5wdXQob2JqKTsKICAgICAgdmFyIHhyZWYgPSB0aGlzLnhyZWYsCiAgICAgICAgICBibGFja0NvbG9yID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KDMpOwoKICAgICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgaSA9IHF1ZXVlLnNoaWZ0KCk7CiAgICAgICAgdmFyIG91dGxpbmVEaWN0ID0geHJlZi5mZXRjaElmUmVmKGkub2JqKTsKCiAgICAgICAgaWYgKG91dGxpbmVEaWN0ID09PSBudWxsKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmICghb3V0bGluZURpY3QuaGFzKCJUaXRsZSIpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgb3V0bGluZSBpdGVtIGVuY291bnRlcmVkLiIpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgICB1cmw6IG51bGwsCiAgICAgICAgICBkZXN0OiBudWxsCiAgICAgICAgfTsKICAgICAgICBDYXRhbG9nLnBhcnNlRGVzdERpY3Rpb25hcnkoewogICAgICAgICAgZGVzdERpY3Q6IG91dGxpbmVEaWN0LAogICAgICAgICAgcmVzdWx0T2JqOiBkYXRhLAogICAgICAgICAgZG9jQmFzZVVybDogdGhpcy5wZGZNYW5hZ2VyLmRvY0Jhc2VVcmwKICAgICAgICB9KTsKICAgICAgICB2YXIgdGl0bGUgPSBvdXRsaW5lRGljdC5nZXQoIlRpdGxlIik7CiAgICAgICAgdmFyIGZsYWdzID0gb3V0bGluZURpY3QuZ2V0KCJGIikgfHwgMDsKICAgICAgICB2YXIgY29sb3IgPSBvdXRsaW5lRGljdC5nZXRBcnJheSgiQyIpOwogICAgICAgIHZhciBjb3VudCA9IG91dGxpbmVEaWN0LmdldCgiQ291bnQiKTsKICAgICAgICB2YXIgcmdiQ29sb3IgPSBibGFja0NvbG9yOwoKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2xvcikgJiYgY29sb3IubGVuZ3RoID09PSAzICYmIChjb2xvclswXSAhPT0gMCB8fCBjb2xvclsxXSAhPT0gMCB8fCBjb2xvclsyXSAhPT0gMCkpIHsKICAgICAgICAgIHJnYkNvbG9yID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLnJnYi5nZXRSZ2IoY29sb3IsIDApOwogICAgICAgIH0KCiAgICAgICAgdmFyIG91dGxpbmVJdGVtID0gewogICAgICAgICAgZGVzdDogZGF0YS5kZXN0LAogICAgICAgICAgdXJsOiBkYXRhLnVybCwKICAgICAgICAgIHVuc2FmZVVybDogZGF0YS51bnNhZmVVcmwsCiAgICAgICAgICBuZXdXaW5kb3c6IGRhdGEubmV3V2luZG93LAogICAgICAgICAgdGl0bGU6ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykodGl0bGUpLAogICAgICAgICAgY29sb3I6IHJnYkNvbG9yLAogICAgICAgICAgY291bnQ6IE51bWJlci5pc0ludGVnZXIoY291bnQpID8gY291bnQgOiB1bmRlZmluZWQsCiAgICAgICAgICBib2xkOiAhIShmbGFncyAmIDIpLAogICAgICAgICAgaXRhbGljOiAhIShmbGFncyAmIDEpLAogICAgICAgICAgaXRlbXM6IFtdCiAgICAgICAgfTsKICAgICAgICBpLnBhcmVudC5pdGVtcy5wdXNoKG91dGxpbmVJdGVtKTsKICAgICAgICBvYmogPSBvdXRsaW5lRGljdC5nZXRSYXcoIkZpcnN0Iik7CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNSZWYpKG9iaikgJiYgIXByb2Nlc3NlZC5oYXMob2JqKSkgewogICAgICAgICAgcXVldWUucHVzaCh7CiAgICAgICAgICAgIG9iajogb2JqLAogICAgICAgICAgICBwYXJlbnQ6IG91dGxpbmVJdGVtCiAgICAgICAgICB9KTsKICAgICAgICAgIHByb2Nlc3NlZC5wdXQob2JqKTsKICAgICAgICB9CgogICAgICAgIG9iaiA9IG91dGxpbmVEaWN0LmdldFJhdygiTmV4dCIpOwoKICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzUmVmKShvYmopICYmICFwcm9jZXNzZWQuaGFzKG9iaikpIHsKICAgICAgICAgIHF1ZXVlLnB1c2goewogICAgICAgICAgICBvYmo6IG9iaiwKICAgICAgICAgICAgcGFyZW50OiBpLnBhcmVudAogICAgICAgICAgfSk7CiAgICAgICAgICBwcm9jZXNzZWQucHV0KG9iaik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcm9vdC5pdGVtcy5sZW5ndGggPiAwID8gcm9vdC5pdGVtcyA6IG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3JlYWRQZXJtaXNzaW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlYWRQZXJtaXNzaW9ucygpIHsKICAgICAgdmFyIGVuY3J5cHQgPSB0aGlzLnhyZWYudHJhaWxlci5nZXQoIkVuY3J5cHQiKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoZW5jcnlwdCkpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIGZsYWdzID0gZW5jcnlwdC5nZXQoIlAiKTsKCiAgICAgIGlmICghKDAsIF91dGlsLmlzTnVtKShmbGFncykpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgZmxhZ3MgKz0gTWF0aC5wb3coMiwgMzIpOwogICAgICB2YXIgcGVybWlzc2lvbnMgPSBbXTsKCiAgICAgIGZvciAodmFyIGtleSBpbiBfdXRpbC5QZXJtaXNzaW9uRmxhZykgewogICAgICAgIHZhciB2YWx1ZSA9IF91dGlsLlBlcm1pc3Npb25GbGFnW2tleV07CgogICAgICAgIGlmIChmbGFncyAmIHZhbHVlKSB7CiAgICAgICAgICBwZXJtaXNzaW9ucy5wdXNoKHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBwZXJtaXNzaW9uczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREZXN0aW5hdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGVzdGluYXRpb24oZGVzdGluYXRpb25JZCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fcmVhZERlc3RzKCk7CgogICAgICBpZiAob2JqIGluc3RhbmNlb2YgTmFtZVRyZWUgfHwgb2JqIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkgewogICAgICAgIHJldHVybiBmZXRjaERlc3RpbmF0aW9uKG9iai5nZXQoZGVzdGluYXRpb25JZCkgfHwgbnVsbCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogIl9yZWFkRGVzdHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWFkRGVzdHMoKSB7CiAgICAgIHZhciBvYmogPSB0aGlzLmNhdERpY3QuZ2V0KCJOYW1lcyIpOwoKICAgICAgaWYgKG9iaiAmJiBvYmouaGFzKCJEZXN0cyIpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBOYW1lVHJlZShvYmouZ2V0UmF3KCJEZXN0cyIpLCB0aGlzLnhyZWYpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuY2F0RGljdC5oYXMoIkRlc3RzIikpIHsKICAgICAgICByZXR1cm4gdGhpcy5jYXREaWN0LmdldCgiRGVzdHMiKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcmVhZFBhZ2VMYWJlbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWFkUGFnZUxhYmVscygpIHsKICAgICAgdmFyIG9iaiA9IHRoaXMuY2F0RGljdC5nZXRSYXcoIlBhZ2VMYWJlbHMiKTsKCiAgICAgIGlmICghb2JqKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBwYWdlTGFiZWxzID0gbmV3IEFycmF5KHRoaXMubnVtUGFnZXMpOwogICAgICB2YXIgc3R5bGUgPSBudWxsLAogICAgICAgICAgcHJlZml4ID0gIiI7CiAgICAgIHZhciBudW1iZXJUcmVlID0gbmV3IE51bWJlclRyZWUob2JqLCB0aGlzLnhyZWYpOwogICAgICB2YXIgbnVtcyA9IG51bWJlclRyZWUuZ2V0QWxsKCk7CiAgICAgIHZhciBjdXJyZW50TGFiZWwgPSAiIiwKICAgICAgICAgIGN1cnJlbnRJbmRleCA9IDE7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLm51bVBhZ2VzOyBpIDwgaWk7IGkrKykgewogICAgICAgIGlmIChpIGluIG51bXMpIHsKICAgICAgICAgIHZhciBsYWJlbERpY3QgPSBudW1zW2ldOwoKICAgICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkobGFiZWxEaWN0KSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhZ2VMYWJlbCBpcyBub3QgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChsYWJlbERpY3QuaGFzKCJUeXBlIikgJiYgISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGxhYmVsRGljdC5nZXQoIlR5cGUiKSwgIlBhZ2VMYWJlbCIpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCB0eXBlIGluIFBhZ2VMYWJlbCBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChsYWJlbERpY3QuaGFzKCJTIikpIHsKICAgICAgICAgICAgdmFyIHMgPSBsYWJlbERpY3QuZ2V0KCJTIik7CgogICAgICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHMpKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIHN0eWxlIGluIFBhZ2VMYWJlbCBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzdHlsZSA9IHMubmFtZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0eWxlID0gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAobGFiZWxEaWN0LmhhcygiUCIpKSB7CiAgICAgICAgICAgIHZhciBwID0gbGFiZWxEaWN0LmdldCgiUCIpOwoKICAgICAgICAgICAgaWYgKCEoMCwgX3V0aWwuaXNTdHJpbmcpKHApKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIHByZWZpeCBpbiBQYWdlTGFiZWwgZGljdGlvbmFyeS4iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJlZml4ID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShwKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByZWZpeCA9ICIiOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChsYWJlbERpY3QuaGFzKCJTdCIpKSB7CiAgICAgICAgICAgIHZhciBzdCA9IGxhYmVsRGljdC5nZXQoIlN0Iik7CgogICAgICAgICAgICBpZiAoIShOdW1iZXIuaXNJbnRlZ2VyKHN0KSAmJiBzdCA+PSAxKSkgewogICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBzdGFydCBpbiBQYWdlTGFiZWwgZGljdGlvbmFyeS4iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY3VycmVudEluZGV4ID0gc3Q7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjdXJyZW50SW5kZXggPSAxOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgc3dpdGNoIChzdHlsZSkgewogICAgICAgICAgY2FzZSAiRCI6CiAgICAgICAgICAgIGN1cnJlbnRMYWJlbCA9IGN1cnJlbnRJbmRleDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiUiI6CiAgICAgICAgICBjYXNlICJyIjoKICAgICAgICAgICAgY3VycmVudExhYmVsID0gKDAsIF9jb3JlX3V0aWxzLnRvUm9tYW5OdW1lcmFscykoY3VycmVudEluZGV4LCBzdHlsZSA9PT0gInIiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiQSI6CiAgICAgICAgICBjYXNlICJhIjoKICAgICAgICAgICAgdmFyIExJTUlUID0gMjY7CiAgICAgICAgICAgIHZhciBBX1VQUEVSX0NBU0UgPSAweDQxLAogICAgICAgICAgICAgICAgQV9MT1dFUl9DQVNFID0gMHg2MTsKICAgICAgICAgICAgdmFyIGJhc2VDaGFyQ29kZSA9IHN0eWxlID09PSAiYSIgPyBBX0xPV0VSX0NBU0UgOiBBX1VQUEVSX0NBU0U7CiAgICAgICAgICAgIHZhciBsZXR0ZXJJbmRleCA9IGN1cnJlbnRJbmRleCAtIDE7CiAgICAgICAgICAgIHZhciBjaGFyYWN0ZXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJhc2VDaGFyQ29kZSArIGxldHRlckluZGV4ICUgTElNSVQpOwogICAgICAgICAgICB2YXIgY2hhckJ1ZiA9IFtdOwoKICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGpqID0gbGV0dGVySW5kZXggLyBMSU1JVCB8IDA7IGogPD0gamo7IGorKykgewogICAgICAgICAgICAgIGNoYXJCdWYucHVzaChjaGFyYWN0ZXIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjdXJyZW50TGFiZWwgPSBjaGFyQnVmLmpvaW4oIiIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBpZiAoc3R5bGUpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgc3R5bGUgXCIiLmNvbmNhdChzdHlsZSwgIlwiIGluIFBhZ2VMYWJlbCBkaWN0aW9uYXJ5LiIpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY3VycmVudExhYmVsID0gIiI7CiAgICAgICAgfQoKICAgICAgICBwYWdlTGFiZWxzW2ldID0gcHJlZml4ICsgY3VycmVudExhYmVsOwogICAgICAgIGN1cnJlbnRJbmRleCsrOwogICAgICB9CgogICAgICByZXR1cm4gcGFnZUxhYmVsczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmb250RmFsbGJhY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZvbnRGYWxsYmFjayhpZCwgaGFuZGxlcikgewogICAgICB2YXIgcHJvbWlzZXMgPSBbXTsKICAgICAgdGhpcy5mb250Q2FjaGUuZm9yRWFjaChmdW5jdGlvbiAocHJvbWlzZSkgewogICAgICAgIHByb21pc2VzLnB1c2gocHJvbWlzZSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKHRyYW5zbGF0ZWRGb250cykgewogICAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0cmFuc2xhdGVkRm9udHMpLAogICAgICAgICAgICBfc3RlcDsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciB0cmFuc2xhdGVkRm9udCA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgICAgaWYgKHRyYW5zbGF0ZWRGb250LmxvYWRlZE5hbWUgPT09IGlkKSB7CiAgICAgICAgICAgICAgdHJhbnNsYXRlZEZvbnQuZmFsbGJhY2soaGFuZGxlcik7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xlYW51cCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYW51cCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBtYW51YWxseVRyaWdnZXJlZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICAgICgwLCBfcHJpbWl0aXZlcy5jbGVhclByaW1pdGl2ZUNhY2hlcykoKTsKICAgICAgdGhpcy5nbG9iYWxJbWFnZUNhY2hlLmNsZWFyKG1hbnVhbGx5VHJpZ2dlcmVkKTsKICAgICAgdGhpcy5wYWdlS2lkc0NvdW50Q2FjaGUuY2xlYXIoKTsKICAgICAgdmFyIHByb21pc2VzID0gW107CiAgICAgIHRoaXMuZm9udENhY2hlLmZvckVhY2goZnVuY3Rpb24gKHByb21pc2UpIHsKICAgICAgICBwcm9taXNlcy5wdXNoKHByb21pc2UpOwogICAgICB9KTsKICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGVkRm9udHMpIHsKICAgICAgICB2YXIgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRyYW5zbGF0ZWRGb250cyksCiAgICAgICAgICAgIF9zdGVwMjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciBkaWN0ID0gX3N0ZXAyLnZhbHVlLmRpY3Q7CiAgICAgICAgICAgIGRlbGV0ZSBkaWN0LnRyYW5zbGF0ZWQ7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5mb250Q2FjaGUuY2xlYXIoKTsKCiAgICAgICAgX3RoaXMuYnVpbHRJbkNNYXBDYWNoZS5jbGVhcigpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQYWdlRGljdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UGFnZURpY3QocGFnZUluZGV4KSB7CiAgICAgIHZhciBjYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICB2YXIgbm9kZXNUb1Zpc2l0ID0gW3RoaXMuY2F0RGljdC5nZXRSYXcoIlBhZ2VzIildOwogICAgICB2YXIgdmlzaXRlZE5vZGVzID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgICB2YXIgeHJlZiA9IHRoaXMueHJlZiwKICAgICAgICAgIHBhZ2VLaWRzQ291bnRDYWNoZSA9IHRoaXMucGFnZUtpZHNDb3VudENhY2hlOwogICAgICB2YXIgY291bnQsCiAgICAgICAgICBjdXJyZW50UGFnZUluZGV4ID0gMDsKCiAgICAgIGZ1bmN0aW9uIG5leHQoKSB7CiAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7CiAgICAgICAgICB2YXIgY3VycmVudE5vZGUgPSBub2Rlc1RvVmlzaXQucG9wKCk7CgogICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc1JlZikoY3VycmVudE5vZGUpKSB7CiAgICAgICAgICAgIGNvdW50ID0gcGFnZUtpZHNDb3VudENhY2hlLmdldChjdXJyZW50Tm9kZSk7CgogICAgICAgICAgICBpZiAoY291bnQgPiAwICYmIGN1cnJlbnRQYWdlSW5kZXggKyBjb3VudCA8IHBhZ2VJbmRleCkgewogICAgICAgICAgICAgIGN1cnJlbnRQYWdlSW5kZXggKz0gY291bnQ7CiAgICAgICAgICAgICAgcmV0dXJuICJjb250aW51ZSI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh2aXNpdGVkTm9kZXMuaGFzKGN1cnJlbnROb2RlKSkgewogICAgICAgICAgICAgIGNhcGFiaWxpdHkucmVqZWN0KG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFnZXMgdHJlZSBjb250YWlucyBjaXJjdWxhciByZWZlcmVuY2UuIikpOwogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICB2OiB2b2lkIDAKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICB2aXNpdGVkTm9kZXMucHV0KGN1cnJlbnROb2RlKTsKICAgICAgICAgICAgeHJlZi5mZXRjaEFzeW5jKGN1cnJlbnROb2RlKS50aGVuKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkob2JqLCAiUGFnZSIpIHx8ICgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKG9iaikgJiYgIW9iai5oYXMoIktpZHMiKSkgewogICAgICAgICAgICAgICAgaWYgKHBhZ2VJbmRleCA9PT0gY3VycmVudFBhZ2VJbmRleCkgewogICAgICAgICAgICAgICAgICBpZiAoY3VycmVudE5vZGUgJiYgIXBhZ2VLaWRzQ291bnRDYWNoZS5oYXMoY3VycmVudE5vZGUpKSB7CiAgICAgICAgICAgICAgICAgICAgcGFnZUtpZHNDb3VudENhY2hlLnB1dChjdXJyZW50Tm9kZSwgMSk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGNhcGFiaWxpdHkucmVzb2x2ZShbb2JqLCBjdXJyZW50Tm9kZV0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgY3VycmVudFBhZ2VJbmRleCsrOwogICAgICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbm9kZXNUb1Zpc2l0LnB1c2gob2JqKTsKICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIH0sIGNhcGFiaWxpdHkucmVqZWN0KTsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICB2OiB2b2lkIDAKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGN1cnJlbnROb2RlKSkgewogICAgICAgICAgICBjYXBhYmlsaXR5LnJlamVjdChuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhZ2UgZGljdGlvbmFyeSBraWQgcmVmZXJlbmNlIHBvaW50cyB0byB3cm9uZyB0eXBlIG9mIG9iamVjdC4iKSk7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgdjogdm9pZCAwCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CgogICAgICAgICAgY291bnQgPSBjdXJyZW50Tm9kZS5nZXQoIkNvdW50Iik7CgogICAgICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIoY291bnQpICYmIGNvdW50ID49IDApIHsKICAgICAgICAgICAgdmFyIG9iaklkID0gY3VycmVudE5vZGUub2JqSWQ7CgogICAgICAgICAgICBpZiAob2JqSWQgJiYgIXBhZ2VLaWRzQ291bnRDYWNoZS5oYXMob2JqSWQpKSB7CiAgICAgICAgICAgICAgcGFnZUtpZHNDb3VudENhY2hlLnB1dChvYmpJZCwgY291bnQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY3VycmVudFBhZ2VJbmRleCArIGNvdW50IDw9IHBhZ2VJbmRleCkgewogICAgICAgICAgICAgIGN1cnJlbnRQYWdlSW5kZXggKz0gY291bnQ7CiAgICAgICAgICAgICAgcmV0dXJuICJjb250aW51ZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB2YXIga2lkcyA9IGN1cnJlbnROb2RlLmdldCgiS2lkcyIpOwoKICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShraWRzKSkgewogICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoY3VycmVudE5vZGUuZ2V0KCJUeXBlIiksICJQYWdlIikgfHwgIWN1cnJlbnROb2RlLmhhcygiVHlwZSIpICYmIGN1cnJlbnROb2RlLmhhcygiQ29udGVudHMiKSkgewogICAgICAgICAgICAgIGlmIChjdXJyZW50UGFnZUluZGV4ID09PSBwYWdlSW5kZXgpIHsKICAgICAgICAgICAgICAgIGNhcGFiaWxpdHkucmVzb2x2ZShbY3VycmVudE5vZGUsIG51bGxdKTsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgIHY6IHZvaWQgMAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGN1cnJlbnRQYWdlSW5kZXgrKzsKICAgICAgICAgICAgICByZXR1cm4gImNvbnRpbnVlIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2FwYWJpbGl0eS5yZWplY3QobmV3IF91dGlsLkZvcm1hdEVycm9yKCJQYWdlIGRpY3Rpb25hcnkga2lkcyBvYmplY3QgaXMgbm90IGFuIGFycmF5LiIpKTsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICB2OiB2b2lkIDAKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKHZhciBsYXN0ID0ga2lkcy5sZW5ndGggLSAxOyBsYXN0ID49IDA7IGxhc3QtLSkgewogICAgICAgICAgICBub2Rlc1RvVmlzaXQucHVzaChraWRzW2xhc3RdKTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB3aGlsZSAobm9kZXNUb1Zpc2l0Lmxlbmd0aCkgewogICAgICAgICAgdmFyIF9yZXQgPSBfbG9vcCgpOwoKICAgICAgICAgIHN3aXRjaCAoX3JldCkgewogICAgICAgICAgICBjYXNlICJjb250aW51ZSI6CiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIGlmIChfdHlwZW9mKF9yZXQpID09PSAib2JqZWN0IikgcmV0dXJuIF9yZXQudjsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNhcGFiaWxpdHkucmVqZWN0KG5ldyBFcnJvcigiUGFnZSBpbmRleCAiLmNvbmNhdChwYWdlSW5kZXgsICIgbm90IGZvdW5kLiIpKSk7CiAgICAgIH0KCiAgICAgIG5leHQoKTsKICAgICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQYWdlSW5kZXgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBhZ2VJbmRleChwYWdlUmVmKSB7CiAgICAgIHZhciB4cmVmID0gdGhpcy54cmVmOwoKICAgICAgZnVuY3Rpb24gcGFnZXNCZWZvcmVSZWYoa2lkUmVmKSB7CiAgICAgICAgdmFyIHRvdGFsID0gMCwKICAgICAgICAgICAgcGFyZW50UmVmOwogICAgICAgIHJldHVybiB4cmVmLmZldGNoQXN5bmMoa2lkUmVmKS50aGVuKGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzUmVmc0VxdWFsKShraWRSZWYsIHBhZ2VSZWYpICYmICEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShub2RlLCAiUGFnZSIpICYmICEoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkobm9kZSkgJiYgIW5vZGUuaGFzKCJUeXBlIikgJiYgbm9kZS5oYXMoIkNvbnRlbnRzIikpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVGhlIHJlZmVyZW5jZSBkb2VzIG5vdCBwb2ludCB0byBhIC9QYWdlIGRpY3Rpb25hcnkuIik7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFub2RlKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkobm9kZSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJOb2RlIG11c3QgYmUgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgfQoKICAgICAgICAgIHBhcmVudFJlZiA9IG5vZGUuZ2V0UmF3KCJQYXJlbnQiKTsKICAgICAgICAgIHJldHVybiBub2RlLmdldEFzeW5jKCJQYXJlbnQiKTsKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChwYXJlbnQpIHsKICAgICAgICAgIGlmICghcGFyZW50KSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkocGFyZW50KSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlBhcmVudCBtdXN0IGJlIGEgZGljdGlvbmFyeS4iKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcGFyZW50LmdldEFzeW5jKCJLaWRzIik7CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoa2lkcykgewogICAgICAgICAgaWYgKCFraWRzKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBraWRQcm9taXNlcyA9IFtdOwogICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7CgogICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0ga2lkcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgIHZhciBraWQgPSBraWRzW2ldOwoKICAgICAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNSZWYpKGtpZCkpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIktpZCBtdXN0IGJlIGEgcmVmZXJlbmNlLiIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzUmVmc0VxdWFsKShraWQsIGtpZFJlZikpIHsKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGtpZFByb21pc2VzLnB1c2goeHJlZi5mZXRjaEFzeW5jKGtpZCkudGhlbihmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShvYmopKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIktpZCBub2RlIG11c3QgYmUgYSBkaWN0aW9uYXJ5LiIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKG9iai5oYXMoIkNvdW50IikpIHsKICAgICAgICAgICAgICAgIHRvdGFsICs9IG9iai5nZXQoIkNvdW50Iik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRvdGFsKys7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIktpZCByZWZlcmVuY2Ugbm90IGZvdW5kIGluIHBhcmVudCdzIGtpZHMuIik7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGtpZFByb21pc2VzKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIFt0b3RhbCwgcGFyZW50UmVmXTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgdG90YWwgPSAwOwoKICAgICAgZnVuY3Rpb24gbmV4dChyZWYpIHsKICAgICAgICByZXR1cm4gcGFnZXNCZWZvcmVSZWYocmVmKS50aGVuKGZ1bmN0aW9uIChhcmdzKSB7CiAgICAgICAgICBpZiAoIWFyZ3MpIHsKICAgICAgICAgICAgcmV0dXJuIHRvdGFsOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBfYXJncyA9IF9zbGljZWRUb0FycmF5KGFyZ3MsIDIpLAogICAgICAgICAgICAgIGNvdW50ID0gX2FyZ3NbMF0sCiAgICAgICAgICAgICAgcGFyZW50UmVmID0gX2FyZ3NbMV07CgogICAgICAgICAgdG90YWwgKz0gY291bnQ7CiAgICAgICAgICByZXR1cm4gbmV4dChwYXJlbnRSZWYpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gbmV4dChwYWdlUmVmKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtZXRhZGF0YSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIHN0cmVhbVJlZiA9IHRoaXMuY2F0RGljdC5nZXRSYXcoIk1ldGFkYXRhIik7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc1JlZikoc3RyZWFtUmVmKSkgewogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAibWV0YWRhdGEiLCBudWxsKTsKICAgICAgfQoKICAgICAgdmFyIHN1cHByZXNzRW5jcnlwdGlvbiA9ICEodGhpcy54cmVmLmVuY3J5cHQgJiYgdGhpcy54cmVmLmVuY3J5cHQuZW5jcnlwdE1ldGFkYXRhKTsKICAgICAgdmFyIHN0cmVhbSA9IHRoaXMueHJlZi5mZXRjaChzdHJlYW1SZWYsIHN1cHByZXNzRW5jcnlwdGlvbik7CiAgICAgIHZhciBtZXRhZGF0YTsKCiAgICAgIGlmIChzdHJlYW0gJiYgKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoc3RyZWFtLmRpY3QpKSB7CiAgICAgICAgdmFyIHR5cGUgPSBzdHJlYW0uZGljdC5nZXQoIlR5cGUiKTsKICAgICAgICB2YXIgc3VidHlwZSA9IHN0cmVhbS5kaWN0LmdldCgiU3VidHlwZSIpOwoKICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodHlwZSwgIk1ldGFkYXRhIikgJiYgKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoc3VidHlwZSwgIlhNTCIpKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBtZXRhZGF0YSA9ICgwLCBfdXRpbC5zdHJpbmdUb1VURjhTdHJpbmcpKCgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShzdHJlYW0uZ2V0Qnl0ZXMoKSkpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJTa2lwcGluZyBpbnZhbGlkIG1ldGFkYXRhLiIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJtZXRhZGF0YSIsIG1ldGFkYXRhKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b3BsZXZlbFBhZ2VzRGljdCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIHBhZ2VzT2JqID0gdGhpcy5jYXREaWN0LmdldCgiUGFnZXMiKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkocGFnZXNPYmopKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIHRvcC1sZXZlbCBwYWdlcyBkaWN0aW9uYXJ5LiIpOwogICAgICB9CgogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInRvcGxldmVsUGFnZXNEaWN0IiwgcGFnZXNPYmopOwogICAgfQogIH0sIHsKICAgIGtleTogImRvY3VtZW50T3V0bGluZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG9iaiA9IG51bGw7CgogICAgICB0cnkgewogICAgICAgIG9iaiA9IHRoaXMuX3JlYWREb2N1bWVudE91dGxpbmUoKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuYWJsZSB0byByZWFkIGRvY3VtZW50IG91dGxpbmUuIik7CiAgICAgIH0KCiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiZG9jdW1lbnRPdXRsaW5lIiwgb2JqKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwZXJtaXNzaW9ucyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIHBlcm1pc3Npb25zID0gbnVsbDsKCiAgICAgIHRyeSB7CiAgICAgICAgcGVybWlzc2lvbnMgPSB0aGlzLl9yZWFkUGVybWlzc2lvbnMoKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuYWJsZSB0byByZWFkIHBlcm1pc3Npb25zLiIpOwogICAgICB9CgogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInBlcm1pc3Npb25zIiwgcGVybWlzc2lvbnMpOwogICAgfQogIH0sIHsKICAgIGtleTogIm51bVBhZ2VzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgb2JqID0gdGhpcy50b3BsZXZlbFBhZ2VzRGljdC5nZXQoIkNvdW50Iik7CgogICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIob2JqKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUGFnZSBjb3VudCBpbiB0b3AtbGV2ZWwgcGFnZXMgZGljdGlvbmFyeSBpcyBub3QgYW4gaW50ZWdlci4iKTsKICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJudW1QYWdlcyIsIG9iaik7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVzdGluYXRpb25zIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgb2JqID0gdGhpcy5fcmVhZERlc3RzKCksCiAgICAgICAgICBkZXN0cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICBpZiAob2JqIGluc3RhbmNlb2YgTmFtZVRyZWUpIHsKICAgICAgICB2YXIgbmFtZXMgPSBvYmouZ2V0QWxsKCk7CgogICAgICAgIGZvciAodmFyIG5hbWUgaW4gbmFtZXMpIHsKICAgICAgICAgIGRlc3RzW25hbWVdID0gZmV0Y2hEZXN0aW5hdGlvbihuYW1lc1tuYW1lXSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkRpY3QpIHsKICAgICAgICBvYmouZm9yRWFjaChmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgICAgIGRlc3RzW2tleV0gPSBmZXRjaERlc3RpbmF0aW9uKHZhbHVlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJkZXN0aW5hdGlvbnMiLCBkZXN0cyk7CiAgICB9CiAgfSwgewogICAga2V5OiAicGFnZUxhYmVscyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG9iaiA9IG51bGw7CgogICAgICB0cnkgewogICAgICAgIG9iaiA9IHRoaXMuX3JlYWRQYWdlTGFiZWxzKCk7CiAgICAgIH0gY2F0Y2ggKGV4KSB7CiAgICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICAgIHRocm93IGV4OwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmFibGUgdG8gcmVhZCBwYWdlIGxhYmVscy4iKTsKICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJwYWdlTGFiZWxzIiwgb2JqKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwYWdlTGF5b3V0IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgb2JqID0gdGhpcy5jYXREaWN0LmdldCgiUGFnZUxheW91dCIpOwogICAgICB2YXIgcGFnZUxheW91dCA9ICIiOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKG9iaikpIHsKICAgICAgICBzd2l0Y2ggKG9iai5uYW1lKSB7CiAgICAgICAgICBjYXNlICJTaW5nbGVQYWdlIjoKICAgICAgICAgIGNhc2UgIk9uZUNvbHVtbiI6CiAgICAgICAgICBjYXNlICJUd29Db2x1bW5MZWZ0IjoKICAgICAgICAgIGNhc2UgIlR3b0NvbHVtblJpZ2h0IjoKICAgICAgICAgIGNhc2UgIlR3b1BhZ2VMZWZ0IjoKICAgICAgICAgIGNhc2UgIlR3b1BhZ2VSaWdodCI6CiAgICAgICAgICAgIHBhZ2VMYXlvdXQgPSBvYmoubmFtZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicGFnZUxheW91dCIsIHBhZ2VMYXlvdXQpOwogICAgfQogIH0sIHsKICAgIGtleTogInBhZ2VNb2RlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgb2JqID0gdGhpcy5jYXREaWN0LmdldCgiUGFnZU1vZGUiKTsKICAgICAgdmFyIHBhZ2VNb2RlID0gIlVzZU5vbmUiOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKG9iaikpIHsKICAgICAgICBzd2l0Y2ggKG9iai5uYW1lKSB7CiAgICAgICAgICBjYXNlICJVc2VOb25lIjoKICAgICAgICAgIGNhc2UgIlVzZU91dGxpbmVzIjoKICAgICAgICAgIGNhc2UgIlVzZVRodW1icyI6CiAgICAgICAgICBjYXNlICJGdWxsU2NyZWVuIjoKICAgICAgICAgIGNhc2UgIlVzZU9DIjoKICAgICAgICAgIGNhc2UgIlVzZUF0dGFjaG1lbnRzIjoKICAgICAgICAgICAgcGFnZU1vZGUgPSBvYmoubmFtZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAicGFnZU1vZGUiLCBwYWdlTW9kZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidmlld2VyUHJlZmVyZW5jZXMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIFZpZXdlclByZWZlcmVuY2VzVmFsaWRhdG9ycyA9IHsKICAgICAgICBIaWRlVG9vbGJhcjogX3V0aWwuaXNCb29sLAogICAgICAgIEhpZGVNZW51YmFyOiBfdXRpbC5pc0Jvb2wsCiAgICAgICAgSGlkZVdpbmRvd1VJOiBfdXRpbC5pc0Jvb2wsCiAgICAgICAgRml0V2luZG93OiBfdXRpbC5pc0Jvb2wsCiAgICAgICAgQ2VudGVyV2luZG93OiBfdXRpbC5pc0Jvb2wsCiAgICAgICAgRGlzcGxheURvY1RpdGxlOiBfdXRpbC5pc0Jvb2wsCiAgICAgICAgTm9uRnVsbFNjcmVlblBhZ2VNb2RlOiBfcHJpbWl0aXZlcy5pc05hbWUsCiAgICAgICAgRGlyZWN0aW9uOiBfcHJpbWl0aXZlcy5pc05hbWUsCiAgICAgICAgVmlld0FyZWE6IF9wcmltaXRpdmVzLmlzTmFtZSwKICAgICAgICBWaWV3Q2xpcDogX3ByaW1pdGl2ZXMuaXNOYW1lLAogICAgICAgIFByaW50QXJlYTogX3ByaW1pdGl2ZXMuaXNOYW1lLAogICAgICAgIFByaW50Q2xpcDogX3ByaW1pdGl2ZXMuaXNOYW1lLAogICAgICAgIFByaW50U2NhbGluZzogX3ByaW1pdGl2ZXMuaXNOYW1lLAogICAgICAgIER1cGxleDogX3ByaW1pdGl2ZXMuaXNOYW1lLAogICAgICAgIFBpY2tUcmF5QnlQREZTaXplOiBfdXRpbC5pc0Jvb2wsCiAgICAgICAgUHJpbnRQYWdlUmFuZ2U6IEFycmF5LmlzQXJyYXksCiAgICAgICAgTnVtQ29waWVzOiBOdW1iZXIuaXNJbnRlZ2VyCiAgICAgIH07CiAgICAgIHZhciBvYmogPSB0aGlzLmNhdERpY3QuZ2V0KCJWaWV3ZXJQcmVmZXJlbmNlcyIpOwogICAgICB2YXIgcHJlZnMgPSBudWxsOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKG9iaikpIHsKICAgICAgICBmb3IgKHZhciBrZXkgaW4gVmlld2VyUHJlZmVyZW5jZXNWYWxpZGF0b3JzKSB7CiAgICAgICAgICBpZiAoIW9iai5oYXMoa2V5KSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgdmFsdWUgPSBvYmouZ2V0KGtleSk7CgogICAgICAgICAgaWYgKCFWaWV3ZXJQcmVmZXJlbmNlc1ZhbGlkYXRvcnNba2V5XSh2YWx1ZSkpIHsKICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJCYWQgdmFsdWUgaW4gVmlld2VyUHJlZmVyZW5jZXMgZm9yIFwiIi5jb25jYXQoa2V5LCAiXCIuIikpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgcHJlZlZhbHVlID0gdm9pZCAwOwoKICAgICAgICAgIHN3aXRjaCAoa2V5KSB7CiAgICAgICAgICAgIGNhc2UgIk5vbkZ1bGxTY3JlZW5QYWdlTW9kZSI6CiAgICAgICAgICAgICAgc3dpdGNoICh2YWx1ZS5uYW1lKSB7CiAgICAgICAgICAgICAgICBjYXNlICJVc2VOb25lIjoKICAgICAgICAgICAgICAgIGNhc2UgIlVzZU91dGxpbmVzIjoKICAgICAgICAgICAgICAgIGNhc2UgIlVzZVRodW1icyI6CiAgICAgICAgICAgICAgICBjYXNlICJVc2VPQyI6CiAgICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlLm5hbWU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9ICJVc2VOb25lIjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiRGlyZWN0aW9uIjoKICAgICAgICAgICAgICBzd2l0Y2ggKHZhbHVlLm5hbWUpIHsKICAgICAgICAgICAgICAgIGNhc2UgIkwyUiI6CiAgICAgICAgICAgICAgICBjYXNlICJSMkwiOgogICAgICAgICAgICAgICAgICBwcmVmVmFsdWUgPSB2YWx1ZS5uYW1lOwogICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICBwcmVmVmFsdWUgPSAiTDJSIjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiVmlld0FyZWEiOgogICAgICAgICAgICBjYXNlICJWaWV3Q2xpcCI6CiAgICAgICAgICAgIGNhc2UgIlByaW50QXJlYSI6CiAgICAgICAgICAgIGNhc2UgIlByaW50Q2xpcCI6CiAgICAgICAgICAgICAgc3dpdGNoICh2YWx1ZS5uYW1lKSB7CiAgICAgICAgICAgICAgICBjYXNlICJNZWRpYUJveCI6CiAgICAgICAgICAgICAgICBjYXNlICJDcm9wQm94IjoKICAgICAgICAgICAgICAgIGNhc2UgIkJsZWVkQm94IjoKICAgICAgICAgICAgICAgIGNhc2UgIlRyaW1Cb3giOgogICAgICAgICAgICAgICAgY2FzZSAiQXJ0Qm94IjoKICAgICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gdmFsdWUubmFtZTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gIkNyb3BCb3giOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICJQcmludFNjYWxpbmciOgogICAgICAgICAgICAgIHN3aXRjaCAodmFsdWUubmFtZSkgewogICAgICAgICAgICAgICAgY2FzZSAiTm9uZSI6CiAgICAgICAgICAgICAgICBjYXNlICJBcHBEZWZhdWx0IjoKICAgICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gdmFsdWUubmFtZTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgcHJlZlZhbHVlID0gIkFwcERlZmF1bHQiOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICJEdXBsZXgiOgogICAgICAgICAgICAgIHN3aXRjaCAodmFsdWUubmFtZSkgewogICAgICAgICAgICAgICAgY2FzZSAiU2ltcGxleCI6CiAgICAgICAgICAgICAgICBjYXNlICJEdXBsZXhGbGlwU2hvcnRFZGdlIjoKICAgICAgICAgICAgICAgIGNhc2UgIkR1cGxleEZsaXBMb25nRWRnZSI6CiAgICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlLm5hbWU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9ICJOb25lIjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiUHJpbnRQYWdlUmFuZ2UiOgogICAgICAgICAgICAgIHZhciBsZW5ndGggPSB2YWx1ZS5sZW5ndGg7CgogICAgICAgICAgICAgIGlmIChsZW5ndGggJSAyICE9PSAwKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBpc1ZhbGlkID0gdmFsdWUuZXZlcnkoZnVuY3Rpb24gKHBhZ2UsIGksIGFycikgewogICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlci5pc0ludGVnZXIocGFnZSkgJiYgcGFnZSA+IDAgJiYgKGkgPT09IDAgfHwgcGFnZSA+PSBhcnJbaSAtIDFdKSAmJiBwYWdlIDw9IF90aGlzMi5udW1QYWdlczsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgaWYgKGlzVmFsaWQpIHsKICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICJOdW1Db3BpZXMiOgogICAgICAgICAgICAgIGlmICh2YWx1ZSA+IDApIHsKICAgICAgICAgICAgICAgIHByZWZWYWx1ZSA9IHZhbHVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICJib29sZWFuIikgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ2aWV3ZXJQcmVmZXJlbmNlcyAtIGV4cGVjdGVkIGEgYm9vbGVhbiB2YWx1ZSBmb3I6ICIuY29uY2F0KGtleSkpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcHJlZlZhbHVlID0gdmFsdWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHByZWZWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGlmICghcHJlZnMpIHsKICAgICAgICAgICAgICBwcmVmcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByZWZzW2tleV0gPSBwcmVmVmFsdWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkJhZCB2YWx1ZSBpbiBWaWV3ZXJQcmVmZXJlbmNlcyBmb3IgXCIiLmNvbmNhdChrZXksICJcIi4iKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInZpZXdlclByZWZlcmVuY2VzIiwgcHJlZnMpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9wZW5BY3Rpb24iLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBvYmogPSB0aGlzLmNhdERpY3QuZ2V0KCJPcGVuQWN0aW9uIik7CiAgICAgIHZhciBvcGVuQWN0aW9uID0gbnVsbDsKCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShvYmopKSB7CiAgICAgICAgdmFyIGRlc3REaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QodGhpcy54cmVmKTsKICAgICAgICBkZXN0RGljdC5zZXQoIkEiLCBvYmopOwogICAgICAgIHZhciByZXN1bHRPYmogPSB7CiAgICAgICAgICB1cmw6IG51bGwsCiAgICAgICAgICBkZXN0OiBudWxsLAogICAgICAgICAgYWN0aW9uOiBudWxsCiAgICAgICAgfTsKICAgICAgICBDYXRhbG9nLnBhcnNlRGVzdERpY3Rpb25hcnkoewogICAgICAgICAgZGVzdERpY3Q6IGRlc3REaWN0LAogICAgICAgICAgcmVzdWx0T2JqOiByZXN1bHRPYmoKICAgICAgICB9KTsKCiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzdWx0T2JqLmRlc3QpKSB7CiAgICAgICAgICBpZiAoIW9wZW5BY3Rpb24pIHsKICAgICAgICAgICAgb3BlbkFjdGlvbiA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgb3BlbkFjdGlvbi5kZXN0ID0gcmVzdWx0T2JqLmRlc3Q7CiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHRPYmouYWN0aW9uKSB7CiAgICAgICAgICBpZiAoIW9wZW5BY3Rpb24pIHsKICAgICAgICAgICAgb3BlbkFjdGlvbiA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgb3BlbkFjdGlvbi5hY3Rpb24gPSByZXN1bHRPYmouYWN0aW9uOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG9iaikpIHsKICAgICAgICBpZiAoIW9wZW5BY3Rpb24pIHsKICAgICAgICAgIG9wZW5BY3Rpb24gPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgIH0KCiAgICAgICAgb3BlbkFjdGlvbi5kZXN0ID0gb2JqOwogICAgICB9CgogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIm9wZW5BY3Rpb24iLCBvcGVuQWN0aW9uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhdHRhY2htZW50cyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG9iaiA9IHRoaXMuY2F0RGljdC5nZXQoIk5hbWVzIik7CiAgICAgIHZhciBhdHRhY2htZW50cyA9IG51bGw7CgogICAgICBpZiAob2JqICYmIG9iai5oYXMoIkVtYmVkZGVkRmlsZXMiKSkgewogICAgICAgIHZhciBuYW1lVHJlZSA9IG5ldyBOYW1lVHJlZShvYmouZ2V0UmF3KCJFbWJlZGRlZEZpbGVzIiksIHRoaXMueHJlZik7CiAgICAgICAgdmFyIG5hbWVzID0gbmFtZVRyZWUuZ2V0QWxsKCk7CgogICAgICAgIGZvciAodmFyIG5hbWUgaW4gbmFtZXMpIHsKICAgICAgICAgIHZhciBmcyA9IG5ldyBGaWxlU3BlYyhuYW1lc1tuYW1lXSwgdGhpcy54cmVmKTsKCiAgICAgICAgICBpZiAoIWF0dGFjaG1lbnRzKSB7CiAgICAgICAgICAgIGF0dGFjaG1lbnRzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgICAgIH0KCiAgICAgICAgICBhdHRhY2htZW50c1soMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKG5hbWUpXSA9IGZzLnNlcmlhbGl6YWJsZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYXR0YWNobWVudHMiLCBhdHRhY2htZW50cyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiamF2YVNjcmlwdCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG9iaiA9IHRoaXMuY2F0RGljdC5nZXQoIk5hbWVzIik7CiAgICAgIHZhciBqYXZhU2NyaXB0ID0gbnVsbDsKCiAgICAgIGZ1bmN0aW9uIGFwcGVuZElmSmF2YVNjcmlwdERpY3QoanNEaWN0KSB7CiAgICAgICAgdmFyIHR5cGUgPSBqc0RpY3QuZ2V0KCJTIik7CgogICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodHlwZSwgIkphdmFTY3JpcHQiKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGpzID0ganNEaWN0LmdldCgiSlMiKTsKCiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkoanMpKSB7CiAgICAgICAgICBqcyA9ICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShqcy5nZXRCeXRlcygpKTsKICAgICAgICB9IGVsc2UgaWYgKCEoMCwgX3V0aWwuaXNTdHJpbmcpKGpzKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFqYXZhU2NyaXB0KSB7CiAgICAgICAgICBqYXZhU2NyaXB0ID0gW107CiAgICAgICAgfQoKICAgICAgICBqYXZhU2NyaXB0LnB1c2goKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShqcykpOwogICAgICB9CgogICAgICBpZiAob2JqICYmIG9iai5oYXMoIkphdmFTY3JpcHQiKSkgewogICAgICAgIHZhciBuYW1lVHJlZSA9IG5ldyBOYW1lVHJlZShvYmouZ2V0UmF3KCJKYXZhU2NyaXB0IiksIHRoaXMueHJlZik7CiAgICAgICAgdmFyIG5hbWVzID0gbmFtZVRyZWUuZ2V0QWxsKCk7CgogICAgICAgIGZvciAodmFyIG5hbWUgaW4gbmFtZXMpIHsKICAgICAgICAgIHZhciBqc0RpY3QgPSBuYW1lc1tuYW1lXTsKCiAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoanNEaWN0KSkgewogICAgICAgICAgICBhcHBlbmRJZkphdmFTY3JpcHREaWN0KGpzRGljdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgb3BlbkFjdGlvbiA9IHRoaXMuY2F0RGljdC5nZXQoIk9wZW5BY3Rpb24iKTsKCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShvcGVuQWN0aW9uKSAmJiAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShvcGVuQWN0aW9uLmdldCgiUyIpLCAiSmF2YVNjcmlwdCIpKSB7CiAgICAgICAgYXBwZW5kSWZKYXZhU2NyaXB0RGljdChvcGVuQWN0aW9uKTsKICAgICAgfQoKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJqYXZhU2NyaXB0IiwgamF2YVNjcmlwdCk7CiAgICB9CiAgfV0sIFt7CiAgICBrZXk6ICJwYXJzZURlc3REaWN0aW9uYXJ5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZURlc3REaWN0aW9uYXJ5KHBhcmFtcykgewogICAgICBmdW5jdGlvbiBhZGREZWZhdWx0UHJvdG9jb2xUb1VybCh1cmwpIHsKICAgICAgICByZXR1cm4gdXJsLnN0YXJ0c1dpdGgoInd3dy4iKSA/ICJodHRwOi8vIi5jb25jYXQodXJsKSA6IHVybDsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gdHJ5Q29udmVydFVybEVuY29kaW5nKHVybCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gKDAsIF91dGlsLnN0cmluZ1RvVVRGOFN0cmluZykodXJsKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICByZXR1cm4gdXJsOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGRlc3REaWN0ID0gcGFyYW1zLmRlc3REaWN0OwoKICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShkZXN0RGljdCkpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoInBhcnNlRGVzdERpY3Rpb25hcnk6IGBkZXN0RGljdGAgbXVzdCBiZSBhIGRpY3Rpb25hcnkuIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgcmVzdWx0T2JqID0gcGFyYW1zLnJlc3VsdE9iajsKCiAgICAgIGlmIChfdHlwZW9mKHJlc3VsdE9iaikgIT09ICJvYmplY3QiKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJwYXJzZURlc3REaWN0aW9uYXJ5OiBgcmVzdWx0T2JqYCBtdXN0IGJlIGFuIG9iamVjdC4iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBkb2NCYXNlVXJsID0gcGFyYW1zLmRvY0Jhc2VVcmwgfHwgbnVsbDsKICAgICAgdmFyIGFjdGlvbiA9IGRlc3REaWN0LmdldCgiQSIpLAogICAgICAgICAgdXJsLAogICAgICAgICAgZGVzdDsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoYWN0aW9uKSAmJiBkZXN0RGljdC5oYXMoIkRlc3QiKSkgewogICAgICAgIGFjdGlvbiA9IGRlc3REaWN0LmdldCgiRGVzdCIpOwogICAgICB9CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoYWN0aW9uKSkgewogICAgICAgIHZhciBhY3Rpb25UeXBlID0gYWN0aW9uLmdldCgiUyIpOwoKICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGFjdGlvblR5cGUpKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoInBhcnNlRGVzdERpY3Rpb25hcnk6IEludmFsaWQgdHlwZSBpbiBBY3Rpb24gZGljdGlvbmFyeS4iKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBhY3Rpb25OYW1lID0gYWN0aW9uVHlwZS5uYW1lOwoKICAgICAgICBzd2l0Y2ggKGFjdGlvbk5hbWUpIHsKICAgICAgICAgIGNhc2UgIlVSSSI6CiAgICAgICAgICAgIHVybCA9IGFjdGlvbi5nZXQoIlVSSSIpOwoKICAgICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHVybCkpIHsKICAgICAgICAgICAgICB1cmwgPSAiLyIgKyB1cmwubmFtZTsKICAgICAgICAgICAgfSBlbHNlIGlmICgoMCwgX3V0aWwuaXNTdHJpbmcpKHVybCkpIHsKICAgICAgICAgICAgICB1cmwgPSBhZGREZWZhdWx0UHJvdG9jb2xUb1VybCh1cmwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJHb1RvIjoKICAgICAgICAgICAgZGVzdCA9IGFjdGlvbi5nZXQoIkQiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiTGF1bmNoIjoKICAgICAgICAgIGNhc2UgIkdvVG9SIjoKICAgICAgICAgICAgdmFyIHVybERpY3QgPSBhY3Rpb24uZ2V0KCJGIik7CgogICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkodXJsRGljdCkpIHsKICAgICAgICAgICAgICB1cmwgPSB1cmxEaWN0LmdldCgiRiIpIHx8IG51bGw7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoKDAsIF91dGlsLmlzU3RyaW5nKSh1cmxEaWN0KSkgewogICAgICAgICAgICAgIHVybCA9IHVybERpY3Q7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciByZW1vdGVEZXN0ID0gYWN0aW9uLmdldCgiRCIpOwoKICAgICAgICAgICAgaWYgKHJlbW90ZURlc3QpIHsKICAgICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkocmVtb3RlRGVzdCkpIHsKICAgICAgICAgICAgICAgIHJlbW90ZURlc3QgPSByZW1vdGVEZXN0Lm5hbWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoKDAsIF91dGlsLmlzU3RyaW5nKSh1cmwpKSB7CiAgICAgICAgICAgICAgICB2YXIgYmFzZVVybCA9IHVybC5zcGxpdCgiIyIpWzBdOwoKICAgICAgICAgICAgICAgIGlmICgoMCwgX3V0aWwuaXNTdHJpbmcpKHJlbW90ZURlc3QpKSB7CiAgICAgICAgICAgICAgICAgIHVybCA9IGJhc2VVcmwgKyAiIyIgKyByZW1vdGVEZXN0OwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHJlbW90ZURlc3QpKSB7CiAgICAgICAgICAgICAgICAgIHVybCA9IGJhc2VVcmwgKyAiIyIgKyBKU09OLnN0cmluZ2lmeShyZW1vdGVEZXN0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBuZXdXaW5kb3cgPSBhY3Rpb24uZ2V0KCJOZXdXaW5kb3ciKTsKCiAgICAgICAgICAgIGlmICgoMCwgX3V0aWwuaXNCb29sKShuZXdXaW5kb3cpKSB7CiAgICAgICAgICAgICAgcmVzdWx0T2JqLm5ld1dpbmRvdyA9IG5ld1dpbmRvdzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiTmFtZWQiOgogICAgICAgICAgICB2YXIgbmFtZWRBY3Rpb24gPSBhY3Rpb24uZ2V0KCJOIik7CgogICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkobmFtZWRBY3Rpb24pKSB7CiAgICAgICAgICAgICAgcmVzdWx0T2JqLmFjdGlvbiA9IG5hbWVkQWN0aW9uLm5hbWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIkphdmFTY3JpcHQiOgogICAgICAgICAgICB2YXIganNBY3Rpb24gPSBhY3Rpb24uZ2V0KCJKUyIpOwogICAgICAgICAgICB2YXIganM7CgogICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzU3RyZWFtKShqc0FjdGlvbikpIHsKICAgICAgICAgICAgICBqcyA9ICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShqc0FjdGlvbi5nZXRCeXRlcygpKTsKICAgICAgICAgICAgfSBlbHNlIGlmICgoMCwgX3V0aWwuaXNTdHJpbmcpKGpzQWN0aW9uKSkgewogICAgICAgICAgICAgIGpzID0ganNBY3Rpb247CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChqcykgewogICAgICAgICAgICAgIHZhciBVUkxfT1BFTl9NRVRIT0RTID0gWyJhcHAubGF1bmNoVVJMIiwgIndpbmRvdy5vcGVuIl07CiAgICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCgiXlxccyooIiArIFVSTF9PUEVOX01FVEhPRFMuam9pbigifCIpLnNwbGl0KCIuIikuam9pbigiXFwuIikgKyAiKVxcKCg/Oid8XCIpKFteJ1wiXSopKD86J3xcIikoPzosXFxzKihcXHcrKVxcKXxcXCkpIiwgImkiKTsKICAgICAgICAgICAgICB2YXIganNVcmwgPSByZWdleC5leGVjKCgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoanMpKTsKCiAgICAgICAgICAgICAgaWYgKGpzVXJsICYmIGpzVXJsWzJdKSB7CiAgICAgICAgICAgICAgICB1cmwgPSBqc1VybFsyXTsKCiAgICAgICAgICAgICAgICBpZiAoanNVcmxbM10gPT09ICJ0cnVlIiAmJiBqc1VybFsxXSA9PT0gImFwcC5sYXVuY2hVUkwiKSB7CiAgICAgICAgICAgICAgICAgIHJlc3VsdE9iai5uZXdXaW5kb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgicGFyc2VEZXN0RGljdGlvbmFyeTogdW5zdXBwb3J0ZWQgYWN0aW9uIHR5cGUgXCIiLmNvbmNhdChhY3Rpb25OYW1lLCAiXCIuIikpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZGVzdERpY3QuaGFzKCJEZXN0IikpIHsKICAgICAgICBkZXN0ID0gZGVzdERpY3QuZ2V0KCJEZXN0Iik7CiAgICAgIH0KCiAgICAgIGlmICgoMCwgX3V0aWwuaXNTdHJpbmcpKHVybCkpIHsKICAgICAgICB1cmwgPSB0cnlDb252ZXJ0VXJsRW5jb2RpbmcodXJsKTsKICAgICAgICB2YXIgYWJzb2x1dGVVcmwgPSAoMCwgX3V0aWwuY3JlYXRlVmFsaWRBYnNvbHV0ZVVybCkodXJsLCBkb2NCYXNlVXJsKTsKCiAgICAgICAgaWYgKGFic29sdXRlVXJsKSB7CiAgICAgICAgICByZXN1bHRPYmoudXJsID0gYWJzb2x1dGVVcmwuaHJlZjsKICAgICAgICB9CgogICAgICAgIHJlc3VsdE9iai51bnNhZmVVcmwgPSB1cmw7CiAgICAgIH0KCiAgICAgIGlmIChkZXN0KSB7CiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGRlc3QpKSB7CiAgICAgICAgICBkZXN0ID0gZGVzdC5uYW1lOwogICAgICAgIH0KCiAgICAgICAgaWYgKCgwLCBfdXRpbC5pc1N0cmluZykoZGVzdCkgfHwgQXJyYXkuaXNBcnJheShkZXN0KSkgewogICAgICAgICAgcmVzdWx0T2JqLmRlc3QgPSBkZXN0OwogICAgICAgIH0KICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIENhdGFsb2c7Cn0oKTsKCmV4cG9ydHMuQ2F0YWxvZyA9IENhdGFsb2c7Cgp2YXIgWFJlZiA9IGZ1bmN0aW9uIFhSZWZDbG9zdXJlKCkgewogIGZ1bmN0aW9uIFhSZWYoc3RyZWFtLCBwZGZNYW5hZ2VyKSB7CiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMucGRmTWFuYWdlciA9IHBkZk1hbmFnZXI7CiAgICB0aGlzLmVudHJpZXMgPSBbXTsKICAgIHRoaXMueHJlZnN0bXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5fY2FjaGVNYXAgPSBuZXcgTWFwKCk7CiAgICB0aGlzLnN0YXRzID0gewogICAgICBzdHJlYW1UeXBlczogT2JqZWN0LmNyZWF0ZShudWxsKSwKICAgICAgZm9udFR5cGVzOiBPYmplY3QuY3JlYXRlKG51bGwpCiAgICB9OwogIH0KCiAgWFJlZi5wcm90b3R5cGUgPSB7CiAgICBzZXRTdGFydFhSZWY6IGZ1bmN0aW9uIFhSZWZfc2V0U3RhcnRYUmVmKHN0YXJ0WFJlZikgewogICAgICB0aGlzLnN0YXJ0WFJlZlF1ZXVlID0gW3N0YXJ0WFJlZl07CiAgICB9LAogICAgcGFyc2U6IGZ1bmN0aW9uIFhSZWZfcGFyc2UocmVjb3ZlcnlNb2RlKSB7CiAgICAgIHZhciB0cmFpbGVyRGljdDsKCiAgICAgIGlmICghcmVjb3ZlcnlNb2RlKSB7CiAgICAgICAgdHJhaWxlckRpY3QgPSB0aGlzLnJlYWRYUmVmKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJJbmRleGluZyBhbGwgUERGIG9iamVjdHMiKTsKICAgICAgICB0cmFpbGVyRGljdCA9IHRoaXMuaW5kZXhPYmplY3RzKCk7CiAgICAgIH0KCiAgICAgIHRyYWlsZXJEaWN0LmFzc2lnblhyZWYodGhpcyk7CiAgICAgIHRoaXMudHJhaWxlciA9IHRyYWlsZXJEaWN0OwogICAgICB2YXIgZW5jcnlwdDsKCiAgICAgIHRyeSB7CiAgICAgICAgZW5jcnlwdCA9IHRyYWlsZXJEaWN0LmdldCgiRW5jcnlwdCIpOwogICAgICB9IGNhdGNoIChleCkgewogICAgICAgIGlmIChleCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICB0aHJvdyBleDsKICAgICAgICB9CgogICAgICAgICgwLCBfdXRpbC53YXJuKSgiWFJlZi5wYXJzZSAtIEludmFsaWQgXCJFbmNyeXB0XCIgcmVmZXJlbmNlOiBcIiIuY29uY2F0KGV4LCAiXCIuIikpOwogICAgICB9CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoZW5jcnlwdCkpIHsKICAgICAgICB2YXIgaWRzID0gdHJhaWxlckRpY3QuZ2V0KCJJRCIpOwogICAgICAgIHZhciBmaWxlSWQgPSBpZHMgJiYgaWRzLmxlbmd0aCA/IGlkc1swXSA6ICIiOwogICAgICAgIGVuY3J5cHQuc3VwcHJlc3NFbmNyeXB0aW9uID0gdHJ1ZTsKICAgICAgICB0aGlzLmVuY3J5cHQgPSBuZXcgX2NyeXB0by5DaXBoZXJUcmFuc2Zvcm1GYWN0b3J5KGVuY3J5cHQsIGZpbGVJZCwgdGhpcy5wZGZNYW5hZ2VyLnBhc3N3b3JkKTsKICAgICAgfQoKICAgICAgdmFyIHJvb3Q7CgogICAgICB0cnkgewogICAgICAgIHJvb3QgPSB0cmFpbGVyRGljdC5nZXQoIlJvb3QiKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoIlhSZWYucGFyc2UgLSBJbnZhbGlkIFwiUm9vdFwiIHJlZmVyZW5jZTogXCIiLmNvbmNhdChleCwgIlwiLiIpKTsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKHJvb3QpICYmIHJvb3QuaGFzKCJQYWdlcyIpKSB7CiAgICAgICAgdGhpcy5yb290ID0gcm9vdDsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIXJlY292ZXJ5TW9kZSkgewogICAgICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZQYXJzZUV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIHJvb3QgcmVmZXJlbmNlIik7CiAgICAgIH0KICAgIH0sCiAgICBwcm9jZXNzWFJlZlRhYmxlOiBmdW5jdGlvbiBYUmVmX3Byb2Nlc3NYUmVmVGFibGUocGFyc2VyKSB7CiAgICAgIGlmICghKCJ0YWJsZVN0YXRlIiBpbiB0aGlzKSkgewogICAgICAgIHRoaXMudGFibGVTdGF0ZSA9IHsKICAgICAgICAgIGVudHJ5TnVtOiAwLAogICAgICAgICAgc3RyZWFtUG9zOiBwYXJzZXIubGV4ZXIuc3RyZWFtLnBvcywKICAgICAgICAgIHBhcnNlckJ1ZjE6IHBhcnNlci5idWYxLAogICAgICAgICAgcGFyc2VyQnVmMjogcGFyc2VyLmJ1ZjIKICAgICAgICB9OwogICAgICB9CgogICAgICB2YXIgb2JqID0gdGhpcy5yZWFkWFJlZlRhYmxlKHBhcnNlcik7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAidHJhaWxlciIpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFhSZWYgdGFibGU6IGNvdWxkIG5vdCBmaW5kIHRyYWlsZXIgZGljdGlvbmFyeSIpOwogICAgICB9CgogICAgICB2YXIgZGljdCA9IHBhcnNlci5nZXRPYmooKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoZGljdCkgJiYgZGljdC5kaWN0KSB7CiAgICAgICAgZGljdCA9IGRpY3QuZGljdDsKICAgICAgfQoKICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShkaWN0KSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBYUmVmIHRhYmxlOiBjb3VsZCBub3QgcGFyc2UgdHJhaWxlciBkaWN0aW9uYXJ5Iik7CiAgICAgIH0KCiAgICAgIGRlbGV0ZSB0aGlzLnRhYmxlU3RhdGU7CiAgICAgIHJldHVybiBkaWN0OwogICAgfSwKICAgIHJlYWRYUmVmVGFibGU6IGZ1bmN0aW9uIFhSZWZfcmVhZFhSZWZUYWJsZShwYXJzZXIpIHsKICAgICAgdmFyIHN0cmVhbSA9IHBhcnNlci5sZXhlci5zdHJlYW07CiAgICAgIHZhciB0YWJsZVN0YXRlID0gdGhpcy50YWJsZVN0YXRlOwogICAgICBzdHJlYW0ucG9zID0gdGFibGVTdGF0ZS5zdHJlYW1Qb3M7CiAgICAgIHBhcnNlci5idWYxID0gdGFibGVTdGF0ZS5wYXJzZXJCdWYxOwogICAgICBwYXJzZXIuYnVmMiA9IHRhYmxlU3RhdGUucGFyc2VyQnVmMjsKICAgICAgdmFyIG9iajsKCiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgaWYgKCEoImZpcnN0RW50cnlOdW0iIGluIHRhYmxlU3RhdGUpIHx8ICEoImVudHJ5Q291bnQiIGluIHRhYmxlU3RhdGUpKSB7CiAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmogPSBwYXJzZXIuZ2V0T2JqKCksICJ0cmFpbGVyIikpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGFibGVTdGF0ZS5maXJzdEVudHJ5TnVtID0gb2JqOwogICAgICAgICAgdGFibGVTdGF0ZS5lbnRyeUNvdW50ID0gcGFyc2VyLmdldE9iaigpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGZpcnN0ID0gdGFibGVTdGF0ZS5maXJzdEVudHJ5TnVtOwogICAgICAgIHZhciBjb3VudCA9IHRhYmxlU3RhdGUuZW50cnlDb3VudDsKCiAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGZpcnN0KSB8fCAhTnVtYmVyLmlzSW50ZWdlcihjb3VudCkpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBYUmVmIHRhYmxlOiB3cm9uZyB0eXBlcyBpbiBzdWJzZWN0aW9uIGhlYWRlciIpOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgaSA9IHRhYmxlU3RhdGUuZW50cnlOdW07IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgICB0YWJsZVN0YXRlLnN0cmVhbVBvcyA9IHN0cmVhbS5wb3M7CiAgICAgICAgICB0YWJsZVN0YXRlLmVudHJ5TnVtID0gaTsKICAgICAgICAgIHRhYmxlU3RhdGUucGFyc2VyQnVmMSA9IHBhcnNlci5idWYxOwogICAgICAgICAgdGFibGVTdGF0ZS5wYXJzZXJCdWYyID0gcGFyc2VyLmJ1ZjI7CiAgICAgICAgICB2YXIgZW50cnkgPSB7fTsKICAgICAgICAgIGVudHJ5Lm9mZnNldCA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgICAgIGVudHJ5LmdlbiA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgICAgIHZhciB0eXBlID0gcGFyc2VyLmdldE9iaigpOwoKICAgICAgICAgIGlmICh0eXBlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuQ21kKSB7CiAgICAgICAgICAgIHN3aXRjaCAodHlwZS5jbWQpIHsKICAgICAgICAgICAgICBjYXNlICJmIjoKICAgICAgICAgICAgICAgIGVudHJ5LmZyZWUgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgIm4iOgogICAgICAgICAgICAgICAgZW50cnkudW5jb21wcmVzc2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGVudHJ5Lm9mZnNldCkgfHwgIU51bWJlci5pc0ludGVnZXIoZW50cnkuZ2VuKSB8fCAhKGVudHJ5LmZyZWUgfHwgZW50cnkudW5jb21wcmVzc2VkKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgZW50cnkgaW4gWFJlZiBzdWJzZWN0aW9uOiAiLmNvbmNhdChmaXJzdCwgIiwgIikuY29uY2F0KGNvdW50KSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGkgPT09IDAgJiYgZW50cnkuZnJlZSAmJiBmaXJzdCA9PT0gMSkgewogICAgICAgICAgICBmaXJzdCA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCF0aGlzLmVudHJpZXNbaSArIGZpcnN0XSkgewogICAgICAgICAgICB0aGlzLmVudHJpZXNbaSArIGZpcnN0XSA9IGVudHJ5OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGFibGVTdGF0ZS5lbnRyeU51bSA9IDA7CiAgICAgICAgdGFibGVTdGF0ZS5zdHJlYW1Qb3MgPSBzdHJlYW0ucG9zOwogICAgICAgIHRhYmxlU3RhdGUucGFyc2VyQnVmMSA9IHBhcnNlci5idWYxOwogICAgICAgIHRhYmxlU3RhdGUucGFyc2VyQnVmMiA9IHBhcnNlci5idWYyOwogICAgICAgIGRlbGV0ZSB0YWJsZVN0YXRlLmZpcnN0RW50cnlOdW07CiAgICAgICAgZGVsZXRlIHRhYmxlU3RhdGUuZW50cnlDb3VudDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZW50cmllc1swXSAmJiAhdGhpcy5lbnRyaWVzWzBdLmZyZWUpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiB0YWJsZTogdW5leHBlY3RlZCBmaXJzdCBvYmplY3QiKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG9iajsKICAgIH0sCiAgICBwcm9jZXNzWFJlZlN0cmVhbTogZnVuY3Rpb24gWFJlZl9wcm9jZXNzWFJlZlN0cmVhbShzdHJlYW0pIHsKICAgICAgaWYgKCEoInN0cmVhbVN0YXRlIiBpbiB0aGlzKSkgewogICAgICAgIHZhciBzdHJlYW1QYXJhbWV0ZXJzID0gc3RyZWFtLmRpY3Q7CiAgICAgICAgdmFyIGJ5dGVXaWR0aHMgPSBzdHJlYW1QYXJhbWV0ZXJzLmdldCgiVyIpOwogICAgICAgIHZhciByYW5nZSA9IHN0cmVhbVBhcmFtZXRlcnMuZ2V0KCJJbmRleCIpOwoKICAgICAgICBpZiAoIXJhbmdlKSB7CiAgICAgICAgICByYW5nZSA9IFswLCBzdHJlYW1QYXJhbWV0ZXJzLmdldCgiU2l6ZSIpXTsKICAgICAgICB9CgogICAgICAgIHRoaXMuc3RyZWFtU3RhdGUgPSB7CiAgICAgICAgICBlbnRyeVJhbmdlczogcmFuZ2UsCiAgICAgICAgICBieXRlV2lkdGhzOiBieXRlV2lkdGhzLAogICAgICAgICAgZW50cnlOdW06IDAsCiAgICAgICAgICBzdHJlYW1Qb3M6IHN0cmVhbS5wb3MKICAgICAgICB9OwogICAgICB9CgogICAgICB0aGlzLnJlYWRYUmVmU3RyZWFtKHN0cmVhbSk7CiAgICAgIGRlbGV0ZSB0aGlzLnN0cmVhbVN0YXRlOwogICAgICByZXR1cm4gc3RyZWFtLmRpY3Q7CiAgICB9LAogICAgcmVhZFhSZWZTdHJlYW06IGZ1bmN0aW9uIFhSZWZfcmVhZFhSZWZTdHJlYW0oc3RyZWFtKSB7CiAgICAgIHZhciBpLCBqOwogICAgICB2YXIgc3RyZWFtU3RhdGUgPSB0aGlzLnN0cmVhbVN0YXRlOwogICAgICBzdHJlYW0ucG9zID0gc3RyZWFtU3RhdGUuc3RyZWFtUG9zOwogICAgICB2YXIgYnl0ZVdpZHRocyA9IHN0cmVhbVN0YXRlLmJ5dGVXaWR0aHM7CiAgICAgIHZhciB0eXBlRmllbGRXaWR0aCA9IGJ5dGVXaWR0aHNbMF07CiAgICAgIHZhciBvZmZzZXRGaWVsZFdpZHRoID0gYnl0ZVdpZHRoc1sxXTsKICAgICAgdmFyIGdlbmVyYXRpb25GaWVsZFdpZHRoID0gYnl0ZVdpZHRoc1syXTsKICAgICAgdmFyIGVudHJ5UmFuZ2VzID0gc3RyZWFtU3RhdGUuZW50cnlSYW5nZXM7CgogICAgICB3aGlsZSAoZW50cnlSYW5nZXMubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBmaXJzdCA9IGVudHJ5UmFuZ2VzWzBdOwogICAgICAgIHZhciBuID0gZW50cnlSYW5nZXNbMV07CgogICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihmaXJzdCkgfHwgIU51bWJlci5pc0ludGVnZXIobikpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBYUmVmIHJhbmdlIGZpZWxkczogIi5jb25jYXQoZmlyc3QsICIsICIpLmNvbmNhdChuKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIodHlwZUZpZWxkV2lkdGgpIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKG9mZnNldEZpZWxkV2lkdGgpIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKGdlbmVyYXRpb25GaWVsZFdpZHRoKSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFhSZWYgZW50cnkgZmllbGRzIGxlbmd0aDogIi5jb25jYXQoZmlyc3QsICIsICIpLmNvbmNhdChuKSk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGkgPSBzdHJlYW1TdGF0ZS5lbnRyeU51bTsgaSA8IG47ICsraSkgewogICAgICAgICAgc3RyZWFtU3RhdGUuZW50cnlOdW0gPSBpOwogICAgICAgICAgc3RyZWFtU3RhdGUuc3RyZWFtUG9zID0gc3RyZWFtLnBvczsKICAgICAgICAgIHZhciB0eXBlID0gMCwKICAgICAgICAgICAgICBvZmZzZXQgPSAwLAogICAgICAgICAgICAgIGdlbmVyYXRpb24gPSAwOwoKICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB0eXBlRmllbGRXaWR0aDsgKytqKSB7CiAgICAgICAgICAgIHR5cGUgPSB0eXBlIDw8IDggfCBzdHJlYW0uZ2V0Qnl0ZSgpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0eXBlRmllbGRXaWR0aCA9PT0gMCkgewogICAgICAgICAgICB0eXBlID0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgb2Zmc2V0RmllbGRXaWR0aDsgKytqKSB7CiAgICAgICAgICAgIG9mZnNldCA9IG9mZnNldCA8PCA4IHwgc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgZ2VuZXJhdGlvbkZpZWxkV2lkdGg7ICsraikgewogICAgICAgICAgICBnZW5lcmF0aW9uID0gZ2VuZXJhdGlvbiA8PCA4IHwgc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZW50cnkgPSB7fTsKICAgICAgICAgIGVudHJ5Lm9mZnNldCA9IG9mZnNldDsKICAgICAgICAgIGVudHJ5LmdlbiA9IGdlbmVyYXRpb247CgogICAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBlbnRyeS5mcmVlID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICBlbnRyeS51bmNvbXByZXNzZWQgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiBlbnRyeSB0eXBlOiAiLmNvbmNhdCh0eXBlKSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCF0aGlzLmVudHJpZXNbZmlyc3QgKyBpXSkgewogICAgICAgICAgICB0aGlzLmVudHJpZXNbZmlyc3QgKyBpXSA9IGVudHJ5OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgc3RyZWFtU3RhdGUuZW50cnlOdW0gPSAwOwogICAgICAgIHN0cmVhbVN0YXRlLnN0cmVhbVBvcyA9IHN0cmVhbS5wb3M7CiAgICAgICAgZW50cnlSYW5nZXMuc3BsaWNlKDAsIDIpOwogICAgICB9CiAgICB9LAogICAgaW5kZXhPYmplY3RzOiBmdW5jdGlvbiBYUmVmX2luZGV4T2JqZWN0cygpIHsKICAgICAgdmFyIFRBQiA9IDB4OSwKICAgICAgICAgIExGID0gMHhhLAogICAgICAgICAgQ1IgPSAweGQsCiAgICAgICAgICBTUEFDRSA9IDB4MjA7CiAgICAgIHZhciBQRVJDRU5UID0gMHgyNSwKICAgICAgICAgIExUID0gMHgzYzsKCiAgICAgIGZ1bmN0aW9uIHJlYWRUb2tlbihkYXRhLCBvZmZzZXQpIHsKICAgICAgICB2YXIgdG9rZW4gPSAiIiwKICAgICAgICAgICAgY2ggPSBkYXRhW29mZnNldF07CgogICAgICAgIHdoaWxlIChjaCAhPT0gTEYgJiYgY2ggIT09IENSICYmIGNoICE9PSBMVCkgewogICAgICAgICAgaWYgKCsrb2Zmc2V0ID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIHRva2VuICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpOwogICAgICAgICAgY2ggPSBkYXRhW29mZnNldF07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdG9rZW47CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNraXBVbnRpbChkYXRhLCBvZmZzZXQsIHdoYXQpIHsKICAgICAgICB2YXIgbGVuZ3RoID0gd2hhdC5sZW5ndGgsCiAgICAgICAgICAgIGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aDsKICAgICAgICB2YXIgc2tpcHBlZCA9IDA7CgogICAgICAgIHdoaWxlIChvZmZzZXQgPCBkYXRhTGVuZ3RoKSB7CiAgICAgICAgICB2YXIgaSA9IDA7CgogICAgICAgICAgd2hpbGUgKGkgPCBsZW5ndGggJiYgZGF0YVtvZmZzZXQgKyBpXSA9PT0gd2hhdFtpXSkgewogICAgICAgICAgICArK2k7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGkgPj0gbGVuZ3RoKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIG9mZnNldCsrOwogICAgICAgICAgc2tpcHBlZCsrOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHNraXBwZWQ7CiAgICAgIH0KCiAgICAgIHZhciBvYmpSZWdFeHAgPSAvXihcZCspXHMrKFxkKylccytvYmpcYi87CiAgICAgIHZhciBlbmRvYmpSZWdFeHAgPSAvXGJlbmRvYmpbXGJcc10kLzsKICAgICAgdmFyIG5lc3RlZE9ialJlZ0V4cCA9IC9ccysoXGQrXHMrXGQrXHMrb2JqW1xiXHM8XSkkLzsKICAgICAgdmFyIENIRUNLX0NPTlRFTlRfTEVOR1RIID0gMjU7CiAgICAgIHZhciB0cmFpbGVyQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMTE2LCAxMTQsIDk3LCAxMDUsIDEwOCwgMTAxLCAxMTRdKTsKICAgICAgdmFyIHN0YXJ0eHJlZkJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoWzExNSwgMTE2LCA5NywgMTE0LCAxMTYsIDEyMCwgMTE0LCAxMDEsIDEwMl0pOwogICAgICB2YXIgb2JqQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMTExLCA5OCwgMTA2XSk7CiAgICAgIHZhciB4cmVmQnl0ZXMgPSBuZXcgVWludDhBcnJheShbNDcsIDg4LCA4MiwgMTAxLCAxMDJdKTsKICAgICAgdGhpcy5lbnRyaWVzLmxlbmd0aCA9IDA7CiAgICAgIHZhciBzdHJlYW0gPSB0aGlzLnN0cmVhbTsKICAgICAgc3RyZWFtLnBvcyA9IDA7CiAgICAgIHZhciBidWZmZXIgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTsKICAgICAgdmFyIHBvc2l0aW9uID0gc3RyZWFtLnN0YXJ0LAogICAgICAgICAgbGVuZ3RoID0gYnVmZmVyLmxlbmd0aDsKICAgICAgdmFyIHRyYWlsZXJzID0gW10sCiAgICAgICAgICB4cmVmU3RtcyA9IFtdOwoKICAgICAgd2hpbGUgKHBvc2l0aW9uIDwgbGVuZ3RoKSB7CiAgICAgICAgdmFyIGNoID0gYnVmZmVyW3Bvc2l0aW9uXTsKCiAgICAgICAgaWYgKGNoID09PSBUQUIgfHwgY2ggPT09IExGIHx8IGNoID09PSBDUiB8fCBjaCA9PT0gU1BBQ0UpIHsKICAgICAgICAgICsrcG9zaXRpb247CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmIChjaCA9PT0gUEVSQ0VOVCkgewogICAgICAgICAgZG8gewogICAgICAgICAgICArK3Bvc2l0aW9uOwoKICAgICAgICAgICAgaWYgKHBvc2l0aW9uID49IGxlbmd0aCkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjaCA9IGJ1ZmZlcltwb3NpdGlvbl07CiAgICAgICAgICB9IHdoaWxlIChjaCAhPT0gTEYgJiYgY2ggIT09IENSKTsKCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHZhciB0b2tlbiA9IHJlYWRUb2tlbihidWZmZXIsIHBvc2l0aW9uKTsKICAgICAgICB2YXIgbTsKCiAgICAgICAgaWYgKHRva2VuLnN0YXJ0c1dpdGgoInhyZWYiKSAmJiAodG9rZW4ubGVuZ3RoID09PSA0IHx8IC9ccy8udGVzdCh0b2tlbls0XSkpKSB7CiAgICAgICAgICBwb3NpdGlvbiArPSBza2lwVW50aWwoYnVmZmVyLCBwb3NpdGlvbiwgdHJhaWxlckJ5dGVzKTsKICAgICAgICAgIHRyYWlsZXJzLnB1c2gocG9zaXRpb24pOwogICAgICAgICAgcG9zaXRpb24gKz0gc2tpcFVudGlsKGJ1ZmZlciwgcG9zaXRpb24sIHN0YXJ0eHJlZkJ5dGVzKTsKICAgICAgICB9IGVsc2UgaWYgKG0gPSBvYmpSZWdFeHAuZXhlYyh0b2tlbikpIHsKICAgICAgICAgIHZhciBudW0gPSBtWzFdIHwgMCwKICAgICAgICAgICAgICBnZW4gPSBtWzJdIHwgMDsKCiAgICAgICAgICBpZiAoIXRoaXMuZW50cmllc1tudW1dIHx8IHRoaXMuZW50cmllc1tudW1dLmdlbiA9PT0gZ2VuKSB7CiAgICAgICAgICAgIHRoaXMuZW50cmllc1tudW1dID0gewogICAgICAgICAgICAgIG9mZnNldDogcG9zaXRpb24gLSBzdHJlYW0uc3RhcnQsCiAgICAgICAgICAgICAgZ2VuOiBnZW4sCiAgICAgICAgICAgICAgdW5jb21wcmVzc2VkOiB0cnVlCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGNvbnRlbnRMZW5ndGggPSB2b2lkIDAsCiAgICAgICAgICAgICAgc3RhcnRQb3MgPSBwb3NpdGlvbiArIHRva2VuLmxlbmd0aDsKCiAgICAgICAgICB3aGlsZSAoc3RhcnRQb3MgPCBidWZmZXIubGVuZ3RoKSB7CiAgICAgICAgICAgIHZhciBlbmRQb3MgPSBzdGFydFBvcyArIHNraXBVbnRpbChidWZmZXIsIHN0YXJ0UG9zLCBvYmpCeXRlcykgKyA0OwogICAgICAgICAgICBjb250ZW50TGVuZ3RoID0gZW5kUG9zIC0gcG9zaXRpb247CiAgICAgICAgICAgIHZhciBjaGVja1BvcyA9IE1hdGgubWF4KGVuZFBvcyAtIENIRUNLX0NPTlRFTlRfTEVOR1RILCBzdGFydFBvcyk7CiAgICAgICAgICAgIHZhciB0b2tlblN0ciA9ICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShidWZmZXIuc3ViYXJyYXkoY2hlY2tQb3MsIGVuZFBvcykpOwoKICAgICAgICAgICAgaWYgKGVuZG9ialJlZ0V4cC50ZXN0KHRva2VuU3RyKSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhciBvYmpUb2tlbiA9IG5lc3RlZE9ialJlZ0V4cC5leGVjKHRva2VuU3RyKTsKCiAgICAgICAgICAgICAgaWYgKG9ialRva2VuICYmIG9ialRva2VuWzFdKSB7CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoJ2luZGV4T2JqZWN0czogRm91bmQgbmV3ICJvYmoiIGluc2lkZSBvZiBhbm90aGVyICJvYmoiLCAnICsgJ2NhdXNlZCBieSBtaXNzaW5nICJlbmRvYmoiIC0tIHRyeWluZyB0byByZWNvdmVyLicpOwogICAgICAgICAgICAgICAgY29udGVudExlbmd0aCAtPSBvYmpUb2tlblsxXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN0YXJ0UG9zID0gZW5kUG9zOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBjb250ZW50ID0gYnVmZmVyLnN1YmFycmF5KHBvc2l0aW9uLCBwb3NpdGlvbiArIGNvbnRlbnRMZW5ndGgpOwogICAgICAgICAgdmFyIHhyZWZUYWdPZmZzZXQgPSBza2lwVW50aWwoY29udGVudCwgMCwgeHJlZkJ5dGVzKTsKCiAgICAgICAgICBpZiAoeHJlZlRhZ09mZnNldCA8IGNvbnRlbnRMZW5ndGggJiYgY29udGVudFt4cmVmVGFnT2Zmc2V0ICsgNV0gPCA2NCkgewogICAgICAgICAgICB4cmVmU3Rtcy5wdXNoKHBvc2l0aW9uIC0gc3RyZWFtLnN0YXJ0KTsKICAgICAgICAgICAgdGhpcy54cmVmc3Rtc1twb3NpdGlvbiAtIHN0cmVhbS5zdGFydF0gPSAxOwogICAgICAgICAgfQoKICAgICAgICAgIHBvc2l0aW9uICs9IGNvbnRlbnRMZW5ndGg7CiAgICAgICAgfSBlbHNlIGlmICh0b2tlbi5zdGFydHNXaXRoKCJ0cmFpbGVyIikgJiYgKHRva2VuLmxlbmd0aCA9PT0gNyB8fCAvXHMvLnRlc3QodG9rZW5bN10pKSkgewogICAgICAgICAgdHJhaWxlcnMucHVzaChwb3NpdGlvbik7CiAgICAgICAgICBwb3NpdGlvbiArPSBza2lwVW50aWwoYnVmZmVyLCBwb3NpdGlvbiwgc3RhcnR4cmVmQnl0ZXMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwb3NpdGlvbiArPSB0b2tlbi5sZW5ndGggKyAxOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGksIGlpOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSB4cmVmU3Rtcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5wdXNoKHhyZWZTdG1zW2ldKTsKICAgICAgICB0aGlzLnJlYWRYUmVmKHRydWUpOwogICAgICB9CgogICAgICB2YXIgdHJhaWxlckRpY3Q7CgogICAgICBmb3IgKGkgPSAwLCBpaSA9IHRyYWlsZXJzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICBzdHJlYW0ucG9zID0gdHJhaWxlcnNbaV07CiAgICAgICAgdmFyIHBhcnNlciA9IG5ldyBfcGFyc2VyLlBhcnNlcih7CiAgICAgICAgICBsZXhlcjogbmV3IF9wYXJzZXIuTGV4ZXIoc3RyZWFtKSwKICAgICAgICAgIHhyZWY6IHRoaXMsCiAgICAgICAgICBhbGxvd1N0cmVhbXM6IHRydWUsCiAgICAgICAgICByZWNvdmVyeU1vZGU6IHRydWUKICAgICAgICB9KTsKICAgICAgICB2YXIgb2JqID0gcGFyc2VyLmdldE9iaigpOwoKICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAidHJhaWxlciIpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHZhciBkaWN0ID0gcGFyc2VyLmdldE9iaigpOwoKICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGRpY3QpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHZhciByb290RGljdCA9IHZvaWQgMDsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHJvb3REaWN0ID0gZGljdC5nZXQoIlJvb3QiKTsKICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgICB9CgogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKHJvb3REaWN0KSB8fCAhcm9vdERpY3QuaGFzKCJQYWdlcyIpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmIChkaWN0LmhhcygiSUQiKSkgewogICAgICAgICAgcmV0dXJuIGRpY3Q7CiAgICAgICAgfQoKICAgICAgICB0cmFpbGVyRGljdCA9IGRpY3Q7CiAgICAgIH0KCiAgICAgIGlmICh0cmFpbGVyRGljdCkgewogICAgICAgIHJldHVybiB0cmFpbGVyRGljdDsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IF91dGlsLkludmFsaWRQREZFeGNlcHRpb24oIkludmFsaWQgUERGIHN0cnVjdHVyZS4iKTsKICAgIH0sCiAgICByZWFkWFJlZjogZnVuY3Rpb24gWFJlZl9yZWFkWFJlZihyZWNvdmVyeU1vZGUpIHsKICAgICAgdmFyIHN0cmVhbSA9IHRoaXMuc3RyZWFtOwogICAgICB2YXIgc3RhcnRYUmVmUGFyc2VkQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgICAgdHJ5IHsKICAgICAgICB3aGlsZSAodGhpcy5zdGFydFhSZWZRdWV1ZS5sZW5ndGgpIHsKICAgICAgICAgIHZhciBzdGFydFhSZWYgPSB0aGlzLnN0YXJ0WFJlZlF1ZXVlWzBdOwoKICAgICAgICAgIGlmIChzdGFydFhSZWZQYXJzZWRDYWNoZVtzdGFydFhSZWZdKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgicmVhZFhSZWYgLSBza2lwcGluZyBYUmVmIHRhYmxlIHNpbmNlIGl0IHdhcyBhbHJlYWR5IHBhcnNlZC4iKTsKICAgICAgICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5zaGlmdCgpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdGFydFhSZWZQYXJzZWRDYWNoZVtzdGFydFhSZWZdID0gdHJ1ZTsKICAgICAgICAgIHN0cmVhbS5wb3MgPSBzdGFydFhSZWYgKyBzdHJlYW0uc3RhcnQ7CiAgICAgICAgICB2YXIgcGFyc2VyID0gbmV3IF9wYXJzZXIuUGFyc2VyKHsKICAgICAgICAgICAgbGV4ZXI6IG5ldyBfcGFyc2VyLkxleGVyKHN0cmVhbSksCiAgICAgICAgICAgIHhyZWY6IHRoaXMsCiAgICAgICAgICAgIGFsbG93U3RyZWFtczogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICB2YXIgb2JqID0gcGFyc2VyLmdldE9iaigpOwogICAgICAgICAgdmFyIGRpY3Q7CgogICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAieHJlZiIpKSB7CiAgICAgICAgICAgIGRpY3QgPSB0aGlzLnByb2Nlc3NYUmVmVGFibGUocGFyc2VyKTsKCiAgICAgICAgICAgIGlmICghdGhpcy50b3BEaWN0KSB7CiAgICAgICAgICAgICAgdGhpcy50b3BEaWN0ID0gZGljdDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgb2JqID0gZGljdC5nZXQoIlhSZWZTdG0iKTsKCiAgICAgICAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG9iaikpIHsKICAgICAgICAgICAgICB2YXIgcG9zID0gb2JqOwoKICAgICAgICAgICAgICBpZiAoIShwb3MgaW4gdGhpcy54cmVmc3RtcykpIHsKICAgICAgICAgICAgICAgIHRoaXMueHJlZnN0bXNbcG9zXSA9IDE7CiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0WFJlZlF1ZXVlLnB1c2gocG9zKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAoTnVtYmVyLmlzSW50ZWdlcihvYmopKSB7CiAgICAgICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihwYXJzZXIuZ2V0T2JqKCkpIHx8ICEoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKHBhcnNlci5nZXRPYmooKSwgIm9iaiIpIHx8ICEoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKG9iaiA9IHBhcnNlci5nZXRPYmooKSkpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiBzdHJlYW0iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGljdCA9IHRoaXMucHJvY2Vzc1hSZWZTdHJlYW0ob2JqKTsKCiAgICAgICAgICAgIGlmICghdGhpcy50b3BEaWN0KSB7CiAgICAgICAgICAgICAgdGhpcy50b3BEaWN0ID0gZGljdDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCFkaWN0KSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJGYWlsZWQgdG8gcmVhZCBYUmVmIHN0cmVhbSIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgWFJlZiBzdHJlYW0gaGVhZGVyIik7CiAgICAgICAgICB9CgogICAgICAgICAgb2JqID0gZGljdC5nZXQoIlByZXYiKTsKCiAgICAgICAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihvYmopKSB7CiAgICAgICAgICAgIHRoaXMuc3RhcnRYUmVmUXVldWUucHVzaChvYmopOwogICAgICAgICAgfSBlbHNlIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNSZWYpKG9iaikpIHsKICAgICAgICAgICAgdGhpcy5zdGFydFhSZWZRdWV1ZS5wdXNoKG9iai5udW0pOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuc3RhcnRYUmVmUXVldWUuc2hpZnQoKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzLnRvcERpY3Q7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICB0aHJvdyBlOwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLmluZm8pKCIod2hpbGUgcmVhZGluZyBYUmVmKTogIiArIGUpOwogICAgICB9CgogICAgICBpZiAocmVjb3ZlcnlNb2RlKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZQYXJzZUV4Y2VwdGlvbigpOwogICAgfSwKICAgIGdldEVudHJ5OiBmdW5jdGlvbiBYUmVmX2dldEVudHJ5KGkpIHsKICAgICAgdmFyIHhyZWZFbnRyeSA9IHRoaXMuZW50cmllc1tpXTsKCiAgICAgIGlmICh4cmVmRW50cnkgJiYgIXhyZWZFbnRyeS5mcmVlICYmIHhyZWZFbnRyeS5vZmZzZXQpIHsKICAgICAgICByZXR1cm4geHJlZkVudHJ5OwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCiAgICBmZXRjaElmUmVmOiBmdW5jdGlvbiBYUmVmX2ZldGNoSWZSZWYob2JqLCBzdXBwcmVzc0VuY3J5cHRpb24pIHsKICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgIHJldHVybiB0aGlzLmZldGNoKG9iaiwgc3VwcHJlc3NFbmNyeXB0aW9uKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG9iajsKICAgIH0sCiAgICBmZXRjaDogZnVuY3Rpb24gWFJlZl9mZXRjaChyZWYsIHN1cHByZXNzRW5jcnlwdGlvbikgewogICAgICBpZiAoIShyZWYgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJyZWYgb2JqZWN0IGlzIG5vdCBhIHJlZmVyZW5jZSIpOwogICAgICB9CgogICAgICB2YXIgbnVtID0gcmVmLm51bTsKCiAgICAgIHZhciBjYWNoZUVudHJ5ID0gdGhpcy5fY2FjaGVNYXAuZ2V0KG51bSk7CgogICAgICBpZiAoY2FjaGVFbnRyeSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKGNhY2hlRW50cnkgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0ICYmICFjYWNoZUVudHJ5Lm9iaklkKSB7CiAgICAgICAgICBjYWNoZUVudHJ5Lm9iaklkID0gcmVmLnRvU3RyaW5nKCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY2FjaGVFbnRyeTsKICAgICAgfQoKICAgICAgdmFyIHhyZWZFbnRyeSA9IHRoaXMuZ2V0RW50cnkobnVtKTsKCiAgICAgIGlmICh4cmVmRW50cnkgPT09IG51bGwpIHsKICAgICAgICB0aGlzLl9jYWNoZU1hcC5zZXQobnVtLCB4cmVmRW50cnkpOwoKICAgICAgICByZXR1cm4geHJlZkVudHJ5OwogICAgICB9CgogICAgICBpZiAoeHJlZkVudHJ5LnVuY29tcHJlc3NlZCkgewogICAgICAgIHhyZWZFbnRyeSA9IHRoaXMuZmV0Y2hVbmNvbXByZXNzZWQocmVmLCB4cmVmRW50cnksIHN1cHByZXNzRW5jcnlwdGlvbik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgeHJlZkVudHJ5ID0gdGhpcy5mZXRjaENvbXByZXNzZWQocmVmLCB4cmVmRW50cnksIHN1cHByZXNzRW5jcnlwdGlvbik7CiAgICAgIH0KCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KSh4cmVmRW50cnkpKSB7CiAgICAgICAgeHJlZkVudHJ5Lm9iaklkID0gcmVmLnRvU3RyaW5nKCk7CiAgICAgIH0gZWxzZSBpZiAoKDAsIF9wcmltaXRpdmVzLmlzU3RyZWFtKSh4cmVmRW50cnkpKSB7CiAgICAgICAgeHJlZkVudHJ5LmRpY3Qub2JqSWQgPSByZWYudG9TdHJpbmcoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHhyZWZFbnRyeTsKICAgIH0sCiAgICBmZXRjaFVuY29tcHJlc3NlZDogZnVuY3Rpb24gZmV0Y2hVbmNvbXByZXNzZWQocmVmLCB4cmVmRW50cnkpIHsKICAgICAgdmFyIHN1cHByZXNzRW5jcnlwdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBnZW4gPSByZWYuZ2VuOwogICAgICB2YXIgbnVtID0gcmVmLm51bTsKCiAgICAgIGlmICh4cmVmRW50cnkuZ2VuICE9PSBnZW4pIHsKICAgICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuWFJlZkVudHJ5RXhjZXB0aW9uKCJJbmNvbnNpc3RlbnQgZ2VuZXJhdGlvbiBpbiBYUmVmOiAiLmNvbmNhdChyZWYpKTsKICAgICAgfQoKICAgICAgdmFyIHN0cmVhbSA9IHRoaXMuc3RyZWFtLm1ha2VTdWJTdHJlYW0oeHJlZkVudHJ5Lm9mZnNldCArIHRoaXMuc3RyZWFtLnN0YXJ0KTsKICAgICAgdmFyIHBhcnNlciA9IG5ldyBfcGFyc2VyLlBhcnNlcih7CiAgICAgICAgbGV4ZXI6IG5ldyBfcGFyc2VyLkxleGVyKHN0cmVhbSksCiAgICAgICAgeHJlZjogdGhpcywKICAgICAgICBhbGxvd1N0cmVhbXM6IHRydWUKICAgICAgfSk7CiAgICAgIHZhciBvYmoxID0gcGFyc2VyLmdldE9iaigpOwogICAgICB2YXIgb2JqMiA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgdmFyIG9iajMgPSBwYXJzZXIuZ2V0T2JqKCk7CgogICAgICBpZiAob2JqMSAhPT0gbnVtIHx8IG9iajIgIT09IGdlbiB8fCAhKG9iajMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5DbWQpKSB7CiAgICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZFbnRyeUV4Y2VwdGlvbigiQmFkICh1bmNvbXByZXNzZWQpIFhSZWYgZW50cnk6ICIuY29uY2F0KHJlZikpOwogICAgICB9CgogICAgICBpZiAob2JqMy5jbWQgIT09ICJvYmoiKSB7CiAgICAgICAgaWYgKG9iajMuY21kLnN0YXJ0c1dpdGgoIm9iaiIpKSB7CiAgICAgICAgICBudW0gPSBwYXJzZUludChvYmozLmNtZC5zdWJzdHJpbmcoMyksIDEwKTsKCiAgICAgICAgICBpZiAoIU51bWJlci5pc05hTihudW0pKSB7CiAgICAgICAgICAgIHJldHVybiBudW07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBuZXcgX2NvcmVfdXRpbHMuWFJlZkVudHJ5RXhjZXB0aW9uKCJCYWQgKHVuY29tcHJlc3NlZCkgWFJlZiBlbnRyeTogIi5jb25jYXQocmVmKSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmVuY3J5cHQgJiYgIXN1cHByZXNzRW5jcnlwdGlvbikgewogICAgICAgIHhyZWZFbnRyeSA9IHBhcnNlci5nZXRPYmoodGhpcy5lbmNyeXB0LmNyZWF0ZUNpcGhlclRyYW5zZm9ybShudW0sIGdlbikpOwogICAgICB9IGVsc2UgewogICAgICAgIHhyZWZFbnRyeSA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgfQoKICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKHhyZWZFbnRyeSkpIHsKICAgICAgICB0aGlzLl9jYWNoZU1hcC5zZXQobnVtLCB4cmVmRW50cnkpOwogICAgICB9CgogICAgICByZXR1cm4geHJlZkVudHJ5OwogICAgfSwKICAgIGZldGNoQ29tcHJlc3NlZDogZnVuY3Rpb24gZmV0Y2hDb21wcmVzc2VkKHJlZiwgeHJlZkVudHJ5KSB7CiAgICAgIHZhciBzdXBwcmVzc0VuY3J5cHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwogICAgICB2YXIgdGFibGVPZmZzZXQgPSB4cmVmRW50cnkub2Zmc2V0OwogICAgICB2YXIgc3RyZWFtID0gdGhpcy5mZXRjaChfcHJpbWl0aXZlcy5SZWYuZ2V0KHRhYmxlT2Zmc2V0LCAwKSk7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkoc3RyZWFtKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiYmFkIE9ialN0bSBzdHJlYW0iKTsKICAgICAgfQoKICAgICAgdmFyIGZpcnN0ID0gc3RyZWFtLmRpY3QuZ2V0KCJGaXJzdCIpOwogICAgICB2YXIgbiA9IHN0cmVhbS5kaWN0LmdldCgiTiIpOwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGZpcnN0KSB8fCAhTnVtYmVyLmlzSW50ZWdlcihuKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiaW52YWxpZCBmaXJzdCBhbmQgbiBwYXJhbWV0ZXJzIGZvciBPYmpTdG0gc3RyZWFtIik7CiAgICAgIH0KCiAgICAgIHZhciBwYXJzZXIgPSBuZXcgX3BhcnNlci5QYXJzZXIoewogICAgICAgIGxleGVyOiBuZXcgX3BhcnNlci5MZXhlcihzdHJlYW0pLAogICAgICAgIHhyZWY6IHRoaXMsCiAgICAgICAgYWxsb3dTdHJlYW1zOiB0cnVlCiAgICAgIH0pOwogICAgICB2YXIgbnVtcyA9IG5ldyBBcnJheShuKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgICAgdmFyIG51bSA9IHBhcnNlci5nZXRPYmooKTsKCiAgICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKG51bSkpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiaW52YWxpZCBvYmplY3QgbnVtYmVyIGluIHRoZSBPYmpTdG0gc3RyZWFtOiAiLmNvbmNhdChudW0pKTsKICAgICAgICB9CgogICAgICAgIHZhciBvZmZzZXQgPSBwYXJzZXIuZ2V0T2JqKCk7CgogICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihvZmZzZXQpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoImludmFsaWQgb2JqZWN0IG9mZnNldCBpbiB0aGUgT2JqU3RtIHN0cmVhbTogIi5jb25jYXQob2Zmc2V0KSk7CiAgICAgICAgfQoKICAgICAgICBudW1zW2ldID0gbnVtOwogICAgICB9CgogICAgICB2YXIgZW50cmllcyA9IG5ldyBBcnJheShuKTsKCiAgICAgIGZvciAodmFyIF9pMiA9IDA7IF9pMiA8IG47ICsrX2kyKSB7CiAgICAgICAgdmFyIG9iaiA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgICBlbnRyaWVzW19pMl0gPSBvYmo7CgogICAgICAgIGlmIChwYXJzZXIuYnVmMSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLkNtZCAmJiBwYXJzZXIuYnVmMS5jbWQgPT09ICJlbmRvYmoiKSB7CiAgICAgICAgICBwYXJzZXIuc2hpZnQoKTsKICAgICAgICB9CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKG9iaikpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIF9udW0gPSBudW1zW19pMl0sCiAgICAgICAgICAgIGVudHJ5ID0gdGhpcy5lbnRyaWVzW19udW1dOwoKICAgICAgICBpZiAoZW50cnkgJiYgZW50cnkub2Zmc2V0ID09PSB0YWJsZU9mZnNldCAmJiBlbnRyeS5nZW4gPT09IF9pMikgewogICAgICAgICAgdGhpcy5fY2FjaGVNYXAuc2V0KF9udW0sIG9iaik7CiAgICAgICAgfQogICAgICB9CgogICAgICB4cmVmRW50cnkgPSBlbnRyaWVzW3hyZWZFbnRyeS5nZW5dOwoKICAgICAgaWYgKHhyZWZFbnRyeSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhyb3cgbmV3IF9jb3JlX3V0aWxzLlhSZWZFbnRyeUV4Y2VwdGlvbigiQmFkIChjb21wcmVzc2VkKSBYUmVmIGVudHJ5OiAiLmNvbmNhdChyZWYpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHhyZWZFbnRyeTsKICAgIH0sCiAgICBmZXRjaElmUmVmQXN5bmM6IGZ1bmN0aW9uIGZldGNoSWZSZWZBc3luYyhvYmosIHN1cHByZXNzRW5jcnlwdGlvbikgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghKG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIF90aGlzMy5mZXRjaEFzeW5jKG9iaiwgc3VwcHJlc3NFbmNyeXB0aW9uKSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIG9iaik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBmZXRjaEFzeW5jOiBmdW5jdGlvbiBmZXRjaEFzeW5jKHJlZiwgc3VwcHJlc3NFbmNyeXB0aW9uKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDA7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgX3RoaXM0LmZldGNoKHJlZiwgc3VwcHJlc3NFbmNyeXB0aW9uKSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gNDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSgwKTsKCiAgICAgICAgICAgICAgICBpZiAoX2NvbnRleHQyLnQwIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dDIudDA7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0LnBkZk1hbmFnZXIucmVxdWVzdFJhbmdlKF9jb250ZXh0Mi50MC5iZWdpbiwgX2NvbnRleHQyLnQwLmVuZCk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgX3RoaXM0LmZldGNoQXN5bmMocmVmLCBzdXBwcmVzc0VuY3J5cHRpb24pKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgbnVsbCwgW1swLCA0XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBnZXRDYXRhbG9nT2JqOiBmdW5jdGlvbiBYUmVmX2dldENhdGFsb2dPYmooKSB7CiAgICAgIHJldHVybiB0aGlzLnJvb3Q7CiAgICB9CiAgfTsKICByZXR1cm4gWFJlZjsKfSgpOwoKZXhwb3J0cy5YUmVmID0gWFJlZjsKCnZhciBOYW1lT3JOdW1iZXJUcmVlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBOYW1lT3JOdW1iZXJUcmVlKHJvb3QsIHhyZWYsIHR5cGUpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOYW1lT3JOdW1iZXJUcmVlKTsKCiAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gTmFtZU9yTnVtYmVyVHJlZSkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBOYW1lT3JOdW1iZXJUcmVlLiIpOwogICAgfQoKICAgIHRoaXMucm9vdCA9IHJvb3Q7CiAgICB0aGlzLnhyZWYgPSB4cmVmOwogICAgdGhpcy5fdHlwZSA9IHR5cGU7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTmFtZU9yTnVtYmVyVHJlZSwgW3sKICAgIGtleTogImdldEFsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QWxsKCkgewogICAgICB2YXIgZGljdCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICBpZiAoIXRoaXMucm9vdCkgewogICAgICAgIHJldHVybiBkaWN0OwogICAgICB9CgogICAgICB2YXIgeHJlZiA9IHRoaXMueHJlZjsKICAgICAgdmFyIHByb2Nlc3NlZCA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXQoKTsKICAgICAgcHJvY2Vzc2VkLnB1dCh0aGlzLnJvb3QpOwogICAgICB2YXIgcXVldWUgPSBbdGhpcy5yb290XTsKCiAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIG9iaiA9IHhyZWYuZmV0Y2hJZlJlZihxdWV1ZS5zaGlmdCgpKTsKCiAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShvYmopKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmIChvYmouaGFzKCJLaWRzIikpIHsKICAgICAgICAgIHZhciBraWRzID0gb2JqLmdldCgiS2lkcyIpOwoKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGtpZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICB2YXIga2lkID0ga2lkc1tpXTsKCiAgICAgICAgICAgIGlmIChwcm9jZXNzZWQuaGFzKGtpZCkpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkR1cGxpY2F0ZSBlbnRyeSBpbiBcIiIuY29uY2F0KHRoaXMuX3R5cGUsICJcIiB0cmVlLiIpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcXVldWUucHVzaChraWQpOwogICAgICAgICAgICBwcm9jZXNzZWQucHV0KGtpZCk7CiAgICAgICAgICB9CgogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgZW50cmllcyA9IG9iai5nZXQodGhpcy5fdHlwZSk7CgogICAgICAgIGlmIChBcnJheS5pc0FycmF5KGVudHJpZXMpKSB7CiAgICAgICAgICBmb3IgKHZhciBfaTMgPSAwLCBfaWkgPSBlbnRyaWVzLmxlbmd0aDsgX2kzIDwgX2lpOyBfaTMgKz0gMikgewogICAgICAgICAgICBkaWN0W3hyZWYuZmV0Y2hJZlJlZihlbnRyaWVzW19pM10pXSA9IHhyZWYuZmV0Y2hJZlJlZihlbnRyaWVzW19pMyArIDFdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBkaWN0OwogICAgfQogIH0sIHsKICAgIGtleTogImdldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0KGtleSkgewogICAgICBpZiAoIXRoaXMucm9vdCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgeHJlZiA9IHRoaXMueHJlZjsKICAgICAgdmFyIGtpZHNPckVudHJpZXMgPSB4cmVmLmZldGNoSWZSZWYodGhpcy5yb290KTsKICAgICAgdmFyIGxvb3BDb3VudCA9IDA7CiAgICAgIHZhciBNQVhfTEVWRUxTID0gMTA7CgogICAgICB3aGlsZSAoa2lkc09yRW50cmllcy5oYXMoIktpZHMiKSkgewogICAgICAgIGlmICgrK2xvb3BDb3VudCA+IE1BWF9MRVZFTFMpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiU2VhcmNoIGRlcHRoIGxpbWl0IHJlYWNoZWQgZm9yIFwiIi5jb25jYXQodGhpcy5fdHlwZSwgIlwiIHRyZWUuIikpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICB2YXIga2lkcyA9IGtpZHNPckVudHJpZXMuZ2V0KCJLaWRzIik7CgogICAgICAgIGlmICghQXJyYXkuaXNBcnJheShraWRzKSkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICB2YXIgbCA9IDAsCiAgICAgICAgICAgIHIgPSBraWRzLmxlbmd0aCAtIDE7CgogICAgICAgIHdoaWxlIChsIDw9IHIpIHsKICAgICAgICAgIHZhciBtID0gbCArIHIgPj4gMTsKICAgICAgICAgIHZhciBraWQgPSB4cmVmLmZldGNoSWZSZWYoa2lkc1ttXSk7CiAgICAgICAgICB2YXIgbGltaXRzID0ga2lkLmdldCgiTGltaXRzIik7CgogICAgICAgICAgaWYgKGtleSA8IHhyZWYuZmV0Y2hJZlJlZihsaW1pdHNbMF0pKSB7CiAgICAgICAgICAgIHIgPSBtIC0gMTsKICAgICAgICAgIH0gZWxzZSBpZiAoa2V5ID4geHJlZi5mZXRjaElmUmVmKGxpbWl0c1sxXSkpIHsKICAgICAgICAgICAgbCA9IG0gKyAxOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAga2lkc09yRW50cmllcyA9IHhyZWYuZmV0Y2hJZlJlZihraWRzW21dKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAobCA+IHIpIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGVudHJpZXMgPSBraWRzT3JFbnRyaWVzLmdldCh0aGlzLl90eXBlKTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGVudHJpZXMpKSB7CiAgICAgICAgdmFyIF9sID0gMCwKICAgICAgICAgICAgX3IgPSBlbnRyaWVzLmxlbmd0aCAtIDI7CgogICAgICAgIHdoaWxlIChfbCA8PSBfcikgewogICAgICAgICAgdmFyIHRtcCA9IF9sICsgX3IgPj4gMSwKICAgICAgICAgICAgICBfbSA9IHRtcCArICh0bXAgJiAxKTsKCiAgICAgICAgICB2YXIgY3VycmVudEtleSA9IHhyZWYuZmV0Y2hJZlJlZihlbnRyaWVzW19tXSk7CgogICAgICAgICAgaWYgKGtleSA8IGN1cnJlbnRLZXkpIHsKICAgICAgICAgICAgX3IgPSBfbSAtIDI7CiAgICAgICAgICB9IGVsc2UgaWYgKGtleSA+IGN1cnJlbnRLZXkpIHsKICAgICAgICAgICAgX2wgPSBfbSArIDI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4geHJlZi5mZXRjaElmUmVmKGVudHJpZXNbX20gKyAxXSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkZhbGxpbmcgYmFjayB0byBhbiBleGhhdXN0aXZlIHNlYXJjaCwgZm9yIGtleSBcIiIuY29uY2F0KGtleSwgIlwiLCAiKSArICJpbiBcIiIuY29uY2F0KHRoaXMuX3R5cGUsICJcIiB0cmVlLiIpKTsKCiAgICAgICAgZm9yICh2YXIgX20yID0gMCwgbW0gPSBlbnRyaWVzLmxlbmd0aDsgX20yIDwgbW07IF9tMiArPSAyKSB7CiAgICAgICAgICB2YXIgX2N1cnJlbnRLZXkgPSB4cmVmLmZldGNoSWZSZWYoZW50cmllc1tfbTJdKTsKCiAgICAgICAgICBpZiAoX2N1cnJlbnRLZXkgPT09IGtleSkgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlRoZSBcIiIuY29uY2F0KGtleSwgIlwiIGtleSB3YXMgZm91bmQgYXQgYW4gaW5jb3JyZWN0LCAiKSArICJpLmUuIG91dC1vZi1vcmRlciwgcG9zaXRpb24gaW4gXCIiLmNvbmNhdCh0aGlzLl90eXBlLCAiXCIgdHJlZS4iKSk7CiAgICAgICAgICAgIHJldHVybiB4cmVmLmZldGNoSWZSZWYoZW50cmllc1tfbTIgKyAxXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9XSk7CgogIHJldHVybiBOYW1lT3JOdW1iZXJUcmVlOwp9KCk7Cgp2YXIgTmFtZVRyZWUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9OYW1lT3JOdW1iZXJUcmVlKSB7CiAgX2luaGVyaXRzKE5hbWVUcmVlLCBfTmFtZU9yTnVtYmVyVHJlZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoTmFtZVRyZWUpOwoKICBmdW5jdGlvbiBOYW1lVHJlZShyb290LCB4cmVmKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTmFtZVRyZWUpOwoKICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCByb290LCB4cmVmLCAiTmFtZXMiKTsKICB9CgogIHJldHVybiBOYW1lVHJlZTsKfShOYW1lT3JOdW1iZXJUcmVlKTsKCnZhciBOdW1iZXJUcmVlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTmFtZU9yTnVtYmVyVHJlZTIpIHsKICBfaW5oZXJpdHMoTnVtYmVyVHJlZSwgX05hbWVPck51bWJlclRyZWUyKTsKCiAgdmFyIF9zdXBlcjIgPSBfY3JlYXRlU3VwZXIoTnVtYmVyVHJlZSk7CgogIGZ1bmN0aW9uIE51bWJlclRyZWUocm9vdCwgeHJlZikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE51bWJlclRyZWUpOwoKICAgIHJldHVybiBfc3VwZXIyLmNhbGwodGhpcywgcm9vdCwgeHJlZiwgIk51bXMiKTsKICB9CgogIHJldHVybiBOdW1iZXJUcmVlOwp9KE5hbWVPck51bWJlclRyZWUpOwoKdmFyIEZpbGVTcGVjID0gZnVuY3Rpb24gRmlsZVNwZWNDbG9zdXJlKCkgewogIGZ1bmN0aW9uIEZpbGVTcGVjKHJvb3QsIHhyZWYpIHsKICAgIGlmICghcm9vdCB8fCAhKDAsIF9wcmltaXRpdmVzLmlzRGljdCkocm9vdCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMueHJlZiA9IHhyZWY7CiAgICB0aGlzLnJvb3QgPSByb290OwoKICAgIGlmIChyb290LmhhcygiRlMiKSkgewogICAgICB0aGlzLmZzID0gcm9vdC5nZXQoIkZTIik7CiAgICB9CgogICAgdGhpcy5kZXNjcmlwdGlvbiA9IHJvb3QuaGFzKCJEZXNjIikgPyAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKHJvb3QuZ2V0KCJEZXNjIikpIDogIiI7CgogICAgaWYgKHJvb3QuaGFzKCJSRiIpKSB7CiAgICAgICgwLCBfdXRpbC53YXJuKSgiUmVsYXRlZCBmaWxlIHNwZWNpZmljYXRpb25zIGFyZSBub3Qgc3VwcG9ydGVkIik7CiAgICB9CgogICAgdGhpcy5jb250ZW50QXZhaWxhYmxlID0gdHJ1ZTsKCiAgICBpZiAoIXJvb3QuaGFzKCJFRiIpKSB7CiAgICAgIHRoaXMuY29udGVudEF2YWlsYWJsZSA9IGZhbHNlOwogICAgICAoMCwgX3V0aWwud2FybikoIk5vbi1lbWJlZGRlZCBmaWxlIHNwZWNpZmljYXRpb25zIGFyZSBub3Qgc3VwcG9ydGVkIik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwaWNrUGxhdGZvcm1JdGVtKGRpY3QpIHsKICAgIGlmIChkaWN0LmhhcygiVUYiKSkgewogICAgICByZXR1cm4gZGljdC5nZXQoIlVGIik7CiAgICB9IGVsc2UgaWYgKGRpY3QuaGFzKCJGIikpIHsKICAgICAgcmV0dXJuIGRpY3QuZ2V0KCJGIik7CiAgICB9IGVsc2UgaWYgKGRpY3QuaGFzKCJVbml4IikpIHsKICAgICAgcmV0dXJuIGRpY3QuZ2V0KCJVbml4Iik7CiAgICB9IGVsc2UgaWYgKGRpY3QuaGFzKCJNYWMiKSkgewogICAgICByZXR1cm4gZGljdC5nZXQoIk1hYyIpOwogICAgfSBlbHNlIGlmIChkaWN0LmhhcygiRE9TIikpIHsKICAgICAgcmV0dXJuIGRpY3QuZ2V0KCJET1MiKTsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9CgogIEZpbGVTcGVjLnByb3RvdHlwZSA9IHsKICAgIGdldCBmaWxlbmFtZSgpIHsKICAgICAgaWYgKCF0aGlzLl9maWxlbmFtZSAmJiB0aGlzLnJvb3QpIHsKICAgICAgICB2YXIgZmlsZW5hbWUgPSBwaWNrUGxhdGZvcm1JdGVtKHRoaXMucm9vdCkgfHwgInVubmFtZWQiOwogICAgICAgIHRoaXMuX2ZpbGVuYW1lID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShmaWxlbmFtZSkucmVwbGFjZSgvXFxcXC9nLCAiXFwiKS5yZXBsYWNlKC9cXFwvL2csICIvIikucmVwbGFjZSgvXFwvZywgIi8iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuX2ZpbGVuYW1lOwogICAgfSwKCiAgICBnZXQgY29udGVudCgpIHsKICAgICAgaWYgKCF0aGlzLmNvbnRlbnRBdmFpbGFibGUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmNvbnRlbnRSZWYgJiYgdGhpcy5yb290KSB7CiAgICAgICAgdGhpcy5jb250ZW50UmVmID0gcGlja1BsYXRmb3JtSXRlbSh0aGlzLnJvb3QuZ2V0KCJFRiIpKTsKICAgICAgfQoKICAgICAgdmFyIGNvbnRlbnQgPSBudWxsOwoKICAgICAgaWYgKHRoaXMuY29udGVudFJlZikgewogICAgICAgIHZhciB4cmVmID0gdGhpcy54cmVmOwogICAgICAgIHZhciBmaWxlT2JqID0geHJlZi5mZXRjaElmUmVmKHRoaXMuY29udGVudFJlZik7CgogICAgICAgIGlmIChmaWxlT2JqICYmICgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkoZmlsZU9iaikpIHsKICAgICAgICAgIGNvbnRlbnQgPSBmaWxlT2JqLmdldEJ5dGVzKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiRW1iZWRkZWQgZmlsZSBzcGVjaWZpY2F0aW9uIHBvaW50cyB0byBub24tZXhpc3RpbmcvaW52YWxpZCAiICsgImNvbnRlbnQiKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJFbWJlZGRlZCBmaWxlIHNwZWNpZmljYXRpb24gZG9lcyBub3QgaGF2ZSBhIGNvbnRlbnQiKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICB9LAoKICAgIGdldCBzZXJpYWxpemFibGUoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgZmlsZW5hbWU6IHRoaXMuZmlsZW5hbWUsCiAgICAgICAgY29udGVudDogdGhpcy5jb250ZW50CiAgICAgIH07CiAgICB9CgogIH07CiAgcmV0dXJuIEZpbGVTcGVjOwp9KCk7CgpleHBvcnRzLkZpbGVTcGVjID0gRmlsZVNwZWM7Cgp2YXIgT2JqZWN0TG9hZGVyID0gZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIG1heUhhdmVDaGlsZHJlbih2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmIHx8IHZhbHVlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCB8fCBBcnJheS5pc0FycmF5KHZhbHVlKSB8fCAoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKHZhbHVlKTsKICB9CgogIGZ1bmN0aW9uIGFkZENoaWxkcmVuKG5vZGUsIG5vZGVzVG9WaXNpdCkgewogICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0IHx8ICgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkobm9kZSkpIHsKICAgICAgdmFyIGRpY3QgPSBub2RlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCA/IG5vZGUgOiBub2RlLmRpY3Q7CiAgICAgIHZhciBkaWN0S2V5cyA9IGRpY3QuZ2V0S2V5cygpOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZGljdEtleXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIHZhciByYXdWYWx1ZSA9IGRpY3QuZ2V0UmF3KGRpY3RLZXlzW2ldKTsKCiAgICAgICAgaWYgKG1heUhhdmVDaGlsZHJlbihyYXdWYWx1ZSkpIHsKICAgICAgICAgIG5vZGVzVG9WaXNpdC5wdXNoKHJhd1ZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShub2RlKSkgewogICAgICBmb3IgKHZhciBfaTQgPSAwLCBfaWkyID0gbm9kZS5sZW5ndGg7IF9pNCA8IF9paTI7IF9pNCsrKSB7CiAgICAgICAgdmFyIHZhbHVlID0gbm9kZVtfaTRdOwoKICAgICAgICBpZiAobWF5SGF2ZUNoaWxkcmVuKHZhbHVlKSkgewogICAgICAgICAgbm9kZXNUb1Zpc2l0LnB1c2godmFsdWUpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gT2JqZWN0TG9hZGVyKGRpY3QsIGtleXMsIHhyZWYpIHsKICAgIHRoaXMuZGljdCA9IGRpY3Q7CiAgICB0aGlzLmtleXMgPSBrZXlzOwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMucmVmU2V0ID0gbnVsbDsKICB9CgogIE9iamVjdExvYWRlci5wcm90b3R5cGUgPSB7CiAgICBsb2FkOiBmdW5jdGlvbiBsb2FkKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIGtleXMsIGRpY3QsIG5vZGVzVG9WaXNpdCwgaSwgaWksIHJhd1ZhbHVlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JbImRlZmF1bHQiXS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghKCFfdGhpczUueHJlZi5zdHJlYW0uYWxsQ2h1bmtzTG9hZGVkIHx8IF90aGlzNS54cmVmLnN0cmVhbS5hbGxDaHVua3NMb2FkZWQoKSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgdW5kZWZpbmVkKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAga2V5cyA9IF90aGlzNS5rZXlzLCBkaWN0ID0gX3RoaXM1LmRpY3Q7CiAgICAgICAgICAgICAgICBfdGhpczUucmVmU2V0ID0gbmV3IF9wcmltaXRpdmVzLlJlZlNldCgpOwogICAgICAgICAgICAgICAgbm9kZXNUb1Zpc2l0ID0gW107CgogICAgICAgICAgICAgICAgZm9yIChpID0gMCwgaWkgPSBrZXlzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgICAgICAgICAgcmF3VmFsdWUgPSBkaWN0LmdldFJhdyhrZXlzW2ldKTsKCiAgICAgICAgICAgICAgICAgIGlmIChyYXdWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgbm9kZXNUb1Zpc2l0LnB1c2gocmF3VmFsdWUpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIF90aGlzNS5fd2Fsayhub2Rlc1RvVmlzaXQpKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgX3dhbGs6IGZ1bmN0aW9uIF93YWxrKG5vZGVzVG9WaXNpdCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIG5vZGVzVG9SZXZpc2l0LCBwZW5kaW5nUmVxdWVzdHMsIGN1cnJlbnROb2RlLCBiYXNlU3RyZWFtcywgZm91bmRNaXNzaW5nRGF0YSwgaSwgaWksIHN0cmVhbSwgX2k1LCBfaWkzLCBub2RlOwoKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBub2Rlc1RvUmV2aXNpdCA9IFtdOwogICAgICAgICAgICAgICAgcGVuZGluZ1JlcXVlc3RzID0gW107CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGlmICghbm9kZXNUb1Zpc2l0Lmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDIyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IG5vZGVzVG9WaXNpdC5wb3AoKTsKCiAgICAgICAgICAgICAgICBpZiAoIShjdXJyZW50Tm9kZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczYucmVmU2V0LmhhcyhjdXJyZW50Tm9kZSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgiY29udGludWUiLCAyKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSA3OwoKICAgICAgICAgICAgICAgIF90aGlzNi5yZWZTZXQucHV0KGN1cnJlbnROb2RlKTsKCiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IF90aGlzNi54cmVmLmZldGNoKGN1cnJlbnROb2RlKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMTI7CiAgICAgICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDRbImNhdGNoIl0oNyk7CgogICAgICAgICAgICAgICAgaWYgKF9jb250ZXh0NC50MCBpbnN0YW5jZW9mIF9jb3JlX3V0aWxzLk1pc3NpbmdEYXRhRXhjZXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRocm93IF9jb250ZXh0NC50MDsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIG5vZGVzVG9SZXZpc2l0LnB1c2goY3VycmVudE5vZGUpOwogICAgICAgICAgICAgICAgcGVuZGluZ1JlcXVlc3RzLnB1c2goewogICAgICAgICAgICAgICAgICBiZWdpbjogX2NvbnRleHQ0LnQwLmJlZ2luLAogICAgICAgICAgICAgICAgICBlbmQ6IF9jb250ZXh0NC50MC5lbmQKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnROb2RlICYmIGN1cnJlbnROb2RlLmdldEJhc2VTdHJlYW1zKSB7CiAgICAgICAgICAgICAgICAgIGJhc2VTdHJlYW1zID0gY3VycmVudE5vZGUuZ2V0QmFzZVN0cmVhbXMoKTsKICAgICAgICAgICAgICAgICAgZm91bmRNaXNzaW5nRGF0YSA9IGZhbHNlOwoKICAgICAgICAgICAgICAgICAgZm9yIChpID0gMCwgaWkgPSBiYXNlU3RyZWFtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgc3RyZWFtID0gYmFzZVN0cmVhbXNbaV07CgogICAgICAgICAgICAgICAgICAgIGlmIChzdHJlYW0uYWxsQ2h1bmtzTG9hZGVkICYmICFzdHJlYW0uYWxsQ2h1bmtzTG9hZGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgIGZvdW5kTWlzc2luZ0RhdGEgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1JlcXVlc3RzLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICBiZWdpbjogc3RyZWFtLnN0YXJ0LAogICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IHN0cmVhbS5lbmQKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kTWlzc2luZ0RhdGEpIHsKICAgICAgICAgICAgICAgICAgICBub2Rlc1RvUmV2aXNpdC5wdXNoKGN1cnJlbnROb2RlKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGFkZENoaWxkcmVuKGN1cnJlbnROb2RlLCBub2Rlc1RvVmlzaXQpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgICAgICBpZiAoIXBlbmRpbmdSZXF1ZXN0cy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyNTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczYueHJlZi5zdHJlYW0ubWFuYWdlci5yZXF1ZXN0UmFuZ2VzKHBlbmRpbmdSZXF1ZXN0cyk7CgogICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgICBmb3IgKF9pNSA9IDAsIF9paTMgPSBub2Rlc1RvUmV2aXNpdC5sZW5ndGg7IF9pNSA8IF9paTM7IF9pNSsrKSB7CiAgICAgICAgICAgICAgICAgIG5vZGUgPSBub2Rlc1RvUmV2aXNpdFtfaTVdOwoKICAgICAgICAgICAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczYucmVmU2V0LnJlbW92ZShub2RlKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBfdGhpczYuX3dhbGsobm9kZXNUb1JldmlzaXQpKTsKCiAgICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICAgIF90aGlzNi5yZWZTZXQgPSBudWxsOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHVuZGVmaW5lZCk7CgogICAgICAgICAgICAgIGNhc2UgMjk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIG51bGwsIFtbNywgMTJdXSk7CiAgICAgIH0pKSgpOwogICAgfQogIH07CiAgcmV0dXJuIE9iamVjdExvYWRlcjsKfSgpOwoKZXhwb3J0cy5PYmplY3RMb2FkZXIgPSBPYmplY3RMb2FkZXI7CgovKioqLyB9KSwKLyogMjA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuUGFyc2VyID0gZXhwb3J0cy5MaW5lYXJpemF0aW9uID0gZXhwb3J0cy5MZXhlciA9IHZvaWQgMDsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDUpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCnZhciBfY2NpdHRfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDYpOwoKdmFyIF9qYmlnMl9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwOCk7Cgp2YXIgX2pwZWdfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTEpOwoKdmFyIF9qcHhfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTMpOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCnZhciBNQVhfTEVOR1RIX1RPX0NBQ0hFID0gMTAwMDsKdmFyIE1BWF9BRExFUjMyX0xFTkdUSCA9IDU1NTI7CgpmdW5jdGlvbiBjb21wdXRlQWRsZXIzMihieXRlcykgewogIHZhciBieXRlc0xlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKICB2YXIgYSA9IDEsCiAgICAgIGIgPSAwOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzTGVuZ3RoOyArK2kpIHsKICAgIGEgKz0gYnl0ZXNbaV0gJiAweGZmOwogICAgYiArPSBhOwogIH0KCiAgcmV0dXJuIGIgJSA2NTUyMSA8PCAxNiB8IGEgJSA2NTUyMTsKfQoKdmFyIFBhcnNlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUGFyc2VyKF9yZWYpIHsKICAgIHZhciBsZXhlciA9IF9yZWYubGV4ZXIsCiAgICAgICAgeHJlZiA9IF9yZWYueHJlZiwKICAgICAgICBfcmVmJGFsbG93U3RyZWFtcyA9IF9yZWYuYWxsb3dTdHJlYW1zLAogICAgICAgIGFsbG93U3RyZWFtcyA9IF9yZWYkYWxsb3dTdHJlYW1zID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYkYWxsb3dTdHJlYW1zLAogICAgICAgIF9yZWYkcmVjb3ZlcnlNb2RlID0gX3JlZi5yZWNvdmVyeU1vZGUsCiAgICAgICAgcmVjb3ZlcnlNb2RlID0gX3JlZiRyZWNvdmVyeU1vZGUgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZiRyZWNvdmVyeU1vZGU7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBhcnNlcik7CgogICAgdGhpcy5sZXhlciA9IGxleGVyOwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMuYWxsb3dTdHJlYW1zID0gYWxsb3dTdHJlYW1zOwogICAgdGhpcy5yZWNvdmVyeU1vZGUgPSByZWNvdmVyeU1vZGU7CiAgICB0aGlzLmltYWdlQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5yZWZpbGwoKTsKICB9CgogIF9jcmVhdGVDbGFzcyhQYXJzZXIsIFt7CiAgICBrZXk6ICJyZWZpbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZmlsbCgpIHsKICAgICAgdGhpcy5idWYxID0gdGhpcy5sZXhlci5nZXRPYmooKTsKICAgICAgdGhpcy5idWYyID0gdGhpcy5sZXhlci5nZXRPYmooKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzaGlmdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2hpZnQoKSB7CiAgICAgIGlmICh0aGlzLmJ1ZjIgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5DbWQgJiYgdGhpcy5idWYyLmNtZCA9PT0gIklEIikgewogICAgICAgIHRoaXMuYnVmMSA9IHRoaXMuYnVmMjsKICAgICAgICB0aGlzLmJ1ZjIgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYnVmMSA9IHRoaXMuYnVmMjsKICAgICAgICB0aGlzLmJ1ZjIgPSB0aGlzLmxleGVyLmdldE9iaigpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAidHJ5U2hpZnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRyeVNoaWZ0KCkgewogICAgICB0cnkgewogICAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGlmIChlIGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICAgIHRocm93IGU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRPYmoiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE9iaigpIHsKICAgICAgdmFyIGNpcGhlclRyYW5zZm9ybSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogbnVsbDsKICAgICAgdmFyIGJ1ZjEgPSB0aGlzLmJ1ZjE7CiAgICAgIHRoaXMuc2hpZnQoKTsKCiAgICAgIGlmIChidWYxIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuQ21kKSB7CiAgICAgICAgc3dpdGNoIChidWYxLmNtZCkgewogICAgICAgICAgY2FzZSAiQkkiOgogICAgICAgICAgICByZXR1cm4gdGhpcy5tYWtlSW5saW5lSW1hZ2UoY2lwaGVyVHJhbnNmb3JtKTsKCiAgICAgICAgICBjYXNlICJbIjoKICAgICAgICAgICAgdmFyIGFycmF5ID0gW107CgogICAgICAgICAgICB3aGlsZSAoISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkodGhpcy5idWYxLCAiXSIpICYmICEoMCwgX3ByaW1pdGl2ZXMuaXNFT0YpKHRoaXMuYnVmMSkpIHsKICAgICAgICAgICAgICBhcnJheS5wdXNoKHRoaXMuZ2V0T2JqKGNpcGhlclRyYW5zZm9ybSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRU9GKSh0aGlzLmJ1ZjEpKSB7CiAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlY292ZXJ5TW9kZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJFbmQgb2YgZmlsZSBpbnNpZGUgYXJyYXkiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBhcnJheTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5zaGlmdCgpOwogICAgICAgICAgICByZXR1cm4gYXJyYXk7CgogICAgICAgICAgY2FzZSAiPDwiOgogICAgICAgICAgICB2YXIgZGljdCA9IG5ldyBfcHJpbWl0aXZlcy5EaWN0KHRoaXMueHJlZik7CgogICAgICAgICAgICB3aGlsZSAoISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkodGhpcy5idWYxLCAiPj4iKSAmJiAhKDAsIF9wcmltaXRpdmVzLmlzRU9GKSh0aGlzLmJ1ZjEpKSB7CiAgICAgICAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh0aGlzLmJ1ZjEpKSB7CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoIk1hbGZvcm1lZCBkaWN0aW9uYXJ5OiBrZXkgbXVzdCBiZSBhIG5hbWUgb2JqZWN0Iik7CiAgICAgICAgICAgICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmJ1ZjEubmFtZTsKICAgICAgICAgICAgICB0aGlzLnNoaWZ0KCk7CgogICAgICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNFT0YpKHRoaXMuYnVmMSkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZGljdC5zZXQoa2V5LCB0aGlzLmdldE9iaihjaXBoZXJUcmFuc2Zvcm0pKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0VPRikodGhpcy5idWYxKSkgewogICAgICAgICAgICAgIGlmICghdGhpcy5yZWNvdmVyeU1vZGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiRW5kIG9mIGZpbGUgaW5zaWRlIGRpY3Rpb25hcnkiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBkaWN0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzQ21kKSh0aGlzLmJ1ZjIsICJzdHJlYW0iKSkgewogICAgICAgICAgICAgIHJldHVybiB0aGlzLmFsbG93U3RyZWFtcyA/IHRoaXMubWFrZVN0cmVhbShkaWN0LCBjaXBoZXJUcmFuc2Zvcm0pIDogZGljdDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5zaGlmdCgpOwogICAgICAgICAgICByZXR1cm4gZGljdDsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm4gYnVmMTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKGJ1ZjEpKSB7CiAgICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIodGhpcy5idWYxKSAmJiAoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKHRoaXMuYnVmMiwgIlIiKSkgewogICAgICAgICAgdmFyIHJlZiA9IF9wcmltaXRpdmVzLlJlZi5nZXQoYnVmMSwgdGhpcy5idWYxKTsKCiAgICAgICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgICAgICByZXR1cm4gcmVmOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGJ1ZjE7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgYnVmMSA9PT0gInN0cmluZyIpIHsKICAgICAgICBpZiAoY2lwaGVyVHJhbnNmb3JtKSB7CiAgICAgICAgICByZXR1cm4gY2lwaGVyVHJhbnNmb3JtLmRlY3J5cHRTdHJpbmcoYnVmMSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYnVmMTsKICAgICAgfQoKICAgICAgcmV0dXJuIGJ1ZjE7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmluZERlZmF1bHRJbmxpbmVTdHJlYW1FbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmREZWZhdWx0SW5saW5lU3RyZWFtRW5kKHN0cmVhbSkgewogICAgICB2YXIgRSA9IDB4NDUsCiAgICAgICAgICBJID0gMHg0OSwKICAgICAgICAgIFNQQUNFID0gMHgyMCwKICAgICAgICAgIExGID0gMHhhLAogICAgICAgICAgQ1IgPSAweGQ7CiAgICAgIHZhciBuID0gMTAsCiAgICAgICAgICBOVUwgPSAweDA7CiAgICAgIHZhciBzdGFydFBvcyA9IHN0cmVhbS5wb3M7CiAgICAgIHZhciBzdGF0ZSA9IDAsCiAgICAgICAgICBjaCwKICAgICAgICAgIG1heWJlRUlQb3M7CgogICAgICB3aGlsZSAoKGNoID0gc3RyZWFtLmdldEJ5dGUoKSkgIT09IC0xKSB7CiAgICAgICAgaWYgKHN0YXRlID09PSAwKSB7CiAgICAgICAgICBzdGF0ZSA9IGNoID09PSBFID8gMSA6IDA7CiAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gMSkgewogICAgICAgICAgc3RhdGUgPSBjaCA9PT0gSSA/IDIgOiAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShzdGF0ZSA9PT0gMiwgImZpbmREZWZhdWx0SW5saW5lU3RyZWFtRW5kIC0gaW52YWxpZCBzdGF0ZS4iKTsKCiAgICAgICAgICBpZiAoY2ggPT09IFNQQUNFIHx8IGNoID09PSBMRiB8fCBjaCA9PT0gQ1IpIHsKICAgICAgICAgICAgbWF5YmVFSVBvcyA9IHN0cmVhbS5wb3M7CiAgICAgICAgICAgIHZhciBmb2xsb3dpbmdCeXRlcyA9IHN0cmVhbS5wZWVrQnl0ZXMobik7CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBmb2xsb3dpbmdCeXRlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgICAgY2ggPSBmb2xsb3dpbmdCeXRlc1tpXTsKCiAgICAgICAgICAgICAgaWYgKGNoID09PSBOVUwgJiYgZm9sbG93aW5nQnl0ZXNbaSArIDFdICE9PSBOVUwpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKGNoICE9PSBMRiAmJiBjaCAhPT0gQ1IgJiYgKGNoIDwgU1BBQ0UgfHwgY2ggPiAweDdmKSkgewogICAgICAgICAgICAgICAgc3RhdGUgPSAwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhdGUgPSAwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGNoID09PSAtMSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiZmluZERlZmF1bHRJbmxpbmVTdHJlYW1FbmQ6ICIgKyAiUmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBzdHJlYW0gd2l0aG91dCBmaW5kaW5nIGEgdmFsaWQgRUkgbWFya2VyIik7CgogICAgICAgIGlmIChtYXliZUVJUG9zKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoJy4uLiB0cnlpbmcgdG8gcmVjb3ZlciBieSB1c2luZyB0aGUgbGFzdCAiRUkiIG9jY3VycmVuY2UuJyk7CiAgICAgICAgICBzdHJlYW0uc2tpcCgtKHN0cmVhbS5wb3MgLSBtYXliZUVJUG9zKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZW5kT2Zmc2V0ID0gNDsKICAgICAgc3RyZWFtLnNraXAoLWVuZE9mZnNldCk7CiAgICAgIGNoID0gc3RyZWFtLnBlZWtCeXRlKCk7CiAgICAgIHN0cmVhbS5za2lwKGVuZE9mZnNldCk7CgogICAgICBpZiAoISgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGNoKSkgewogICAgICAgIGVuZE9mZnNldC0tOwogICAgICB9CgogICAgICByZXR1cm4gc3RyZWFtLnBvcyAtIGVuZE9mZnNldCAtIHN0YXJ0UG9zOwogICAgfQogIH0sIHsKICAgIGtleTogImZpbmREQ1REZWNvZGVJbmxpbmVTdHJlYW1FbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmREQ1REZWNvZGVJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKSB7CiAgICAgIHZhciBzdGFydFBvcyA9IHN0cmVhbS5wb3M7CiAgICAgIHZhciBmb3VuZEVPSSA9IGZhbHNlLAogICAgICAgICAgYiwKICAgICAgICAgIG1hcmtlckxlbmd0aDsKCiAgICAgIHdoaWxlICgoYiA9IHN0cmVhbS5nZXRCeXRlKCkpICE9PSAtMSkgewogICAgICAgIGlmIChiICE9PSAweGZmKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHN3aXRjaCAoc3RyZWFtLmdldEJ5dGUoKSkgewogICAgICAgICAgY2FzZSAweDAwOgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4ZmY6CiAgICAgICAgICAgIHN0cmVhbS5za2lwKC0xKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGQ5OgogICAgICAgICAgICBmb3VuZEVPSSA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhjMDoKICAgICAgICAgIGNhc2UgMHhjMToKICAgICAgICAgIGNhc2UgMHhjMjoKICAgICAgICAgIGNhc2UgMHhjMzoKICAgICAgICAgIGNhc2UgMHhjNToKICAgICAgICAgIGNhc2UgMHhjNjoKICAgICAgICAgIGNhc2UgMHhjNzoKICAgICAgICAgIGNhc2UgMHhjOToKICAgICAgICAgIGNhc2UgMHhjYToKICAgICAgICAgIGNhc2UgMHhjYjoKICAgICAgICAgIGNhc2UgMHhjZDoKICAgICAgICAgIGNhc2UgMHhjZToKICAgICAgICAgIGNhc2UgMHhjZjoKICAgICAgICAgIGNhc2UgMHhjNDoKICAgICAgICAgIGNhc2UgMHhjYzoKICAgICAgICAgIGNhc2UgMHhkYToKICAgICAgICAgIGNhc2UgMHhkYjoKICAgICAgICAgIGNhc2UgMHhkYzoKICAgICAgICAgIGNhc2UgMHhkZDoKICAgICAgICAgIGNhc2UgMHhkZToKICAgICAgICAgIGNhc2UgMHhkZjoKICAgICAgICAgIGNhc2UgMHhlMDoKICAgICAgICAgIGNhc2UgMHhlMToKICAgICAgICAgIGNhc2UgMHhlMjoKICAgICAgICAgIGNhc2UgMHhlMzoKICAgICAgICAgIGNhc2UgMHhlNDoKICAgICAgICAgIGNhc2UgMHhlNToKICAgICAgICAgIGNhc2UgMHhlNjoKICAgICAgICAgIGNhc2UgMHhlNzoKICAgICAgICAgIGNhc2UgMHhlODoKICAgICAgICAgIGNhc2UgMHhlOToKICAgICAgICAgIGNhc2UgMHhlYToKICAgICAgICAgIGNhc2UgMHhlYjoKICAgICAgICAgIGNhc2UgMHhlYzoKICAgICAgICAgIGNhc2UgMHhlZDoKICAgICAgICAgIGNhc2UgMHhlZToKICAgICAgICAgIGNhc2UgMHhlZjoKICAgICAgICAgIGNhc2UgMHhmZToKICAgICAgICAgICAgbWFya2VyTGVuZ3RoID0gc3RyZWFtLmdldFVpbnQxNigpOwoKICAgICAgICAgICAgaWYgKG1hcmtlckxlbmd0aCA+IDIpIHsKICAgICAgICAgICAgICBzdHJlYW0uc2tpcChtYXJrZXJMZW5ndGggLSAyKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzdHJlYW0uc2tpcCgtMik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKGZvdW5kRU9JKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBsZW5ndGggPSBzdHJlYW0ucG9zIC0gc3RhcnRQb3M7CgogICAgICBpZiAoYiA9PT0gLTEpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIklubGluZSBEQ1REZWNvZGUgaW1hZ2Ugc3RyZWFtOiAiICsgIkVPSSBtYXJrZXIgbm90IGZvdW5kLCBzZWFyY2hpbmcgZm9yIC9FSS8gaW5zdGVhZC4iKTsKICAgICAgICBzdHJlYW0uc2tpcCgtbGVuZ3RoKTsKICAgICAgICByZXR1cm4gdGhpcy5maW5kRGVmYXVsdElubGluZVN0cmVhbUVuZChzdHJlYW0pOwogICAgICB9CgogICAgICB0aGlzLmlubGluZVN0cmVhbVNraXBFSShzdHJlYW0pOwogICAgICByZXR1cm4gbGVuZ3RoOwogICAgfQogIH0sIHsKICAgIGtleTogImZpbmRBU0NJSTg1RGVjb2RlSW5saW5lU3RyZWFtRW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kQVNDSUk4NURlY29kZUlubGluZVN0cmVhbUVuZChzdHJlYW0pIHsKICAgICAgdmFyIFRJTERFID0gMHg3ZSwKICAgICAgICAgIEdUID0gMHgzZTsKICAgICAgdmFyIHN0YXJ0UG9zID0gc3RyZWFtLnBvczsKICAgICAgdmFyIGNoOwoKICAgICAgd2hpbGUgKChjaCA9IHN0cmVhbS5nZXRCeXRlKCkpICE9PSAtMSkgewogICAgICAgIGlmIChjaCA9PT0gVElMREUpIHsKICAgICAgICAgIHZhciB0aWxkZVBvcyA9IHN0cmVhbS5wb3M7CiAgICAgICAgICBjaCA9IHN0cmVhbS5wZWVrQnl0ZSgpOwoKICAgICAgICAgIHdoaWxlICgoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpIHsKICAgICAgICAgICAgc3RyZWFtLnNraXAoKTsKICAgICAgICAgICAgY2ggPSBzdHJlYW0ucGVla0J5dGUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY2ggPT09IEdUKSB7CiAgICAgICAgICAgIHN0cmVhbS5za2lwKCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChzdHJlYW0ucG9zID4gdGlsZGVQb3MpIHsKICAgICAgICAgICAgdmFyIG1heWJlRUkgPSBzdHJlYW0ucGVla0J5dGVzKDIpOwoKICAgICAgICAgICAgaWYgKG1heWJlRUlbMF0gPT09IDB4NDUgJiYgbWF5YmVFSVsxXSA9PT0gMHg0OSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgbGVuZ3RoID0gc3RyZWFtLnBvcyAtIHN0YXJ0UG9zOwoKICAgICAgaWYgKGNoID09PSAtMSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW5saW5lIEFTQ0lJODVEZWNvZGUgaW1hZ2Ugc3RyZWFtOiAiICsgIkVPRCBtYXJrZXIgbm90IGZvdW5kLCBzZWFyY2hpbmcgZm9yIC9FSS8gaW5zdGVhZC4iKTsKICAgICAgICBzdHJlYW0uc2tpcCgtbGVuZ3RoKTsKICAgICAgICByZXR1cm4gdGhpcy5maW5kRGVmYXVsdElubGluZVN0cmVhbUVuZChzdHJlYW0pOwogICAgICB9CgogICAgICB0aGlzLmlubGluZVN0cmVhbVNraXBFSShzdHJlYW0pOwogICAgICByZXR1cm4gbGVuZ3RoOwogICAgfQogIH0sIHsKICAgIGtleTogImZpbmRBU0NJSUhleERlY29kZUlubGluZVN0cmVhbUVuZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEFTQ0lJSGV4RGVjb2RlSW5saW5lU3RyZWFtRW5kKHN0cmVhbSkgewogICAgICB2YXIgR1QgPSAweDNlOwogICAgICB2YXIgc3RhcnRQb3MgPSBzdHJlYW0ucG9zOwogICAgICB2YXIgY2g7CgogICAgICB3aGlsZSAoKGNoID0gc3RyZWFtLmdldEJ5dGUoKSkgIT09IC0xKSB7CiAgICAgICAgaWYgKGNoID09PSBHVCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgbGVuZ3RoID0gc3RyZWFtLnBvcyAtIHN0YXJ0UG9zOwoKICAgICAgaWYgKGNoID09PSAtMSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW5saW5lIEFTQ0lJSGV4RGVjb2RlIGltYWdlIHN0cmVhbTogIiArICJFT0QgbWFya2VyIG5vdCBmb3VuZCwgc2VhcmNoaW5nIGZvciAvRUkvIGluc3RlYWQuIik7CiAgICAgICAgc3RyZWFtLnNraXAoLWxlbmd0aCk7CiAgICAgICAgcmV0dXJuIHRoaXMuZmluZERlZmF1bHRJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKTsKICAgICAgfQoKICAgICAgdGhpcy5pbmxpbmVTdHJlYW1Ta2lwRUkoc3RyZWFtKTsKICAgICAgcmV0dXJuIGxlbmd0aDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbmxpbmVTdHJlYW1Ta2lwRUkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlubGluZVN0cmVhbVNraXBFSShzdHJlYW0pIHsKICAgICAgdmFyIEUgPSAweDQ1LAogICAgICAgICAgSSA9IDB4NDk7CiAgICAgIHZhciBzdGF0ZSA9IDAsCiAgICAgICAgICBjaDsKCiAgICAgIHdoaWxlICgoY2ggPSBzdHJlYW0uZ2V0Qnl0ZSgpKSAhPT0gLTEpIHsKICAgICAgICBpZiAoc3RhdGUgPT09IDApIHsKICAgICAgICAgIHN0YXRlID0gY2ggPT09IEUgPyAxIDogMDsKICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAxKSB7CiAgICAgICAgICBzdGF0ZSA9IGNoID09PSBJID8gMiA6IDA7CiAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gMikgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZUlubGluZUltYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYWtlSW5saW5lSW1hZ2UoY2lwaGVyVHJhbnNmb3JtKSB7CiAgICAgIHZhciBsZXhlciA9IHRoaXMubGV4ZXI7CiAgICAgIHZhciBzdHJlYW0gPSBsZXhlci5zdHJlYW07CiAgICAgIHZhciBkaWN0ID0gbmV3IF9wcmltaXRpdmVzLkRpY3QodGhpcy54cmVmKTsKICAgICAgdmFyIGRpY3RMZW5ndGg7CgogICAgICB3aGlsZSAoISgwLCBfcHJpbWl0aXZlcy5pc0NtZCkodGhpcy5idWYxLCAiSUQiKSAmJiAhKDAsIF9wcmltaXRpdmVzLmlzRU9GKSh0aGlzLmJ1ZjEpKSB7CiAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh0aGlzLmJ1ZjEpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkRpY3Rpb25hcnkga2V5IG11c3QgYmUgYSBuYW1lIG9iamVjdCIpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGtleSA9IHRoaXMuYnVmMS5uYW1lOwogICAgICAgIHRoaXMuc2hpZnQoKTsKCiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0VPRikodGhpcy5idWYxKSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBkaWN0LnNldChrZXksIHRoaXMuZ2V0T2JqKGNpcGhlclRyYW5zZm9ybSkpOwogICAgICB9CgogICAgICBpZiAobGV4ZXIuYmVnaW5JbmxpbmVJbWFnZVBvcyAhPT0gLTEpIHsKICAgICAgICBkaWN0TGVuZ3RoID0gc3RyZWFtLnBvcyAtIGxleGVyLmJlZ2luSW5saW5lSW1hZ2VQb3M7CiAgICAgIH0KCiAgICAgIHZhciBmaWx0ZXIgPSBkaWN0LmdldCgiRmlsdGVyIiwgIkYiKTsKICAgICAgdmFyIGZpbHRlck5hbWU7CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZmlsdGVyKSkgewogICAgICAgIGZpbHRlck5hbWUgPSBmaWx0ZXIubmFtZTsKICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGZpbHRlcikpIHsKICAgICAgICB2YXIgZmlsdGVyWmVybyA9IHRoaXMueHJlZi5mZXRjaElmUmVmKGZpbHRlclswXSk7CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShmaWx0ZXJaZXJvKSkgewogICAgICAgICAgZmlsdGVyTmFtZSA9IGZpbHRlclplcm8ubmFtZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBzdGFydFBvcyA9IHN0cmVhbS5wb3M7CiAgICAgIHZhciBsZW5ndGg7CgogICAgICBpZiAoZmlsdGVyTmFtZSA9PT0gIkRDVERlY29kZSIgfHwgZmlsdGVyTmFtZSA9PT0gIkRDVCIpIHsKICAgICAgICBsZW5ndGggPSB0aGlzLmZpbmREQ1REZWNvZGVJbmxpbmVTdHJlYW1FbmQoc3RyZWFtKTsKICAgICAgfSBlbHNlIGlmIChmaWx0ZXJOYW1lID09PSAiQVNDSUk4NURlY29kZSIgfHwgZmlsdGVyTmFtZSA9PT0gIkE4NSIpIHsKICAgICAgICBsZW5ndGggPSB0aGlzLmZpbmRBU0NJSTg1RGVjb2RlSW5saW5lU3RyZWFtRW5kKHN0cmVhbSk7CiAgICAgIH0gZWxzZSBpZiAoZmlsdGVyTmFtZSA9PT0gIkFTQ0lJSGV4RGVjb2RlIiB8fCBmaWx0ZXJOYW1lID09PSAiQUh4IikgewogICAgICAgIGxlbmd0aCA9IHRoaXMuZmluZEFTQ0lJSGV4RGVjb2RlSW5saW5lU3RyZWFtRW5kKHN0cmVhbSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGVuZ3RoID0gdGhpcy5maW5kRGVmYXVsdElubGluZVN0cmVhbUVuZChzdHJlYW0pOwogICAgICB9CgogICAgICB2YXIgaW1hZ2VTdHJlYW0gPSBzdHJlYW0ubWFrZVN1YlN0cmVhbShzdGFydFBvcywgbGVuZ3RoLCBkaWN0KTsKICAgICAgdmFyIGNhY2hlS2V5OwoKICAgICAgaWYgKGxlbmd0aCA8IE1BWF9MRU5HVEhfVE9fQ0FDSEUgJiYgZGljdExlbmd0aCA8IE1BWF9BRExFUjMyX0xFTkdUSCkgewogICAgICAgIHZhciBpbWFnZUJ5dGVzID0gaW1hZ2VTdHJlYW0uZ2V0Qnl0ZXMoKTsKICAgICAgICBpbWFnZVN0cmVhbS5yZXNldCgpOwogICAgICAgIHZhciBpbml0aWFsU3RyZWFtUG9zID0gc3RyZWFtLnBvczsKICAgICAgICBzdHJlYW0ucG9zID0gbGV4ZXIuYmVnaW5JbmxpbmVJbWFnZVBvczsKICAgICAgICB2YXIgZGljdEJ5dGVzID0gc3RyZWFtLmdldEJ5dGVzKGRpY3RMZW5ndGgpOwogICAgICAgIHN0cmVhbS5wb3MgPSBpbml0aWFsU3RyZWFtUG9zOwogICAgICAgIGNhY2hlS2V5ID0gY29tcHV0ZUFkbGVyMzIoaW1hZ2VCeXRlcykgKyAiXyIgKyBjb21wdXRlQWRsZXIzMihkaWN0Qnl0ZXMpOwogICAgICAgIHZhciBjYWNoZUVudHJ5ID0gdGhpcy5pbWFnZUNhY2hlW2NhY2hlS2V5XTsKCiAgICAgICAgaWYgKGNhY2hlRW50cnkgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy5idWYyID0gX3ByaW1pdGl2ZXMuQ21kLmdldCgiRUkiKTsKICAgICAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgICAgIGNhY2hlRW50cnkucmVzZXQoKTsKICAgICAgICAgIHJldHVybiBjYWNoZUVudHJ5OwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGNpcGhlclRyYW5zZm9ybSkgewogICAgICAgIGltYWdlU3RyZWFtID0gY2lwaGVyVHJhbnNmb3JtLmNyZWF0ZVN0cmVhbShpbWFnZVN0cmVhbSwgbGVuZ3RoKTsKICAgICAgfQoKICAgICAgaW1hZ2VTdHJlYW0gPSB0aGlzLmZpbHRlcihpbWFnZVN0cmVhbSwgZGljdCwgbGVuZ3RoKTsKICAgICAgaW1hZ2VTdHJlYW0uZGljdCA9IGRpY3Q7CgogICAgICBpZiAoY2FjaGVLZXkgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGltYWdlU3RyZWFtLmNhY2hlS2V5ID0gImlubGluZV8iLmNvbmNhdChsZW5ndGgsICJfIikuY29uY2F0KGNhY2hlS2V5KTsKICAgICAgICB0aGlzLmltYWdlQ2FjaGVbY2FjaGVLZXldID0gaW1hZ2VTdHJlYW07CiAgICAgIH0KCiAgICAgIHRoaXMuYnVmMiA9IF9wcmltaXRpdmVzLkNtZC5nZXQoIkVJIik7CiAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgcmV0dXJuIGltYWdlU3RyZWFtOwogICAgfQogIH0sIHsKICAgIGtleTogIl9maW5kU3RyZWFtTGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZFN0cmVhbUxlbmd0aChzdGFydFBvcywgc2lnbmF0dXJlKSB7CiAgICAgIHZhciBzdHJlYW0gPSB0aGlzLmxleGVyLnN0cmVhbTsKICAgICAgc3RyZWFtLnBvcyA9IHN0YXJ0UG9zOwogICAgICB2YXIgU0NBTl9CTE9DS19MRU5HVEggPSAyMDQ4OwogICAgICB2YXIgc2lnbmF0dXJlTGVuZ3RoID0gc2lnbmF0dXJlLmxlbmd0aDsKCiAgICAgIHdoaWxlIChzdHJlYW0ucG9zIDwgc3RyZWFtLmVuZCkgewogICAgICAgIHZhciBzY2FuQnl0ZXMgPSBzdHJlYW0ucGVla0J5dGVzKFNDQU5fQkxPQ0tfTEVOR1RIKTsKICAgICAgICB2YXIgc2Nhbkxlbmd0aCA9IHNjYW5CeXRlcy5sZW5ndGggLSBzaWduYXR1cmVMZW5ndGg7CgogICAgICAgIGlmIChzY2FuTGVuZ3RoIDw9IDApIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgdmFyIHBvcyA9IDA7CgogICAgICAgIHdoaWxlIChwb3MgPCBzY2FuTGVuZ3RoKSB7CiAgICAgICAgICB2YXIgaiA9IDA7CgogICAgICAgICAgd2hpbGUgKGogPCBzaWduYXR1cmVMZW5ndGggJiYgc2NhbkJ5dGVzW3BvcyArIGpdID09PSBzaWduYXR1cmVbal0pIHsKICAgICAgICAgICAgaisrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChqID49IHNpZ25hdHVyZUxlbmd0aCkgewogICAgICAgICAgICBzdHJlYW0ucG9zICs9IHBvczsKICAgICAgICAgICAgcmV0dXJuIHN0cmVhbS5wb3MgLSBzdGFydFBvczsKICAgICAgICAgIH0KCiAgICAgICAgICBwb3MrKzsKICAgICAgICB9CgogICAgICAgIHN0cmVhbS5wb3MgKz0gc2Nhbkxlbmd0aDsKICAgICAgfQoKICAgICAgcmV0dXJuIC0xOwogICAgfQogIH0sIHsKICAgIGtleTogIm1ha2VTdHJlYW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1ha2VTdHJlYW0oZGljdCwgY2lwaGVyVHJhbnNmb3JtKSB7CiAgICAgIHZhciBsZXhlciA9IHRoaXMubGV4ZXI7CiAgICAgIHZhciBzdHJlYW0gPSBsZXhlci5zdHJlYW07CiAgICAgIGxleGVyLnNraXBUb05leHRMaW5lKCk7CiAgICAgIHZhciBzdGFydFBvcyA9IHN0cmVhbS5wb3MgLSAxOwogICAgICB2YXIgbGVuZ3RoID0gZGljdC5nZXQoIkxlbmd0aCIpOwoKICAgICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGxlbmd0aCkpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkJhZCBsZW5ndGggXCIiLmNvbmNhdChsZW5ndGgsICJcIiBpbiBzdHJlYW0iKSk7CiAgICAgICAgbGVuZ3RoID0gMDsKICAgICAgfQoKICAgICAgc3RyZWFtLnBvcyA9IHN0YXJ0UG9zICsgbGVuZ3RoOwogICAgICBsZXhlci5uZXh0Q2hhcigpOwoKICAgICAgaWYgKHRoaXMudHJ5U2hpZnQoKSAmJiAoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKHRoaXMuYnVmMiwgImVuZHN0cmVhbSIpKSB7CiAgICAgICAgdGhpcy5zaGlmdCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBFTkRTVFJFQU1fU0lHTkFUVVJFID0gbmV3IFVpbnQ4QXJyYXkoWzB4NjUsIDB4NkUsIDB4NjQsIDB4NzMsIDB4NzQsIDB4NzIsIDB4NjUsIDB4NjEsIDB4NkRdKTsKCiAgICAgICAgdmFyIGFjdHVhbExlbmd0aCA9IHRoaXMuX2ZpbmRTdHJlYW1MZW5ndGgoc3RhcnRQb3MsIEVORFNUUkVBTV9TSUdOQVRVUkUpOwoKICAgICAgICBpZiAoYWN0dWFsTGVuZ3RoIDwgMCkgewogICAgICAgICAgdmFyIE1BWF9UUlVOQ0FUSU9OID0gMTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBNQVhfVFJVTkNBVElPTjsgaSsrKSB7CiAgICAgICAgICAgIHZhciBlbmQgPSBFTkRTVFJFQU1fU0lHTkFUVVJFLmxlbmd0aCAtIGk7CiAgICAgICAgICAgIHZhciBUUlVOQ0FURURfU0lHTkFUVVJFID0gRU5EU1RSRUFNX1NJR05BVFVSRS5zbGljZSgwLCBlbmQpOwoKICAgICAgICAgICAgdmFyIG1heWJlTGVuZ3RoID0gdGhpcy5fZmluZFN0cmVhbUxlbmd0aChzdGFydFBvcywgVFJVTkNBVEVEX1NJR05BVFVSRSk7CgogICAgICAgICAgICBpZiAobWF5YmVMZW5ndGggPj0gMCkgewogICAgICAgICAgICAgIHZhciBsYXN0Qnl0ZSA9IHN0cmVhbS5wZWVrQnl0ZXMoZW5kICsgMSlbZW5kXTsKCiAgICAgICAgICAgICAgaWYgKCEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShsYXN0Qnl0ZSkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJGb3VuZCBcIiIuY29uY2F0KCgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShUUlVOQ0FURURfU0lHTkFUVVJFKSwgIlwiIHdoZW4gIikgKyAic2VhcmNoaW5nIGZvciBlbmRzdHJlYW0gY29tbWFuZC4iKTsKICAgICAgICAgICAgICBhY3R1YWxMZW5ndGggPSBtYXliZUxlbmd0aDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChhY3R1YWxMZW5ndGggPCAwKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTWlzc2luZyBlbmRzdHJlYW0gY29tbWFuZC4iKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGxlbmd0aCA9IGFjdHVhbExlbmd0aDsKICAgICAgICBsZXhlci5uZXh0Q2hhcigpOwogICAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgICB0aGlzLnNoaWZ0KCk7CiAgICAgIH0KCiAgICAgIHRoaXMuc2hpZnQoKTsKICAgICAgc3RyZWFtID0gc3RyZWFtLm1ha2VTdWJTdHJlYW0oc3RhcnRQb3MsIGxlbmd0aCwgZGljdCk7CgogICAgICBpZiAoY2lwaGVyVHJhbnNmb3JtKSB7CiAgICAgICAgc3RyZWFtID0gY2lwaGVyVHJhbnNmb3JtLmNyZWF0ZVN0cmVhbShzdHJlYW0sIGxlbmd0aCk7CiAgICAgIH0KCiAgICAgIHN0cmVhbSA9IHRoaXMuZmlsdGVyKHN0cmVhbSwgZGljdCwgbGVuZ3RoKTsKICAgICAgc3RyZWFtLmRpY3QgPSBkaWN0OwogICAgICByZXR1cm4gc3RyZWFtOwogICAgfQogIH0sIHsKICAgIGtleTogImZpbHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmlsdGVyKHN0cmVhbSwgZGljdCwgbGVuZ3RoKSB7CiAgICAgIHZhciBmaWx0ZXIgPSBkaWN0LmdldCgiRmlsdGVyIiwgIkYiKTsKICAgICAgdmFyIHBhcmFtcyA9IGRpY3QuZ2V0KCJEZWNvZGVQYXJtcyIsICJEUCIpOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGZpbHRlcikpIHsKICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJhbXMpKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIi9EZWNvZGVQYXJtcyBzaG91bGQgbm90IGNvbnRhaW4gYW4gQXJyYXksICIgKyAid2hlbiAvRmlsdGVyIGNvbnRhaW5zIGEgTmFtZS4iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzLm1ha2VGaWx0ZXIoc3RyZWFtLCBmaWx0ZXIubmFtZSwgbGVuZ3RoLCBwYXJhbXMpOwogICAgICB9CgogICAgICB2YXIgbWF5YmVMZW5ndGggPSBsZW5ndGg7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXIpKSB7CiAgICAgICAgdmFyIGZpbHRlckFycmF5ID0gZmlsdGVyOwogICAgICAgIHZhciBwYXJhbXNBcnJheSA9IHBhcmFtczsKCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gZmlsdGVyQXJyYXkubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICAgICAgZmlsdGVyID0gdGhpcy54cmVmLmZldGNoSWZSZWYoZmlsdGVyQXJyYXlbaV0pOwoKICAgICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZmlsdGVyKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkJhZCBmaWx0ZXIgbmFtZSBcIiIuY29uY2F0KGZpbHRlciwgIlwiIikpOwogICAgICAgICAgfQoKICAgICAgICAgIHBhcmFtcyA9IG51bGw7CgogICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyYW1zQXJyYXkpICYmIGkgaW4gcGFyYW1zQXJyYXkpIHsKICAgICAgICAgICAgcGFyYW1zID0gdGhpcy54cmVmLmZldGNoSWZSZWYocGFyYW1zQXJyYXlbaV0pOwogICAgICAgICAgfQoKICAgICAgICAgIHN0cmVhbSA9IHRoaXMubWFrZUZpbHRlcihzdHJlYW0sIGZpbHRlci5uYW1lLCBtYXliZUxlbmd0aCwgcGFyYW1zKTsKICAgICAgICAgIG1heWJlTGVuZ3RoID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBzdHJlYW07CiAgICB9CiAgfSwgewogICAga2V5OiAibWFrZUZpbHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZUZpbHRlcihzdHJlYW0sIG5hbWUsIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgICAgaWYgKG1heWJlTGVuZ3RoID09PSAwKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJFbXB0eSBcIiIuY29uY2F0KG5hbWUsICJcIiBzdHJlYW0uIikpOwogICAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5OdWxsU3RyZWFtKCk7CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgdmFyIHhyZWZTdHJlYW1TdGF0cyA9IHRoaXMueHJlZi5zdGF0cy5zdHJlYW1UeXBlczsKCiAgICAgICAgaWYgKG5hbWUgPT09ICJGbGF0ZURlY29kZSIgfHwgbmFtZSA9PT0gIkZsIikgewogICAgICAgICAgeHJlZlN0cmVhbVN0YXRzW191dGlsLlN0cmVhbVR5cGUuRkxBVEVdID0gdHJ1ZTsKCiAgICAgICAgICBpZiAocGFyYW1zKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5QcmVkaWN0b3JTdHJlYW0obmV3IF9zdHJlYW0uRmxhdGVTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCksIG1heWJlTGVuZ3RoLCBwYXJhbXMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5GbGF0ZVN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoKTsKICAgICAgICB9CgogICAgICAgIGlmIChuYW1lID09PSAiTFpXRGVjb2RlIiB8fCBuYW1lID09PSAiTFpXIikgewogICAgICAgICAgeHJlZlN0cmVhbVN0YXRzW191dGlsLlN0cmVhbVR5cGUuTFpXXSA9IHRydWU7CiAgICAgICAgICB2YXIgZWFybHlDaGFuZ2UgPSAxOwoKICAgICAgICAgIGlmIChwYXJhbXMpIHsKICAgICAgICAgICAgaWYgKHBhcmFtcy5oYXMoIkVhcmx5Q2hhbmdlIikpIHsKICAgICAgICAgICAgICBlYXJseUNoYW5nZSA9IHBhcmFtcy5nZXQoIkVhcmx5Q2hhbmdlIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5QcmVkaWN0b3JTdHJlYW0obmV3IF9zdHJlYW0uTFpXU3RyZWFtKHN0cmVhbSwgbWF5YmVMZW5ndGgsIGVhcmx5Q2hhbmdlKSwgbWF5YmVMZW5ndGgsIHBhcmFtcyk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG5ldyBfc3RyZWFtLkxaV1N0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBlYXJseUNoYW5nZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAobmFtZSA9PT0gIkRDVERlY29kZSIgfHwgbmFtZSA9PT0gIkRDVCIpIHsKICAgICAgICAgIHhyZWZTdHJlYW1TdGF0c1tfdXRpbC5TdHJlYW1UeXBlLkRDVF0gPSB0cnVlOwogICAgICAgICAgcmV0dXJuIG5ldyBfanBlZ19zdHJlYW0uSnBlZ1N0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBzdHJlYW0uZGljdCwgcGFyYW1zKTsKICAgICAgICB9CgogICAgICAgIGlmIChuYW1lID09PSAiSlBYRGVjb2RlIiB8fCBuYW1lID09PSAiSlBYIikgewogICAgICAgICAgeHJlZlN0cmVhbVN0YXRzW191dGlsLlN0cmVhbVR5cGUuSlBYXSA9IHRydWU7CiAgICAgICAgICByZXR1cm4gbmV3IF9qcHhfc3RyZWFtLkpweFN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBzdHJlYW0uZGljdCwgcGFyYW1zKTsKICAgICAgICB9CgogICAgICAgIGlmIChuYW1lID09PSAiQVNDSUk4NURlY29kZSIgfHwgbmFtZSA9PT0gIkE4NSIpIHsKICAgICAgICAgIHhyZWZTdHJlYW1TdGF0c1tfdXRpbC5TdHJlYW1UeXBlLkE4NV0gPSB0cnVlOwogICAgICAgICAgcmV0dXJuIG5ldyBfc3RyZWFtLkFzY2lpODVTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobmFtZSA9PT0gIkFTQ0lJSGV4RGVjb2RlIiB8fCBuYW1lID09PSAiQUh4IikgewogICAgICAgICAgeHJlZlN0cmVhbVN0YXRzW191dGlsLlN0cmVhbVR5cGUuQUhYXSA9IHRydWU7CiAgICAgICAgICByZXR1cm4gbmV3IF9zdHJlYW0uQXNjaWlIZXhTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobmFtZSA9PT0gIkNDSVRURmF4RGVjb2RlIiB8fCBuYW1lID09PSAiQ0NGIikgewogICAgICAgICAgeHJlZlN0cmVhbVN0YXRzW191dGlsLlN0cmVhbVR5cGUuQ0NGXSA9IHRydWU7CiAgICAgICAgICByZXR1cm4gbmV3IF9jY2l0dF9zdHJlYW0uQ0NJVFRGYXhTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCwgcGFyYW1zKTsKICAgICAgICB9CgogICAgICAgIGlmIChuYW1lID09PSAiUnVuTGVuZ3RoRGVjb2RlIiB8fCBuYW1lID09PSAiUkwiKSB7CiAgICAgICAgICB4cmVmU3RyZWFtU3RhdHNbX3V0aWwuU3RyZWFtVHlwZS5STFhdID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiBuZXcgX3N0cmVhbS5SdW5MZW5ndGhTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobmFtZSA9PT0gIkpCSUcyRGVjb2RlIikgewogICAgICAgICAgeHJlZlN0cmVhbVN0YXRzW191dGlsLlN0cmVhbVR5cGUuSkJJR10gPSB0cnVlOwogICAgICAgICAgcmV0dXJuIG5ldyBfamJpZzJfc3RyZWFtLkpiaWcyU3RyZWFtKHN0cmVhbSwgbWF5YmVMZW5ndGgsIHN0cmVhbS5kaWN0LCBwYXJhbXMpOwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJGaWx0ZXIgXCIiLmNvbmNhdChuYW1lLCAiXCIgaXMgbm90IHN1cHBvcnRlZC4iKSk7CiAgICAgICAgcmV0dXJuIHN0cmVhbTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgc3RyZWFtOiBcIiIuY29uY2F0KGV4LCAiXCIiKSk7CiAgICAgICAgcmV0dXJuIG5ldyBfc3RyZWFtLk51bGxTdHJlYW0oKTsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIFBhcnNlcjsKfSgpOwoKZXhwb3J0cy5QYXJzZXIgPSBQYXJzZXI7CnZhciBzcGVjaWFsQ2hhcnMgPSBbMSwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMSwgMSwgMCwgMSwgMSwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMSwgMCwgMCwgMCwgMCwgMiwgMCwgMCwgMiwgMiwgMCwgMCwgMCwgMCwgMCwgMiwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMiwgMCwgMiwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMiwgMCwgMiwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMiwgMCwgMiwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF07CgpmdW5jdGlvbiB0b0hleERpZ2l0KGNoKSB7CiAgaWYgKGNoID49IDB4MzAgJiYgY2ggPD0gMHgzOSkgewogICAgcmV0dXJuIGNoICYgMHgwZjsKICB9CgogIGlmIChjaCA+PSAweDQxICYmIGNoIDw9IDB4NDYgfHwgY2ggPj0gMHg2MSAmJiBjaCA8PSAweDY2KSB7CiAgICByZXR1cm4gKGNoICYgMHgwZikgKyA5OwogIH0KCiAgcmV0dXJuIC0xOwp9Cgp2YXIgTGV4ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIExleGVyKHN0cmVhbSkgewogICAgdmFyIGtub3duQ29tbWFuZHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG51bGw7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExleGVyKTsKCiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMubmV4dENoYXIoKTsKICAgIHRoaXMuc3RyQnVmID0gW107CiAgICB0aGlzLmtub3duQ29tbWFuZHMgPSBrbm93bkNvbW1hbmRzOwogICAgdGhpcy5faGV4U3RyaW5nTnVtV2FybiA9IDA7CiAgICB0aGlzLmJlZ2luSW5saW5lSW1hZ2VQb3MgPSAtMTsKICB9CgogIF9jcmVhdGVDbGFzcyhMZXhlciwgW3sKICAgIGtleTogIm5leHRDaGFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBuZXh0Q2hhcigpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudENoYXIgPSB0aGlzLnN0cmVhbS5nZXRCeXRlKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicGVla0NoYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBlZWtDaGFyKCkgewogICAgICByZXR1cm4gdGhpcy5zdHJlYW0ucGVla0J5dGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXROdW1iZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE51bWJlcigpIHsKICAgICAgdmFyIGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKICAgICAgdmFyIGVOb3RhdGlvbiA9IGZhbHNlOwogICAgICB2YXIgZGl2aWRlQnkgPSAwOwogICAgICB2YXIgc2lnbiA9IDA7CgogICAgICBpZiAoY2ggPT09IDB4MmQpIHsKICAgICAgICBzaWduID0gLTE7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CgogICAgICAgIGlmIChjaCA9PT0gMHgyZCkgewogICAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGNoID09PSAweDJiKSB7CiAgICAgICAgc2lnbiA9IDE7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgIH0KCiAgICAgIGlmIChjaCA9PT0gMHgwYSB8fCBjaCA9PT0gMHgwZCkgewogICAgICAgIGRvIHsKICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgIH0gd2hpbGUgKGNoID09PSAweDBhIHx8IGNoID09PSAweDBkKTsKICAgICAgfQoKICAgICAgaWYgKGNoID09PSAweDJlKSB7CiAgICAgICAgZGl2aWRlQnkgPSAxMDsKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgfQoKICAgICAgaWYgKGNoIDwgMHgzMCB8fCBjaCA+IDB4MzkpIHsKICAgICAgICBpZiAoZGl2aWRlQnkgPT09IDEwICYmIHNpZ24gPT09IDAgJiYgKCgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGNoKSB8fCBjaCA9PT0gLTEpKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkxleGVyLmdldE51bWJlciAtIHRyZWF0aW5nIGEgc2luZ2xlIGRlY2ltYWwgcG9pbnQgYXMgemVyby4iKTsKICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIG51bWJlcjogIi5jb25jYXQoU3RyaW5nLmZyb21DaGFyQ29kZShjaCksICIgKGNoYXJDb2RlICIpLmNvbmNhdChjaCwgIikiKSk7CiAgICAgIH0KCiAgICAgIHNpZ24gPSBzaWduIHx8IDE7CiAgICAgIHZhciBiYXNlVmFsdWUgPSBjaCAtIDB4MzA7CiAgICAgIHZhciBwb3dlclZhbHVlID0gMDsKICAgICAgdmFyIHBvd2VyVmFsdWVTaWduID0gMTsKCiAgICAgIHdoaWxlICgoY2ggPSB0aGlzLm5leHRDaGFyKCkpID49IDApIHsKICAgICAgICBpZiAoY2ggPj0gMHgzMCAmJiBjaCA8PSAweDM5KSB7CiAgICAgICAgICB2YXIgY3VycmVudERpZ2l0ID0gY2ggLSAweDMwOwoKICAgICAgICAgIGlmIChlTm90YXRpb24pIHsKICAgICAgICAgICAgcG93ZXJWYWx1ZSA9IHBvd2VyVmFsdWUgKiAxMCArIGN1cnJlbnREaWdpdDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChkaXZpZGVCeSAhPT0gMCkgewogICAgICAgICAgICAgIGRpdmlkZUJ5ICo9IDEwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBiYXNlVmFsdWUgPSBiYXNlVmFsdWUgKiAxMCArIGN1cnJlbnREaWdpdDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGNoID09PSAweDJlKSB7CiAgICAgICAgICBpZiAoZGl2aWRlQnkgPT09IDApIHsKICAgICAgICAgICAgZGl2aWRlQnkgPSAxOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgyZCkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJCYWRseSBmb3JtYXR0ZWQgbnVtYmVyOiBtaW51cyBzaWduIGluIHRoZSBtaWRkbGUiKTsKICAgICAgICB9IGVsc2UgaWYgKGNoID09PSAweDQ1IHx8IGNoID09PSAweDY1KSB7CiAgICAgICAgICBjaCA9IHRoaXMucGVla0NoYXIoKTsKCiAgICAgICAgICBpZiAoY2ggPT09IDB4MmIgfHwgY2ggPT09IDB4MmQpIHsKICAgICAgICAgICAgcG93ZXJWYWx1ZVNpZ24gPSBjaCA9PT0gMHgyZCA/IC0xIDogMTsKICAgICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgfSBlbHNlIGlmIChjaCA8IDB4MzAgfHwgY2ggPiAweDM5KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGVOb3RhdGlvbiA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGRpdmlkZUJ5ICE9PSAwKSB7CiAgICAgICAgYmFzZVZhbHVlIC89IGRpdmlkZUJ5OwogICAgICB9CgogICAgICBpZiAoZU5vdGF0aW9uKSB7CiAgICAgICAgYmFzZVZhbHVlICo9IE1hdGgucG93KDEwLCBwb3dlclZhbHVlU2lnbiAqIHBvd2VyVmFsdWUpOwogICAgICB9CgogICAgICByZXR1cm4gc2lnbiAqIGJhc2VWYWx1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTdHJpbmciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0cmluZygpIHsKICAgICAgdmFyIG51bVBhcmVuID0gMTsKICAgICAgdmFyIGRvbmUgPSBmYWxzZTsKICAgICAgdmFyIHN0ckJ1ZiA9IHRoaXMuc3RyQnVmOwogICAgICBzdHJCdWYubGVuZ3RoID0gMDsKICAgICAgdmFyIGNoID0gdGhpcy5uZXh0Q2hhcigpOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICB2YXIgY2hhckJ1ZmZlcmVkID0gZmFsc2U7CgogICAgICAgIHN3aXRjaCAoY2ggfCAwKSB7CiAgICAgICAgICBjYXNlIC0xOgogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVudGVybWluYXRlZCBzdHJpbmciKTsKICAgICAgICAgICAgZG9uZSA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHgyODoKICAgICAgICAgICAgKytudW1QYXJlbjsKICAgICAgICAgICAgc3RyQnVmLnB1c2goIigiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweDI5OgogICAgICAgICAgICBpZiAoLS1udW1QYXJlbiA9PT0gMCkgewogICAgICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgICBkb25lID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzdHJCdWYucHVzaCgiKSIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4NWM6CiAgICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwoKICAgICAgICAgICAgc3dpdGNoIChjaCkgewogICAgICAgICAgICAgIGNhc2UgLTE6CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVudGVybWluYXRlZCBzdHJpbmciKTsKICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMHg2ZToKICAgICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKCJcbiIpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMHg3MjoKICAgICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKCJcciIpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMHg3NDoKICAgICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKCJcdCIpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMHg2MjoKICAgICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKCJcYiIpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMHg2NjoKICAgICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKCJcZiIpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMHg1YzoKICAgICAgICAgICAgICBjYXNlIDB4Mjg6CiAgICAgICAgICAgICAgY2FzZSAweDI5OgogICAgICAgICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShjaCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMHgzMDoKICAgICAgICAgICAgICBjYXNlIDB4MzE6CiAgICAgICAgICAgICAgY2FzZSAweDMyOgogICAgICAgICAgICAgIGNhc2UgMHgzMzoKICAgICAgICAgICAgICBjYXNlIDB4MzQ6CiAgICAgICAgICAgICAgY2FzZSAweDM1OgogICAgICAgICAgICAgIGNhc2UgMHgzNjoKICAgICAgICAgICAgICBjYXNlIDB4Mzc6CiAgICAgICAgICAgICAgICB2YXIgeCA9IGNoICYgMHgwZjsKICAgICAgICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICAgICAgY2hhckJ1ZmZlcmVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoY2ggPj0gMHgzMCAmJiBjaCA8PSAweDM3KSB7CiAgICAgICAgICAgICAgICAgIHggPSAoeCA8PCAzKSArIChjaCAmIDB4MGYpOwogICAgICAgICAgICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICAgICAgICAgICAgICAgIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzcpIHsKICAgICAgICAgICAgICAgICAgICBjaGFyQnVmZmVyZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB4ID0gKHggPDwgMykgKyAoY2ggJiAweDBmKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoeCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMHgwZDoKICAgICAgICAgICAgICAgIGlmICh0aGlzLnBlZWtDaGFyKCkgPT09IDB4MGEpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDB4MGE6CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKGRvbmUpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFjaGFyQnVmZmVyZWQpIHsKICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHN0ckJ1Zi5qb2luKCIiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXROYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROYW1lKCkgewogICAgICB2YXIgY2gsIHByZXZpb3VzQ2g7CiAgICAgIHZhciBzdHJCdWYgPSB0aGlzLnN0ckJ1ZjsKICAgICAgc3RyQnVmLmxlbmd0aCA9IDA7CgogICAgICB3aGlsZSAoKGNoID0gdGhpcy5uZXh0Q2hhcigpKSA+PSAwICYmICFzcGVjaWFsQ2hhcnNbY2hdKSB7CiAgICAgICAgaWYgKGNoID09PSAweDIzKSB7CiAgICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKCiAgICAgICAgICBpZiAoc3BlY2lhbENoYXJzW2NoXSkgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkxleGVyX2dldE5hbWU6ICIgKyAiTlVNQkVSIFNJR04gKCMpIHNob3VsZCBiZSBmb2xsb3dlZCBieSBhIGhleGFkZWNpbWFsIG51bWJlci4iKTsKICAgICAgICAgICAgc3RyQnVmLnB1c2goIiMiKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHggPSB0b0hleERpZ2l0KGNoKTsKCiAgICAgICAgICBpZiAoeCAhPT0gLTEpIHsKICAgICAgICAgICAgcHJldmlvdXNDaCA9IGNoOwogICAgICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgdmFyIHgyID0gdG9IZXhEaWdpdChjaCk7CgogICAgICAgICAgICBpZiAoeDIgPT09IC0xKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJMZXhlcl9nZXROYW1lOiBJbGxlZ2FsIGRpZ2l0ICgiLmNvbmNhdChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSwgIikgIikgKyAiaW4gaGV4YWRlY2ltYWwgbnVtYmVyLiIpOwogICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKCIjIiwgU3RyaW5nLmZyb21DaGFyQ29kZShwcmV2aW91c0NoKSk7CgogICAgICAgICAgICAgIGlmIChzcGVjaWFsQ2hhcnNbY2hdKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHN0ckJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZSh4IDw8IDQgfCB4MikpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RyQnVmLnB1c2goIiMiLCBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0ckJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChzdHJCdWYubGVuZ3RoID4gMTI3KSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJOYW1lIHRva2VuIGlzIGxvbmdlciB0aGFuIGFsbG93ZWQgYnkgdGhlIHNwZWM6ICIuY29uY2F0KHN0ckJ1Zi5sZW5ndGgpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLk5hbWUuZ2V0KHN0ckJ1Zi5qb2luKCIiKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2hleFN0cmluZ1dhcm4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9oZXhTdHJpbmdXYXJuKGNoKSB7CiAgICAgIHZhciBNQVhfSEVYX1NUUklOR19OVU1fV0FSTiA9IDU7CgogICAgICBpZiAodGhpcy5faGV4U3RyaW5nTnVtV2FybisrID09PSBNQVhfSEVYX1NUUklOR19OVU1fV0FSTikgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiZ2V0SGV4U3RyaW5nIC0gaWdub3JpbmcgYWRkaXRpb25hbCBpbnZhbGlkIGNoYXJhY3RlcnMuIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5faGV4U3RyaW5nTnVtV2FybiA+IE1BWF9IRVhfU1RSSU5HX05VTV9XQVJOKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAoMCwgX3V0aWwud2FybikoImdldEhleFN0cmluZyAtIGlnbm9yaW5nIGludmFsaWQgY2hhcmFjdGVyOiAiLmNvbmNhdChjaCkpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEhleFN0cmluZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SGV4U3RyaW5nKCkgewogICAgICB2YXIgc3RyQnVmID0gdGhpcy5zdHJCdWY7CiAgICAgIHN0ckJ1Zi5sZW5ndGggPSAwOwogICAgICB2YXIgY2ggPSB0aGlzLmN1cnJlbnRDaGFyOwogICAgICB2YXIgaXNGaXJzdEhleCA9IHRydWU7CiAgICAgIHZhciBmaXJzdERpZ2l0LCBzZWNvbmREaWdpdDsKICAgICAgdGhpcy5faGV4U3RyaW5nTnVtV2FybiA9IDA7CgogICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIGlmIChjaCA8IDApIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVW50ZXJtaW5hdGVkIGhleCBzdHJpbmciKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gZWxzZSBpZiAoY2ggPT09IDB4M2UpIHsKICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gZWxzZSBpZiAoc3BlY2lhbENoYXJzW2NoXSA9PT0gMSkgewogICAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGlzRmlyc3RIZXgpIHsKICAgICAgICAgICAgZmlyc3REaWdpdCA9IHRvSGV4RGlnaXQoY2gpOwoKICAgICAgICAgICAgaWYgKGZpcnN0RGlnaXQgPT09IC0xKSB7CiAgICAgICAgICAgICAgdGhpcy5faGV4U3RyaW5nV2FybihjaCk7CgogICAgICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZWNvbmREaWdpdCA9IHRvSGV4RGlnaXQoY2gpOwoKICAgICAgICAgICAgaWYgKHNlY29uZERpZ2l0ID09PSAtMSkgewogICAgICAgICAgICAgIHRoaXMuX2hleFN0cmluZ1dhcm4oY2gpOwoKICAgICAgICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3RyQnVmLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShmaXJzdERpZ2l0IDw8IDQgfCBzZWNvbmREaWdpdCkpOwogICAgICAgICAgfQoKICAgICAgICAgIGlzRmlyc3RIZXggPSAhaXNGaXJzdEhleDsKICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHN0ckJ1Zi5qb2luKCIiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRPYmoiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE9iaigpIHsKICAgICAgdmFyIGNvbW1lbnQgPSBmYWxzZTsKICAgICAgdmFyIGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKCiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgaWYgKGNoIDwgMCkgewogICAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkVPRjsKICAgICAgICB9CgogICAgICAgIGlmIChjb21tZW50KSB7CiAgICAgICAgICBpZiAoY2ggPT09IDB4MGEgfHwgY2ggPT09IDB4MGQpIHsKICAgICAgICAgICAgY29tbWVudCA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoY2ggPT09IDB4MjUpIHsKICAgICAgICAgIGNvbW1lbnQgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoc3BlY2lhbENoYXJzW2NoXSAhPT0gMSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgfQoKICAgICAgc3dpdGNoIChjaCB8IDApIHsKICAgICAgICBjYXNlIDB4MzA6CiAgICAgICAgY2FzZSAweDMxOgogICAgICAgIGNhc2UgMHgzMjoKICAgICAgICBjYXNlIDB4MzM6CiAgICAgICAgY2FzZSAweDM0OgogICAgICAgIGNhc2UgMHgzNToKICAgICAgICBjYXNlIDB4MzY6CiAgICAgICAgY2FzZSAweDM3OgogICAgICAgIGNhc2UgMHgzODoKICAgICAgICBjYXNlIDB4Mzk6CiAgICAgICAgY2FzZSAweDJiOgogICAgICAgIGNhc2UgMHgyZDoKICAgICAgICBjYXNlIDB4MmU6CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXROdW1iZXIoKTsKCiAgICAgICAgY2FzZSAweDI4OgogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RyaW5nKCk7CgogICAgICAgIGNhc2UgMHgyZjoKICAgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKTsKCiAgICAgICAgY2FzZSAweDViOgogICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkNtZC5nZXQoIlsiKTsKCiAgICAgICAgY2FzZSAweDVkOgogICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkNtZC5nZXQoIl0iKTsKCiAgICAgICAgY2FzZSAweDNjOgogICAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CgogICAgICAgICAgaWYgKGNoID09PSAweDNjKSB7CiAgICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkNtZC5nZXQoIjw8Iik7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SGV4U3RyaW5nKCk7CgogICAgICAgIGNhc2UgMHgzZToKICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwoKICAgICAgICAgIGlmIChjaCA9PT0gMHgzZSkgewogICAgICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KCI+PiIpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KCI+Iik7CgogICAgICAgIGNhc2UgMHg3YjoKICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KCJ7Iik7CgogICAgICAgIGNhc2UgMHg3ZDoKICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KCJ9Iik7CgogICAgICAgIGNhc2UgMHgyOToKICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSWxsZWdhbCBjaGFyYWN0ZXI6ICIuY29uY2F0KGNoKSk7CiAgICAgIH0KCiAgICAgIHZhciBzdHIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKICAgICAgdmFyIGtub3duQ29tbWFuZHMgPSB0aGlzLmtub3duQ29tbWFuZHM7CiAgICAgIHZhciBrbm93bkNvbW1hbmRGb3VuZCA9IGtub3duQ29tbWFuZHMgJiYga25vd25Db21tYW5kc1tzdHJdICE9PSB1bmRlZmluZWQ7CgogICAgICB3aGlsZSAoKGNoID0gdGhpcy5uZXh0Q2hhcigpKSA+PSAwICYmICFzcGVjaWFsQ2hhcnNbY2hdKSB7CiAgICAgICAgdmFyIHBvc3NpYmxlQ29tbWFuZCA9IHN0ciArIFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpOwoKICAgICAgICBpZiAoa25vd25Db21tYW5kRm91bmQgJiYga25vd25Db21tYW5kc1twb3NzaWJsZUNvbW1hbmRdID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0ci5sZW5ndGggPT09IDEyOCkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJDb21tYW5kIHRva2VuIHRvbyBsb25nOiAiLmNvbmNhdChzdHIubGVuZ3RoKSk7CiAgICAgICAgfQoKICAgICAgICBzdHIgPSBwb3NzaWJsZUNvbW1hbmQ7CiAgICAgICAga25vd25Db21tYW5kRm91bmQgPSBrbm93bkNvbW1hbmRzICYmIGtub3duQ29tbWFuZHNbc3RyXSAhPT0gdW5kZWZpbmVkOwogICAgICB9CgogICAgICBpZiAoc3RyID09PSAidHJ1ZSIpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHN0ciA9PT0gImZhbHNlIikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKHN0ciA9PT0gIm51bGwiKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGlmIChzdHIgPT09ICJCSSIpIHsKICAgICAgICB0aGlzLmJlZ2luSW5saW5lSW1hZ2VQb3MgPSB0aGlzLnN0cmVhbS5wb3M7CiAgICAgIH0KCiAgICAgIHJldHVybiBfcHJpbWl0aXZlcy5DbWQuZ2V0KHN0cik7CiAgICB9CiAgfSwgewogICAga2V5OiAic2tpcFRvTmV4dExpbmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNraXBUb05leHRMaW5lKCkgewogICAgICB2YXIgY2ggPSB0aGlzLmN1cnJlbnRDaGFyOwoKICAgICAgd2hpbGUgKGNoID49IDApIHsKICAgICAgICBpZiAoY2ggPT09IDB4MGQpIHsKICAgICAgICAgIGNoID0gdGhpcy5uZXh0Q2hhcigpOwoKICAgICAgICAgIGlmIChjaCA9PT0gMHgwYSkgewogICAgICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgICAgfSBlbHNlIGlmIChjaCA9PT0gMHgwYSkgewogICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIExleGVyOwp9KCk7CgpleHBvcnRzLkxleGVyID0gTGV4ZXI7Cgp2YXIgTGluZWFyaXphdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTGluZWFyaXphdGlvbigpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMaW5lYXJpemF0aW9uKTsKICB9CgogIF9jcmVhdGVDbGFzcyhMaW5lYXJpemF0aW9uLCBudWxsLCBbewogICAga2V5OiAiY3JlYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUoc3RyZWFtKSB7CiAgICAgIGZ1bmN0aW9uIGdldEludChsaW5EaWN0LCBuYW1lKSB7CiAgICAgICAgdmFyIGFsbG93WmVyb1ZhbHVlID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgICAgICB2YXIgb2JqID0gbGluRGljdC5nZXQobmFtZSk7CgogICAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG9iaikgJiYgKGFsbG93WmVyb1ZhbHVlID8gb2JqID49IDAgOiBvYmogPiAwKSkgewogICAgICAgICAgcmV0dXJuIG9iajsKICAgICAgICB9CgogICAgICAgIHRocm93IG5ldyBFcnJvcigiVGhlIFwiIi5jb25jYXQobmFtZSwgIlwiIHBhcmFtZXRlciBpbiB0aGUgbGluZWFyaXphdGlvbiAiKSArICJkaWN0aW9uYXJ5IGlzIGludmFsaWQuIik7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGdldEhpbnRzKGxpbkRpY3QpIHsKICAgICAgICB2YXIgaGludHMgPSBsaW5EaWN0LmdldCgiSCIpOwogICAgICAgIHZhciBoaW50c0xlbmd0aDsKCiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaGludHMpICYmICgoaGludHNMZW5ndGggPSBoaW50cy5sZW5ndGgpID09PSAyIHx8IGhpbnRzTGVuZ3RoID09PSA0KSkgewogICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGhpbnRzTGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgIHZhciBoaW50ID0gaGludHNbaW5kZXhdOwoKICAgICAgICAgICAgaWYgKCEoTnVtYmVyLmlzSW50ZWdlcihoaW50KSAmJiBoaW50ID4gMCkpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkhpbnQgKCIuY29uY2F0KGluZGV4LCAiKSBpbiB0aGUgbGluZWFyaXphdGlvbiBkaWN0aW9uYXJ5IGlzIGludmFsaWQuIikpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGhpbnRzOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJIaW50IGFycmF5IGluIHRoZSBsaW5lYXJpemF0aW9uIGRpY3Rpb25hcnkgaXMgaW52YWxpZC4iKTsKICAgICAgfQoKICAgICAgdmFyIHBhcnNlciA9IG5ldyBQYXJzZXIoewogICAgICAgIGxleGVyOiBuZXcgTGV4ZXIoc3RyZWFtKSwKICAgICAgICB4cmVmOiBudWxsCiAgICAgIH0pOwogICAgICB2YXIgb2JqMSA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgdmFyIG9iajIgPSBwYXJzZXIuZ2V0T2JqKCk7CiAgICAgIHZhciBvYmozID0gcGFyc2VyLmdldE9iaigpOwogICAgICB2YXIgbGluRGljdCA9IHBhcnNlci5nZXRPYmooKTsKICAgICAgdmFyIG9iaiwgbGVuZ3RoOwoKICAgICAgaWYgKCEoTnVtYmVyLmlzSW50ZWdlcihvYmoxKSAmJiBOdW1iZXIuaXNJbnRlZ2VyKG9iajIpICYmICgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqMywgIm9iaiIpICYmICgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGxpbkRpY3QpICYmICgwLCBfdXRpbC5pc051bSkob2JqID0gbGluRGljdC5nZXQoIkxpbmVhcml6ZWQiKSkgJiYgb2JqID4gMCkpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSBlbHNlIGlmICgobGVuZ3RoID0gZ2V0SW50KGxpbkRpY3QsICJMIikpICE9PSBzdHJlYW0ubGVuZ3RoKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgIkwiIHBhcmFtZXRlciBpbiB0aGUgbGluZWFyaXphdGlvbiBkaWN0aW9uYXJ5ICcgKyAiZG9lcyBub3QgZXF1YWwgdGhlIHN0cmVhbSBsZW5ndGguIik7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgbGVuZ3RoOiBsZW5ndGgsCiAgICAgICAgaGludHM6IGdldEhpbnRzKGxpbkRpY3QpLAogICAgICAgIG9iamVjdE51bWJlckZpcnN0OiBnZXRJbnQobGluRGljdCwgIk8iKSwKICAgICAgICBlbmRGaXJzdDogZ2V0SW50KGxpbkRpY3QsICJFIiksCiAgICAgICAgbnVtUGFnZXM6IGdldEludChsaW5EaWN0LCAiTiIpLAogICAgICAgIG1haW5YUmVmRW50cmllc09mZnNldDogZ2V0SW50KGxpbkRpY3QsICJUIiksCiAgICAgICAgcGFnZUZpcnN0OiBsaW5EaWN0LmhhcygiUCIpID8gZ2V0SW50KGxpbkRpY3QsICJQIiwgdHJ1ZSkgOiAwCiAgICAgIH07CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTGluZWFyaXphdGlvbjsKfSgpOwoKZXhwb3J0cy5MaW5lYXJpemF0aW9uID0gTGluZWFyaXphdGlvbjsKCi8qKiovIH0pLAovKiAyMDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5MWldTdHJlYW0gPSBleHBvcnRzLlN0cmluZ1N0cmVhbSA9IGV4cG9ydHMuU3RyZWFtc1NlcXVlbmNlU3RyZWFtID0gZXhwb3J0cy5TdHJlYW0gPSBleHBvcnRzLlJ1bkxlbmd0aFN0cmVhbSA9IGV4cG9ydHMuUHJlZGljdG9yU3RyZWFtID0gZXhwb3J0cy5OdWxsU3RyZWFtID0gZXhwb3J0cy5GbGF0ZVN0cmVhbSA9IGV4cG9ydHMuRGVjb2RlU3RyZWFtID0gZXhwb3J0cy5EZWNyeXB0U3RyZWFtID0gZXhwb3J0cy5Bc2NpaUhleFN0cmVhbSA9IGV4cG9ydHMuQXNjaWk4NVN0cmVhbSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5OCk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMSk7CgpmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHsgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICJ1bmRlZmluZWQiICYmIFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9CgpmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCnZhciBTdHJlYW0gPSBmdW5jdGlvbiBTdHJlYW1DbG9zdXJlKCkgewogIGZ1bmN0aW9uIFN0cmVhbShhcnJheUJ1ZmZlciwgc3RhcnQsIGxlbmd0aCwgZGljdCkgewogICAgdGhpcy5ieXRlcyA9IGFycmF5QnVmZmVyIGluc3RhbmNlb2YgVWludDhBcnJheSA/IGFycmF5QnVmZmVyIDogbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpOwogICAgdGhpcy5zdGFydCA9IHN0YXJ0IHx8IDA7CiAgICB0aGlzLnBvcyA9IHRoaXMuc3RhcnQ7CiAgICB0aGlzLmVuZCA9IHN0YXJ0ICsgbGVuZ3RoIHx8IHRoaXMuYnl0ZXMubGVuZ3RoOwogICAgdGhpcy5kaWN0ID0gZGljdDsKICB9CgogIFN0cmVhbS5wcm90b3R5cGUgPSB7CiAgICBnZXQgbGVuZ3RoKCkgewogICAgICByZXR1cm4gdGhpcy5lbmQgLSB0aGlzLnN0YXJ0OwogICAgfSwKCiAgICBnZXQgaXNFbXB0eSgpIHsKICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoID09PSAwOwogICAgfSwKCiAgICBnZXRCeXRlOiBmdW5jdGlvbiBTdHJlYW1fZ2V0Qnl0ZSgpIHsKICAgICAgaWYgKHRoaXMucG9zID49IHRoaXMuZW5kKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5ieXRlc1t0aGlzLnBvcysrXTsKICAgIH0sCiAgICBnZXRVaW50MTY6IGZ1bmN0aW9uIFN0cmVhbV9nZXRVaW50MTYoKSB7CiAgICAgIHZhciBiMCA9IHRoaXMuZ2V0Qnl0ZSgpOwogICAgICB2YXIgYjEgPSB0aGlzLmdldEJ5dGUoKTsKCiAgICAgIGlmIChiMCA9PT0gLTEgfHwgYjEgPT09IC0xKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CgogICAgICByZXR1cm4gKGIwIDw8IDgpICsgYjE7CiAgICB9LAogICAgZ2V0SW50MzI6IGZ1bmN0aW9uIFN0cmVhbV9nZXRJbnQzMigpIHsKICAgICAgdmFyIGIwID0gdGhpcy5nZXRCeXRlKCk7CiAgICAgIHZhciBiMSA9IHRoaXMuZ2V0Qnl0ZSgpOwogICAgICB2YXIgYjIgPSB0aGlzLmdldEJ5dGUoKTsKICAgICAgdmFyIGIzID0gdGhpcy5nZXRCeXRlKCk7CiAgICAgIHJldHVybiAoYjAgPDwgMjQpICsgKGIxIDw8IDE2KSArIChiMiA8PCA4KSArIGIzOwogICAgfSwKICAgIGdldEJ5dGVzOiBmdW5jdGlvbiBnZXRCeXRlcyhsZW5ndGgpIHsKICAgICAgdmFyIGZvcmNlQ2xhbXBlZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBieXRlcyA9IHRoaXMuYnl0ZXM7CiAgICAgIHZhciBwb3MgPSB0aGlzLnBvczsKICAgICAgdmFyIHN0ckVuZCA9IHRoaXMuZW5kOwoKICAgICAgaWYgKCFsZW5ndGgpIHsKICAgICAgICB2YXIgX3N1YmFycmF5ID0gYnl0ZXMuc3ViYXJyYXkocG9zLCBzdHJFbmQpOwoKICAgICAgICByZXR1cm4gZm9yY2VDbGFtcGVkID8gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KF9zdWJhcnJheSkgOiBfc3ViYXJyYXk7CiAgICAgIH0KCiAgICAgIHZhciBlbmQgPSBwb3MgKyBsZW5ndGg7CgogICAgICBpZiAoZW5kID4gc3RyRW5kKSB7CiAgICAgICAgZW5kID0gc3RyRW5kOwogICAgICB9CgogICAgICB0aGlzLnBvcyA9IGVuZDsKICAgICAgdmFyIHN1YmFycmF5ID0gYnl0ZXMuc3ViYXJyYXkocG9zLCBlbmQpOwogICAgICByZXR1cm4gZm9yY2VDbGFtcGVkID8gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHN1YmFycmF5KSA6IHN1YmFycmF5OwogICAgfSwKICAgIHBlZWtCeXRlOiBmdW5jdGlvbiBTdHJlYW1fcGVla0J5dGUoKSB7CiAgICAgIHZhciBwZWVrZWRCeXRlID0gdGhpcy5nZXRCeXRlKCk7CgogICAgICBpZiAocGVla2VkQnl0ZSAhPT0gLTEpIHsKICAgICAgICB0aGlzLnBvcy0tOwogICAgICB9CgogICAgICByZXR1cm4gcGVla2VkQnl0ZTsKICAgIH0sCiAgICBwZWVrQnl0ZXM6IGZ1bmN0aW9uIHBlZWtCeXRlcyhsZW5ndGgpIHsKICAgICAgdmFyIGZvcmNlQ2xhbXBlZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBieXRlcyA9IHRoaXMuZ2V0Qnl0ZXMobGVuZ3RoLCBmb3JjZUNsYW1wZWQpOwogICAgICB0aGlzLnBvcyAtPSBieXRlcy5sZW5ndGg7CiAgICAgIHJldHVybiBieXRlczsKICAgIH0sCiAgICBnZXRCeXRlUmFuZ2U6IGZ1bmN0aW9uIGdldEJ5dGVSYW5nZShiZWdpbiwgZW5kKSB7CiAgICAgIGlmIChiZWdpbiA8IDApIHsKICAgICAgICBiZWdpbiA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChlbmQgPiB0aGlzLmVuZCkgewogICAgICAgIGVuZCA9IHRoaXMuZW5kOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5ieXRlcy5zdWJhcnJheShiZWdpbiwgZW5kKTsKICAgIH0sCiAgICBza2lwOiBmdW5jdGlvbiBTdHJlYW1fc2tpcChuKSB7CiAgICAgIGlmICghbikgewogICAgICAgIG4gPSAxOwogICAgICB9CgogICAgICB0aGlzLnBvcyArPSBuOwogICAgfSwKICAgIHJlc2V0OiBmdW5jdGlvbiBTdHJlYW1fcmVzZXQoKSB7CiAgICAgIHRoaXMucG9zID0gdGhpcy5zdGFydDsKICAgIH0sCiAgICBtb3ZlU3RhcnQ6IGZ1bmN0aW9uIFN0cmVhbV9tb3ZlU3RhcnQoKSB7CiAgICAgIHRoaXMuc3RhcnQgPSB0aGlzLnBvczsKICAgIH0sCiAgICBtYWtlU3ViU3RyZWFtOiBmdW5jdGlvbiBTdHJlYW1fbWFrZVN1YlN0cmVhbShzdGFydCwgbGVuZ3RoLCBkaWN0KSB7CiAgICAgIHJldHVybiBuZXcgU3RyZWFtKHRoaXMuYnl0ZXMuYnVmZmVyLCBzdGFydCwgbGVuZ3RoLCBkaWN0KTsKICAgIH0KICB9OwogIHJldHVybiBTdHJlYW07Cn0oKTsKCmV4cG9ydHMuU3RyZWFtID0gU3RyZWFtOwoKdmFyIFN0cmluZ1N0cmVhbSA9IGZ1bmN0aW9uIFN0cmluZ1N0cmVhbUNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gU3RyaW5nU3RyZWFtKHN0cikgewogICAgdmFyIGJ5dGVzID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKHN0cik7CiAgICBTdHJlYW0uY2FsbCh0aGlzLCBieXRlcyk7CiAgfQoKICBTdHJpbmdTdHJlYW0ucHJvdG90eXBlID0gU3RyZWFtLnByb3RvdHlwZTsKICByZXR1cm4gU3RyaW5nU3RyZWFtOwp9KCk7CgpleHBvcnRzLlN0cmluZ1N0cmVhbSA9IFN0cmluZ1N0cmVhbTsKCnZhciBEZWNvZGVTdHJlYW0gPSBmdW5jdGlvbiBEZWNvZGVTdHJlYW1DbG9zdXJlKCkgewogIHZhciBlbXB0eUJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDApOwoKICBmdW5jdGlvbiBEZWNvZGVTdHJlYW0obWF5YmVNaW5CdWZmZXJMZW5ndGgpIHsKICAgIHRoaXMuX3Jhd01pbkJ1ZmZlckxlbmd0aCA9IG1heWJlTWluQnVmZmVyTGVuZ3RoIHx8IDA7CiAgICB0aGlzLnBvcyA9IDA7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IDA7CiAgICB0aGlzLmVvZiA9IGZhbHNlOwogICAgdGhpcy5idWZmZXIgPSBlbXB0eUJ1ZmZlcjsKICAgIHRoaXMubWluQnVmZmVyTGVuZ3RoID0gNTEyOwoKICAgIGlmIChtYXliZU1pbkJ1ZmZlckxlbmd0aCkgewogICAgICB3aGlsZSAodGhpcy5taW5CdWZmZXJMZW5ndGggPCBtYXliZU1pbkJ1ZmZlckxlbmd0aCkgewogICAgICAgIHRoaXMubWluQnVmZmVyTGVuZ3RoICo9IDI7CiAgICAgIH0KICAgIH0KICB9CgogIERlY29kZVN0cmVhbS5wcm90b3R5cGUgPSB7CiAgICBnZXQgaXNFbXB0eSgpIHsKICAgICAgd2hpbGUgKCF0aGlzLmVvZiAmJiB0aGlzLmJ1ZmZlckxlbmd0aCA9PT0gMCkgewogICAgICAgIHRoaXMucmVhZEJsb2NrKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmJ1ZmZlckxlbmd0aCA9PT0gMDsKICAgIH0sCgogICAgZW5zdXJlQnVmZmVyOiBmdW5jdGlvbiBEZWNvZGVTdHJlYW1fZW5zdXJlQnVmZmVyKHJlcXVlc3RlZCkgewogICAgICB2YXIgYnVmZmVyID0gdGhpcy5idWZmZXI7CgogICAgICBpZiAocmVxdWVzdGVkIDw9IGJ1ZmZlci5ieXRlTGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIGJ1ZmZlcjsKICAgICAgfQoKICAgICAgdmFyIHNpemUgPSB0aGlzLm1pbkJ1ZmZlckxlbmd0aDsKCiAgICAgIHdoaWxlIChzaXplIDwgcmVxdWVzdGVkKSB7CiAgICAgICAgc2l6ZSAqPSAyOwogICAgICB9CgogICAgICB2YXIgYnVmZmVyMiA9IG5ldyBVaW50OEFycmF5KHNpemUpOwogICAgICBidWZmZXIyLnNldChidWZmZXIpOwogICAgICByZXR1cm4gdGhpcy5idWZmZXIgPSBidWZmZXIyOwogICAgfSwKICAgIGdldEJ5dGU6IGZ1bmN0aW9uIERlY29kZVN0cmVhbV9nZXRCeXRlKCkgewogICAgICB2YXIgcG9zID0gdGhpcy5wb3M7CgogICAgICB3aGlsZSAodGhpcy5idWZmZXJMZW5ndGggPD0gcG9zKSB7CiAgICAgICAgaWYgKHRoaXMuZW9mKSB7CiAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnJlYWRCbG9jaygpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5idWZmZXJbdGhpcy5wb3MrK107CiAgICB9LAogICAgZ2V0VWludDE2OiBmdW5jdGlvbiBEZWNvZGVTdHJlYW1fZ2V0VWludDE2KCkgewogICAgICB2YXIgYjAgPSB0aGlzLmdldEJ5dGUoKTsKICAgICAgdmFyIGIxID0gdGhpcy5nZXRCeXRlKCk7CgogICAgICBpZiAoYjAgPT09IC0xIHx8IGIxID09PSAtMSkgewogICAgICAgIHJldHVybiAtMTsKICAgICAgfQoKICAgICAgcmV0dXJuIChiMCA8PCA4KSArIGIxOwogICAgfSwKICAgIGdldEludDMyOiBmdW5jdGlvbiBEZWNvZGVTdHJlYW1fZ2V0SW50MzIoKSB7CiAgICAgIHZhciBiMCA9IHRoaXMuZ2V0Qnl0ZSgpOwogICAgICB2YXIgYjEgPSB0aGlzLmdldEJ5dGUoKTsKICAgICAgdmFyIGIyID0gdGhpcy5nZXRCeXRlKCk7CiAgICAgIHZhciBiMyA9IHRoaXMuZ2V0Qnl0ZSgpOwogICAgICByZXR1cm4gKGIwIDw8IDI0KSArIChiMSA8PCAxNikgKyAoYjIgPDwgOCkgKyBiMzsKICAgIH0sCiAgICBnZXRCeXRlczogZnVuY3Rpb24gZ2V0Qnl0ZXMobGVuZ3RoKSB7CiAgICAgIHZhciBmb3JjZUNsYW1wZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICB2YXIgZW5kLAogICAgICAgICAgcG9zID0gdGhpcy5wb3M7CgogICAgICBpZiAobGVuZ3RoKSB7CiAgICAgICAgdGhpcy5lbnN1cmVCdWZmZXIocG9zICsgbGVuZ3RoKTsKICAgICAgICBlbmQgPSBwb3MgKyBsZW5ndGg7CgogICAgICAgIHdoaWxlICghdGhpcy5lb2YgJiYgdGhpcy5idWZmZXJMZW5ndGggPCBlbmQpIHsKICAgICAgICAgIHRoaXMucmVhZEJsb2NrKCk7CiAgICAgICAgfQoKICAgICAgICB2YXIgYnVmRW5kID0gdGhpcy5idWZmZXJMZW5ndGg7CgogICAgICAgIGlmIChlbmQgPiBidWZFbmQpIHsKICAgICAgICAgIGVuZCA9IGJ1ZkVuZDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd2hpbGUgKCF0aGlzLmVvZikgewogICAgICAgICAgdGhpcy5yZWFkQmxvY2soKTsKICAgICAgICB9CgogICAgICAgIGVuZCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwogICAgICB9CgogICAgICB0aGlzLnBvcyA9IGVuZDsKICAgICAgdmFyIHN1YmFycmF5ID0gdGhpcy5idWZmZXIuc3ViYXJyYXkocG9zLCBlbmQpOwogICAgICByZXR1cm4gZm9yY2VDbGFtcGVkICYmICEoc3ViYXJyYXkgaW5zdGFuY2VvZiBVaW50OENsYW1wZWRBcnJheSkgPyBuZXcgVWludDhDbGFtcGVkQXJyYXkoc3ViYXJyYXkpIDogc3ViYXJyYXk7CiAgICB9LAogICAgcGVla0J5dGU6IGZ1bmN0aW9uIERlY29kZVN0cmVhbV9wZWVrQnl0ZSgpIHsKICAgICAgdmFyIHBlZWtlZEJ5dGUgPSB0aGlzLmdldEJ5dGUoKTsKCiAgICAgIGlmIChwZWVrZWRCeXRlICE9PSAtMSkgewogICAgICAgIHRoaXMucG9zLS07CiAgICAgIH0KCiAgICAgIHJldHVybiBwZWVrZWRCeXRlOwogICAgfSwKICAgIHBlZWtCeXRlczogZnVuY3Rpb24gcGVla0J5dGVzKGxlbmd0aCkgewogICAgICB2YXIgZm9yY2VDbGFtcGVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgICAgdmFyIGJ5dGVzID0gdGhpcy5nZXRCeXRlcyhsZW5ndGgsIGZvcmNlQ2xhbXBlZCk7CiAgICAgIHRoaXMucG9zIC09IGJ5dGVzLmxlbmd0aDsKICAgICAgcmV0dXJuIGJ5dGVzOwogICAgfSwKICAgIG1ha2VTdWJTdHJlYW06IGZ1bmN0aW9uIERlY29kZVN0cmVhbV9tYWtlU3ViU3RyZWFtKHN0YXJ0LCBsZW5ndGgsIGRpY3QpIHsKICAgICAgdmFyIGVuZCA9IHN0YXJ0ICsgbGVuZ3RoOwoKICAgICAgd2hpbGUgKHRoaXMuYnVmZmVyTGVuZ3RoIDw9IGVuZCAmJiAhdGhpcy5lb2YpIHsKICAgICAgICB0aGlzLnJlYWRCbG9jaygpOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IFN0cmVhbSh0aGlzLmJ1ZmZlciwgc3RhcnQsIGxlbmd0aCwgZGljdCk7CiAgICB9LAogICAgZ2V0Qnl0ZVJhbmdlOiBmdW5jdGlvbiBnZXRCeXRlUmFuZ2UoYmVnaW4sIGVuZCkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJTaG91bGQgbm90IGNhbGwgRGVjb2RlU3RyZWFtLmdldEJ5dGVSYW5nZSIpOwogICAgfSwKICAgIHNraXA6IGZ1bmN0aW9uIERlY29kZVN0cmVhbV9za2lwKG4pIHsKICAgICAgaWYgKCFuKSB7CiAgICAgICAgbiA9IDE7CiAgICAgIH0KCiAgICAgIHRoaXMucG9zICs9IG47CiAgICB9LAogICAgcmVzZXQ6IGZ1bmN0aW9uIERlY29kZVN0cmVhbV9yZXNldCgpIHsKICAgICAgdGhpcy5wb3MgPSAwOwogICAgfSwKICAgIGdldEJhc2VTdHJlYW1zOiBmdW5jdGlvbiBEZWNvZGVTdHJlYW1fZ2V0QmFzZVN0cmVhbXMoKSB7CiAgICAgIGlmICh0aGlzLnN0ciAmJiB0aGlzLnN0ci5nZXRCYXNlU3RyZWFtcykgewogICAgICAgIHJldHVybiB0aGlzLnN0ci5nZXRCYXNlU3RyZWFtcygpOwogICAgICB9CgogICAgICByZXR1cm4gW107CiAgICB9CiAgfTsKICByZXR1cm4gRGVjb2RlU3RyZWFtOwp9KCk7CgpleHBvcnRzLkRlY29kZVN0cmVhbSA9IERlY29kZVN0cmVhbTsKCnZhciBTdHJlYW1zU2VxdWVuY2VTdHJlYW0gPSBmdW5jdGlvbiBTdHJlYW1zU2VxdWVuY2VTdHJlYW1DbG9zdXJlKCkgewogIGZ1bmN0aW9uIFN0cmVhbXNTZXF1ZW5jZVN0cmVhbShzdHJlYW1zKSB7CiAgICB0aGlzLnN0cmVhbXMgPSBzdHJlYW1zOwogICAgdmFyIG1heWJlTGVuZ3RoID0gMDsKCiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzdHJlYW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgdmFyIHN0cmVhbSA9IHN0cmVhbXNbaV07CgogICAgICBpZiAoc3RyZWFtIGluc3RhbmNlb2YgRGVjb2RlU3RyZWFtKSB7CiAgICAgICAgbWF5YmVMZW5ndGggKz0gc3RyZWFtLl9yYXdNaW5CdWZmZXJMZW5ndGg7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWF5YmVMZW5ndGggKz0gc3RyZWFtLmxlbmd0aDsKICAgICAgfQogICAgfQoKICAgIERlY29kZVN0cmVhbS5jYWxsKHRoaXMsIG1heWJlTGVuZ3RoKTsKICB9CgogIFN0cmVhbXNTZXF1ZW5jZVN0cmVhbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKERlY29kZVN0cmVhbS5wcm90b3R5cGUpOwoKICBTdHJlYW1zU2VxdWVuY2VTdHJlYW0ucHJvdG90eXBlLnJlYWRCbG9jayA9IGZ1bmN0aW9uIHN0cmVhbVNlcXVlbmNlU3RyZWFtUmVhZEJsb2NrKCkgewogICAgdmFyIHN0cmVhbXMgPSB0aGlzLnN0cmVhbXM7CgogICAgaWYgKHN0cmVhbXMubGVuZ3RoID09PSAwKSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBzdHJlYW0gPSBzdHJlYW1zLnNoaWZ0KCk7CiAgICB2YXIgY2h1bmsgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTsKICAgIHZhciBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIHZhciBuZXdMZW5ndGggPSBidWZmZXJMZW5ndGggKyBjaHVuay5sZW5ndGg7CiAgICB2YXIgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIobmV3TGVuZ3RoKTsKICAgIGJ1ZmZlci5zZXQoY2h1bmssIGJ1ZmZlckxlbmd0aCk7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IG5ld0xlbmd0aDsKICB9OwoKICBTdHJlYW1zU2VxdWVuY2VTdHJlYW0ucHJvdG90eXBlLmdldEJhc2VTdHJlYW1zID0gZnVuY3Rpb24gU3RyZWFtc1NlcXVlbmNlU3RyZWFtX2dldEJhc2VTdHJlYW1zKCkgewogICAgdmFyIGJhc2VTdHJlYW1zID0gW107CgogICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5zdHJlYW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgdmFyIHN0cmVhbSA9IHRoaXMuc3RyZWFtc1tpXTsKCiAgICAgIGlmIChzdHJlYW0uZ2V0QmFzZVN0cmVhbXMpIHsKICAgICAgICBiYXNlU3RyZWFtcy5wdXNoLmFwcGx5KGJhc2VTdHJlYW1zLCBfdG9Db25zdW1hYmxlQXJyYXkoc3RyZWFtLmdldEJhc2VTdHJlYW1zKCkpKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBiYXNlU3RyZWFtczsKICB9OwoKICByZXR1cm4gU3RyZWFtc1NlcXVlbmNlU3RyZWFtOwp9KCk7CgpleHBvcnRzLlN0cmVhbXNTZXF1ZW5jZVN0cmVhbSA9IFN0cmVhbXNTZXF1ZW5jZVN0cmVhbTsKCnZhciBGbGF0ZVN0cmVhbSA9IGZ1bmN0aW9uIEZsYXRlU3RyZWFtQ2xvc3VyZSgpIHsKICB2YXIgY29kZUxlbkNvZGVNYXAgPSBuZXcgSW50MzJBcnJheShbMTYsIDE3LCAxOCwgMCwgOCwgNywgOSwgNiwgMTAsIDUsIDExLCA0LCAxMiwgMywgMTMsIDIsIDE0LCAxLCAxNV0pOwogIHZhciBsZW5ndGhEZWNvZGUgPSBuZXcgSW50MzJBcnJheShbMHgwMDAwMywgMHgwMDAwNCwgMHgwMDAwNSwgMHgwMDAwNiwgMHgwMDAwNywgMHgwMDAwOCwgMHgwMDAwOSwgMHgwMDAwYSwgMHgxMDAwYiwgMHgxMDAwZCwgMHgxMDAwZiwgMHgxMDAxMSwgMHgyMDAxMywgMHgyMDAxNywgMHgyMDAxYiwgMHgyMDAxZiwgMHgzMDAyMywgMHgzMDAyYiwgMHgzMDAzMywgMHgzMDAzYiwgMHg0MDA0MywgMHg0MDA1MywgMHg0MDA2MywgMHg0MDA3MywgMHg1MDA4MywgMHg1MDBhMywgMHg1MDBjMywgMHg1MDBlMywgMHgwMDEwMiwgMHgwMDEwMiwgMHgwMDEwMl0pOwogIHZhciBkaXN0RGVjb2RlID0gbmV3IEludDMyQXJyYXkoWzB4MDAwMDEsIDB4MDAwMDIsIDB4MDAwMDMsIDB4MDAwMDQsIDB4MTAwMDUsIDB4MTAwMDcsIDB4MjAwMDksIDB4MjAwMGQsIDB4MzAwMTEsIDB4MzAwMTksIDB4NDAwMjEsIDB4NDAwMzEsIDB4NTAwNDEsIDB4NTAwNjEsIDB4NjAwODEsIDB4NjAwYzEsIDB4NzAxMDEsIDB4NzAxODEsIDB4ODAyMDEsIDB4ODAzMDEsIDB4OTA0MDEsIDB4OTA2MDEsIDB4YTA4MDEsIDB4YTBjMDEsIDB4YjEwMDEsIDB4YjE4MDEsIDB4YzIwMDEsIDB4YzMwMDEsIDB4ZDQwMDEsIDB4ZDYwMDFdKTsKICB2YXIgZml4ZWRMaXRDb2RlVGFiID0gW25ldyBJbnQzMkFycmF5KFsweDcwMTAwLCAweDgwMDUwLCAweDgwMDEwLCAweDgwMTE4LCAweDcwMTEwLCAweDgwMDcwLCAweDgwMDMwLCAweDkwMGMwLCAweDcwMTA4LCAweDgwMDYwLCAweDgwMDIwLCAweDkwMGEwLCAweDgwMDAwLCAweDgwMDgwLCAweDgwMDQwLCAweDkwMGUwLCAweDcwMTA0LCAweDgwMDU4LCAweDgwMDE4LCAweDkwMDkwLCAweDcwMTE0LCAweDgwMDc4LCAweDgwMDM4LCAweDkwMGQwLCAweDcwMTBjLCAweDgwMDY4LCAweDgwMDI4LCAweDkwMGIwLCAweDgwMDA4LCAweDgwMDg4LCAweDgwMDQ4LCAweDkwMGYwLCAweDcwMTAyLCAweDgwMDU0LCAweDgwMDE0LCAweDgwMTFjLCAweDcwMTEyLCAweDgwMDc0LCAweDgwMDM0LCAweDkwMGM4LCAweDcwMTBhLCAweDgwMDY0LCAweDgwMDI0LCAweDkwMGE4LCAweDgwMDA0LCAweDgwMDg0LCAweDgwMDQ0LCAweDkwMGU4LCAweDcwMTA2LCAweDgwMDVjLCAweDgwMDFjLCAweDkwMDk4LCAweDcwMTE2LCAweDgwMDdjLCAweDgwMDNjLCAweDkwMGQ4LCAweDcwMTBlLCAweDgwMDZjLCAweDgwMDJjLCAweDkwMGI4LCAweDgwMDBjLCAweDgwMDhjLCAweDgwMDRjLCAweDkwMGY4LCAweDcwMTAxLCAweDgwMDUyLCAweDgwMDEyLCAweDgwMTFhLCAweDcwMTExLCAweDgwMDcyLCAweDgwMDMyLCAweDkwMGM0LCAweDcwMTA5LCAweDgwMDYyLCAweDgwMDIyLCAweDkwMGE0LCAweDgwMDAyLCAweDgwMDgyLCAweDgwMDQyLCAweDkwMGU0LCAweDcwMTA1LCAweDgwMDVhLCAweDgwMDFhLCAweDkwMDk0LCAweDcwMTE1LCAweDgwMDdhLCAweDgwMDNhLCAweDkwMGQ0LCAweDcwMTBkLCAweDgwMDZhLCAweDgwMDJhLCAweDkwMGI0LCAweDgwMDBhLCAweDgwMDhhLCAweDgwMDRhLCAweDkwMGY0LCAweDcwMTAzLCAweDgwMDU2LCAweDgwMDE2LCAweDgwMTFlLCAweDcwMTEzLCAweDgwMDc2LCAweDgwMDM2LCAweDkwMGNjLCAweDcwMTBiLCAweDgwMDY2LCAweDgwMDI2LCAweDkwMGFjLCAweDgwMDA2LCAweDgwMDg2LCAweDgwMDQ2LCAweDkwMGVjLCAweDcwMTA3LCAweDgwMDVlLCAweDgwMDFlLCAweDkwMDljLCAweDcwMTE3LCAweDgwMDdlLCAweDgwMDNlLCAweDkwMGRjLCAweDcwMTBmLCAweDgwMDZlLCAweDgwMDJlLCAweDkwMGJjLCAweDgwMDBlLCAweDgwMDhlLCAweDgwMDRlLCAweDkwMGZjLCAweDcwMTAwLCAweDgwMDUxLCAweDgwMDExLCAweDgwMTE5LCAweDcwMTEwLCAweDgwMDcxLCAweDgwMDMxLCAweDkwMGMyLCAweDcwMTA4LCAweDgwMDYxLCAweDgwMDIxLCAweDkwMGEyLCAweDgwMDAxLCAweDgwMDgxLCAweDgwMDQxLCAweDkwMGUyLCAweDcwMTA0LCAweDgwMDU5LCAweDgwMDE5LCAweDkwMDkyLCAweDcwMTE0LCAweDgwMDc5LCAweDgwMDM5LCAweDkwMGQyLCAweDcwMTBjLCAweDgwMDY5LCAweDgwMDI5LCAweDkwMGIyLCAweDgwMDA5LCAweDgwMDg5LCAweDgwMDQ5LCAweDkwMGYyLCAweDcwMTAyLCAweDgwMDU1LCAweDgwMDE1LCAweDgwMTFkLCAweDcwMTEyLCAweDgwMDc1LCAweDgwMDM1LCAweDkwMGNhLCAweDcwMTBhLCAweDgwMDY1LCAweDgwMDI1LCAweDkwMGFhLCAweDgwMDA1LCAweDgwMDg1LCAweDgwMDQ1LCAweDkwMGVhLCAweDcwMTA2LCAweDgwMDVkLCAweDgwMDFkLCAweDkwMDlhLCAweDcwMTE2LCAweDgwMDdkLCAweDgwMDNkLCAweDkwMGRhLCAweDcwMTBlLCAweDgwMDZkLCAweDgwMDJkLCAweDkwMGJhLCAweDgwMDBkLCAweDgwMDhkLCAweDgwMDRkLCAweDkwMGZhLCAweDcwMTAxLCAweDgwMDUzLCAweDgwMDEzLCAweDgwMTFiLCAweDcwMTExLCAweDgwMDczLCAweDgwMDMzLCAweDkwMGM2LCAweDcwMTA5LCAweDgwMDYzLCAweDgwMDIzLCAweDkwMGE2LCAweDgwMDAzLCAweDgwMDgzLCAweDgwMDQzLCAweDkwMGU2LCAweDcwMTA1LCAweDgwMDViLCAweDgwMDFiLCAweDkwMDk2LCAweDcwMTE1LCAweDgwMDdiLCAweDgwMDNiLCAweDkwMGQ2LCAweDcwMTBkLCAweDgwMDZiLCAweDgwMDJiLCAweDkwMGI2LCAweDgwMDBiLCAweDgwMDhiLCAweDgwMDRiLCAweDkwMGY2LCAweDcwMTAzLCAweDgwMDU3LCAweDgwMDE3LCAweDgwMTFmLCAweDcwMTEzLCAweDgwMDc3LCAweDgwMDM3LCAweDkwMGNlLCAweDcwMTBiLCAweDgwMDY3LCAweDgwMDI3LCAweDkwMGFlLCAweDgwMDA3LCAweDgwMDg3LCAweDgwMDQ3LCAweDkwMGVlLCAweDcwMTA3LCAweDgwMDVmLCAweDgwMDFmLCAweDkwMDllLCAweDcwMTE3LCAweDgwMDdmLCAweDgwMDNmLCAweDkwMGRlLCAweDcwMTBmLCAweDgwMDZmLCAweDgwMDJmLCAweDkwMGJlLCAweDgwMDBmLCAweDgwMDhmLCAweDgwMDRmLCAweDkwMGZlLCAweDcwMTAwLCAweDgwMDUwLCAweDgwMDEwLCAweDgwMTE4LCAweDcwMTEwLCAweDgwMDcwLCAweDgwMDMwLCAweDkwMGMxLCAweDcwMTA4LCAweDgwMDYwLCAweDgwMDIwLCAweDkwMGExLCAweDgwMDAwLCAweDgwMDgwLCAweDgwMDQwLCAweDkwMGUxLCAweDcwMTA0LCAweDgwMDU4LCAweDgwMDE4LCAweDkwMDkxLCAweDcwMTE0LCAweDgwMDc4LCAweDgwMDM4LCAweDkwMGQxLCAweDcwMTBjLCAweDgwMDY4LCAweDgwMDI4LCAweDkwMGIxLCAweDgwMDA4LCAweDgwMDg4LCAweDgwMDQ4LCAweDkwMGYxLCAweDcwMTAyLCAweDgwMDU0LCAweDgwMDE0LCAweDgwMTFjLCAweDcwMTEyLCAweDgwMDc0LCAweDgwMDM0LCAweDkwMGM5LCAweDcwMTBhLCAweDgwMDY0LCAweDgwMDI0LCAweDkwMGE5LCAweDgwMDA0LCAweDgwMDg0LCAweDgwMDQ0LCAweDkwMGU5LCAweDcwMTA2LCAweDgwMDVjLCAweDgwMDFjLCAweDkwMDk5LCAweDcwMTE2LCAweDgwMDdjLCAweDgwMDNjLCAweDkwMGQ5LCAweDcwMTBlLCAweDgwMDZjLCAweDgwMDJjLCAweDkwMGI5LCAweDgwMDBjLCAweDgwMDhjLCAweDgwMDRjLCAweDkwMGY5LCAweDcwMTAxLCAweDgwMDUyLCAweDgwMDEyLCAweDgwMTFhLCAweDcwMTExLCAweDgwMDcyLCAweDgwMDMyLCAweDkwMGM1LCAweDcwMTA5LCAweDgwMDYyLCAweDgwMDIyLCAweDkwMGE1LCAweDgwMDAyLCAweDgwMDgyLCAweDgwMDQyLCAweDkwMGU1LCAweDcwMTA1LCAweDgwMDVhLCAweDgwMDFhLCAweDkwMDk1LCAweDcwMTE1LCAweDgwMDdhLCAweDgwMDNhLCAweDkwMGQ1LCAweDcwMTBkLCAweDgwMDZhLCAweDgwMDJhLCAweDkwMGI1LCAweDgwMDBhLCAweDgwMDhhLCAweDgwMDRhLCAweDkwMGY1LCAweDcwMTAzLCAweDgwMDU2LCAweDgwMDE2LCAweDgwMTFlLCAweDcwMTEzLCAweDgwMDc2LCAweDgwMDM2LCAweDkwMGNkLCAweDcwMTBiLCAweDgwMDY2LCAweDgwMDI2LCAweDkwMGFkLCAweDgwMDA2LCAweDgwMDg2LCAweDgwMDQ2LCAweDkwMGVkLCAweDcwMTA3LCAweDgwMDVlLCAweDgwMDFlLCAweDkwMDlkLCAweDcwMTE3LCAweDgwMDdlLCAweDgwMDNlLCAweDkwMGRkLCAweDcwMTBmLCAweDgwMDZlLCAweDgwMDJlLCAweDkwMGJkLCAweDgwMDBlLCAweDgwMDhlLCAweDgwMDRlLCAweDkwMGZkLCAweDcwMTAwLCAweDgwMDUxLCAweDgwMDExLCAweDgwMTE5LCAweDcwMTEwLCAweDgwMDcxLCAweDgwMDMxLCAweDkwMGMzLCAweDcwMTA4LCAweDgwMDYxLCAweDgwMDIxLCAweDkwMGEzLCAweDgwMDAxLCAweDgwMDgxLCAweDgwMDQxLCAweDkwMGUzLCAweDcwMTA0LCAweDgwMDU5LCAweDgwMDE5LCAweDkwMDkzLCAweDcwMTE0LCAweDgwMDc5LCAweDgwMDM5LCAweDkwMGQzLCAweDcwMTBjLCAweDgwMDY5LCAweDgwMDI5LCAweDkwMGIzLCAweDgwMDA5LCAweDgwMDg5LCAweDgwMDQ5LCAweDkwMGYzLCAweDcwMTAyLCAweDgwMDU1LCAweDgwMDE1LCAweDgwMTFkLCAweDcwMTEyLCAweDgwMDc1LCAweDgwMDM1LCAweDkwMGNiLCAweDcwMTBhLCAweDgwMDY1LCAweDgwMDI1LCAweDkwMGFiLCAweDgwMDA1LCAweDgwMDg1LCAweDgwMDQ1LCAweDkwMGViLCAweDcwMTA2LCAweDgwMDVkLCAweDgwMDFkLCAweDkwMDliLCAweDcwMTE2LCAweDgwMDdkLCAweDgwMDNkLCAweDkwMGRiLCAweDcwMTBlLCAweDgwMDZkLCAweDgwMDJkLCAweDkwMGJiLCAweDgwMDBkLCAweDgwMDhkLCAweDgwMDRkLCAweDkwMGZiLCAweDcwMTAxLCAweDgwMDUzLCAweDgwMDEzLCAweDgwMTFiLCAweDcwMTExLCAweDgwMDczLCAweDgwMDMzLCAweDkwMGM3LCAweDcwMTA5LCAweDgwMDYzLCAweDgwMDIzLCAweDkwMGE3LCAweDgwMDAzLCAweDgwMDgzLCAweDgwMDQzLCAweDkwMGU3LCAweDcwMTA1LCAweDgwMDViLCAweDgwMDFiLCAweDkwMDk3LCAweDcwMTE1LCAweDgwMDdiLCAweDgwMDNiLCAweDkwMGQ3LCAweDcwMTBkLCAweDgwMDZiLCAweDgwMDJiLCAweDkwMGI3LCAweDgwMDBiLCAweDgwMDhiLCAweDgwMDRiLCAweDkwMGY3LCAweDcwMTAzLCAweDgwMDU3LCAweDgwMDE3LCAweDgwMTFmLCAweDcwMTEzLCAweDgwMDc3LCAweDgwMDM3LCAweDkwMGNmLCAweDcwMTBiLCAweDgwMDY3LCAweDgwMDI3LCAweDkwMGFmLCAweDgwMDA3LCAweDgwMDg3LCAweDgwMDQ3LCAweDkwMGVmLCAweDcwMTA3LCAweDgwMDVmLCAweDgwMDFmLCAweDkwMDlmLCAweDcwMTE3LCAweDgwMDdmLCAweDgwMDNmLCAweDkwMGRmLCAweDcwMTBmLCAweDgwMDZmLCAweDgwMDJmLCAweDkwMGJmLCAweDgwMDBmLCAweDgwMDhmLCAweDgwMDRmLCAweDkwMGZmXSksIDldOwogIHZhciBmaXhlZERpc3RDb2RlVGFiID0gW25ldyBJbnQzMkFycmF5KFsweDUwMDAwLCAweDUwMDEwLCAweDUwMDA4LCAweDUwMDE4LCAweDUwMDA0LCAweDUwMDE0LCAweDUwMDBjLCAweDUwMDFjLCAweDUwMDAyLCAweDUwMDEyLCAweDUwMDBhLCAweDUwMDFhLCAweDUwMDA2LCAweDUwMDE2LCAweDUwMDBlLCAweDAwMDAwLCAweDUwMDAxLCAweDUwMDExLCAweDUwMDA5LCAweDUwMDE5LCAweDUwMDA1LCAweDUwMDE1LCAweDUwMDBkLCAweDUwMDFkLCAweDUwMDAzLCAweDUwMDEzLCAweDUwMDBiLCAweDUwMDFiLCAweDUwMDA3LCAweDUwMDE3LCAweDUwMDBmLCAweDAwMDAwXSksIDVdOwoKICBmdW5jdGlvbiBGbGF0ZVN0cmVhbShzdHIsIG1heWJlTGVuZ3RoKSB7CiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwogICAgdmFyIGNtZiA9IHN0ci5nZXRCeXRlKCk7CiAgICB2YXIgZmxnID0gc3RyLmdldEJ5dGUoKTsKCiAgICBpZiAoY21mID09PSAtMSB8fCBmbGcgPT09IC0xKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBoZWFkZXIgaW4gZmxhdGUgc3RyZWFtOiAiLmNvbmNhdChjbWYsICIsICIpLmNvbmNhdChmbGcpKTsKICAgIH0KCiAgICBpZiAoKGNtZiAmIDB4MGYpICE9PSAweDA4KSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biBjb21wcmVzc2lvbiBtZXRob2QgaW4gZmxhdGUgc3RyZWFtOiAiLmNvbmNhdChjbWYsICIsICIpLmNvbmNhdChmbGcpKTsKICAgIH0KCiAgICBpZiAoKChjbWYgPDwgOCkgKyBmbGcpICUgMzEgIT09IDApIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgRkNIRUNLIGluIGZsYXRlIHN0cmVhbTogIi5jb25jYXQoY21mLCAiLCAiKS5jb25jYXQoZmxnKSk7CiAgICB9CgogICAgaWYgKGZsZyAmIDB4MjApIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJGRElDVCBiaXQgc2V0IGluIGZsYXRlIHN0cmVhbTogIi5jb25jYXQoY21mLCAiLCAiKS5jb25jYXQoZmxnKSk7CiAgICB9CgogICAgdGhpcy5jb2RlU2l6ZSA9IDA7CiAgICB0aGlzLmNvZGVCdWYgPSAwOwogICAgRGVjb2RlU3RyZWFtLmNhbGwodGhpcywgbWF5YmVMZW5ndGgpOwogIH0KCiAgRmxhdGVTdHJlYW0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShEZWNvZGVTdHJlYW0ucHJvdG90eXBlKTsKCiAgRmxhdGVTdHJlYW0ucHJvdG90eXBlLmdldEJpdHMgPSBmdW5jdGlvbiBGbGF0ZVN0cmVhbV9nZXRCaXRzKGJpdHMpIHsKICAgIHZhciBzdHIgPSB0aGlzLnN0cjsKICAgIHZhciBjb2RlU2l6ZSA9IHRoaXMuY29kZVNpemU7CiAgICB2YXIgY29kZUJ1ZiA9IHRoaXMuY29kZUJ1ZjsKICAgIHZhciBiOwoKICAgIHdoaWxlIChjb2RlU2l6ZSA8IGJpdHMpIHsKICAgICAgaWYgKChiID0gc3RyLmdldEJ5dGUoKSkgPT09IC0xKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgZW5jb2RpbmcgaW4gZmxhdGUgc3RyZWFtIik7CiAgICAgIH0KCiAgICAgIGNvZGVCdWYgfD0gYiA8PCBjb2RlU2l6ZTsKICAgICAgY29kZVNpemUgKz0gODsKICAgIH0KCiAgICBiID0gY29kZUJ1ZiAmICgxIDw8IGJpdHMpIC0gMTsKICAgIHRoaXMuY29kZUJ1ZiA9IGNvZGVCdWYgPj4gYml0czsKICAgIHRoaXMuY29kZVNpemUgPSBjb2RlU2l6ZSAtPSBiaXRzOwogICAgcmV0dXJuIGI7CiAgfTsKCiAgRmxhdGVTdHJlYW0ucHJvdG90eXBlLmdldENvZGUgPSBmdW5jdGlvbiBGbGF0ZVN0cmVhbV9nZXRDb2RlKHRhYmxlKSB7CiAgICB2YXIgc3RyID0gdGhpcy5zdHI7CiAgICB2YXIgY29kZXMgPSB0YWJsZVswXTsKICAgIHZhciBtYXhMZW4gPSB0YWJsZVsxXTsKICAgIHZhciBjb2RlU2l6ZSA9IHRoaXMuY29kZVNpemU7CiAgICB2YXIgY29kZUJ1ZiA9IHRoaXMuY29kZUJ1ZjsKICAgIHZhciBiOwoKICAgIHdoaWxlIChjb2RlU2l6ZSA8IG1heExlbikgewogICAgICBpZiAoKGIgPSBzdHIuZ2V0Qnl0ZSgpKSA9PT0gLTEpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY29kZUJ1ZiB8PSBiIDw8IGNvZGVTaXplOwogICAgICBjb2RlU2l6ZSArPSA4OwogICAgfQoKICAgIHZhciBjb2RlID0gY29kZXNbY29kZUJ1ZiAmICgxIDw8IG1heExlbikgLSAxXTsKICAgIHZhciBjb2RlTGVuID0gY29kZSA+PiAxNjsKICAgIHZhciBjb2RlVmFsID0gY29kZSAmIDB4ZmZmZjsKCiAgICBpZiAoY29kZUxlbiA8IDEgfHwgY29kZVNpemUgPCBjb2RlTGVuKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGVuY29kaW5nIGluIGZsYXRlIHN0cmVhbSIpOwogICAgfQoKICAgIHRoaXMuY29kZUJ1ZiA9IGNvZGVCdWYgPj4gY29kZUxlbjsKICAgIHRoaXMuY29kZVNpemUgPSBjb2RlU2l6ZSAtIGNvZGVMZW47CiAgICByZXR1cm4gY29kZVZhbDsKICB9OwoKICBGbGF0ZVN0cmVhbS5wcm90b3R5cGUuZ2VuZXJhdGVIdWZmbWFuVGFibGUgPSBmdW5jdGlvbiBmbGF0ZVN0cmVhbUdlbmVyYXRlSHVmZm1hblRhYmxlKGxlbmd0aHMpIHsKICAgIHZhciBuID0gbGVuZ3Rocy5sZW5ndGg7CiAgICB2YXIgbWF4TGVuID0gMDsKICAgIHZhciBpOwoKICAgIGZvciAoaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgaWYgKGxlbmd0aHNbaV0gPiBtYXhMZW4pIHsKICAgICAgICBtYXhMZW4gPSBsZW5ndGhzW2ldOwogICAgICB9CiAgICB9CgogICAgdmFyIHNpemUgPSAxIDw8IG1heExlbjsKICAgIHZhciBjb2RlcyA9IG5ldyBJbnQzMkFycmF5KHNpemUpOwoKICAgIGZvciAodmFyIGxlbiA9IDEsIGNvZGUgPSAwLCBza2lwID0gMjsgbGVuIDw9IG1heExlbjsgKytsZW4sIGNvZGUgPDw9IDEsIHNraXAgPDw9IDEpIHsKICAgICAgZm9yICh2YXIgdmFsID0gMDsgdmFsIDwgbjsgKyt2YWwpIHsKICAgICAgICBpZiAobGVuZ3Roc1t2YWxdID09PSBsZW4pIHsKICAgICAgICAgIHZhciBjb2RlMiA9IDA7CiAgICAgICAgICB2YXIgdCA9IGNvZGU7CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7CiAgICAgICAgICAgIGNvZGUyID0gY29kZTIgPDwgMSB8IHQgJiAxOwogICAgICAgICAgICB0ID4+PSAxOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAoaSA9IGNvZGUyOyBpIDwgc2l6ZTsgaSArPSBza2lwKSB7CiAgICAgICAgICAgIGNvZGVzW2ldID0gbGVuIDw8IDE2IHwgdmFsOwogICAgICAgICAgfQoKICAgICAgICAgICsrY29kZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gW2NvZGVzLCBtYXhMZW5dOwogIH07CgogIEZsYXRlU3RyZWFtLnByb3RvdHlwZS5yZWFkQmxvY2sgPSBmdW5jdGlvbiBGbGF0ZVN0cmVhbV9yZWFkQmxvY2soKSB7CiAgICB2YXIgYnVmZmVyLCBsZW47CiAgICB2YXIgc3RyID0gdGhpcy5zdHI7CiAgICB2YXIgaGRyID0gdGhpcy5nZXRCaXRzKDMpOwoKICAgIGlmIChoZHIgJiAxKSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgIH0KCiAgICBoZHIgPj49IDE7CgogICAgaWYgKGhkciA9PT0gMCkgewogICAgICB2YXIgYjsKCiAgICAgIGlmICgoYiA9IHN0ci5nZXRCeXRlKCkpID09PSAtMSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGJsb2NrIGhlYWRlciBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgICAgfQoKICAgICAgdmFyIGJsb2NrTGVuID0gYjsKCiAgICAgIGlmICgoYiA9IHN0ci5nZXRCeXRlKCkpID09PSAtMSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiQmFkIGJsb2NrIGhlYWRlciBpbiBmbGF0ZSBzdHJlYW0iKTsKICAgICAgfQoKICAgICAgYmxvY2tMZW4gfD0gYiA8PCA4OwoKICAgICAgaWYgKChiID0gc3RyLmdldEJ5dGUoKSkgPT09IC0xKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgYmxvY2sgaGVhZGVyIGluIGZsYXRlIHN0cmVhbSIpOwogICAgICB9CgogICAgICB2YXIgY2hlY2sgPSBiOwoKICAgICAgaWYgKChiID0gc3RyLmdldEJ5dGUoKSkgPT09IC0xKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgYmxvY2sgaGVhZGVyIGluIGZsYXRlIHN0cmVhbSIpOwogICAgICB9CgogICAgICBjaGVjayB8PSBiIDw8IDg7CgogICAgICBpZiAoY2hlY2sgIT09ICh+YmxvY2tMZW4gJiAweGZmZmYpICYmIChibG9ja0xlbiAhPT0gMCB8fCBjaGVjayAhPT0gMCkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkJhZCB1bmNvbXByZXNzZWQgYmxvY2sgbGVuZ3RoIGluIGZsYXRlIHN0cmVhbSIpOwogICAgICB9CgogICAgICB0aGlzLmNvZGVCdWYgPSAwOwogICAgICB0aGlzLmNvZGVTaXplID0gMDsKICAgICAgdmFyIGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoLAogICAgICAgICAgZW5kID0gYnVmZmVyTGVuZ3RoICsgYmxvY2tMZW47CiAgICAgIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGVuZCk7CiAgICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gZW5kOwoKICAgICAgaWYgKGJsb2NrTGVuID09PSAwKSB7CiAgICAgICAgaWYgKHN0ci5wZWVrQnl0ZSgpID09PSAtMSkgewogICAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgYmxvY2sgPSBzdHIuZ2V0Qnl0ZXMoYmxvY2tMZW4pOwogICAgICAgIGJ1ZmZlci5zZXQoYmxvY2ssIGJ1ZmZlckxlbmd0aCk7CgogICAgICAgIGlmIChibG9jay5sZW5ndGggPCBibG9ja0xlbikgewogICAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBsaXRDb2RlVGFibGU7CiAgICB2YXIgZGlzdENvZGVUYWJsZTsKCiAgICBpZiAoaGRyID09PSAxKSB7CiAgICAgIGxpdENvZGVUYWJsZSA9IGZpeGVkTGl0Q29kZVRhYjsKICAgICAgZGlzdENvZGVUYWJsZSA9IGZpeGVkRGlzdENvZGVUYWI7CiAgICB9IGVsc2UgaWYgKGhkciA9PT0gMikgewogICAgICB2YXIgbnVtTGl0Q29kZXMgPSB0aGlzLmdldEJpdHMoNSkgKyAyNTc7CiAgICAgIHZhciBudW1EaXN0Q29kZXMgPSB0aGlzLmdldEJpdHMoNSkgKyAxOwogICAgICB2YXIgbnVtQ29kZUxlbkNvZGVzID0gdGhpcy5nZXRCaXRzKDQpICsgNDsKICAgICAgdmFyIGNvZGVMZW5Db2RlTGVuZ3RocyA9IG5ldyBVaW50OEFycmF5KGNvZGVMZW5Db2RlTWFwLmxlbmd0aCk7CiAgICAgIHZhciBpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IG51bUNvZGVMZW5Db2RlczsgKytpKSB7CiAgICAgICAgY29kZUxlbkNvZGVMZW5ndGhzW2NvZGVMZW5Db2RlTWFwW2ldXSA9IHRoaXMuZ2V0Qml0cygzKTsKICAgICAgfQoKICAgICAgdmFyIGNvZGVMZW5Db2RlVGFiID0gdGhpcy5nZW5lcmF0ZUh1ZmZtYW5UYWJsZShjb2RlTGVuQ29kZUxlbmd0aHMpOwogICAgICBsZW4gPSAwOwogICAgICBpID0gMDsKICAgICAgdmFyIGNvZGVzID0gbnVtTGl0Q29kZXMgKyBudW1EaXN0Q29kZXM7CiAgICAgIHZhciBjb2RlTGVuZ3RocyA9IG5ldyBVaW50OEFycmF5KGNvZGVzKTsKICAgICAgdmFyIGJpdHNMZW5ndGgsIGJpdHNPZmZzZXQsIHdoYXQ7CgogICAgICB3aGlsZSAoaSA8IGNvZGVzKSB7CiAgICAgICAgdmFyIGNvZGUgPSB0aGlzLmdldENvZGUoY29kZUxlbkNvZGVUYWIpOwoKICAgICAgICBpZiAoY29kZSA9PT0gMTYpIHsKICAgICAgICAgIGJpdHNMZW5ndGggPSAyOwogICAgICAgICAgYml0c09mZnNldCA9IDM7CiAgICAgICAgICB3aGF0ID0gbGVuOwogICAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gMTcpIHsKICAgICAgICAgIGJpdHNMZW5ndGggPSAzOwogICAgICAgICAgYml0c09mZnNldCA9IDM7CiAgICAgICAgICB3aGF0ID0gbGVuID0gMDsKICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IDE4KSB7CiAgICAgICAgICBiaXRzTGVuZ3RoID0gNzsKICAgICAgICAgIGJpdHNPZmZzZXQgPSAxMTsKICAgICAgICAgIHdoYXQgPSBsZW4gPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb2RlTGVuZ3Roc1tpKytdID0gbGVuID0gY29kZTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHJlcGVhdExlbmd0aCA9IHRoaXMuZ2V0Qml0cyhiaXRzTGVuZ3RoKSArIGJpdHNPZmZzZXQ7CgogICAgICAgIHdoaWxlIChyZXBlYXRMZW5ndGgtLSA+IDApIHsKICAgICAgICAgIGNvZGVMZW5ndGhzW2krK10gPSB3aGF0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgbGl0Q29kZVRhYmxlID0gdGhpcy5nZW5lcmF0ZUh1ZmZtYW5UYWJsZShjb2RlTGVuZ3Rocy5zdWJhcnJheSgwLCBudW1MaXRDb2RlcykpOwogICAgICBkaXN0Q29kZVRhYmxlID0gdGhpcy5nZW5lcmF0ZUh1ZmZtYW5UYWJsZShjb2RlTGVuZ3Rocy5zdWJhcnJheShudW1MaXRDb2RlcywgY29kZXMpKTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biBibG9jayB0eXBlIGluIGZsYXRlIHN0cmVhbSIpOwogICAgfQoKICAgIGJ1ZmZlciA9IHRoaXMuYnVmZmVyOwogICAgdmFyIGxpbWl0ID0gYnVmZmVyID8gYnVmZmVyLmxlbmd0aCA6IDA7CiAgICB2YXIgcG9zID0gdGhpcy5idWZmZXJMZW5ndGg7CgogICAgd2hpbGUgKHRydWUpIHsKICAgICAgdmFyIGNvZGUxID0gdGhpcy5nZXRDb2RlKGxpdENvZGVUYWJsZSk7CgogICAgICBpZiAoY29kZTEgPCAyNTYpIHsKICAgICAgICBpZiAocG9zICsgMSA+PSBsaW1pdCkgewogICAgICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIocG9zICsgMSk7CiAgICAgICAgICBsaW1pdCA9IGJ1ZmZlci5sZW5ndGg7CiAgICAgICAgfQoKICAgICAgICBidWZmZXJbcG9zKytdID0gY29kZTE7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChjb2RlMSA9PT0gMjU2KSB7CiAgICAgICAgdGhpcy5idWZmZXJMZW5ndGggPSBwb3M7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb2RlMSAtPSAyNTc7CiAgICAgIGNvZGUxID0gbGVuZ3RoRGVjb2RlW2NvZGUxXTsKICAgICAgdmFyIGNvZGUyID0gY29kZTEgPj4gMTY7CgogICAgICBpZiAoY29kZTIgPiAwKSB7CiAgICAgICAgY29kZTIgPSB0aGlzLmdldEJpdHMoY29kZTIpOwogICAgICB9CgogICAgICBsZW4gPSAoY29kZTEgJiAweGZmZmYpICsgY29kZTI7CiAgICAgIGNvZGUxID0gdGhpcy5nZXRDb2RlKGRpc3RDb2RlVGFibGUpOwogICAgICBjb2RlMSA9IGRpc3REZWNvZGVbY29kZTFdOwogICAgICBjb2RlMiA9IGNvZGUxID4+IDE2OwoKICAgICAgaWYgKGNvZGUyID4gMCkgewogICAgICAgIGNvZGUyID0gdGhpcy5nZXRCaXRzKGNvZGUyKTsKICAgICAgfQoKICAgICAgdmFyIGRpc3QgPSAoY29kZTEgJiAweGZmZmYpICsgY29kZTI7CgogICAgICBpZiAocG9zICsgbGVuID49IGxpbWl0KSB7CiAgICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIocG9zICsgbGVuKTsKICAgICAgICBsaW1pdCA9IGJ1ZmZlci5sZW5ndGg7CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgbGVuOyArK2ssICsrcG9zKSB7CiAgICAgICAgYnVmZmVyW3Bvc10gPSBidWZmZXJbcG9zIC0gZGlzdF07CiAgICAgIH0KICAgIH0KICB9OwoKICByZXR1cm4gRmxhdGVTdHJlYW07Cn0oKTsKCmV4cG9ydHMuRmxhdGVTdHJlYW0gPSBGbGF0ZVN0cmVhbTsKCnZhciBQcmVkaWN0b3JTdHJlYW0gPSBmdW5jdGlvbiBQcmVkaWN0b3JTdHJlYW1DbG9zdXJlKCkgewogIGZ1bmN0aW9uIFByZWRpY3RvclN0cmVhbShzdHIsIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkocGFyYW1zKSkgewogICAgICByZXR1cm4gc3RyOwogICAgfQoKICAgIHZhciBwcmVkaWN0b3IgPSB0aGlzLnByZWRpY3RvciA9IHBhcmFtcy5nZXQoIlByZWRpY3RvciIpIHx8IDE7CgogICAgaWYgKHByZWRpY3RvciA8PSAxKSB7CiAgICAgIHJldHVybiBzdHI7CiAgICB9CgogICAgaWYgKHByZWRpY3RvciAhPT0gMiAmJiAocHJlZGljdG9yIDwgMTAgfHwgcHJlZGljdG9yID4gMTUpKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5zdXBwb3J0ZWQgcHJlZGljdG9yOiAiLmNvbmNhdChwcmVkaWN0b3IpKTsKICAgIH0KCiAgICBpZiAocHJlZGljdG9yID09PSAyKSB7CiAgICAgIHRoaXMucmVhZEJsb2NrID0gdGhpcy5yZWFkQmxvY2tUaWZmOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5yZWFkQmxvY2sgPSB0aGlzLnJlYWRCbG9ja1BuZzsKICAgIH0KCiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwogICAgdmFyIGNvbG9ycyA9IHRoaXMuY29sb3JzID0gcGFyYW1zLmdldCgiQ29sb3JzIikgfHwgMTsKICAgIHZhciBiaXRzID0gdGhpcy5iaXRzID0gcGFyYW1zLmdldCgiQml0c1BlckNvbXBvbmVudCIpIHx8IDg7CiAgICB2YXIgY29sdW1ucyA9IHRoaXMuY29sdW1ucyA9IHBhcmFtcy5nZXQoIkNvbHVtbnMiKSB8fCAxOwogICAgdGhpcy5waXhCeXRlcyA9IGNvbG9ycyAqIGJpdHMgKyA3ID4+IDM7CiAgICB0aGlzLnJvd0J5dGVzID0gY29sdW1ucyAqIGNvbG9ycyAqIGJpdHMgKyA3ID4+IDM7CiAgICBEZWNvZGVTdHJlYW0uY2FsbCh0aGlzLCBtYXliZUxlbmd0aCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIFByZWRpY3RvclN0cmVhbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKERlY29kZVN0cmVhbS5wcm90b3R5cGUpOwoKICBQcmVkaWN0b3JTdHJlYW0ucHJvdG90eXBlLnJlYWRCbG9ja1RpZmYgPSBmdW5jdGlvbiBwcmVkaWN0b3JTdHJlYW1SZWFkQmxvY2tUaWZmKCkgewogICAgdmFyIHJvd0J5dGVzID0gdGhpcy5yb3dCeXRlczsKICAgIHZhciBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIHZhciBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcihidWZmZXJMZW5ndGggKyByb3dCeXRlcyk7CiAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKICAgIHZhciBjb2xvcnMgPSB0aGlzLmNvbG9yczsKICAgIHZhciByYXdCeXRlcyA9IHRoaXMuc3RyLmdldEJ5dGVzKHJvd0J5dGVzKTsKICAgIHRoaXMuZW9mID0gIXJhd0J5dGVzLmxlbmd0aDsKCiAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBpbmJ1ZiA9IDAsCiAgICAgICAgb3V0YnVmID0gMDsKICAgIHZhciBpbmJpdHMgPSAwLAogICAgICAgIG91dGJpdHMgPSAwOwogICAgdmFyIHBvcyA9IGJ1ZmZlckxlbmd0aDsKICAgIHZhciBpOwoKICAgIGlmIChiaXRzID09PSAxICYmIGNvbG9ycyA9PT0gMSkgewogICAgICBmb3IgKGkgPSAwOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgIHZhciBjID0gcmF3Qnl0ZXNbaV0gXiBpbmJ1ZjsKICAgICAgICBjIF49IGMgPj4gMTsKICAgICAgICBjIF49IGMgPj4gMjsKICAgICAgICBjIF49IGMgPj4gNDsKICAgICAgICBpbmJ1ZiA9IChjICYgMSkgPDwgNzsKICAgICAgICBidWZmZXJbcG9zKytdID0gYzsKICAgICAgfQogICAgfSBlbHNlIGlmIChiaXRzID09PSA4KSB7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBjb2xvcnM7ICsraSkgewogICAgICAgIGJ1ZmZlcltwb3MrK10gPSByYXdCeXRlc1tpXTsKICAgICAgfQoKICAgICAgZm9yICg7IGkgPCByb3dCeXRlczsgKytpKSB7CiAgICAgICAgYnVmZmVyW3Bvc10gPSBidWZmZXJbcG9zIC0gY29sb3JzXSArIHJhd0J5dGVzW2ldOwogICAgICAgIHBvcysrOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGJpdHMgPT09IDE2KSB7CiAgICAgIHZhciBieXRlc1BlclBpeGVsID0gY29sb3JzICogMjsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBieXRlc1BlclBpeGVsOyArK2kpIHsKICAgICAgICBidWZmZXJbcG9zKytdID0gcmF3Qnl0ZXNbaV07CiAgICAgIH0KCiAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7IGkgKz0gMikgewogICAgICAgIHZhciBzdW0gPSAoKHJhd0J5dGVzW2ldICYgMHhmZikgPDwgOCkgKyAocmF3Qnl0ZXNbaSArIDFdICYgMHhmZikgKyAoKGJ1ZmZlcltwb3MgLSBieXRlc1BlclBpeGVsXSAmIDB4ZmYpIDw8IDgpICsgKGJ1ZmZlcltwb3MgLSBieXRlc1BlclBpeGVsICsgMV0gJiAweGZmKTsKICAgICAgICBidWZmZXJbcG9zKytdID0gc3VtID4+IDggJiAweGZmOwogICAgICAgIGJ1ZmZlcltwb3MrK10gPSBzdW0gJiAweGZmOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB2YXIgY29tcEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoY29sb3JzICsgMSk7CiAgICAgIHZhciBiaXRNYXNrID0gKDEgPDwgYml0cykgLSAxOwogICAgICB2YXIgaiA9IDAsCiAgICAgICAgICBrID0gYnVmZmVyTGVuZ3RoOwogICAgICB2YXIgY29sdW1ucyA9IHRoaXMuY29sdW1uczsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBjb2x1bW5zOyArK2kpIHsKICAgICAgICBmb3IgKHZhciBrayA9IDA7IGtrIDwgY29sb3JzOyArK2trKSB7CiAgICAgICAgICBpZiAoaW5iaXRzIDwgYml0cykgewogICAgICAgICAgICBpbmJ1ZiA9IGluYnVmIDw8IDggfCByYXdCeXRlc1tqKytdICYgMHhmZjsKICAgICAgICAgICAgaW5iaXRzICs9IDg7CiAgICAgICAgICB9CgogICAgICAgICAgY29tcEFycmF5W2trXSA9IGNvbXBBcnJheVtra10gKyAoaW5idWYgPj4gaW5iaXRzIC0gYml0cykgJiBiaXRNYXNrOwogICAgICAgICAgaW5iaXRzIC09IGJpdHM7CiAgICAgICAgICBvdXRidWYgPSBvdXRidWYgPDwgYml0cyB8IGNvbXBBcnJheVtra107CiAgICAgICAgICBvdXRiaXRzICs9IGJpdHM7CgogICAgICAgICAgaWYgKG91dGJpdHMgPj0gOCkgewogICAgICAgICAgICBidWZmZXJbaysrXSA9IG91dGJ1ZiA+PiBvdXRiaXRzIC0gOCAmIDB4ZmY7CiAgICAgICAgICAgIG91dGJpdHMgLT0gODsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChvdXRiaXRzID4gMCkgewogICAgICAgIGJ1ZmZlcltrKytdID0gKG91dGJ1ZiA8PCA4IC0gb3V0Yml0cykgKyAoaW5idWYgJiAoMSA8PCA4IC0gb3V0Yml0cykgLSAxKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMuYnVmZmVyTGVuZ3RoICs9IHJvd0J5dGVzOwogIH07CgogIFByZWRpY3RvclN0cmVhbS5wcm90b3R5cGUucmVhZEJsb2NrUG5nID0gZnVuY3Rpb24gcHJlZGljdG9yU3RyZWFtUmVhZEJsb2NrUG5nKCkgewogICAgdmFyIHJvd0J5dGVzID0gdGhpcy5yb3dCeXRlczsKICAgIHZhciBwaXhCeXRlcyA9IHRoaXMucGl4Qnl0ZXM7CiAgICB2YXIgcHJlZGljdG9yID0gdGhpcy5zdHIuZ2V0Qnl0ZSgpOwogICAgdmFyIHJhd0J5dGVzID0gdGhpcy5zdHIuZ2V0Qnl0ZXMocm93Qnl0ZXMpOwogICAgdGhpcy5lb2YgPSAhcmF3Qnl0ZXMubGVuZ3RoOwoKICAgIGlmICh0aGlzLmVvZikgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyTGVuZ3RoOwogICAgdmFyIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKGJ1ZmZlckxlbmd0aCArIHJvd0J5dGVzKTsKICAgIHZhciBwcmV2Um93ID0gYnVmZmVyLnN1YmFycmF5KGJ1ZmZlckxlbmd0aCAtIHJvd0J5dGVzLCBidWZmZXJMZW5ndGgpOwoKICAgIGlmIChwcmV2Um93Lmxlbmd0aCA9PT0gMCkgewogICAgICBwcmV2Um93ID0gbmV3IFVpbnQ4QXJyYXkocm93Qnl0ZXMpOwogICAgfQoKICAgIHZhciBpLAogICAgICAgIGogPSBidWZmZXJMZW5ndGgsCiAgICAgICAgdXAsCiAgICAgICAgYzsKCiAgICBzd2l0Y2ggKHByZWRpY3RvcikgewogICAgICBjYXNlIDA6CiAgICAgICAgZm9yIChpID0gMDsgaSA8IHJvd0J5dGVzOyArK2kpIHsKICAgICAgICAgIGJ1ZmZlcltqKytdID0gcmF3Qnl0ZXNbaV07CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMToKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGl4Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2orK10gPSByYXdCeXRlc1tpXTsKICAgICAgICB9CgogICAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2pdID0gYnVmZmVyW2ogLSBwaXhCeXRlc10gKyByYXdCeXRlc1tpXSAmIDB4ZmY7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2orK10gPSBwcmV2Um93W2ldICsgcmF3Qnl0ZXNbaV0gJiAweGZmOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDM6CiAgICAgICAgZm9yIChpID0gMDsgaSA8IHBpeEJ5dGVzOyArK2kpIHsKICAgICAgICAgIGJ1ZmZlcltqKytdID0gKHByZXZSb3dbaV0gPj4gMSkgKyByYXdCeXRlc1tpXTsKICAgICAgICB9CgogICAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgYnVmZmVyW2pdID0gKHByZXZSb3dbaV0gKyBidWZmZXJbaiAtIHBpeEJ5dGVzXSA+PiAxKSArIHJhd0J5dGVzW2ldICYgMHhmZjsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA0OgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBwaXhCeXRlczsgKytpKSB7CiAgICAgICAgICB1cCA9IHByZXZSb3dbaV07CiAgICAgICAgICBjID0gcmF3Qnl0ZXNbaV07CiAgICAgICAgICBidWZmZXJbaisrXSA9IHVwICsgYzsKICAgICAgICB9CgogICAgICAgIGZvciAoOyBpIDwgcm93Qnl0ZXM7ICsraSkgewogICAgICAgICAgdXAgPSBwcmV2Um93W2ldOwogICAgICAgICAgdmFyIHVwTGVmdCA9IHByZXZSb3dbaSAtIHBpeEJ5dGVzXTsKICAgICAgICAgIHZhciBsZWZ0ID0gYnVmZmVyW2ogLSBwaXhCeXRlc107CiAgICAgICAgICB2YXIgcCA9IGxlZnQgKyB1cCAtIHVwTGVmdDsKICAgICAgICAgIHZhciBwYSA9IHAgLSBsZWZ0OwoKICAgICAgICAgIGlmIChwYSA8IDApIHsKICAgICAgICAgICAgcGEgPSAtcGE7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHBiID0gcCAtIHVwOwoKICAgICAgICAgIGlmIChwYiA8IDApIHsKICAgICAgICAgICAgcGIgPSAtcGI7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHBjID0gcCAtIHVwTGVmdDsKCiAgICAgICAgICBpZiAocGMgPCAwKSB7CiAgICAgICAgICAgIHBjID0gLXBjOwogICAgICAgICAgfQoKICAgICAgICAgIGMgPSByYXdCeXRlc1tpXTsKCiAgICAgICAgICBpZiAocGEgPD0gcGIgJiYgcGEgPD0gcGMpIHsKICAgICAgICAgICAgYnVmZmVyW2orK10gPSBsZWZ0ICsgYzsKICAgICAgICAgIH0gZWxzZSBpZiAocGIgPD0gcGMpIHsKICAgICAgICAgICAgYnVmZmVyW2orK10gPSB1cCArIGM7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBidWZmZXJbaisrXSA9IHVwTGVmdCArIGM7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbnN1cHBvcnRlZCBwcmVkaWN0b3I6ICIuY29uY2F0KHByZWRpY3RvcikpOwogICAgfQoKICAgIHRoaXMuYnVmZmVyTGVuZ3RoICs9IHJvd0J5dGVzOwogIH07CgogIHJldHVybiBQcmVkaWN0b3JTdHJlYW07Cn0oKTsKCmV4cG9ydHMuUHJlZGljdG9yU3RyZWFtID0gUHJlZGljdG9yU3RyZWFtOwoKdmFyIERlY3J5cHRTdHJlYW0gPSBmdW5jdGlvbiBEZWNyeXB0U3RyZWFtQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBEZWNyeXB0U3RyZWFtKHN0ciwgbWF5YmVMZW5ndGgsIGRlY3J5cHQpIHsKICAgIHRoaXMuc3RyID0gc3RyOwogICAgdGhpcy5kaWN0ID0gc3RyLmRpY3Q7CiAgICB0aGlzLmRlY3J5cHQgPSBkZWNyeXB0OwogICAgdGhpcy5uZXh0Q2h1bmsgPSBudWxsOwogICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlOwogICAgRGVjb2RlU3RyZWFtLmNhbGwodGhpcywgbWF5YmVMZW5ndGgpOwogIH0KCiAgdmFyIGNodW5rU2l6ZSA9IDUxMjsKICBEZWNyeXB0U3RyZWFtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRGVjb2RlU3RyZWFtLnByb3RvdHlwZSk7CgogIERlY3J5cHRTdHJlYW0ucHJvdG90eXBlLnJlYWRCbG9jayA9IGZ1bmN0aW9uIERlY3J5cHRTdHJlYW1fcmVhZEJsb2NrKCkgewogICAgdmFyIGNodW5rOwoKICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7CiAgICAgIGNodW5rID0gdGhpcy5uZXh0Q2h1bms7CiAgICB9IGVsc2UgewogICAgICBjaHVuayA9IHRoaXMuc3RyLmdldEJ5dGVzKGNodW5rU2l6ZSk7CiAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlOwogICAgfQoKICAgIGlmICghY2h1bmsgfHwgY2h1bmsubGVuZ3RoID09PSAwKSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMubmV4dENodW5rID0gdGhpcy5zdHIuZ2V0Qnl0ZXMoY2h1bmtTaXplKTsKICAgIHZhciBoYXNNb3JlRGF0YSA9IHRoaXMubmV4dENodW5rICYmIHRoaXMubmV4dENodW5rLmxlbmd0aCA+IDA7CiAgICB2YXIgZGVjcnlwdCA9IHRoaXMuZGVjcnlwdDsKICAgIGNodW5rID0gZGVjcnlwdChjaHVuaywgIWhhc01vcmVEYXRhKTsKICAgIHZhciBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIHZhciBpLAogICAgICAgIG4gPSBjaHVuay5sZW5ndGg7CiAgICB2YXIgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIoYnVmZmVyTGVuZ3RoICsgbik7CgogICAgZm9yIChpID0gMDsgaSA8IG47IGkrKykgewogICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gY2h1bmtbaV07CiAgICB9CgogICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgfTsKCiAgcmV0dXJuIERlY3J5cHRTdHJlYW07Cn0oKTsKCmV4cG9ydHMuRGVjcnlwdFN0cmVhbSA9IERlY3J5cHRTdHJlYW07Cgp2YXIgQXNjaWk4NVN0cmVhbSA9IGZ1bmN0aW9uIEFzY2lpODVTdHJlYW1DbG9zdXJlKCkgewogIGZ1bmN0aW9uIEFzY2lpODVTdHJlYW0oc3RyLCBtYXliZUxlbmd0aCkgewogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICAgIHRoaXMuaW5wdXQgPSBuZXcgVWludDhBcnJheSg1KTsKCiAgICBpZiAobWF5YmVMZW5ndGgpIHsKICAgICAgbWF5YmVMZW5ndGggPSAwLjggKiBtYXliZUxlbmd0aDsKICAgIH0KCiAgICBEZWNvZGVTdHJlYW0uY2FsbCh0aGlzLCBtYXliZUxlbmd0aCk7CiAgfQoKICBBc2NpaTg1U3RyZWFtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRGVjb2RlU3RyZWFtLnByb3RvdHlwZSk7CgogIEFzY2lpODVTdHJlYW0ucHJvdG90eXBlLnJlYWRCbG9jayA9IGZ1bmN0aW9uIEFzY2lpODVTdHJlYW1fcmVhZEJsb2NrKCkgewogICAgdmFyIFRJTERBX0NIQVIgPSAweDdlOwogICAgdmFyIFpfTE9XRVJfQ0hBUiA9IDB4N2E7CiAgICB2YXIgRU9GID0gLTE7CiAgICB2YXIgc3RyID0gdGhpcy5zdHI7CiAgICB2YXIgYyA9IHN0ci5nZXRCeXRlKCk7CgogICAgd2hpbGUgKCgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGMpKSB7CiAgICAgIGMgPSBzdHIuZ2V0Qnl0ZSgpOwogICAgfQoKICAgIGlmIChjID09PSBFT0YgfHwgYyA9PT0gVElMREFfQ0hBUikgewogICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJMZW5ndGgsCiAgICAgICAgYnVmZmVyOwogICAgdmFyIGk7CgogICAgaWYgKGMgPT09IFpfTE9XRVJfQ0hBUikgewogICAgICBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcihidWZmZXJMZW5ndGggKyA0KTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCA0OyArK2kpIHsKICAgICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoICsgaV0gPSAwOwogICAgICB9CgogICAgICB0aGlzLmJ1ZmZlckxlbmd0aCArPSA0OwogICAgfSBlbHNlIHsKICAgICAgdmFyIGlucHV0ID0gdGhpcy5pbnB1dDsKICAgICAgaW5wdXRbMF0gPSBjOwoKICAgICAgZm9yIChpID0gMTsgaSA8IDU7ICsraSkgewogICAgICAgIGMgPSBzdHIuZ2V0Qnl0ZSgpOwoKICAgICAgICB3aGlsZSAoKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoYykpIHsKICAgICAgICAgIGMgPSBzdHIuZ2V0Qnl0ZSgpOwogICAgICAgIH0KCiAgICAgICAgaW5wdXRbaV0gPSBjOwoKICAgICAgICBpZiAoYyA9PT0gRU9GIHx8IGMgPT09IFRJTERBX0NIQVIpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIoYnVmZmVyTGVuZ3RoICsgaSAtIDEpOwogICAgICB0aGlzLmJ1ZmZlckxlbmd0aCArPSBpIC0gMTsKCiAgICAgIGlmIChpIDwgNSkgewogICAgICAgIGZvciAoOyBpIDwgNTsgKytpKSB7CiAgICAgICAgICBpbnB1dFtpXSA9IDB4MjEgKyA4NDsKICAgICAgICB9CgogICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgfQoKICAgICAgdmFyIHQgPSAwOwoKICAgICAgZm9yIChpID0gMDsgaSA8IDU7ICsraSkgewogICAgICAgIHQgPSB0ICogODUgKyAoaW5wdXRbaV0gLSAweDIxKTsKICAgICAgfQoKICAgICAgZm9yIChpID0gMzsgaSA+PSAwOyAtLWkpIHsKICAgICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoICsgaV0gPSB0ICYgMHhmZjsKICAgICAgICB0ID4+PSA4OwogICAgICB9CiAgICB9CiAgfTsKCiAgcmV0dXJuIEFzY2lpODVTdHJlYW07Cn0oKTsKCmV4cG9ydHMuQXNjaWk4NVN0cmVhbSA9IEFzY2lpODVTdHJlYW07Cgp2YXIgQXNjaWlIZXhTdHJlYW0gPSBmdW5jdGlvbiBBc2NpaUhleFN0cmVhbUNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQXNjaWlIZXhTdHJlYW0oc3RyLCBtYXliZUxlbmd0aCkgewogICAgdGhpcy5zdHIgPSBzdHI7CiAgICB0aGlzLmRpY3QgPSBzdHIuZGljdDsKICAgIHRoaXMuZmlyc3REaWdpdCA9IC0xOwoKICAgIGlmIChtYXliZUxlbmd0aCkgewogICAgICBtYXliZUxlbmd0aCA9IDAuNSAqIG1heWJlTGVuZ3RoOwogICAgfQoKICAgIERlY29kZVN0cmVhbS5jYWxsKHRoaXMsIG1heWJlTGVuZ3RoKTsKICB9CgogIEFzY2lpSGV4U3RyZWFtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRGVjb2RlU3RyZWFtLnByb3RvdHlwZSk7CgogIEFzY2lpSGV4U3RyZWFtLnByb3RvdHlwZS5yZWFkQmxvY2sgPSBmdW5jdGlvbiBBc2NpaUhleFN0cmVhbV9yZWFkQmxvY2soKSB7CiAgICB2YXIgVVBTVFJFQU1fQkxPQ0tfU0laRSA9IDgwMDA7CiAgICB2YXIgYnl0ZXMgPSB0aGlzLnN0ci5nZXRCeXRlcyhVUFNUUkVBTV9CTE9DS19TSVpFKTsKCiAgICBpZiAoIWJ5dGVzLmxlbmd0aCkgewogICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgbWF4RGVjb2RlTGVuZ3RoID0gYnl0ZXMubGVuZ3RoICsgMSA+PiAxOwogICAgdmFyIGJ1ZmZlciA9IHRoaXMuZW5zdXJlQnVmZmVyKHRoaXMuYnVmZmVyTGVuZ3RoICsgbWF4RGVjb2RlTGVuZ3RoKTsKICAgIHZhciBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKICAgIHZhciBmaXJzdERpZ2l0ID0gdGhpcy5maXJzdERpZ2l0OwoKICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGJ5dGVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgdmFyIGNoID0gYnl0ZXNbaV0sCiAgICAgICAgICBkaWdpdDsKCiAgICAgIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzkpIHsKICAgICAgICBkaWdpdCA9IGNoICYgMHgwZjsKICAgICAgfSBlbHNlIGlmIChjaCA+PSAweDQxICYmIGNoIDw9IDB4NDYgfHwgY2ggPj0gMHg2MSAmJiBjaCA8PSAweDY2KSB7CiAgICAgICAgZGlnaXQgPSAoY2ggJiAweDBmKSArIDk7CiAgICAgIH0gZWxzZSBpZiAoY2ggPT09IDB4M2UpIHsKICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgYnJlYWs7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChmaXJzdERpZ2l0IDwgMCkgewogICAgICAgIGZpcnN0RGlnaXQgPSBkaWdpdDsKICAgICAgfSBlbHNlIHsKICAgICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gZmlyc3REaWdpdCA8PCA0IHwgZGlnaXQ7CiAgICAgICAgZmlyc3REaWdpdCA9IC0xOwogICAgICB9CiAgICB9CgogICAgaWYgKGZpcnN0RGlnaXQgPj0gMCAmJiB0aGlzLmVvZikgewogICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gZmlyc3REaWdpdCA8PCA0OwogICAgICBmaXJzdERpZ2l0ID0gLTE7CiAgICB9CgogICAgdGhpcy5maXJzdERpZ2l0ID0gZmlyc3REaWdpdDsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gYnVmZmVyTGVuZ3RoOwogIH07CgogIHJldHVybiBBc2NpaUhleFN0cmVhbTsKfSgpOwoKZXhwb3J0cy5Bc2NpaUhleFN0cmVhbSA9IEFzY2lpSGV4U3RyZWFtOwoKdmFyIFJ1bkxlbmd0aFN0cmVhbSA9IGZ1bmN0aW9uIFJ1bkxlbmd0aFN0cmVhbUNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gUnVuTGVuZ3RoU3RyZWFtKHN0ciwgbWF5YmVMZW5ndGgpIHsKICAgIHRoaXMuc3RyID0gc3RyOwogICAgdGhpcy5kaWN0ID0gc3RyLmRpY3Q7CiAgICBEZWNvZGVTdHJlYW0uY2FsbCh0aGlzLCBtYXliZUxlbmd0aCk7CiAgfQoKICBSdW5MZW5ndGhTdHJlYW0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShEZWNvZGVTdHJlYW0ucHJvdG90eXBlKTsKCiAgUnVuTGVuZ3RoU3RyZWFtLnByb3RvdHlwZS5yZWFkQmxvY2sgPSBmdW5jdGlvbiBSdW5MZW5ndGhTdHJlYW1fcmVhZEJsb2NrKCkgewogICAgdmFyIHJlcGVhdEhlYWRlciA9IHRoaXMuc3RyLmdldEJ5dGVzKDIpOwoKICAgIGlmICghcmVwZWF0SGVhZGVyIHx8IHJlcGVhdEhlYWRlci5sZW5ndGggPCAyIHx8IHJlcGVhdEhlYWRlclswXSA9PT0gMTI4KSB7CiAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBidWZmZXI7CiAgICB2YXIgYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJMZW5ndGg7CiAgICB2YXIgbiA9IHJlcGVhdEhlYWRlclswXTsKCiAgICBpZiAobiA8IDEyOCkgewogICAgICBidWZmZXIgPSB0aGlzLmVuc3VyZUJ1ZmZlcihidWZmZXJMZW5ndGggKyBuICsgMSk7CiAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGgrK10gPSByZXBlYXRIZWFkZXJbMV07CgogICAgICBpZiAobiA+IDApIHsKICAgICAgICB2YXIgc291cmNlID0gdGhpcy5zdHIuZ2V0Qnl0ZXMobik7CiAgICAgICAgYnVmZmVyLnNldChzb3VyY2UsIGJ1ZmZlckxlbmd0aCk7CiAgICAgICAgYnVmZmVyTGVuZ3RoICs9IG47CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIG4gPSAyNTcgLSBuOwogICAgICB2YXIgYiA9IHJlcGVhdEhlYWRlclsxXTsKICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIoYnVmZmVyTGVuZ3RoICsgbiArIDEpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICBidWZmZXJbYnVmZmVyTGVuZ3RoKytdID0gYjsKICAgICAgfQogICAgfQoKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gYnVmZmVyTGVuZ3RoOwogIH07CgogIHJldHVybiBSdW5MZW5ndGhTdHJlYW07Cn0oKTsKCmV4cG9ydHMuUnVuTGVuZ3RoU3RyZWFtID0gUnVuTGVuZ3RoU3RyZWFtOwoKdmFyIExaV1N0cmVhbSA9IGZ1bmN0aW9uIExaV1N0cmVhbUNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gTFpXU3RyZWFtKHN0ciwgbWF5YmVMZW5ndGgsIGVhcmx5Q2hhbmdlKSB7CiAgICB0aGlzLnN0ciA9IHN0cjsKICAgIHRoaXMuZGljdCA9IHN0ci5kaWN0OwogICAgdGhpcy5jYWNoZWREYXRhID0gMDsKICAgIHRoaXMuYml0c0NhY2hlZCA9IDA7CiAgICB2YXIgbWF4THp3RGljdGlvbmFyeVNpemUgPSA0MDk2OwogICAgdmFyIGx6d1N0YXRlID0gewogICAgICBlYXJseUNoYW5nZTogZWFybHlDaGFuZ2UsCiAgICAgIGNvZGVMZW5ndGg6IDksCiAgICAgIG5leHRDb2RlOiAyNTgsCiAgICAgIGRpY3Rpb25hcnlWYWx1ZXM6IG5ldyBVaW50OEFycmF5KG1heEx6d0RpY3Rpb25hcnlTaXplKSwKICAgICAgZGljdGlvbmFyeUxlbmd0aHM6IG5ldyBVaW50MTZBcnJheShtYXhMendEaWN0aW9uYXJ5U2l6ZSksCiAgICAgIGRpY3Rpb25hcnlQcmV2Q29kZXM6IG5ldyBVaW50MTZBcnJheShtYXhMendEaWN0aW9uYXJ5U2l6ZSksCiAgICAgIGN1cnJlbnRTZXF1ZW5jZTogbmV3IFVpbnQ4QXJyYXkobWF4THp3RGljdGlvbmFyeVNpemUpLAogICAgICBjdXJyZW50U2VxdWVuY2VMZW5ndGg6IDAKICAgIH07CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7ICsraSkgewogICAgICBsendTdGF0ZS5kaWN0aW9uYXJ5VmFsdWVzW2ldID0gaTsKICAgICAgbHp3U3RhdGUuZGljdGlvbmFyeUxlbmd0aHNbaV0gPSAxOwogICAgfQoKICAgIHRoaXMubHp3U3RhdGUgPSBsendTdGF0ZTsKICAgIERlY29kZVN0cmVhbS5jYWxsKHRoaXMsIG1heWJlTGVuZ3RoKTsKICB9CgogIExaV1N0cmVhbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKERlY29kZVN0cmVhbS5wcm90b3R5cGUpOwoKICBMWldTdHJlYW0ucHJvdG90eXBlLnJlYWRCaXRzID0gZnVuY3Rpb24gTFpXU3RyZWFtX3JlYWRCaXRzKG4pIHsKICAgIHZhciBiaXRzQ2FjaGVkID0gdGhpcy5iaXRzQ2FjaGVkOwogICAgdmFyIGNhY2hlZERhdGEgPSB0aGlzLmNhY2hlZERhdGE7CgogICAgd2hpbGUgKGJpdHNDYWNoZWQgPCBuKSB7CiAgICAgIHZhciBjID0gdGhpcy5zdHIuZ2V0Qnl0ZSgpOwoKICAgICAgaWYgKGMgPT09IC0xKSB7CiAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBjYWNoZWREYXRhID0gY2FjaGVkRGF0YSA8PCA4IHwgYzsKICAgICAgYml0c0NhY2hlZCArPSA4OwogICAgfQoKICAgIHRoaXMuYml0c0NhY2hlZCA9IGJpdHNDYWNoZWQgLT0gbjsKICAgIHRoaXMuY2FjaGVkRGF0YSA9IGNhY2hlZERhdGE7CiAgICB0aGlzLmxhc3RDb2RlID0gbnVsbDsKICAgIHJldHVybiBjYWNoZWREYXRhID4+PiBiaXRzQ2FjaGVkICYgKDEgPDwgbikgLSAxOwogIH07CgogIExaV1N0cmVhbS5wcm90b3R5cGUucmVhZEJsb2NrID0gZnVuY3Rpb24gTFpXU3RyZWFtX3JlYWRCbG9jaygpIHsKICAgIHZhciBibG9ja1NpemUgPSA1MTI7CiAgICB2YXIgZXN0aW1hdGVkRGVjb2RlZFNpemUgPSBibG9ja1NpemUgKiAyLAogICAgICAgIGRlY29kZWRTaXplRGVsdGEgPSBibG9ja1NpemU7CiAgICB2YXIgaSwgaiwgcTsKICAgIHZhciBsendTdGF0ZSA9IHRoaXMubHp3U3RhdGU7CgogICAgaWYgKCFsendTdGF0ZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGVhcmx5Q2hhbmdlID0gbHp3U3RhdGUuZWFybHlDaGFuZ2U7CiAgICB2YXIgbmV4dENvZGUgPSBsendTdGF0ZS5uZXh0Q29kZTsKICAgIHZhciBkaWN0aW9uYXJ5VmFsdWVzID0gbHp3U3RhdGUuZGljdGlvbmFyeVZhbHVlczsKICAgIHZhciBkaWN0aW9uYXJ5TGVuZ3RocyA9IGx6d1N0YXRlLmRpY3Rpb25hcnlMZW5ndGhzOwogICAgdmFyIGRpY3Rpb25hcnlQcmV2Q29kZXMgPSBsendTdGF0ZS5kaWN0aW9uYXJ5UHJldkNvZGVzOwogICAgdmFyIGNvZGVMZW5ndGggPSBsendTdGF0ZS5jb2RlTGVuZ3RoOwogICAgdmFyIHByZXZDb2RlID0gbHp3U3RhdGUucHJldkNvZGU7CiAgICB2YXIgY3VycmVudFNlcXVlbmNlID0gbHp3U3RhdGUuY3VycmVudFNlcXVlbmNlOwogICAgdmFyIGN1cnJlbnRTZXF1ZW5jZUxlbmd0aCA9IGx6d1N0YXRlLmN1cnJlbnRTZXF1ZW5jZUxlbmd0aDsKICAgIHZhciBkZWNvZGVkTGVuZ3RoID0gMDsKICAgIHZhciBjdXJyZW50QnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJMZW5ndGg7CiAgICB2YXIgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIodGhpcy5idWZmZXJMZW5ndGggKyBlc3RpbWF0ZWREZWNvZGVkU2l6ZSk7CgogICAgZm9yIChpID0gMDsgaSA8IGJsb2NrU2l6ZTsgaSsrKSB7CiAgICAgIHZhciBjb2RlID0gdGhpcy5yZWFkQml0cyhjb2RlTGVuZ3RoKTsKICAgICAgdmFyIGhhc1ByZXYgPSBjdXJyZW50U2VxdWVuY2VMZW5ndGggPiAwOwoKICAgICAgaWYgKGNvZGUgPCAyNTYpIHsKICAgICAgICBjdXJyZW50U2VxdWVuY2VbMF0gPSBjb2RlOwogICAgICAgIGN1cnJlbnRTZXF1ZW5jZUxlbmd0aCA9IDE7CiAgICAgIH0gZWxzZSBpZiAoY29kZSA+PSAyNTgpIHsKICAgICAgICBpZiAoY29kZSA8IG5leHRDb2RlKSB7CiAgICAgICAgICBjdXJyZW50U2VxdWVuY2VMZW5ndGggPSBkaWN0aW9uYXJ5TGVuZ3Roc1tjb2RlXTsKCiAgICAgICAgICBmb3IgKGogPSBjdXJyZW50U2VxdWVuY2VMZW5ndGggLSAxLCBxID0gY29kZTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgICAgY3VycmVudFNlcXVlbmNlW2pdID0gZGljdGlvbmFyeVZhbHVlc1txXTsKICAgICAgICAgICAgcSA9IGRpY3Rpb25hcnlQcmV2Q29kZXNbcV07CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGN1cnJlbnRTZXF1ZW5jZVtjdXJyZW50U2VxdWVuY2VMZW5ndGgrK10gPSBjdXJyZW50U2VxdWVuY2VbMF07CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGNvZGUgPT09IDI1NikgewogICAgICAgIGNvZGVMZW5ndGggPSA5OwogICAgICAgIG5leHRDb2RlID0gMjU4OwogICAgICAgIGN1cnJlbnRTZXF1ZW5jZUxlbmd0aCA9IDA7CiAgICAgICAgY29udGludWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgIGRlbGV0ZSB0aGlzLmx6d1N0YXRlOwogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoaGFzUHJldikgewogICAgICAgIGRpY3Rpb25hcnlQcmV2Q29kZXNbbmV4dENvZGVdID0gcHJldkNvZGU7CiAgICAgICAgZGljdGlvbmFyeUxlbmd0aHNbbmV4dENvZGVdID0gZGljdGlvbmFyeUxlbmd0aHNbcHJldkNvZGVdICsgMTsKICAgICAgICBkaWN0aW9uYXJ5VmFsdWVzW25leHRDb2RlXSA9IGN1cnJlbnRTZXF1ZW5jZVswXTsKICAgICAgICBuZXh0Q29kZSsrOwogICAgICAgIGNvZGVMZW5ndGggPSBuZXh0Q29kZSArIGVhcmx5Q2hhbmdlICYgbmV4dENvZGUgKyBlYXJseUNoYW5nZSAtIDEgPyBjb2RlTGVuZ3RoIDogTWF0aC5taW4oTWF0aC5sb2cobmV4dENvZGUgKyBlYXJseUNoYW5nZSkgLyAwLjY5MzE0NzE4MDU1OTk0NTMgKyAxLCAxMikgfCAwOwogICAgICB9CgogICAgICBwcmV2Q29kZSA9IGNvZGU7CiAgICAgIGRlY29kZWRMZW5ndGggKz0gY3VycmVudFNlcXVlbmNlTGVuZ3RoOwoKICAgICAgaWYgKGVzdGltYXRlZERlY29kZWRTaXplIDwgZGVjb2RlZExlbmd0aCkgewogICAgICAgIGRvIHsKICAgICAgICAgIGVzdGltYXRlZERlY29kZWRTaXplICs9IGRlY29kZWRTaXplRGVsdGE7CiAgICAgICAgfSB3aGlsZSAoZXN0aW1hdGVkRGVjb2RlZFNpemUgPCBkZWNvZGVkTGVuZ3RoKTsKCiAgICAgICAgYnVmZmVyID0gdGhpcy5lbnN1cmVCdWZmZXIodGhpcy5idWZmZXJMZW5ndGggKyBlc3RpbWF0ZWREZWNvZGVkU2l6ZSk7CiAgICAgIH0KCiAgICAgIGZvciAoaiA9IDA7IGogPCBjdXJyZW50U2VxdWVuY2VMZW5ndGg7IGorKykgewogICAgICAgIGJ1ZmZlcltjdXJyZW50QnVmZmVyTGVuZ3RoKytdID0gY3VycmVudFNlcXVlbmNlW2pdOwogICAgICB9CiAgICB9CgogICAgbHp3U3RhdGUubmV4dENvZGUgPSBuZXh0Q29kZTsKICAgIGx6d1N0YXRlLmNvZGVMZW5ndGggPSBjb2RlTGVuZ3RoOwogICAgbHp3U3RhdGUucHJldkNvZGUgPSBwcmV2Q29kZTsKICAgIGx6d1N0YXRlLmN1cnJlbnRTZXF1ZW5jZUxlbmd0aCA9IGN1cnJlbnRTZXF1ZW5jZUxlbmd0aDsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gY3VycmVudEJ1ZmZlckxlbmd0aDsKICB9OwoKICByZXR1cm4gTFpXU3RyZWFtOwp9KCk7CgpleHBvcnRzLkxaV1N0cmVhbSA9IExaV1N0cmVhbTsKCnZhciBOdWxsU3RyZWFtID0gZnVuY3Rpb24gTnVsbFN0cmVhbUNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gTnVsbFN0cmVhbSgpIHsKICAgIFN0cmVhbS5jYWxsKHRoaXMsIG5ldyBVaW50OEFycmF5KDApKTsKICB9CgogIE51bGxTdHJlYW0ucHJvdG90eXBlID0gU3RyZWFtLnByb3RvdHlwZTsKICByZXR1cm4gTnVsbFN0cmVhbTsKfSgpOwoKZXhwb3J0cy5OdWxsU3RyZWFtID0gTnVsbFN0cmVhbTsKCi8qKiovIH0pLAovKiAyMDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5DQ0lUVEZheFN0cmVhbSA9IHZvaWQgMDsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfY2NpdHQgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNyk7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA1KTsKCnZhciBDQ0lUVEZheFN0cmVhbSA9IGZ1bmN0aW9uIENDSVRURmF4U3RyZWFtQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBDQ0lUVEZheFN0cmVhbShzdHIsIG1heWJlTGVuZ3RoLCBwYXJhbXMpIHsKICAgIHRoaXMuc3RyID0gc3RyOwogICAgdGhpcy5kaWN0ID0gc3RyLmRpY3Q7CgogICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShwYXJhbXMpKSB7CiAgICAgIHBhcmFtcyA9IF9wcmltaXRpdmVzLkRpY3QuZW1wdHk7CiAgICB9CgogICAgdmFyIHNvdXJjZSA9IHsKICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHsKICAgICAgICByZXR1cm4gc3RyLmdldEJ5dGUoKTsKICAgICAgfQogICAgfTsKICAgIHRoaXMuY2NpdHRGYXhEZWNvZGVyID0gbmV3IF9jY2l0dC5DQ0lUVEZheERlY29kZXIoc291cmNlLCB7CiAgICAgIEs6IHBhcmFtcy5nZXQoIksiKSwKICAgICAgRW5kT2ZMaW5lOiBwYXJhbXMuZ2V0KCJFbmRPZkxpbmUiKSwKICAgICAgRW5jb2RlZEJ5dGVBbGlnbjogcGFyYW1zLmdldCgiRW5jb2RlZEJ5dGVBbGlnbiIpLAogICAgICBDb2x1bW5zOiBwYXJhbXMuZ2V0KCJDb2x1bW5zIiksCiAgICAgIFJvd3M6IHBhcmFtcy5nZXQoIlJvd3MiKSwKICAgICAgRW5kT2ZCbG9jazogcGFyYW1zLmdldCgiRW5kT2ZCbG9jayIpLAogICAgICBCbGFja0lzMTogcGFyYW1zLmdldCgiQmxhY2tJczEiKQogICAgfSk7CgogICAgX3N0cmVhbS5EZWNvZGVTdHJlYW0uY2FsbCh0aGlzLCBtYXliZUxlbmd0aCk7CiAgfQoKICBDQ0lUVEZheFN0cmVhbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKF9zdHJlYW0uRGVjb2RlU3RyZWFtLnByb3RvdHlwZSk7CgogIENDSVRURmF4U3RyZWFtLnByb3RvdHlwZS5yZWFkQmxvY2sgPSBmdW5jdGlvbiAoKSB7CiAgICB3aGlsZSAoIXRoaXMuZW9mKSB7CiAgICAgIHZhciBjID0gdGhpcy5jY2l0dEZheERlY29kZXIucmVhZE5leHRDaGFyKCk7CgogICAgICBpZiAoYyA9PT0gLTEpIHsKICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmVuc3VyZUJ1ZmZlcih0aGlzLmJ1ZmZlckxlbmd0aCArIDEpOwogICAgICB0aGlzLmJ1ZmZlclt0aGlzLmJ1ZmZlckxlbmd0aCsrXSA9IGM7CiAgICB9CiAgfTsKCiAgcmV0dXJuIENDSVRURmF4U3RyZWFtOwp9KCk7CgpleHBvcnRzLkNDSVRURmF4U3RyZWFtID0gQ0NJVFRGYXhTdHJlYW07CgovKioqLyB9KSwKLyogMjA3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQ0NJVFRGYXhEZWNvZGVyID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBDQ0lUVEZheERlY29kZXIgPSBmdW5jdGlvbiBDQ0lUVEZheERlY29kZXIoKSB7CiAgdmFyIGNjaXR0RU9MID0gLTI7CiAgdmFyIGNjaXR0RU9GID0gLTE7CiAgdmFyIHR3b0RpbVBhc3MgPSAwOwogIHZhciB0d29EaW1Ib3JpeiA9IDE7CiAgdmFyIHR3b0RpbVZlcnQwID0gMjsKICB2YXIgdHdvRGltVmVydFIxID0gMzsKICB2YXIgdHdvRGltVmVydEwxID0gNDsKICB2YXIgdHdvRGltVmVydFIyID0gNTsKICB2YXIgdHdvRGltVmVydEwyID0gNjsKICB2YXIgdHdvRGltVmVydFIzID0gNzsKICB2YXIgdHdvRGltVmVydEwzID0gODsKICB2YXIgdHdvRGltVGFibGUgPSBbWy0xLCAtMV0sIFstMSwgLTFdLCBbNywgdHdvRGltVmVydEwzXSwgWzcsIHR3b0RpbVZlcnRSM10sIFs2LCB0d29EaW1WZXJ0TDJdLCBbNiwgdHdvRGltVmVydEwyXSwgWzYsIHR3b0RpbVZlcnRSMl0sIFs2LCB0d29EaW1WZXJ0UjJdLCBbNCwgdHdvRGltUGFzc10sIFs0LCB0d29EaW1QYXNzXSwgWzQsIHR3b0RpbVBhc3NdLCBbNCwgdHdvRGltUGFzc10sIFs0LCB0d29EaW1QYXNzXSwgWzQsIHR3b0RpbVBhc3NdLCBbNCwgdHdvRGltUGFzc10sIFs0LCB0d29EaW1QYXNzXSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbUhvcml6XSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0TDFdLCBbMywgdHdvRGltVmVydEwxXSwgWzMsIHR3b0RpbVZlcnRMMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMywgdHdvRGltVmVydFIxXSwgWzMsIHR3b0RpbVZlcnRSMV0sIFszLCB0d29EaW1WZXJ0UjFdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdLCBbMSwgdHdvRGltVmVydDBdXTsKICB2YXIgd2hpdGVUYWJsZTEgPSBbWy0xLCAtMV0sIFsxMiwgY2NpdHRFT0xdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFsxMSwgMTc5Ml0sIFsxMSwgMTc5Ml0sIFsxMiwgMTk4NF0sIFsxMiwgMjA0OF0sIFsxMiwgMjExMl0sIFsxMiwgMjE3Nl0sIFsxMiwgMjI0MF0sIFsxMiwgMjMwNF0sIFsxMSwgMTg1Nl0sIFsxMSwgMTg1Nl0sIFsxMSwgMTkyMF0sIFsxMSwgMTkyMF0sIFsxMiwgMjM2OF0sIFsxMiwgMjQzMl0sIFsxMiwgMjQ5Nl0sIFsxMiwgMjU2MF1dOwogIHZhciB3aGl0ZVRhYmxlMiA9IFtbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWzgsIDI5XSwgWzgsIDI5XSwgWzgsIDMwXSwgWzgsIDMwXSwgWzgsIDQ1XSwgWzgsIDQ1XSwgWzgsIDQ2XSwgWzgsIDQ2XSwgWzcsIDIyXSwgWzcsIDIyXSwgWzcsIDIyXSwgWzcsIDIyXSwgWzcsIDIzXSwgWzcsIDIzXSwgWzcsIDIzXSwgWzcsIDIzXSwgWzgsIDQ3XSwgWzgsIDQ3XSwgWzgsIDQ4XSwgWzgsIDQ4XSwgWzYsIDEzXSwgWzYsIDEzXSwgWzYsIDEzXSwgWzYsIDEzXSwgWzYsIDEzXSwgWzYsIDEzXSwgWzYsIDEzXSwgWzYsIDEzXSwgWzcsIDIwXSwgWzcsIDIwXSwgWzcsIDIwXSwgWzcsIDIwXSwgWzgsIDMzXSwgWzgsIDMzXSwgWzgsIDM0XSwgWzgsIDM0XSwgWzgsIDM1XSwgWzgsIDM1XSwgWzgsIDM2XSwgWzgsIDM2XSwgWzgsIDM3XSwgWzgsIDM3XSwgWzgsIDM4XSwgWzgsIDM4XSwgWzcsIDE5XSwgWzcsIDE5XSwgWzcsIDE5XSwgWzcsIDE5XSwgWzgsIDMxXSwgWzgsIDMxXSwgWzgsIDMyXSwgWzgsIDMyXSwgWzYsIDFdLCBbNiwgMV0sIFs2LCAxXSwgWzYsIDFdLCBbNiwgMV0sIFs2LCAxXSwgWzYsIDFdLCBbNiwgMV0sIFs2LCAxMl0sIFs2LCAxMl0sIFs2LCAxMl0sIFs2LCAxMl0sIFs2LCAxMl0sIFs2LCAxMl0sIFs2LCAxMl0sIFs2LCAxMl0sIFs4LCA1M10sIFs4LCA1M10sIFs4LCA1NF0sIFs4LCA1NF0sIFs3LCAyNl0sIFs3LCAyNl0sIFs3LCAyNl0sIFs3LCAyNl0sIFs4LCAzOV0sIFs4LCAzOV0sIFs4LCA0MF0sIFs4LCA0MF0sIFs4LCA0MV0sIFs4LCA0MV0sIFs4LCA0Ml0sIFs4LCA0Ml0sIFs4LCA0M10sIFs4LCA0M10sIFs4LCA0NF0sIFs4LCA0NF0sIFs3LCAyMV0sIFs3LCAyMV0sIFs3LCAyMV0sIFs3LCAyMV0sIFs3LCAyOF0sIFs3LCAyOF0sIFs3LCAyOF0sIFs3LCAyOF0sIFs4LCA2MV0sIFs4LCA2MV0sIFs4LCA2Ml0sIFs4LCA2Ml0sIFs4LCA2M10sIFs4LCA2M10sIFs4LCAwXSwgWzgsIDBdLCBbOCwgMzIwXSwgWzgsIDMyMF0sIFs4LCAzODRdLCBbOCwgMzg0XSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDEwXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzUsIDExXSwgWzcsIDI3XSwgWzcsIDI3XSwgWzcsIDI3XSwgWzcsIDI3XSwgWzgsIDU5XSwgWzgsIDU5XSwgWzgsIDYwXSwgWzgsIDYwXSwgWzksIDE0NzJdLCBbOSwgMTUzNl0sIFs5LCAxNjAwXSwgWzksIDE3MjhdLCBbNywgMThdLCBbNywgMThdLCBbNywgMThdLCBbNywgMThdLCBbNywgMjRdLCBbNywgMjRdLCBbNywgMjRdLCBbNywgMjRdLCBbOCwgNDldLCBbOCwgNDldLCBbOCwgNTBdLCBbOCwgNTBdLCBbOCwgNTFdLCBbOCwgNTFdLCBbOCwgNTJdLCBbOCwgNTJdLCBbNywgMjVdLCBbNywgMjVdLCBbNywgMjVdLCBbNywgMjVdLCBbOCwgNTVdLCBbOCwgNTVdLCBbOCwgNTZdLCBbOCwgNTZdLCBbOCwgNTddLCBbOCwgNTddLCBbOCwgNThdLCBbOCwgNThdLCBbNiwgMTkyXSwgWzYsIDE5Ml0sIFs2LCAxOTJdLCBbNiwgMTkyXSwgWzYsIDE5Ml0sIFs2LCAxOTJdLCBbNiwgMTkyXSwgWzYsIDE5Ml0sIFs2LCAxNjY0XSwgWzYsIDE2NjRdLCBbNiwgMTY2NF0sIFs2LCAxNjY0XSwgWzYsIDE2NjRdLCBbNiwgMTY2NF0sIFs2LCAxNjY0XSwgWzYsIDE2NjRdLCBbOCwgNDQ4XSwgWzgsIDQ0OF0sIFs4LCA1MTJdLCBbOCwgNTEyXSwgWzksIDcwNF0sIFs5LCA3NjhdLCBbOCwgNjQwXSwgWzgsIDY0MF0sIFs4LCA1NzZdLCBbOCwgNTc2XSwgWzksIDgzMl0sIFs5LCA4OTZdLCBbOSwgOTYwXSwgWzksIDEwMjRdLCBbOSwgMTA4OF0sIFs5LCAxMTUyXSwgWzksIDEyMTZdLCBbOSwgMTI4MF0sIFs5LCAxMzQ0XSwgWzksIDE0MDhdLCBbNywgMjU2XSwgWzcsIDI1Nl0sIFs3LCAyNTZdLCBbNywgMjU2XSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAyXSwgWzQsIDJdLCBbNCwgMl0sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNCwgM10sIFs0LCAzXSwgWzQsIDNdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDEyOF0sIFs1LCAxMjhdLCBbNSwgMTI4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOF0sIFs1LCA4XSwgWzUsIDhdLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs1LCA5XSwgWzUsIDldLCBbNSwgOV0sIFs2LCAxNl0sIFs2LCAxNl0sIFs2LCAxNl0sIFs2LCAxNl0sIFs2LCAxNl0sIFs2LCAxNl0sIFs2LCAxNl0sIFs2LCAxNl0sIFs2LCAxN10sIFs2LCAxN10sIFs2LCAxN10sIFs2LCAxN10sIFs2LCAxN10sIFs2LCAxN10sIFs2LCAxN10sIFs2LCAxN10sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNF0sIFs0LCA0XSwgWzQsIDRdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzYsIDE0XSwgWzYsIDE0XSwgWzYsIDE0XSwgWzYsIDE0XSwgWzYsIDE0XSwgWzYsIDE0XSwgWzYsIDE0XSwgWzYsIDE0XSwgWzYsIDE1XSwgWzYsIDE1XSwgWzYsIDE1XSwgWzYsIDE1XSwgWzYsIDE1XSwgWzYsIDE1XSwgWzYsIDE1XSwgWzYsIDE1XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzUsIDY0XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddLCBbNCwgN10sIFs0LCA3XSwgWzQsIDddXTsKICB2YXIgYmxhY2tUYWJsZTEgPSBbWy0xLCAtMV0sIFstMSwgLTFdLCBbMTIsIGNjaXR0RU9MXSwgWzEyLCBjY2l0dEVPTF0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbMTEsIDE3OTJdLCBbMTEsIDE3OTJdLCBbMTEsIDE3OTJdLCBbMTEsIDE3OTJdLCBbMTIsIDE5ODRdLCBbMTIsIDE5ODRdLCBbMTIsIDIwNDhdLCBbMTIsIDIwNDhdLCBbMTIsIDIxMTJdLCBbMTIsIDIxMTJdLCBbMTIsIDIxNzZdLCBbMTIsIDIxNzZdLCBbMTIsIDIyNDBdLCBbMTIsIDIyNDBdLCBbMTIsIDIzMDRdLCBbMTIsIDIzMDRdLCBbMTEsIDE4NTZdLCBbMTEsIDE4NTZdLCBbMTEsIDE4NTZdLCBbMTEsIDE4NTZdLCBbMTEsIDE5MjBdLCBbMTEsIDE5MjBdLCBbMTEsIDE5MjBdLCBbMTEsIDE5MjBdLCBbMTIsIDIzNjhdLCBbMTIsIDIzNjhdLCBbMTIsIDI0MzJdLCBbMTIsIDI0MzJdLCBbMTIsIDI0OTZdLCBbMTIsIDI0OTZdLCBbMTIsIDI1NjBdLCBbMTIsIDI1NjBdLCBbMTAsIDE4XSwgWzEwLCAxOF0sIFsxMCwgMThdLCBbMTAsIDE4XSwgWzEwLCAxOF0sIFsxMCwgMThdLCBbMTAsIDE4XSwgWzEwLCAxOF0sIFsxMiwgNTJdLCBbMTIsIDUyXSwgWzEzLCA2NDBdLCBbMTMsIDcwNF0sIFsxMywgNzY4XSwgWzEzLCA4MzJdLCBbMTIsIDU1XSwgWzEyLCA1NV0sIFsxMiwgNTZdLCBbMTIsIDU2XSwgWzEzLCAxMjgwXSwgWzEzLCAxMzQ0XSwgWzEzLCAxNDA4XSwgWzEzLCAxNDcyXSwgWzEyLCA1OV0sIFsxMiwgNTldLCBbMTIsIDYwXSwgWzEyLCA2MF0sIFsxMywgMTUzNl0sIFsxMywgMTYwMF0sIFsxMSwgMjRdLCBbMTEsIDI0XSwgWzExLCAyNF0sIFsxMSwgMjRdLCBbMTEsIDI1XSwgWzExLCAyNV0sIFsxMSwgMjVdLCBbMTEsIDI1XSwgWzEzLCAxNjY0XSwgWzEzLCAxNzI4XSwgWzEyLCAzMjBdLCBbMTIsIDMyMF0sIFsxMiwgMzg0XSwgWzEyLCAzODRdLCBbMTIsIDQ0OF0sIFsxMiwgNDQ4XSwgWzEzLCA1MTJdLCBbMTMsIDU3Nl0sIFsxMiwgNTNdLCBbMTIsIDUzXSwgWzEyLCA1NF0sIFsxMiwgNTRdLCBbMTMsIDg5Nl0sIFsxMywgOTYwXSwgWzEzLCAxMDI0XSwgWzEzLCAxMDg4XSwgWzEzLCAxMTUyXSwgWzEzLCAxMjE2XSwgWzEwLCA2NF0sIFsxMCwgNjRdLCBbMTAsIDY0XSwgWzEwLCA2NF0sIFsxMCwgNjRdLCBbMTAsIDY0XSwgWzEwLCA2NF0sIFsxMCwgNjRdXTsKICB2YXIgYmxhY2tUYWJsZTIgPSBbWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzgsIDEzXSwgWzExLCAyM10sIFsxMSwgMjNdLCBbMTIsIDUwXSwgWzEyLCA1MV0sIFsxMiwgNDRdLCBbMTIsIDQ1XSwgWzEyLCA0Nl0sIFsxMiwgNDddLCBbMTIsIDU3XSwgWzEyLCA1OF0sIFsxMiwgNjFdLCBbMTIsIDI1Nl0sIFsxMCwgMTZdLCBbMTAsIDE2XSwgWzEwLCAxNl0sIFsxMCwgMTZdLCBbMTAsIDE3XSwgWzEwLCAxN10sIFsxMCwgMTddLCBbMTAsIDE3XSwgWzEyLCA0OF0sIFsxMiwgNDldLCBbMTIsIDYyXSwgWzEyLCA2M10sIFsxMiwgMzBdLCBbMTIsIDMxXSwgWzEyLCAzMl0sIFsxMiwgMzNdLCBbMTIsIDQwXSwgWzEyLCA0MV0sIFsxMSwgMjJdLCBbMTEsIDIyXSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzgsIDE0XSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDEwXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzcsIDExXSwgWzksIDE1XSwgWzksIDE1XSwgWzksIDE1XSwgWzksIDE1XSwgWzksIDE1XSwgWzksIDE1XSwgWzksIDE1XSwgWzksIDE1XSwgWzEyLCAxMjhdLCBbMTIsIDE5Ml0sIFsxMiwgMjZdLCBbMTIsIDI3XSwgWzEyLCAyOF0sIFsxMiwgMjldLCBbMTEsIDE5XSwgWzExLCAxOV0sIFsxMSwgMjBdLCBbMTEsIDIwXSwgWzEyLCAzNF0sIFsxMiwgMzVdLCBbMTIsIDM2XSwgWzEyLCAzN10sIFsxMiwgMzhdLCBbMTIsIDM5XSwgWzExLCAyMV0sIFsxMSwgMjFdLCBbMTIsIDQyXSwgWzEyLCA0M10sIFsxMCwgMF0sIFsxMCwgMF0sIFsxMCwgMF0sIFsxMCwgMF0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl0sIFs3LCAxMl1dOwogIHZhciBibGFja1RhYmxlMyA9IFtbLTEsIC0xXSwgWy0xLCAtMV0sIFstMSwgLTFdLCBbLTEsIC0xXSwgWzYsIDldLCBbNiwgOF0sIFs1LCA3XSwgWzUsIDddLCBbNCwgNl0sIFs0LCA2XSwgWzQsIDZdLCBbNCwgNl0sIFs0LCA1XSwgWzQsIDVdLCBbNCwgNV0sIFs0LCA1XSwgWzMsIDFdLCBbMywgMV0sIFszLCAxXSwgWzMsIDFdLCBbMywgMV0sIFszLCAxXSwgWzMsIDFdLCBbMywgMV0sIFszLCA0XSwgWzMsIDRdLCBbMywgNF0sIFszLCA0XSwgWzMsIDRdLCBbMywgNF0sIFszLCA0XSwgWzMsIDRdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAzXSwgWzIsIDNdLCBbMiwgM10sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXSwgWzIsIDJdLCBbMiwgMl0sIFsyLCAyXV07CgogIGZ1bmN0aW9uIENDSVRURmF4RGVjb2Rlcihzb3VyY2UpIHsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKCiAgICBpZiAoIXNvdXJjZSB8fCB0eXBlb2Ygc291cmNlLm5leHQgIT09ICJmdW5jdGlvbiIpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdDQ0lUVEZheERlY29kZXIgLSBpbnZhbGlkICJzb3VyY2UiIHBhcmFtZXRlci4nKTsKICAgIH0KCiAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTsKICAgIHRoaXMuZW9mID0gZmFsc2U7CiAgICB0aGlzLmVuY29kaW5nID0gb3B0aW9ucy5LIHx8IDA7CiAgICB0aGlzLmVvbGluZSA9IG9wdGlvbnMuRW5kT2ZMaW5lIHx8IGZhbHNlOwogICAgdGhpcy5ieXRlQWxpZ24gPSBvcHRpb25zLkVuY29kZWRCeXRlQWxpZ24gfHwgZmFsc2U7CiAgICB0aGlzLmNvbHVtbnMgPSBvcHRpb25zLkNvbHVtbnMgfHwgMTcyODsKICAgIHRoaXMucm93cyA9IG9wdGlvbnMuUm93cyB8fCAwOwogICAgdmFyIGVvYmxvY2sgPSBvcHRpb25zLkVuZE9mQmxvY2s7CgogICAgaWYgKGVvYmxvY2sgPT09IG51bGwgfHwgZW9ibG9jayA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGVvYmxvY2sgPSB0cnVlOwogICAgfQoKICAgIHRoaXMuZW9ibG9jayA9IGVvYmxvY2s7CiAgICB0aGlzLmJsYWNrID0gb3B0aW9ucy5CbGFja0lzMSB8fCBmYWxzZTsKICAgIHRoaXMuY29kaW5nTGluZSA9IG5ldyBVaW50MzJBcnJheSh0aGlzLmNvbHVtbnMgKyAxKTsKICAgIHRoaXMucmVmTGluZSA9IG5ldyBVaW50MzJBcnJheSh0aGlzLmNvbHVtbnMgKyAyKTsKICAgIHRoaXMuY29kaW5nTGluZVswXSA9IHRoaXMuY29sdW1uczsKICAgIHRoaXMuY29kaW5nUG9zID0gMDsKICAgIHRoaXMucm93ID0gMDsKICAgIHRoaXMubmV4dExpbmUyRCA9IHRoaXMuZW5jb2RpbmcgPCAwOwogICAgdGhpcy5pbnB1dEJpdHMgPSAwOwogICAgdGhpcy5pbnB1dEJ1ZiA9IDA7CiAgICB0aGlzLm91dHB1dEJpdHMgPSAwOwogICAgdGhpcy5yb3dzRG9uZSA9IGZhbHNlOwogICAgdmFyIGNvZGUxOwoKICAgIHdoaWxlICgoY29kZTEgPSB0aGlzLl9sb29rQml0cygxMikpID09PSAwKSB7CiAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CiAgICB9CgogICAgaWYgKGNvZGUxID09PSAxKSB7CiAgICAgIHRoaXMuX2VhdEJpdHMoMTIpOwogICAgfQoKICAgIGlmICh0aGlzLmVuY29kaW5nID4gMCkgewogICAgICB0aGlzLm5leHRMaW5lMkQgPSAhdGhpcy5fbG9va0JpdHMoMSk7CgogICAgICB0aGlzLl9lYXRCaXRzKDEpOwogICAgfQogIH0KCiAgQ0NJVFRGYXhEZWNvZGVyLnByb3RvdHlwZSA9IHsKICAgIHJlYWROZXh0Q2hhcjogZnVuY3Rpb24gcmVhZE5leHRDaGFyKCkgewogICAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIHZhciByZWZMaW5lID0gdGhpcy5yZWZMaW5lOwogICAgICB2YXIgY29kaW5nTGluZSA9IHRoaXMuY29kaW5nTGluZTsKICAgICAgdmFyIGNvbHVtbnMgPSB0aGlzLmNvbHVtbnM7CiAgICAgIHZhciByZWZQb3MsIGJsYWNrUGl4ZWxzLCBiaXRzLCBpOwoKICAgICAgaWYgKHRoaXMub3V0cHV0Qml0cyA9PT0gMCkgewogICAgICAgIGlmICh0aGlzLnJvd3NEb25lKSB7CiAgICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CgogICAgICAgIHRoaXMuZXJyID0gZmFsc2U7CiAgICAgICAgdmFyIGNvZGUxLCBjb2RlMiwgY29kZTM7CgogICAgICAgIGlmICh0aGlzLm5leHRMaW5lMkQpIHsKICAgICAgICAgIGZvciAoaSA9IDA7IGNvZGluZ0xpbmVbaV0gPCBjb2x1bW5zOyArK2kpIHsKICAgICAgICAgICAgcmVmTGluZVtpXSA9IGNvZGluZ0xpbmVbaV07CiAgICAgICAgICB9CgogICAgICAgICAgcmVmTGluZVtpKytdID0gY29sdW1uczsKICAgICAgICAgIHJlZkxpbmVbaV0gPSBjb2x1bW5zOwogICAgICAgICAgY29kaW5nTGluZVswXSA9IDA7CiAgICAgICAgICB0aGlzLmNvZGluZ1BvcyA9IDA7CiAgICAgICAgICByZWZQb3MgPSAwOwogICAgICAgICAgYmxhY2tQaXhlbHMgPSAwOwoKICAgICAgICAgIHdoaWxlIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgY29kZTEgPSB0aGlzLl9nZXRUd29EaW1Db2RlKCk7CgogICAgICAgICAgICBzd2l0Y2ggKGNvZGUxKSB7CiAgICAgICAgICAgICAgY2FzZSB0d29EaW1QYXNzOgogICAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKHJlZkxpbmVbcmVmUG9zICsgMV0sIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgICBpZiAocmVmTGluZVtyZWZQb3MgKyAxXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgcmVmUG9zICs9IDI7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgdHdvRGltSG9yaXo6CiAgICAgICAgICAgICAgICBjb2RlMSA9IGNvZGUyID0gMDsKCiAgICAgICAgICAgICAgICBpZiAoYmxhY2tQaXhlbHMpIHsKICAgICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgIGNvZGUxICs9IGNvZGUzID0gdGhpcy5fZ2V0QmxhY2tDb2RlKCk7CiAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKGNvZGUzID49IDY0KTsKCiAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICBjb2RlMiArPSBjb2RlMyA9IHRoaXMuX2dldFdoaXRlQ29kZSgpOwogICAgICAgICAgICAgICAgICB9IHdoaWxlIChjb2RlMyA+PSA2NCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgY29kZTEgKz0gY29kZTMgPSB0aGlzLl9nZXRXaGl0ZUNvZGUoKTsKICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwoKICAgICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgIGNvZGUyICs9IGNvZGUzID0gdGhpcy5fZ2V0QmxhY2tDb2RlKCk7CiAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKGNvZGUzID49IDY0KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gKyBjb2RlMSwgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICsgY29kZTIsIGJsYWNrUGl4ZWxzIF4gMSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIHR3b0RpbVZlcnRSMzoKICAgICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVscyhyZWZMaW5lW3JlZlBvc10gKyAzLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKCiAgICAgICAgICAgICAgICBpZiAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgICsrcmVmUG9zOwoKICAgICAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgICAgcmVmUG9zICs9IDI7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSB0d29EaW1WZXJ0UjI6CiAgICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMocmVmTGluZVtyZWZQb3NdICsgMiwgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CgogICAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICArK3JlZlBvczsKCiAgICAgICAgICAgICAgICAgIHdoaWxlIChyZWZMaW5lW3JlZlBvc10gPD0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gJiYgcmVmTGluZVtyZWZQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgdHdvRGltVmVydFIxOgogICAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKHJlZkxpbmVbcmVmUG9zXSArIDEsIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgICBibGFja1BpeGVscyBePSAxOwoKICAgICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgKytyZWZQb3M7CgogICAgICAgICAgICAgICAgICB3aGlsZSAocmVmTGluZVtyZWZQb3NdIDw9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICYmIHJlZkxpbmVbcmVmUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIHR3b0RpbVZlcnQwOgogICAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKHJlZkxpbmVbcmVmUG9zXSwgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CgogICAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICArK3JlZlBvczsKCiAgICAgICAgICAgICAgICAgIHdoaWxlIChyZWZMaW5lW3JlZlBvc10gPD0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gJiYgcmVmTGluZVtyZWZQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgdHdvRGltVmVydEwzOgogICAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzTmVnKHJlZkxpbmVbcmVmUG9zXSAtIDMsIGJsYWNrUGl4ZWxzKTsKCiAgICAgICAgICAgICAgICBibGFja1BpeGVscyBePSAxOwoKICAgICAgICAgICAgICAgIGlmIChjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgaWYgKHJlZlBvcyA+IDApIHsKICAgICAgICAgICAgICAgICAgICAtLXJlZlBvczsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICArK3JlZlBvczsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgd2hpbGUgKHJlZkxpbmVbcmVmUG9zXSA8PSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAmJiByZWZMaW5lW3JlZlBvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgICAgcmVmUG9zICs9IDI7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSB0d29EaW1WZXJ0TDI6CiAgICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHNOZWcocmVmTGluZVtyZWZQb3NdIC0gMiwgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgICAgIGJsYWNrUGl4ZWxzIF49IDE7CgogICAgICAgICAgICAgICAgaWYgKGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICBpZiAocmVmUG9zID4gMCkgewogICAgICAgICAgICAgICAgICAgIC0tcmVmUG9zOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICsrcmVmUG9zOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB3aGlsZSAocmVmTGluZVtyZWZQb3NdIDw9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdICYmIHJlZkxpbmVbcmVmUG9zXSA8IGNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgICByZWZQb3MgKz0gMjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIHR3b0RpbVZlcnRMMToKICAgICAgICAgICAgICAgIHRoaXMuX2FkZFBpeGVsc05lZyhyZWZMaW5lW3JlZlBvc10gLSAxLCBibGFja1BpeGVscyk7CgogICAgICAgICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKCiAgICAgICAgICAgICAgICBpZiAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgICAgIGlmIChyZWZQb3MgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgLS1yZWZQb3M7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgKytyZWZQb3M7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHdoaWxlIChyZWZMaW5lW3JlZlBvc10gPD0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gJiYgcmVmTGluZVtyZWZQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgICAgICAgICAgIHJlZlBvcyArPSAyOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgY2NpdHRFT0Y6CiAgICAgICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMoY29sdW1ucywgMCk7CgogICAgICAgICAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoImJhZCAyZCBjb2RlIik7CgogICAgICAgICAgICAgICAgdGhpcy5fYWRkUGl4ZWxzKGNvbHVtbnMsIDApOwoKICAgICAgICAgICAgICAgIHRoaXMuZXJyID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb2RpbmdMaW5lWzBdID0gMDsKICAgICAgICAgIHRoaXMuY29kaW5nUG9zID0gMDsKICAgICAgICAgIGJsYWNrUGl4ZWxzID0gMDsKCiAgICAgICAgICB3aGlsZSAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgIGNvZGUxID0gMDsKCiAgICAgICAgICAgIGlmIChibGFja1BpeGVscykgewogICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIGNvZGUxICs9IGNvZGUzID0gdGhpcy5fZ2V0QmxhY2tDb2RlKCk7CiAgICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIGNvZGUxICs9IGNvZGUzID0gdGhpcy5fZ2V0V2hpdGVDb2RlKCk7CiAgICAgICAgICAgICAgfSB3aGlsZSAoY29kZTMgPj0gNjQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLl9hZGRQaXhlbHMoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gKyBjb2RlMSwgYmxhY2tQaXhlbHMpOwoKICAgICAgICAgICAgYmxhY2tQaXhlbHMgXj0gMTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciBnb3RFT0wgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMuYnl0ZUFsaWduKSB7CiAgICAgICAgICB0aGlzLmlucHV0Qml0cyAmPSB+NzsKICAgICAgICB9CgogICAgICAgIGlmICghdGhpcy5lb2Jsb2NrICYmIHRoaXMucm93ID09PSB0aGlzLnJvd3MgLSAxKSB7CiAgICAgICAgICB0aGlzLnJvd3NEb25lID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29kZTEgPSB0aGlzLl9sb29rQml0cygxMik7CgogICAgICAgICAgaWYgKHRoaXMuZW9saW5lKSB7CiAgICAgICAgICAgIHdoaWxlIChjb2RlMSAhPT0gY2NpdHRFT0YgJiYgY29kZTEgIT09IDEpIHsKICAgICAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEpOwoKICAgICAgICAgICAgICBjb2RlMSA9IHRoaXMuX2xvb2tCaXRzKDEyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgd2hpbGUgKGNvZGUxID09PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5fZWF0Qml0cygxKTsKCiAgICAgICAgICAgICAgY29kZTEgPSB0aGlzLl9sb29rQml0cygxMik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY29kZTEgPT09IDEpIHsKICAgICAgICAgICAgdGhpcy5fZWF0Qml0cygxMik7CgogICAgICAgICAgICBnb3RFT0wgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIGlmIChjb2RlMSA9PT0gY2NpdHRFT0YpIHsKICAgICAgICAgICAgdGhpcy5lb2YgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCF0aGlzLmVvZiAmJiB0aGlzLmVuY29kaW5nID4gMCAmJiAhdGhpcy5yb3dzRG9uZSkgewogICAgICAgICAgdGhpcy5uZXh0TGluZTJEID0gIXRoaXMuX2xvb2tCaXRzKDEpOwoKICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5lb2Jsb2NrICYmIGdvdEVPTCAmJiB0aGlzLmJ5dGVBbGlnbikgewogICAgICAgICAgY29kZTEgPSB0aGlzLl9sb29rQml0cygxMik7CgogICAgICAgICAgaWYgKGNvZGUxID09PSAxKSB7CiAgICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMTIpOwoKICAgICAgICAgICAgaWYgKHRoaXMuZW5jb2RpbmcgPiAwKSB7CiAgICAgICAgICAgICAgdGhpcy5fbG9va0JpdHMoMSk7CgogICAgICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmVuY29kaW5nID49IDApIHsKICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNDsgKytpKSB7CiAgICAgICAgICAgICAgICBjb2RlMSA9IHRoaXMuX2xvb2tCaXRzKDEyKTsKCiAgICAgICAgICAgICAgICBpZiAoY29kZTEgIT09IDEpIHsKICAgICAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJiYWQgcnRjIGNvZGU6ICIgKyBjb2RlMSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhpcy5fZWF0Qml0cygxMik7CgogICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5jb2RpbmcgPiAwKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuX2xvb2tCaXRzKDEpOwoKICAgICAgICAgICAgICAgICAgdGhpcy5fZWF0Qml0cygxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuZW9mID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZXJyICYmIHRoaXMuZW9saW5lKSB7CiAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICBjb2RlMSA9IHRoaXMuX2xvb2tCaXRzKDEzKTsKCiAgICAgICAgICAgIGlmIChjb2RlMSA9PT0gY2NpdHRFT0YpIHsKICAgICAgICAgICAgICB0aGlzLmVvZiA9IHRydWU7CiAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY29kZTEgPj4gMSA9PT0gMSkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEpOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuX2VhdEJpdHMoMTIpOwoKICAgICAgICAgIGlmICh0aGlzLmVuY29kaW5nID4gMCkgewogICAgICAgICAgICB0aGlzLl9lYXRCaXRzKDEpOwoKICAgICAgICAgICAgdGhpcy5uZXh0TGluZTJEID0gIShjb2RlMSAmIDEpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGNvZGluZ0xpbmVbMF0gPiAwKSB7CiAgICAgICAgICB0aGlzLm91dHB1dEJpdHMgPSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zID0gMF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMub3V0cHV0Qml0cyA9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3MgPSAxXTsKICAgICAgICB9CgogICAgICAgIHRoaXMucm93Kys7CiAgICAgIH0KCiAgICAgIHZhciBjOwoKICAgICAgaWYgKHRoaXMub3V0cHV0Qml0cyA+PSA4KSB7CiAgICAgICAgYyA9IHRoaXMuY29kaW5nUG9zICYgMSA/IDAgOiAweGZmOwogICAgICAgIHRoaXMub3V0cHV0Qml0cyAtPSA4OwoKICAgICAgICBpZiAodGhpcy5vdXRwdXRCaXRzID09PSAwICYmIGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIDwgY29sdW1ucykgewogICAgICAgICAgdGhpcy5jb2RpbmdQb3MrKzsKICAgICAgICAgIHRoaXMub3V0cHV0Qml0cyA9IGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3NdIC0gY29kaW5nTGluZVt0aGlzLmNvZGluZ1BvcyAtIDFdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBiaXRzID0gODsKICAgICAgICBjID0gMDsKCiAgICAgICAgZG8gewogICAgICAgICAgaWYgKHRoaXMub3V0cHV0Qml0cyA+IGJpdHMpIHsKICAgICAgICAgICAgYyA8PD0gYml0czsKCiAgICAgICAgICAgIGlmICghKHRoaXMuY29kaW5nUG9zICYgMSkpIHsKICAgICAgICAgICAgICBjIHw9IDB4ZmYgPj4gOCAtIGJpdHM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMub3V0cHV0Qml0cyAtPSBiaXRzOwogICAgICAgICAgICBiaXRzID0gMDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGMgPDw9IHRoaXMub3V0cHV0Qml0czsKCiAgICAgICAgICAgIGlmICghKHRoaXMuY29kaW5nUG9zICYgMSkpIHsKICAgICAgICAgICAgICBjIHw9IDB4ZmYgPj4gOCAtIHRoaXMub3V0cHV0Qml0czsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYml0cyAtPSB0aGlzLm91dHB1dEJpdHM7CiAgICAgICAgICAgIHRoaXMub3V0cHV0Qml0cyA9IDA7CgogICAgICAgICAgICBpZiAoY29kaW5nTGluZVt0aGlzLmNvZGluZ1Bvc10gPCBjb2x1bW5zKSB7CiAgICAgICAgICAgICAgdGhpcy5jb2RpbmdQb3MrKzsKICAgICAgICAgICAgICB0aGlzLm91dHB1dEJpdHMgPSBjb2RpbmdMaW5lW3RoaXMuY29kaW5nUG9zXSAtIGNvZGluZ0xpbmVbdGhpcy5jb2RpbmdQb3MgLSAxXTsKICAgICAgICAgICAgfSBlbHNlIGlmIChiaXRzID4gMCkgewogICAgICAgICAgICAgIGMgPDw9IGJpdHM7CiAgICAgICAgICAgICAgYml0cyA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IHdoaWxlIChiaXRzKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuYmxhY2spIHsKICAgICAgICBjIF49IDB4ZmY7CiAgICAgIH0KCiAgICAgIHJldHVybiBjOwogICAgfSwKICAgIF9hZGRQaXhlbHM6IGZ1bmN0aW9uIF9hZGRQaXhlbHMoYTEsIGJsYWNrUGl4ZWxzKSB7CiAgICAgIHZhciBjb2RpbmdMaW5lID0gdGhpcy5jb2RpbmdMaW5lOwogICAgICB2YXIgY29kaW5nUG9zID0gdGhpcy5jb2RpbmdQb3M7CgogICAgICBpZiAoYTEgPiBjb2RpbmdMaW5lW2NvZGluZ1Bvc10pIHsKICAgICAgICBpZiAoYTEgPiB0aGlzLmNvbHVtbnMpIHsKICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgicm93IGlzIHdyb25nIGxlbmd0aCIpOwogICAgICAgICAgdGhpcy5lcnIgPSB0cnVlOwogICAgICAgICAgYTEgPSB0aGlzLmNvbHVtbnM7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29kaW5nUG9zICYgMSBeIGJsYWNrUGl4ZWxzKSB7CiAgICAgICAgICArK2NvZGluZ1BvczsKICAgICAgICB9CgogICAgICAgIGNvZGluZ0xpbmVbY29kaW5nUG9zXSA9IGExOwogICAgICB9CgogICAgICB0aGlzLmNvZGluZ1BvcyA9IGNvZGluZ1BvczsKICAgIH0sCiAgICBfYWRkUGl4ZWxzTmVnOiBmdW5jdGlvbiBfYWRkUGl4ZWxzTmVnKGExLCBibGFja1BpeGVscykgewogICAgICB2YXIgY29kaW5nTGluZSA9IHRoaXMuY29kaW5nTGluZTsKICAgICAgdmFyIGNvZGluZ1BvcyA9IHRoaXMuY29kaW5nUG9zOwoKICAgICAgaWYgKGExID4gY29kaW5nTGluZVtjb2RpbmdQb3NdKSB7CiAgICAgICAgaWYgKGExID4gdGhpcy5jb2x1bW5zKSB7CiAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoInJvdyBpcyB3cm9uZyBsZW5ndGgiKTsKICAgICAgICAgIHRoaXMuZXJyID0gdHJ1ZTsKICAgICAgICAgIGExID0gdGhpcy5jb2x1bW5zOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNvZGluZ1BvcyAmIDEgXiBibGFja1BpeGVscykgewogICAgICAgICAgKytjb2RpbmdQb3M7CiAgICAgICAgfQoKICAgICAgICBjb2RpbmdMaW5lW2NvZGluZ1Bvc10gPSBhMTsKICAgICAgfSBlbHNlIGlmIChhMSA8IGNvZGluZ0xpbmVbY29kaW5nUG9zXSkgewogICAgICAgIGlmIChhMSA8IDApIHsKICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiaW52YWxpZCBjb2RlIik7CiAgICAgICAgICB0aGlzLmVyciA9IHRydWU7CiAgICAgICAgICBhMSA9IDA7CiAgICAgICAgfQoKICAgICAgICB3aGlsZSAoY29kaW5nUG9zID4gMCAmJiBhMSA8IGNvZGluZ0xpbmVbY29kaW5nUG9zIC0gMV0pIHsKICAgICAgICAgIC0tY29kaW5nUG9zOwogICAgICAgIH0KCiAgICAgICAgY29kaW5nTGluZVtjb2RpbmdQb3NdID0gYTE7CiAgICAgIH0KCiAgICAgIHRoaXMuY29kaW5nUG9zID0gY29kaW5nUG9zOwogICAgfSwKICAgIF9maW5kVGFibGVDb2RlOiBmdW5jdGlvbiBfZmluZFRhYmxlQ29kZShzdGFydCwgZW5kLCB0YWJsZSwgbGltaXQpIHsKICAgICAgdmFyIGxpbWl0VmFsdWUgPSBsaW1pdCB8fCAwOwoKICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDw9IGVuZDsgKytpKSB7CiAgICAgICAgdmFyIGNvZGUgPSB0aGlzLl9sb29rQml0cyhpKTsKCiAgICAgICAgaWYgKGNvZGUgPT09IGNjaXR0RU9GKSB7CiAgICAgICAgICByZXR1cm4gW3RydWUsIDEsIGZhbHNlXTsKICAgICAgICB9CgogICAgICAgIGlmIChpIDwgZW5kKSB7CiAgICAgICAgICBjb2RlIDw8PSBlbmQgLSBpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFsaW1pdFZhbHVlIHx8IGNvZGUgPj0gbGltaXRWYWx1ZSkgewogICAgICAgICAgdmFyIHAgPSB0YWJsZVtjb2RlIC0gbGltaXRWYWx1ZV07CgogICAgICAgICAgaWYgKHBbMF0gPT09IGkpIHsKICAgICAgICAgICAgdGhpcy5fZWF0Qml0cyhpKTsKCiAgICAgICAgICAgIHJldHVybiBbdHJ1ZSwgcFsxXSwgdHJ1ZV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gW2ZhbHNlLCAwLCBmYWxzZV07CiAgICB9LAogICAgX2dldFR3b0RpbUNvZGU6IGZ1bmN0aW9uIF9nZXRUd29EaW1Db2RlKCkgewogICAgICB2YXIgY29kZSA9IDA7CiAgICAgIHZhciBwOwoKICAgICAgaWYgKHRoaXMuZW9ibG9jaykgewogICAgICAgIGNvZGUgPSB0aGlzLl9sb29rQml0cyg3KTsKICAgICAgICBwID0gdHdvRGltVGFibGVbY29kZV07CgogICAgICAgIGlmIChwICYmIHBbMF0gPiAwKSB7CiAgICAgICAgICB0aGlzLl9lYXRCaXRzKHBbMF0pOwoKICAgICAgICAgIHJldHVybiBwWzFdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fZmluZFRhYmxlQ29kZSgxLCA3LCB0d29EaW1UYWJsZSk7CgogICAgICAgIGlmIChyZXN1bHRbMF0gJiYgcmVzdWx0WzJdKSB7CiAgICAgICAgICByZXR1cm4gcmVzdWx0WzFdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgKDAsIF91dGlsLmluZm8pKCJCYWQgdHdvIGRpbSBjb2RlIik7CiAgICAgIHJldHVybiBjY2l0dEVPRjsKICAgIH0sCiAgICBfZ2V0V2hpdGVDb2RlOiBmdW5jdGlvbiBfZ2V0V2hpdGVDb2RlKCkgewogICAgICB2YXIgY29kZSA9IDA7CiAgICAgIHZhciBwOwoKICAgICAgaWYgKHRoaXMuZW9ibG9jaykgewogICAgICAgIGNvZGUgPSB0aGlzLl9sb29rQml0cygxMik7CgogICAgICAgIGlmIChjb2RlID09PSBjY2l0dEVPRikgewogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29kZSA+PiA1ID09PSAwKSB7CiAgICAgICAgICBwID0gd2hpdGVUYWJsZTFbY29kZV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHAgPSB3aGl0ZVRhYmxlMltjb2RlID4+IDNdOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBbMF0gPiAwKSB7CiAgICAgICAgICB0aGlzLl9lYXRCaXRzKHBbMF0pOwoKICAgICAgICAgIHJldHVybiBwWzFdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fZmluZFRhYmxlQ29kZSgxLCA5LCB3aGl0ZVRhYmxlMik7CgogICAgICAgIGlmIChyZXN1bHRbMF0pIHsKICAgICAgICAgIHJldHVybiByZXN1bHRbMV07CiAgICAgICAgfQoKICAgICAgICByZXN1bHQgPSB0aGlzLl9maW5kVGFibGVDb2RlKDExLCAxMiwgd2hpdGVUYWJsZTEpOwoKICAgICAgICBpZiAocmVzdWx0WzBdKSB7CiAgICAgICAgICByZXR1cm4gcmVzdWx0WzFdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgKDAsIF91dGlsLmluZm8pKCJiYWQgd2hpdGUgY29kZSIpOwoKICAgICAgdGhpcy5fZWF0Qml0cygxKTsKCiAgICAgIHJldHVybiAxOwogICAgfSwKICAgIF9nZXRCbGFja0NvZGU6IGZ1bmN0aW9uIF9nZXRCbGFja0NvZGUoKSB7CiAgICAgIHZhciBjb2RlLCBwOwoKICAgICAgaWYgKHRoaXMuZW9ibG9jaykgewogICAgICAgIGNvZGUgPSB0aGlzLl9sb29rQml0cygxMyk7CgogICAgICAgIGlmIChjb2RlID09PSBjY2l0dEVPRikgewogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29kZSA+PiA3ID09PSAwKSB7CiAgICAgICAgICBwID0gYmxhY2tUYWJsZTFbY29kZV07CiAgICAgICAgfSBlbHNlIGlmIChjb2RlID4+IDkgPT09IDAgJiYgY29kZSA+PiA3ICE9PSAwKSB7CiAgICAgICAgICBwID0gYmxhY2tUYWJsZTJbKGNvZGUgPj4gMSkgLSA2NF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHAgPSBibGFja1RhYmxlM1tjb2RlID4+IDddOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBbMF0gPiAwKSB7CiAgICAgICAgICB0aGlzLl9lYXRCaXRzKHBbMF0pOwoKICAgICAgICAgIHJldHVybiBwWzFdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fZmluZFRhYmxlQ29kZSgyLCA2LCBibGFja1RhYmxlMyk7CgogICAgICAgIGlmIChyZXN1bHRbMF0pIHsKICAgICAgICAgIHJldHVybiByZXN1bHRbMV07CiAgICAgICAgfQoKICAgICAgICByZXN1bHQgPSB0aGlzLl9maW5kVGFibGVDb2RlKDcsIDEyLCBibGFja1RhYmxlMiwgNjQpOwoKICAgICAgICBpZiAocmVzdWx0WzBdKSB7CiAgICAgICAgICByZXR1cm4gcmVzdWx0WzFdOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0ID0gdGhpcy5fZmluZFRhYmxlQ29kZSgxMCwgMTMsIGJsYWNrVGFibGUxKTsKCiAgICAgICAgaWYgKHJlc3VsdFswXSkgewogICAgICAgICAgcmV0dXJuIHJlc3VsdFsxXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgICgwLCBfdXRpbC5pbmZvKSgiYmFkIGJsYWNrIGNvZGUiKTsKCiAgICAgIHRoaXMuX2VhdEJpdHMoMSk7CgogICAgICByZXR1cm4gMTsKICAgIH0sCiAgICBfbG9va0JpdHM6IGZ1bmN0aW9uIF9sb29rQml0cyhuKSB7CiAgICAgIHZhciBjOwoKICAgICAgd2hpbGUgKHRoaXMuaW5wdXRCaXRzIDwgbikgewogICAgICAgIGlmICgoYyA9IHRoaXMuc291cmNlLm5leHQoKSkgPT09IC0xKSB7CiAgICAgICAgICBpZiAodGhpcy5pbnB1dEJpdHMgPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuIGNjaXR0RU9GOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0aGlzLmlucHV0QnVmIDw8IG4gLSB0aGlzLmlucHV0Qml0cyAmIDB4ZmZmZiA+PiAxNiAtIG47CiAgICAgICAgfQoKICAgICAgICB0aGlzLmlucHV0QnVmID0gdGhpcy5pbnB1dEJ1ZiA8PCA4IHwgYzsKICAgICAgICB0aGlzLmlucHV0Qml0cyArPSA4OwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5pbnB1dEJ1ZiA+PiB0aGlzLmlucHV0Qml0cyAtIG4gJiAweGZmZmYgPj4gMTYgLSBuOwogICAgfSwKICAgIF9lYXRCaXRzOiBmdW5jdGlvbiBfZWF0Qml0cyhuKSB7CiAgICAgIGlmICgodGhpcy5pbnB1dEJpdHMgLT0gbikgPCAwKSB7CiAgICAgICAgdGhpcy5pbnB1dEJpdHMgPSAwOwogICAgICB9CiAgICB9CiAgfTsKICByZXR1cm4gQ0NJVFRGYXhEZWNvZGVyOwp9KCk7CgpleHBvcnRzLkNDSVRURmF4RGVjb2RlciA9IENDSVRURmF4RGVjb2RlcjsKCi8qKiovIH0pLAovKiAyMDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5KYmlnMlN0cmVhbSA9IHZvaWQgMDsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDUpOwoKdmFyIF9qYmlnID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDkpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBKYmlnMlN0cmVhbSA9IGZ1bmN0aW9uIEpiaWcyU3RyZWFtQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBKYmlnMlN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBkaWN0LCBwYXJhbXMpIHsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5tYXliZUxlbmd0aCA9IG1heWJlTGVuZ3RoOwogICAgdGhpcy5kaWN0ID0gZGljdDsKICAgIHRoaXMucGFyYW1zID0gcGFyYW1zOwoKICAgIF9zdHJlYW0uRGVjb2RlU3RyZWFtLmNhbGwodGhpcywgbWF5YmVMZW5ndGgpOwogIH0KCiAgSmJpZzJTdHJlYW0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShfc3RyZWFtLkRlY29kZVN0cmVhbS5wcm90b3R5cGUpOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShKYmlnMlN0cmVhbS5wcm90b3R5cGUsICJieXRlcyIsIHsKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImJ5dGVzIiwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZXModGhpcy5tYXliZUxlbmd0aCkpOwogICAgfSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwoKICBKYmlnMlN0cmVhbS5wcm90b3R5cGUuZW5zdXJlQnVmZmVyID0gZnVuY3Rpb24gKHJlcXVlc3RlZCkge307CgogIEpiaWcyU3RyZWFtLnByb3RvdHlwZS5yZWFkQmxvY2sgPSBmdW5jdGlvbiAoKSB7CiAgICBpZiAodGhpcy5lb2YpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBqYmlnMkltYWdlID0gbmV3IF9qYmlnLkpiaWcySW1hZ2UoKTsKICAgIHZhciBjaHVua3MgPSBbXTsKCiAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkodGhpcy5wYXJhbXMpKSB7CiAgICAgIHZhciBnbG9iYWxzU3RyZWFtID0gdGhpcy5wYXJhbXMuZ2V0KCJKQklHMkdsb2JhbHMiKTsKCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKGdsb2JhbHNTdHJlYW0pKSB7CiAgICAgICAgdmFyIGdsb2JhbHMgPSBnbG9iYWxzU3RyZWFtLmdldEJ5dGVzKCk7CiAgICAgICAgY2h1bmtzLnB1c2goewogICAgICAgICAgZGF0YTogZ2xvYmFscywKICAgICAgICAgIHN0YXJ0OiAwLAogICAgICAgICAgZW5kOiBnbG9iYWxzLmxlbmd0aAogICAgICAgIH0pOwogICAgICB9CiAgICB9CgogICAgY2h1bmtzLnB1c2goewogICAgICBkYXRhOiB0aGlzLmJ5dGVzLAogICAgICBzdGFydDogMCwKICAgICAgZW5kOiB0aGlzLmJ5dGVzLmxlbmd0aAogICAgfSk7CiAgICB2YXIgZGF0YSA9IGpiaWcySW1hZ2UucGFyc2VDaHVua3MoY2h1bmtzKTsKICAgIHZhciBkYXRhTGVuZ3RoID0gZGF0YS5sZW5ndGg7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhTGVuZ3RoOyBpKyspIHsKICAgICAgZGF0YVtpXSBePSAweGZmOwogICAgfQoKICAgIHRoaXMuYnVmZmVyID0gZGF0YTsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gZGF0YUxlbmd0aDsKICAgIHRoaXMuZW9mID0gdHJ1ZTsKICB9OwoKICByZXR1cm4gSmJpZzJTdHJlYW07Cn0oKTsKCmV4cG9ydHMuSmJpZzJTdHJlYW0gPSBKYmlnMlN0cmVhbTsKCi8qKiovIH0pLAovKiAyMDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5KYmlnMkltYWdlID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCnZhciBfYXJpdGhtZXRpY19kZWNvZGVyID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTApOwoKdmFyIF9jY2l0dCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA3KTsKCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBfc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpOyB9CgpmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgby5fX3Byb3RvX18gPSBwOyByZXR1cm4gbzsgfTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihvLCBwKTsgfQoKZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKGNhbGwgJiYgKF90eXBlb2YoY2FsbCkgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSkgeyByZXR1cm4gY2FsbDsgfSByZXR1cm4gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTsgfQoKZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7IGlmIChzZWxmID09PSB2b2lkIDApIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gc2VsZjsgfQoKZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IERhdGUucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoRGF0ZSwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9CgpmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2YobykgeyByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOyB9OyByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pOyB9Cgp2YXIgSmJpZzJFcnJvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VFeGNlcHRpb24pIHsKICBfaW5oZXJpdHMoSmJpZzJFcnJvciwgX0Jhc2VFeGNlcHRpb24pOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKEpiaWcyRXJyb3IpOwoKICBmdW5jdGlvbiBKYmlnMkVycm9yKG1zZykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEpiaWcyRXJyb3IpOwoKICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCAiSkJJRzIgZXJyb3I6ICIuY29uY2F0KG1zZykpOwogIH0KCiAgcmV0dXJuIEpiaWcyRXJyb3I7Cn0oX3V0aWwuQmFzZUV4Y2VwdGlvbik7Cgp2YXIgSmJpZzJJbWFnZSA9IGZ1bmN0aW9uIEpiaWcySW1hZ2VDbG9zdXJlKCkgewogIGZ1bmN0aW9uIENvbnRleHRDYWNoZSgpIHt9CgogIENvbnRleHRDYWNoZS5wcm90b3R5cGUgPSB7CiAgICBnZXRDb250ZXh0czogZnVuY3Rpb24gZ2V0Q29udGV4dHMoaWQpIHsKICAgICAgaWYgKGlkIGluIHRoaXMpIHsKICAgICAgICByZXR1cm4gdGhpc1tpZF07CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzW2lkXSA9IG5ldyBJbnQ4QXJyYXkoMSA8PCAxNik7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gRGVjb2RpbmdDb250ZXh0KGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7CiAgICB0aGlzLmVuZCA9IGVuZDsKICB9CgogIERlY29kaW5nQ29udGV4dC5wcm90b3R5cGUgPSB7CiAgICBnZXQgZGVjb2RlcigpIHsKICAgICAgdmFyIGRlY29kZXIgPSBuZXcgX2FyaXRobWV0aWNfZGVjb2Rlci5Bcml0aG1ldGljRGVjb2Rlcih0aGlzLmRhdGEsIHRoaXMuc3RhcnQsIHRoaXMuZW5kKTsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJkZWNvZGVyIiwgZGVjb2Rlcik7CiAgICB9LAoKICAgIGdldCBjb250ZXh0Q2FjaGUoKSB7CiAgICAgIHZhciBjYWNoZSA9IG5ldyBDb250ZXh0Q2FjaGUoKTsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJjb250ZXh0Q2FjaGUiLCBjYWNoZSk7CiAgICB9CgogIH07CgogIGZ1bmN0aW9uIGRlY29kZUludGVnZXIoY29udGV4dENhY2hlLCBwcm9jZWR1cmUsIGRlY29kZXIpIHsKICAgIHZhciBjb250ZXh0cyA9IGNvbnRleHRDYWNoZS5nZXRDb250ZXh0cyhwcm9jZWR1cmUpOwogICAgdmFyIHByZXYgPSAxOwoKICAgIGZ1bmN0aW9uIHJlYWRCaXRzKGxlbmd0aCkgewogICAgICB2YXIgdiA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGJpdCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgcHJldik7CiAgICAgICAgcHJldiA9IHByZXYgPCAyNTYgPyBwcmV2IDw8IDEgfCBiaXQgOiAocHJldiA8PCAxIHwgYml0KSAmIDUxMSB8IDI1NjsKICAgICAgICB2ID0gdiA8PCAxIHwgYml0OwogICAgICB9CgogICAgICByZXR1cm4gdiA+Pj4gMDsKICAgIH0KCiAgICB2YXIgc2lnbiA9IHJlYWRCaXRzKDEpOwogICAgdmFyIHZhbHVlID0gcmVhZEJpdHMoMSkgPyByZWFkQml0cygxKSA/IHJlYWRCaXRzKDEpID8gcmVhZEJpdHMoMSkgPyByZWFkQml0cygxKSA/IHJlYWRCaXRzKDMyKSArIDQ0MzYgOiByZWFkQml0cygxMikgKyAzNDAgOiByZWFkQml0cyg4KSArIDg0IDogcmVhZEJpdHMoNikgKyAyMCA6IHJlYWRCaXRzKDQpICsgNCA6IHJlYWRCaXRzKDIpOwoKICAgIGlmIChzaWduID09PSAwKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0gZWxzZSBpZiAodmFsdWUgPiAwKSB7CiAgICAgIHJldHVybiAtdmFsdWU7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVJQUlEKGNvbnRleHRDYWNoZSwgZGVjb2RlciwgY29kZUxlbmd0aCkgewogICAgdmFyIGNvbnRleHRzID0gY29udGV4dENhY2hlLmdldENvbnRleHRzKCJJQUlEIik7CiAgICB2YXIgcHJldiA9IDE7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2RlTGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGJpdCA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgcHJldik7CiAgICAgIHByZXYgPSBwcmV2IDw8IDEgfCBiaXQ7CiAgICB9CgogICAgaWYgKGNvZGVMZW5ndGggPCAzMSkgewogICAgICByZXR1cm4gcHJldiAmICgxIDw8IGNvZGVMZW5ndGgpIC0gMTsKICAgIH0KCiAgICByZXR1cm4gcHJldiAmIDB4N2ZmZmZmZmY7CiAgfQoKICB2YXIgU2VnbWVudFR5cGVzID0gWyJTeW1ib2xEaWN0aW9uYXJ5IiwgbnVsbCwgbnVsbCwgbnVsbCwgIkludGVybWVkaWF0ZVRleHRSZWdpb24iLCBudWxsLCAiSW1tZWRpYXRlVGV4dFJlZ2lvbiIsICJJbW1lZGlhdGVMb3NzbGVzc1RleHRSZWdpb24iLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCAiUGF0dGVybkRpY3Rpb25hcnkiLCBudWxsLCBudWxsLCBudWxsLCAiSW50ZXJtZWRpYXRlSGFsZnRvbmVSZWdpb24iLCBudWxsLCAiSW1tZWRpYXRlSGFsZnRvbmVSZWdpb24iLCAiSW1tZWRpYXRlTG9zc2xlc3NIYWxmdG9uZVJlZ2lvbiIsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsIG51bGwsICJJbnRlcm1lZGlhdGVHZW5lcmljUmVnaW9uIiwgbnVsbCwgIkltbWVkaWF0ZUdlbmVyaWNSZWdpb24iLCAiSW1tZWRpYXRlTG9zc2xlc3NHZW5lcmljUmVnaW9uIiwgIkludGVybWVkaWF0ZUdlbmVyaWNSZWZpbmVtZW50UmVnaW9uIiwgbnVsbCwgIkltbWVkaWF0ZUdlbmVyaWNSZWZpbmVtZW50UmVnaW9uIiwgIkltbWVkaWF0ZUxvc3NsZXNzR2VuZXJpY1JlZmluZW1lbnRSZWdpb24iLCBudWxsLCBudWxsLCBudWxsLCBudWxsLCAiUGFnZUluZm9ybWF0aW9uIiwgIkVuZE9mUGFnZSIsICJFbmRPZlN0cmlwZSIsICJFbmRPZkZpbGUiLCAiUHJvZmlsZXMiLCAiVGFibGVzIiwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgIkV4dGVuc2lvbiJdOwogIHZhciBDb2RpbmdUZW1wbGF0ZXMgPSBbW3sKICAgIHg6IC0xLAogICAgeTogLTIKICB9LCB7CiAgICB4OiAwLAogICAgeTogLTIKICB9LCB7CiAgICB4OiAxLAogICAgeTogLTIKICB9LCB7CiAgICB4OiAtMiwKICAgIHk6IC0xCiAgfSwgewogICAgeDogLTEsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDAsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDIsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IC00LAogICAgeTogMAogIH0sIHsKICAgIHg6IC0zLAogICAgeTogMAogIH0sIHsKICAgIHg6IC0yLAogICAgeTogMAogIH0sIHsKICAgIHg6IC0xLAogICAgeTogMAogIH1dLCBbewogICAgeDogLTEsCiAgICB5OiAtMgogIH0sIHsKICAgIHg6IDAsCiAgICB5OiAtMgogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAtMgogIH0sIHsKICAgIHg6IDIsCiAgICB5OiAtMgogIH0sIHsKICAgIHg6IC0yLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAtMSwKICAgIHk6IC0xCiAgfSwgewogICAgeDogMCwKICAgIHk6IC0xCiAgfSwgewogICAgeDogMSwKICAgIHk6IC0xCiAgfSwgewogICAgeDogMiwKICAgIHk6IC0xCiAgfSwgewogICAgeDogLTMsCiAgICB5OiAwCiAgfSwgewogICAgeDogLTIsCiAgICB5OiAwCiAgfSwgewogICAgeDogLTEsCiAgICB5OiAwCiAgfV0sIFt7CiAgICB4OiAtMSwKICAgIHk6IC0yCiAgfSwgewogICAgeDogMCwKICAgIHk6IC0yCiAgfSwgewogICAgeDogMSwKICAgIHk6IC0yCiAgfSwgewogICAgeDogLTIsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IC0xLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAwLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAxLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAtMiwKICAgIHk6IDAKICB9LCB7CiAgICB4OiAtMSwKICAgIHk6IDAKICB9XSwgW3sKICAgIHg6IC0zLAogICAgeTogLTEKICB9LCB7CiAgICB4OiAtMiwKICAgIHk6IC0xCiAgfSwgewogICAgeDogLTEsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDAsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IDEsCiAgICB5OiAtMQogIH0sIHsKICAgIHg6IC00LAogICAgeTogMAogIH0sIHsKICAgIHg6IC0zLAogICAgeTogMAogIH0sIHsKICAgIHg6IC0yLAogICAgeTogMAogIH0sIHsKICAgIHg6IC0xLAogICAgeTogMAogIH1dXTsKICB2YXIgUmVmaW5lbWVudFRlbXBsYXRlcyA9IFt7CiAgICBjb2Rpbmc6IFt7CiAgICAgIHg6IDAsCiAgICAgIHk6IC0xCiAgICB9LCB7CiAgICAgIHg6IDEsCiAgICAgIHk6IC0xCiAgICB9LCB7CiAgICAgIHg6IC0xLAogICAgICB5OiAwCiAgICB9XSwKICAgIHJlZmVyZW5jZTogW3sKICAgICAgeDogMCwKICAgICAgeTogLTEKICAgIH0sIHsKICAgICAgeDogMSwKICAgICAgeTogLTEKICAgIH0sIHsKICAgICAgeDogLTEsCiAgICAgIHk6IDAKICAgIH0sIHsKICAgICAgeDogMCwKICAgICAgeTogMAogICAgfSwgewogICAgICB4OiAxLAogICAgICB5OiAwCiAgICB9LCB7CiAgICAgIHg6IC0xLAogICAgICB5OiAxCiAgICB9LCB7CiAgICAgIHg6IDAsCiAgICAgIHk6IDEKICAgIH0sIHsKICAgICAgeDogMSwKICAgICAgeTogMQogICAgfV0KICB9LCB7CiAgICBjb2Rpbmc6IFt7CiAgICAgIHg6IC0xLAogICAgICB5OiAtMQogICAgfSwgewogICAgICB4OiAwLAogICAgICB5OiAtMQogICAgfSwgewogICAgICB4OiAxLAogICAgICB5OiAtMQogICAgfSwgewogICAgICB4OiAtMSwKICAgICAgeTogMAogICAgfV0sCiAgICByZWZlcmVuY2U6IFt7CiAgICAgIHg6IDAsCiAgICAgIHk6IC0xCiAgICB9LCB7CiAgICAgIHg6IC0xLAogICAgICB5OiAwCiAgICB9LCB7CiAgICAgIHg6IDAsCiAgICAgIHk6IDAKICAgIH0sIHsKICAgICAgeDogMSwKICAgICAgeTogMAogICAgfSwgewogICAgICB4OiAwLAogICAgICB5OiAxCiAgICB9LCB7CiAgICAgIHg6IDEsCiAgICAgIHk6IDEKICAgIH1dCiAgfV07CiAgdmFyIFJldXNlZENvbnRleHRzID0gWzB4OWIyNSwgMHgwNzk1LCAweDAwZTUsIDB4MDE5NV07CiAgdmFyIFJlZmluZW1lbnRSZXVzZWRDb250ZXh0cyA9IFsweDAwMjAsIDB4MDAwOF07CgogIGZ1bmN0aW9uIGRlY29kZUJpdG1hcFRlbXBsYXRlMCh3aWR0aCwgaGVpZ2h0LCBkZWNvZGluZ0NvbnRleHQpIHsKICAgIHZhciBkZWNvZGVyID0gZGVjb2RpbmdDb250ZXh0LmRlY29kZXI7CiAgICB2YXIgY29udGV4dHMgPSBkZWNvZGluZ0NvbnRleHQuY29udGV4dENhY2hlLmdldENvbnRleHRzKCJHQiIpOwogICAgdmFyIGNvbnRleHRMYWJlbCwKICAgICAgICBpLAogICAgICAgIGosCiAgICAgICAgcGl4ZWwsCiAgICAgICAgcm93LAogICAgICAgIHJvdzEsCiAgICAgICAgcm93MiwKICAgICAgICBiaXRtYXAgPSBbXTsKICAgIHZhciBPTERfUElYRUxfTUFTSyA9IDB4N2JmNzsKCiAgICBmb3IgKGkgPSAwOyBpIDwgaGVpZ2h0OyBpKyspIHsKICAgICAgcm93ID0gYml0bWFwW2ldID0gbmV3IFVpbnQ4QXJyYXkod2lkdGgpOwogICAgICByb3cxID0gaSA8IDEgPyByb3cgOiBiaXRtYXBbaSAtIDFdOwogICAgICByb3cyID0gaSA8IDIgPyByb3cgOiBiaXRtYXBbaSAtIDJdOwogICAgICBjb250ZXh0TGFiZWwgPSByb3cyWzBdIDw8IDEzIHwgcm93MlsxXSA8PCAxMiB8IHJvdzJbMl0gPDwgMTEgfCByb3cxWzBdIDw8IDcgfCByb3cxWzFdIDw8IDYgfCByb3cxWzJdIDw8IDUgfCByb3cxWzNdIDw8IDQ7CgogICAgICBmb3IgKGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgIHJvd1tqXSA9IHBpeGVsID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBjb250ZXh0TGFiZWwpOwogICAgICAgIGNvbnRleHRMYWJlbCA9IChjb250ZXh0TGFiZWwgJiBPTERfUElYRUxfTUFTSykgPDwgMSB8IChqICsgMyA8IHdpZHRoID8gcm93MltqICsgM10gPDwgMTEgOiAwKSB8IChqICsgNCA8IHdpZHRoID8gcm93MVtqICsgNF0gPDwgNCA6IDApIHwgcGl4ZWw7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYml0bWFwOwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlQml0bWFwKG1tciwgd2lkdGgsIGhlaWdodCwgdGVtcGxhdGVJbmRleCwgcHJlZGljdGlvbiwgc2tpcCwgYXQsIGRlY29kaW5nQ29udGV4dCkgewogICAgaWYgKG1tcikgewogICAgICB2YXIgaW5wdXQgPSBuZXcgUmVhZGVyKGRlY29kaW5nQ29udGV4dC5kYXRhLCBkZWNvZGluZ0NvbnRleHQuc3RhcnQsIGRlY29kaW5nQ29udGV4dC5lbmQpOwogICAgICByZXR1cm4gZGVjb2RlTU1SQml0bWFwKGlucHV0LCB3aWR0aCwgaGVpZ2h0LCBmYWxzZSk7CiAgICB9CgogICAgaWYgKHRlbXBsYXRlSW5kZXggPT09IDAgJiYgIXNraXAgJiYgIXByZWRpY3Rpb24gJiYgYXQubGVuZ3RoID09PSA0ICYmIGF0WzBdLnggPT09IDMgJiYgYXRbMF0ueSA9PT0gLTEgJiYgYXRbMV0ueCA9PT0gLTMgJiYgYXRbMV0ueSA9PT0gLTEgJiYgYXRbMl0ueCA9PT0gMiAmJiBhdFsyXS55ID09PSAtMiAmJiBhdFszXS54ID09PSAtMiAmJiBhdFszXS55ID09PSAtMikgewogICAgICByZXR1cm4gZGVjb2RlQml0bWFwVGVtcGxhdGUwKHdpZHRoLCBoZWlnaHQsIGRlY29kaW5nQ29udGV4dCk7CiAgICB9CgogICAgdmFyIHVzZXNraXAgPSAhIXNraXA7CiAgICB2YXIgdGVtcGxhdGUgPSBDb2RpbmdUZW1wbGF0ZXNbdGVtcGxhdGVJbmRleF0uY29uY2F0KGF0KTsKICAgIHRlbXBsYXRlLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgcmV0dXJuIGEueSAtIGIueSB8fCBhLnggLSBiLng7CiAgICB9KTsKICAgIHZhciB0ZW1wbGF0ZUxlbmd0aCA9IHRlbXBsYXRlLmxlbmd0aDsKICAgIHZhciB0ZW1wbGF0ZVggPSBuZXcgSW50OEFycmF5KHRlbXBsYXRlTGVuZ3RoKTsKICAgIHZhciB0ZW1wbGF0ZVkgPSBuZXcgSW50OEFycmF5KHRlbXBsYXRlTGVuZ3RoKTsKICAgIHZhciBjaGFuZ2luZ1RlbXBsYXRlRW50cmllcyA9IFtdOwogICAgdmFyIHJldXNlTWFzayA9IDAsCiAgICAgICAgbWluWCA9IDAsCiAgICAgICAgbWF4WCA9IDAsCiAgICAgICAgbWluWSA9IDA7CiAgICB2YXIgYywgazsKCiAgICBmb3IgKGsgPSAwOyBrIDwgdGVtcGxhdGVMZW5ndGg7IGsrKykgewogICAgICB0ZW1wbGF0ZVhba10gPSB0ZW1wbGF0ZVtrXS54OwogICAgICB0ZW1wbGF0ZVlba10gPSB0ZW1wbGF0ZVtrXS55OwogICAgICBtaW5YID0gTWF0aC5taW4obWluWCwgdGVtcGxhdGVba10ueCk7CiAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCB0ZW1wbGF0ZVtrXS54KTsKICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIHRlbXBsYXRlW2tdLnkpOwoKICAgICAgaWYgKGsgPCB0ZW1wbGF0ZUxlbmd0aCAtIDEgJiYgdGVtcGxhdGVba10ueSA9PT0gdGVtcGxhdGVbayArIDFdLnkgJiYgdGVtcGxhdGVba10ueCA9PT0gdGVtcGxhdGVbayArIDFdLnggLSAxKSB7CiAgICAgICAgcmV1c2VNYXNrIHw9IDEgPDwgdGVtcGxhdGVMZW5ndGggLSAxIC0gazsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFuZ2luZ1RlbXBsYXRlRW50cmllcy5wdXNoKGspOwogICAgICB9CiAgICB9CgogICAgdmFyIGNoYW5naW5nRW50cmllc0xlbmd0aCA9IGNoYW5naW5nVGVtcGxhdGVFbnRyaWVzLmxlbmd0aDsKICAgIHZhciBjaGFuZ2luZ1RlbXBsYXRlWCA9IG5ldyBJbnQ4QXJyYXkoY2hhbmdpbmdFbnRyaWVzTGVuZ3RoKTsKICAgIHZhciBjaGFuZ2luZ1RlbXBsYXRlWSA9IG5ldyBJbnQ4QXJyYXkoY2hhbmdpbmdFbnRyaWVzTGVuZ3RoKTsKICAgIHZhciBjaGFuZ2luZ1RlbXBsYXRlQml0ID0gbmV3IFVpbnQxNkFycmF5KGNoYW5naW5nRW50cmllc0xlbmd0aCk7CgogICAgZm9yIChjID0gMDsgYyA8IGNoYW5naW5nRW50cmllc0xlbmd0aDsgYysrKSB7CiAgICAgIGsgPSBjaGFuZ2luZ1RlbXBsYXRlRW50cmllc1tjXTsKICAgICAgY2hhbmdpbmdUZW1wbGF0ZVhbY10gPSB0ZW1wbGF0ZVtrXS54OwogICAgICBjaGFuZ2luZ1RlbXBsYXRlWVtjXSA9IHRlbXBsYXRlW2tdLnk7CiAgICAgIGNoYW5naW5nVGVtcGxhdGVCaXRbY10gPSAxIDw8IHRlbXBsYXRlTGVuZ3RoIC0gMSAtIGs7CiAgICB9CgogICAgdmFyIHNiYl9sZWZ0ID0gLW1pblg7CiAgICB2YXIgc2JiX3RvcCA9IC1taW5ZOwogICAgdmFyIHNiYl9yaWdodCA9IHdpZHRoIC0gbWF4WDsKICAgIHZhciBwc2V1ZG9QaXhlbENvbnRleHQgPSBSZXVzZWRDb250ZXh0c1t0ZW1wbGF0ZUluZGV4XTsKICAgIHZhciByb3cgPSBuZXcgVWludDhBcnJheSh3aWR0aCk7CiAgICB2YXIgYml0bWFwID0gW107CiAgICB2YXIgZGVjb2RlciA9IGRlY29kaW5nQ29udGV4dC5kZWNvZGVyOwogICAgdmFyIGNvbnRleHRzID0gZGVjb2RpbmdDb250ZXh0LmNvbnRleHRDYWNoZS5nZXRDb250ZXh0cygiR0IiKTsKICAgIHZhciBsdHAgPSAwLAogICAgICAgIGosCiAgICAgICAgaTAsCiAgICAgICAgajAsCiAgICAgICAgY29udGV4dExhYmVsID0gMCwKICAgICAgICBiaXQsCiAgICAgICAgc2hpZnQ7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewogICAgICBpZiAocHJlZGljdGlvbikgewogICAgICAgIHZhciBzbHRwID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBwc2V1ZG9QaXhlbENvbnRleHQpOwogICAgICAgIGx0cCBePSBzbHRwOwoKICAgICAgICBpZiAobHRwKSB7CiAgICAgICAgICBiaXRtYXAucHVzaChyb3cpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICB9CgogICAgICByb3cgPSBuZXcgVWludDhBcnJheShyb3cpOwogICAgICBiaXRtYXAucHVzaChyb3cpOwoKICAgICAgZm9yIChqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICBpZiAodXNlc2tpcCAmJiBza2lwW2ldW2pdKSB7CiAgICAgICAgICByb3dbal0gPSAwOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoaiA+PSBzYmJfbGVmdCAmJiBqIDwgc2JiX3JpZ2h0ICYmIGkgPj0gc2JiX3RvcCkgewogICAgICAgICAgY29udGV4dExhYmVsID0gY29udGV4dExhYmVsIDw8IDEgJiByZXVzZU1hc2s7CgogICAgICAgICAgZm9yIChrID0gMDsgayA8IGNoYW5naW5nRW50cmllc0xlbmd0aDsgaysrKSB7CiAgICAgICAgICAgIGkwID0gaSArIGNoYW5naW5nVGVtcGxhdGVZW2tdOwogICAgICAgICAgICBqMCA9IGogKyBjaGFuZ2luZ1RlbXBsYXRlWFtrXTsKICAgICAgICAgICAgYml0ID0gYml0bWFwW2kwXVtqMF07CgogICAgICAgICAgICBpZiAoYml0KSB7CiAgICAgICAgICAgICAgYml0ID0gY2hhbmdpbmdUZW1wbGF0ZUJpdFtrXTsKICAgICAgICAgICAgICBjb250ZXh0TGFiZWwgfD0gYml0OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnRleHRMYWJlbCA9IDA7CiAgICAgICAgICBzaGlmdCA9IHRlbXBsYXRlTGVuZ3RoIC0gMTsKCiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgdGVtcGxhdGVMZW5ndGg7IGsrKywgc2hpZnQtLSkgewogICAgICAgICAgICBqMCA9IGogKyB0ZW1wbGF0ZVhba107CgogICAgICAgICAgICBpZiAoajAgPj0gMCAmJiBqMCA8IHdpZHRoKSB7CiAgICAgICAgICAgICAgaTAgPSBpICsgdGVtcGxhdGVZW2tdOwoKICAgICAgICAgICAgICBpZiAoaTAgPj0gMCkgewogICAgICAgICAgICAgICAgYml0ID0gYml0bWFwW2kwXVtqMF07CgogICAgICAgICAgICAgICAgaWYgKGJpdCkgewogICAgICAgICAgICAgICAgICBjb250ZXh0TGFiZWwgfD0gYml0IDw8IHNoaWZ0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFyIHBpeGVsID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBjb250ZXh0TGFiZWwpOwogICAgICAgIHJvd1tqXSA9IHBpeGVsOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGJpdG1hcDsKICB9CgogIGZ1bmN0aW9uIGRlY29kZVJlZmluZW1lbnQod2lkdGgsIGhlaWdodCwgdGVtcGxhdGVJbmRleCwgcmVmZXJlbmNlQml0bWFwLCBvZmZzZXRYLCBvZmZzZXRZLCBwcmVkaWN0aW9uLCBhdCwgZGVjb2RpbmdDb250ZXh0KSB7CiAgICB2YXIgY29kaW5nVGVtcGxhdGUgPSBSZWZpbmVtZW50VGVtcGxhdGVzW3RlbXBsYXRlSW5kZXhdLmNvZGluZzsKCiAgICBpZiAodGVtcGxhdGVJbmRleCA9PT0gMCkgewogICAgICBjb2RpbmdUZW1wbGF0ZSA9IGNvZGluZ1RlbXBsYXRlLmNvbmNhdChbYXRbMF1dKTsKICAgIH0KCiAgICB2YXIgY29kaW5nVGVtcGxhdGVMZW5ndGggPSBjb2RpbmdUZW1wbGF0ZS5sZW5ndGg7CiAgICB2YXIgY29kaW5nVGVtcGxhdGVYID0gbmV3IEludDMyQXJyYXkoY29kaW5nVGVtcGxhdGVMZW5ndGgpOwogICAgdmFyIGNvZGluZ1RlbXBsYXRlWSA9IG5ldyBJbnQzMkFycmF5KGNvZGluZ1RlbXBsYXRlTGVuZ3RoKTsKICAgIHZhciBrOwoKICAgIGZvciAoayA9IDA7IGsgPCBjb2RpbmdUZW1wbGF0ZUxlbmd0aDsgaysrKSB7CiAgICAgIGNvZGluZ1RlbXBsYXRlWFtrXSA9IGNvZGluZ1RlbXBsYXRlW2tdLng7CiAgICAgIGNvZGluZ1RlbXBsYXRlWVtrXSA9IGNvZGluZ1RlbXBsYXRlW2tdLnk7CiAgICB9CgogICAgdmFyIHJlZmVyZW5jZVRlbXBsYXRlID0gUmVmaW5lbWVudFRlbXBsYXRlc1t0ZW1wbGF0ZUluZGV4XS5yZWZlcmVuY2U7CgogICAgaWYgKHRlbXBsYXRlSW5kZXggPT09IDApIHsKICAgICAgcmVmZXJlbmNlVGVtcGxhdGUgPSByZWZlcmVuY2VUZW1wbGF0ZS5jb25jYXQoW2F0WzFdXSk7CiAgICB9CgogICAgdmFyIHJlZmVyZW5jZVRlbXBsYXRlTGVuZ3RoID0gcmVmZXJlbmNlVGVtcGxhdGUubGVuZ3RoOwogICAgdmFyIHJlZmVyZW5jZVRlbXBsYXRlWCA9IG5ldyBJbnQzMkFycmF5KHJlZmVyZW5jZVRlbXBsYXRlTGVuZ3RoKTsKICAgIHZhciByZWZlcmVuY2VUZW1wbGF0ZVkgPSBuZXcgSW50MzJBcnJheShyZWZlcmVuY2VUZW1wbGF0ZUxlbmd0aCk7CgogICAgZm9yIChrID0gMDsgayA8IHJlZmVyZW5jZVRlbXBsYXRlTGVuZ3RoOyBrKyspIHsKICAgICAgcmVmZXJlbmNlVGVtcGxhdGVYW2tdID0gcmVmZXJlbmNlVGVtcGxhdGVba10ueDsKICAgICAgcmVmZXJlbmNlVGVtcGxhdGVZW2tdID0gcmVmZXJlbmNlVGVtcGxhdGVba10ueTsKICAgIH0KCiAgICB2YXIgcmVmZXJlbmNlV2lkdGggPSByZWZlcmVuY2VCaXRtYXBbMF0ubGVuZ3RoOwogICAgdmFyIHJlZmVyZW5jZUhlaWdodCA9IHJlZmVyZW5jZUJpdG1hcC5sZW5ndGg7CiAgICB2YXIgcHNldWRvUGl4ZWxDb250ZXh0ID0gUmVmaW5lbWVudFJldXNlZENvbnRleHRzW3RlbXBsYXRlSW5kZXhdOwogICAgdmFyIGJpdG1hcCA9IFtdOwogICAgdmFyIGRlY29kZXIgPSBkZWNvZGluZ0NvbnRleHQuZGVjb2RlcjsKICAgIHZhciBjb250ZXh0cyA9IGRlY29kaW5nQ29udGV4dC5jb250ZXh0Q2FjaGUuZ2V0Q29udGV4dHMoIkdSIik7CiAgICB2YXIgbHRwID0gMDsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7CiAgICAgIGlmIChwcmVkaWN0aW9uKSB7CiAgICAgICAgdmFyIHNsdHAgPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIHBzZXVkb1BpeGVsQ29udGV4dCk7CiAgICAgICAgbHRwIF49IHNsdHA7CgogICAgICAgIGlmIChsdHApIHsKICAgICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJwcmVkaWN0aW9uIGlzIG5vdCBzdXBwb3J0ZWQiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciByb3cgPSBuZXcgVWludDhBcnJheSh3aWR0aCk7CiAgICAgIGJpdG1hcC5wdXNoKHJvdyk7CgogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICB2YXIgaTAsIGowOwogICAgICAgIHZhciBjb250ZXh0TGFiZWwgPSAwOwoKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgY29kaW5nVGVtcGxhdGVMZW5ndGg7IGsrKykgewogICAgICAgICAgaTAgPSBpICsgY29kaW5nVGVtcGxhdGVZW2tdOwogICAgICAgICAgajAgPSBqICsgY29kaW5nVGVtcGxhdGVYW2tdOwoKICAgICAgICAgIGlmIChpMCA8IDAgfHwgajAgPCAwIHx8IGowID49IHdpZHRoKSB7CiAgICAgICAgICAgIGNvbnRleHRMYWJlbCA8PD0gMTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnRleHRMYWJlbCA9IGNvbnRleHRMYWJlbCA8PCAxIHwgYml0bWFwW2kwXVtqMF07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgcmVmZXJlbmNlVGVtcGxhdGVMZW5ndGg7IGsrKykgewogICAgICAgICAgaTAgPSBpICsgcmVmZXJlbmNlVGVtcGxhdGVZW2tdIC0gb2Zmc2V0WTsKICAgICAgICAgIGowID0gaiArIHJlZmVyZW5jZVRlbXBsYXRlWFtrXSAtIG9mZnNldFg7CgogICAgICAgICAgaWYgKGkwIDwgMCB8fCBpMCA+PSByZWZlcmVuY2VIZWlnaHQgfHwgajAgPCAwIHx8IGowID49IHJlZmVyZW5jZVdpZHRoKSB7CiAgICAgICAgICAgIGNvbnRleHRMYWJlbCA8PD0gMTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnRleHRMYWJlbCA9IGNvbnRleHRMYWJlbCA8PCAxIHwgcmVmZXJlbmNlQml0bWFwW2kwXVtqMF07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgcGl4ZWwgPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIGNvbnRleHRMYWJlbCk7CiAgICAgICAgcm93W2pdID0gcGl4ZWw7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYml0bWFwOwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlU3ltYm9sRGljdGlvbmFyeShodWZmbWFuLCByZWZpbmVtZW50LCBzeW1ib2xzLCBudW1iZXJPZk5ld1N5bWJvbHMsIG51bWJlck9mRXhwb3J0ZWRTeW1ib2xzLCBodWZmbWFuVGFibGVzLCB0ZW1wbGF0ZUluZGV4LCBhdCwgcmVmaW5lbWVudFRlbXBsYXRlSW5kZXgsIHJlZmluZW1lbnRBdCwgZGVjb2RpbmdDb250ZXh0LCBodWZmbWFuSW5wdXQpIHsKICAgIGlmIChodWZmbWFuICYmIHJlZmluZW1lbnQpIHsKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoInN5bWJvbCByZWZpbmVtZW50IHdpdGggSHVmZm1hbiBpcyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CgogICAgdmFyIG5ld1N5bWJvbHMgPSBbXTsKICAgIHZhciBjdXJyZW50SGVpZ2h0ID0gMDsKICAgIHZhciBzeW1ib2xDb2RlTGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKHN5bWJvbHMubGVuZ3RoICsgbnVtYmVyT2ZOZXdTeW1ib2xzKTsKICAgIHZhciBkZWNvZGVyID0gZGVjb2RpbmdDb250ZXh0LmRlY29kZXI7CiAgICB2YXIgY29udGV4dENhY2hlID0gZGVjb2RpbmdDb250ZXh0LmNvbnRleHRDYWNoZTsKICAgIHZhciB0YWJsZUIxLCBzeW1ib2xXaWR0aHM7CgogICAgaWYgKGh1ZmZtYW4pIHsKICAgICAgdGFibGVCMSA9IGdldFN0YW5kYXJkVGFibGUoMSk7CiAgICAgIHN5bWJvbFdpZHRocyA9IFtdOwogICAgICBzeW1ib2xDb2RlTGVuZ3RoID0gTWF0aC5tYXgoc3ltYm9sQ29kZUxlbmd0aCwgMSk7CiAgICB9CgogICAgd2hpbGUgKG5ld1N5bWJvbHMubGVuZ3RoIDwgbnVtYmVyT2ZOZXdTeW1ib2xzKSB7CiAgICAgIHZhciBkZWx0YUhlaWdodCA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnRhYmxlRGVsdGFIZWlnaHQuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBREgiLCBkZWNvZGVyKTsKICAgICAgY3VycmVudEhlaWdodCArPSBkZWx0YUhlaWdodDsKICAgICAgdmFyIGN1cnJlbnRXaWR0aCA9IDAsCiAgICAgICAgICB0b3RhbFdpZHRoID0gMDsKICAgICAgdmFyIGZpcnN0U3ltYm9sID0gaHVmZm1hbiA/IHN5bWJvbFdpZHRocy5sZW5ndGggOiAwOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICB2YXIgZGVsdGFXaWR0aCA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnRhYmxlRGVsdGFXaWR0aC5kZWNvZGUoaHVmZm1hbklucHV0KSA6IGRlY29kZUludGVnZXIoY29udGV4dENhY2hlLCAiSUFEVyIsIGRlY29kZXIpOwoKICAgICAgICBpZiAoZGVsdGFXaWR0aCA9PT0gbnVsbCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50V2lkdGggKz0gZGVsdGFXaWR0aDsKICAgICAgICB0b3RhbFdpZHRoICs9IGN1cnJlbnRXaWR0aDsKICAgICAgICB2YXIgYml0bWFwOwoKICAgICAgICBpZiAocmVmaW5lbWVudCkgewogICAgICAgICAgdmFyIG51bWJlck9mSW5zdGFuY2VzID0gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQUFJIiwgZGVjb2Rlcik7CgogICAgICAgICAgaWYgKG51bWJlck9mSW5zdGFuY2VzID4gMSkgewogICAgICAgICAgICBiaXRtYXAgPSBkZWNvZGVUZXh0UmVnaW9uKGh1ZmZtYW4sIHJlZmluZW1lbnQsIGN1cnJlbnRXaWR0aCwgY3VycmVudEhlaWdodCwgMCwgbnVtYmVyT2ZJbnN0YW5jZXMsIDEsIHN5bWJvbHMuY29uY2F0KG5ld1N5bWJvbHMpLCBzeW1ib2xDb2RlTGVuZ3RoLCAwLCAwLCAxLCAwLCBodWZmbWFuVGFibGVzLCByZWZpbmVtZW50VGVtcGxhdGVJbmRleCwgcmVmaW5lbWVudEF0LCBkZWNvZGluZ0NvbnRleHQsIDAsIGh1ZmZtYW5JbnB1dCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgc3ltYm9sSWQgPSBkZWNvZGVJQUlEKGNvbnRleHRDYWNoZSwgZGVjb2Rlciwgc3ltYm9sQ29kZUxlbmd0aCk7CiAgICAgICAgICAgIHZhciByZHggPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRYIiwgZGVjb2Rlcik7CiAgICAgICAgICAgIHZhciByZHkgPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRZIiwgZGVjb2Rlcik7CiAgICAgICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xJZCA8IHN5bWJvbHMubGVuZ3RoID8gc3ltYm9sc1tzeW1ib2xJZF0gOiBuZXdTeW1ib2xzW3N5bWJvbElkIC0gc3ltYm9scy5sZW5ndGhdOwogICAgICAgICAgICBiaXRtYXAgPSBkZWNvZGVSZWZpbmVtZW50KGN1cnJlbnRXaWR0aCwgY3VycmVudEhlaWdodCwgcmVmaW5lbWVudFRlbXBsYXRlSW5kZXgsIHN5bWJvbCwgcmR4LCByZHksIGZhbHNlLCByZWZpbmVtZW50QXQsIGRlY29kaW5nQ29udGV4dCk7CiAgICAgICAgICB9CgogICAgICAgICAgbmV3U3ltYm9scy5wdXNoKGJpdG1hcCk7CiAgICAgICAgfSBlbHNlIGlmIChodWZmbWFuKSB7CiAgICAgICAgICBzeW1ib2xXaWR0aHMucHVzaChjdXJyZW50V2lkdGgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBiaXRtYXAgPSBkZWNvZGVCaXRtYXAoZmFsc2UsIGN1cnJlbnRXaWR0aCwgY3VycmVudEhlaWdodCwgdGVtcGxhdGVJbmRleCwgZmFsc2UsIG51bGwsIGF0LCBkZWNvZGluZ0NvbnRleHQpOwogICAgICAgICAgbmV3U3ltYm9scy5wdXNoKGJpdG1hcCk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoaHVmZm1hbiAmJiAhcmVmaW5lbWVudCkgewogICAgICAgIHZhciBiaXRtYXBTaXplID0gaHVmZm1hblRhYmxlcy50YWJsZUJpdG1hcFNpemUuZGVjb2RlKGh1ZmZtYW5JbnB1dCk7CiAgICAgICAgaHVmZm1hbklucHV0LmJ5dGVBbGlnbigpOwogICAgICAgIHZhciBjb2xsZWN0aXZlQml0bWFwID0gdm9pZCAwOwoKICAgICAgICBpZiAoYml0bWFwU2l6ZSA9PT0gMCkgewogICAgICAgICAgY29sbGVjdGl2ZUJpdG1hcCA9IHJlYWRVbmNvbXByZXNzZWRCaXRtYXAoaHVmZm1hbklucHV0LCB0b3RhbFdpZHRoLCBjdXJyZW50SGVpZ2h0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIG9yaWdpbmFsRW5kID0gaHVmZm1hbklucHV0LmVuZDsKICAgICAgICAgIHZhciBiaXRtYXBFbmQgPSBodWZmbWFuSW5wdXQucG9zaXRpb24gKyBiaXRtYXBTaXplOwogICAgICAgICAgaHVmZm1hbklucHV0LmVuZCA9IGJpdG1hcEVuZDsKICAgICAgICAgIGNvbGxlY3RpdmVCaXRtYXAgPSBkZWNvZGVNTVJCaXRtYXAoaHVmZm1hbklucHV0LCB0b3RhbFdpZHRoLCBjdXJyZW50SGVpZ2h0LCBmYWxzZSk7CiAgICAgICAgICBodWZmbWFuSW5wdXQuZW5kID0gb3JpZ2luYWxFbmQ7CiAgICAgICAgICBodWZmbWFuSW5wdXQucG9zaXRpb24gPSBiaXRtYXBFbmQ7CiAgICAgICAgfQoKICAgICAgICB2YXIgbnVtYmVyT2ZTeW1ib2xzRGVjb2RlZCA9IHN5bWJvbFdpZHRocy5sZW5ndGg7CgogICAgICAgIGlmIChmaXJzdFN5bWJvbCA9PT0gbnVtYmVyT2ZTeW1ib2xzRGVjb2RlZCAtIDEpIHsKICAgICAgICAgIG5ld1N5bWJvbHMucHVzaChjb2xsZWN0aXZlQml0bWFwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIF9pID0gdm9pZCAwLAogICAgICAgICAgICAgIHkgPSB2b2lkIDAsCiAgICAgICAgICAgICAgeE1pbiA9IDAsCiAgICAgICAgICAgICAgeE1heCA9IHZvaWQgMCwKICAgICAgICAgICAgICBiaXRtYXBXaWR0aCA9IHZvaWQgMCwKICAgICAgICAgICAgICBzeW1ib2xCaXRtYXAgPSB2b2lkIDA7CgogICAgICAgICAgZm9yIChfaSA9IGZpcnN0U3ltYm9sOyBfaSA8IG51bWJlck9mU3ltYm9sc0RlY29kZWQ7IF9pKyspIHsKICAgICAgICAgICAgYml0bWFwV2lkdGggPSBzeW1ib2xXaWR0aHNbX2ldOwogICAgICAgICAgICB4TWF4ID0geE1pbiArIGJpdG1hcFdpZHRoOwogICAgICAgICAgICBzeW1ib2xCaXRtYXAgPSBbXTsKCiAgICAgICAgICAgIGZvciAoeSA9IDA7IHkgPCBjdXJyZW50SGVpZ2h0OyB5KyspIHsKICAgICAgICAgICAgICBzeW1ib2xCaXRtYXAucHVzaChjb2xsZWN0aXZlQml0bWFwW3ldLnN1YmFycmF5KHhNaW4sIHhNYXgpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV3U3ltYm9scy5wdXNoKHN5bWJvbEJpdG1hcCk7CiAgICAgICAgICAgIHhNaW4gPSB4TWF4OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHZhciBleHBvcnRlZFN5bWJvbHMgPSBbXTsKICAgIHZhciBmbGFncyA9IFtdLAogICAgICAgIGN1cnJlbnRGbGFnID0gZmFsc2U7CiAgICB2YXIgdG90YWxTeW1ib2xzTGVuZ3RoID0gc3ltYm9scy5sZW5ndGggKyBudW1iZXJPZk5ld1N5bWJvbHM7CgogICAgd2hpbGUgKGZsYWdzLmxlbmd0aCA8IHRvdGFsU3ltYm9sc0xlbmd0aCkgewogICAgICB2YXIgcnVuTGVuZ3RoID0gaHVmZm1hbiA/IHRhYmxlQjEuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBRVgiLCBkZWNvZGVyKTsKCiAgICAgIHdoaWxlIChydW5MZW5ndGgtLSkgewogICAgICAgIGZsYWdzLnB1c2goY3VycmVudEZsYWcpOwogICAgICB9CgogICAgICBjdXJyZW50RmxhZyA9ICFjdXJyZW50RmxhZzsKICAgIH0KCiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzeW1ib2xzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgaWYgKGZsYWdzW2ldKSB7CiAgICAgICAgZXhwb3J0ZWRTeW1ib2xzLnB1c2goc3ltYm9sc1tpXSk7CiAgICAgIH0KICAgIH0KCiAgICBmb3IgKHZhciBqID0gMDsgaiA8IG51bWJlck9mTmV3U3ltYm9sczsgaSsrLCBqKyspIHsKICAgICAgaWYgKGZsYWdzW2ldKSB7CiAgICAgICAgZXhwb3J0ZWRTeW1ib2xzLnB1c2gobmV3U3ltYm9sc1tqXSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZXhwb3J0ZWRTeW1ib2xzOwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlVGV4dFJlZ2lvbihodWZmbWFuLCByZWZpbmVtZW50LCB3aWR0aCwgaGVpZ2h0LCBkZWZhdWx0UGl4ZWxWYWx1ZSwgbnVtYmVyT2ZTeW1ib2xJbnN0YW5jZXMsIHN0cmlwU2l6ZSwgaW5wdXRTeW1ib2xzLCBzeW1ib2xDb2RlTGVuZ3RoLCB0cmFuc3Bvc2VkLCBkc09mZnNldCwgcmVmZXJlbmNlQ29ybmVyLCBjb21iaW5hdGlvbk9wZXJhdG9yLCBodWZmbWFuVGFibGVzLCByZWZpbmVtZW50VGVtcGxhdGVJbmRleCwgcmVmaW5lbWVudEF0LCBkZWNvZGluZ0NvbnRleHQsIGxvZ1N0cmlwU2l6ZSwgaHVmZm1hbklucHV0KSB7CiAgICBpZiAoaHVmZm1hbiAmJiByZWZpbmVtZW50KSB7CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJyZWZpbmVtZW50IHdpdGggSHVmZm1hbiBpcyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CgogICAgdmFyIGJpdG1hcCA9IFtdOwogICAgdmFyIGksIHJvdzsKCiAgICBmb3IgKGkgPSAwOyBpIDwgaGVpZ2h0OyBpKyspIHsKICAgICAgcm93ID0gbmV3IFVpbnQ4QXJyYXkod2lkdGgpOwoKICAgICAgaWYgKGRlZmF1bHRQaXhlbFZhbHVlKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CiAgICAgICAgICByb3dbal0gPSBkZWZhdWx0UGl4ZWxWYWx1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGJpdG1hcC5wdXNoKHJvdyk7CiAgICB9CgogICAgdmFyIGRlY29kZXIgPSBkZWNvZGluZ0NvbnRleHQuZGVjb2RlcjsKICAgIHZhciBjb250ZXh0Q2FjaGUgPSBkZWNvZGluZ0NvbnRleHQuY29udGV4dENhY2hlOwogICAgdmFyIHN0cmlwVCA9IGh1ZmZtYW4gPyAtaHVmZm1hblRhYmxlcy50YWJsZURlbHRhVC5kZWNvZGUoaHVmZm1hbklucHV0KSA6IC1kZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBRFQiLCBkZWNvZGVyKTsKICAgIHZhciBmaXJzdFMgPSAwOwogICAgaSA9IDA7CgogICAgd2hpbGUgKGkgPCBudW1iZXJPZlN5bWJvbEluc3RhbmNlcykgewogICAgICB2YXIgZGVsdGFUID0gaHVmZm1hbiA/IGh1ZmZtYW5UYWJsZXMudGFibGVEZWx0YVQuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBRFQiLCBkZWNvZGVyKTsKICAgICAgc3RyaXBUICs9IGRlbHRhVDsKICAgICAgdmFyIGRlbHRhRmlyc3RTID0gaHVmZm1hbiA/IGh1ZmZtYW5UYWJsZXMudGFibGVGaXJzdFMuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBRlMiLCBkZWNvZGVyKTsKICAgICAgZmlyc3RTICs9IGRlbHRhRmlyc3RTOwogICAgICB2YXIgY3VycmVudFMgPSBmaXJzdFM7CgogICAgICBkbyB7CiAgICAgICAgdmFyIGN1cnJlbnRUID0gMDsKCiAgICAgICAgaWYgKHN0cmlwU2l6ZSA+IDEpIHsKICAgICAgICAgIGN1cnJlbnRUID0gaHVmZm1hbiA/IGh1ZmZtYW5JbnB1dC5yZWFkQml0cyhsb2dTdHJpcFNpemUpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQUlUIiwgZGVjb2Rlcik7CiAgICAgICAgfQoKICAgICAgICB2YXIgdCA9IHN0cmlwU2l6ZSAqIHN0cmlwVCArIGN1cnJlbnRUOwogICAgICAgIHZhciBzeW1ib2xJZCA9IGh1ZmZtYW4gPyBodWZmbWFuVGFibGVzLnN5bWJvbElEVGFibGUuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJQUlEKGNvbnRleHRDYWNoZSwgZGVjb2Rlciwgc3ltYm9sQ29kZUxlbmd0aCk7CiAgICAgICAgdmFyIGFwcGx5UmVmaW5lbWVudCA9IHJlZmluZW1lbnQgJiYgKGh1ZmZtYW4gPyBodWZmbWFuSW5wdXQucmVhZEJpdCgpIDogZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQVJJIiwgZGVjb2RlcikpOwogICAgICAgIHZhciBzeW1ib2xCaXRtYXAgPSBpbnB1dFN5bWJvbHNbc3ltYm9sSWRdOwogICAgICAgIHZhciBzeW1ib2xXaWR0aCA9IHN5bWJvbEJpdG1hcFswXS5sZW5ndGg7CiAgICAgICAgdmFyIHN5bWJvbEhlaWdodCA9IHN5bWJvbEJpdG1hcC5sZW5ndGg7CgogICAgICAgIGlmIChhcHBseVJlZmluZW1lbnQpIHsKICAgICAgICAgIHZhciByZHcgPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRXIiwgZGVjb2Rlcik7CiAgICAgICAgICB2YXIgcmRoID0gZGVjb2RlSW50ZWdlcihjb250ZXh0Q2FjaGUsICJJQVJESCIsIGRlY29kZXIpOwogICAgICAgICAgdmFyIHJkeCA9IGRlY29kZUludGVnZXIoY29udGV4dENhY2hlLCAiSUFSRFgiLCBkZWNvZGVyKTsKICAgICAgICAgIHZhciByZHkgPSBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBUkRZIiwgZGVjb2Rlcik7CiAgICAgICAgICBzeW1ib2xXaWR0aCArPSByZHc7CiAgICAgICAgICBzeW1ib2xIZWlnaHQgKz0gcmRoOwogICAgICAgICAgc3ltYm9sQml0bWFwID0gZGVjb2RlUmVmaW5lbWVudChzeW1ib2xXaWR0aCwgc3ltYm9sSGVpZ2h0LCByZWZpbmVtZW50VGVtcGxhdGVJbmRleCwgc3ltYm9sQml0bWFwLCAocmR3ID4+IDEpICsgcmR4LCAocmRoID4+IDEpICsgcmR5LCBmYWxzZSwgcmVmaW5lbWVudEF0LCBkZWNvZGluZ0NvbnRleHQpOwogICAgICAgIH0KCiAgICAgICAgdmFyIG9mZnNldFQgPSB0IC0gKHJlZmVyZW5jZUNvcm5lciAmIDEgPyAwIDogc3ltYm9sSGVpZ2h0IC0gMSk7CiAgICAgICAgdmFyIG9mZnNldFMgPSBjdXJyZW50UyAtIChyZWZlcmVuY2VDb3JuZXIgJiAyID8gc3ltYm9sV2lkdGggLSAxIDogMCk7CiAgICAgICAgdmFyIHMyLCB0Miwgc3ltYm9sUm93OwoKICAgICAgICBpZiAodHJhbnNwb3NlZCkgewogICAgICAgICAgZm9yIChzMiA9IDA7IHMyIDwgc3ltYm9sSGVpZ2h0OyBzMisrKSB7CiAgICAgICAgICAgIHJvdyA9IGJpdG1hcFtvZmZzZXRTICsgczJdOwoKICAgICAgICAgICAgaWYgKCFyb3cpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3ltYm9sUm93ID0gc3ltYm9sQml0bWFwW3MyXTsKICAgICAgICAgICAgdmFyIG1heFdpZHRoID0gTWF0aC5taW4od2lkdGggLSBvZmZzZXRULCBzeW1ib2xXaWR0aCk7CgogICAgICAgICAgICBzd2l0Y2ggKGNvbWJpbmF0aW9uT3BlcmF0b3IpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBmb3IgKHQyID0gMDsgdDIgPCBtYXhXaWR0aDsgdDIrKykgewogICAgICAgICAgICAgICAgICByb3dbb2Zmc2V0VCArIHQyXSB8PSBzeW1ib2xSb3dbdDJdOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBmb3IgKHQyID0gMDsgdDIgPCBtYXhXaWR0aDsgdDIrKykgewogICAgICAgICAgICAgICAgICByb3dbb2Zmc2V0VCArIHQyXSBePSBzeW1ib2xSb3dbdDJdOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoIm9wZXJhdG9yICIuY29uY2F0KGNvbWJpbmF0aW9uT3BlcmF0b3IsICIgaXMgbm90IHN1cHBvcnRlZCIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRTICs9IHN5bWJvbEhlaWdodCAtIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAodDIgPSAwOyB0MiA8IHN5bWJvbEhlaWdodDsgdDIrKykgewogICAgICAgICAgICByb3cgPSBiaXRtYXBbb2Zmc2V0VCArIHQyXTsKCiAgICAgICAgICAgIGlmICghcm93KSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN5bWJvbFJvdyA9IHN5bWJvbEJpdG1hcFt0Ml07CgogICAgICAgICAgICBzd2l0Y2ggKGNvbWJpbmF0aW9uT3BlcmF0b3IpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBmb3IgKHMyID0gMDsgczIgPCBzeW1ib2xXaWR0aDsgczIrKykgewogICAgICAgICAgICAgICAgICByb3dbb2Zmc2V0UyArIHMyXSB8PSBzeW1ib2xSb3dbczJdOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBmb3IgKHMyID0gMDsgczIgPCBzeW1ib2xXaWR0aDsgczIrKykgewogICAgICAgICAgICAgICAgICByb3dbb2Zmc2V0UyArIHMyXSBePSBzeW1ib2xSb3dbczJdOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoIm9wZXJhdG9yICIuY29uY2F0KGNvbWJpbmF0aW9uT3BlcmF0b3IsICIgaXMgbm90IHN1cHBvcnRlZCIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGN1cnJlbnRTICs9IHN5bWJvbFdpZHRoIC0gMTsKICAgICAgICB9CgogICAgICAgIGkrKzsKICAgICAgICB2YXIgZGVsdGFTID0gaHVmZm1hbiA/IGh1ZmZtYW5UYWJsZXMudGFibGVEZWx0YVMuZGVjb2RlKGh1ZmZtYW5JbnB1dCkgOiBkZWNvZGVJbnRlZ2VyKGNvbnRleHRDYWNoZSwgIklBRFMiLCBkZWNvZGVyKTsKCiAgICAgICAgaWYgKGRlbHRhUyA9PT0gbnVsbCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50UyArPSBkZWx0YVMgKyBkc09mZnNldDsKICAgICAgfSB3aGlsZSAodHJ1ZSk7CiAgICB9CgogICAgcmV0dXJuIGJpdG1hcDsKICB9CgogIGZ1bmN0aW9uIGRlY29kZVBhdHRlcm5EaWN0aW9uYXJ5KG1tciwgcGF0dGVybldpZHRoLCBwYXR0ZXJuSGVpZ2h0LCBtYXhQYXR0ZXJuSW5kZXgsIHRlbXBsYXRlLCBkZWNvZGluZ0NvbnRleHQpIHsKICAgIHZhciBhdCA9IFtdOwoKICAgIGlmICghbW1yKSB7CiAgICAgIGF0LnB1c2goewogICAgICAgIHg6IC1wYXR0ZXJuV2lkdGgsCiAgICAgICAgeTogMAogICAgICB9KTsKCiAgICAgIGlmICh0ZW1wbGF0ZSA9PT0gMCkgewogICAgICAgIGF0LnB1c2goewogICAgICAgICAgeDogLTMsCiAgICAgICAgICB5OiAtMQogICAgICAgIH0pOwogICAgICAgIGF0LnB1c2goewogICAgICAgICAgeDogMiwKICAgICAgICAgIHk6IC0yCiAgICAgICAgfSk7CiAgICAgICAgYXQucHVzaCh7CiAgICAgICAgICB4OiAtMiwKICAgICAgICAgIHk6IC0yCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgY29sbGVjdGl2ZVdpZHRoID0gKG1heFBhdHRlcm5JbmRleCArIDEpICogcGF0dGVybldpZHRoOwogICAgdmFyIGNvbGxlY3RpdmVCaXRtYXAgPSBkZWNvZGVCaXRtYXAobW1yLCBjb2xsZWN0aXZlV2lkdGgsIHBhdHRlcm5IZWlnaHQsIHRlbXBsYXRlLCBmYWxzZSwgbnVsbCwgYXQsIGRlY29kaW5nQ29udGV4dCk7CiAgICB2YXIgcGF0dGVybnMgPSBbXTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBtYXhQYXR0ZXJuSW5kZXg7IGkrKykgewogICAgICB2YXIgcGF0dGVybkJpdG1hcCA9IFtdOwogICAgICB2YXIgeE1pbiA9IHBhdHRlcm5XaWR0aCAqIGk7CiAgICAgIHZhciB4TWF4ID0geE1pbiArIHBhdHRlcm5XaWR0aDsKCiAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgcGF0dGVybkhlaWdodDsgeSsrKSB7CiAgICAgICAgcGF0dGVybkJpdG1hcC5wdXNoKGNvbGxlY3RpdmVCaXRtYXBbeV0uc3ViYXJyYXkoeE1pbiwgeE1heCkpOwogICAgICB9CgogICAgICBwYXR0ZXJucy5wdXNoKHBhdHRlcm5CaXRtYXApOwogICAgfQoKICAgIHJldHVybiBwYXR0ZXJuczsKICB9CgogIGZ1bmN0aW9uIGRlY29kZUhhbGZ0b25lUmVnaW9uKG1tciwgcGF0dGVybnMsIHRlbXBsYXRlLCByZWdpb25XaWR0aCwgcmVnaW9uSGVpZ2h0LCBkZWZhdWx0UGl4ZWxWYWx1ZSwgZW5hYmxlU2tpcCwgY29tYmluYXRpb25PcGVyYXRvciwgZ3JpZFdpZHRoLCBncmlkSGVpZ2h0LCBncmlkT2Zmc2V0WCwgZ3JpZE9mZnNldFksIGdyaWRWZWN0b3JYLCBncmlkVmVjdG9yWSwgZGVjb2RpbmdDb250ZXh0KSB7CiAgICB2YXIgc2tpcCA9IG51bGw7CgogICAgaWYgKGVuYWJsZVNraXApIHsKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoInNraXAgaXMgbm90IHN1cHBvcnRlZCIpOwogICAgfQoKICAgIGlmIChjb21iaW5hdGlvbk9wZXJhdG9yICE9PSAwKSB7CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJvcGVyYXRvciAiICsgY29tYmluYXRpb25PcGVyYXRvciArICIgaXMgbm90IHN1cHBvcnRlZCBpbiBoYWxmdG9uZSByZWdpb24iKTsKICAgIH0KCiAgICB2YXIgcmVnaW9uQml0bWFwID0gW107CiAgICB2YXIgaSwgaiwgcm93OwoKICAgIGZvciAoaSA9IDA7IGkgPCByZWdpb25IZWlnaHQ7IGkrKykgewogICAgICByb3cgPSBuZXcgVWludDhBcnJheShyZWdpb25XaWR0aCk7CgogICAgICBpZiAoZGVmYXVsdFBpeGVsVmFsdWUpIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgcmVnaW9uV2lkdGg7IGorKykgewogICAgICAgICAgcm93W2pdID0gZGVmYXVsdFBpeGVsVmFsdWU7CiAgICAgICAgfQogICAgICB9CgogICAgICByZWdpb25CaXRtYXAucHVzaChyb3cpOwogICAgfQoKICAgIHZhciBudW1iZXJPZlBhdHRlcm5zID0gcGF0dGVybnMubGVuZ3RoOwogICAgdmFyIHBhdHRlcm4wID0gcGF0dGVybnNbMF07CiAgICB2YXIgcGF0dGVybldpZHRoID0gcGF0dGVybjBbMF0ubGVuZ3RoLAogICAgICAgIHBhdHRlcm5IZWlnaHQgPSBwYXR0ZXJuMC5sZW5ndGg7CiAgICB2YXIgYml0c1BlclZhbHVlID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKG51bWJlck9mUGF0dGVybnMpOwogICAgdmFyIGF0ID0gW107CgogICAgaWYgKCFtbXIpIHsKICAgICAgYXQucHVzaCh7CiAgICAgICAgeDogdGVtcGxhdGUgPD0gMSA/IDMgOiAyLAogICAgICAgIHk6IC0xCiAgICAgIH0pOwoKICAgICAgaWYgKHRlbXBsYXRlID09PSAwKSB7CiAgICAgICAgYXQucHVzaCh7CiAgICAgICAgICB4OiAtMywKICAgICAgICAgIHk6IC0xCiAgICAgICAgfSk7CiAgICAgICAgYXQucHVzaCh7CiAgICAgICAgICB4OiAyLAogICAgICAgICAgeTogLTIKICAgICAgICB9KTsKICAgICAgICBhdC5wdXNoKHsKICAgICAgICAgIHg6IC0yLAogICAgICAgICAgeTogLTIKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIHZhciBncmF5U2NhbGVCaXRQbGFuZXMgPSBbXTsKICAgIHZhciBtbXJJbnB1dCwgYml0bWFwOwoKICAgIGlmIChtbXIpIHsKICAgICAgbW1ySW5wdXQgPSBuZXcgUmVhZGVyKGRlY29kaW5nQ29udGV4dC5kYXRhLCBkZWNvZGluZ0NvbnRleHQuc3RhcnQsIGRlY29kaW5nQ29udGV4dC5lbmQpOwogICAgfQoKICAgIGZvciAoaSA9IGJpdHNQZXJWYWx1ZSAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgIGlmIChtbXIpIHsKICAgICAgICBiaXRtYXAgPSBkZWNvZGVNTVJCaXRtYXAobW1ySW5wdXQsIGdyaWRXaWR0aCwgZ3JpZEhlaWdodCwgdHJ1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYml0bWFwID0gZGVjb2RlQml0bWFwKGZhbHNlLCBncmlkV2lkdGgsIGdyaWRIZWlnaHQsIHRlbXBsYXRlLCBmYWxzZSwgc2tpcCwgYXQsIGRlY29kaW5nQ29udGV4dCk7CiAgICAgIH0KCiAgICAgIGdyYXlTY2FsZUJpdFBsYW5lc1tpXSA9IGJpdG1hcDsKICAgIH0KCiAgICB2YXIgbWcsIG5nLCBiaXQsIHBhdHRlcm5JbmRleCwgcGF0dGVybkJpdG1hcCwgeCwgeSwgcGF0dGVyblJvdywgcmVnaW9uUm93OwoKICAgIGZvciAobWcgPSAwOyBtZyA8IGdyaWRIZWlnaHQ7IG1nKyspIHsKICAgICAgZm9yIChuZyA9IDA7IG5nIDwgZ3JpZFdpZHRoOyBuZysrKSB7CiAgICAgICAgYml0ID0gMDsKICAgICAgICBwYXR0ZXJuSW5kZXggPSAwOwoKICAgICAgICBmb3IgKGogPSBiaXRzUGVyVmFsdWUgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgYml0ID0gZ3JheVNjYWxlQml0UGxhbmVzW2pdW21nXVtuZ10gXiBiaXQ7CiAgICAgICAgICBwYXR0ZXJuSW5kZXggfD0gYml0IDw8IGo7CiAgICAgICAgfQoKICAgICAgICBwYXR0ZXJuQml0bWFwID0gcGF0dGVybnNbcGF0dGVybkluZGV4XTsKICAgICAgICB4ID0gZ3JpZE9mZnNldFggKyBtZyAqIGdyaWRWZWN0b3JZICsgbmcgKiBncmlkVmVjdG9yWCA+PiA4OwogICAgICAgIHkgPSBncmlkT2Zmc2V0WSArIG1nICogZ3JpZFZlY3RvclggLSBuZyAqIGdyaWRWZWN0b3JZID4+IDg7CgogICAgICAgIGlmICh4ID49IDAgJiYgeCArIHBhdHRlcm5XaWR0aCA8PSByZWdpb25XaWR0aCAmJiB5ID49IDAgJiYgeSArIHBhdHRlcm5IZWlnaHQgPD0gcmVnaW9uSGVpZ2h0KSB7CiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGF0dGVybkhlaWdodDsgaSsrKSB7CiAgICAgICAgICAgIHJlZ2lvblJvdyA9IHJlZ2lvbkJpdG1hcFt5ICsgaV07CiAgICAgICAgICAgIHBhdHRlcm5Sb3cgPSBwYXR0ZXJuQml0bWFwW2ldOwoKICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHBhdHRlcm5XaWR0aDsgaisrKSB7CiAgICAgICAgICAgICAgcmVnaW9uUm93W3ggKyBqXSB8PSBwYXR0ZXJuUm93W2pdOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciByZWdpb25YID0gdm9pZCAwLAogICAgICAgICAgICAgIHJlZ2lvblkgPSB2b2lkIDA7CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBhdHRlcm5IZWlnaHQ7IGkrKykgewogICAgICAgICAgICByZWdpb25ZID0geSArIGk7CgogICAgICAgICAgICBpZiAocmVnaW9uWSA8IDAgfHwgcmVnaW9uWSA+PSByZWdpb25IZWlnaHQpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVnaW9uUm93ID0gcmVnaW9uQml0bWFwW3JlZ2lvblldOwogICAgICAgICAgICBwYXR0ZXJuUm93ID0gcGF0dGVybkJpdG1hcFtpXTsKCiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBwYXR0ZXJuV2lkdGg7IGorKykgewogICAgICAgICAgICAgIHJlZ2lvblggPSB4ICsgajsKCiAgICAgICAgICAgICAgaWYgKHJlZ2lvblggPj0gMCAmJiByZWdpb25YIDwgcmVnaW9uV2lkdGgpIHsKICAgICAgICAgICAgICAgIHJlZ2lvblJvd1tyZWdpb25YXSB8PSBwYXR0ZXJuUm93W2pdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiByZWdpb25CaXRtYXA7CiAgfQoKICBmdW5jdGlvbiByZWFkU2VnbWVudEhlYWRlcihkYXRhLCBzdGFydCkgewogICAgdmFyIHNlZ21lbnRIZWFkZXIgPSB7fTsKICAgIHNlZ21lbnRIZWFkZXIubnVtYmVyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHN0YXJ0KTsKICAgIHZhciBmbGFncyA9IGRhdGFbc3RhcnQgKyA0XTsKICAgIHZhciBzZWdtZW50VHlwZSA9IGZsYWdzICYgMHgzZjsKCiAgICBpZiAoIVNlZ21lbnRUeXBlc1tzZWdtZW50VHlwZV0pIHsKICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgc2VnbWVudCB0eXBlOiAiICsgc2VnbWVudFR5cGUpOwogICAgfQoKICAgIHNlZ21lbnRIZWFkZXIudHlwZSA9IHNlZ21lbnRUeXBlOwogICAgc2VnbWVudEhlYWRlci50eXBlTmFtZSA9IFNlZ21lbnRUeXBlc1tzZWdtZW50VHlwZV07CiAgICBzZWdtZW50SGVhZGVyLmRlZmVycmVkTm9uUmV0YWluID0gISEoZmxhZ3MgJiAweDgwKTsKICAgIHZhciBwYWdlQXNzb2NpYXRpb25GaWVsZFNpemUgPSAhIShmbGFncyAmIDB4NDApOwogICAgdmFyIHJlZmVycmVkRmxhZ3MgPSBkYXRhW3N0YXJ0ICsgNV07CiAgICB2YXIgcmVmZXJyZWRUb0NvdW50ID0gcmVmZXJyZWRGbGFncyA+PiA1ICYgNzsKICAgIHZhciByZXRhaW5CaXRzID0gW3JlZmVycmVkRmxhZ3MgJiAzMV07CiAgICB2YXIgcG9zaXRpb24gPSBzdGFydCArIDY7CgogICAgaWYgKHJlZmVycmVkRmxhZ3MgPT09IDcpIHsKICAgICAgcmVmZXJyZWRUb0NvdW50ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uIC0gMSkgJiAweDFmZmZmZmZmOwogICAgICBwb3NpdGlvbiArPSAzOwogICAgICB2YXIgYnl0ZXMgPSByZWZlcnJlZFRvQ291bnQgKyA3ID4+IDM7CiAgICAgIHJldGFpbkJpdHNbMF0gPSBkYXRhW3Bvc2l0aW9uKytdOwoKICAgICAgd2hpbGUgKC0tYnl0ZXMgPiAwKSB7CiAgICAgICAgcmV0YWluQml0cy5wdXNoKGRhdGFbcG9zaXRpb24rK10pOwogICAgICB9CiAgICB9IGVsc2UgaWYgKHJlZmVycmVkRmxhZ3MgPT09IDUgfHwgcmVmZXJyZWRGbGFncyA9PT0gNikgewogICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCByZWZlcnJlZC10byBmbGFncyIpOwogICAgfQoKICAgIHNlZ21lbnRIZWFkZXIucmV0YWluQml0cyA9IHJldGFpbkJpdHM7CiAgICB2YXIgcmVmZXJyZWRUb1NlZ21lbnROdW1iZXJTaXplID0gNDsKCiAgICBpZiAoc2VnbWVudEhlYWRlci5udW1iZXIgPD0gMjU2KSB7CiAgICAgIHJlZmVycmVkVG9TZWdtZW50TnVtYmVyU2l6ZSA9IDE7CiAgICB9IGVsc2UgaWYgKHNlZ21lbnRIZWFkZXIubnVtYmVyIDw9IDY1NTM2KSB7CiAgICAgIHJlZmVycmVkVG9TZWdtZW50TnVtYmVyU2l6ZSA9IDI7CiAgICB9CgogICAgdmFyIHJlZmVycmVkVG8gPSBbXTsKICAgIHZhciBpLCBpaTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgcmVmZXJyZWRUb0NvdW50OyBpKyspIHsKICAgICAgdmFyIG51bWJlciA9IHZvaWQgMDsKCiAgICAgIGlmIChyZWZlcnJlZFRvU2VnbWVudE51bWJlclNpemUgPT09IDEpIHsKICAgICAgICBudW1iZXIgPSBkYXRhW3Bvc2l0aW9uXTsKICAgICAgfSBlbHNlIGlmIChyZWZlcnJlZFRvU2VnbWVudE51bWJlclNpemUgPT09IDIpIHsKICAgICAgICBudW1iZXIgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICB9IGVsc2UgewogICAgICAgIG51bWJlciA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgICAgIH0KCiAgICAgIHJlZmVycmVkVG8ucHVzaChudW1iZXIpOwogICAgICBwb3NpdGlvbiArPSByZWZlcnJlZFRvU2VnbWVudE51bWJlclNpemU7CiAgICB9CgogICAgc2VnbWVudEhlYWRlci5yZWZlcnJlZFRvID0gcmVmZXJyZWRUbzsKCiAgICBpZiAoIXBhZ2VBc3NvY2lhdGlvbkZpZWxkU2l6ZSkgewogICAgICBzZWdtZW50SGVhZGVyLnBhZ2VBc3NvY2lhdGlvbiA9IGRhdGFbcG9zaXRpb24rK107CiAgICB9IGVsc2UgewogICAgICBzZWdtZW50SGVhZGVyLnBhZ2VBc3NvY2lhdGlvbiA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICB9CgogICAgc2VnbWVudEhlYWRlci5sZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24pOwogICAgcG9zaXRpb24gKz0gNDsKCiAgICBpZiAoc2VnbWVudEhlYWRlci5sZW5ndGggPT09IDB4ZmZmZmZmZmYpIHsKICAgICAgaWYgKHNlZ21lbnRUeXBlID09PSAzOCkgewogICAgICAgIHZhciBnZW5lcmljUmVnaW9uSW5mbyA9IHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgcG9zaXRpb24pOwogICAgICAgIHZhciBnZW5lcmljUmVnaW9uU2VnbWVudEZsYWdzID0gZGF0YVtwb3NpdGlvbiArIFJlZ2lvblNlZ21lbnRJbmZvcm1hdGlvbkZpZWxkTGVuZ3RoXTsKICAgICAgICB2YXIgZ2VuZXJpY1JlZ2lvbk1tciA9ICEhKGdlbmVyaWNSZWdpb25TZWdtZW50RmxhZ3MgJiAxKTsKICAgICAgICB2YXIgc2VhcmNoUGF0dGVybkxlbmd0aCA9IDY7CiAgICAgICAgdmFyIHNlYXJjaFBhdHRlcm4gPSBuZXcgVWludDhBcnJheShzZWFyY2hQYXR0ZXJuTGVuZ3RoKTsKCiAgICAgICAgaWYgKCFnZW5lcmljUmVnaW9uTW1yKSB7CiAgICAgICAgICBzZWFyY2hQYXR0ZXJuWzBdID0gMHhmZjsKICAgICAgICAgIHNlYXJjaFBhdHRlcm5bMV0gPSAweGFjOwogICAgICAgIH0KCiAgICAgICAgc2VhcmNoUGF0dGVyblsyXSA9IGdlbmVyaWNSZWdpb25JbmZvLmhlaWdodCA+Pj4gMjQgJiAweGZmOwogICAgICAgIHNlYXJjaFBhdHRlcm5bM10gPSBnZW5lcmljUmVnaW9uSW5mby5oZWlnaHQgPj4gMTYgJiAweGZmOwogICAgICAgIHNlYXJjaFBhdHRlcm5bNF0gPSBnZW5lcmljUmVnaW9uSW5mby5oZWlnaHQgPj4gOCAmIDB4ZmY7CiAgICAgICAgc2VhcmNoUGF0dGVybls1XSA9IGdlbmVyaWNSZWdpb25JbmZvLmhlaWdodCAmIDB4ZmY7CgogICAgICAgIGZvciAoaSA9IHBvc2l0aW9uLCBpaSA9IGRhdGEubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgdmFyIGogPSAwOwoKICAgICAgICAgIHdoaWxlIChqIDwgc2VhcmNoUGF0dGVybkxlbmd0aCAmJiBzZWFyY2hQYXR0ZXJuW2pdID09PSBkYXRhW2kgKyBqXSkgewogICAgICAgICAgICBqKys7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGogPT09IHNlYXJjaFBhdHRlcm5MZW5ndGgpIHsKICAgICAgICAgICAgc2VnbWVudEhlYWRlci5sZW5ndGggPSBpICsgc2VhcmNoUGF0dGVybkxlbmd0aDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoc2VnbWVudEhlYWRlci5sZW5ndGggPT09IDB4ZmZmZmZmZmYpIHsKICAgICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJzZWdtZW50IGVuZCB3YXMgbm90IGZvdW5kIik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJpbnZhbGlkIHVua25vd24gc2VnbWVudCBsZW5ndGgiKTsKICAgICAgfQogICAgfQoKICAgIHNlZ21lbnRIZWFkZXIuaGVhZGVyRW5kID0gcG9zaXRpb247CiAgICByZXR1cm4gc2VnbWVudEhlYWRlcjsKICB9CgogIGZ1bmN0aW9uIHJlYWRTZWdtZW50cyhoZWFkZXIsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIHZhciBzZWdtZW50cyA9IFtdOwogICAgdmFyIHBvc2l0aW9uID0gc3RhcnQ7CgogICAgd2hpbGUgKHBvc2l0aW9uIDwgZW5kKSB7CiAgICAgIHZhciBzZWdtZW50SGVhZGVyID0gcmVhZFNlZ21lbnRIZWFkZXIoZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiA9IHNlZ21lbnRIZWFkZXIuaGVhZGVyRW5kOwogICAgICB2YXIgc2VnbWVudCA9IHsKICAgICAgICBoZWFkZXI6IHNlZ21lbnRIZWFkZXIsCiAgICAgICAgZGF0YTogZGF0YQogICAgICB9OwoKICAgICAgaWYgKCFoZWFkZXIucmFuZG9tQWNjZXNzKSB7CiAgICAgICAgc2VnbWVudC5zdGFydCA9IHBvc2l0aW9uOwogICAgICAgIHBvc2l0aW9uICs9IHNlZ21lbnRIZWFkZXIubGVuZ3RoOwogICAgICAgIHNlZ21lbnQuZW5kID0gcG9zaXRpb247CiAgICAgIH0KCiAgICAgIHNlZ21lbnRzLnB1c2goc2VnbWVudCk7CgogICAgICBpZiAoc2VnbWVudEhlYWRlci50eXBlID09PSA1MSkgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgaWYgKGhlYWRlci5yYW5kb21BY2Nlc3MpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gc2VnbWVudHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIHNlZ21lbnRzW2ldLnN0YXJ0ID0gcG9zaXRpb247CiAgICAgICAgcG9zaXRpb24gKz0gc2VnbWVudHNbaV0uaGVhZGVyLmxlbmd0aDsKICAgICAgICBzZWdtZW50c1tpXS5lbmQgPSBwb3NpdGlvbjsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBzZWdtZW50czsKICB9CgogIGZ1bmN0aW9uIHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgc3RhcnQpIHsKICAgIHJldHVybiB7CiAgICAgIHdpZHRoOiAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgc3RhcnQpLAogICAgICBoZWlnaHQ6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBzdGFydCArIDQpLAogICAgICB4OiAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgc3RhcnQgKyA4KSwKICAgICAgeTogKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHN0YXJ0ICsgMTIpLAogICAgICBjb21iaW5hdGlvbk9wZXJhdG9yOiBkYXRhW3N0YXJ0ICsgMTZdICYgNwogICAgfTsKICB9CgogIHZhciBSZWdpb25TZWdtZW50SW5mb3JtYXRpb25GaWVsZExlbmd0aCA9IDE3OwoKICBmdW5jdGlvbiBwcm9jZXNzU2VnbWVudChzZWdtZW50LCB2aXNpdG9yKSB7CiAgICB2YXIgaGVhZGVyID0gc2VnbWVudC5oZWFkZXI7CiAgICB2YXIgZGF0YSA9IHNlZ21lbnQuZGF0YSwKICAgICAgICBwb3NpdGlvbiA9IHNlZ21lbnQuc3RhcnQsCiAgICAgICAgZW5kID0gc2VnbWVudC5lbmQ7CiAgICB2YXIgYXJncywgYXQsIGksIGF0TGVuZ3RoOwoKICAgIHN3aXRjaCAoaGVhZGVyLnR5cGUpIHsKICAgICAgY2FzZSAwOgogICAgICAgIHZhciBkaWN0aW9uYXJ5ID0ge307CiAgICAgICAgdmFyIGRpY3Rpb25hcnlGbGFncyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgZGljdGlvbmFyeS5odWZmbWFuID0gISEoZGljdGlvbmFyeUZsYWdzICYgMSk7CiAgICAgICAgZGljdGlvbmFyeS5yZWZpbmVtZW50ID0gISEoZGljdGlvbmFyeUZsYWdzICYgMik7CiAgICAgICAgZGljdGlvbmFyeS5odWZmbWFuREhTZWxlY3RvciA9IGRpY3Rpb25hcnlGbGFncyA+PiAyICYgMzsKICAgICAgICBkaWN0aW9uYXJ5Lmh1ZmZtYW5EV1NlbGVjdG9yID0gZGljdGlvbmFyeUZsYWdzID4+IDQgJiAzOwogICAgICAgIGRpY3Rpb25hcnkuYml0bWFwU2l6ZVNlbGVjdG9yID0gZGljdGlvbmFyeUZsYWdzID4+IDYgJiAxOwogICAgICAgIGRpY3Rpb25hcnkuYWdncmVnYXRpb25JbnN0YW5jZXNTZWxlY3RvciA9IGRpY3Rpb25hcnlGbGFncyA+PiA3ICYgMTsKICAgICAgICBkaWN0aW9uYXJ5LmJpdG1hcENvZGluZ0NvbnRleHRVc2VkID0gISEoZGljdGlvbmFyeUZsYWdzICYgMjU2KTsKICAgICAgICBkaWN0aW9uYXJ5LmJpdG1hcENvZGluZ0NvbnRleHRSZXRhaW5lZCA9ICEhKGRpY3Rpb25hcnlGbGFncyAmIDUxMik7CiAgICAgICAgZGljdGlvbmFyeS50ZW1wbGF0ZSA9IGRpY3Rpb25hcnlGbGFncyA+PiAxMCAmIDM7CiAgICAgICAgZGljdGlvbmFyeS5yZWZpbmVtZW50VGVtcGxhdGUgPSBkaWN0aW9uYXJ5RmxhZ3MgPj4gMTIgJiAxOwogICAgICAgIHBvc2l0aW9uICs9IDI7CgogICAgICAgIGlmICghZGljdGlvbmFyeS5odWZmbWFuKSB7CiAgICAgICAgICBhdExlbmd0aCA9IGRpY3Rpb25hcnkudGVtcGxhdGUgPT09IDAgPyA0IDogMTsKICAgICAgICAgIGF0ID0gW107CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGF0TGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYXQucHVzaCh7CiAgICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgICAgeTogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiArIDEpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgICAgfQoKICAgICAgICAgIGRpY3Rpb25hcnkuYXQgPSBhdDsKICAgICAgICB9CgogICAgICAgIGlmIChkaWN0aW9uYXJ5LnJlZmluZW1lbnQgJiYgIWRpY3Rpb25hcnkucmVmaW5lbWVudFRlbXBsYXRlKSB7CiAgICAgICAgICBhdCA9IFtdOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAyOyBpKyspIHsKICAgICAgICAgICAgYXQucHVzaCh7CiAgICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgICAgeTogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiArIDEpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgICAgfQoKICAgICAgICAgIGRpY3Rpb25hcnkucmVmaW5lbWVudEF0ID0gYXQ7CiAgICAgICAgfQoKICAgICAgICBkaWN0aW9uYXJ5Lm51bWJlck9mRXhwb3J0ZWRTeW1ib2xzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICBwb3NpdGlvbiArPSA0OwogICAgICAgIGRpY3Rpb25hcnkubnVtYmVyT2ZOZXdTeW1ib2xzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICBwb3NpdGlvbiArPSA0OwogICAgICAgIGFyZ3MgPSBbZGljdGlvbmFyeSwgaGVhZGVyLm51bWJlciwgaGVhZGVyLnJlZmVycmVkVG8sIGRhdGEsIHBvc2l0aW9uLCBlbmRdOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA2OgogICAgICBjYXNlIDc6CiAgICAgICAgdmFyIHRleHRSZWdpb24gPSB7fTsKICAgICAgICB0ZXh0UmVnaW9uLmluZm8gPSByZWFkUmVnaW9uU2VnbWVudEluZm9ybWF0aW9uKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICBwb3NpdGlvbiArPSBSZWdpb25TZWdtZW50SW5mb3JtYXRpb25GaWVsZExlbmd0aDsKICAgICAgICB2YXIgdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gMjsKICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW4gPSAhISh0ZXh0UmVnaW9uU2VnbWVudEZsYWdzICYgMSk7CiAgICAgICAgdGV4dFJlZ2lvbi5yZWZpbmVtZW50ID0gISEodGV4dFJlZ2lvblNlZ21lbnRGbGFncyAmIDIpOwogICAgICAgIHRleHRSZWdpb24ubG9nU3RyaXBTaXplID0gdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA+PiAyICYgMzsKICAgICAgICB0ZXh0UmVnaW9uLnN0cmlwU2l6ZSA9IDEgPDwgdGV4dFJlZ2lvbi5sb2dTdHJpcFNpemU7CiAgICAgICAgdGV4dFJlZ2lvbi5yZWZlcmVuY2VDb3JuZXIgPSB0ZXh0UmVnaW9uU2VnbWVudEZsYWdzID4+IDQgJiAzOwogICAgICAgIHRleHRSZWdpb24udHJhbnNwb3NlZCA9ICEhKHRleHRSZWdpb25TZWdtZW50RmxhZ3MgJiA2NCk7CiAgICAgICAgdGV4dFJlZ2lvbi5jb21iaW5hdGlvbk9wZXJhdG9yID0gdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA+PiA3ICYgMzsKICAgICAgICB0ZXh0UmVnaW9uLmRlZmF1bHRQaXhlbFZhbHVlID0gdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA+PiA5ICYgMTsKICAgICAgICB0ZXh0UmVnaW9uLmRzT2Zmc2V0ID0gdGV4dFJlZ2lvblNlZ21lbnRGbGFncyA8PCAxNyA+PiAyNzsKICAgICAgICB0ZXh0UmVnaW9uLnJlZmluZW1lbnRUZW1wbGF0ZSA9IHRleHRSZWdpb25TZWdtZW50RmxhZ3MgPj4gMTUgJiAxOwoKICAgICAgICBpZiAodGV4dFJlZ2lvbi5odWZmbWFuKSB7CiAgICAgICAgICB2YXIgdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgICAgdGV4dFJlZ2lvbi5odWZmbWFuRlMgPSB0ZXh0UmVnaW9uSHVmZm1hbkZsYWdzICYgMzsKICAgICAgICAgIHRleHRSZWdpb24uaHVmZm1hbkRTID0gdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA+PiAyICYgMzsKICAgICAgICAgIHRleHRSZWdpb24uaHVmZm1hbkRUID0gdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA+PiA0ICYgMzsKICAgICAgICAgIHRleHRSZWdpb24uaHVmZm1hblJlZmluZW1lbnREVyA9IHRleHRSZWdpb25IdWZmbWFuRmxhZ3MgPj4gNiAmIDM7CiAgICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW5SZWZpbmVtZW50REggPSB0ZXh0UmVnaW9uSHVmZm1hbkZsYWdzID4+IDggJiAzOwogICAgICAgICAgdGV4dFJlZ2lvbi5odWZmbWFuUmVmaW5lbWVudERYID0gdGV4dFJlZ2lvbkh1ZmZtYW5GbGFncyA+PiAxMCAmIDM7CiAgICAgICAgICB0ZXh0UmVnaW9uLmh1ZmZtYW5SZWZpbmVtZW50RFkgPSB0ZXh0UmVnaW9uSHVmZm1hbkZsYWdzID4+IDEyICYgMzsKICAgICAgICAgIHRleHRSZWdpb24uaHVmZm1hblJlZmluZW1lbnRTaXplU2VsZWN0b3IgPSAhISh0ZXh0UmVnaW9uSHVmZm1hbkZsYWdzICYgMHg0MDAwKTsKICAgICAgICB9CgogICAgICAgIGlmICh0ZXh0UmVnaW9uLnJlZmluZW1lbnQgJiYgIXRleHRSZWdpb24ucmVmaW5lbWVudFRlbXBsYXRlKSB7CiAgICAgICAgICBhdCA9IFtdOwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAyOyBpKyspIHsKICAgICAgICAgICAgYXQucHVzaCh7CiAgICAgICAgICAgICAgeDogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICAgICAgeTogKDAsIF9jb3JlX3V0aWxzLnJlYWRJbnQ4KShkYXRhLCBwb3NpdGlvbiArIDEpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBwb3NpdGlvbiArPSAyOwogICAgICAgICAgfQoKICAgICAgICAgIHRleHRSZWdpb24ucmVmaW5lbWVudEF0ID0gYXQ7CiAgICAgICAgfQoKICAgICAgICB0ZXh0UmVnaW9uLm51bWJlck9mU3ltYm9sSW5zdGFuY2VzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICBwb3NpdGlvbiArPSA0OwogICAgICAgIGFyZ3MgPSBbdGV4dFJlZ2lvbiwgaGVhZGVyLnJlZmVycmVkVG8sIGRhdGEsIHBvc2l0aW9uLCBlbmRdOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxNjoKICAgICAgICB2YXIgcGF0dGVybkRpY3Rpb25hcnkgPSB7fTsKICAgICAgICB2YXIgcGF0dGVybkRpY3Rpb25hcnlGbGFncyA9IGRhdGFbcG9zaXRpb24rK107CiAgICAgICAgcGF0dGVybkRpY3Rpb25hcnkubW1yID0gISEocGF0dGVybkRpY3Rpb25hcnlGbGFncyAmIDEpOwogICAgICAgIHBhdHRlcm5EaWN0aW9uYXJ5LnRlbXBsYXRlID0gcGF0dGVybkRpY3Rpb25hcnlGbGFncyA+PiAxICYgMzsKICAgICAgICBwYXR0ZXJuRGljdGlvbmFyeS5wYXR0ZXJuV2lkdGggPSBkYXRhW3Bvc2l0aW9uKytdOwogICAgICAgIHBhdHRlcm5EaWN0aW9uYXJ5LnBhdHRlcm5IZWlnaHQgPSBkYXRhW3Bvc2l0aW9uKytdOwogICAgICAgIHBhdHRlcm5EaWN0aW9uYXJ5Lm1heFBhdHRlcm5JbmRleCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gNDsKICAgICAgICBhcmdzID0gW3BhdHRlcm5EaWN0aW9uYXJ5LCBoZWFkZXIubnVtYmVyLCBkYXRhLCBwb3NpdGlvbiwgZW5kXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjI6CiAgICAgIGNhc2UgMjM6CiAgICAgICAgdmFyIGhhbGZ0b25lUmVnaW9uID0ge307CiAgICAgICAgaGFsZnRvbmVSZWdpb24uaW5mbyA9IHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgcG9zaXRpb24pOwogICAgICAgIHBvc2l0aW9uICs9IFJlZ2lvblNlZ21lbnRJbmZvcm1hdGlvbkZpZWxkTGVuZ3RoOwogICAgICAgIHZhciBoYWxmdG9uZVJlZ2lvbkZsYWdzID0gZGF0YVtwb3NpdGlvbisrXTsKICAgICAgICBoYWxmdG9uZVJlZ2lvbi5tbXIgPSAhIShoYWxmdG9uZVJlZ2lvbkZsYWdzICYgMSk7CiAgICAgICAgaGFsZnRvbmVSZWdpb24udGVtcGxhdGUgPSBoYWxmdG9uZVJlZ2lvbkZsYWdzID4+IDEgJiAzOwogICAgICAgIGhhbGZ0b25lUmVnaW9uLmVuYWJsZVNraXAgPSAhIShoYWxmdG9uZVJlZ2lvbkZsYWdzICYgOCk7CiAgICAgICAgaGFsZnRvbmVSZWdpb24uY29tYmluYXRpb25PcGVyYXRvciA9IGhhbGZ0b25lUmVnaW9uRmxhZ3MgPj4gNCAmIDc7CiAgICAgICAgaGFsZnRvbmVSZWdpb24uZGVmYXVsdFBpeGVsVmFsdWUgPSBoYWxmdG9uZVJlZ2lvbkZsYWdzID4+IDcgJiAxOwogICAgICAgIGhhbGZ0b25lUmVnaW9uLmdyaWRXaWR0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gNDsKICAgICAgICBoYWxmdG9uZVJlZ2lvbi5ncmlkSGVpZ2h0ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICBwb3NpdGlvbiArPSA0OwogICAgICAgIGhhbGZ0b25lUmVnaW9uLmdyaWRPZmZzZXRYID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSAmIDB4ZmZmZmZmZmY7CiAgICAgICAgcG9zaXRpb24gKz0gNDsKICAgICAgICBoYWxmdG9uZVJlZ2lvbi5ncmlkT2Zmc2V0WSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbikgJiAweGZmZmZmZmZmOwogICAgICAgIHBvc2l0aW9uICs9IDQ7CiAgICAgICAgaGFsZnRvbmVSZWdpb24uZ3JpZFZlY3RvclggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgIHBvc2l0aW9uICs9IDI7CiAgICAgICAgaGFsZnRvbmVSZWdpb24uZ3JpZFZlY3RvclkgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgIHBvc2l0aW9uICs9IDI7CiAgICAgICAgYXJncyA9IFtoYWxmdG9uZVJlZ2lvbiwgaGVhZGVyLnJlZmVycmVkVG8sIGRhdGEsIHBvc2l0aW9uLCBlbmRdOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzODoKICAgICAgY2FzZSAzOToKICAgICAgICB2YXIgZ2VuZXJpY1JlZ2lvbiA9IHt9OwogICAgICAgIGdlbmVyaWNSZWdpb24uaW5mbyA9IHJlYWRSZWdpb25TZWdtZW50SW5mb3JtYXRpb24oZGF0YSwgcG9zaXRpb24pOwogICAgICAgIHBvc2l0aW9uICs9IFJlZ2lvblNlZ21lbnRJbmZvcm1hdGlvbkZpZWxkTGVuZ3RoOwogICAgICAgIHZhciBnZW5lcmljUmVnaW9uU2VnbWVudEZsYWdzID0gZGF0YVtwb3NpdGlvbisrXTsKICAgICAgICBnZW5lcmljUmVnaW9uLm1tciA9ICEhKGdlbmVyaWNSZWdpb25TZWdtZW50RmxhZ3MgJiAxKTsKICAgICAgICBnZW5lcmljUmVnaW9uLnRlbXBsYXRlID0gZ2VuZXJpY1JlZ2lvblNlZ21lbnRGbGFncyA+PiAxICYgMzsKICAgICAgICBnZW5lcmljUmVnaW9uLnByZWRpY3Rpb24gPSAhIShnZW5lcmljUmVnaW9uU2VnbWVudEZsYWdzICYgOCk7CgogICAgICAgIGlmICghZ2VuZXJpY1JlZ2lvbi5tbXIpIHsKICAgICAgICAgIGF0TGVuZ3RoID0gZ2VuZXJpY1JlZ2lvbi50ZW1wbGF0ZSA9PT0gMCA/IDQgOiAxOwogICAgICAgICAgYXQgPSBbXTsKCiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXRMZW5ndGg7IGkrKykgewogICAgICAgICAgICBhdC5wdXNoKHsKICAgICAgICAgICAgICB4OiAoMCwgX2NvcmVfdXRpbHMucmVhZEludDgpKGRhdGEsIHBvc2l0aW9uKSwKICAgICAgICAgICAgICB5OiAoMCwgX2NvcmVfdXRpbHMucmVhZEludDgpKGRhdGEsIHBvc2l0aW9uICsgMSkKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHBvc2l0aW9uICs9IDI7CiAgICAgICAgICB9CgogICAgICAgICAgZ2VuZXJpY1JlZ2lvbi5hdCA9IGF0OwogICAgICAgIH0KCiAgICAgICAgYXJncyA9IFtnZW5lcmljUmVnaW9uLCBkYXRhLCBwb3NpdGlvbiwgZW5kXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNDg6CiAgICAgICAgdmFyIHBhZ2VJbmZvID0gewogICAgICAgICAgd2lkdGg6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiksCiAgICAgICAgICBoZWlnaHQ6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpLAogICAgICAgICAgcmVzb2x1dGlvblg6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDgpLAogICAgICAgICAgcmVzb2x1dGlvblk6ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDEyKQogICAgICAgIH07CgogICAgICAgIGlmIChwYWdlSW5mby5oZWlnaHQgPT09IDB4ZmZmZmZmZmYpIHsKICAgICAgICAgIGRlbGV0ZSBwYWdlSW5mby5oZWlnaHQ7CiAgICAgICAgfQoKICAgICAgICB2YXIgcGFnZVNlZ21lbnRGbGFncyA9IGRhdGFbcG9zaXRpb24gKyAxNl07CiAgICAgICAgKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uICsgMTcpOwogICAgICAgIHBhZ2VJbmZvLmxvc3NsZXNzID0gISEocGFnZVNlZ21lbnRGbGFncyAmIDEpOwogICAgICAgIHBhZ2VJbmZvLnJlZmluZW1lbnQgPSAhIShwYWdlU2VnbWVudEZsYWdzICYgMik7CiAgICAgICAgcGFnZUluZm8uZGVmYXVsdFBpeGVsVmFsdWUgPSBwYWdlU2VnbWVudEZsYWdzID4+IDIgJiAxOwogICAgICAgIHBhZ2VJbmZvLmNvbWJpbmF0aW9uT3BlcmF0b3IgPSBwYWdlU2VnbWVudEZsYWdzID4+IDMgJiAzOwogICAgICAgIHBhZ2VJbmZvLnJlcXVpcmVzQnVmZmVyID0gISEocGFnZVNlZ21lbnRGbGFncyAmIDMyKTsKICAgICAgICBwYWdlSW5mby5jb21iaW5hdGlvbk9wZXJhdG9yT3ZlcnJpZGUgPSAhIShwYWdlU2VnbWVudEZsYWdzICYgNjQpOwogICAgICAgIGFyZ3MgPSBbcGFnZUluZm9dOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA0OToKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNTA6CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDUxOgogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA1MzoKICAgICAgICBhcmdzID0gW2hlYWRlci5udW1iZXIsIGRhdGEsIHBvc2l0aW9uLCBlbmRdOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA2MjoKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoInNlZ21lbnQgdHlwZSAiLmNvbmNhdChoZWFkZXIudHlwZU5hbWUsICIoIikuY29uY2F0KGhlYWRlci50eXBlLCAiKSIpICsgIiBpcyBub3QgaW1wbGVtZW50ZWQiKTsKICAgIH0KCiAgICB2YXIgY2FsbGJhY2tOYW1lID0gIm9uIiArIGhlYWRlci50eXBlTmFtZTsKCiAgICBpZiAoY2FsbGJhY2tOYW1lIGluIHZpc2l0b3IpIHsKICAgICAgdmlzaXRvcltjYWxsYmFja05hbWVdLmFwcGx5KHZpc2l0b3IsIGFyZ3MpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcHJvY2Vzc1NlZ21lbnRzKHNlZ21lbnRzLCB2aXNpdG9yKSB7CiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzZWdtZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHByb2Nlc3NTZWdtZW50KHNlZ21lbnRzW2ldLCB2aXNpdG9yKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHBhcnNlSmJpZzJDaHVua3MoY2h1bmtzKSB7CiAgICB2YXIgdmlzaXRvciA9IG5ldyBTaW1wbGVTZWdtZW50VmlzaXRvcigpOwoKICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGNodW5rcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHZhciBjaHVuayA9IGNodW5rc1tpXTsKICAgICAgdmFyIHNlZ21lbnRzID0gcmVhZFNlZ21lbnRzKHt9LCBjaHVuay5kYXRhLCBjaHVuay5zdGFydCwgY2h1bmsuZW5kKTsKICAgICAgcHJvY2Vzc1NlZ21lbnRzKHNlZ21lbnRzLCB2aXNpdG9yKTsKICAgIH0KCiAgICByZXR1cm4gdmlzaXRvci5idWZmZXI7CiAgfQoKICBmdW5jdGlvbiBwYXJzZUpiaWcyKGRhdGEpIHsKICAgIHZhciBlbmQgPSBkYXRhLmxlbmd0aDsKICAgIHZhciBwb3NpdGlvbiA9IDA7CgogICAgaWYgKGRhdGFbcG9zaXRpb25dICE9PSAweDk3IHx8IGRhdGFbcG9zaXRpb24gKyAxXSAhPT0gMHg0YSB8fCBkYXRhW3Bvc2l0aW9uICsgMl0gIT09IDB4NDIgfHwgZGF0YVtwb3NpdGlvbiArIDNdICE9PSAweDMyIHx8IGRhdGFbcG9zaXRpb24gKyA0XSAhPT0gMHgwZCB8fCBkYXRhW3Bvc2l0aW9uICsgNV0gIT09IDB4MGEgfHwgZGF0YVtwb3NpdGlvbiArIDZdICE9PSAweDFhIHx8IGRhdGFbcG9zaXRpb24gKyA3XSAhPT0gMHgwYSkgewogICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigicGFyc2VKYmlnMiAtIGludmFsaWQgaGVhZGVyLiIpOwogICAgfQoKICAgIHZhciBoZWFkZXIgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgcG9zaXRpb24gKz0gODsKICAgIHZhciBmbGFncyA9IGRhdGFbcG9zaXRpb24rK107CiAgICBoZWFkZXIucmFuZG9tQWNjZXNzID0gIShmbGFncyAmIDEpOwoKICAgIGlmICghKGZsYWdzICYgMikpIHsKICAgICAgaGVhZGVyLm51bWJlck9mUGFnZXMgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24pOwogICAgICBwb3NpdGlvbiArPSA0OwogICAgfQoKICAgIHZhciBzZWdtZW50cyA9IHJlYWRTZWdtZW50cyhoZWFkZXIsIGRhdGEsIHBvc2l0aW9uLCBlbmQpOwogICAgdmFyIHZpc2l0b3IgPSBuZXcgU2ltcGxlU2VnbWVudFZpc2l0b3IoKTsKICAgIHByb2Nlc3NTZWdtZW50cyhzZWdtZW50cywgdmlzaXRvcik7CiAgICB2YXIgX3Zpc2l0b3IkY3VycmVudFBhZ2VJID0gdmlzaXRvci5jdXJyZW50UGFnZUluZm8sCiAgICAgICAgd2lkdGggPSBfdmlzaXRvciRjdXJyZW50UGFnZUkud2lkdGgsCiAgICAgICAgaGVpZ2h0ID0gX3Zpc2l0b3IkY3VycmVudFBhZ2VJLmhlaWdodDsKICAgIHZhciBiaXRQYWNrZWQgPSB2aXNpdG9yLmJ1ZmZlcjsKICAgIHZhciBpbWdEYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHdpZHRoICogaGVpZ2h0KTsKICAgIHZhciBxID0gMCwKICAgICAgICBrID0gMDsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7CiAgICAgIHZhciBtYXNrID0gMCwKICAgICAgICAgIGJ1ZmZlciA9IHZvaWQgMDsKCiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgIGlmICghbWFzaykgewogICAgICAgICAgbWFzayA9IDEyODsKICAgICAgICAgIGJ1ZmZlciA9IGJpdFBhY2tlZFtrKytdOwogICAgICAgIH0KCiAgICAgICAgaW1nRGF0YVtxKytdID0gYnVmZmVyICYgbWFzayA/IDAgOiAyNTU7CiAgICAgICAgbWFzayA+Pj0gMTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGltZ0RhdGE6IGltZ0RhdGEsCiAgICAgIHdpZHRoOiB3aWR0aCwKICAgICAgaGVpZ2h0OiBoZWlnaHQKICAgIH07CiAgfQoKICBmdW5jdGlvbiBTaW1wbGVTZWdtZW50VmlzaXRvcigpIHt9CgogIFNpbXBsZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZSA9IHsKICAgIG9uUGFnZUluZm9ybWF0aW9uOiBmdW5jdGlvbiBTaW1wbGVTZWdtZW50VmlzaXRvcl9vblBhZ2VJbmZvcm1hdGlvbihpbmZvKSB7CiAgICAgIHRoaXMuY3VycmVudFBhZ2VJbmZvID0gaW5mbzsKICAgICAgdmFyIHJvd1NpemUgPSBpbmZvLndpZHRoICsgNyA+PiAzOwogICAgICB2YXIgYnVmZmVyID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHJvd1NpemUgKiBpbmZvLmhlaWdodCk7CgogICAgICBpZiAoaW5mby5kZWZhdWx0UGl4ZWxWYWx1ZSkgewogICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGJ1ZmZlci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICBidWZmZXJbaV0gPSAweGZmOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5idWZmZXIgPSBidWZmZXI7CiAgICB9LAogICAgZHJhd0JpdG1hcDogZnVuY3Rpb24gU2ltcGxlU2VnbWVudFZpc2l0b3JfZHJhd0JpdG1hcChyZWdpb25JbmZvLCBiaXRtYXApIHsKICAgICAgdmFyIHBhZ2VJbmZvID0gdGhpcy5jdXJyZW50UGFnZUluZm87CiAgICAgIHZhciB3aWR0aCA9IHJlZ2lvbkluZm8ud2lkdGgsCiAgICAgICAgICBoZWlnaHQgPSByZWdpb25JbmZvLmhlaWdodDsKICAgICAgdmFyIHJvd1NpemUgPSBwYWdlSW5mby53aWR0aCArIDcgPj4gMzsKICAgICAgdmFyIGNvbWJpbmF0aW9uT3BlcmF0b3IgPSBwYWdlSW5mby5jb21iaW5hdGlvbk9wZXJhdG9yT3ZlcnJpZGUgPyByZWdpb25JbmZvLmNvbWJpbmF0aW9uT3BlcmF0b3IgOiBwYWdlSW5mby5jb21iaW5hdGlvbk9wZXJhdG9yOwogICAgICB2YXIgYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICAgIHZhciBtYXNrMCA9IDEyOCA+PiAocmVnaW9uSW5mby54ICYgNyk7CiAgICAgIHZhciBvZmZzZXQwID0gcmVnaW9uSW5mby55ICogcm93U2l6ZSArIChyZWdpb25JbmZvLnggPj4gMyk7CiAgICAgIHZhciBpLCBqLCBtYXNrLCBvZmZzZXQ7CgogICAgICBzd2l0Y2ggKGNvbWJpbmF0aW9uT3BlcmF0b3IpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaGVpZ2h0OyBpKyspIHsKICAgICAgICAgICAgbWFzayA9IG1hc2swOwogICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQwOwoKICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICAgICAgICBpZiAoYml0bWFwW2ldW2pdKSB7CiAgICAgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSB8PSBtYXNrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbWFzayA+Pj0gMTsKCiAgICAgICAgICAgICAgaWYgKCFtYXNrKSB7CiAgICAgICAgICAgICAgICBtYXNrID0gMTI4OwogICAgICAgICAgICAgICAgb2Zmc2V0Kys7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBvZmZzZXQwICs9IHJvd1NpemU7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewogICAgICAgICAgICBtYXNrID0gbWFzazA7CiAgICAgICAgICAgIG9mZnNldCA9IG9mZnNldDA7CgogICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgICAgICAgIGlmIChiaXRtYXBbaV1bal0pIHsKICAgICAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXRdIF49IG1hc2s7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBtYXNrID4+PSAxOwoKICAgICAgICAgICAgICBpZiAoIW1hc2spIHsKICAgICAgICAgICAgICAgIG1hc2sgPSAxMjg7CiAgICAgICAgICAgICAgICBvZmZzZXQrKzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG9mZnNldDAgKz0gcm93U2l6ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJvcGVyYXRvciAiLmNvbmNhdChjb21iaW5hdGlvbk9wZXJhdG9yLCAiIGlzIG5vdCBzdXBwb3J0ZWQiKSk7CiAgICAgIH0KICAgIH0sCiAgICBvbkltbWVkaWF0ZUdlbmVyaWNSZWdpb246IGZ1bmN0aW9uIFNpbXBsZVNlZ21lbnRWaXNpdG9yX29uSW1tZWRpYXRlR2VuZXJpY1JlZ2lvbihyZWdpb24sIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgICAgdmFyIHJlZ2lvbkluZm8gPSByZWdpb24uaW5mbzsKICAgICAgdmFyIGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICAgIHZhciBiaXRtYXAgPSBkZWNvZGVCaXRtYXAocmVnaW9uLm1tciwgcmVnaW9uSW5mby53aWR0aCwgcmVnaW9uSW5mby5oZWlnaHQsIHJlZ2lvbi50ZW1wbGF0ZSwgcmVnaW9uLnByZWRpY3Rpb24sIG51bGwsIHJlZ2lvbi5hdCwgZGVjb2RpbmdDb250ZXh0KTsKICAgICAgdGhpcy5kcmF3Qml0bWFwKHJlZ2lvbkluZm8sIGJpdG1hcCk7CiAgICB9LAogICAgb25JbW1lZGlhdGVMb3NzbGVzc0dlbmVyaWNSZWdpb246IGZ1bmN0aW9uIFNpbXBsZVNlZ21lbnRWaXNpdG9yX29uSW1tZWRpYXRlTG9zc2xlc3NHZW5lcmljUmVnaW9uKCkgewogICAgICB0aGlzLm9uSW1tZWRpYXRlR2VuZXJpY1JlZ2lvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfSwKICAgIG9uU3ltYm9sRGljdGlvbmFyeTogZnVuY3Rpb24gU2ltcGxlU2VnbWVudFZpc2l0b3Jfb25TeW1ib2xEaWN0aW9uYXJ5KGRpY3Rpb25hcnksIGN1cnJlbnRTZWdtZW50LCByZWZlcnJlZFNlZ21lbnRzLCBkYXRhLCBzdGFydCwgZW5kKSB7CiAgICAgIHZhciBodWZmbWFuVGFibGVzLCBodWZmbWFuSW5wdXQ7CgogICAgICBpZiAoZGljdGlvbmFyeS5odWZmbWFuKSB7CiAgICAgICAgaHVmZm1hblRhYmxlcyA9IGdldFN5bWJvbERpY3Rpb25hcnlIdWZmbWFuVGFibGVzKGRpY3Rpb25hcnksIHJlZmVycmVkU2VnbWVudHMsIHRoaXMuY3VzdG9tVGFibGVzKTsKICAgICAgICBodWZmbWFuSW5wdXQgPSBuZXcgUmVhZGVyKGRhdGEsIHN0YXJ0LCBlbmQpOwogICAgICB9CgogICAgICB2YXIgc3ltYm9scyA9IHRoaXMuc3ltYm9sczsKCiAgICAgIGlmICghc3ltYm9scykgewogICAgICAgIHRoaXMuc3ltYm9scyA9IHN5bWJvbHMgPSB7fTsKICAgICAgfQoKICAgICAgdmFyIGlucHV0U3ltYm9scyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcmVmZXJyZWRTZWdtZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgdmFyIHJlZmVycmVkU3ltYm9scyA9IHN5bWJvbHNbcmVmZXJyZWRTZWdtZW50c1tpXV07CgogICAgICAgIGlmIChyZWZlcnJlZFN5bWJvbHMpIHsKICAgICAgICAgIGlucHV0U3ltYm9scyA9IGlucHV0U3ltYm9scy5jb25jYXQocmVmZXJyZWRTeW1ib2xzKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBkZWNvZGluZ0NvbnRleHQgPSBuZXcgRGVjb2RpbmdDb250ZXh0KGRhdGEsIHN0YXJ0LCBlbmQpOwogICAgICBzeW1ib2xzW2N1cnJlbnRTZWdtZW50XSA9IGRlY29kZVN5bWJvbERpY3Rpb25hcnkoZGljdGlvbmFyeS5odWZmbWFuLCBkaWN0aW9uYXJ5LnJlZmluZW1lbnQsIGlucHV0U3ltYm9scywgZGljdGlvbmFyeS5udW1iZXJPZk5ld1N5bWJvbHMsIGRpY3Rpb25hcnkubnVtYmVyT2ZFeHBvcnRlZFN5bWJvbHMsIGh1ZmZtYW5UYWJsZXMsIGRpY3Rpb25hcnkudGVtcGxhdGUsIGRpY3Rpb25hcnkuYXQsIGRpY3Rpb25hcnkucmVmaW5lbWVudFRlbXBsYXRlLCBkaWN0aW9uYXJ5LnJlZmluZW1lbnRBdCwgZGVjb2RpbmdDb250ZXh0LCBodWZmbWFuSW5wdXQpOwogICAgfSwKICAgIG9uSW1tZWRpYXRlVGV4dFJlZ2lvbjogZnVuY3Rpb24gU2ltcGxlU2VnbWVudFZpc2l0b3Jfb25JbW1lZGlhdGVUZXh0UmVnaW9uKHJlZ2lvbiwgcmVmZXJyZWRTZWdtZW50cywgZGF0YSwgc3RhcnQsIGVuZCkgewogICAgICB2YXIgcmVnaW9uSW5mbyA9IHJlZ2lvbi5pbmZvOwogICAgICB2YXIgaHVmZm1hblRhYmxlcywgaHVmZm1hbklucHV0OwogICAgICB2YXIgc3ltYm9scyA9IHRoaXMuc3ltYm9sczsKICAgICAgdmFyIGlucHV0U3ltYm9scyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcmVmZXJyZWRTZWdtZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgdmFyIHJlZmVycmVkU3ltYm9scyA9IHN5bWJvbHNbcmVmZXJyZWRTZWdtZW50c1tpXV07CgogICAgICAgIGlmIChyZWZlcnJlZFN5bWJvbHMpIHsKICAgICAgICAgIGlucHV0U3ltYm9scyA9IGlucHV0U3ltYm9scy5jb25jYXQocmVmZXJyZWRTeW1ib2xzKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBzeW1ib2xDb2RlTGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKGlucHV0U3ltYm9scy5sZW5ndGgpOwoKICAgICAgaWYgKHJlZ2lvbi5odWZmbWFuKSB7CiAgICAgICAgaHVmZm1hbklucHV0ID0gbmV3IFJlYWRlcihkYXRhLCBzdGFydCwgZW5kKTsKICAgICAgICBodWZmbWFuVGFibGVzID0gZ2V0VGV4dFJlZ2lvbkh1ZmZtYW5UYWJsZXMocmVnaW9uLCByZWZlcnJlZFNlZ21lbnRzLCB0aGlzLmN1c3RvbVRhYmxlcywgaW5wdXRTeW1ib2xzLmxlbmd0aCwgaHVmZm1hbklucHV0KTsKICAgICAgfQoKICAgICAgdmFyIGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICAgIHZhciBiaXRtYXAgPSBkZWNvZGVUZXh0UmVnaW9uKHJlZ2lvbi5odWZmbWFuLCByZWdpb24ucmVmaW5lbWVudCwgcmVnaW9uSW5mby53aWR0aCwgcmVnaW9uSW5mby5oZWlnaHQsIHJlZ2lvbi5kZWZhdWx0UGl4ZWxWYWx1ZSwgcmVnaW9uLm51bWJlck9mU3ltYm9sSW5zdGFuY2VzLCByZWdpb24uc3RyaXBTaXplLCBpbnB1dFN5bWJvbHMsIHN5bWJvbENvZGVMZW5ndGgsIHJlZ2lvbi50cmFuc3Bvc2VkLCByZWdpb24uZHNPZmZzZXQsIHJlZ2lvbi5yZWZlcmVuY2VDb3JuZXIsIHJlZ2lvbi5jb21iaW5hdGlvbk9wZXJhdG9yLCBodWZmbWFuVGFibGVzLCByZWdpb24ucmVmaW5lbWVudFRlbXBsYXRlLCByZWdpb24ucmVmaW5lbWVudEF0LCBkZWNvZGluZ0NvbnRleHQsIHJlZ2lvbi5sb2dTdHJpcFNpemUsIGh1ZmZtYW5JbnB1dCk7CiAgICAgIHRoaXMuZHJhd0JpdG1hcChyZWdpb25JbmZvLCBiaXRtYXApOwogICAgfSwKICAgIG9uSW1tZWRpYXRlTG9zc2xlc3NUZXh0UmVnaW9uOiBmdW5jdGlvbiBTaW1wbGVTZWdtZW50VmlzaXRvcl9vbkltbWVkaWF0ZUxvc3NsZXNzVGV4dFJlZ2lvbigpIHsKICAgICAgdGhpcy5vbkltbWVkaWF0ZVRleHRSZWdpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0sCiAgICBvblBhdHRlcm5EaWN0aW9uYXJ5OiBmdW5jdGlvbiBvblBhdHRlcm5EaWN0aW9uYXJ5KGRpY3Rpb25hcnksIGN1cnJlbnRTZWdtZW50LCBkYXRhLCBzdGFydCwgZW5kKSB7CiAgICAgIHZhciBwYXR0ZXJucyA9IHRoaXMucGF0dGVybnM7CgogICAgICBpZiAoIXBhdHRlcm5zKSB7CiAgICAgICAgdGhpcy5wYXR0ZXJucyA9IHBhdHRlcm5zID0ge307CiAgICAgIH0KCiAgICAgIHZhciBkZWNvZGluZ0NvbnRleHQgPSBuZXcgRGVjb2RpbmdDb250ZXh0KGRhdGEsIHN0YXJ0LCBlbmQpOwogICAgICBwYXR0ZXJuc1tjdXJyZW50U2VnbWVudF0gPSBkZWNvZGVQYXR0ZXJuRGljdGlvbmFyeShkaWN0aW9uYXJ5Lm1tciwgZGljdGlvbmFyeS5wYXR0ZXJuV2lkdGgsIGRpY3Rpb25hcnkucGF0dGVybkhlaWdodCwgZGljdGlvbmFyeS5tYXhQYXR0ZXJuSW5kZXgsIGRpY3Rpb25hcnkudGVtcGxhdGUsIGRlY29kaW5nQ29udGV4dCk7CiAgICB9LAogICAgb25JbW1lZGlhdGVIYWxmdG9uZVJlZ2lvbjogZnVuY3Rpb24gb25JbW1lZGlhdGVIYWxmdG9uZVJlZ2lvbihyZWdpb24sIHJlZmVycmVkU2VnbWVudHMsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgICAgdmFyIHBhdHRlcm5zID0gdGhpcy5wYXR0ZXJuc1tyZWZlcnJlZFNlZ21lbnRzWzBdXTsKICAgICAgdmFyIHJlZ2lvbkluZm8gPSByZWdpb24uaW5mbzsKICAgICAgdmFyIGRlY29kaW5nQ29udGV4dCA9IG5ldyBEZWNvZGluZ0NvbnRleHQoZGF0YSwgc3RhcnQsIGVuZCk7CiAgICAgIHZhciBiaXRtYXAgPSBkZWNvZGVIYWxmdG9uZVJlZ2lvbihyZWdpb24ubW1yLCBwYXR0ZXJucywgcmVnaW9uLnRlbXBsYXRlLCByZWdpb25JbmZvLndpZHRoLCByZWdpb25JbmZvLmhlaWdodCwgcmVnaW9uLmRlZmF1bHRQaXhlbFZhbHVlLCByZWdpb24uZW5hYmxlU2tpcCwgcmVnaW9uLmNvbWJpbmF0aW9uT3BlcmF0b3IsIHJlZ2lvbi5ncmlkV2lkdGgsIHJlZ2lvbi5ncmlkSGVpZ2h0LCByZWdpb24uZ3JpZE9mZnNldFgsIHJlZ2lvbi5ncmlkT2Zmc2V0WSwgcmVnaW9uLmdyaWRWZWN0b3JYLCByZWdpb24uZ3JpZFZlY3RvclksIGRlY29kaW5nQ29udGV4dCk7CiAgICAgIHRoaXMuZHJhd0JpdG1hcChyZWdpb25JbmZvLCBiaXRtYXApOwogICAgfSwKICAgIG9uSW1tZWRpYXRlTG9zc2xlc3NIYWxmdG9uZVJlZ2lvbjogZnVuY3Rpb24gb25JbW1lZGlhdGVMb3NzbGVzc0hhbGZ0b25lUmVnaW9uKCkgewogICAgICB0aGlzLm9uSW1tZWRpYXRlSGFsZnRvbmVSZWdpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0sCiAgICBvblRhYmxlczogZnVuY3Rpb24gb25UYWJsZXMoY3VycmVudFNlZ21lbnQsIGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgICAgdmFyIGN1c3RvbVRhYmxlcyA9IHRoaXMuY3VzdG9tVGFibGVzOwoKICAgICAgaWYgKCFjdXN0b21UYWJsZXMpIHsKICAgICAgICB0aGlzLmN1c3RvbVRhYmxlcyA9IGN1c3RvbVRhYmxlcyA9IHt9OwogICAgICB9CgogICAgICBjdXN0b21UYWJsZXNbY3VycmVudFNlZ21lbnRdID0gZGVjb2RlVGFibGVzU2VnbWVudChkYXRhLCBzdGFydCwgZW5kKTsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBIdWZmbWFuTGluZShsaW5lRGF0YSkgewogICAgaWYgKGxpbmVEYXRhLmxlbmd0aCA9PT0gMikgewogICAgICB0aGlzLmlzT09CID0gdHJ1ZTsKICAgICAgdGhpcy5yYW5nZUxvdyA9IDA7CiAgICAgIHRoaXMucHJlZml4TGVuZ3RoID0gbGluZURhdGFbMF07CiAgICAgIHRoaXMucmFuZ2VMZW5ndGggPSAwOwogICAgICB0aGlzLnByZWZpeENvZGUgPSBsaW5lRGF0YVsxXTsKICAgICAgdGhpcy5pc0xvd2VyUmFuZ2UgPSBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuaXNPT0IgPSBmYWxzZTsKICAgICAgdGhpcy5yYW5nZUxvdyA9IGxpbmVEYXRhWzBdOwogICAgICB0aGlzLnByZWZpeExlbmd0aCA9IGxpbmVEYXRhWzFdOwogICAgICB0aGlzLnJhbmdlTGVuZ3RoID0gbGluZURhdGFbMl07CiAgICAgIHRoaXMucHJlZml4Q29kZSA9IGxpbmVEYXRhWzNdOwogICAgICB0aGlzLmlzTG93ZXJSYW5nZSA9IGxpbmVEYXRhWzRdID09PSAibG93ZXIiOwogICAgfQogIH0KCiAgZnVuY3Rpb24gSHVmZm1hblRyZWVOb2RlKGxpbmUpIHsKICAgIHRoaXMuY2hpbGRyZW4gPSBbXTsKCiAgICBpZiAobGluZSkgewogICAgICB0aGlzLmlzTGVhZiA9IHRydWU7CiAgICAgIHRoaXMucmFuZ2VMZW5ndGggPSBsaW5lLnJhbmdlTGVuZ3RoOwogICAgICB0aGlzLnJhbmdlTG93ID0gbGluZS5yYW5nZUxvdzsKICAgICAgdGhpcy5pc0xvd2VyUmFuZ2UgPSBsaW5lLmlzTG93ZXJSYW5nZTsKICAgICAgdGhpcy5pc09PQiA9IGxpbmUuaXNPT0I7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmlzTGVhZiA9IGZhbHNlOwogICAgfQogIH0KCiAgSHVmZm1hblRyZWVOb2RlLnByb3RvdHlwZSA9IHsKICAgIGJ1aWxkVHJlZTogZnVuY3Rpb24gYnVpbGRUcmVlKGxpbmUsIHNoaWZ0KSB7CiAgICAgIHZhciBiaXQgPSBsaW5lLnByZWZpeENvZGUgPj4gc2hpZnQgJiAxOwoKICAgICAgaWYgKHNoaWZ0IDw9IDApIHsKICAgICAgICB0aGlzLmNoaWxkcmVuW2JpdF0gPSBuZXcgSHVmZm1hblRyZWVOb2RlKGxpbmUpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBub2RlID0gdGhpcy5jaGlsZHJlbltiaXRdOwoKICAgICAgICBpZiAoIW5vZGUpIHsKICAgICAgICAgIHRoaXMuY2hpbGRyZW5bYml0XSA9IG5vZGUgPSBuZXcgSHVmZm1hblRyZWVOb2RlKG51bGwpOwogICAgICAgIH0KCiAgICAgICAgbm9kZS5idWlsZFRyZWUobGluZSwgc2hpZnQgLSAxKTsKICAgICAgfQogICAgfSwKICAgIGRlY29kZU5vZGU6IGZ1bmN0aW9uIGRlY29kZU5vZGUocmVhZGVyKSB7CiAgICAgIGlmICh0aGlzLmlzTGVhZikgewogICAgICAgIGlmICh0aGlzLmlzT09CKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIHZhciBodE9mZnNldCA9IHJlYWRlci5yZWFkQml0cyh0aGlzLnJhbmdlTGVuZ3RoKTsKICAgICAgICByZXR1cm4gdGhpcy5yYW5nZUxvdyArICh0aGlzLmlzTG93ZXJSYW5nZSA/IC1odE9mZnNldCA6IGh0T2Zmc2V0KTsKICAgICAgfQoKICAgICAgdmFyIG5vZGUgPSB0aGlzLmNoaWxkcmVuW3JlYWRlci5yZWFkQml0KCldOwoKICAgICAgaWYgKCFub2RlKSB7CiAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBkYXRhIik7CiAgICAgIH0KCiAgICAgIHJldHVybiBub2RlLmRlY29kZU5vZGUocmVhZGVyKTsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBIdWZmbWFuVGFibGUobGluZXMsIHByZWZpeENvZGVzRG9uZSkgewogICAgaWYgKCFwcmVmaXhDb2Rlc0RvbmUpIHsKICAgICAgdGhpcy5hc3NpZ25QcmVmaXhDb2RlcyhsaW5lcyk7CiAgICB9CgogICAgdGhpcy5yb290Tm9kZSA9IG5ldyBIdWZmbWFuVHJlZU5vZGUobnVsbCk7CgogICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbGluZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICB2YXIgbGluZSA9IGxpbmVzW2ldOwoKICAgICAgaWYgKGxpbmUucHJlZml4TGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMucm9vdE5vZGUuYnVpbGRUcmVlKGxpbmUsIGxpbmUucHJlZml4TGVuZ3RoIC0gMSk7CiAgICAgIH0KICAgIH0KICB9CgogIEh1ZmZtYW5UYWJsZS5wcm90b3R5cGUgPSB7CiAgICBkZWNvZGU6IGZ1bmN0aW9uIGRlY29kZShyZWFkZXIpIHsKICAgICAgcmV0dXJuIHRoaXMucm9vdE5vZGUuZGVjb2RlTm9kZShyZWFkZXIpOwogICAgfSwKICAgIGFzc2lnblByZWZpeENvZGVzOiBmdW5jdGlvbiBhc3NpZ25QcmVmaXhDb2RlcyhsaW5lcykgewogICAgICB2YXIgbGluZXNMZW5ndGggPSBsaW5lcy5sZW5ndGg7CiAgICAgIHZhciBwcmVmaXhMZW5ndGhNYXggPSAwOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lc0xlbmd0aDsgaSsrKSB7CiAgICAgICAgcHJlZml4TGVuZ3RoTWF4ID0gTWF0aC5tYXgocHJlZml4TGVuZ3RoTWF4LCBsaW5lc1tpXS5wcmVmaXhMZW5ndGgpOwogICAgICB9CgogICAgICB2YXIgaGlzdG9ncmFtID0gbmV3IFVpbnQzMkFycmF5KHByZWZpeExlbmd0aE1heCArIDEpOwoKICAgICAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgbGluZXNMZW5ndGg7IF9pMisrKSB7CiAgICAgICAgaGlzdG9ncmFtW2xpbmVzW19pMl0ucHJlZml4TGVuZ3RoXSsrOwogICAgICB9CgogICAgICB2YXIgY3VycmVudExlbmd0aCA9IDEsCiAgICAgICAgICBmaXJzdENvZGUgPSAwLAogICAgICAgICAgY3VycmVudENvZGUsCiAgICAgICAgICBjdXJyZW50VGVtcCwKICAgICAgICAgIGxpbmU7CiAgICAgIGhpc3RvZ3JhbVswXSA9IDA7CgogICAgICB3aGlsZSAoY3VycmVudExlbmd0aCA8PSBwcmVmaXhMZW5ndGhNYXgpIHsKICAgICAgICBmaXJzdENvZGUgPSBmaXJzdENvZGUgKyBoaXN0b2dyYW1bY3VycmVudExlbmd0aCAtIDFdIDw8IDE7CiAgICAgICAgY3VycmVudENvZGUgPSBmaXJzdENvZGU7CiAgICAgICAgY3VycmVudFRlbXAgPSAwOwoKICAgICAgICB3aGlsZSAoY3VycmVudFRlbXAgPCBsaW5lc0xlbmd0aCkgewogICAgICAgICAgbGluZSA9IGxpbmVzW2N1cnJlbnRUZW1wXTsKCiAgICAgICAgICBpZiAobGluZS5wcmVmaXhMZW5ndGggPT09IGN1cnJlbnRMZW5ndGgpIHsKICAgICAgICAgICAgbGluZS5wcmVmaXhDb2RlID0gY3VycmVudENvZGU7CiAgICAgICAgICAgIGN1cnJlbnRDb2RlKys7CiAgICAgICAgICB9CgogICAgICAgICAgY3VycmVudFRlbXArKzsKICAgICAgICB9CgogICAgICAgIGN1cnJlbnRMZW5ndGgrKzsKICAgICAgfQogICAgfQogIH07CgogIGZ1bmN0aW9uIGRlY29kZVRhYmxlc1NlZ21lbnQoZGF0YSwgc3RhcnQsIGVuZCkgewogICAgdmFyIGZsYWdzID0gZGF0YVtzdGFydF07CiAgICB2YXIgbG93ZXN0VmFsdWUgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgc3RhcnQgKyAxKSAmIDB4ZmZmZmZmZmY7CiAgICB2YXIgaGlnaGVzdFZhbHVlID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHN0YXJ0ICsgNSkgJiAweGZmZmZmZmZmOwogICAgdmFyIHJlYWRlciA9IG5ldyBSZWFkZXIoZGF0YSwgc3RhcnQgKyA5LCBlbmQpOwogICAgdmFyIHByZWZpeFNpemVCaXRzID0gKGZsYWdzID4+IDEgJiA3KSArIDE7CiAgICB2YXIgcmFuZ2VTaXplQml0cyA9IChmbGFncyA+PiA0ICYgNykgKyAxOwogICAgdmFyIGxpbmVzID0gW107CiAgICB2YXIgcHJlZml4TGVuZ3RoLAogICAgICAgIHJhbmdlTGVuZ3RoLAogICAgICAgIGN1cnJlbnRSYW5nZUxvdyA9IGxvd2VzdFZhbHVlOwoKICAgIGRvIHsKICAgICAgcHJlZml4TGVuZ3RoID0gcmVhZGVyLnJlYWRCaXRzKHByZWZpeFNpemVCaXRzKTsKICAgICAgcmFuZ2VMZW5ndGggPSByZWFkZXIucmVhZEJpdHMocmFuZ2VTaXplQml0cyk7CiAgICAgIGxpbmVzLnB1c2gobmV3IEh1ZmZtYW5MaW5lKFtjdXJyZW50UmFuZ2VMb3csIHByZWZpeExlbmd0aCwgcmFuZ2VMZW5ndGgsIDBdKSk7CiAgICAgIGN1cnJlbnRSYW5nZUxvdyArPSAxIDw8IHJhbmdlTGVuZ3RoOwogICAgfSB3aGlsZSAoY3VycmVudFJhbmdlTG93IDwgaGlnaGVzdFZhbHVlKTsKCiAgICBwcmVmaXhMZW5ndGggPSByZWFkZXIucmVhZEJpdHMocHJlZml4U2l6ZUJpdHMpOwogICAgbGluZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW2xvd2VzdFZhbHVlIC0gMSwgcHJlZml4TGVuZ3RoLCAzMiwgMCwgImxvd2VyIl0pKTsKICAgIHByZWZpeExlbmd0aCA9IHJlYWRlci5yZWFkQml0cyhwcmVmaXhTaXplQml0cyk7CiAgICBsaW5lcy5wdXNoKG5ldyBIdWZmbWFuTGluZShbaGlnaGVzdFZhbHVlLCBwcmVmaXhMZW5ndGgsIDMyLCAwXSkpOwoKICAgIGlmIChmbGFncyAmIDEpIHsKICAgICAgcHJlZml4TGVuZ3RoID0gcmVhZGVyLnJlYWRCaXRzKHByZWZpeFNpemVCaXRzKTsKICAgICAgbGluZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW3ByZWZpeExlbmd0aCwgMF0pKTsKICAgIH0KCiAgICByZXR1cm4gbmV3IEh1ZmZtYW5UYWJsZShsaW5lcywgZmFsc2UpOwogIH0KCiAgdmFyIHN0YW5kYXJkVGFibGVzQ2FjaGUgPSB7fTsKCiAgZnVuY3Rpb24gZ2V0U3RhbmRhcmRUYWJsZShudW1iZXIpIHsKICAgIHZhciB0YWJsZSA9IHN0YW5kYXJkVGFibGVzQ2FjaGVbbnVtYmVyXTsKCiAgICBpZiAodGFibGUpIHsKICAgICAgcmV0dXJuIHRhYmxlOwogICAgfQoKICAgIHZhciBsaW5lczsKCiAgICBzd2l0Y2ggKG51bWJlcikgewogICAgICBjYXNlIDE6CiAgICAgICAgbGluZXMgPSBbWzAsIDEsIDQsIDB4MF0sIFsxNiwgMiwgOCwgMHgyXSwgWzI3MiwgMywgMTYsIDB4Nl0sIFs2NTgwOCwgMywgMzIsIDB4N11dOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAyOgogICAgICAgIGxpbmVzID0gW1swLCAxLCAwLCAweDBdLCBbMSwgMiwgMCwgMHgyXSwgWzIsIDMsIDAsIDB4Nl0sIFszLCA0LCAzLCAweGVdLCBbMTEsIDUsIDYsIDB4MWVdLCBbNzUsIDYsIDMyLCAweDNlXSwgWzYsIDB4M2ZdXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzoKICAgICAgICBsaW5lcyA9IFtbLTI1NiwgOCwgOCwgMHhmZV0sIFswLCAxLCAwLCAweDBdLCBbMSwgMiwgMCwgMHgyXSwgWzIsIDMsIDAsIDB4Nl0sIFszLCA0LCAzLCAweGVdLCBbMTEsIDUsIDYsIDB4MWVdLCBbLTI1NywgOCwgMzIsIDB4ZmYsICJsb3dlciJdLCBbNzUsIDcsIDMyLCAweDdlXSwgWzYsIDB4M2VdXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNDoKICAgICAgICBsaW5lcyA9IFtbMSwgMSwgMCwgMHgwXSwgWzIsIDIsIDAsIDB4Ml0sIFszLCAzLCAwLCAweDZdLCBbNCwgNCwgMywgMHhlXSwgWzEyLCA1LCA2LCAweDFlXSwgWzc2LCA1LCAzMiwgMHgxZl1dOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA1OgogICAgICAgIGxpbmVzID0gW1stMjU1LCA3LCA4LCAweDdlXSwgWzEsIDEsIDAsIDB4MF0sIFsyLCAyLCAwLCAweDJdLCBbMywgMywgMCwgMHg2XSwgWzQsIDQsIDMsIDB4ZV0sIFsxMiwgNSwgNiwgMHgxZV0sIFstMjU2LCA3LCAzMiwgMHg3ZiwgImxvd2VyIl0sIFs3NiwgNiwgMzIsIDB4M2VdXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNjoKICAgICAgICBsaW5lcyA9IFtbLTIwNDgsIDUsIDEwLCAweDFjXSwgWy0xMDI0LCA0LCA5LCAweDhdLCBbLTUxMiwgNCwgOCwgMHg5XSwgWy0yNTYsIDQsIDcsIDB4YV0sIFstMTI4LCA1LCA2LCAweDFkXSwgWy02NCwgNSwgNSwgMHgxZV0sIFstMzIsIDQsIDUsIDB4Yl0sIFswLCAyLCA3LCAweDBdLCBbMTI4LCAzLCA3LCAweDJdLCBbMjU2LCAzLCA4LCAweDNdLCBbNTEyLCA0LCA5LCAweGNdLCBbMTAyNCwgNCwgMTAsIDB4ZF0sIFstMjA0OSwgNiwgMzIsIDB4M2UsICJsb3dlciJdLCBbMjA0OCwgNiwgMzIsIDB4M2ZdXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgNzoKICAgICAgICBsaW5lcyA9IFtbLTEwMjQsIDQsIDksIDB4OF0sIFstNTEyLCAzLCA4LCAweDBdLCBbLTI1NiwgNCwgNywgMHg5XSwgWy0xMjgsIDUsIDYsIDB4MWFdLCBbLTY0LCA1LCA1LCAweDFiXSwgWy0zMiwgNCwgNSwgMHhhXSwgWzAsIDQsIDUsIDB4Yl0sIFszMiwgNSwgNSwgMHgxY10sIFs2NCwgNSwgNiwgMHgxZF0sIFsxMjgsIDQsIDcsIDB4Y10sIFsyNTYsIDMsIDgsIDB4MV0sIFs1MTIsIDMsIDksIDB4Ml0sIFsxMDI0LCAzLCAxMCwgMHgzXSwgWy0xMDI1LCA1LCAzMiwgMHgxZSwgImxvd2VyIl0sIFsyMDQ4LCA1LCAzMiwgMHgxZl1dOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSA4OgogICAgICAgIGxpbmVzID0gW1stMTUsIDgsIDMsIDB4ZmNdLCBbLTcsIDksIDEsIDB4MWZjXSwgWy01LCA4LCAxLCAweGZkXSwgWy0zLCA5LCAwLCAweDFmZF0sIFstMiwgNywgMCwgMHg3Y10sIFstMSwgNCwgMCwgMHhhXSwgWzAsIDIsIDEsIDB4MF0sIFsyLCA1LCAwLCAweDFhXSwgWzMsIDYsIDAsIDB4M2FdLCBbNCwgMywgNCwgMHg0XSwgWzIwLCA2LCAxLCAweDNiXSwgWzIyLCA0LCA0LCAweGJdLCBbMzgsIDQsIDUsIDB4Y10sIFs3MCwgNSwgNiwgMHgxYl0sIFsxMzQsIDUsIDcsIDB4MWNdLCBbMjYyLCA2LCA3LCAweDNjXSwgWzM5MCwgNywgOCwgMHg3ZF0sIFs2NDYsIDYsIDEwLCAweDNkXSwgWy0xNiwgOSwgMzIsIDB4MWZlLCAibG93ZXIiXSwgWzE2NzAsIDksIDMyLCAweDFmZl0sIFsyLCAweDFdXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgOToKICAgICAgICBsaW5lcyA9IFtbLTMxLCA4LCA0LCAweGZjXSwgWy0xNSwgOSwgMiwgMHgxZmNdLCBbLTExLCA4LCAyLCAweGZkXSwgWy03LCA5LCAxLCAweDFmZF0sIFstNSwgNywgMSwgMHg3Y10sIFstMywgNCwgMSwgMHhhXSwgWy0xLCAzLCAxLCAweDJdLCBbMSwgMywgMSwgMHgzXSwgWzMsIDUsIDEsIDB4MWFdLCBbNSwgNiwgMSwgMHgzYV0sIFs3LCAzLCA1LCAweDRdLCBbMzksIDYsIDIsIDB4M2JdLCBbNDMsIDQsIDUsIDB4Yl0sIFs3NSwgNCwgNiwgMHhjXSwgWzEzOSwgNSwgNywgMHgxYl0sIFsyNjcsIDUsIDgsIDB4MWNdLCBbNTIzLCA2LCA4LCAweDNjXSwgWzc3OSwgNywgOSwgMHg3ZF0sIFsxMjkxLCA2LCAxMSwgMHgzZF0sIFstMzIsIDksIDMyLCAweDFmZSwgImxvd2VyIl0sIFszMzM5LCA5LCAzMiwgMHgxZmZdLCBbMiwgMHgwXV07CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDEwOgogICAgICAgIGxpbmVzID0gW1stMjEsIDcsIDQsIDB4N2FdLCBbLTUsIDgsIDAsIDB4ZmNdLCBbLTQsIDcsIDAsIDB4N2JdLCBbLTMsIDUsIDAsIDB4MThdLCBbLTIsIDIsIDIsIDB4MF0sIFsyLCA1LCAwLCAweDE5XSwgWzMsIDYsIDAsIDB4MzZdLCBbNCwgNywgMCwgMHg3Y10sIFs1LCA4LCAwLCAweGZkXSwgWzYsIDIsIDYsIDB4MV0sIFs3MCwgNSwgNSwgMHgxYV0sIFsxMDIsIDYsIDUsIDB4MzddLCBbMTM0LCA2LCA2LCAweDM4XSwgWzE5OCwgNiwgNywgMHgzOV0sIFszMjYsIDYsIDgsIDB4M2FdLCBbNTgyLCA2LCA5LCAweDNiXSwgWzEwOTQsIDYsIDEwLCAweDNjXSwgWzIxMTgsIDcsIDExLCAweDdkXSwgWy0yMiwgOCwgMzIsIDB4ZmUsICJsb3dlciJdLCBbNDE2NiwgOCwgMzIsIDB4ZmZdLCBbMiwgMHgyXV07CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDExOgogICAgICAgIGxpbmVzID0gW1sxLCAxLCAwLCAweDBdLCBbMiwgMiwgMSwgMHgyXSwgWzQsIDQsIDAsIDB4Y10sIFs1LCA0LCAxLCAweGRdLCBbNywgNSwgMSwgMHgxY10sIFs5LCA1LCAyLCAweDFkXSwgWzEzLCA2LCAyLCAweDNjXSwgWzE3LCA3LCAyLCAweDdhXSwgWzIxLCA3LCAzLCAweDdiXSwgWzI5LCA3LCA0LCAweDdjXSwgWzQ1LCA3LCA1LCAweDdkXSwgWzc3LCA3LCA2LCAweDdlXSwgWzE0MSwgNywgMzIsIDB4N2ZdXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTI6CiAgICAgICAgbGluZXMgPSBbWzEsIDEsIDAsIDB4MF0sIFsyLCAyLCAwLCAweDJdLCBbMywgMywgMSwgMHg2XSwgWzUsIDUsIDAsIDB4MWNdLCBbNiwgNSwgMSwgMHgxZF0sIFs4LCA2LCAxLCAweDNjXSwgWzEwLCA3LCAwLCAweDdhXSwgWzExLCA3LCAxLCAweDdiXSwgWzEzLCA3LCAyLCAweDdjXSwgWzE3LCA3LCAzLCAweDdkXSwgWzI1LCA3LCA0LCAweDdlXSwgWzQxLCA4LCA1LCAweGZlXSwgWzczLCA4LCAzMiwgMHhmZl1dOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxMzoKICAgICAgICBsaW5lcyA9IFtbMSwgMSwgMCwgMHgwXSwgWzIsIDMsIDAsIDB4NF0sIFszLCA0LCAwLCAweGNdLCBbNCwgNSwgMCwgMHgxY10sIFs1LCA0LCAxLCAweGRdLCBbNywgMywgMywgMHg1XSwgWzE1LCA2LCAxLCAweDNhXSwgWzE3LCA2LCAyLCAweDNiXSwgWzIxLCA2LCAzLCAweDNjXSwgWzI5LCA2LCA0LCAweDNkXSwgWzQ1LCA2LCA1LCAweDNlXSwgWzc3LCA3LCA2LCAweDdlXSwgWzE0MSwgNywgMzIsIDB4N2ZdXTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMTQ6CiAgICAgICAgbGluZXMgPSBbWy0yLCAzLCAwLCAweDRdLCBbLTEsIDMsIDAsIDB4NV0sIFswLCAxLCAwLCAweDBdLCBbMSwgMywgMCwgMHg2XSwgWzIsIDMsIDAsIDB4N11dOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAxNToKICAgICAgICBsaW5lcyA9IFtbLTI0LCA3LCA0LCAweDdjXSwgWy04LCA2LCAyLCAweDNjXSwgWy00LCA1LCAxLCAweDFjXSwgWy0yLCA0LCAwLCAweGNdLCBbLTEsIDMsIDAsIDB4NF0sIFswLCAxLCAwLCAweDBdLCBbMSwgMywgMCwgMHg1XSwgWzIsIDQsIDAsIDB4ZF0sIFszLCA1LCAxLCAweDFkXSwgWzUsIDYsIDIsIDB4M2RdLCBbOSwgNywgNCwgMHg3ZF0sIFstMjUsIDcsIDMyLCAweDdlLCAibG93ZXIiXSwgWzI1LCA3LCAzMiwgMHg3Zl1dOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigic3RhbmRhcmQgdGFibGUgQi4iLmNvbmNhdChudW1iZXIsICIgZG9lcyBub3QgZXhpc3QiKSk7CiAgICB9CgogICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbGluZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICBsaW5lc1tpXSA9IG5ldyBIdWZmbWFuTGluZShsaW5lc1tpXSk7CiAgICB9CgogICAgdGFibGUgPSBuZXcgSHVmZm1hblRhYmxlKGxpbmVzLCB0cnVlKTsKICAgIHN0YW5kYXJkVGFibGVzQ2FjaGVbbnVtYmVyXSA9IHRhYmxlOwogICAgcmV0dXJuIHRhYmxlOwogIH0KCiAgZnVuY3Rpb24gUmVhZGVyKGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7CiAgICB0aGlzLmVuZCA9IGVuZDsKICAgIHRoaXMucG9zaXRpb24gPSBzdGFydDsKICAgIHRoaXMuc2hpZnQgPSAtMTsKICAgIHRoaXMuY3VycmVudEJ5dGUgPSAwOwogIH0KCiAgUmVhZGVyLnByb3RvdHlwZSA9IHsKICAgIHJlYWRCaXQ6IGZ1bmN0aW9uIHJlYWRCaXQoKSB7CiAgICAgIGlmICh0aGlzLnNoaWZ0IDwgMCkgewogICAgICAgIGlmICh0aGlzLnBvc2l0aW9uID49IHRoaXMuZW5kKSB7CiAgICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiZW5kIG9mIGRhdGEgd2hpbGUgcmVhZGluZyBiaXQiKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuY3VycmVudEJ5dGUgPSB0aGlzLmRhdGFbdGhpcy5wb3NpdGlvbisrXTsKICAgICAgICB0aGlzLnNoaWZ0ID0gNzsKICAgICAgfQoKICAgICAgdmFyIGJpdCA9IHRoaXMuY3VycmVudEJ5dGUgPj4gdGhpcy5zaGlmdCAmIDE7CiAgICAgIHRoaXMuc2hpZnQtLTsKICAgICAgcmV0dXJuIGJpdDsKICAgIH0sCiAgICByZWFkQml0czogZnVuY3Rpb24gcmVhZEJpdHMobnVtQml0cykgewogICAgICB2YXIgcmVzdWx0ID0gMCwKICAgICAgICAgIGk7CgogICAgICBmb3IgKGkgPSBudW1CaXRzIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICByZXN1bHQgfD0gdGhpcy5yZWFkQml0KCkgPDwgaTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICBieXRlQWxpZ246IGZ1bmN0aW9uIGJ5dGVBbGlnbigpIHsKICAgICAgdGhpcy5zaGlmdCA9IC0xOwogICAgfSwKICAgIG5leHQ6IGZ1bmN0aW9uIG5leHQoKSB7CiAgICAgIGlmICh0aGlzLnBvc2l0aW9uID49IHRoaXMuZW5kKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5kYXRhW3RoaXMucG9zaXRpb24rK107CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpIHsKICAgIHZhciBjdXJyZW50SW5kZXggPSAwOwoKICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHJlZmVycmVkVG8ubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICB2YXIgdGFibGUgPSBjdXN0b21UYWJsZXNbcmVmZXJyZWRUb1tpXV07CgogICAgICBpZiAodGFibGUpIHsKICAgICAgICBpZiAoaW5kZXggPT09IGN1cnJlbnRJbmRleCkgewogICAgICAgICAgcmV0dXJuIHRhYmxlOwogICAgICAgIH0KCiAgICAgICAgY3VycmVudEluZGV4Kys7CiAgICAgIH0KICAgIH0KCiAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiY2FuJ3QgZmluZCBjdXN0b20gSHVmZm1hbiB0YWJsZSIpOwogIH0KCiAgZnVuY3Rpb24gZ2V0VGV4dFJlZ2lvbkh1ZmZtYW5UYWJsZXModGV4dFJlZ2lvbiwgcmVmZXJyZWRUbywgY3VzdG9tVGFibGVzLCBudW1iZXJPZlN5bWJvbHMsIHJlYWRlcikgewogICAgdmFyIGNvZGVzID0gW107CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gMzQ7IGkrKykgewogICAgICB2YXIgY29kZUxlbmd0aCA9IHJlYWRlci5yZWFkQml0cyg0KTsKICAgICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW2ksIGNvZGVMZW5ndGgsIDAsIDBdKSk7CiAgICB9CgogICAgdmFyIHJ1bkNvZGVzVGFibGUgPSBuZXcgSHVmZm1hblRhYmxlKGNvZGVzLCBmYWxzZSk7CiAgICBjb2Rlcy5sZW5ndGggPSAwOwoKICAgIGZvciAodmFyIF9pMyA9IDA7IF9pMyA8IG51bWJlck9mU3ltYm9sczspIHsKICAgICAgdmFyIF9jb2RlTGVuZ3RoID0gcnVuQ29kZXNUYWJsZS5kZWNvZGUocmVhZGVyKTsKCiAgICAgIGlmIChfY29kZUxlbmd0aCA+PSAzMikgewogICAgICAgIHZhciByZXBlYXRlZExlbmd0aCA9IHZvaWQgMCwKICAgICAgICAgICAgbnVtYmVyT2ZSZXBlYXRzID0gdm9pZCAwLAogICAgICAgICAgICBqID0gdm9pZCAwOwoKICAgICAgICBzd2l0Y2ggKF9jb2RlTGVuZ3RoKSB7CiAgICAgICAgICBjYXNlIDMyOgogICAgICAgICAgICBpZiAoX2kzID09PSAwKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoIm5vIHByZXZpb3VzIHZhbHVlIGluIHN5bWJvbCBJRCB0YWJsZSIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBudW1iZXJPZlJlcGVhdHMgPSByZWFkZXIucmVhZEJpdHMoMikgKyAzOwogICAgICAgICAgICByZXBlYXRlZExlbmd0aCA9IGNvZGVzW19pMyAtIDFdLnByZWZpeExlbmd0aDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzMzoKICAgICAgICAgICAgbnVtYmVyT2ZSZXBlYXRzID0gcmVhZGVyLnJlYWRCaXRzKDMpICsgMzsKICAgICAgICAgICAgcmVwZWF0ZWRMZW5ndGggPSAwOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM0OgogICAgICAgICAgICBudW1iZXJPZlJlcGVhdHMgPSByZWFkZXIucmVhZEJpdHMoNykgKyAxMTsKICAgICAgICAgICAgcmVwZWF0ZWRMZW5ndGggPSAwOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCBjb2RlIGxlbmd0aCBpbiBzeW1ib2wgSUQgdGFibGUiKTsKICAgICAgICB9CgogICAgICAgIGZvciAoaiA9IDA7IGogPCBudW1iZXJPZlJlcGVhdHM7IGorKykgewogICAgICAgICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW19pMywgcmVwZWF0ZWRMZW5ndGgsIDAsIDBdKSk7CiAgICAgICAgICBfaTMrKzsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29kZXMucHVzaChuZXcgSHVmZm1hbkxpbmUoW19pMywgX2NvZGVMZW5ndGgsIDAsIDBdKSk7CiAgICAgICAgX2kzKys7CiAgICAgIH0KICAgIH0KCiAgICByZWFkZXIuYnl0ZUFsaWduKCk7CiAgICB2YXIgc3ltYm9sSURUYWJsZSA9IG5ldyBIdWZmbWFuVGFibGUoY29kZXMsIGZhbHNlKTsKICAgIHZhciBjdXN0b21JbmRleCA9IDAsCiAgICAgICAgdGFibGVGaXJzdFMsCiAgICAgICAgdGFibGVEZWx0YVMsCiAgICAgICAgdGFibGVEZWx0YVQ7CgogICAgc3dpdGNoICh0ZXh0UmVnaW9uLmh1ZmZtYW5GUykgewogICAgICBjYXNlIDA6CiAgICAgIGNhc2UgMToKICAgICAgICB0YWJsZUZpcnN0UyA9IGdldFN0YW5kYXJkVGFibGUodGV4dFJlZ2lvbi5odWZmbWFuRlMgKyA2KTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzoKICAgICAgICB0YWJsZUZpcnN0UyA9IGdldEN1c3RvbUh1ZmZtYW5UYWJsZShjdXN0b21JbmRleCwgcmVmZXJyZWRUbywgY3VzdG9tVGFibGVzKTsKICAgICAgICBjdXN0b21JbmRleCsrOwogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICB0aHJvdyBuZXcgSmJpZzJFcnJvcigiaW52YWxpZCBIdWZmbWFuIEZTIHNlbGVjdG9yIik7CiAgICB9CgogICAgc3dpdGNoICh0ZXh0UmVnaW9uLmh1ZmZtYW5EUykgewogICAgICBjYXNlIDA6CiAgICAgIGNhc2UgMToKICAgICAgY2FzZSAyOgogICAgICAgIHRhYmxlRGVsdGFTID0gZ2V0U3RhbmRhcmRUYWJsZSh0ZXh0UmVnaW9uLmh1ZmZtYW5EUyArIDgpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzOgogICAgICAgIHRhYmxlRGVsdGFTID0gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGN1c3RvbUluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpOwogICAgICAgIGN1c3RvbUluZGV4Kys7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJpbnZhbGlkIEh1ZmZtYW4gRFMgc2VsZWN0b3IiKTsKICAgIH0KCiAgICBzd2l0Y2ggKHRleHRSZWdpb24uaHVmZm1hbkRUKSB7CiAgICAgIGNhc2UgMDoKICAgICAgY2FzZSAxOgogICAgICBjYXNlIDI6CiAgICAgICAgdGFibGVEZWx0YVQgPSBnZXRTdGFuZGFyZFRhYmxlKHRleHRSZWdpb24uaHVmZm1hbkRUICsgMTEpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzOgogICAgICAgIHRhYmxlRGVsdGFUID0gZ2V0Q3VzdG9tSHVmZm1hblRhYmxlKGN1c3RvbUluZGV4LCByZWZlcnJlZFRvLCBjdXN0b21UYWJsZXMpOwogICAgICAgIGN1c3RvbUluZGV4Kys7CiAgICAgICAgYnJlYWs7CgogICAgICBkZWZhdWx0OgogICAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJpbnZhbGlkIEh1ZmZtYW4gRFQgc2VsZWN0b3IiKTsKICAgIH0KCiAgICBpZiAodGV4dFJlZ2lvbi5yZWZpbmVtZW50KSB7CiAgICAgIHRocm93IG5ldyBKYmlnMkVycm9yKCJyZWZpbmVtZW50IHdpdGggSHVmZm1hbiBpcyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgc3ltYm9sSURUYWJsZTogc3ltYm9sSURUYWJsZSwKICAgICAgdGFibGVGaXJzdFM6IHRhYmxlRmlyc3RTLAogICAgICB0YWJsZURlbHRhUzogdGFibGVEZWx0YVMsCiAgICAgIHRhYmxlRGVsdGFUOiB0YWJsZURlbHRhVAogICAgfTsKICB9CgogIGZ1bmN0aW9uIGdldFN5bWJvbERpY3Rpb25hcnlIdWZmbWFuVGFibGVzKGRpY3Rpb25hcnksIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcykgewogICAgdmFyIGN1c3RvbUluZGV4ID0gMCwKICAgICAgICB0YWJsZURlbHRhSGVpZ2h0LAogICAgICAgIHRhYmxlRGVsdGFXaWR0aDsKCiAgICBzd2l0Y2ggKGRpY3Rpb25hcnkuaHVmZm1hbkRIU2VsZWN0b3IpIHsKICAgICAgY2FzZSAwOgogICAgICBjYXNlIDE6CiAgICAgICAgdGFibGVEZWx0YUhlaWdodCA9IGdldFN0YW5kYXJkVGFibGUoZGljdGlvbmFyeS5odWZmbWFuREhTZWxlY3RvciArIDQpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzOgogICAgICAgIHRhYmxlRGVsdGFIZWlnaHQgPSBnZXRDdXN0b21IdWZmbWFuVGFibGUoY3VzdG9tSW5kZXgsIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcyk7CiAgICAgICAgY3VzdG9tSW5kZXgrKzsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBESCBzZWxlY3RvciIpOwogICAgfQoKICAgIHN3aXRjaCAoZGljdGlvbmFyeS5odWZmbWFuRFdTZWxlY3RvcikgewogICAgICBjYXNlIDA6CiAgICAgIGNhc2UgMToKICAgICAgICB0YWJsZURlbHRhV2lkdGggPSBnZXRTdGFuZGFyZFRhYmxlKGRpY3Rpb25hcnkuaHVmZm1hbkRXU2VsZWN0b3IgKyAyKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMzoKICAgICAgICB0YWJsZURlbHRhV2lkdGggPSBnZXRDdXN0b21IdWZmbWFuVGFibGUoY3VzdG9tSW5kZXgsIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcyk7CiAgICAgICAgY3VzdG9tSW5kZXgrKzsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IEpiaWcyRXJyb3IoImludmFsaWQgSHVmZm1hbiBEVyBzZWxlY3RvciIpOwogICAgfQoKICAgIHZhciB0YWJsZUJpdG1hcFNpemUsIHRhYmxlQWdncmVnYXRlSW5zdGFuY2VzOwoKICAgIGlmIChkaWN0aW9uYXJ5LmJpdG1hcFNpemVTZWxlY3RvcikgewogICAgICB0YWJsZUJpdG1hcFNpemUgPSBnZXRDdXN0b21IdWZmbWFuVGFibGUoY3VzdG9tSW5kZXgsIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcyk7CiAgICAgIGN1c3RvbUluZGV4Kys7CiAgICB9IGVsc2UgewogICAgICB0YWJsZUJpdG1hcFNpemUgPSBnZXRTdGFuZGFyZFRhYmxlKDEpOwogICAgfQoKICAgIGlmIChkaWN0aW9uYXJ5LmFnZ3JlZ2F0aW9uSW5zdGFuY2VzU2VsZWN0b3IpIHsKICAgICAgdGFibGVBZ2dyZWdhdGVJbnN0YW5jZXMgPSBnZXRDdXN0b21IdWZmbWFuVGFibGUoY3VzdG9tSW5kZXgsIHJlZmVycmVkVG8sIGN1c3RvbVRhYmxlcyk7CiAgICB9IGVsc2UgewogICAgICB0YWJsZUFnZ3JlZ2F0ZUluc3RhbmNlcyA9IGdldFN0YW5kYXJkVGFibGUoMSk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgdGFibGVEZWx0YUhlaWdodDogdGFibGVEZWx0YUhlaWdodCwKICAgICAgdGFibGVEZWx0YVdpZHRoOiB0YWJsZURlbHRhV2lkdGgsCiAgICAgIHRhYmxlQml0bWFwU2l6ZTogdGFibGVCaXRtYXBTaXplLAogICAgICB0YWJsZUFnZ3JlZ2F0ZUluc3RhbmNlczogdGFibGVBZ2dyZWdhdGVJbnN0YW5jZXMKICAgIH07CiAgfQoKICBmdW5jdGlvbiByZWFkVW5jb21wcmVzc2VkQml0bWFwKHJlYWRlciwgd2lkdGgsIGhlaWdodCkgewogICAgdmFyIGJpdG1hcCA9IFtdOwoKICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKICAgICAgdmFyIHJvdyA9IG5ldyBVaW50OEFycmF5KHdpZHRoKTsKICAgICAgYml0bWFwLnB1c2gocm93KTsKCiAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICAgIHJvd1t4XSA9IHJlYWRlci5yZWFkQml0KCk7CiAgICAgIH0KCiAgICAgIHJlYWRlci5ieXRlQWxpZ24oKTsKICAgIH0KCiAgICByZXR1cm4gYml0bWFwOwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlTU1SQml0bWFwKGlucHV0LCB3aWR0aCwgaGVpZ2h0LCBlbmRPZkJsb2NrKSB7CiAgICB2YXIgcGFyYW1zID0gewogICAgICBLOiAtMSwKICAgICAgQ29sdW1uczogd2lkdGgsCiAgICAgIFJvd3M6IGhlaWdodCwKICAgICAgQmxhY2tJczE6IHRydWUsCiAgICAgIEVuZE9mQmxvY2s6IGVuZE9mQmxvY2sKICAgIH07CiAgICB2YXIgZGVjb2RlciA9IG5ldyBfY2NpdHQuQ0NJVFRGYXhEZWNvZGVyKGlucHV0LCBwYXJhbXMpOwogICAgdmFyIGJpdG1hcCA9IFtdOwogICAgdmFyIGN1cnJlbnRCeXRlLAogICAgICAgIGVvZiA9IGZhbHNlOwoKICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKICAgICAgdmFyIHJvdyA9IG5ldyBVaW50OEFycmF5KHdpZHRoKTsKICAgICAgYml0bWFwLnB1c2gocm93KTsKICAgICAgdmFyIHNoaWZ0ID0gLTE7CgogICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICBpZiAoc2hpZnQgPCAwKSB7CiAgICAgICAgICBjdXJyZW50Qnl0ZSA9IGRlY29kZXIucmVhZE5leHRDaGFyKCk7CgogICAgICAgICAgaWYgKGN1cnJlbnRCeXRlID09PSAtMSkgewogICAgICAgICAgICBjdXJyZW50Qnl0ZSA9IDA7CiAgICAgICAgICAgIGVvZiA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgc2hpZnQgPSA3OwogICAgICAgIH0KCiAgICAgICAgcm93W3hdID0gY3VycmVudEJ5dGUgPj4gc2hpZnQgJiAxOwogICAgICAgIHNoaWZ0LS07CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZW5kT2ZCbG9jayAmJiAhZW9mKSB7CiAgICAgIHZhciBsb29rRm9yRU9GTGltaXQgPSA1OwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb29rRm9yRU9GTGltaXQ7IGkrKykgewogICAgICAgIGlmIChkZWNvZGVyLnJlYWROZXh0Q2hhcigpID09PSAtMSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGJpdG1hcDsKICB9CgogIGZ1bmN0aW9uIEpiaWcySW1hZ2UoKSB7fQoKICBKYmlnMkltYWdlLnByb3RvdHlwZSA9IHsKICAgIHBhcnNlQ2h1bmtzOiBmdW5jdGlvbiBwYXJzZUNodW5rcyhjaHVua3MpIHsKICAgICAgcmV0dXJuIHBhcnNlSmJpZzJDaHVua3MoY2h1bmtzKTsKICAgIH0sCiAgICBwYXJzZTogZnVuY3Rpb24gcGFyc2UoZGF0YSkgewogICAgICB2YXIgX3BhcnNlSmJpZyA9IHBhcnNlSmJpZzIoZGF0YSksCiAgICAgICAgICBpbWdEYXRhID0gX3BhcnNlSmJpZy5pbWdEYXRhLAogICAgICAgICAgd2lkdGggPSBfcGFyc2VKYmlnLndpZHRoLAogICAgICAgICAgaGVpZ2h0ID0gX3BhcnNlSmJpZy5oZWlnaHQ7CgogICAgICB0aGlzLndpZHRoID0gd2lkdGg7CiAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwogICAgICByZXR1cm4gaW1nRGF0YTsKICAgIH0KICB9OwogIHJldHVybiBKYmlnMkltYWdlOwp9KCk7CgpleHBvcnRzLkpiaWcySW1hZ2UgPSBKYmlnMkltYWdlOwoKLyoqKi8gfSksCi8qIDIxMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkFyaXRobWV0aWNEZWNvZGVyID0gdm9pZCAwOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCnZhciBRZVRhYmxlID0gW3sKICBxZTogMHg1NjAxLAogIG5tcHM6IDEsCiAgbmxwczogMSwKICBzd2l0Y2hGbGFnOiAxCn0sIHsKICBxZTogMHgzNDAxLAogIG5tcHM6IDIsCiAgbmxwczogNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxODAxLAogIG5tcHM6IDMsCiAgbmxwczogOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwYWMxLAogIG5tcHM6IDQsCiAgbmxwczogMTIsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDUyMSwKICBubXBzOiA1LAogIG5scHM6IDI5LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAyMjEsCiAgbm1wczogMzgsCiAgbmxwczogMzMsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NTYwMSwKICBubXBzOiA3LAogIG5scHM6IDYsCiAgc3dpdGNoRmxhZzogMQp9LCB7CiAgcWU6IDB4NTQwMSwKICBubXBzOiA4LAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDQ4MDEsCiAgbm1wczogOSwKICBubHBzOiAxNCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgzODAxLAogIG5tcHM6IDEwLAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDMwMDEsCiAgbm1wczogMTEsCiAgbmxwczogMTcsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MjQwMSwKICBubXBzOiAxMiwKICBubHBzOiAxOCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxYzAxLAogIG5tcHM6IDEzLAogIG5scHM6IDIwLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDE2MDEsCiAgbm1wczogMjksCiAgbmxwczogMjEsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NTYwMSwKICBubXBzOiAxNSwKICBubHBzOiAxNCwKICBzd2l0Y2hGbGFnOiAxCn0sIHsKICBxZTogMHg1NDAxLAogIG5tcHM6IDE2LAogIG5scHM6IDE0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDUxMDEsCiAgbm1wczogMTcsCiAgbmxwczogMTUsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4NDgwMSwKICBubXBzOiAxOCwKICBubHBzOiAxNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgzODAxLAogIG5tcHM6IDE5LAogIG5scHM6IDE3LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDM0MDEsCiAgbm1wczogMjAsCiAgbmxwczogMTgsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MzAwMSwKICBubXBzOiAyMSwKICBubHBzOiAxOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgyODAxLAogIG5tcHM6IDIyLAogIG5scHM6IDE5LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDI0MDEsCiAgbm1wczogMjMsCiAgbmxwczogMjAsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MjIwMSwKICBubXBzOiAyNCwKICBubHBzOiAyMSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxYzAxLAogIG5tcHM6IDI1LAogIG5scHM6IDIyLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDE4MDEsCiAgbm1wczogMjYsCiAgbmxwczogMjMsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MTYwMSwKICBubXBzOiAyNywKICBubHBzOiAyNCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgxNDAxLAogIG5tcHM6IDI4LAogIG5scHM6IDI1LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDEyMDEsCiAgbm1wczogMjksCiAgbmxwczogMjYsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MTEwMSwKICBubXBzOiAzMCwKICBubHBzOiAyNywKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwYWMxLAogIG5tcHM6IDMxLAogIG5scHM6IDI4LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDA5YzEsCiAgbm1wczogMzIsCiAgbmxwczogMjksCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDhhMSwKICBubXBzOiAzMywKICBubHBzOiAzMCwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwNTIxLAogIG5tcHM6IDM0LAogIG5scHM6IDMxLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDA0NDEsCiAgbm1wczogMzUsCiAgbmxwczogMzIsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDJhMSwKICBubXBzOiAzNiwKICBubHBzOiAzMywKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMjIxLAogIG5tcHM6IDM3LAogIG5scHM6IDM0LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAxNDEsCiAgbm1wczogMzgsCiAgbmxwczogMzUsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDExMSwKICBubXBzOiAzOSwKICBubHBzOiAzNiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDg1LAogIG5tcHM6IDQwLAogIG5scHM6IDM3LAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAwNDksCiAgbm1wczogNDEsCiAgbmxwczogMzgsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDAyNSwKICBubXBzOiA0MiwKICBubHBzOiAzOSwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDE1LAogIG5tcHM6IDQzLAogIG5scHM6IDQwLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDAwMDksCiAgbm1wczogNDQsCiAgbmxwczogNDEsCiAgc3dpdGNoRmxhZzogMAp9LCB7CiAgcWU6IDB4MDAwNSwKICBubXBzOiA0NSwKICBubHBzOiA0MiwKICBzd2l0Y2hGbGFnOiAwCn0sIHsKICBxZTogMHgwMDAxLAogIG5tcHM6IDQ1LAogIG5scHM6IDQzLAogIHN3aXRjaEZsYWc6IDAKfSwgewogIHFlOiAweDU2MDEsCiAgbm1wczogNDYsCiAgbmxwczogNDYsCiAgc3dpdGNoRmxhZzogMAp9XTsKCnZhciBBcml0aG1ldGljRGVjb2RlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQXJpdGhtZXRpY0RlY29kZXIoZGF0YSwgc3RhcnQsIGVuZCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFyaXRobWV0aWNEZWNvZGVyKTsKCiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5icCA9IHN0YXJ0OwogICAgdGhpcy5kYXRhRW5kID0gZW5kOwogICAgdGhpcy5jaGlnaCA9IGRhdGFbc3RhcnRdOwogICAgdGhpcy5jbG93ID0gMDsKICAgIHRoaXMuYnl0ZUluKCk7CiAgICB0aGlzLmNoaWdoID0gdGhpcy5jaGlnaCA8PCA3ICYgMHhmZmZmIHwgdGhpcy5jbG93ID4+IDkgJiAweDdmOwogICAgdGhpcy5jbG93ID0gdGhpcy5jbG93IDw8IDcgJiAweGZmZmY7CiAgICB0aGlzLmN0IC09IDc7CiAgICB0aGlzLmEgPSAweDgwMDA7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQXJpdGhtZXRpY0RlY29kZXIsIFt7CiAgICBrZXk6ICJieXRlSW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJ5dGVJbigpIHsKICAgICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIHZhciBicCA9IHRoaXMuYnA7CgogICAgICBpZiAoZGF0YVticF0gPT09IDB4ZmYpIHsKICAgICAgICBpZiAoZGF0YVticCArIDFdID4gMHg4ZikgewogICAgICAgICAgdGhpcy5jbG93ICs9IDB4ZmYwMDsKICAgICAgICAgIHRoaXMuY3QgPSA4OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBicCsrOwogICAgICAgICAgdGhpcy5jbG93ICs9IGRhdGFbYnBdIDw8IDk7CiAgICAgICAgICB0aGlzLmN0ID0gNzsKICAgICAgICAgIHRoaXMuYnAgPSBicDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYnArKzsKICAgICAgICB0aGlzLmNsb3cgKz0gYnAgPCB0aGlzLmRhdGFFbmQgPyBkYXRhW2JwXSA8PCA4IDogMHhmZjAwOwogICAgICAgIHRoaXMuY3QgPSA4OwogICAgICAgIHRoaXMuYnAgPSBicDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuY2xvdyA+IDB4ZmZmZikgewogICAgICAgIHRoaXMuY2hpZ2ggKz0gdGhpcy5jbG93ID4+IDE2OwogICAgICAgIHRoaXMuY2xvdyAmPSAweGZmZmY7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWFkQml0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkQml0KGNvbnRleHRzLCBwb3MpIHsKICAgICAgdmFyIGN4X2luZGV4ID0gY29udGV4dHNbcG9zXSA+PiAxLAogICAgICAgICAgY3hfbXBzID0gY29udGV4dHNbcG9zXSAmIDE7CiAgICAgIHZhciBxZVRhYmxlSWN4ID0gUWVUYWJsZVtjeF9pbmRleF07CiAgICAgIHZhciBxZUljeCA9IHFlVGFibGVJY3gucWU7CiAgICAgIHZhciBkOwogICAgICB2YXIgYSA9IHRoaXMuYSAtIHFlSWN4OwoKICAgICAgaWYgKHRoaXMuY2hpZ2ggPCBxZUljeCkgewogICAgICAgIGlmIChhIDwgcWVJY3gpIHsKICAgICAgICAgIGEgPSBxZUljeDsKICAgICAgICAgIGQgPSBjeF9tcHM7CiAgICAgICAgICBjeF9pbmRleCA9IHFlVGFibGVJY3gubm1wczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYSA9IHFlSWN4OwogICAgICAgICAgZCA9IDEgXiBjeF9tcHM7CgogICAgICAgICAgaWYgKHFlVGFibGVJY3guc3dpdGNoRmxhZyA9PT0gMSkgewogICAgICAgICAgICBjeF9tcHMgPSBkOwogICAgICAgICAgfQoKICAgICAgICAgIGN4X2luZGV4ID0gcWVUYWJsZUljeC5ubHBzOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNoaWdoIC09IHFlSWN4OwoKICAgICAgICBpZiAoKGEgJiAweDgwMDApICE9PSAwKSB7CiAgICAgICAgICB0aGlzLmEgPSBhOwogICAgICAgICAgcmV0dXJuIGN4X21wczsKICAgICAgICB9CgogICAgICAgIGlmIChhIDwgcWVJY3gpIHsKICAgICAgICAgIGQgPSAxIF4gY3hfbXBzOwoKICAgICAgICAgIGlmIChxZVRhYmxlSWN4LnN3aXRjaEZsYWcgPT09IDEpIHsKICAgICAgICAgICAgY3hfbXBzID0gZDsKICAgICAgICAgIH0KCiAgICAgICAgICBjeF9pbmRleCA9IHFlVGFibGVJY3gubmxwczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZCA9IGN4X21wczsKICAgICAgICAgIGN4X2luZGV4ID0gcWVUYWJsZUljeC5ubXBzOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZG8gewogICAgICAgIGlmICh0aGlzLmN0ID09PSAwKSB7CiAgICAgICAgICB0aGlzLmJ5dGVJbigpOwogICAgICAgIH0KCiAgICAgICAgYSA8PD0gMTsKICAgICAgICB0aGlzLmNoaWdoID0gdGhpcy5jaGlnaCA8PCAxICYgMHhmZmZmIHwgdGhpcy5jbG93ID4+IDE1ICYgMTsKICAgICAgICB0aGlzLmNsb3cgPSB0aGlzLmNsb3cgPDwgMSAmIDB4ZmZmZjsKICAgICAgICB0aGlzLmN0LS07CiAgICAgIH0gd2hpbGUgKChhICYgMHg4MDAwKSA9PT0gMCk7CgogICAgICB0aGlzLmEgPSBhOwogICAgICBjb250ZXh0c1twb3NdID0gY3hfaW5kZXggPDwgMSB8IGN4X21wczsKICAgICAgcmV0dXJuIGQ7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQXJpdGhtZXRpY0RlY29kZXI7Cn0oKTsKCmV4cG9ydHMuQXJpdGhtZXRpY0RlY29kZXIgPSBBcml0aG1ldGljRGVjb2RlcjsKCi8qKiovIH0pLAovKiAyMTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5KcGVnU3RyZWFtID0gdm9pZCAwOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNSk7Cgp2YXIgX3ByaW1pdGl2ZXMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDE5OCk7Cgp2YXIgX2pwZyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjEyKTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgSnBlZ1N0cmVhbSA9IGZ1bmN0aW9uIEpwZWdTdHJlYW1DbG9zdXJlKCkgewogIGZ1bmN0aW9uIEpwZWdTdHJlYW0oc3RyZWFtLCBtYXliZUxlbmd0aCwgZGljdCwgcGFyYW1zKSB7CiAgICB2YXIgY2g7CgogICAgd2hpbGUgKChjaCA9IHN0cmVhbS5nZXRCeXRlKCkpICE9PSAtMSkgewogICAgICBpZiAoY2ggPT09IDB4ZmYpIHsKICAgICAgICBzdHJlYW0uc2tpcCgtMSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMubWF5YmVMZW5ndGggPSBtYXliZUxlbmd0aDsKICAgIHRoaXMuZGljdCA9IGRpY3Q7CiAgICB0aGlzLnBhcmFtcyA9IHBhcmFtczsKCiAgICBfc3RyZWFtLkRlY29kZVN0cmVhbS5jYWxsKHRoaXMsIG1heWJlTGVuZ3RoKTsKICB9CgogIEpwZWdTdHJlYW0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShfc3RyZWFtLkRlY29kZVN0cmVhbS5wcm90b3R5cGUpOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShKcGVnU3RyZWFtLnByb3RvdHlwZSwgImJ5dGVzIiwgewogICAgZ2V0OiBmdW5jdGlvbiBKcGVnU3RyZWFtX2J5dGVzKCkgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImJ5dGVzIiwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZXModGhpcy5tYXliZUxlbmd0aCkpOwogICAgfSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogIH0pOwoKICBKcGVnU3RyZWFtLnByb3RvdHlwZS5lbnN1cmVCdWZmZXIgPSBmdW5jdGlvbiAocmVxdWVzdGVkKSB7fTsKCiAgSnBlZ1N0cmVhbS5wcm90b3R5cGUucmVhZEJsb2NrID0gZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMuZW9mKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIganBlZ09wdGlvbnMgPSB7CiAgICAgIGRlY29kZVRyYW5zZm9ybTogdW5kZWZpbmVkLAogICAgICBjb2xvclRyYW5zZm9ybTogdW5kZWZpbmVkCiAgICB9OwogICAgdmFyIGRlY29kZUFyciA9IHRoaXMuZGljdC5nZXRBcnJheSgiRGVjb2RlIiwgIkQiKTsKCiAgICBpZiAodGhpcy5mb3JjZVJHQiAmJiBBcnJheS5pc0FycmF5KGRlY29kZUFycikpIHsKICAgICAgdmFyIGJpdHNQZXJDb21wb25lbnQgPSB0aGlzLmRpY3QuZ2V0KCJCaXRzUGVyQ29tcG9uZW50IikgfHwgODsKICAgICAgdmFyIGRlY29kZUFyckxlbmd0aCA9IGRlY29kZUFyci5sZW5ndGg7CiAgICAgIHZhciB0cmFuc2Zvcm0gPSBuZXcgSW50MzJBcnJheShkZWNvZGVBcnJMZW5ndGgpOwogICAgICB2YXIgdHJhbnNmb3JtTmVlZGVkID0gZmFsc2U7CiAgICAgIHZhciBtYXhWYWx1ZSA9ICgxIDw8IGJpdHNQZXJDb21wb25lbnQpIC0gMTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGVjb2RlQXJyTGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICB0cmFuc2Zvcm1baV0gPSAoZGVjb2RlQXJyW2kgKyAxXSAtIGRlY29kZUFycltpXSkgKiAyNTYgfCAwOwogICAgICAgIHRyYW5zZm9ybVtpICsgMV0gPSBkZWNvZGVBcnJbaV0gKiBtYXhWYWx1ZSB8IDA7CgogICAgICAgIGlmICh0cmFuc2Zvcm1baV0gIT09IDI1NiB8fCB0cmFuc2Zvcm1baSArIDFdICE9PSAwKSB7CiAgICAgICAgICB0cmFuc2Zvcm1OZWVkZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRyYW5zZm9ybU5lZWRlZCkgewogICAgICAgIGpwZWdPcHRpb25zLmRlY29kZVRyYW5zZm9ybSA9IHRyYW5zZm9ybTsKICAgICAgfQogICAgfQoKICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KSh0aGlzLnBhcmFtcykpIHsKICAgICAgdmFyIGNvbG9yVHJhbnNmb3JtID0gdGhpcy5wYXJhbXMuZ2V0KCJDb2xvclRyYW5zZm9ybSIpOwoKICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIoY29sb3JUcmFuc2Zvcm0pKSB7CiAgICAgICAganBlZ09wdGlvbnMuY29sb3JUcmFuc2Zvcm0gPSBjb2xvclRyYW5zZm9ybTsKICAgICAgfQogICAgfQoKICAgIHZhciBqcGVnSW1hZ2UgPSBuZXcgX2pwZy5KcGVnSW1hZ2UoanBlZ09wdGlvbnMpOwogICAganBlZ0ltYWdlLnBhcnNlKHRoaXMuYnl0ZXMpOwogICAgdmFyIGRhdGEgPSBqcGVnSW1hZ2UuZ2V0RGF0YSh7CiAgICAgIHdpZHRoOiB0aGlzLmRyYXdXaWR0aCwKICAgICAgaGVpZ2h0OiB0aGlzLmRyYXdIZWlnaHQsCiAgICAgIGZvcmNlUkdCOiB0aGlzLmZvcmNlUkdCLAogICAgICBpc1NvdXJjZVBERjogdHJ1ZQogICAgfSk7CiAgICB0aGlzLmJ1ZmZlciA9IGRhdGE7CiAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAgdGhpcy5lb2YgPSB0cnVlOwogIH07CgogIHJldHVybiBKcGVnU3RyZWFtOwp9KCk7CgpleHBvcnRzLkpwZWdTdHJlYW0gPSBKcGVnU3RyZWFtOwoKLyoqKi8gfSksCi8qIDIxMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkpwZWdJbWFnZSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMSk7CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOyB0cnkgeyBEYXRlLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKFJlZmxlY3QuY29uc3RydWN0KERhdGUsIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKdmFyIEpwZWdFcnJvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VFeGNlcHRpb24pIHsKICBfaW5oZXJpdHMoSnBlZ0Vycm9yLCBfQmFzZUV4Y2VwdGlvbik7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoSnBlZ0Vycm9yKTsKCiAgZnVuY3Rpb24gSnBlZ0Vycm9yKG1zZykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEpwZWdFcnJvcik7CgogICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsICJKUEVHIGVycm9yOiAiLmNvbmNhdChtc2cpKTsKICB9CgogIHJldHVybiBKcGVnRXJyb3I7Cn0oX3V0aWwuQmFzZUV4Y2VwdGlvbik7Cgp2YXIgRE5MTWFya2VyRXJyb3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9CYXNlRXhjZXB0aW9uMikgewogIF9pbmhlcml0cyhETkxNYXJrZXJFcnJvciwgX0Jhc2VFeGNlcHRpb24yKTsKCiAgdmFyIF9zdXBlcjIgPSBfY3JlYXRlU3VwZXIoRE5MTWFya2VyRXJyb3IpOwoKICBmdW5jdGlvbiBETkxNYXJrZXJFcnJvcihtZXNzYWdlLCBzY2FuTGluZXMpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRE5MTWFya2VyRXJyb3IpOwoKICAgIF90aGlzID0gX3N1cGVyMi5jYWxsKHRoaXMsIG1lc3NhZ2UpOwogICAgX3RoaXMuc2NhbkxpbmVzID0gc2NhbkxpbmVzOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgcmV0dXJuIEROTE1hcmtlckVycm9yOwp9KF91dGlsLkJhc2VFeGNlcHRpb24pOwoKdmFyIEVPSU1hcmtlckVycm9yID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZUV4Y2VwdGlvbjMpIHsKICBfaW5oZXJpdHMoRU9JTWFya2VyRXJyb3IsIF9CYXNlRXhjZXB0aW9uMyk7CgogIHZhciBfc3VwZXIzID0gX2NyZWF0ZVN1cGVyKEVPSU1hcmtlckVycm9yKTsKCiAgZnVuY3Rpb24gRU9JTWFya2VyRXJyb3IoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRU9JTWFya2VyRXJyb3IpOwoKICAgIHJldHVybiBfc3VwZXIzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQoKICByZXR1cm4gRU9JTWFya2VyRXJyb3I7Cn0oX3V0aWwuQmFzZUV4Y2VwdGlvbik7Cgp2YXIgSnBlZ0ltYWdlID0gZnVuY3Rpb24gSnBlZ0ltYWdlQ2xvc3VyZSgpIHsKICB2YXIgZGN0WmlnWmFnID0gbmV3IFVpbnQ4QXJyYXkoWzAsIDEsIDgsIDE2LCA5LCAyLCAzLCAxMCwgMTcsIDI0LCAzMiwgMjUsIDE4LCAxMSwgNCwgNSwgMTIsIDE5LCAyNiwgMzMsIDQwLCA0OCwgNDEsIDM0LCAyNywgMjAsIDEzLCA2LCA3LCAxNCwgMjEsIDI4LCAzNSwgNDIsIDQ5LCA1NiwgNTcsIDUwLCA0MywgMzYsIDI5LCAyMiwgMTUsIDIzLCAzMCwgMzcsIDQ0LCA1MSwgNTgsIDU5LCA1MiwgNDUsIDM4LCAzMSwgMzksIDQ2LCA1MywgNjAsIDYxLCA1NCwgNDcsIDU1LCA2MiwgNjNdKTsKICB2YXIgZGN0Q29zMSA9IDQwMTc7CiAgdmFyIGRjdFNpbjEgPSA3OTk7CiAgdmFyIGRjdENvczMgPSAzNDA2OwogIHZhciBkY3RTaW4zID0gMjI3NjsKICB2YXIgZGN0Q29zNiA9IDE1Njc7CiAgdmFyIGRjdFNpbjYgPSAzNzg0OwogIHZhciBkY3RTcXJ0MiA9IDU3OTM7CiAgdmFyIGRjdFNxcnQxZDIgPSAyODk2OwoKICBmdW5jdGlvbiBKcGVnSW1hZ2UoKSB7CiAgICB2YXIgX3JlZiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge30sCiAgICAgICAgX3JlZiRkZWNvZGVUcmFuc2Zvcm0gPSBfcmVmLmRlY29kZVRyYW5zZm9ybSwKICAgICAgICBkZWNvZGVUcmFuc2Zvcm0gPSBfcmVmJGRlY29kZVRyYW5zZm9ybSA9PT0gdm9pZCAwID8gbnVsbCA6IF9yZWYkZGVjb2RlVHJhbnNmb3JtLAogICAgICAgIF9yZWYkY29sb3JUcmFuc2Zvcm0gPSBfcmVmLmNvbG9yVHJhbnNmb3JtLAogICAgICAgIGNvbG9yVHJhbnNmb3JtID0gX3JlZiRjb2xvclRyYW5zZm9ybSA9PT0gdm9pZCAwID8gLTEgOiBfcmVmJGNvbG9yVHJhbnNmb3JtOwoKICAgIHRoaXMuX2RlY29kZVRyYW5zZm9ybSA9IGRlY29kZVRyYW5zZm9ybTsKICAgIHRoaXMuX2NvbG9yVHJhbnNmb3JtID0gY29sb3JUcmFuc2Zvcm07CiAgfQoKICBmdW5jdGlvbiBidWlsZEh1ZmZtYW5UYWJsZShjb2RlTGVuZ3RocywgdmFsdWVzKSB7CiAgICB2YXIgayA9IDAsCiAgICAgICAgY29kZSA9IFtdLAogICAgICAgIGksCiAgICAgICAgaiwKICAgICAgICBsZW5ndGggPSAxNjsKCiAgICB3aGlsZSAobGVuZ3RoID4gMCAmJiAhY29kZUxlbmd0aHNbbGVuZ3RoIC0gMV0pIHsKICAgICAgbGVuZ3RoLS07CiAgICB9CgogICAgY29kZS5wdXNoKHsKICAgICAgY2hpbGRyZW46IFtdLAogICAgICBpbmRleDogMAogICAgfSk7CiAgICB2YXIgcCA9IGNvZGVbMF0sCiAgICAgICAgcTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgZm9yIChqID0gMDsgaiA8IGNvZGVMZW5ndGhzW2ldOyBqKyspIHsKICAgICAgICBwID0gY29kZS5wb3AoKTsKICAgICAgICBwLmNoaWxkcmVuW3AuaW5kZXhdID0gdmFsdWVzW2tdOwoKICAgICAgICB3aGlsZSAocC5pbmRleCA+IDApIHsKICAgICAgICAgIHAgPSBjb2RlLnBvcCgpOwogICAgICAgIH0KCiAgICAgICAgcC5pbmRleCsrOwogICAgICAgIGNvZGUucHVzaChwKTsKCiAgICAgICAgd2hpbGUgKGNvZGUubGVuZ3RoIDw9IGkpIHsKICAgICAgICAgIGNvZGUucHVzaChxID0gewogICAgICAgICAgICBjaGlsZHJlbjogW10sCiAgICAgICAgICAgIGluZGV4OiAwCiAgICAgICAgICB9KTsKICAgICAgICAgIHAuY2hpbGRyZW5bcC5pbmRleF0gPSBxLmNoaWxkcmVuOwogICAgICAgICAgcCA9IHE7CiAgICAgICAgfQoKICAgICAgICBrKys7CiAgICAgIH0KCiAgICAgIGlmIChpICsgMSA8IGxlbmd0aCkgewogICAgICAgIGNvZGUucHVzaChxID0gewogICAgICAgICAgY2hpbGRyZW46IFtdLAogICAgICAgICAgaW5kZXg6IDAKICAgICAgICB9KTsKICAgICAgICBwLmNoaWxkcmVuW3AuaW5kZXhdID0gcS5jaGlsZHJlbjsKICAgICAgICBwID0gcTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBjb2RlWzBdLmNoaWxkcmVuOwogIH0KCiAgZnVuY3Rpb24gZ2V0QmxvY2tCdWZmZXJPZmZzZXQoY29tcG9uZW50LCByb3csIGNvbCkgewogICAgcmV0dXJuIDY0ICogKChjb21wb25lbnQuYmxvY2tzUGVyTGluZSArIDEpICogcm93ICsgY29sKTsKICB9CgogIGZ1bmN0aW9uIGRlY29kZVNjYW4oZGF0YSwgb2Zmc2V0LCBmcmFtZSwgY29tcG9uZW50cywgcmVzZXRJbnRlcnZhbCwgc3BlY3RyYWxTdGFydCwgc3BlY3RyYWxFbmQsIHN1Y2Nlc3NpdmVQcmV2LCBzdWNjZXNzaXZlKSB7CiAgICB2YXIgcGFyc2VETkxNYXJrZXIgPSBhcmd1bWVudHMubGVuZ3RoID4gOSAmJiBhcmd1bWVudHNbOV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s5XSA6IGZhbHNlOwogICAgdmFyIG1jdXNQZXJMaW5lID0gZnJhbWUubWN1c1BlckxpbmU7CiAgICB2YXIgcHJvZ3Jlc3NpdmUgPSBmcmFtZS5wcm9ncmVzc2l2ZTsKICAgIHZhciBzdGFydE9mZnNldCA9IG9mZnNldDsKICAgIHZhciBiaXRzRGF0YSA9IDAsCiAgICAgICAgYml0c0NvdW50ID0gMDsKCiAgICBmdW5jdGlvbiByZWFkQml0KCkgewogICAgICBpZiAoYml0c0NvdW50ID4gMCkgewogICAgICAgIGJpdHNDb3VudC0tOwogICAgICAgIHJldHVybiBiaXRzRGF0YSA+PiBiaXRzQ291bnQgJiAxOwogICAgICB9CgogICAgICBiaXRzRGF0YSA9IGRhdGFbb2Zmc2V0KytdOwoKICAgICAgaWYgKGJpdHNEYXRhID09PSAweGZmKSB7CiAgICAgICAgdmFyIG5leHRCeXRlID0gZGF0YVtvZmZzZXQrK107CgogICAgICAgIGlmIChuZXh0Qnl0ZSkgewogICAgICAgICAgaWYgKG5leHRCeXRlID09PSAweGRjICYmIHBhcnNlRE5MTWFya2VyKSB7CiAgICAgICAgICAgIG9mZnNldCArPSAyOwogICAgICAgICAgICB2YXIgc2NhbkxpbmVzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgICAgICAgIG9mZnNldCArPSAyOwoKICAgICAgICAgICAgaWYgKHNjYW5MaW5lcyA+IDAgJiYgc2NhbkxpbmVzICE9PSBmcmFtZS5zY2FuTGluZXMpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRE5MTWFya2VyRXJyb3IoIkZvdW5kIEROTCBtYXJrZXIgKDB4RkZEQykgd2hpbGUgcGFyc2luZyBzY2FuIGRhdGEiLCBzY2FuTGluZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKG5leHRCeXRlID09PSAweGQ5KSB7CiAgICAgICAgICAgIGlmIChwYXJzZUROTE1hcmtlcikgewogICAgICAgICAgICAgIHZhciBtYXliZVNjYW5MaW5lcyA9IGJsb2NrUm93ICogODsKCiAgICAgICAgICAgICAgaWYgKG1heWJlU2NhbkxpbmVzID4gMCAmJiBtYXliZVNjYW5MaW5lcyA8IGZyYW1lLnNjYW5MaW5lcyAvIDEwKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRE5MTWFya2VyRXJyb3IoIkZvdW5kIEVPSSBtYXJrZXIgKDB4RkZEOSkgd2hpbGUgcGFyc2luZyBzY2FuIGRhdGEsICIgKyAicG9zc2libHkgY2F1c2VkIGJ5IGluY29ycmVjdCBgc2NhbkxpbmVzYCBwYXJhbWV0ZXIiLCBtYXliZVNjYW5MaW5lcyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB0aHJvdyBuZXcgRU9JTWFya2VyRXJyb3IoIkZvdW5kIEVPSSBtYXJrZXIgKDB4RkZEOSkgd2hpbGUgcGFyc2luZyBzY2FuIGRhdGEiKTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJ1bmV4cGVjdGVkIG1hcmtlciAiLmNvbmNhdCgoYml0c0RhdGEgPDwgOCB8IG5leHRCeXRlKS50b1N0cmluZygxNikpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGJpdHNDb3VudCA9IDc7CiAgICAgIHJldHVybiBiaXRzRGF0YSA+Pj4gNzsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWNvZGVIdWZmbWFuKHRyZWUpIHsKICAgICAgdmFyIG5vZGUgPSB0cmVlOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICBub2RlID0gbm9kZVtyZWFkQml0KCldOwoKICAgICAgICBzd2l0Y2ggKF90eXBlb2Yobm9kZSkpIHsKICAgICAgICAgIGNhc2UgIm51bWJlciI6CiAgICAgICAgICAgIHJldHVybiBub2RlOwoKICAgICAgICAgIGNhc2UgIm9iamVjdCI6CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IEpwZWdFcnJvcigiaW52YWxpZCBodWZmbWFuIHNlcXVlbmNlIik7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiByZWNlaXZlKGxlbmd0aCkgewogICAgICB2YXIgbiA9IDA7CgogICAgICB3aGlsZSAobGVuZ3RoID4gMCkgewogICAgICAgIG4gPSBuIDw8IDEgfCByZWFkQml0KCk7CiAgICAgICAgbGVuZ3RoLS07CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlY2VpdmVBbmRFeHRlbmQobGVuZ3RoKSB7CiAgICAgIGlmIChsZW5ndGggPT09IDEpIHsKICAgICAgICByZXR1cm4gcmVhZEJpdCgpID09PSAxID8gMSA6IC0xOwogICAgICB9CgogICAgICB2YXIgbiA9IHJlY2VpdmUobGVuZ3RoKTsKCiAgICAgIGlmIChuID49IDEgPDwgbGVuZ3RoIC0gMSkgewogICAgICAgIHJldHVybiBuOwogICAgICB9CgogICAgICByZXR1cm4gbiArICgtMSA8PCBsZW5ndGgpICsgMTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWNvZGVCYXNlbGluZShjb21wb25lbnQsIGJsb2NrT2Zmc2V0KSB7CiAgICAgIHZhciB0ID0gZGVjb2RlSHVmZm1hbihjb21wb25lbnQuaHVmZm1hblRhYmxlREMpOwogICAgICB2YXIgZGlmZiA9IHQgPT09IDAgPyAwIDogcmVjZWl2ZUFuZEV4dGVuZCh0KTsKICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtibG9ja09mZnNldF0gPSBjb21wb25lbnQucHJlZCArPSBkaWZmOwogICAgICB2YXIgayA9IDE7CgogICAgICB3aGlsZSAoayA8IDY0KSB7CiAgICAgICAgdmFyIHJzID0gZGVjb2RlSHVmZm1hbihjb21wb25lbnQuaHVmZm1hblRhYmxlQUMpOwogICAgICAgIHZhciBzID0gcnMgJiAxNSwKICAgICAgICAgICAgciA9IHJzID4+IDQ7CgogICAgICAgIGlmIChzID09PSAwKSB7CiAgICAgICAgICBpZiAociA8IDE1KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGsgKz0gMTY7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGsgKz0gcjsKICAgICAgICB2YXIgeiA9IGRjdFppZ1phZ1trXTsKICAgICAgICBjb21wb25lbnQuYmxvY2tEYXRhW2Jsb2NrT2Zmc2V0ICsgel0gPSByZWNlaXZlQW5kRXh0ZW5kKHMpOwogICAgICAgIGsrKzsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGRlY29kZURDRmlyc3QoY29tcG9uZW50LCBibG9ja09mZnNldCkgewogICAgICB2YXIgdCA9IGRlY29kZUh1ZmZtYW4oY29tcG9uZW50Lmh1ZmZtYW5UYWJsZURDKTsKICAgICAgdmFyIGRpZmYgPSB0ID09PSAwID8gMCA6IHJlY2VpdmVBbmRFeHRlbmQodCkgPDwgc3VjY2Vzc2l2ZTsKICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtibG9ja09mZnNldF0gPSBjb21wb25lbnQucHJlZCArPSBkaWZmOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlY29kZURDU3VjY2Vzc2l2ZShjb21wb25lbnQsIGJsb2NrT2Zmc2V0KSB7CiAgICAgIGNvbXBvbmVudC5ibG9ja0RhdGFbYmxvY2tPZmZzZXRdIHw9IHJlYWRCaXQoKSA8PCBzdWNjZXNzaXZlOwogICAgfQoKICAgIHZhciBlb2JydW4gPSAwOwoKICAgIGZ1bmN0aW9uIGRlY29kZUFDRmlyc3QoY29tcG9uZW50LCBibG9ja09mZnNldCkgewogICAgICBpZiAoZW9icnVuID4gMCkgewogICAgICAgIGVvYnJ1bi0tOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGsgPSBzcGVjdHJhbFN0YXJ0LAogICAgICAgICAgZSA9IHNwZWN0cmFsRW5kOwoKICAgICAgd2hpbGUgKGsgPD0gZSkgewogICAgICAgIHZhciBycyA9IGRlY29kZUh1ZmZtYW4oY29tcG9uZW50Lmh1ZmZtYW5UYWJsZUFDKTsKICAgICAgICB2YXIgcyA9IHJzICYgMTUsCiAgICAgICAgICAgIHIgPSBycyA+PiA0OwoKICAgICAgICBpZiAocyA9PT0gMCkgewogICAgICAgICAgaWYgKHIgPCAxNSkgewogICAgICAgICAgICBlb2JydW4gPSByZWNlaXZlKHIpICsgKDEgPDwgcikgLSAxOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBrICs9IDE2OwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBrICs9IHI7CiAgICAgICAgdmFyIHogPSBkY3RaaWdaYWdba107CiAgICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtibG9ja09mZnNldCArIHpdID0gcmVjZWl2ZUFuZEV4dGVuZChzKSAqICgxIDw8IHN1Y2Nlc3NpdmUpOwogICAgICAgIGsrKzsKICAgICAgfQogICAgfQoKICAgIHZhciBzdWNjZXNzaXZlQUNTdGF0ZSA9IDAsCiAgICAgICAgc3VjY2Vzc2l2ZUFDTmV4dFZhbHVlOwoKICAgIGZ1bmN0aW9uIGRlY29kZUFDU3VjY2Vzc2l2ZShjb21wb25lbnQsIGJsb2NrT2Zmc2V0KSB7CiAgICAgIHZhciBrID0gc3BlY3RyYWxTdGFydDsKICAgICAgdmFyIGUgPSBzcGVjdHJhbEVuZDsKICAgICAgdmFyIHIgPSAwOwogICAgICB2YXIgczsKICAgICAgdmFyIHJzOwoKICAgICAgd2hpbGUgKGsgPD0gZSkgewogICAgICAgIHZhciBvZmZzZXRaID0gYmxvY2tPZmZzZXQgKyBkY3RaaWdaYWdba107CiAgICAgICAgdmFyIHNpZ24gPSBjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdIDwgMCA/IC0xIDogMTsKCiAgICAgICAgc3dpdGNoIChzdWNjZXNzaXZlQUNTdGF0ZSkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBycyA9IGRlY29kZUh1ZmZtYW4oY29tcG9uZW50Lmh1ZmZtYW5UYWJsZUFDKTsKICAgICAgICAgICAgcyA9IHJzICYgMTU7CiAgICAgICAgICAgIHIgPSBycyA+PiA0OwoKICAgICAgICAgICAgaWYgKHMgPT09IDApIHsKICAgICAgICAgICAgICBpZiAociA8IDE1KSB7CiAgICAgICAgICAgICAgICBlb2JydW4gPSByZWNlaXZlKHIpICsgKDEgPDwgcik7CiAgICAgICAgICAgICAgICBzdWNjZXNzaXZlQUNTdGF0ZSA9IDQ7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHIgPSAxNjsKICAgICAgICAgICAgICAgIHN1Y2Nlc3NpdmVBQ1N0YXRlID0gMTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaWYgKHMgIT09IDEpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBKcGVnRXJyb3IoImludmFsaWQgQUNuIGVuY29kaW5nIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdWNjZXNzaXZlQUNOZXh0VmFsdWUgPSByZWNlaXZlQW5kRXh0ZW5kKHMpOwogICAgICAgICAgICAgIHN1Y2Nlc3NpdmVBQ1N0YXRlID0gciA/IDIgOiAzOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGlmIChjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdKSB7CiAgICAgICAgICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSArPSBzaWduICogKHJlYWRCaXQoKSA8PCBzdWNjZXNzaXZlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByLS07CgogICAgICAgICAgICAgIGlmIChyID09PSAwKSB7CiAgICAgICAgICAgICAgICBzdWNjZXNzaXZlQUNTdGF0ZSA9IHN1Y2Nlc3NpdmVBQ1N0YXRlID09PSAyID8gMyA6IDA7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGlmIChjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdKSB7CiAgICAgICAgICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSArPSBzaWduICogKHJlYWRCaXQoKSA8PCBzdWNjZXNzaXZlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdID0gc3VjY2Vzc2l2ZUFDTmV4dFZhbHVlIDw8IHN1Y2Nlc3NpdmU7CiAgICAgICAgICAgICAgc3VjY2Vzc2l2ZUFDU3RhdGUgPSAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGlmIChjb21wb25lbnQuYmxvY2tEYXRhW29mZnNldFpdKSB7CiAgICAgICAgICAgICAgY29tcG9uZW50LmJsb2NrRGF0YVtvZmZzZXRaXSArPSBzaWduICogKHJlYWRCaXQoKSA8PCBzdWNjZXNzaXZlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBrKys7CiAgICAgIH0KCiAgICAgIGlmIChzdWNjZXNzaXZlQUNTdGF0ZSA9PT0gNCkgewogICAgICAgIGVvYnJ1bi0tOwoKICAgICAgICBpZiAoZW9icnVuID09PSAwKSB7CiAgICAgICAgICBzdWNjZXNzaXZlQUNTdGF0ZSA9IDA7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdmFyIGJsb2NrUm93ID0gMDsKCiAgICBmdW5jdGlvbiBkZWNvZGVNY3UoY29tcG9uZW50LCBkZWNvZGUsIG1jdSwgcm93LCBjb2wpIHsKICAgICAgdmFyIG1jdVJvdyA9IG1jdSAvIG1jdXNQZXJMaW5lIHwgMDsKICAgICAgdmFyIG1jdUNvbCA9IG1jdSAlIG1jdXNQZXJMaW5lOwogICAgICBibG9ja1JvdyA9IG1jdVJvdyAqIGNvbXBvbmVudC52ICsgcm93OwogICAgICB2YXIgYmxvY2tDb2wgPSBtY3VDb2wgKiBjb21wb25lbnQuaCArIGNvbDsKICAgICAgdmFyIGJsb2NrT2Zmc2V0ID0gZ2V0QmxvY2tCdWZmZXJPZmZzZXQoY29tcG9uZW50LCBibG9ja1JvdywgYmxvY2tDb2wpOwogICAgICBkZWNvZGUoY29tcG9uZW50LCBibG9ja09mZnNldCk7CiAgICB9CgogICAgZnVuY3Rpb24gZGVjb2RlQmxvY2soY29tcG9uZW50LCBkZWNvZGUsIG1jdSkgewogICAgICBibG9ja1JvdyA9IG1jdSAvIGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lIHwgMDsKICAgICAgdmFyIGJsb2NrQ29sID0gbWN1ICUgY29tcG9uZW50LmJsb2Nrc1BlckxpbmU7CiAgICAgIHZhciBibG9ja09mZnNldCA9IGdldEJsb2NrQnVmZmVyT2Zmc2V0KGNvbXBvbmVudCwgYmxvY2tSb3csIGJsb2NrQ29sKTsKICAgICAgZGVjb2RlKGNvbXBvbmVudCwgYmxvY2tPZmZzZXQpOwogICAgfQoKICAgIHZhciBjb21wb25lbnRzTGVuZ3RoID0gY29tcG9uZW50cy5sZW5ndGg7CiAgICB2YXIgY29tcG9uZW50LCBpLCBqLCBrLCBuOwogICAgdmFyIGRlY29kZUZuOwoKICAgIGlmIChwcm9ncmVzc2l2ZSkgewogICAgICBpZiAoc3BlY3RyYWxTdGFydCA9PT0gMCkgewogICAgICAgIGRlY29kZUZuID0gc3VjY2Vzc2l2ZVByZXYgPT09IDAgPyBkZWNvZGVEQ0ZpcnN0IDogZGVjb2RlRENTdWNjZXNzaXZlOwogICAgICB9IGVsc2UgewogICAgICAgIGRlY29kZUZuID0gc3VjY2Vzc2l2ZVByZXYgPT09IDAgPyBkZWNvZGVBQ0ZpcnN0IDogZGVjb2RlQUNTdWNjZXNzaXZlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBkZWNvZGVGbiA9IGRlY29kZUJhc2VsaW5lOwogICAgfQoKICAgIHZhciBtY3UgPSAwLAogICAgICAgIGZpbGVNYXJrZXI7CiAgICB2YXIgbWN1RXhwZWN0ZWQ7CgogICAgaWYgKGNvbXBvbmVudHNMZW5ndGggPT09IDEpIHsKICAgICAgbWN1RXhwZWN0ZWQgPSBjb21wb25lbnRzWzBdLmJsb2Nrc1BlckxpbmUgKiBjb21wb25lbnRzWzBdLmJsb2Nrc1BlckNvbHVtbjsKICAgIH0gZWxzZSB7CiAgICAgIG1jdUV4cGVjdGVkID0gbWN1c1BlckxpbmUgKiBmcmFtZS5tY3VzUGVyQ29sdW1uOwogICAgfQoKICAgIHZhciBoLCB2OwoKICAgIHdoaWxlIChtY3UgPD0gbWN1RXhwZWN0ZWQpIHsKICAgICAgdmFyIG1jdVRvUmVhZCA9IHJlc2V0SW50ZXJ2YWwgPyBNYXRoLm1pbihtY3VFeHBlY3RlZCAtIG1jdSwgcmVzZXRJbnRlcnZhbCkgOiBtY3VFeHBlY3RlZDsKCiAgICAgIGlmIChtY3VUb1JlYWQgPiAwKSB7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbXBvbmVudHNMZW5ndGg7IGkrKykgewogICAgICAgICAgY29tcG9uZW50c1tpXS5wcmVkID0gMDsKICAgICAgICB9CgogICAgICAgIGVvYnJ1biA9IDA7CgogICAgICAgIGlmIChjb21wb25lbnRzTGVuZ3RoID09PSAxKSB7CiAgICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnRzWzBdOwoKICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBtY3VUb1JlYWQ7IG4rKykgewogICAgICAgICAgICBkZWNvZGVCbG9jayhjb21wb25lbnQsIGRlY29kZUZuLCBtY3UpOwogICAgICAgICAgICBtY3UrKzsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZm9yIChuID0gMDsgbiA8IG1jdVRvUmVhZDsgbisrKSB7CiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb21wb25lbnRzTGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnRzW2ldOwogICAgICAgICAgICAgIGggPSBjb21wb25lbnQuaDsKICAgICAgICAgICAgICB2ID0gY29tcG9uZW50LnY7CgogICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCB2OyBqKyspIHsKICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBoOyBrKyspIHsKICAgICAgICAgICAgICAgICAgZGVjb2RlTWN1KGNvbXBvbmVudCwgZGVjb2RlRm4sIG1jdSwgaiwgayk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBtY3UrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGJpdHNDb3VudCA9IDA7CiAgICAgIGZpbGVNYXJrZXIgPSBmaW5kTmV4dEZpbGVNYXJrZXIoZGF0YSwgb2Zmc2V0KTsKCiAgICAgIGlmICghZmlsZU1hcmtlcikgewogICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBpZiAoZmlsZU1hcmtlci5pbnZhbGlkKSB7CiAgICAgICAgdmFyIHBhcnRpYWxNc2cgPSBtY3VUb1JlYWQgPiAwID8gInVuZXhwZWN0ZWQiIDogImV4Y2Vzc2l2ZSI7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJkZWNvZGVTY2FuIC0gIi5jb25jYXQocGFydGlhbE1zZywgIiBNQ1UgZGF0YSwgY3VycmVudCBtYXJrZXIgaXM6ICIpLmNvbmNhdChmaWxlTWFya2VyLmludmFsaWQpKTsKICAgICAgICBvZmZzZXQgPSBmaWxlTWFya2VyLm9mZnNldDsKICAgICAgfQoKICAgICAgaWYgKGZpbGVNYXJrZXIubWFya2VyID49IDB4ZmZkMCAmJiBmaWxlTWFya2VyLm1hcmtlciA8PSAweGZmZDcpIHsKICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgfSBlbHNlIHsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBvZmZzZXQgLSBzdGFydE9mZnNldDsKICB9CgogIGZ1bmN0aW9uIHF1YW50aXplQW5kSW52ZXJzZShjb21wb25lbnQsIGJsb2NrQnVmZmVyT2Zmc2V0LCBwKSB7CiAgICB2YXIgcXQgPSBjb21wb25lbnQucXVhbnRpemF0aW9uVGFibGUsCiAgICAgICAgYmxvY2tEYXRhID0gY29tcG9uZW50LmJsb2NrRGF0YTsKICAgIHZhciB2MCwgdjEsIHYyLCB2MywgdjQsIHY1LCB2Niwgdjc7CiAgICB2YXIgcDAsIHAxLCBwMiwgcDMsIHA0LCBwNSwgcDYsIHA3OwogICAgdmFyIHQ7CgogICAgaWYgKCFxdCkgewogICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJtaXNzaW5nIHJlcXVpcmVkIFF1YW50aXphdGlvbiBUYWJsZS4iKTsKICAgIH0KCiAgICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCA2NDsgcm93ICs9IDgpIHsKICAgICAgcDAgPSBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyByb3ddOwogICAgICBwMSA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDFdOwogICAgICBwMiA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDJdOwogICAgICBwMyA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDNdOwogICAgICBwNCA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDRdOwogICAgICBwNSA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDVdOwogICAgICBwNiA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDZdOwogICAgICBwNyA9IGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIHJvdyArIDddOwogICAgICBwMCAqPSBxdFtyb3ddOwoKICAgICAgaWYgKChwMSB8IHAyIHwgcDMgfCBwNCB8IHA1IHwgcDYgfCBwNykgPT09IDApIHsKICAgICAgICB0ID0gZGN0U3FydDIgKiBwMCArIDUxMiA+PiAxMDsKICAgICAgICBwW3Jvd10gPSB0OwogICAgICAgIHBbcm93ICsgMV0gPSB0OwogICAgICAgIHBbcm93ICsgMl0gPSB0OwogICAgICAgIHBbcm93ICsgM10gPSB0OwogICAgICAgIHBbcm93ICsgNF0gPSB0OwogICAgICAgIHBbcm93ICsgNV0gPSB0OwogICAgICAgIHBbcm93ICsgNl0gPSB0OwogICAgICAgIHBbcm93ICsgN10gPSB0OwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBwMSAqPSBxdFtyb3cgKyAxXTsKICAgICAgcDIgKj0gcXRbcm93ICsgMl07CiAgICAgIHAzICo9IHF0W3JvdyArIDNdOwogICAgICBwNCAqPSBxdFtyb3cgKyA0XTsKICAgICAgcDUgKj0gcXRbcm93ICsgNV07CiAgICAgIHA2ICo9IHF0W3JvdyArIDZdOwogICAgICBwNyAqPSBxdFtyb3cgKyA3XTsKICAgICAgdjAgPSBkY3RTcXJ0MiAqIHAwICsgMTI4ID4+IDg7CiAgICAgIHYxID0gZGN0U3FydDIgKiBwNCArIDEyOCA+PiA4OwogICAgICB2MiA9IHAyOwogICAgICB2MyA9IHA2OwogICAgICB2NCA9IGRjdFNxcnQxZDIgKiAocDEgLSBwNykgKyAxMjggPj4gODsKICAgICAgdjcgPSBkY3RTcXJ0MWQyICogKHAxICsgcDcpICsgMTI4ID4+IDg7CiAgICAgIHY1ID0gcDMgPDwgNDsKICAgICAgdjYgPSBwNSA8PCA0OwogICAgICB2MCA9IHYwICsgdjEgKyAxID4+IDE7CiAgICAgIHYxID0gdjAgLSB2MTsKICAgICAgdCA9IHYyICogZGN0U2luNiArIHYzICogZGN0Q29zNiArIDEyOCA+PiA4OwogICAgICB2MiA9IHYyICogZGN0Q29zNiAtIHYzICogZGN0U2luNiArIDEyOCA+PiA4OwogICAgICB2MyA9IHQ7CiAgICAgIHY0ID0gdjQgKyB2NiArIDEgPj4gMTsKICAgICAgdjYgPSB2NCAtIHY2OwogICAgICB2NyA9IHY3ICsgdjUgKyAxID4+IDE7CiAgICAgIHY1ID0gdjcgLSB2NTsKICAgICAgdjAgPSB2MCArIHYzICsgMSA+PiAxOwogICAgICB2MyA9IHYwIC0gdjM7CiAgICAgIHYxID0gdjEgKyB2MiArIDEgPj4gMTsKICAgICAgdjIgPSB2MSAtIHYyOwogICAgICB0ID0gdjQgKiBkY3RTaW4zICsgdjcgKiBkY3RDb3MzICsgMjA0OCA+PiAxMjsKICAgICAgdjQgPSB2NCAqIGRjdENvczMgLSB2NyAqIGRjdFNpbjMgKyAyMDQ4ID4+IDEyOwogICAgICB2NyA9IHQ7CiAgICAgIHQgPSB2NSAqIGRjdFNpbjEgKyB2NiAqIGRjdENvczEgKyAyMDQ4ID4+IDEyOwogICAgICB2NSA9IHY1ICogZGN0Q29zMSAtIHY2ICogZGN0U2luMSArIDIwNDggPj4gMTI7CiAgICAgIHY2ID0gdDsKICAgICAgcFtyb3ddID0gdjAgKyB2NzsKICAgICAgcFtyb3cgKyA3XSA9IHYwIC0gdjc7CiAgICAgIHBbcm93ICsgMV0gPSB2MSArIHY2OwogICAgICBwW3JvdyArIDZdID0gdjEgLSB2NjsKICAgICAgcFtyb3cgKyAyXSA9IHYyICsgdjU7CiAgICAgIHBbcm93ICsgNV0gPSB2MiAtIHY1OwogICAgICBwW3JvdyArIDNdID0gdjMgKyB2NDsKICAgICAgcFtyb3cgKyA0XSA9IHYzIC0gdjQ7CiAgICB9CgogICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgODsgKytjb2wpIHsKICAgICAgcDAgPSBwW2NvbF07CiAgICAgIHAxID0gcFtjb2wgKyA4XTsKICAgICAgcDIgPSBwW2NvbCArIDE2XTsKICAgICAgcDMgPSBwW2NvbCArIDI0XTsKICAgICAgcDQgPSBwW2NvbCArIDMyXTsKICAgICAgcDUgPSBwW2NvbCArIDQwXTsKICAgICAgcDYgPSBwW2NvbCArIDQ4XTsKICAgICAgcDcgPSBwW2NvbCArIDU2XTsKCiAgICAgIGlmICgocDEgfCBwMiB8IHAzIHwgcDQgfCBwNSB8IHA2IHwgcDcpID09PSAwKSB7CiAgICAgICAgdCA9IGRjdFNxcnQyICogcDAgKyA4MTkyID4+IDE0OwoKICAgICAgICBpZiAodCA8IC0yMDQwKSB7CiAgICAgICAgICB0ID0gMDsKICAgICAgICB9IGVsc2UgaWYgKHQgPj0gMjAyNCkgewogICAgICAgICAgdCA9IDI1NTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdCA9IHQgKyAyMDU2ID4+IDQ7CiAgICAgICAgfQoKICAgICAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2xdID0gdDsKICAgICAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyA4XSA9IHQ7CiAgICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgMTZdID0gdDsKICAgICAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyAyNF0gPSB0OwogICAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDMyXSA9IHQ7CiAgICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgNDBdID0gdDsKICAgICAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyA0OF0gPSB0OwogICAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDU2XSA9IHQ7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHYwID0gZGN0U3FydDIgKiBwMCArIDIwNDggPj4gMTI7CiAgICAgIHYxID0gZGN0U3FydDIgKiBwNCArIDIwNDggPj4gMTI7CiAgICAgIHYyID0gcDI7CiAgICAgIHYzID0gcDY7CiAgICAgIHY0ID0gZGN0U3FydDFkMiAqIChwMSAtIHA3KSArIDIwNDggPj4gMTI7CiAgICAgIHY3ID0gZGN0U3FydDFkMiAqIChwMSArIHA3KSArIDIwNDggPj4gMTI7CiAgICAgIHY1ID0gcDM7CiAgICAgIHY2ID0gcDU7CiAgICAgIHYwID0gKHYwICsgdjEgKyAxID4+IDEpICsgNDExMjsKICAgICAgdjEgPSB2MCAtIHYxOwogICAgICB0ID0gdjIgKiBkY3RTaW42ICsgdjMgKiBkY3RDb3M2ICsgMjA0OCA+PiAxMjsKICAgICAgdjIgPSB2MiAqIGRjdENvczYgLSB2MyAqIGRjdFNpbjYgKyAyMDQ4ID4+IDEyOwogICAgICB2MyA9IHQ7CiAgICAgIHY0ID0gdjQgKyB2NiArIDEgPj4gMTsKICAgICAgdjYgPSB2NCAtIHY2OwogICAgICB2NyA9IHY3ICsgdjUgKyAxID4+IDE7CiAgICAgIHY1ID0gdjcgLSB2NTsKICAgICAgdjAgPSB2MCArIHYzICsgMSA+PiAxOwogICAgICB2MyA9IHYwIC0gdjM7CiAgICAgIHYxID0gdjEgKyB2MiArIDEgPj4gMTsKICAgICAgdjIgPSB2MSAtIHYyOwogICAgICB0ID0gdjQgKiBkY3RTaW4zICsgdjcgKiBkY3RDb3MzICsgMjA0OCA+PiAxMjsKICAgICAgdjQgPSB2NCAqIGRjdENvczMgLSB2NyAqIGRjdFNpbjMgKyAyMDQ4ID4+IDEyOwogICAgICB2NyA9IHQ7CiAgICAgIHQgPSB2NSAqIGRjdFNpbjEgKyB2NiAqIGRjdENvczEgKyAyMDQ4ID4+IDEyOwogICAgICB2NSA9IHY1ICogZGN0Q29zMSAtIHY2ICogZGN0U2luMSArIDIwNDggPj4gMTI7CiAgICAgIHY2ID0gdDsKICAgICAgcDAgPSB2MCArIHY3OwogICAgICBwNyA9IHYwIC0gdjc7CiAgICAgIHAxID0gdjEgKyB2NjsKICAgICAgcDYgPSB2MSAtIHY2OwogICAgICBwMiA9IHYyICsgdjU7CiAgICAgIHA1ID0gdjIgLSB2NTsKICAgICAgcDMgPSB2MyArIHY0OwogICAgICBwNCA9IHYzIC0gdjQ7CgogICAgICBpZiAocDAgPCAxNikgewogICAgICAgIHAwID0gMDsKICAgICAgfSBlbHNlIGlmIChwMCA+PSA0MDgwKSB7CiAgICAgICAgcDAgPSAyNTU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcDAgPj49IDQ7CiAgICAgIH0KCiAgICAgIGlmIChwMSA8IDE2KSB7CiAgICAgICAgcDEgPSAwOwogICAgICB9IGVsc2UgaWYgKHAxID49IDQwODApIHsKICAgICAgICBwMSA9IDI1NTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwMSA+Pj0gNDsKICAgICAgfQoKICAgICAgaWYgKHAyIDwgMTYpIHsKICAgICAgICBwMiA9IDA7CiAgICAgIH0gZWxzZSBpZiAocDIgPj0gNDA4MCkgewogICAgICAgIHAyID0gMjU1OwogICAgICB9IGVsc2UgewogICAgICAgIHAyID4+PSA0OwogICAgICB9CgogICAgICBpZiAocDMgPCAxNikgewogICAgICAgIHAzID0gMDsKICAgICAgfSBlbHNlIGlmIChwMyA+PSA0MDgwKSB7CiAgICAgICAgcDMgPSAyNTU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcDMgPj49IDQ7CiAgICAgIH0KCiAgICAgIGlmIChwNCA8IDE2KSB7CiAgICAgICAgcDQgPSAwOwogICAgICB9IGVsc2UgaWYgKHA0ID49IDQwODApIHsKICAgICAgICBwNCA9IDI1NTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwNCA+Pj0gNDsKICAgICAgfQoKICAgICAgaWYgKHA1IDwgMTYpIHsKICAgICAgICBwNSA9IDA7CiAgICAgIH0gZWxzZSBpZiAocDUgPj0gNDA4MCkgewogICAgICAgIHA1ID0gMjU1OwogICAgICB9IGVsc2UgewogICAgICAgIHA1ID4+PSA0OwogICAgICB9CgogICAgICBpZiAocDYgPCAxNikgewogICAgICAgIHA2ID0gMDsKICAgICAgfSBlbHNlIGlmIChwNiA+PSA0MDgwKSB7CiAgICAgICAgcDYgPSAyNTU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcDYgPj49IDQ7CiAgICAgIH0KCiAgICAgIGlmIChwNyA8IDE2KSB7CiAgICAgICAgcDcgPSAwOwogICAgICB9IGVsc2UgaWYgKHA3ID49IDQwODApIHsKICAgICAgICBwNyA9IDI1NTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwNyA+Pj0gNDsKICAgICAgfQoKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sXSA9IHAwOwogICAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyA4XSA9IHAxOwogICAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyAxNl0gPSBwMjsKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgMjRdID0gcDM7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDMyXSA9IHA0OwogICAgICBibG9ja0RhdGFbYmxvY2tCdWZmZXJPZmZzZXQgKyBjb2wgKyA0MF0gPSBwNTsKICAgICAgYmxvY2tEYXRhW2Jsb2NrQnVmZmVyT2Zmc2V0ICsgY29sICsgNDhdID0gcDY7CiAgICAgIGJsb2NrRGF0YVtibG9ja0J1ZmZlck9mZnNldCArIGNvbCArIDU2XSA9IHA3OwogICAgfQogIH0KCiAgZnVuY3Rpb24gYnVpbGRDb21wb25lbnREYXRhKGZyYW1lLCBjb21wb25lbnQpIHsKICAgIHZhciBibG9ja3NQZXJMaW5lID0gY29tcG9uZW50LmJsb2Nrc1BlckxpbmU7CiAgICB2YXIgYmxvY2tzUGVyQ29sdW1uID0gY29tcG9uZW50LmJsb2Nrc1BlckNvbHVtbjsKICAgIHZhciBjb21wdXRhdGlvbkJ1ZmZlciA9IG5ldyBJbnQxNkFycmF5KDY0KTsKCiAgICBmb3IgKHZhciBibG9ja1JvdyA9IDA7IGJsb2NrUm93IDwgYmxvY2tzUGVyQ29sdW1uOyBibG9ja1JvdysrKSB7CiAgICAgIGZvciAodmFyIGJsb2NrQ29sID0gMDsgYmxvY2tDb2wgPCBibG9ja3NQZXJMaW5lOyBibG9ja0NvbCsrKSB7CiAgICAgICAgdmFyIG9mZnNldCA9IGdldEJsb2NrQnVmZmVyT2Zmc2V0KGNvbXBvbmVudCwgYmxvY2tSb3csIGJsb2NrQ29sKTsKICAgICAgICBxdWFudGl6ZUFuZEludmVyc2UoY29tcG9uZW50LCBvZmZzZXQsIGNvbXB1dGF0aW9uQnVmZmVyKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBjb21wb25lbnQuYmxvY2tEYXRhOwogIH0KCiAgZnVuY3Rpb24gZmluZE5leHRGaWxlTWFya2VyKGRhdGEsIGN1cnJlbnRQb3MpIHsKICAgIHZhciBzdGFydFBvcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogY3VycmVudFBvczsKICAgIHZhciBtYXhQb3MgPSBkYXRhLmxlbmd0aCAtIDE7CiAgICB2YXIgbmV3UG9zID0gc3RhcnRQb3MgPCBjdXJyZW50UG9zID8gc3RhcnRQb3MgOiBjdXJyZW50UG9zOwoKICAgIGlmIChjdXJyZW50UG9zID49IG1heFBvcykgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICB2YXIgY3VycmVudE1hcmtlciA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBjdXJyZW50UG9zKTsKCiAgICBpZiAoY3VycmVudE1hcmtlciA+PSAweGZmYzAgJiYgY3VycmVudE1hcmtlciA8PSAweGZmZmUpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBpbnZhbGlkOiBudWxsLAogICAgICAgIG1hcmtlcjogY3VycmVudE1hcmtlciwKICAgICAgICBvZmZzZXQ6IGN1cnJlbnRQb3MKICAgICAgfTsKICAgIH0KCiAgICB2YXIgbmV3TWFya2VyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG5ld1Bvcyk7CgogICAgd2hpbGUgKCEobmV3TWFya2VyID49IDB4ZmZjMCAmJiBuZXdNYXJrZXIgPD0gMHhmZmZlKSkgewogICAgICBpZiAoKytuZXdQb3MgPj0gbWF4UG9zKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIG5ld01hcmtlciA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBuZXdQb3MpOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGludmFsaWQ6IGN1cnJlbnRNYXJrZXIudG9TdHJpbmcoMTYpLAogICAgICBtYXJrZXI6IG5ld01hcmtlciwKICAgICAgb2Zmc2V0OiBuZXdQb3MKICAgIH07CiAgfQoKICBKcGVnSW1hZ2UucHJvdG90eXBlID0gewogICAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlKGRhdGEpIHsKICAgICAgdmFyIF9yZWYyID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fSwKICAgICAgICAgIF9yZWYyJGRubFNjYW5MaW5lcyA9IF9yZWYyLmRubFNjYW5MaW5lcywKICAgICAgICAgIGRubFNjYW5MaW5lcyA9IF9yZWYyJGRubFNjYW5MaW5lcyA9PT0gdm9pZCAwID8gbnVsbCA6IF9yZWYyJGRubFNjYW5MaW5lczsKCiAgICAgIGZ1bmN0aW9uIHJlYWREYXRhQmxvY2soKSB7CiAgICAgICAgdmFyIGxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICAgIG9mZnNldCArPSAyOwogICAgICAgIHZhciBlbmRPZmZzZXQgPSBvZmZzZXQgKyBsZW5ndGggLSAyOwogICAgICAgIHZhciBmaWxlTWFya2VyID0gZmluZE5leHRGaWxlTWFya2VyKGRhdGEsIGVuZE9mZnNldCwgb2Zmc2V0KTsKCiAgICAgICAgaWYgKGZpbGVNYXJrZXIgJiYgZmlsZU1hcmtlci5pbnZhbGlkKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoInJlYWREYXRhQmxvY2sgLSBpbmNvcnJlY3QgbGVuZ3RoLCBjdXJyZW50IG1hcmtlciBpczogIiArIGZpbGVNYXJrZXIuaW52YWxpZCk7CiAgICAgICAgICBlbmRPZmZzZXQgPSBmaWxlTWFya2VyLm9mZnNldDsKICAgICAgICB9CgogICAgICAgIHZhciBhcnJheSA9IGRhdGEuc3ViYXJyYXkob2Zmc2V0LCBlbmRPZmZzZXQpOwogICAgICAgIG9mZnNldCArPSBhcnJheS5sZW5ndGg7CiAgICAgICAgcmV0dXJuIGFycmF5OwogICAgICB9CgogICAgICBmdW5jdGlvbiBwcmVwYXJlQ29tcG9uZW50cyhmcmFtZSkgewogICAgICAgIHZhciBtY3VzUGVyTGluZSA9IE1hdGguY2VpbChmcmFtZS5zYW1wbGVzUGVyTGluZSAvIDggLyBmcmFtZS5tYXhIKTsKICAgICAgICB2YXIgbWN1c1BlckNvbHVtbiA9IE1hdGguY2VpbChmcmFtZS5zY2FuTGluZXMgLyA4IC8gZnJhbWUubWF4Vik7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnJhbWUuY29tcG9uZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29tcG9uZW50ID0gZnJhbWUuY29tcG9uZW50c1tpXTsKICAgICAgICAgIHZhciBibG9ja3NQZXJMaW5lID0gTWF0aC5jZWlsKE1hdGguY2VpbChmcmFtZS5zYW1wbGVzUGVyTGluZSAvIDgpICogY29tcG9uZW50LmggLyBmcmFtZS5tYXhIKTsKICAgICAgICAgIHZhciBibG9ja3NQZXJDb2x1bW4gPSBNYXRoLmNlaWwoTWF0aC5jZWlsKGZyYW1lLnNjYW5MaW5lcyAvIDgpICogY29tcG9uZW50LnYgLyBmcmFtZS5tYXhWKTsKICAgICAgICAgIHZhciBibG9ja3NQZXJMaW5lRm9yTWN1ID0gbWN1c1BlckxpbmUgKiBjb21wb25lbnQuaDsKICAgICAgICAgIHZhciBibG9ja3NQZXJDb2x1bW5Gb3JNY3UgPSBtY3VzUGVyQ29sdW1uICogY29tcG9uZW50LnY7CiAgICAgICAgICB2YXIgYmxvY2tzQnVmZmVyU2l6ZSA9IDY0ICogYmxvY2tzUGVyQ29sdW1uRm9yTWN1ICogKGJsb2Nrc1BlckxpbmVGb3JNY3UgKyAxKTsKICAgICAgICAgIGNvbXBvbmVudC5ibG9ja0RhdGEgPSBuZXcgSW50MTZBcnJheShibG9ja3NCdWZmZXJTaXplKTsKICAgICAgICAgIGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lID0gYmxvY2tzUGVyTGluZTsKICAgICAgICAgIGNvbXBvbmVudC5ibG9ja3NQZXJDb2x1bW4gPSBibG9ja3NQZXJDb2x1bW47CiAgICAgICAgfQoKICAgICAgICBmcmFtZS5tY3VzUGVyTGluZSA9IG1jdXNQZXJMaW5lOwogICAgICAgIGZyYW1lLm1jdXNQZXJDb2x1bW4gPSBtY3VzUGVyQ29sdW1uOwogICAgICB9CgogICAgICB2YXIgb2Zmc2V0ID0gMDsKICAgICAgdmFyIGpmaWYgPSBudWxsOwogICAgICB2YXIgYWRvYmUgPSBudWxsOwogICAgICB2YXIgZnJhbWUsIHJlc2V0SW50ZXJ2YWw7CiAgICAgIHZhciBudW1TT1NNYXJrZXJzID0gMDsKICAgICAgdmFyIHF1YW50aXphdGlvblRhYmxlcyA9IFtdOwogICAgICB2YXIgaHVmZm1hblRhYmxlc0FDID0gW10sCiAgICAgICAgICBodWZmbWFuVGFibGVzREMgPSBbXTsKICAgICAgdmFyIGZpbGVNYXJrZXIgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgb2Zmc2V0ICs9IDI7CgogICAgICBpZiAoZmlsZU1hcmtlciAhPT0gMHhmZmQ4KSB7CiAgICAgICAgdGhyb3cgbmV3IEpwZWdFcnJvcigiU09JIG5vdCBmb3VuZCIpOwogICAgICB9CgogICAgICBmaWxlTWFya2VyID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgIG9mZnNldCArPSAyOwoKICAgICAgbWFya2VyTG9vcDogd2hpbGUgKGZpbGVNYXJrZXIgIT09IDB4ZmZkOSkgewogICAgICAgIHZhciBpLCBqLCBsOwoKICAgICAgICBzd2l0Y2ggKGZpbGVNYXJrZXIpIHsKICAgICAgICAgIGNhc2UgMHhmZmUwOgogICAgICAgICAgY2FzZSAweGZmZTE6CiAgICAgICAgICBjYXNlIDB4ZmZlMjoKICAgICAgICAgIGNhc2UgMHhmZmUzOgogICAgICAgICAgY2FzZSAweGZmZTQ6CiAgICAgICAgICBjYXNlIDB4ZmZlNToKICAgICAgICAgIGNhc2UgMHhmZmU2OgogICAgICAgICAgY2FzZSAweGZmZTc6CiAgICAgICAgICBjYXNlIDB4ZmZlODoKICAgICAgICAgIGNhc2UgMHhmZmU5OgogICAgICAgICAgY2FzZSAweGZmZWE6CiAgICAgICAgICBjYXNlIDB4ZmZlYjoKICAgICAgICAgIGNhc2UgMHhmZmVjOgogICAgICAgICAgY2FzZSAweGZmZWQ6CiAgICAgICAgICBjYXNlIDB4ZmZlZToKICAgICAgICAgIGNhc2UgMHhmZmVmOgogICAgICAgICAgY2FzZSAweGZmZmU6CiAgICAgICAgICAgIHZhciBhcHBEYXRhID0gcmVhZERhdGFCbG9jaygpOwoKICAgICAgICAgICAgaWYgKGZpbGVNYXJrZXIgPT09IDB4ZmZlMCkgewogICAgICAgICAgICAgIGlmIChhcHBEYXRhWzBdID09PSAweDRhICYmIGFwcERhdGFbMV0gPT09IDB4NDYgJiYgYXBwRGF0YVsyXSA9PT0gMHg0OSAmJiBhcHBEYXRhWzNdID09PSAweDQ2ICYmIGFwcERhdGFbNF0gPT09IDApIHsKICAgICAgICAgICAgICAgIGpmaWYgPSB7CiAgICAgICAgICAgICAgICAgIHZlcnNpb246IHsKICAgICAgICAgICAgICAgICAgICBtYWpvcjogYXBwRGF0YVs1XSwKICAgICAgICAgICAgICAgICAgICBtaW5vcjogYXBwRGF0YVs2XQogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBkZW5zaXR5VW5pdHM6IGFwcERhdGFbN10sCiAgICAgICAgICAgICAgICAgIHhEZW5zaXR5OiBhcHBEYXRhWzhdIDw8IDggfCBhcHBEYXRhWzldLAogICAgICAgICAgICAgICAgICB5RGVuc2l0eTogYXBwRGF0YVsxMF0gPDwgOCB8IGFwcERhdGFbMTFdLAogICAgICAgICAgICAgICAgICB0aHVtYldpZHRoOiBhcHBEYXRhWzEyXSwKICAgICAgICAgICAgICAgICAgdGh1bWJIZWlnaHQ6IGFwcERhdGFbMTNdLAogICAgICAgICAgICAgICAgICB0aHVtYkRhdGE6IGFwcERhdGEuc3ViYXJyYXkoMTQsIDE0ICsgMyAqIGFwcERhdGFbMTJdICogYXBwRGF0YVsxM10pCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGZpbGVNYXJrZXIgPT09IDB4ZmZlZSkgewogICAgICAgICAgICAgIGlmIChhcHBEYXRhWzBdID09PSAweDQxICYmIGFwcERhdGFbMV0gPT09IDB4NjQgJiYgYXBwRGF0YVsyXSA9PT0gMHg2ZiAmJiBhcHBEYXRhWzNdID09PSAweDYyICYmIGFwcERhdGFbNF0gPT09IDB4NjUpIHsKICAgICAgICAgICAgICAgIGFkb2JlID0gewogICAgICAgICAgICAgICAgICB2ZXJzaW9uOiBhcHBEYXRhWzVdIDw8IDggfCBhcHBEYXRhWzZdLAogICAgICAgICAgICAgICAgICBmbGFnczA6IGFwcERhdGFbN10gPDwgOCB8IGFwcERhdGFbOF0sCiAgICAgICAgICAgICAgICAgIGZsYWdzMTogYXBwRGF0YVs5XSA8PCA4IHwgYXBwRGF0YVsxMF0sCiAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybUNvZGU6IGFwcERhdGFbMTFdCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmZGI6CiAgICAgICAgICAgIHZhciBxdWFudGl6YXRpb25UYWJsZXNMZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICAgIHZhciBxdWFudGl6YXRpb25UYWJsZXNFbmQgPSBxdWFudGl6YXRpb25UYWJsZXNMZW5ndGggKyBvZmZzZXQgLSAyOwogICAgICAgICAgICB2YXIgejsKCiAgICAgICAgICAgIHdoaWxlIChvZmZzZXQgPCBxdWFudGl6YXRpb25UYWJsZXNFbmQpIHsKICAgICAgICAgICAgICB2YXIgcXVhbnRpemF0aW9uVGFibGVTcGVjID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICAgICAgdmFyIHRhYmxlRGF0YSA9IG5ldyBVaW50MTZBcnJheSg2NCk7CgogICAgICAgICAgICAgIGlmIChxdWFudGl6YXRpb25UYWJsZVNwZWMgPj4gNCA9PT0gMCkgewogICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IDY0OyBqKyspIHsKICAgICAgICAgICAgICAgICAgeiA9IGRjdFppZ1phZ1tqXTsKICAgICAgICAgICAgICAgICAgdGFibGVEYXRhW3pdID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChxdWFudGl6YXRpb25UYWJsZVNwZWMgPj4gNCA9PT0gMSkgewogICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IDY0OyBqKyspIHsKICAgICAgICAgICAgICAgICAgeiA9IGRjdFppZ1phZ1tqXTsKICAgICAgICAgICAgICAgICAgdGFibGVEYXRhW3pdID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgICAgICAgICAgICAgIG9mZnNldCArPSAyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJEUVQgLSBpbnZhbGlkIHRhYmxlIHNwZWMiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHF1YW50aXphdGlvblRhYmxlc1txdWFudGl6YXRpb25UYWJsZVNwZWMgJiAxNV0gPSB0YWJsZURhdGE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhmZmMwOgogICAgICAgICAgY2FzZSAweGZmYzE6CiAgICAgICAgICBjYXNlIDB4ZmZjMjoKICAgICAgICAgICAgaWYgKGZyYW1lKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEpwZWdFcnJvcigiT25seSBzaW5nbGUgZnJhbWUgSlBFR3Mgc3VwcG9ydGVkIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG9mZnNldCArPSAyOwogICAgICAgICAgICBmcmFtZSA9IHt9OwogICAgICAgICAgICBmcmFtZS5leHRlbmRlZCA9IGZpbGVNYXJrZXIgPT09IDB4ZmZjMTsKICAgICAgICAgICAgZnJhbWUucHJvZ3Jlc3NpdmUgPSBmaWxlTWFya2VyID09PSAweGZmYzI7CiAgICAgICAgICAgIGZyYW1lLnByZWNpc2lvbiA9IGRhdGFbb2Zmc2V0KytdOwogICAgICAgICAgICB2YXIgc29mU2NhbkxpbmVzID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIG9mZnNldCk7CiAgICAgICAgICAgIG9mZnNldCArPSAyOwogICAgICAgICAgICBmcmFtZS5zY2FuTGluZXMgPSBkbmxTY2FuTGluZXMgfHwgc29mU2NhbkxpbmVzOwogICAgICAgICAgICBmcmFtZS5zYW1wbGVzUGVyTGluZSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgICAgICAgZnJhbWUuY29tcG9uZW50cyA9IFtdOwogICAgICAgICAgICBmcmFtZS5jb21wb25lbnRJZHMgPSB7fTsKICAgICAgICAgICAgdmFyIGNvbXBvbmVudHNDb3VudCA9IGRhdGFbb2Zmc2V0KytdLAogICAgICAgICAgICAgICAgY29tcG9uZW50SWQ7CiAgICAgICAgICAgIHZhciBtYXhIID0gMCwKICAgICAgICAgICAgICAgIG1heFYgPSAwOwoKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbXBvbmVudHNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgY29tcG9uZW50SWQgPSBkYXRhW29mZnNldF07CiAgICAgICAgICAgICAgdmFyIGggPSBkYXRhW29mZnNldCArIDFdID4+IDQ7CiAgICAgICAgICAgICAgdmFyIHYgPSBkYXRhW29mZnNldCArIDFdICYgMTU7CgogICAgICAgICAgICAgIGlmIChtYXhIIDwgaCkgewogICAgICAgICAgICAgICAgbWF4SCA9IGg7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAobWF4ViA8IHYpIHsKICAgICAgICAgICAgICAgIG1heFYgPSB2OwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIHFJZCA9IGRhdGFbb2Zmc2V0ICsgMl07CiAgICAgICAgICAgICAgbCA9IGZyYW1lLmNvbXBvbmVudHMucHVzaCh7CiAgICAgICAgICAgICAgICBoOiBoLAogICAgICAgICAgICAgICAgdjogdiwKICAgICAgICAgICAgICAgIHF1YW50aXphdGlvbklkOiBxSWQsCiAgICAgICAgICAgICAgICBxdWFudGl6YXRpb25UYWJsZTogbnVsbAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGZyYW1lLmNvbXBvbmVudElkc1tjb21wb25lbnRJZF0gPSBsIC0gMTsKICAgICAgICAgICAgICBvZmZzZXQgKz0gMzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnJhbWUubWF4SCA9IG1heEg7CiAgICAgICAgICAgIGZyYW1lLm1heFYgPSBtYXhWOwogICAgICAgICAgICBwcmVwYXJlQ29tcG9uZW50cyhmcmFtZSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhmZmM0OgogICAgICAgICAgICB2YXIgaHVmZm1hbkxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBvZmZzZXQpOwogICAgICAgICAgICBvZmZzZXQgKz0gMjsKCiAgICAgICAgICAgIGZvciAoaSA9IDI7IGkgPCBodWZmbWFuTGVuZ3RoOykgewogICAgICAgICAgICAgIHZhciBodWZmbWFuVGFibGVTcGVjID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICAgICAgdmFyIGNvZGVMZW5ndGhzID0gbmV3IFVpbnQ4QXJyYXkoMTYpOwogICAgICAgICAgICAgIHZhciBjb2RlTGVuZ3RoU3VtID0gMDsKCiAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IDE2OyBqKyssIG9mZnNldCsrKSB7CiAgICAgICAgICAgICAgICBjb2RlTGVuZ3RoU3VtICs9IGNvZGVMZW5ndGhzW2pdID0gZGF0YVtvZmZzZXRdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIGh1ZmZtYW5WYWx1ZXMgPSBuZXcgVWludDhBcnJheShjb2RlTGVuZ3RoU3VtKTsKCiAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGNvZGVMZW5ndGhTdW07IGorKywgb2Zmc2V0KyspIHsKICAgICAgICAgICAgICAgIGh1ZmZtYW5WYWx1ZXNbal0gPSBkYXRhW29mZnNldF07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpICs9IDE3ICsgY29kZUxlbmd0aFN1bTsKICAgICAgICAgICAgICAoaHVmZm1hblRhYmxlU3BlYyA+PiA0ID09PSAwID8gaHVmZm1hblRhYmxlc0RDIDogaHVmZm1hblRhYmxlc0FDKVtodWZmbWFuVGFibGVTcGVjICYgMTVdID0gYnVpbGRIdWZmbWFuVGFibGUoY29kZUxlbmd0aHMsIGh1ZmZtYW5WYWx1ZXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4ZmZkZDoKICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICAgIHJlc2V0SW50ZXJ2YWwgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhmZmRhOgogICAgICAgICAgICB2YXIgcGFyc2VETkxNYXJrZXIgPSArK251bVNPU01hcmtlcnMgPT09IDEgJiYgIWRubFNjYW5MaW5lczsKICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CiAgICAgICAgICAgIHZhciBzZWxlY3RvcnNDb3VudCA9IGRhdGFbb2Zmc2V0KytdOwogICAgICAgICAgICB2YXIgY29tcG9uZW50cyA9IFtdLAogICAgICAgICAgICAgICAgY29tcG9uZW50OwoKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNlbGVjdG9yc0NvdW50OyBpKyspIHsKICAgICAgICAgICAgICB2YXIgY29tcG9uZW50SW5kZXggPSBmcmFtZS5jb21wb25lbnRJZHNbZGF0YVtvZmZzZXQrK11dOwogICAgICAgICAgICAgIGNvbXBvbmVudCA9IGZyYW1lLmNvbXBvbmVudHNbY29tcG9uZW50SW5kZXhdOwogICAgICAgICAgICAgIHZhciB0YWJsZVNwZWMgPSBkYXRhW29mZnNldCsrXTsKICAgICAgICAgICAgICBjb21wb25lbnQuaHVmZm1hblRhYmxlREMgPSBodWZmbWFuVGFibGVzRENbdGFibGVTcGVjID4+IDRdOwogICAgICAgICAgICAgIGNvbXBvbmVudC5odWZmbWFuVGFibGVBQyA9IGh1ZmZtYW5UYWJsZXNBQ1t0YWJsZVNwZWMgJiAxNV07CiAgICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBzcGVjdHJhbFN0YXJ0ID0gZGF0YVtvZmZzZXQrK107CiAgICAgICAgICAgIHZhciBzcGVjdHJhbEVuZCA9IGRhdGFbb2Zmc2V0KytdOwogICAgICAgICAgICB2YXIgc3VjY2Vzc2l2ZUFwcHJveGltYXRpb24gPSBkYXRhW29mZnNldCsrXTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgdmFyIHByb2Nlc3NlZCA9IGRlY29kZVNjYW4oZGF0YSwgb2Zmc2V0LCBmcmFtZSwgY29tcG9uZW50cywgcmVzZXRJbnRlcnZhbCwgc3BlY3RyYWxTdGFydCwgc3BlY3RyYWxFbmQsIHN1Y2Nlc3NpdmVBcHByb3hpbWF0aW9uID4+IDQsIHN1Y2Nlc3NpdmVBcHByb3hpbWF0aW9uICYgMTUsIHBhcnNlRE5MTWFya2VyKTsKICAgICAgICAgICAgICBvZmZzZXQgKz0gcHJvY2Vzc2VkOwogICAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICAgIGlmIChleCBpbnN0YW5jZW9mIEROTE1hcmtlckVycm9yKSB7CiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIiIuY29uY2F0KGV4Lm1lc3NhZ2UsICIgLS0gYXR0ZW1wdGluZyB0byByZS1wYXJzZSB0aGUgSlBFRyBpbWFnZS4iKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZShkYXRhLCB7CiAgICAgICAgICAgICAgICAgIGRubFNjYW5MaW5lczogZXguc2NhbkxpbmVzCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4IGluc3RhbmNlb2YgRU9JTWFya2VyRXJyb3IpIHsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiIi5jb25jYXQoZXgubWVzc2FnZSwgIiAtLSBpZ25vcmluZyB0aGUgcmVzdCBvZiB0aGUgaW1hZ2UgZGF0YS4iKSk7CiAgICAgICAgICAgICAgICBicmVhayBtYXJrZXJMb29wOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHhmZmRjOgogICAgICAgICAgICBvZmZzZXQgKz0gNDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweGZmZmY6CiAgICAgICAgICAgIGlmIChkYXRhW29mZnNldF0gIT09IDB4ZmYpIHsKICAgICAgICAgICAgICBvZmZzZXQtLTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgdmFyIG5leHRGaWxlTWFya2VyID0gZmluZE5leHRGaWxlTWFya2VyKGRhdGEsIG9mZnNldCAtIDIsIG9mZnNldCAtIDMpOwoKICAgICAgICAgICAgaWYgKG5leHRGaWxlTWFya2VyICYmIG5leHRGaWxlTWFya2VyLmludmFsaWQpIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkpwZWdJbWFnZS5wYXJzZSAtIHVuZXhwZWN0ZWQgZGF0YSwgY3VycmVudCBtYXJrZXIgaXM6ICIgKyBuZXh0RmlsZU1hcmtlci5pbnZhbGlkKTsKICAgICAgICAgICAgICBvZmZzZXQgPSBuZXh0RmlsZU1hcmtlci5vZmZzZXQ7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChvZmZzZXQgPj0gZGF0YS5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJKcGVnSW1hZ2UucGFyc2UgLSByZWFjaGVkIHRoZSBlbmQgb2YgdGhlIGltYWdlIGRhdGEgIiArICJ3aXRob3V0IGZpbmRpbmcgYW4gRU9JIG1hcmtlciAoMHhGRkQ5KS4iKTsKICAgICAgICAgICAgICBicmVhayBtYXJrZXJMb29wOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJKcGVnSW1hZ2UucGFyc2UgLSB1bmtub3duIG1hcmtlcjogIiArIGZpbGVNYXJrZXIudG9TdHJpbmcoMTYpKTsKICAgICAgICB9CgogICAgICAgIGZpbGVNYXJrZXIgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgb2Zmc2V0KTsKICAgICAgICBvZmZzZXQgKz0gMjsKICAgICAgfQoKICAgICAgdGhpcy53aWR0aCA9IGZyYW1lLnNhbXBsZXNQZXJMaW5lOwogICAgICB0aGlzLmhlaWdodCA9IGZyYW1lLnNjYW5MaW5lczsKICAgICAgdGhpcy5qZmlmID0gamZpZjsKICAgICAgdGhpcy5hZG9iZSA9IGFkb2JlOwogICAgICB0aGlzLmNvbXBvbmVudHMgPSBbXTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBmcmFtZS5jb21wb25lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29tcG9uZW50ID0gZnJhbWUuY29tcG9uZW50c1tpXTsKICAgICAgICB2YXIgcXVhbnRpemF0aW9uVGFibGUgPSBxdWFudGl6YXRpb25UYWJsZXNbY29tcG9uZW50LnF1YW50aXphdGlvbklkXTsKCiAgICAgICAgaWYgKHF1YW50aXphdGlvblRhYmxlKSB7CiAgICAgICAgICBjb21wb25lbnQucXVhbnRpemF0aW9uVGFibGUgPSBxdWFudGl6YXRpb25UYWJsZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuY29tcG9uZW50cy5wdXNoKHsKICAgICAgICAgIG91dHB1dDogYnVpbGRDb21wb25lbnREYXRhKGZyYW1lLCBjb21wb25lbnQpLAogICAgICAgICAgc2NhbGVYOiBjb21wb25lbnQuaCAvIGZyYW1lLm1heEgsCiAgICAgICAgICBzY2FsZVk6IGNvbXBvbmVudC52IC8gZnJhbWUubWF4ViwKICAgICAgICAgIGJsb2Nrc1BlckxpbmU6IGNvbXBvbmVudC5ibG9ja3NQZXJMaW5lLAogICAgICAgICAgYmxvY2tzUGVyQ29sdW1uOiBjb21wb25lbnQuYmxvY2tzUGVyQ29sdW1uCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMubnVtQ29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cy5sZW5ndGg7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9LAogICAgX2dldExpbmVhcml6ZWRCbG9ja0RhdGE6IGZ1bmN0aW9uIF9nZXRMaW5lYXJpemVkQmxvY2tEYXRhKHdpZHRoLCBoZWlnaHQpIHsKICAgICAgdmFyIGlzU291cmNlUERGID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgICAgdmFyIHNjYWxlWCA9IHRoaXMud2lkdGggLyB3aWR0aCwKICAgICAgICAgIHNjYWxlWSA9IHRoaXMuaGVpZ2h0IC8gaGVpZ2h0OwogICAgICB2YXIgY29tcG9uZW50LCBjb21wb25lbnRTY2FsZVgsIGNvbXBvbmVudFNjYWxlWSwgYmxvY2tzUGVyU2NhbmxpbmU7CiAgICAgIHZhciB4LCB5LCBpLCBqLCBrOwogICAgICB2YXIgaW5kZXg7CiAgICAgIHZhciBvZmZzZXQgPSAwOwogICAgICB2YXIgb3V0cHV0OwogICAgICB2YXIgbnVtQ29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cy5sZW5ndGg7CiAgICAgIHZhciBkYXRhTGVuZ3RoID0gd2lkdGggKiBoZWlnaHQgKiBudW1Db21wb25lbnRzOwogICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OENsYW1wZWRBcnJheShkYXRhTGVuZ3RoKTsKICAgICAgdmFyIHhTY2FsZUJsb2NrT2Zmc2V0ID0gbmV3IFVpbnQzMkFycmF5KHdpZHRoKTsKICAgICAgdmFyIG1hc2szTFNCID0gMHhmZmZmZmZmODsKICAgICAgdmFyIGxhc3RDb21wb25lbnRTY2FsZVg7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtQ29tcG9uZW50czsgaSsrKSB7CiAgICAgICAgY29tcG9uZW50ID0gdGhpcy5jb21wb25lbnRzW2ldOwogICAgICAgIGNvbXBvbmVudFNjYWxlWCA9IGNvbXBvbmVudC5zY2FsZVggKiBzY2FsZVg7CiAgICAgICAgY29tcG9uZW50U2NhbGVZID0gY29tcG9uZW50LnNjYWxlWSAqIHNjYWxlWTsKICAgICAgICBvZmZzZXQgPSBpOwogICAgICAgIG91dHB1dCA9IGNvbXBvbmVudC5vdXRwdXQ7CiAgICAgICAgYmxvY2tzUGVyU2NhbmxpbmUgPSBjb21wb25lbnQuYmxvY2tzUGVyTGluZSArIDEgPDwgMzsKCiAgICAgICAgaWYgKGNvbXBvbmVudFNjYWxlWCAhPT0gbGFzdENvbXBvbmVudFNjYWxlWCkgewogICAgICAgICAgZm9yICh4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICAgICAgaiA9IDAgfCB4ICogY29tcG9uZW50U2NhbGVYOwogICAgICAgICAgICB4U2NhbGVCbG9ja09mZnNldFt4XSA9IChqICYgbWFzazNMU0IpIDw8IDMgfCBqICYgNzsKICAgICAgICAgIH0KCiAgICAgICAgICBsYXN0Q29tcG9uZW50U2NhbGVYID0gY29tcG9uZW50U2NhbGVYOwogICAgICAgIH0KCiAgICAgICAgZm9yICh5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CiAgICAgICAgICBqID0gMCB8IHkgKiBjb21wb25lbnRTY2FsZVk7CiAgICAgICAgICBpbmRleCA9IGJsb2Nrc1BlclNjYW5saW5lICogKGogJiBtYXNrM0xTQikgfCAoaiAmIDcpIDw8IDM7CgogICAgICAgICAgZm9yICh4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICAgICAgZGF0YVtvZmZzZXRdID0gb3V0cHV0W2luZGV4ICsgeFNjYWxlQmxvY2tPZmZzZXRbeF1dOwogICAgICAgICAgICBvZmZzZXQgKz0gbnVtQ29tcG9uZW50czsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciB0cmFuc2Zvcm0gPSB0aGlzLl9kZWNvZGVUcmFuc2Zvcm07CgogICAgICBpZiAoIWlzU291cmNlUERGICYmIG51bUNvbXBvbmVudHMgPT09IDQgJiYgIXRyYW5zZm9ybSkgewogICAgICAgIHRyYW5zZm9ybSA9IG5ldyBJbnQzMkFycmF5KFstMjU2LCAyNTUsIC0yNTYsIDI1NSwgLTI1NiwgMjU1LCAtMjU2LCAyNTVdKTsKICAgICAgfQoKICAgICAgaWYgKHRyYW5zZm9ybSkgewogICAgICAgIGZvciAoaSA9IDA7IGkgPCBkYXRhTGVuZ3RoOykgewogICAgICAgICAgZm9yIChqID0gMCwgayA9IDA7IGogPCBudW1Db21wb25lbnRzOyBqKyssIGkrKywgayArPSAyKSB7CiAgICAgICAgICAgIGRhdGFbaV0gPSAoZGF0YVtpXSAqIHRyYW5zZm9ybVtrXSA+PiA4KSArIHRyYW5zZm9ybVtrICsgMV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gZGF0YTsKICAgIH0sCgogICAgZ2V0IF9pc0NvbG9yQ29udmVyc2lvbk5lZWRlZCgpIHsKICAgICAgaWYgKHRoaXMuYWRvYmUpIHsKICAgICAgICByZXR1cm4gISF0aGlzLmFkb2JlLnRyYW5zZm9ybUNvZGU7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm51bUNvbXBvbmVudHMgPT09IDMpIHsKICAgICAgICBpZiAodGhpcy5fY29sb3JUcmFuc2Zvcm0gPT09IDApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAodGhpcy5fY29sb3JUcmFuc2Zvcm0gPT09IDEpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKCiAgICBfY29udmVydFljY1RvUmdiOiBmdW5jdGlvbiBjb252ZXJ0WWNjVG9SZ2IoZGF0YSkgewogICAgICB2YXIgWSwgQ2IsIENyOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGRhdGEubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpICs9IDMpIHsKICAgICAgICBZID0gZGF0YVtpXTsKICAgICAgICBDYiA9IGRhdGFbaSArIDFdOwogICAgICAgIENyID0gZGF0YVtpICsgMl07CiAgICAgICAgZGF0YVtpXSA9IFkgLSAxNzkuNDU2ICsgMS40MDIgKiBDcjsKICAgICAgICBkYXRhW2kgKyAxXSA9IFkgKyAxMzUuNDU5IC0gMC4zNDQgKiBDYiAtIDAuNzE0ICogQ3I7CiAgICAgICAgZGF0YVtpICsgMl0gPSBZIC0gMjI2LjgxNiArIDEuNzcyICogQ2I7CiAgICAgIH0KCiAgICAgIHJldHVybiBkYXRhOwogICAgfSwKICAgIF9jb252ZXJ0WWNja1RvUmdiOiBmdW5jdGlvbiBjb252ZXJ0WWNja1RvUmdiKGRhdGEpIHsKICAgICAgdmFyIFksIENiLCBDciwgazsKICAgICAgdmFyIG9mZnNldCA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gZGF0YS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkgKz0gNCkgewogICAgICAgIFkgPSBkYXRhW2ldOwogICAgICAgIENiID0gZGF0YVtpICsgMV07CiAgICAgICAgQ3IgPSBkYXRhW2kgKyAyXTsKICAgICAgICBrID0gZGF0YVtpICsgM107CiAgICAgICAgZGF0YVtvZmZzZXQrK10gPSAtMTIyLjY3MTk1NDA2ODk0ICsgQ2IgKiAoLTYuNjA2MzU2Njk0MjAzNjRlLTUgKiBDYiArIDAuMDAwNDM3MTMwNDc1OTI2MjMyICogQ3IgLSA1LjQwODA2MTAwNjQ1OTllLTUgKiBZICsgMC4wMDA0ODQ0OTc5NzEyMDI4MSAqIGsgLSAwLjE1NDM2MjE1MTg3MTEyNikgKyBDciAqICgtMC4wMDA5NTc5NjQzNzg0NDU3NzMgKiBDciArIDAuMDAwODE3MDc2OTExMzQ2NjI1ICogWSAtIDAuMDA0NzcyNzE0MDU0MDg3NDcgKiBrICsgMS41MzM4MDI1MzIyMTczNCkgKyBZICogKDAuMDAwOTYxMjUwMTg0MTMwNjg4ICogWSAtIDAuMDAyNjYyNTczMzIyODM5MzMgKiBrICsgMC40ODM1NzA4ODQ1MTI2NSkgKyBrICogKC0wLjAwMDMzNjE5NzE3NzYxODM5NCAqIGsgKyAwLjQ4NDc5MTU2MTQ5MDc3Nik7CiAgICAgICAgZGF0YVtvZmZzZXQrK10gPSAxMDcuMjY4MDM5Mzk3NzI0ICsgQ2IgKiAoMi4xOTkyNzEwNDUyNTc0MWUtNSAqIENiIC0gMC4wMDA2NDA5OTIwMTgyOTc5NDUgKiBDciArIDAuMDAwNjU5Mzk3MDAxMjQ1NTc3ICogWSArIDAuMDAwNDI2MTA1NjUyOTM4ODM3ICogayAtIDAuMTc2NDkxNzkyNDYyODc1KSArIENyICogKC0wLjAwMDc3ODI2OTk0MTUxMzY4MyAqIENyICsgMC4wMDEzMDg3MjI2MTQwODI3NSAqIFkgKyAwLjAwMDc3MDQ4MjYzMTgwMTEzMiAqIGsgLSAwLjE1MTA1MTQ5Mjc3NTU2MikgKyBZICogKDAuMDAxMjY5MzUzNjgxMTQ4NDMgKiBZIC0gMC4wMDI2NTA5MDE4OTAxMDg5OCAqIGsgKyAwLjI1ODAyOTEwMjA2ODQ1KSArIGsgKiAoLTAuMDAwMzE4OTEzMTE3NTg4MzI4ICogayAtIDAuMjEzNzQyNDAwMzIzNjY1KTsKICAgICAgICBkYXRhW29mZnNldCsrXSA9IC0yMC44MTAwMTI1NDY5NDcgKyBDYiAqICgtMC4wMDA1NzAxMTUxOTY5NzM2NzcgKiBDYiAtIDIuNjM0MDkwNTEwMDQ1ODllLTUgKiBDciArIDAuMDAyMDc0MTA4ODExNTAxMiAqIFkgLSAwLjAwMjg4MjYwMjM2ODUzNDQyICogayArIDAuODE0MjcyOTY4MzU5Mjk1KSArIENyICogKC0xLjUzNDk2MDU3NDQwOTc1ZS01ICogQ3IgLSAwLjAwMDEzMjY4OTA0Mzk2MTQ0NiAqIFkgKyAwLjAwMDU2MDgzMzY5MTI0MjgxMiAqIGsgLSAwLjE5NTE1MjAyNzUzNDA0OSkgKyBZICogKDAuMDAxNzQ0MTgxMzI5Mjc1ODIgKiBZIC0gMC4wMDI1NTI0MzMyMTQzOTM0NyAqIGsgKyAwLjExNjkzNTAyMDQ2NTE0NSkgKyBrICogKC0wLjAwMDM0MzUzMTk5NjUxMDU1NSAqIGsgKyAwLjI0MTY1MjYwMjMyNDA3KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGRhdGEuc3ViYXJyYXkoMCwgb2Zmc2V0KTsKICAgIH0sCiAgICBfY29udmVydFljY2tUb0NteWs6IGZ1bmN0aW9uIGNvbnZlcnRZY2NrVG9DbXlrKGRhdGEpIHsKICAgICAgdmFyIFksIENiLCBDcjsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBkYXRhLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSArPSA0KSB7CiAgICAgICAgWSA9IGRhdGFbaV07CiAgICAgICAgQ2IgPSBkYXRhW2kgKyAxXTsKICAgICAgICBDciA9IGRhdGFbaSArIDJdOwogICAgICAgIGRhdGFbaV0gPSA0MzQuNDU2IC0gWSAtIDEuNDAyICogQ3I7CiAgICAgICAgZGF0YVtpICsgMV0gPSAxMTkuNTQxIC0gWSArIDAuMzQ0ICogQ2IgKyAwLjcxNCAqIENyOwogICAgICAgIGRhdGFbaSArIDJdID0gNDgxLjgxNiAtIFkgLSAxLjc3MiAqIENiOwogICAgICB9CgogICAgICByZXR1cm4gZGF0YTsKICAgIH0sCiAgICBfY29udmVydENteWtUb1JnYjogZnVuY3Rpb24gY29udmVydENteWtUb1JnYihkYXRhKSB7CiAgICAgIHZhciBjLCBtLCB5LCBrOwogICAgICB2YXIgb2Zmc2V0ID0gMDsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBkYXRhLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSArPSA0KSB7CiAgICAgICAgYyA9IGRhdGFbaV07CiAgICAgICAgbSA9IGRhdGFbaSArIDFdOwogICAgICAgIHkgPSBkYXRhW2kgKyAyXTsKICAgICAgICBrID0gZGF0YVtpICsgM107CiAgICAgICAgZGF0YVtvZmZzZXQrK10gPSAyNTUgKyBjICogKC0wLjAwMDA2NzQ3MTQ3MDczNjAyNDQxICogYyArIDAuMDAwODM3OTI2MjEyMTAxMzcyNyAqIG0gKyAwLjAwMDI4OTQ3MTgxODg2NDMyOTQgKiB5ICsgMC4wMDMyNjQyMzEwNTc1Mzc4MDYgKiBrIC0gMS4xMTg1NjExODY3MjAzOTM3KSArIG0gKiAoMC4wMDAwMjYzNzQxMDc2MTYwODk0MDUgKiBtIC0gMC4wMDAwODYyNjk0OTE1ODYzODU3MiAqIHkgLSAwLjAwMDI3NDg3NjkwNjc0OTk0OTEgKiBrIC0gMC4wMjE1NTY4ODc5NDk3ODk2NykgKyB5ICogKC0wLjAwMDAzODc4MDk5MjEyODY5MzYzICogeSAtIDAuMDAwMzI2NzgwODI3OTQ4NTI4NiAqIGsgKyAwLjA2ODY3NDIyMzg1OTUzNDUpIC0gayAqICgwLjAwMDMzNjE5NzE3NzYxODM5MzcgKiBrICsgMC43NDMwNjU5MTUxMzQyMjU0KTsKICAgICAgICBkYXRhW29mZnNldCsrXSA9IDI1NSArIGMgKiAoMC4wMDAxMzU5NjM3MjgxMzU4ODg0OCAqIGMgKyAwLjAwMDkyNDUzNzEzMjU3MzU4NSAqIG0gKyAwLjAwMDEwNTY3MzU5NjE4NjgzNTkzICogeSArIDAuMDAwNDc5MTg2NDY4NzQzNjUxMiAqIGsgLSAwLjMxMDk2ODk1ODc1MTU4NzUpICsgbSAqICgtMC4wMDAyMzU0NTM0NjEwODM3MDM0NCAqIG0gKyAwLjAwMDI3MDI4NDUyNTM1MzQ3MTQgKiB5ICsgMC4wMDIwMjAwMzA4OTc3MzA3MTU2ICogayAtIDAuNzQ4ODA1MjE2NzAxNTQ5NCkgKyB5ICogKDAuMDAwMDY4MzQ4MTU5OTgyMzU2NjIgKiB5ICsgMC4wMDAxNTE2ODQ1MjM2MzQ2MDk3MyAqIGsgLSAwLjA5NzUxOTI3Nzc0NzI4OTMzKSAtIGsgKiAoMC4wMDAzMTg5MTMxMTc1ODgzMjgxNCAqIGsgKyAwLjczNjQ4ODM4MDc3MzMxNjgpOwogICAgICAgIGRhdGFbb2Zmc2V0KytdID0gMjU1ICsgYyAqICgwLjAwMDAxMzU5ODY1MDQxMTM4NTMwNyAqIGMgKyAwLjAwMDEyNDIzOTU2MTc1NDkwODUxICogbSArIDAuMDAwNDc1MTk4NTA5NzU4MzU4OSAqIHkgLSAwLjAwMDAwMzY3MjkzMTc0NzY2MzA0MjIgKiBrIC0gMC4wNTU2MjE4Njk4MDI2NDAzNCkgKyBtICogKDAuMDAwMTYxNDEzODA1OTg3MjQ2NzYgKiBtICsgMC4wMDA5NjkyMjM5MTMwNzI1MTg2ICogeSArIDAuMDAwNzc4MjY5MjQ1MDAzNjI1MyAqIGsgLSAwLjQ0MDE1MjMyMzY3NTI2NDYzKSArIHkgKiAoNS4wNjg4ODI5MTQwNjg3NjllLTcgKiB5ICsgMC4wMDE3Nzc4MzY5MDExMzc1MDcxICogayAtIDAuNzU5MTQ1NDY0OTc0OTYwOSkgLSBrICogKDAuMDAwMzQzNTMxOTk2NTEwNTU1MyAqIGsgKyAwLjcwNjM3NzAxODYxNjAxNDQpOwogICAgICB9CgogICAgICByZXR1cm4gZGF0YS5zdWJhcnJheSgwLCBvZmZzZXQpOwogICAgfSwKICAgIGdldERhdGE6IGZ1bmN0aW9uIGdldERhdGEoX3JlZjMpIHsKICAgICAgdmFyIHdpZHRoID0gX3JlZjMud2lkdGgsCiAgICAgICAgICBoZWlnaHQgPSBfcmVmMy5oZWlnaHQsCiAgICAgICAgICBfcmVmMyRmb3JjZVJHQiA9IF9yZWYzLmZvcmNlUkdCLAogICAgICAgICAgZm9yY2VSR0IgPSBfcmVmMyRmb3JjZVJHQiA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmMyRmb3JjZVJHQiwKICAgICAgICAgIF9yZWYzJGlzU291cmNlUERGID0gX3JlZjMuaXNTb3VyY2VQREYsCiAgICAgICAgICBpc1NvdXJjZVBERiA9IF9yZWYzJGlzU291cmNlUERGID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYzJGlzU291cmNlUERGOwoKICAgICAgaWYgKHRoaXMubnVtQ29tcG9uZW50cyA+IDQpIHsKICAgICAgICB0aHJvdyBuZXcgSnBlZ0Vycm9yKCJVbnN1cHBvcnRlZCBjb2xvciBtb2RlIik7CiAgICAgIH0KCiAgICAgIHZhciBkYXRhID0gdGhpcy5fZ2V0TGluZWFyaXplZEJsb2NrRGF0YSh3aWR0aCwgaGVpZ2h0LCBpc1NvdXJjZVBERik7CgogICAgICBpZiAodGhpcy5udW1Db21wb25lbnRzID09PSAxICYmIGZvcmNlUkdCKSB7CiAgICAgICAgdmFyIGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aDsKICAgICAgICB2YXIgcmdiRGF0YSA9IG5ldyBVaW50OENsYW1wZWRBcnJheShkYXRhTGVuZ3RoICogMyk7CiAgICAgICAgdmFyIG9mZnNldCA9IDA7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YUxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgZ3JheUNvbG9yID0gZGF0YVtpXTsKICAgICAgICAgIHJnYkRhdGFbb2Zmc2V0KytdID0gZ3JheUNvbG9yOwogICAgICAgICAgcmdiRGF0YVtvZmZzZXQrK10gPSBncmF5Q29sb3I7CiAgICAgICAgICByZ2JEYXRhW29mZnNldCsrXSA9IGdyYXlDb2xvcjsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZ2JEYXRhOwogICAgICB9IGVsc2UgaWYgKHRoaXMubnVtQ29tcG9uZW50cyA9PT0gMyAmJiB0aGlzLl9pc0NvbG9yQ29udmVyc2lvbk5lZWRlZCkgewogICAgICAgIHJldHVybiB0aGlzLl9jb252ZXJ0WWNjVG9SZ2IoZGF0YSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5udW1Db21wb25lbnRzID09PSA0KSB7CiAgICAgICAgaWYgKHRoaXMuX2lzQ29sb3JDb252ZXJzaW9uTmVlZGVkKSB7CiAgICAgICAgICBpZiAoZm9yY2VSR0IpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnZlcnRZY2NrVG9SZ2IoZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnZlcnRZY2NrVG9DbXlrKGRhdGEpOwogICAgICAgIH0gZWxzZSBpZiAoZm9yY2VSR0IpIHsKICAgICAgICAgIHJldHVybiB0aGlzLl9jb252ZXJ0Q215a1RvUmdiKGRhdGEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGRhdGE7CiAgICB9CiAgfTsKICByZXR1cm4gSnBlZ0ltYWdlOwp9KCk7CgpleHBvcnRzLkpwZWdJbWFnZSA9IEpwZWdJbWFnZTsKCi8qKiovIH0pLAovKiAyMTMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5KcHhTdHJlYW0gPSB2b2lkIDA7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA1KTsKCnZhciBfanB4ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTQpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBKcHhTdHJlYW0gPSBmdW5jdGlvbiBKcHhTdHJlYW1DbG9zdXJlKCkgewogIGZ1bmN0aW9uIEpweFN0cmVhbShzdHJlYW0sIG1heWJlTGVuZ3RoLCBkaWN0LCBwYXJhbXMpIHsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5tYXliZUxlbmd0aCA9IG1heWJlTGVuZ3RoOwogICAgdGhpcy5kaWN0ID0gZGljdDsKICAgIHRoaXMucGFyYW1zID0gcGFyYW1zOwoKICAgIF9zdHJlYW0uRGVjb2RlU3RyZWFtLmNhbGwodGhpcywgbWF5YmVMZW5ndGgpOwogIH0KCiAgSnB4U3RyZWFtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoX3N0cmVhbS5EZWNvZGVTdHJlYW0ucHJvdG90eXBlKTsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSnB4U3RyZWFtLnByb3RvdHlwZSwgImJ5dGVzIiwgewogICAgZ2V0OiBmdW5jdGlvbiBKcHhTdHJlYW1fYnl0ZXMoKSB7CiAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiYnl0ZXMiLCB0aGlzLnN0cmVhbS5nZXRCeXRlcyh0aGlzLm1heWJlTGVuZ3RoKSk7CiAgICB9LAogICAgY29uZmlndXJhYmxlOiB0cnVlCiAgfSk7CgogIEpweFN0cmVhbS5wcm90b3R5cGUuZW5zdXJlQnVmZmVyID0gZnVuY3Rpb24gKHJlcXVlc3RlZCkge307CgogIEpweFN0cmVhbS5wcm90b3R5cGUucmVhZEJsb2NrID0gZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMuZW9mKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIganB4SW1hZ2UgPSBuZXcgX2pweC5KcHhJbWFnZSgpOwogICAganB4SW1hZ2UucGFyc2UodGhpcy5ieXRlcyk7CiAgICB2YXIgd2lkdGggPSBqcHhJbWFnZS53aWR0aDsKICAgIHZhciBoZWlnaHQgPSBqcHhJbWFnZS5oZWlnaHQ7CiAgICB2YXIgY29tcG9uZW50c0NvdW50ID0ganB4SW1hZ2UuY29tcG9uZW50c0NvdW50OwogICAgdmFyIHRpbGVDb3VudCA9IGpweEltYWdlLnRpbGVzLmxlbmd0aDsKCiAgICBpZiAodGlsZUNvdW50ID09PSAxKSB7CiAgICAgIHRoaXMuYnVmZmVyID0ganB4SW1hZ2UudGlsZXNbMF0uaXRlbXM7CiAgICB9IGVsc2UgewogICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCAqIGhlaWdodCAqIGNvbXBvbmVudHNDb3VudCk7CgogICAgICBmb3IgKHZhciBrID0gMDsgayA8IHRpbGVDb3VudDsgaysrKSB7CiAgICAgICAgdmFyIHRpbGVDb21wb25lbnRzID0ganB4SW1hZ2UudGlsZXNba107CiAgICAgICAgdmFyIHRpbGVXaWR0aCA9IHRpbGVDb21wb25lbnRzLndpZHRoOwogICAgICAgIHZhciB0aWxlSGVpZ2h0ID0gdGlsZUNvbXBvbmVudHMuaGVpZ2h0OwogICAgICAgIHZhciB0aWxlTGVmdCA9IHRpbGVDb21wb25lbnRzLmxlZnQ7CiAgICAgICAgdmFyIHRpbGVUb3AgPSB0aWxlQ29tcG9uZW50cy50b3A7CiAgICAgICAgdmFyIHNyYyA9IHRpbGVDb21wb25lbnRzLml0ZW1zOwogICAgICAgIHZhciBzcmNQb3NpdGlvbiA9IDA7CiAgICAgICAgdmFyIGRhdGFQb3NpdGlvbiA9ICh3aWR0aCAqIHRpbGVUb3AgKyB0aWxlTGVmdCkgKiBjb21wb25lbnRzQ291bnQ7CiAgICAgICAgdmFyIGltZ1Jvd1NpemUgPSB3aWR0aCAqIGNvbXBvbmVudHNDb3VudDsKICAgICAgICB2YXIgdGlsZVJvd1NpemUgPSB0aWxlV2lkdGggKiBjb21wb25lbnRzQ291bnQ7CgogICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGlsZUhlaWdodDsgaisrKSB7CiAgICAgICAgICB2YXIgcm93Qnl0ZXMgPSBzcmMuc3ViYXJyYXkoc3JjUG9zaXRpb24sIHNyY1Bvc2l0aW9uICsgdGlsZVJvd1NpemUpOwogICAgICAgICAgZGF0YS5zZXQocm93Qnl0ZXMsIGRhdGFQb3NpdGlvbik7CiAgICAgICAgICBzcmNQb3NpdGlvbiArPSB0aWxlUm93U2l6ZTsKICAgICAgICAgIGRhdGFQb3NpdGlvbiArPSBpbWdSb3dTaXplOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5idWZmZXIgPSBkYXRhOwogICAgfQoKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXIubGVuZ3RoOwogICAgdGhpcy5lb2YgPSB0cnVlOwogIH07CgogIHJldHVybiBKcHhTdHJlYW07Cn0oKTsKCmV4cG9ydHMuSnB4U3RyZWFtID0gSnB4U3RyZWFtOwoKLyoqKi8gfSksCi8qIDIxNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLkpweEltYWdlID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCnZhciBfYXJpdGhtZXRpY19kZWNvZGVyID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTApOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCnZhciBKcHhFcnJvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Jhc2VFeGNlcHRpb24pIHsKICBfaW5oZXJpdHMoSnB4RXJyb3IsIF9CYXNlRXhjZXB0aW9uKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihKcHhFcnJvcik7CgogIGZ1bmN0aW9uIEpweEVycm9yKG1zZykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEpweEVycm9yKTsKCiAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgIkpQWCBlcnJvcjogIi5jb25jYXQobXNnKSk7CiAgfQoKICByZXR1cm4gSnB4RXJyb3I7Cn0oX3V0aWwuQmFzZUV4Y2VwdGlvbik7Cgp2YXIgSnB4SW1hZ2UgPSBmdW5jdGlvbiBKcHhJbWFnZUNsb3N1cmUoKSB7CiAgdmFyIFN1YmJhbmRzR2FpbkxvZzIgPSB7CiAgICBMTDogMCwKICAgIExIOiAxLAogICAgSEw6IDEsCiAgICBISDogMgogIH07CgogIGZ1bmN0aW9uIEpweEltYWdlKCkgewogICAgdGhpcy5mYWlsT25Db3JydXB0ZWRJbWFnZSA9IGZhbHNlOwogIH0KCiAgSnB4SW1hZ2UucHJvdG90eXBlID0gewogICAgcGFyc2U6IGZ1bmN0aW9uIEpweEltYWdlX3BhcnNlKGRhdGEpIHsKICAgICAgdmFyIGhlYWQgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgMCk7CgogICAgICBpZiAoaGVhZCA9PT0gMHhmZjRmKSB7CiAgICAgICAgdGhpcy5wYXJzZUNvZGVzdHJlYW0oZGF0YSwgMCwgZGF0YS5sZW5ndGgpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBvc2l0aW9uID0gMCwKICAgICAgICAgIGxlbmd0aCA9IGRhdGEubGVuZ3RoOwoKICAgICAgd2hpbGUgKHBvc2l0aW9uIDwgbGVuZ3RoKSB7CiAgICAgICAgdmFyIGhlYWRlclNpemUgPSA4OwogICAgICAgIHZhciBsYm94ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICB2YXIgdGJveCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpOwogICAgICAgIHBvc2l0aW9uICs9IGhlYWRlclNpemU7CgogICAgICAgIGlmIChsYm94ID09PSAxKSB7CiAgICAgICAgICBsYm94ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uKSAqIDQyOTQ5NjcyOTYgKyAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA0KTsKICAgICAgICAgIHBvc2l0aW9uICs9IDg7CiAgICAgICAgICBoZWFkZXJTaXplICs9IDg7CiAgICAgICAgfQoKICAgICAgICBpZiAobGJveCA9PT0gMCkgewogICAgICAgICAgbGJveCA9IGxlbmd0aCAtIHBvc2l0aW9uICsgaGVhZGVyU2l6ZTsKICAgICAgICB9CgogICAgICAgIGlmIChsYm94IDwgaGVhZGVyU2l6ZSkgewogICAgICAgICAgdGhyb3cgbmV3IEpweEVycm9yKCJJbnZhbGlkIGJveCBmaWVsZCBzaXplIik7CiAgICAgICAgfQoKICAgICAgICB2YXIgZGF0YUxlbmd0aCA9IGxib3ggLSBoZWFkZXJTaXplOwogICAgICAgIHZhciBqdW1wRGF0YUxlbmd0aCA9IHRydWU7CgogICAgICAgIHN3aXRjaCAodGJveCkgewogICAgICAgICAgY2FzZSAweDZhNzAzMjY4OgogICAgICAgICAgICBqdW1wRGF0YUxlbmd0aCA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4NjM2ZjZjNzI6CiAgICAgICAgICAgIHZhciBtZXRob2QgPSBkYXRhW3Bvc2l0aW9uXTsKCiAgICAgICAgICAgIGlmIChtZXRob2QgPT09IDEpIHsKICAgICAgICAgICAgICB2YXIgY29sb3JzcGFjZSA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDMpOwoKICAgICAgICAgICAgICBzd2l0Y2ggKGNvbG9yc3BhY2UpIHsKICAgICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmtub3duIGNvbG9yc3BhY2UgIiArIGNvbG9yc3BhY2UpOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSAyKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJQ0MgcHJvZmlsZSBub3Qgc3VwcG9ydGVkIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHg2YTcwMzI2MzoKICAgICAgICAgICAgdGhpcy5wYXJzZUNvZGVzdHJlYW0oZGF0YSwgcG9zaXRpb24sIHBvc2l0aW9uICsgZGF0YUxlbmd0aCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHg2YTUwMjAyMDoKICAgICAgICAgICAgaWYgKCgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbikgIT09IDB4MGQwYTg3MGEpIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgSlAyIHNpZ25hdHVyZSIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4NmE1MDFhMWE6CiAgICAgICAgICBjYXNlIDB4NjY3NDc5NzA6CiAgICAgICAgICBjYXNlIDB4NzI3MjY1NzE6CiAgICAgICAgICBjYXNlIDB4NzI2NTczMjA6CiAgICAgICAgICBjYXNlIDB4Njk2ODY0NzI6CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHZhciBoZWFkZXJUeXBlID0gU3RyaW5nLmZyb21DaGFyQ29kZSh0Ym94ID4+IDI0ICYgMHhmZiwgdGJveCA+PiAxNiAmIDB4ZmYsIHRib3ggPj4gOCAmIDB4ZmYsIHRib3ggJiAweGZmKTsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnN1cHBvcnRlZCBoZWFkZXIgdHlwZSAiICsgdGJveCArICIgKCIgKyBoZWFkZXJUeXBlICsgIikiKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAoanVtcERhdGFMZW5ndGgpIHsKICAgICAgICAgIHBvc2l0aW9uICs9IGRhdGFMZW5ndGg7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcGFyc2VJbWFnZVByb3BlcnRpZXM6IGZ1bmN0aW9uIEpweEltYWdlX3BhcnNlSW1hZ2VQcm9wZXJ0aWVzKHN0cmVhbSkgewogICAgICB2YXIgbmV3Qnl0ZSA9IHN0cmVhbS5nZXRCeXRlKCk7CgogICAgICB3aGlsZSAobmV3Qnl0ZSA+PSAwKSB7CiAgICAgICAgdmFyIG9sZEJ5dGUgPSBuZXdCeXRlOwogICAgICAgIG5ld0J5dGUgPSBzdHJlYW0uZ2V0Qnl0ZSgpOwogICAgICAgIHZhciBjb2RlID0gb2xkQnl0ZSA8PCA4IHwgbmV3Qnl0ZTsKCiAgICAgICAgaWYgKGNvZGUgPT09IDB4ZmY1MSkgewogICAgICAgICAgc3RyZWFtLnNraXAoNCk7CiAgICAgICAgICB2YXIgWHNpeiA9IHN0cmVhbS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgICAgdmFyIFlzaXogPSBzdHJlYW0uZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgICAgIHZhciBYT3NpeiA9IHN0cmVhbS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgICAgdmFyIFlPc2l6ID0gc3RyZWFtLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgICBzdHJlYW0uc2tpcCgxNik7CiAgICAgICAgICB2YXIgQ3NpeiA9IHN0cmVhbS5nZXRVaW50MTYoKTsKICAgICAgICAgIHRoaXMud2lkdGggPSBYc2l6IC0gWE9zaXo7CiAgICAgICAgICB0aGlzLmhlaWdodCA9IFlzaXogLSBZT3NpejsKICAgICAgICAgIHRoaXMuY29tcG9uZW50c0NvdW50ID0gQ3NpejsKICAgICAgICAgIHRoaXMuYml0c1BlckNvbXBvbmVudCA9IDg7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk5vIHNpemUgbWFya2VyIGZvdW5kIGluIEpQWCBzdHJlYW0iKTsKICAgIH0sCiAgICBwYXJzZUNvZGVzdHJlYW06IGZ1bmN0aW9uIEpweEltYWdlX3BhcnNlQ29kZXN0cmVhbShkYXRhLCBzdGFydCwgZW5kKSB7CiAgICAgIHZhciBjb250ZXh0ID0ge307CiAgICAgIHZhciBkb05vdFJlY292ZXIgPSBmYWxzZTsKCiAgICAgIHRyeSB7CiAgICAgICAgdmFyIHBvc2l0aW9uID0gc3RhcnQ7CgogICAgICAgIHdoaWxlIChwb3NpdGlvbiArIDEgPCBlbmQpIHsKICAgICAgICAgIHZhciBjb2RlID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgIHBvc2l0aW9uICs9IDI7CiAgICAgICAgICB2YXIgbGVuZ3RoID0gMCwKICAgICAgICAgICAgICBqLAogICAgICAgICAgICAgIHNxY2QsCiAgICAgICAgICAgICAgc3BxY2RzLAogICAgICAgICAgICAgIHNwcWNkU2l6ZSwKICAgICAgICAgICAgICBzY2FsYXJFeHBvdW5kZWQsCiAgICAgICAgICAgICAgdGlsZTsKCiAgICAgICAgICBzd2l0Y2ggKGNvZGUpIHsKICAgICAgICAgICAgY2FzZSAweGZmNGY6CiAgICAgICAgICAgICAgY29udGV4dC5tYWluSGVhZGVyID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMHhmZmQ5OgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAweGZmNTE6CiAgICAgICAgICAgICAgbGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgICAgICB2YXIgc2l6ID0ge307CiAgICAgICAgICAgICAgc2l6LlhzaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyA0KTsKICAgICAgICAgICAgICBzaXouWXNpeiA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDgpOwogICAgICAgICAgICAgIHNpei5YT3NpeiA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDEyKTsKICAgICAgICAgICAgICBzaXouWU9zaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyAxNik7CiAgICAgICAgICAgICAgc2l6LlhUc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMjApOwogICAgICAgICAgICAgIHNpei5ZVHNpeiA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDI0KTsKICAgICAgICAgICAgICBzaXouWFRPc2l6ID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGRhdGEsIHBvc2l0aW9uICsgMjgpOwogICAgICAgICAgICAgIHNpei5ZVE9zaXogPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoZGF0YSwgcG9zaXRpb24gKyAzMik7CiAgICAgICAgICAgICAgdmFyIGNvbXBvbmVudHNDb3VudCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbiArIDM2KTsKICAgICAgICAgICAgICBzaXouQ3NpeiA9IGNvbXBvbmVudHNDb3VudDsKICAgICAgICAgICAgICB2YXIgY29tcG9uZW50cyA9IFtdOwogICAgICAgICAgICAgIGogPSBwb3NpdGlvbiArIDM4OwoKICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBvbmVudHNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICB2YXIgY29tcG9uZW50ID0gewogICAgICAgICAgICAgICAgICBwcmVjaXNpb246IChkYXRhW2pdICYgMHg3ZikgKyAxLAogICAgICAgICAgICAgICAgICBpc1NpZ25lZDogISEoZGF0YVtqXSAmIDB4ODApLAogICAgICAgICAgICAgICAgICBYUnNpejogZGF0YVtqICsgMV0sCiAgICAgICAgICAgICAgICAgIFlSc2l6OiBkYXRhW2ogKyAyXQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGogKz0gMzsKICAgICAgICAgICAgICAgIGNhbGN1bGF0ZUNvbXBvbmVudERpbWVuc2lvbnMoY29tcG9uZW50LCBzaXopOwogICAgICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb250ZXh0LlNJWiA9IHNpejsKICAgICAgICAgICAgICBjb250ZXh0LmNvbXBvbmVudHMgPSBjb21wb25lbnRzOwogICAgICAgICAgICAgIGNhbGN1bGF0ZVRpbGVHcmlkcyhjb250ZXh0LCBjb21wb25lbnRzKTsKICAgICAgICAgICAgICBjb250ZXh0LlFDQyA9IFtdOwogICAgICAgICAgICAgIGNvbnRleHQuQ09DID0gW107CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4ZmY1YzoKICAgICAgICAgICAgICBsZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgICAgICAgIHZhciBxY2QgPSB7fTsKICAgICAgICAgICAgICBqID0gcG9zaXRpb24gKyAyOwogICAgICAgICAgICAgIHNxY2QgPSBkYXRhW2orK107CgogICAgICAgICAgICAgIHN3aXRjaCAoc3FjZCAmIDB4MWYpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgc3BxY2RTaXplID0gODsKICAgICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICBzcHFjZFNpemUgPSAxNjsKICAgICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgc3BxY2RTaXplID0gMTY7CiAgICAgICAgICAgICAgICAgIHNjYWxhckV4cG91bmRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBTUWNkIHZhbHVlICIgKyBzcWNkKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHFjZC5ub1F1YW50aXphdGlvbiA9IHNwcWNkU2l6ZSA9PT0gODsKICAgICAgICAgICAgICBxY2Quc2NhbGFyRXhwb3VuZGVkID0gc2NhbGFyRXhwb3VuZGVkOwogICAgICAgICAgICAgIHFjZC5ndWFyZEJpdHMgPSBzcWNkID4+IDU7CiAgICAgICAgICAgICAgc3BxY2RzID0gW107CgogICAgICAgICAgICAgIHdoaWxlIChqIDwgbGVuZ3RoICsgcG9zaXRpb24pIHsKICAgICAgICAgICAgICAgIHZhciBzcHFjZCA9IHt9OwoKICAgICAgICAgICAgICAgIGlmIChzcHFjZFNpemUgPT09IDgpIHsKICAgICAgICAgICAgICAgICAgc3BxY2QuZXBzaWxvbiA9IGRhdGFbaisrXSA+PiAzOwogICAgICAgICAgICAgICAgICBzcHFjZC5tdSA9IDA7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBzcHFjZC5lcHNpbG9uID0gZGF0YVtqXSA+PiAzOwogICAgICAgICAgICAgICAgICBzcHFjZC5tdSA9IChkYXRhW2pdICYgMHg3KSA8PCA4IHwgZGF0YVtqICsgMV07CiAgICAgICAgICAgICAgICAgIGogKz0gMjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBzcHFjZHMucHVzaChzcHFjZCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBxY2QuU1BxY2RzID0gc3BxY2RzOwoKICAgICAgICAgICAgICBpZiAoY29udGV4dC5tYWluSGVhZGVyKSB7CiAgICAgICAgICAgICAgICBjb250ZXh0LlFDRCA9IHFjZDsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGlsZS5RQ0QgPSBxY2Q7CiAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlLlFDQyA9IFtdOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4ZmY1ZDoKICAgICAgICAgICAgICBsZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgICAgICAgIHZhciBxY2MgPSB7fTsKICAgICAgICAgICAgICBqID0gcG9zaXRpb24gKyAyOwogICAgICAgICAgICAgIHZhciBjcWNjOwoKICAgICAgICAgICAgICBpZiAoY29udGV4dC5TSVouQ3NpeiA8IDI1NykgewogICAgICAgICAgICAgICAgY3FjYyA9IGRhdGFbaisrXTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3FjYyA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBqKTsKICAgICAgICAgICAgICAgIGogKz0gMjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHNxY2QgPSBkYXRhW2orK107CgogICAgICAgICAgICAgIHN3aXRjaCAoc3FjZCAmIDB4MWYpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgc3BxY2RTaXplID0gODsKICAgICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICBzcHFjZFNpemUgPSAxNjsKICAgICAgICAgICAgICAgICAgc2NhbGFyRXhwb3VuZGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgc3BxY2RTaXplID0gMTY7CiAgICAgICAgICAgICAgICAgIHNjYWxhckV4cG91bmRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBTUWNkIHZhbHVlICIgKyBzcWNkKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHFjYy5ub1F1YW50aXphdGlvbiA9IHNwcWNkU2l6ZSA9PT0gODsKICAgICAgICAgICAgICBxY2Muc2NhbGFyRXhwb3VuZGVkID0gc2NhbGFyRXhwb3VuZGVkOwogICAgICAgICAgICAgIHFjYy5ndWFyZEJpdHMgPSBzcWNkID4+IDU7CiAgICAgICAgICAgICAgc3BxY2RzID0gW107CgogICAgICAgICAgICAgIHdoaWxlIChqIDwgbGVuZ3RoICsgcG9zaXRpb24pIHsKICAgICAgICAgICAgICAgIHNwcWNkID0ge307CgogICAgICAgICAgICAgICAgaWYgKHNwcWNkU2l6ZSA9PT0gOCkgewogICAgICAgICAgICAgICAgICBzcHFjZC5lcHNpbG9uID0gZGF0YVtqKytdID4+IDM7CiAgICAgICAgICAgICAgICAgIHNwcWNkLm11ID0gMDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHNwcWNkLmVwc2lsb24gPSBkYXRhW2pdID4+IDM7CiAgICAgICAgICAgICAgICAgIHNwcWNkLm11ID0gKGRhdGFbal0gJiAweDcpIDw8IDggfCBkYXRhW2ogKyAxXTsKICAgICAgICAgICAgICAgICAgaiArPSAyOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHNwcWNkcy5wdXNoKHNwcWNkKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHFjYy5TUHFjZHMgPSBzcHFjZHM7CgogICAgICAgICAgICAgIGlmIChjb250ZXh0Lm1haW5IZWFkZXIpIHsKICAgICAgICAgICAgICAgIGNvbnRleHQuUUNDW2NxY2NdID0gcWNjOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlLlFDQ1tjcWNjXSA9IHFjYzsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAweGZmNTI6CiAgICAgICAgICAgICAgbGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MTYpKGRhdGEsIHBvc2l0aW9uKTsKICAgICAgICAgICAgICB2YXIgY29kID0ge307CiAgICAgICAgICAgICAgaiA9IHBvc2l0aW9uICsgMjsKICAgICAgICAgICAgICB2YXIgc2NvZCA9IGRhdGFbaisrXTsKICAgICAgICAgICAgICBjb2QuZW50cm9weUNvZGVyV2l0aEN1c3RvbVByZWNpbmN0cyA9ICEhKHNjb2QgJiAxKTsKICAgICAgICAgICAgICBjb2Quc29wTWFya2VyVXNlZCA9ICEhKHNjb2QgJiAyKTsKICAgICAgICAgICAgICBjb2QuZXBoTWFya2VyVXNlZCA9ICEhKHNjb2QgJiA0KTsKICAgICAgICAgICAgICBjb2QucHJvZ3Jlc3Npb25PcmRlciA9IGRhdGFbaisrXTsKICAgICAgICAgICAgICBjb2QubGF5ZXJzQ291bnQgPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgaik7CiAgICAgICAgICAgICAgaiArPSAyOwogICAgICAgICAgICAgIGNvZC5tdWx0aXBsZUNvbXBvbmVudFRyYW5zZm9ybSA9IGRhdGFbaisrXTsKICAgICAgICAgICAgICBjb2QuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gZGF0YVtqKytdOwogICAgICAgICAgICAgIGNvZC54Y2IgPSAoZGF0YVtqKytdICYgMHhmKSArIDI7CiAgICAgICAgICAgICAgY29kLnljYiA9IChkYXRhW2orK10gJiAweGYpICsgMjsKICAgICAgICAgICAgICB2YXIgYmxvY2tTdHlsZSA9IGRhdGFbaisrXTsKICAgICAgICAgICAgICBjb2Quc2VsZWN0aXZlQXJpdGhtZXRpY0NvZGluZ0J5cGFzcyA9ICEhKGJsb2NrU3R5bGUgJiAxKTsKICAgICAgICAgICAgICBjb2QucmVzZXRDb250ZXh0UHJvYmFiaWxpdGllcyA9ICEhKGJsb2NrU3R5bGUgJiAyKTsKICAgICAgICAgICAgICBjb2QudGVybWluYXRpb25PbkVhY2hDb2RpbmdQYXNzID0gISEoYmxvY2tTdHlsZSAmIDQpOwogICAgICAgICAgICAgIGNvZC52ZXJ0aWNhbGx5U3RyaXBlID0gISEoYmxvY2tTdHlsZSAmIDgpOwogICAgICAgICAgICAgIGNvZC5wcmVkaWN0YWJsZVRlcm1pbmF0aW9uID0gISEoYmxvY2tTdHlsZSAmIDE2KTsKICAgICAgICAgICAgICBjb2Quc2VnbWVudGF0aW9uU3ltYm9sVXNlZCA9ICEhKGJsb2NrU3R5bGUgJiAzMik7CiAgICAgICAgICAgICAgY29kLnJldmVyc2libGVUcmFuc2Zvcm1hdGlvbiA9IGRhdGFbaisrXTsKCiAgICAgICAgICAgICAgaWYgKGNvZC5lbnRyb3B5Q29kZXJXaXRoQ3VzdG9tUHJlY2luY3RzKSB7CiAgICAgICAgICAgICAgICB2YXIgcHJlY2luY3RzU2l6ZXMgPSBbXTsKCiAgICAgICAgICAgICAgICB3aGlsZSAoaiA8IGxlbmd0aCArIHBvc2l0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHZhciBwcmVjaW5jdHNTaXplID0gZGF0YVtqKytdOwogICAgICAgICAgICAgICAgICBwcmVjaW5jdHNTaXplcy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBQUHg6IHByZWNpbmN0c1NpemUgJiAweGYsCiAgICAgICAgICAgICAgICAgICAgUFB5OiBwcmVjaW5jdHNTaXplID4+IDQKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29kLnByZWNpbmN0c1NpemVzID0gcHJlY2luY3RzU2l6ZXM7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgdW5zdXBwb3J0ZWQgPSBbXTsKCiAgICAgICAgICAgICAgaWYgKGNvZC5zZWxlY3RpdmVBcml0aG1ldGljQ29kaW5nQnlwYXNzKSB7CiAgICAgICAgICAgICAgICB1bnN1cHBvcnRlZC5wdXNoKCJzZWxlY3RpdmVBcml0aG1ldGljQ29kaW5nQnlwYXNzIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoY29kLnJlc2V0Q29udGV4dFByb2JhYmlsaXRpZXMpIHsKICAgICAgICAgICAgICAgIHVuc3VwcG9ydGVkLnB1c2goInJlc2V0Q29udGV4dFByb2JhYmlsaXRpZXMiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChjb2QudGVybWluYXRpb25PbkVhY2hDb2RpbmdQYXNzKSB7CiAgICAgICAgICAgICAgICB1bnN1cHBvcnRlZC5wdXNoKCJ0ZXJtaW5hdGlvbk9uRWFjaENvZGluZ1Bhc3MiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChjb2QudmVydGljYWxseVN0cmlwZSkgewogICAgICAgICAgICAgICAgdW5zdXBwb3J0ZWQucHVzaCgidmVydGljYWxseVN0cmlwZSIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKGNvZC5wcmVkaWN0YWJsZVRlcm1pbmF0aW9uKSB7CiAgICAgICAgICAgICAgICB1bnN1cHBvcnRlZC5wdXNoKCJwcmVkaWN0YWJsZVRlcm1pbmF0aW9uIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAodW5zdXBwb3J0ZWQubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgZG9Ob3RSZWNvdmVyID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVW5zdXBwb3J0ZWQgQ09EIG9wdGlvbnMgKCIgKyB1bnN1cHBvcnRlZC5qb2luKCIsICIpICsgIikiKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmIChjb250ZXh0Lm1haW5IZWFkZXIpIHsKICAgICAgICAgICAgICAgIGNvbnRleHQuQ09EID0gY29kOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb250ZXh0LmN1cnJlbnRUaWxlLkNPRCA9IGNvZDsKICAgICAgICAgICAgICAgIGNvbnRleHQuY3VycmVudFRpbGUuQ09DID0gW107CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMHhmZjkwOgogICAgICAgICAgICAgIGxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDE2KShkYXRhLCBwb3NpdGlvbik7CiAgICAgICAgICAgICAgdGlsZSA9IHt9OwogICAgICAgICAgICAgIHRpbGUuaW5kZXggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24gKyAyKTsKICAgICAgICAgICAgICB0aWxlLmxlbmd0aCA9ICgwLCBfY29yZV91dGlscy5yZWFkVWludDMyKShkYXRhLCBwb3NpdGlvbiArIDQpOwogICAgICAgICAgICAgIHRpbGUuZGF0YUVuZCA9IHRpbGUubGVuZ3RoICsgcG9zaXRpb24gLSAyOwogICAgICAgICAgICAgIHRpbGUucGFydEluZGV4ID0gZGF0YVtwb3NpdGlvbiArIDhdOwogICAgICAgICAgICAgIHRpbGUucGFydHNDb3VudCA9IGRhdGFbcG9zaXRpb24gKyA5XTsKICAgICAgICAgICAgICBjb250ZXh0Lm1haW5IZWFkZXIgPSBmYWxzZTsKCiAgICAgICAgICAgICAgaWYgKHRpbGUucGFydEluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICB0aWxlLkNPRCA9IGNvbnRleHQuQ09EOwogICAgICAgICAgICAgICAgdGlsZS5DT0MgPSBjb250ZXh0LkNPQy5zbGljZSgwKTsKICAgICAgICAgICAgICAgIHRpbGUuUUNEID0gY29udGV4dC5RQ0Q7CiAgICAgICAgICAgICAgICB0aWxlLlFDQyA9IGNvbnRleHQuUUNDLnNsaWNlKDApOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29udGV4dC5jdXJyZW50VGlsZSA9IHRpbGU7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4ZmY5MzoKICAgICAgICAgICAgICB0aWxlID0gY29udGV4dC5jdXJyZW50VGlsZTsKCiAgICAgICAgICAgICAgaWYgKHRpbGUucGFydEluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICBpbml0aWFsaXplVGlsZShjb250ZXh0LCB0aWxlLmluZGV4KTsKICAgICAgICAgICAgICAgIGJ1aWxkUGFja2V0cyhjb250ZXh0KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGxlbmd0aCA9IHRpbGUuZGF0YUVuZCAtIHBvc2l0aW9uOwogICAgICAgICAgICAgIHBhcnNlVGlsZVBhY2tldHMoY29udGV4dCwgZGF0YSwgcG9zaXRpb24sIGxlbmd0aCk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDB4ZmY1NToKICAgICAgICAgICAgY2FzZSAweGZmNTc6CiAgICAgICAgICAgIGNhc2UgMHhmZjU4OgogICAgICAgICAgICBjYXNlIDB4ZmY2NDoKICAgICAgICAgICAgICBsZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQxNikoZGF0YSwgcG9zaXRpb24pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAweGZmNTM6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDb2Rlc3RyZWFtIGNvZGUgMHhGRjUzIChDT0MpIGlzIG5vdCBpbXBsZW1lbnRlZCIpOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gY29kZXN0cmVhbSBjb2RlOiAiICsgY29kZS50b1N0cmluZygxNikpOwogICAgICAgICAgfQoKICAgICAgICAgIHBvc2l0aW9uICs9IGxlbmd0aDsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBpZiAoZG9Ob3RSZWNvdmVyIHx8IHRoaXMuZmFpbE9uQ29ycnVwdGVkSW1hZ2UpIHsKICAgICAgICAgIHRocm93IG5ldyBKcHhFcnJvcihlLm1lc3NhZ2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkpQWDogVHJ5aW5nIHRvIHJlY292ZXIgZnJvbTogIiArIGUubWVzc2FnZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLnRpbGVzID0gdHJhbnNmb3JtQ29tcG9uZW50cyhjb250ZXh0KTsKICAgICAgdGhpcy53aWR0aCA9IGNvbnRleHQuU0laLlhzaXogLSBjb250ZXh0LlNJWi5YT3NpejsKICAgICAgdGhpcy5oZWlnaHQgPSBjb250ZXh0LlNJWi5Zc2l6IC0gY29udGV4dC5TSVouWU9zaXo7CiAgICAgIHRoaXMuY29tcG9uZW50c0NvdW50ID0gY29udGV4dC5TSVouQ3NpejsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBjYWxjdWxhdGVDb21wb25lbnREaW1lbnNpb25zKGNvbXBvbmVudCwgc2l6KSB7CiAgICBjb21wb25lbnQueDAgPSBNYXRoLmNlaWwoc2l6LlhPc2l6IC8gY29tcG9uZW50LlhSc2l6KTsKICAgIGNvbXBvbmVudC54MSA9IE1hdGguY2VpbChzaXouWHNpeiAvIGNvbXBvbmVudC5YUnNpeik7CiAgICBjb21wb25lbnQueTAgPSBNYXRoLmNlaWwoc2l6LllPc2l6IC8gY29tcG9uZW50LllSc2l6KTsKICAgIGNvbXBvbmVudC55MSA9IE1hdGguY2VpbChzaXouWXNpeiAvIGNvbXBvbmVudC5ZUnNpeik7CiAgICBjb21wb25lbnQud2lkdGggPSBjb21wb25lbnQueDEgLSBjb21wb25lbnQueDA7CiAgICBjb21wb25lbnQuaGVpZ2h0ID0gY29tcG9uZW50LnkxIC0gY29tcG9uZW50LnkwOwogIH0KCiAgZnVuY3Rpb24gY2FsY3VsYXRlVGlsZUdyaWRzKGNvbnRleHQsIGNvbXBvbmVudHMpIHsKICAgIHZhciBzaXogPSBjb250ZXh0LlNJWjsKICAgIHZhciB0aWxlLAogICAgICAgIHRpbGVzID0gW107CiAgICB2YXIgbnVtWHRpbGVzID0gTWF0aC5jZWlsKChzaXouWHNpeiAtIHNpei5YVE9zaXopIC8gc2l6LlhUc2l6KTsKICAgIHZhciBudW1ZdGlsZXMgPSBNYXRoLmNlaWwoKHNpei5Zc2l6IC0gc2l6LllUT3NpeikgLyBzaXouWVRzaXopOwoKICAgIGZvciAodmFyIHEgPSAwOyBxIDwgbnVtWXRpbGVzOyBxKyspIHsKICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBudW1YdGlsZXM7IHArKykgewogICAgICAgIHRpbGUgPSB7fTsKICAgICAgICB0aWxlLnR4MCA9IE1hdGgubWF4KHNpei5YVE9zaXogKyBwICogc2l6LlhUc2l6LCBzaXouWE9zaXopOwogICAgICAgIHRpbGUudHkwID0gTWF0aC5tYXgoc2l6LllUT3NpeiArIHEgKiBzaXouWVRzaXosIHNpei5ZT3Npeik7CiAgICAgICAgdGlsZS50eDEgPSBNYXRoLm1pbihzaXouWFRPc2l6ICsgKHAgKyAxKSAqIHNpei5YVHNpeiwgc2l6LlhzaXopOwogICAgICAgIHRpbGUudHkxID0gTWF0aC5taW4oc2l6LllUT3NpeiArIChxICsgMSkgKiBzaXouWVRzaXosIHNpei5Zc2l6KTsKICAgICAgICB0aWxlLndpZHRoID0gdGlsZS50eDEgLSB0aWxlLnR4MDsKICAgICAgICB0aWxlLmhlaWdodCA9IHRpbGUudHkxIC0gdGlsZS50eTA7CiAgICAgICAgdGlsZS5jb21wb25lbnRzID0gW107CiAgICAgICAgdGlsZXMucHVzaCh0aWxlKTsKICAgICAgfQogICAgfQoKICAgIGNvbnRleHQudGlsZXMgPSB0aWxlczsKICAgIHZhciBjb21wb25lbnRzQ291bnQgPSBzaXouQ3NpejsKCiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBjb21wb25lbnRzQ291bnQ7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHZhciBjb21wb25lbnQgPSBjb21wb25lbnRzW2ldOwoKICAgICAgZm9yICh2YXIgaiA9IDAsIGpqID0gdGlsZXMubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgIHZhciB0aWxlQ29tcG9uZW50ID0ge307CiAgICAgICAgdGlsZSA9IHRpbGVzW2pdOwogICAgICAgIHRpbGVDb21wb25lbnQudGN4MCA9IE1hdGguY2VpbCh0aWxlLnR4MCAvIGNvbXBvbmVudC5YUnNpeik7CiAgICAgICAgdGlsZUNvbXBvbmVudC50Y3kwID0gTWF0aC5jZWlsKHRpbGUudHkwIC8gY29tcG9uZW50LllSc2l6KTsKICAgICAgICB0aWxlQ29tcG9uZW50LnRjeDEgPSBNYXRoLmNlaWwodGlsZS50eDEgLyBjb21wb25lbnQuWFJzaXopOwogICAgICAgIHRpbGVDb21wb25lbnQudGN5MSA9IE1hdGguY2VpbCh0aWxlLnR5MSAvIGNvbXBvbmVudC5ZUnNpeik7CiAgICAgICAgdGlsZUNvbXBvbmVudC53aWR0aCA9IHRpbGVDb21wb25lbnQudGN4MSAtIHRpbGVDb21wb25lbnQudGN4MDsKICAgICAgICB0aWxlQ29tcG9uZW50LmhlaWdodCA9IHRpbGVDb21wb25lbnQudGN5MSAtIHRpbGVDb21wb25lbnQudGN5MDsKICAgICAgICB0aWxlLmNvbXBvbmVudHNbaV0gPSB0aWxlQ29tcG9uZW50OwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXRCbG9ja3NEaW1lbnNpb25zKGNvbnRleHQsIGNvbXBvbmVudCwgcikgewogICAgdmFyIGNvZE9yQ29jID0gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVyczsKICAgIHZhciByZXN1bHQgPSB7fTsKCiAgICBpZiAoIWNvZE9yQ29jLmVudHJvcHlDb2RlcldpdGhDdXN0b21QcmVjaW5jdHMpIHsKICAgICAgcmVzdWx0LlBQeCA9IDE1OwogICAgICByZXN1bHQuUFB5ID0gMTU7CiAgICB9IGVsc2UgewogICAgICByZXN1bHQuUFB4ID0gY29kT3JDb2MucHJlY2luY3RzU2l6ZXNbcl0uUFB4OwogICAgICByZXN1bHQuUFB5ID0gY29kT3JDb2MucHJlY2luY3RzU2l6ZXNbcl0uUFB5OwogICAgfQoKICAgIHJlc3VsdC54Y2JfID0gciA+IDAgPyBNYXRoLm1pbihjb2RPckNvYy54Y2IsIHJlc3VsdC5QUHggLSAxKSA6IE1hdGgubWluKGNvZE9yQ29jLnhjYiwgcmVzdWx0LlBQeCk7CiAgICByZXN1bHQueWNiXyA9IHIgPiAwID8gTWF0aC5taW4oY29kT3JDb2MueWNiLCByZXN1bHQuUFB5IC0gMSkgOiBNYXRoLm1pbihjb2RPckNvYy55Y2IsIHJlc3VsdC5QUHkpOwogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIGZ1bmN0aW9uIGJ1aWxkUHJlY2luY3RzKGNvbnRleHQsIHJlc29sdXRpb24sIGRpbWVuc2lvbnMpIHsKICAgIHZhciBwcmVjaW5jdFdpZHRoID0gMSA8PCBkaW1lbnNpb25zLlBQeDsKICAgIHZhciBwcmVjaW5jdEhlaWdodCA9IDEgPDwgZGltZW5zaW9ucy5QUHk7CiAgICB2YXIgaXNaZXJvUmVzID0gcmVzb2x1dGlvbi5yZXNMZXZlbCA9PT0gMDsKICAgIHZhciBwcmVjaW5jdFdpZHRoSW5TdWJiYW5kID0gMSA8PCBkaW1lbnNpb25zLlBQeCArIChpc1plcm9SZXMgPyAwIDogLTEpOwogICAgdmFyIHByZWNpbmN0SGVpZ2h0SW5TdWJiYW5kID0gMSA8PCBkaW1lbnNpb25zLlBQeSArIChpc1plcm9SZXMgPyAwIDogLTEpOwogICAgdmFyIG51bXByZWNpbmN0c3dpZGUgPSByZXNvbHV0aW9uLnRyeDEgPiByZXNvbHV0aW9uLnRyeDAgPyBNYXRoLmNlaWwocmVzb2x1dGlvbi50cngxIC8gcHJlY2luY3RXaWR0aCkgLSBNYXRoLmZsb29yKHJlc29sdXRpb24udHJ4MCAvIHByZWNpbmN0V2lkdGgpIDogMDsKICAgIHZhciBudW1wcmVjaW5jdHNoaWdoID0gcmVzb2x1dGlvbi50cnkxID4gcmVzb2x1dGlvbi50cnkwID8gTWF0aC5jZWlsKHJlc29sdXRpb24udHJ5MSAvIHByZWNpbmN0SGVpZ2h0KSAtIE1hdGguZmxvb3IocmVzb2x1dGlvbi50cnkwIC8gcHJlY2luY3RIZWlnaHQpIDogMDsKICAgIHZhciBudW1wcmVjaW5jdHMgPSBudW1wcmVjaW5jdHN3aWRlICogbnVtcHJlY2luY3RzaGlnaDsKICAgIHJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzID0gewogICAgICBwcmVjaW5jdFdpZHRoOiBwcmVjaW5jdFdpZHRoLAogICAgICBwcmVjaW5jdEhlaWdodDogcHJlY2luY3RIZWlnaHQsCiAgICAgIG51bXByZWNpbmN0c3dpZGU6IG51bXByZWNpbmN0c3dpZGUsCiAgICAgIG51bXByZWNpbmN0c2hpZ2g6IG51bXByZWNpbmN0c2hpZ2gsCiAgICAgIG51bXByZWNpbmN0czogbnVtcHJlY2luY3RzLAogICAgICBwcmVjaW5jdFdpZHRoSW5TdWJiYW5kOiBwcmVjaW5jdFdpZHRoSW5TdWJiYW5kLAogICAgICBwcmVjaW5jdEhlaWdodEluU3ViYmFuZDogcHJlY2luY3RIZWlnaHRJblN1YmJhbmQKICAgIH07CiAgfQoKICBmdW5jdGlvbiBidWlsZENvZGVibG9ja3MoY29udGV4dCwgc3ViYmFuZCwgZGltZW5zaW9ucykgewogICAgdmFyIHhjYl8gPSBkaW1lbnNpb25zLnhjYl87CiAgICB2YXIgeWNiXyA9IGRpbWVuc2lvbnMueWNiXzsKICAgIHZhciBjb2RlYmxvY2tXaWR0aCA9IDEgPDwgeGNiXzsKICAgIHZhciBjb2RlYmxvY2tIZWlnaHQgPSAxIDw8IHljYl87CiAgICB2YXIgY2J4MCA9IHN1YmJhbmQudGJ4MCA+PiB4Y2JfOwogICAgdmFyIGNieTAgPSBzdWJiYW5kLnRieTAgPj4geWNiXzsKICAgIHZhciBjYngxID0gc3ViYmFuZC50YngxICsgY29kZWJsb2NrV2lkdGggLSAxID4+IHhjYl87CiAgICB2YXIgY2J5MSA9IHN1YmJhbmQudGJ5MSArIGNvZGVibG9ja0hlaWdodCAtIDEgPj4geWNiXzsKICAgIHZhciBwcmVjaW5jdFBhcmFtZXRlcnMgPSBzdWJiYW5kLnJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzOwogICAgdmFyIGNvZGVibG9ja3MgPSBbXTsKICAgIHZhciBwcmVjaW5jdHMgPSBbXTsKICAgIHZhciBpLCBqLCBjb2RlYmxvY2ssIHByZWNpbmN0TnVtYmVyOwoKICAgIGZvciAoaiA9IGNieTA7IGogPCBjYnkxOyBqKyspIHsKICAgICAgZm9yIChpID0gY2J4MDsgaSA8IGNieDE7IGkrKykgewogICAgICAgIGNvZGVibG9jayA9IHsKICAgICAgICAgIGNieDogaSwKICAgICAgICAgIGNieTogaiwKICAgICAgICAgIHRieDA6IGNvZGVibG9ja1dpZHRoICogaSwKICAgICAgICAgIHRieTA6IGNvZGVibG9ja0hlaWdodCAqIGosCiAgICAgICAgICB0YngxOiBjb2RlYmxvY2tXaWR0aCAqIChpICsgMSksCiAgICAgICAgICB0YnkxOiBjb2RlYmxvY2tIZWlnaHQgKiAoaiArIDEpCiAgICAgICAgfTsKICAgICAgICBjb2RlYmxvY2sudGJ4MF8gPSBNYXRoLm1heChzdWJiYW5kLnRieDAsIGNvZGVibG9jay50YngwKTsKICAgICAgICBjb2RlYmxvY2sudGJ5MF8gPSBNYXRoLm1heChzdWJiYW5kLnRieTAsIGNvZGVibG9jay50YnkwKTsKICAgICAgICBjb2RlYmxvY2sudGJ4MV8gPSBNYXRoLm1pbihzdWJiYW5kLnRieDEsIGNvZGVibG9jay50YngxKTsKICAgICAgICBjb2RlYmxvY2sudGJ5MV8gPSBNYXRoLm1pbihzdWJiYW5kLnRieTEsIGNvZGVibG9jay50YnkxKTsKICAgICAgICB2YXIgcGkgPSBNYXRoLmZsb29yKChjb2RlYmxvY2sudGJ4MF8gLSBzdWJiYW5kLnRieDApIC8gcHJlY2luY3RQYXJhbWV0ZXJzLnByZWNpbmN0V2lkdGhJblN1YmJhbmQpOwogICAgICAgIHZhciBwaiA9IE1hdGguZmxvb3IoKGNvZGVibG9jay50YnkwXyAtIHN1YmJhbmQudGJ5MCkgLyBwcmVjaW5jdFBhcmFtZXRlcnMucHJlY2luY3RIZWlnaHRJblN1YmJhbmQpOwogICAgICAgIHByZWNpbmN0TnVtYmVyID0gcGkgKyBwaiAqIHByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHN3aWRlOwogICAgICAgIGNvZGVibG9jay5wcmVjaW5jdE51bWJlciA9IHByZWNpbmN0TnVtYmVyOwogICAgICAgIGNvZGVibG9jay5zdWJiYW5kVHlwZSA9IHN1YmJhbmQudHlwZTsKICAgICAgICBjb2RlYmxvY2suTGJsb2NrID0gMzsKCiAgICAgICAgaWYgKGNvZGVibG9jay50YngxXyA8PSBjb2RlYmxvY2sudGJ4MF8gfHwgY29kZWJsb2NrLnRieTFfIDw9IGNvZGVibG9jay50YnkwXykgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb2RlYmxvY2tzLnB1c2goY29kZWJsb2NrKTsKICAgICAgICB2YXIgcHJlY2luY3QgPSBwcmVjaW5jdHNbcHJlY2luY3ROdW1iZXJdOwoKICAgICAgICBpZiAocHJlY2luY3QgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgaWYgKGkgPCBwcmVjaW5jdC5jYnhNaW4pIHsKICAgICAgICAgICAgcHJlY2luY3QuY2J4TWluID0gaTsKICAgICAgICAgIH0gZWxzZSBpZiAoaSA+IHByZWNpbmN0LmNieE1heCkgewogICAgICAgICAgICBwcmVjaW5jdC5jYnhNYXggPSBpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChqIDwgcHJlY2luY3QuY2J5TWluKSB7CiAgICAgICAgICAgIHByZWNpbmN0LmNieE1pbiA9IGo7CiAgICAgICAgICB9IGVsc2UgaWYgKGogPiBwcmVjaW5jdC5jYnlNYXgpIHsKICAgICAgICAgICAgcHJlY2luY3QuY2J5TWF4ID0gajsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcHJlY2luY3RzW3ByZWNpbmN0TnVtYmVyXSA9IHByZWNpbmN0ID0gewogICAgICAgICAgICBjYnhNaW46IGksCiAgICAgICAgICAgIGNieU1pbjogaiwKICAgICAgICAgICAgY2J4TWF4OiBpLAogICAgICAgICAgICBjYnlNYXg6IGoKICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICBjb2RlYmxvY2sucHJlY2luY3QgPSBwcmVjaW5jdDsKICAgICAgfQogICAgfQoKICAgIHN1YmJhbmQuY29kZWJsb2NrUGFyYW1ldGVycyA9IHsKICAgICAgY29kZWJsb2NrV2lkdGg6IHhjYl8sCiAgICAgIGNvZGVibG9ja0hlaWdodDogeWNiXywKICAgICAgbnVtY29kZWJsb2Nrd2lkZTogY2J4MSAtIGNieDAgKyAxLAogICAgICBudW1jb2RlYmxvY2toaWdoOiBjYnkxIC0gY2J5MCArIDEKICAgIH07CiAgICBzdWJiYW5kLmNvZGVibG9ja3MgPSBjb2RlYmxvY2tzOwogICAgc3ViYmFuZC5wcmVjaW5jdHMgPSBwcmVjaW5jdHM7CiAgfQoKICBmdW5jdGlvbiBjcmVhdGVQYWNrZXQocmVzb2x1dGlvbiwgcHJlY2luY3ROdW1iZXIsIGxheWVyTnVtYmVyKSB7CiAgICB2YXIgcHJlY2luY3RDb2RlYmxvY2tzID0gW107CiAgICB2YXIgc3ViYmFuZHMgPSByZXNvbHV0aW9uLnN1YmJhbmRzOwoKICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHN1YmJhbmRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgdmFyIHN1YmJhbmQgPSBzdWJiYW5kc1tpXTsKICAgICAgdmFyIGNvZGVibG9ja3MgPSBzdWJiYW5kLmNvZGVibG9ja3M7CgogICAgICBmb3IgKHZhciBqID0gMCwgamogPSBjb2RlYmxvY2tzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICB2YXIgY29kZWJsb2NrID0gY29kZWJsb2Nrc1tqXTsKCiAgICAgICAgaWYgKGNvZGVibG9jay5wcmVjaW5jdE51bWJlciAhPT0gcHJlY2luY3ROdW1iZXIpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgcHJlY2luY3RDb2RlYmxvY2tzLnB1c2goY29kZWJsb2NrKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGxheWVyTnVtYmVyOiBsYXllck51bWJlciwKICAgICAgY29kZWJsb2NrczogcHJlY2luY3RDb2RlYmxvY2tzCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gTGF5ZXJSZXNvbHV0aW9uQ29tcG9uZW50UG9zaXRpb25JdGVyYXRvcihjb250ZXh0KSB7CiAgICB2YXIgc2l6ID0gY29udGV4dC5TSVo7CiAgICB2YXIgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICAgIHZhciB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogICAgdmFyIGxheWVyc0NvdW50ID0gdGlsZS5jb2RpbmdTdHlsZURlZmF1bHRQYXJhbWV0ZXJzLmxheWVyc0NvdW50OwogICAgdmFyIGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwogICAgdmFyIG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IDA7CgogICAgZm9yICh2YXIgcSA9IDA7IHEgPCBjb21wb25lbnRzQ291bnQ7IHErKykgewogICAgICBtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSBNYXRoLm1heChtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQsIHRpbGUuY29tcG9uZW50c1txXS5jb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50KTsKICAgIH0KCiAgICB2YXIgbCA9IDAsCiAgICAgICAgciA9IDAsCiAgICAgICAgaSA9IDAsCiAgICAgICAgayA9IDA7CgogICAgdGhpcy5uZXh0UGFja2V0ID0gZnVuY3Rpb24gSnB4SW1hZ2VfbmV4dFBhY2tldCgpIHsKICAgICAgZm9yICg7IGwgPCBsYXllcnNDb3VudDsgbCsrKSB7CiAgICAgICAgZm9yICg7IHIgPD0gbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByKyspIHsKICAgICAgICAgIGZvciAoOyBpIDwgY29tcG9uZW50c0NvdW50OyBpKyspIHsKICAgICAgICAgICAgdmFyIGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tpXTsKCiAgICAgICAgICAgIGlmIChyID4gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHJlc29sdXRpb24gPSBjb21wb25lbnQucmVzb2x1dGlvbnNbcl07CiAgICAgICAgICAgIHZhciBudW1wcmVjaW5jdHMgPSByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHM7CgogICAgICAgICAgICBmb3IgKDsgayA8IG51bXByZWNpbmN0czspIHsKICAgICAgICAgICAgICB2YXIgcGFja2V0ID0gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIGssIGwpOwogICAgICAgICAgICAgIGsrKzsKICAgICAgICAgICAgICByZXR1cm4gcGFja2V0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBrID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICBpID0gMDsKICAgICAgICB9CgogICAgICAgIHIgPSAwOwogICAgICB9CgogICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk91dCBvZiBwYWNrZXRzIik7CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gUmVzb2x1dGlvbkxheWVyQ29tcG9uZW50UG9zaXRpb25JdGVyYXRvcihjb250ZXh0KSB7CiAgICB2YXIgc2l6ID0gY29udGV4dC5TSVo7CiAgICB2YXIgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICAgIHZhciB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogICAgdmFyIGxheWVyc0NvdW50ID0gdGlsZS5jb2RpbmdTdHlsZURlZmF1bHRQYXJhbWV0ZXJzLmxheWVyc0NvdW50OwogICAgdmFyIGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwogICAgdmFyIG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IDA7CgogICAgZm9yICh2YXIgcSA9IDA7IHEgPCBjb21wb25lbnRzQ291bnQ7IHErKykgewogICAgICBtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSBNYXRoLm1heChtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQsIHRpbGUuY29tcG9uZW50c1txXS5jb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50KTsKICAgIH0KCiAgICB2YXIgciA9IDAsCiAgICAgICAgbCA9IDAsCiAgICAgICAgaSA9IDAsCiAgICAgICAgayA9IDA7CgogICAgdGhpcy5uZXh0UGFja2V0ID0gZnVuY3Rpb24gSnB4SW1hZ2VfbmV4dFBhY2tldCgpIHsKICAgICAgZm9yICg7IHIgPD0gbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByKyspIHsKICAgICAgICBmb3IgKDsgbCA8IGxheWVyc0NvdW50OyBsKyspIHsKICAgICAgICAgIGZvciAoOyBpIDwgY29tcG9uZW50c0NvdW50OyBpKyspIHsKICAgICAgICAgICAgdmFyIGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tpXTsKCiAgICAgICAgICAgIGlmIChyID4gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHJlc29sdXRpb24gPSBjb21wb25lbnQucmVzb2x1dGlvbnNbcl07CiAgICAgICAgICAgIHZhciBudW1wcmVjaW5jdHMgPSByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHM7CgogICAgICAgICAgICBmb3IgKDsgayA8IG51bXByZWNpbmN0czspIHsKICAgICAgICAgICAgICB2YXIgcGFja2V0ID0gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIGssIGwpOwogICAgICAgICAgICAgIGsrKzsKICAgICAgICAgICAgICByZXR1cm4gcGFja2V0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBrID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICBpID0gMDsKICAgICAgICB9CgogICAgICAgIGwgPSAwOwogICAgICB9CgogICAgICB0aHJvdyBuZXcgSnB4RXJyb3IoIk91dCBvZiBwYWNrZXRzIik7CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gUmVzb2x1dGlvblBvc2l0aW9uQ29tcG9uZW50TGF5ZXJJdGVyYXRvcihjb250ZXh0KSB7CiAgICB2YXIgc2l6ID0gY29udGV4dC5TSVo7CiAgICB2YXIgdGlsZUluZGV4ID0gY29udGV4dC5jdXJyZW50VGlsZS5pbmRleDsKICAgIHZhciB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwogICAgdmFyIGxheWVyc0NvdW50ID0gdGlsZS5jb2RpbmdTdHlsZURlZmF1bHRQYXJhbWV0ZXJzLmxheWVyc0NvdW50OwogICAgdmFyIGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwogICAgdmFyIGwsIHIsIGMsIHA7CiAgICB2YXIgbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gMDsKCiAgICBmb3IgKGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgICAgdmFyIGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICAgICAgbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gTWF0aC5tYXgobWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50LCBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzLmRlY29tcG9zaXRpb25MZXZlbHNDb3VudCk7CiAgICB9CgogICAgdmFyIG1heE51bVByZWNpbmN0c0luTGV2ZWwgPSBuZXcgSW50MzJBcnJheShtYXhEZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgKyAxKTsKCiAgICBmb3IgKHIgPSAwOyByIDw9IG1heERlY29tcG9zaXRpb25MZXZlbHNDb3VudDsgKytyKSB7CiAgICAgIHZhciBtYXhOdW1QcmVjaW5jdHMgPSAwOwoKICAgICAgZm9yIChjID0gMDsgYyA8IGNvbXBvbmVudHNDb3VudDsgKytjKSB7CiAgICAgICAgdmFyIHJlc29sdXRpb25zID0gdGlsZS5jb21wb25lbnRzW2NdLnJlc29sdXRpb25zOwoKICAgICAgICBpZiAociA8IHJlc29sdXRpb25zLmxlbmd0aCkgewogICAgICAgICAgbWF4TnVtUHJlY2luY3RzID0gTWF0aC5tYXgobWF4TnVtUHJlY2luY3RzLCByZXNvbHV0aW9uc1tyXS5wcmVjaW5jdFBhcmFtZXRlcnMubnVtcHJlY2luY3RzKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1heE51bVByZWNpbmN0c0luTGV2ZWxbcl0gPSBtYXhOdW1QcmVjaW5jdHM7CiAgICB9CgogICAgbCA9IDA7CiAgICByID0gMDsKICAgIGMgPSAwOwogICAgcCA9IDA7CgogICAgdGhpcy5uZXh0UGFja2V0ID0gZnVuY3Rpb24gSnB4SW1hZ2VfbmV4dFBhY2tldCgpIHsKICAgICAgZm9yICg7IHIgPD0gbWF4RGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByKyspIHsKICAgICAgICBmb3IgKDsgcCA8IG1heE51bVByZWNpbmN0c0luTGV2ZWxbcl07IHArKykgewogICAgICAgICAgZm9yICg7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgICAgICAgICB2YXIgX2NvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKCiAgICAgICAgICAgIGlmIChyID4gX2NvbXBvbmVudC5jb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50KSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciByZXNvbHV0aW9uID0gX2NvbXBvbmVudC5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgICAgdmFyIG51bXByZWNpbmN0cyA9IHJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0czsKCiAgICAgICAgICAgIGlmIChwID49IG51bXByZWNpbmN0cykgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgKDsgbCA8IGxheWVyc0NvdW50OykgewogICAgICAgICAgICAgIHZhciBwYWNrZXQgPSBjcmVhdGVQYWNrZXQocmVzb2x1dGlvbiwgcCwgbCk7CiAgICAgICAgICAgICAgbCsrOwogICAgICAgICAgICAgIHJldHVybiBwYWNrZXQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGwgPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIGMgPSAwOwogICAgICAgIH0KCiAgICAgICAgcCA9IDA7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBKcHhFcnJvcigiT3V0IG9mIHBhY2tldHMiKTsKICAgIH07CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvbkNvbXBvbmVudFJlc29sdXRpb25MYXllckl0ZXJhdG9yKGNvbnRleHQpIHsKICAgIHZhciBzaXogPSBjb250ZXh0LlNJWjsKICAgIHZhciB0aWxlSW5kZXggPSBjb250ZXh0LmN1cnJlbnRUaWxlLmluZGV4OwogICAgdmFyIHRpbGUgPSBjb250ZXh0LnRpbGVzW3RpbGVJbmRleF07CiAgICB2YXIgbGF5ZXJzQ291bnQgPSB0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubGF5ZXJzQ291bnQ7CiAgICB2YXIgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CiAgICB2YXIgcHJlY2luY3RzU2l6ZXMgPSBnZXRQcmVjaW5jdFNpemVzSW5JbWFnZVNjYWxlKHRpbGUpOwogICAgdmFyIHByZWNpbmN0c0l0ZXJhdGlvblNpemVzID0gcHJlY2luY3RzU2l6ZXM7CiAgICB2YXIgbCA9IDAsCiAgICAgICAgciA9IDAsCiAgICAgICAgYyA9IDAsCiAgICAgICAgcHggPSAwLAogICAgICAgIHB5ID0gMDsKCiAgICB0aGlzLm5leHRQYWNrZXQgPSBmdW5jdGlvbiBKcHhJbWFnZV9uZXh0UGFja2V0KCkgewogICAgICBmb3IgKDsgcHkgPCBwcmVjaW5jdHNJdGVyYXRpb25TaXplcy5tYXhOdW1IaWdoOyBweSsrKSB7CiAgICAgICAgZm9yICg7IHB4IDwgcHJlY2luY3RzSXRlcmF0aW9uU2l6ZXMubWF4TnVtV2lkZTsgcHgrKykgewogICAgICAgICAgZm9yICg7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgICAgICAgICB2YXIgY29tcG9uZW50ID0gdGlsZS5jb21wb25lbnRzW2NdOwogICAgICAgICAgICB2YXIgZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7CgogICAgICAgICAgICBmb3IgKDsgciA8PSBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7IHIrKykgewogICAgICAgICAgICAgIHZhciByZXNvbHV0aW9uID0gY29tcG9uZW50LnJlc29sdXRpb25zW3JdOwogICAgICAgICAgICAgIHZhciBzaXplSW5JbWFnZVNjYWxlID0gcHJlY2luY3RzU2l6ZXMuY29tcG9uZW50c1tjXS5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgICAgICB2YXIgayA9IGdldFByZWNpbmN0SW5kZXhJZkV4aXN0KHB4LCBweSwgc2l6ZUluSW1hZ2VTY2FsZSwgcHJlY2luY3RzSXRlcmF0aW9uU2l6ZXMsIHJlc29sdXRpb24pOwoKICAgICAgICAgICAgICBpZiAoayA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3IgKDsgbCA8IGxheWVyc0NvdW50OykgewogICAgICAgICAgICAgICAgdmFyIHBhY2tldCA9IGNyZWF0ZVBhY2tldChyZXNvbHV0aW9uLCBrLCBsKTsKICAgICAgICAgICAgICAgIGwrKzsKICAgICAgICAgICAgICAgIHJldHVybiBwYWNrZXQ7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBsID0gMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgciA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgYyA9IDA7CiAgICAgICAgfQoKICAgICAgICBweCA9IDA7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBKcHhFcnJvcigiT3V0IG9mIHBhY2tldHMiKTsKICAgIH07CiAgfQoKICBmdW5jdGlvbiBDb21wb25lbnRQb3NpdGlvblJlc29sdXRpb25MYXllckl0ZXJhdG9yKGNvbnRleHQpIHsKICAgIHZhciBzaXogPSBjb250ZXh0LlNJWjsKICAgIHZhciB0aWxlSW5kZXggPSBjb250ZXh0LmN1cnJlbnRUaWxlLmluZGV4OwogICAgdmFyIHRpbGUgPSBjb250ZXh0LnRpbGVzW3RpbGVJbmRleF07CiAgICB2YXIgbGF5ZXJzQ291bnQgPSB0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubGF5ZXJzQ291bnQ7CiAgICB2YXIgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CiAgICB2YXIgcHJlY2luY3RzU2l6ZXMgPSBnZXRQcmVjaW5jdFNpemVzSW5JbWFnZVNjYWxlKHRpbGUpOwogICAgdmFyIGwgPSAwLAogICAgICAgIHIgPSAwLAogICAgICAgIGMgPSAwLAogICAgICAgIHB4ID0gMCwKICAgICAgICBweSA9IDA7CgogICAgdGhpcy5uZXh0UGFja2V0ID0gZnVuY3Rpb24gSnB4SW1hZ2VfbmV4dFBhY2tldCgpIHsKICAgICAgZm9yICg7IGMgPCBjb21wb25lbnRzQ291bnQ7ICsrYykgewogICAgICAgIHZhciBjb21wb25lbnQgPSB0aWxlLmNvbXBvbmVudHNbY107CiAgICAgICAgdmFyIHByZWNpbmN0c0l0ZXJhdGlvblNpemVzID0gcHJlY2luY3RzU2l6ZXMuY29tcG9uZW50c1tjXTsKICAgICAgICB2YXIgZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7CgogICAgICAgIGZvciAoOyBweSA8IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzLm1heE51bUhpZ2g7IHB5KyspIHsKICAgICAgICAgIGZvciAoOyBweCA8IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzLm1heE51bVdpZGU7IHB4KyspIHsKICAgICAgICAgICAgZm9yICg7IHIgPD0gZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByKyspIHsKICAgICAgICAgICAgICB2YXIgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tyXTsKICAgICAgICAgICAgICB2YXIgc2l6ZUluSW1hZ2VTY2FsZSA9IHByZWNpbmN0c0l0ZXJhdGlvblNpemVzLnJlc29sdXRpb25zW3JdOwogICAgICAgICAgICAgIHZhciBrID0gZ2V0UHJlY2luY3RJbmRleElmRXhpc3QocHgsIHB5LCBzaXplSW5JbWFnZVNjYWxlLCBwcmVjaW5jdHNJdGVyYXRpb25TaXplcywgcmVzb2x1dGlvbik7CgogICAgICAgICAgICAgIGlmIChrID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvciAoOyBsIDwgbGF5ZXJzQ291bnQ7KSB7CiAgICAgICAgICAgICAgICB2YXIgcGFja2V0ID0gY3JlYXRlUGFja2V0KHJlc29sdXRpb24sIGssIGwpOwogICAgICAgICAgICAgICAgbCsrOwogICAgICAgICAgICAgICAgcmV0dXJuIHBhY2tldDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGwgPSAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICByID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICBweCA9IDA7CiAgICAgICAgfQoKICAgICAgICBweSA9IDA7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBKcHhFcnJvcigiT3V0IG9mIHBhY2tldHMiKTsKICAgIH07CiAgfQoKICBmdW5jdGlvbiBnZXRQcmVjaW5jdEluZGV4SWZFeGlzdChweEluZGV4LCBweUluZGV4LCBzaXplSW5JbWFnZVNjYWxlLCBwcmVjaW5jdEl0ZXJhdGlvblNpemVzLCByZXNvbHV0aW9uKSB7CiAgICB2YXIgcG9zWCA9IHB4SW5kZXggKiBwcmVjaW5jdEl0ZXJhdGlvblNpemVzLm1pbldpZHRoOwogICAgdmFyIHBvc1kgPSBweUluZGV4ICogcHJlY2luY3RJdGVyYXRpb25TaXplcy5taW5IZWlnaHQ7CgogICAgaWYgKHBvc1ggJSBzaXplSW5JbWFnZVNjYWxlLndpZHRoICE9PSAwIHx8IHBvc1kgJSBzaXplSW5JbWFnZVNjYWxlLmhlaWdodCAhPT0gMCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICB2YXIgc3RhcnRQcmVjaW5jdFJvd0luZGV4ID0gcG9zWSAvIHNpemVJbkltYWdlU2NhbGUud2lkdGggKiByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5udW1wcmVjaW5jdHN3aWRlOwogICAgcmV0dXJuIHBvc1ggLyBzaXplSW5JbWFnZVNjYWxlLmhlaWdodCArIHN0YXJ0UHJlY2luY3RSb3dJbmRleDsKICB9CgogIGZ1bmN0aW9uIGdldFByZWNpbmN0U2l6ZXNJbkltYWdlU2NhbGUodGlsZSkgewogICAgdmFyIGNvbXBvbmVudHNDb3VudCA9IHRpbGUuY29tcG9uZW50cy5sZW5ndGg7CiAgICB2YXIgbWluV2lkdGggPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgdmFyIG1pbkhlaWdodCA9IE51bWJlci5NQVhfVkFMVUU7CiAgICB2YXIgbWF4TnVtV2lkZSA9IDA7CiAgICB2YXIgbWF4TnVtSGlnaCA9IDA7CiAgICB2YXIgc2l6ZVBlckNvbXBvbmVudCA9IG5ldyBBcnJheShjb21wb25lbnRzQ291bnQpOwoKICAgIGZvciAodmFyIGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgICAgdmFyIGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICAgICAgdmFyIGRlY29tcG9zaXRpb25MZXZlbHNDb3VudCA9IGNvbXBvbmVudC5jb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OwogICAgICB2YXIgc2l6ZVBlclJlc29sdXRpb24gPSBuZXcgQXJyYXkoZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ICsgMSk7CiAgICAgIHZhciBtaW5XaWR0aEN1cnJlbnRDb21wb25lbnQgPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICB2YXIgbWluSGVpZ2h0Q3VycmVudENvbXBvbmVudCA9IE51bWJlci5NQVhfVkFMVUU7CiAgICAgIHZhciBtYXhOdW1XaWRlQ3VycmVudENvbXBvbmVudCA9IDA7CiAgICAgIHZhciBtYXhOdW1IaWdoQ3VycmVudENvbXBvbmVudCA9IDA7CiAgICAgIHZhciBzY2FsZSA9IDE7CgogICAgICBmb3IgKHZhciByID0gZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OyByID49IDA7IC0tcikgewogICAgICAgIHZhciByZXNvbHV0aW9uID0gY29tcG9uZW50LnJlc29sdXRpb25zW3JdOwogICAgICAgIHZhciB3aWR0aEN1cnJlbnRSZXNvbHV0aW9uID0gc2NhbGUgKiByZXNvbHV0aW9uLnByZWNpbmN0UGFyYW1ldGVycy5wcmVjaW5jdFdpZHRoOwogICAgICAgIHZhciBoZWlnaHRDdXJyZW50UmVzb2x1dGlvbiA9IHNjYWxlICogcmVzb2x1dGlvbi5wcmVjaW5jdFBhcmFtZXRlcnMucHJlY2luY3RIZWlnaHQ7CiAgICAgICAgbWluV2lkdGhDdXJyZW50Q29tcG9uZW50ID0gTWF0aC5taW4obWluV2lkdGhDdXJyZW50Q29tcG9uZW50LCB3aWR0aEN1cnJlbnRSZXNvbHV0aW9uKTsKICAgICAgICBtaW5IZWlnaHRDdXJyZW50Q29tcG9uZW50ID0gTWF0aC5taW4obWluSGVpZ2h0Q3VycmVudENvbXBvbmVudCwgaGVpZ2h0Q3VycmVudFJlc29sdXRpb24pOwogICAgICAgIG1heE51bVdpZGVDdXJyZW50Q29tcG9uZW50ID0gTWF0aC5tYXgobWF4TnVtV2lkZUN1cnJlbnRDb21wb25lbnQsIHJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0c3dpZGUpOwogICAgICAgIG1heE51bUhpZ2hDdXJyZW50Q29tcG9uZW50ID0gTWF0aC5tYXgobWF4TnVtSGlnaEN1cnJlbnRDb21wb25lbnQsIHJlc29sdXRpb24ucHJlY2luY3RQYXJhbWV0ZXJzLm51bXByZWNpbmN0c2hpZ2gpOwogICAgICAgIHNpemVQZXJSZXNvbHV0aW9uW3JdID0gewogICAgICAgICAgd2lkdGg6IHdpZHRoQ3VycmVudFJlc29sdXRpb24sCiAgICAgICAgICBoZWlnaHQ6IGhlaWdodEN1cnJlbnRSZXNvbHV0aW9uCiAgICAgICAgfTsKICAgICAgICBzY2FsZSA8PD0gMTsKICAgICAgfQoKICAgICAgbWluV2lkdGggPSBNYXRoLm1pbihtaW5XaWR0aCwgbWluV2lkdGhDdXJyZW50Q29tcG9uZW50KTsKICAgICAgbWluSGVpZ2h0ID0gTWF0aC5taW4obWluSGVpZ2h0LCBtaW5IZWlnaHRDdXJyZW50Q29tcG9uZW50KTsKICAgICAgbWF4TnVtV2lkZSA9IE1hdGgubWF4KG1heE51bVdpZGUsIG1heE51bVdpZGVDdXJyZW50Q29tcG9uZW50KTsKICAgICAgbWF4TnVtSGlnaCA9IE1hdGgubWF4KG1heE51bUhpZ2gsIG1heE51bUhpZ2hDdXJyZW50Q29tcG9uZW50KTsKICAgICAgc2l6ZVBlckNvbXBvbmVudFtjXSA9IHsKICAgICAgICByZXNvbHV0aW9uczogc2l6ZVBlclJlc29sdXRpb24sCiAgICAgICAgbWluV2lkdGg6IG1pbldpZHRoQ3VycmVudENvbXBvbmVudCwKICAgICAgICBtaW5IZWlnaHQ6IG1pbkhlaWdodEN1cnJlbnRDb21wb25lbnQsCiAgICAgICAgbWF4TnVtV2lkZTogbWF4TnVtV2lkZUN1cnJlbnRDb21wb25lbnQsCiAgICAgICAgbWF4TnVtSGlnaDogbWF4TnVtSGlnaEN1cnJlbnRDb21wb25lbnQKICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBjb21wb25lbnRzOiBzaXplUGVyQ29tcG9uZW50LAogICAgICBtaW5XaWR0aDogbWluV2lkdGgsCiAgICAgIG1pbkhlaWdodDogbWluSGVpZ2h0LAogICAgICBtYXhOdW1XaWRlOiBtYXhOdW1XaWRlLAogICAgICBtYXhOdW1IaWdoOiBtYXhOdW1IaWdoCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gYnVpbGRQYWNrZXRzKGNvbnRleHQpIHsKICAgIHZhciBzaXogPSBjb250ZXh0LlNJWjsKICAgIHZhciB0aWxlSW5kZXggPSBjb250ZXh0LmN1cnJlbnRUaWxlLmluZGV4OwogICAgdmFyIHRpbGUgPSBjb250ZXh0LnRpbGVzW3RpbGVJbmRleF07CiAgICB2YXIgY29tcG9uZW50c0NvdW50ID0gc2l6LkNzaXo7CgogICAgZm9yICh2YXIgYyA9IDA7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgICB2YXIgY29tcG9uZW50ID0gdGlsZS5jb21wb25lbnRzW2NdOwogICAgICB2YXIgZGVjb21wb3NpdGlvbkxldmVsc0NvdW50ID0gY29tcG9uZW50LmNvZGluZ1N0eWxlUGFyYW1ldGVycy5kZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7CiAgICAgIHZhciByZXNvbHV0aW9ucyA9IFtdOwogICAgICB2YXIgc3ViYmFuZHMgPSBbXTsKCiAgICAgIGZvciAodmFyIHIgPSAwOyByIDw9IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudDsgcisrKSB7CiAgICAgICAgdmFyIGJsb2Nrc0RpbWVuc2lvbnMgPSBnZXRCbG9ja3NEaW1lbnNpb25zKGNvbnRleHQsIGNvbXBvbmVudCwgcik7CiAgICAgICAgdmFyIHJlc29sdXRpb24gPSB7fTsKICAgICAgICB2YXIgc2NhbGUgPSAxIDw8IGRlY29tcG9zaXRpb25MZXZlbHNDb3VudCAtIHI7CiAgICAgICAgcmVzb2x1dGlvbi50cngwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gwIC8gc2NhbGUpOwogICAgICAgIHJlc29sdXRpb24udHJ5MCA9IE1hdGguY2VpbChjb21wb25lbnQudGN5MCAvIHNjYWxlKTsKICAgICAgICByZXNvbHV0aW9uLnRyeDEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDEgLyBzY2FsZSk7CiAgICAgICAgcmVzb2x1dGlvbi50cnkxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kxIC8gc2NhbGUpOwogICAgICAgIHJlc29sdXRpb24ucmVzTGV2ZWwgPSByOwogICAgICAgIGJ1aWxkUHJlY2luY3RzKGNvbnRleHQsIHJlc29sdXRpb24sIGJsb2Nrc0RpbWVuc2lvbnMpOwogICAgICAgIHJlc29sdXRpb25zLnB1c2gocmVzb2x1dGlvbik7CiAgICAgICAgdmFyIHN1YmJhbmQ7CgogICAgICAgIGlmIChyID09PSAwKSB7CiAgICAgICAgICBzdWJiYW5kID0ge307CiAgICAgICAgICBzdWJiYW5kLnR5cGUgPSAiTEwiOwogICAgICAgICAgc3ViYmFuZC50YngwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gwIC8gc2NhbGUpOwogICAgICAgICAgc3ViYmFuZC50YnkwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kwIC8gc2NhbGUpOwogICAgICAgICAgc3ViYmFuZC50YngxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3gxIC8gc2NhbGUpOwogICAgICAgICAgc3ViYmFuZC50YnkxID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kxIC8gc2NhbGUpOwogICAgICAgICAgc3ViYmFuZC5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjsKICAgICAgICAgIGJ1aWxkQ29kZWJsb2Nrcyhjb250ZXh0LCBzdWJiYW5kLCBibG9ja3NEaW1lbnNpb25zKTsKICAgICAgICAgIHN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgICByZXNvbHV0aW9uLnN1YmJhbmRzID0gW3N1YmJhbmRdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgYnNjYWxlID0gMSA8PCBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgLSByICsgMTsKICAgICAgICAgIHZhciByZXNvbHV0aW9uU3ViYmFuZHMgPSBbXTsKICAgICAgICAgIHN1YmJhbmQgPSB7fTsKICAgICAgICAgIHN1YmJhbmQudHlwZSA9ICJITCI7CiAgICAgICAgICBzdWJiYW5kLnRieDAgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDAgLyBic2NhbGUgLSAwLjUpOwogICAgICAgICAgc3ViYmFuZC50YnkwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kwIC8gYnNjYWxlKTsKICAgICAgICAgIHN1YmJhbmQudGJ4MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MSAvIGJzY2FsZSAtIDAuNSk7CiAgICAgICAgICBzdWJiYW5kLnRieTEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeTEgLyBic2NhbGUpOwogICAgICAgICAgc3ViYmFuZC5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjsKICAgICAgICAgIGJ1aWxkQ29kZWJsb2Nrcyhjb250ZXh0LCBzdWJiYW5kLCBibG9ja3NEaW1lbnNpb25zKTsKICAgICAgICAgIHN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgICByZXNvbHV0aW9uU3ViYmFuZHMucHVzaChzdWJiYW5kKTsKICAgICAgICAgIHN1YmJhbmQgPSB7fTsKICAgICAgICAgIHN1YmJhbmQudHlwZSA9ICJMSCI7CiAgICAgICAgICBzdWJiYW5kLnRieDAgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDAgLyBic2NhbGUpOwogICAgICAgICAgc3ViYmFuZC50YnkwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kwIC8gYnNjYWxlIC0gMC41KTsKICAgICAgICAgIHN1YmJhbmQudGJ4MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MSAvIGJzY2FsZSk7CiAgICAgICAgICBzdWJiYW5kLnRieTEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeTEgLyBic2NhbGUgLSAwLjUpOwogICAgICAgICAgc3ViYmFuZC5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjsKICAgICAgICAgIGJ1aWxkQ29kZWJsb2Nrcyhjb250ZXh0LCBzdWJiYW5kLCBibG9ja3NEaW1lbnNpb25zKTsKICAgICAgICAgIHN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgICByZXNvbHV0aW9uU3ViYmFuZHMucHVzaChzdWJiYW5kKTsKICAgICAgICAgIHN1YmJhbmQgPSB7fTsKICAgICAgICAgIHN1YmJhbmQudHlwZSA9ICJISCI7CiAgICAgICAgICBzdWJiYW5kLnRieDAgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeDAgLyBic2NhbGUgLSAwLjUpOwogICAgICAgICAgc3ViYmFuZC50YnkwID0gTWF0aC5jZWlsKGNvbXBvbmVudC50Y3kwIC8gYnNjYWxlIC0gMC41KTsKICAgICAgICAgIHN1YmJhbmQudGJ4MSA9IE1hdGguY2VpbChjb21wb25lbnQudGN4MSAvIGJzY2FsZSAtIDAuNSk7CiAgICAgICAgICBzdWJiYW5kLnRieTEgPSBNYXRoLmNlaWwoY29tcG9uZW50LnRjeTEgLyBic2NhbGUgLSAwLjUpOwogICAgICAgICAgc3ViYmFuZC5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjsKICAgICAgICAgIGJ1aWxkQ29kZWJsb2Nrcyhjb250ZXh0LCBzdWJiYW5kLCBibG9ja3NEaW1lbnNpb25zKTsKICAgICAgICAgIHN1YmJhbmRzLnB1c2goc3ViYmFuZCk7CiAgICAgICAgICByZXNvbHV0aW9uU3ViYmFuZHMucHVzaChzdWJiYW5kKTsKICAgICAgICAgIHJlc29sdXRpb24uc3ViYmFuZHMgPSByZXNvbHV0aW9uU3ViYmFuZHM7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb21wb25lbnQucmVzb2x1dGlvbnMgPSByZXNvbHV0aW9uczsKICAgICAgY29tcG9uZW50LnN1YmJhbmRzID0gc3ViYmFuZHM7CiAgICB9CgogICAgdmFyIHByb2dyZXNzaW9uT3JkZXIgPSB0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMucHJvZ3Jlc3Npb25PcmRlcjsKCiAgICBzd2l0Y2ggKHByb2dyZXNzaW9uT3JkZXIpIHsKICAgICAgY2FzZSAwOgogICAgICAgIHRpbGUucGFja2V0c0l0ZXJhdG9yID0gbmV3IExheWVyUmVzb2x1dGlvbkNvbXBvbmVudFBvc2l0aW9uSXRlcmF0b3IoY29udGV4dCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDE6CiAgICAgICAgdGlsZS5wYWNrZXRzSXRlcmF0b3IgPSBuZXcgUmVzb2x1dGlvbkxheWVyQ29tcG9uZW50UG9zaXRpb25JdGVyYXRvcihjb250ZXh0KTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgMjoKICAgICAgICB0aWxlLnBhY2tldHNJdGVyYXRvciA9IG5ldyBSZXNvbHV0aW9uUG9zaXRpb25Db21wb25lbnRMYXllckl0ZXJhdG9yKGNvbnRleHQpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAzOgogICAgICAgIHRpbGUucGFja2V0c0l0ZXJhdG9yID0gbmV3IFBvc2l0aW9uQ29tcG9uZW50UmVzb2x1dGlvbkxheWVySXRlcmF0b3IoY29udGV4dCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIDQ6CiAgICAgICAgdGlsZS5wYWNrZXRzSXRlcmF0b3IgPSBuZXcgQ29tcG9uZW50UG9zaXRpb25SZXNvbHV0aW9uTGF5ZXJJdGVyYXRvcihjb250ZXh0KTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IEpweEVycm9yKCJVbnN1cHBvcnRlZCBwcm9ncmVzc2lvbiBvcmRlciAiLmNvbmNhdChwcm9ncmVzc2lvbk9yZGVyKSk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwYXJzZVRpbGVQYWNrZXRzKGNvbnRleHQsIGRhdGEsIG9mZnNldCwgZGF0YUxlbmd0aCkgewogICAgdmFyIHBvc2l0aW9uID0gMDsKICAgIHZhciBidWZmZXIsCiAgICAgICAgYnVmZmVyU2l6ZSA9IDAsCiAgICAgICAgc2tpcE5leHRCaXQgPSBmYWxzZTsKCiAgICBmdW5jdGlvbiByZWFkQml0cyhjb3VudCkgewogICAgICB3aGlsZSAoYnVmZmVyU2l6ZSA8IGNvdW50KSB7CiAgICAgICAgdmFyIGIgPSBkYXRhW29mZnNldCArIHBvc2l0aW9uXTsKICAgICAgICBwb3NpdGlvbisrOwoKICAgICAgICBpZiAoc2tpcE5leHRCaXQpIHsKICAgICAgICAgIGJ1ZmZlciA9IGJ1ZmZlciA8PCA3IHwgYjsKICAgICAgICAgIGJ1ZmZlclNpemUgKz0gNzsKICAgICAgICAgIHNraXBOZXh0Qml0ID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJ1ZmZlciA9IGJ1ZmZlciA8PCA4IHwgYjsKICAgICAgICAgIGJ1ZmZlclNpemUgKz0gODsKICAgICAgICB9CgogICAgICAgIGlmIChiID09PSAweGZmKSB7CiAgICAgICAgICBza2lwTmV4dEJpdCA9IHRydWU7CiAgICAgICAgfQogICAgICB9CgogICAgICBidWZmZXJTaXplIC09IGNvdW50OwogICAgICByZXR1cm4gYnVmZmVyID4+PiBidWZmZXJTaXplICYgKDEgPDwgY291bnQpIC0gMTsKICAgIH0KCiAgICBmdW5jdGlvbiBza2lwTWFya2VySWZFcXVhbCh2YWx1ZSkgewogICAgICBpZiAoZGF0YVtvZmZzZXQgKyBwb3NpdGlvbiAtIDFdID09PSAweGZmICYmIGRhdGFbb2Zmc2V0ICsgcG9zaXRpb25dID09PSB2YWx1ZSkgewogICAgICAgIHNraXBCeXRlcygxKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIGlmIChkYXRhW29mZnNldCArIHBvc2l0aW9uXSA9PT0gMHhmZiAmJiBkYXRhW29mZnNldCArIHBvc2l0aW9uICsgMV0gPT09IHZhbHVlKSB7CiAgICAgICAgc2tpcEJ5dGVzKDIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnVuY3Rpb24gc2tpcEJ5dGVzKGNvdW50KSB7CiAgICAgIHBvc2l0aW9uICs9IGNvdW50OwogICAgfQoKICAgIGZ1bmN0aW9uIGFsaWduVG9CeXRlKCkgewogICAgICBidWZmZXJTaXplID0gMDsKCiAgICAgIGlmIChza2lwTmV4dEJpdCkgewogICAgICAgIHBvc2l0aW9uKys7CiAgICAgICAgc2tpcE5leHRCaXQgPSBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHJlYWRDb2RpbmdwYXNzZXMoKSB7CiAgICAgIGlmIChyZWFkQml0cygxKSA9PT0gMCkgewogICAgICAgIHJldHVybiAxOwogICAgICB9CgogICAgICBpZiAocmVhZEJpdHMoMSkgPT09IDApIHsKICAgICAgICByZXR1cm4gMjsKICAgICAgfQoKICAgICAgdmFyIHZhbHVlID0gcmVhZEJpdHMoMik7CgogICAgICBpZiAodmFsdWUgPCAzKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlICsgMzsKICAgICAgfQoKICAgICAgdmFsdWUgPSByZWFkQml0cyg1KTsKCiAgICAgIGlmICh2YWx1ZSA8IDMxKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlICsgNjsKICAgICAgfQoKICAgICAgdmFsdWUgPSByZWFkQml0cyg3KTsKICAgICAgcmV0dXJuIHZhbHVlICsgMzc7CiAgICB9CgogICAgdmFyIHRpbGVJbmRleCA9IGNvbnRleHQuY3VycmVudFRpbGUuaW5kZXg7CiAgICB2YXIgdGlsZSA9IGNvbnRleHQudGlsZXNbdGlsZUluZGV4XTsKICAgIHZhciBzb3BNYXJrZXJVc2VkID0gY29udGV4dC5DT0Quc29wTWFya2VyVXNlZDsKICAgIHZhciBlcGhNYXJrZXJVc2VkID0gY29udGV4dC5DT0QuZXBoTWFya2VyVXNlZDsKICAgIHZhciBwYWNrZXRzSXRlcmF0b3IgPSB0aWxlLnBhY2tldHNJdGVyYXRvcjsKCiAgICB3aGlsZSAocG9zaXRpb24gPCBkYXRhTGVuZ3RoKSB7CiAgICAgIGFsaWduVG9CeXRlKCk7CgogICAgICBpZiAoc29wTWFya2VyVXNlZCAmJiBza2lwTWFya2VySWZFcXVhbCgweDkxKSkgewogICAgICAgIHNraXBCeXRlcyg0KTsKICAgICAgfQoKICAgICAgdmFyIHBhY2tldCA9IHBhY2tldHNJdGVyYXRvci5uZXh0UGFja2V0KCk7CgogICAgICBpZiAoIXJlYWRCaXRzKDEpKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHZhciBsYXllck51bWJlciA9IHBhY2tldC5sYXllck51bWJlcjsKICAgICAgdmFyIHF1ZXVlID0gW10sCiAgICAgICAgICBjb2RlYmxvY2s7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBwYWNrZXQuY29kZWJsb2Nrcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgY29kZWJsb2NrID0gcGFja2V0LmNvZGVibG9ja3NbaV07CiAgICAgICAgdmFyIHByZWNpbmN0ID0gY29kZWJsb2NrLnByZWNpbmN0OwogICAgICAgIHZhciBjb2RlYmxvY2tDb2x1bW4gPSBjb2RlYmxvY2suY2J4IC0gcHJlY2luY3QuY2J4TWluOwogICAgICAgIHZhciBjb2RlYmxvY2tSb3cgPSBjb2RlYmxvY2suY2J5IC0gcHJlY2luY3QuY2J5TWluOwogICAgICAgIHZhciBjb2RlYmxvY2tJbmNsdWRlZCA9IGZhbHNlOwogICAgICAgIHZhciBmaXJzdFRpbWVJbmNsdXNpb24gPSBmYWxzZTsKICAgICAgICB2YXIgdmFsdWVSZWFkeTsKCiAgICAgICAgaWYgKGNvZGVibG9jay5pbmNsdWRlZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjb2RlYmxvY2tJbmNsdWRlZCA9ICEhcmVhZEJpdHMoMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHByZWNpbmN0ID0gY29kZWJsb2NrLnByZWNpbmN0OwogICAgICAgICAgdmFyIGluY2x1c2lvblRyZWUsIHplcm9CaXRQbGFuZXNUcmVlOwoKICAgICAgICAgIGlmIChwcmVjaW5jdC5pbmNsdXNpb25UcmVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgaW5jbHVzaW9uVHJlZSA9IHByZWNpbmN0LmluY2x1c2lvblRyZWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgd2lkdGggPSBwcmVjaW5jdC5jYnhNYXggLSBwcmVjaW5jdC5jYnhNaW4gKyAxOwogICAgICAgICAgICB2YXIgaGVpZ2h0ID0gcHJlY2luY3QuY2J5TWF4IC0gcHJlY2luY3QuY2J5TWluICsgMTsKICAgICAgICAgICAgaW5jbHVzaW9uVHJlZSA9IG5ldyBJbmNsdXNpb25UcmVlKHdpZHRoLCBoZWlnaHQsIGxheWVyTnVtYmVyKTsKICAgICAgICAgICAgemVyb0JpdFBsYW5lc1RyZWUgPSBuZXcgVGFnVHJlZSh3aWR0aCwgaGVpZ2h0KTsKICAgICAgICAgICAgcHJlY2luY3QuaW5jbHVzaW9uVHJlZSA9IGluY2x1c2lvblRyZWU7CiAgICAgICAgICAgIHByZWNpbmN0Lnplcm9CaXRQbGFuZXNUcmVlID0gemVyb0JpdFBsYW5lc1RyZWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGluY2x1c2lvblRyZWUucmVzZXQoY29kZWJsb2NrQ29sdW1uLCBjb2RlYmxvY2tSb3csIGxheWVyTnVtYmVyKSkgewogICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICAgIGlmIChyZWFkQml0cygxKSkgewogICAgICAgICAgICAgICAgdmFsdWVSZWFkeSA9ICFpbmNsdXNpb25UcmVlLm5leHRMZXZlbCgpOwoKICAgICAgICAgICAgICAgIGlmICh2YWx1ZVJlYWR5KSB7CiAgICAgICAgICAgICAgICAgIGNvZGVibG9jay5pbmNsdWRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgIGNvZGVibG9ja0luY2x1ZGVkID0gZmlyc3RUaW1lSW5jbHVzaW9uID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGluY2x1c2lvblRyZWUuaW5jcmVtZW50VmFsdWUobGF5ZXJOdW1iZXIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIWNvZGVibG9ja0luY2x1ZGVkKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmIChmaXJzdFRpbWVJbmNsdXNpb24pIHsKICAgICAgICAgIHplcm9CaXRQbGFuZXNUcmVlID0gcHJlY2luY3QuemVyb0JpdFBsYW5lc1RyZWU7CiAgICAgICAgICB6ZXJvQml0UGxhbmVzVHJlZS5yZXNldChjb2RlYmxvY2tDb2x1bW4sIGNvZGVibG9ja1Jvdyk7CgogICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgaWYgKHJlYWRCaXRzKDEpKSB7CiAgICAgICAgICAgICAgdmFsdWVSZWFkeSA9ICF6ZXJvQml0UGxhbmVzVHJlZS5uZXh0TGV2ZWwoKTsKCiAgICAgICAgICAgICAgaWYgKHZhbHVlUmVhZHkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB6ZXJvQml0UGxhbmVzVHJlZS5pbmNyZW1lbnRWYWx1ZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgY29kZWJsb2NrLnplcm9CaXRQbGFuZXMgPSB6ZXJvQml0UGxhbmVzVHJlZS52YWx1ZTsKICAgICAgICB9CgogICAgICAgIHZhciBjb2RpbmdwYXNzZXMgPSByZWFkQ29kaW5ncGFzc2VzKCk7CgogICAgICAgIHdoaWxlIChyZWFkQml0cygxKSkgewogICAgICAgICAgY29kZWJsb2NrLkxibG9jaysrOwogICAgICAgIH0KCiAgICAgICAgdmFyIGNvZGluZ3Bhc3Nlc0xvZzIgPSAoMCwgX2NvcmVfdXRpbHMubG9nMikoY29kaW5ncGFzc2VzKTsKICAgICAgICB2YXIgYml0cyA9IChjb2RpbmdwYXNzZXMgPCAxIDw8IGNvZGluZ3Bhc3Nlc0xvZzIgPyBjb2RpbmdwYXNzZXNMb2cyIC0gMSA6IGNvZGluZ3Bhc3Nlc0xvZzIpICsgY29kZWJsb2NrLkxibG9jazsKICAgICAgICB2YXIgY29kZWREYXRhTGVuZ3RoID0gcmVhZEJpdHMoYml0cyk7CiAgICAgICAgcXVldWUucHVzaCh7CiAgICAgICAgICBjb2RlYmxvY2s6IGNvZGVibG9jaywKICAgICAgICAgIGNvZGluZ3Bhc3NlczogY29kaW5ncGFzc2VzLAogICAgICAgICAgZGF0YUxlbmd0aDogY29kZWREYXRhTGVuZ3RoCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGFsaWduVG9CeXRlKCk7CgogICAgICBpZiAoZXBoTWFya2VyVXNlZCkgewogICAgICAgIHNraXBNYXJrZXJJZkVxdWFsKDB4OTIpOwogICAgICB9CgogICAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBwYWNrZXRJdGVtID0gcXVldWUuc2hpZnQoKTsKICAgICAgICBjb2RlYmxvY2sgPSBwYWNrZXRJdGVtLmNvZGVibG9jazsKCiAgICAgICAgaWYgKGNvZGVibG9jay5kYXRhID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGNvZGVibG9jay5kYXRhID0gW107CiAgICAgICAgfQoKICAgICAgICBjb2RlYmxvY2suZGF0YS5wdXNoKHsKICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICBzdGFydDogb2Zmc2V0ICsgcG9zaXRpb24sCiAgICAgICAgICBlbmQ6IG9mZnNldCArIHBvc2l0aW9uICsgcGFja2V0SXRlbS5kYXRhTGVuZ3RoLAogICAgICAgICAgY29kaW5ncGFzc2VzOiBwYWNrZXRJdGVtLmNvZGluZ3Bhc3NlcwogICAgICAgIH0pOwogICAgICAgIHBvc2l0aW9uICs9IHBhY2tldEl0ZW0uZGF0YUxlbmd0aDsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBwb3NpdGlvbjsKICB9CgogIGZ1bmN0aW9uIGNvcHlDb2VmZmljaWVudHMoY29lZmZpY2llbnRzLCBsZXZlbFdpZHRoLCBsZXZlbEhlaWdodCwgc3ViYmFuZCwgZGVsdGEsIG1iLCByZXZlcnNpYmxlLCBzZWdtZW50YXRpb25TeW1ib2xVc2VkKSB7CiAgICB2YXIgeDAgPSBzdWJiYW5kLnRieDA7CiAgICB2YXIgeTAgPSBzdWJiYW5kLnRieTA7CiAgICB2YXIgd2lkdGggPSBzdWJiYW5kLnRieDEgLSBzdWJiYW5kLnRieDA7CiAgICB2YXIgY29kZWJsb2NrcyA9IHN1YmJhbmQuY29kZWJsb2NrczsKICAgIHZhciByaWdodCA9IHN1YmJhbmQudHlwZS5jaGFyQXQoMCkgPT09ICJIIiA/IDEgOiAwOwogICAgdmFyIGJvdHRvbSA9IHN1YmJhbmQudHlwZS5jaGFyQXQoMSkgPT09ICJIIiA/IGxldmVsV2lkdGggOiAwOwoKICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGNvZGVibG9ja3MubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICB2YXIgY29kZWJsb2NrID0gY29kZWJsb2Nrc1tpXTsKICAgICAgdmFyIGJsb2NrV2lkdGggPSBjb2RlYmxvY2sudGJ4MV8gLSBjb2RlYmxvY2sudGJ4MF87CiAgICAgIHZhciBibG9ja0hlaWdodCA9IGNvZGVibG9jay50YnkxXyAtIGNvZGVibG9jay50YnkwXzsKCiAgICAgIGlmIChibG9ja1dpZHRoID09PSAwIHx8IGJsb2NrSGVpZ2h0ID09PSAwKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChjb2RlYmxvY2suZGF0YSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIHZhciBiaXRNb2RlbCwgY3VycmVudENvZGluZ3Bhc3NUeXBlOwogICAgICBiaXRNb2RlbCA9IG5ldyBCaXRNb2RlbChibG9ja1dpZHRoLCBibG9ja0hlaWdodCwgY29kZWJsb2NrLnN1YmJhbmRUeXBlLCBjb2RlYmxvY2suemVyb0JpdFBsYW5lcywgbWIpOwogICAgICBjdXJyZW50Q29kaW5ncGFzc1R5cGUgPSAyOwogICAgICB2YXIgZGF0YSA9IGNvZGVibG9jay5kYXRhLAogICAgICAgICAgdG90YWxMZW5ndGggPSAwLAogICAgICAgICAgY29kaW5ncGFzc2VzID0gMDsKICAgICAgdmFyIGosIGpqLCBkYXRhSXRlbTsKCiAgICAgIGZvciAoaiA9IDAsIGpqID0gZGF0YS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgZGF0YUl0ZW0gPSBkYXRhW2pdOwogICAgICAgIHRvdGFsTGVuZ3RoICs9IGRhdGFJdGVtLmVuZCAtIGRhdGFJdGVtLnN0YXJ0OwogICAgICAgIGNvZGluZ3Bhc3NlcyArPSBkYXRhSXRlbS5jb2RpbmdwYXNzZXM7CiAgICAgIH0KCiAgICAgIHZhciBlbmNvZGVkRGF0YSA9IG5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTsKICAgICAgdmFyIHBvc2l0aW9uID0gMDsKCiAgICAgIGZvciAoaiA9IDAsIGpqID0gZGF0YS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgZGF0YUl0ZW0gPSBkYXRhW2pdOwogICAgICAgIHZhciBjaHVuayA9IGRhdGFJdGVtLmRhdGEuc3ViYXJyYXkoZGF0YUl0ZW0uc3RhcnQsIGRhdGFJdGVtLmVuZCk7CiAgICAgICAgZW5jb2RlZERhdGEuc2V0KGNodW5rLCBwb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb24gKz0gY2h1bmsubGVuZ3RoOwogICAgICB9CgogICAgICB2YXIgZGVjb2RlciA9IG5ldyBfYXJpdGhtZXRpY19kZWNvZGVyLkFyaXRobWV0aWNEZWNvZGVyKGVuY29kZWREYXRhLCAwLCB0b3RhbExlbmd0aCk7CiAgICAgIGJpdE1vZGVsLnNldERlY29kZXIoZGVjb2Rlcik7CgogICAgICBmb3IgKGogPSAwOyBqIDwgY29kaW5ncGFzc2VzOyBqKyspIHsKICAgICAgICBzd2l0Y2ggKGN1cnJlbnRDb2RpbmdwYXNzVHlwZSkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBiaXRNb2RlbC5ydW5TaWduaWZpY2FuY2VQcm9wYWdhdGlvblBhc3MoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBiaXRNb2RlbC5ydW5NYWduaXR1ZGVSZWZpbmVtZW50UGFzcygpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGJpdE1vZGVsLnJ1bkNsZWFudXBQYXNzKCk7CgogICAgICAgICAgICBpZiAoc2VnbWVudGF0aW9uU3ltYm9sVXNlZCkgewogICAgICAgICAgICAgIGJpdE1vZGVsLmNoZWNrU2VnbWVudGF0aW9uU3ltYm9sKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgY3VycmVudENvZGluZ3Bhc3NUeXBlID0gKGN1cnJlbnRDb2RpbmdwYXNzVHlwZSArIDEpICUgMzsKICAgICAgfQoKICAgICAgdmFyIG9mZnNldCA9IGNvZGVibG9jay50YngwXyAtIHgwICsgKGNvZGVibG9jay50YnkwXyAtIHkwKSAqIHdpZHRoOwogICAgICB2YXIgc2lnbiA9IGJpdE1vZGVsLmNvZWZmaWNlbnRzU2lnbjsKICAgICAgdmFyIG1hZ25pdHVkZSA9IGJpdE1vZGVsLmNvZWZmaWNlbnRzTWFnbml0dWRlOwogICAgICB2YXIgYml0c0RlY29kZWQgPSBiaXRNb2RlbC5iaXRzRGVjb2RlZDsKICAgICAgdmFyIG1hZ25pdHVkZUNvcnJlY3Rpb24gPSByZXZlcnNpYmxlID8gMCA6IDAuNTsKICAgICAgdmFyIGssIG4sIG5iOwogICAgICBwb3NpdGlvbiA9IDA7CiAgICAgIHZhciBpbnRlcmxlYXZlID0gc3ViYmFuZC50eXBlICE9PSAiTEwiOwoKICAgICAgZm9yIChqID0gMDsgaiA8IGJsb2NrSGVpZ2h0OyBqKyspIHsKICAgICAgICB2YXIgcm93ID0gb2Zmc2V0IC8gd2lkdGggfCAwOwogICAgICAgIHZhciBsZXZlbE9mZnNldCA9IDIgKiByb3cgKiAobGV2ZWxXaWR0aCAtIHdpZHRoKSArIHJpZ2h0ICsgYm90dG9tOwoKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgYmxvY2tXaWR0aDsgaysrKSB7CiAgICAgICAgICBuID0gbWFnbml0dWRlW3Bvc2l0aW9uXTsKCiAgICAgICAgICBpZiAobiAhPT0gMCkgewogICAgICAgICAgICBuID0gKG4gKyBtYWduaXR1ZGVDb3JyZWN0aW9uKSAqIGRlbHRhOwoKICAgICAgICAgICAgaWYgKHNpZ25bcG9zaXRpb25dICE9PSAwKSB7CiAgICAgICAgICAgICAgbiA9IC1uOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuYiA9IGJpdHNEZWNvZGVkW3Bvc2l0aW9uXTsKICAgICAgICAgICAgdmFyIHBvcyA9IGludGVybGVhdmUgPyBsZXZlbE9mZnNldCArIChvZmZzZXQgPDwgMSkgOiBvZmZzZXQ7CgogICAgICAgICAgICBpZiAocmV2ZXJzaWJsZSAmJiBuYiA+PSBtYikgewogICAgICAgICAgICAgIGNvZWZmaWNpZW50c1twb3NdID0gbjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb2VmZmljaWVudHNbcG9zXSA9IG4gKiAoMSA8PCBtYiAtIG5iKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIG9mZnNldCsrOwogICAgICAgICAgcG9zaXRpb24rKzsKICAgICAgICB9CgogICAgICAgIG9mZnNldCArPSB3aWR0aCAtIGJsb2NrV2lkdGg7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIHRyYW5zZm9ybVRpbGUoY29udGV4dCwgdGlsZSwgYykgewogICAgdmFyIGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICAgIHZhciBjb2RpbmdTdHlsZVBhcmFtZXRlcnMgPSBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzOwogICAgdmFyIHF1YW50aXphdGlvblBhcmFtZXRlcnMgPSBjb21wb25lbnQucXVhbnRpemF0aW9uUGFyYW1ldGVyczsKICAgIHZhciBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQgPSBjb2RpbmdTdHlsZVBhcmFtZXRlcnMuZGVjb21wb3NpdGlvbkxldmVsc0NvdW50OwogICAgdmFyIHNwcWNkcyA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuU1BxY2RzOwogICAgdmFyIHNjYWxhckV4cG91bmRlZCA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuc2NhbGFyRXhwb3VuZGVkOwogICAgdmFyIGd1YXJkQml0cyA9IHF1YW50aXphdGlvblBhcmFtZXRlcnMuZ3VhcmRCaXRzOwogICAgdmFyIHNlZ21lbnRhdGlvblN5bWJvbFVzZWQgPSBjb2RpbmdTdHlsZVBhcmFtZXRlcnMuc2VnbWVudGF0aW9uU3ltYm9sVXNlZDsKICAgIHZhciBwcmVjaXNpb24gPSBjb250ZXh0LmNvbXBvbmVudHNbY10ucHJlY2lzaW9uOwogICAgdmFyIHJldmVyc2libGUgPSBjb2RpbmdTdHlsZVBhcmFtZXRlcnMucmV2ZXJzaWJsZVRyYW5zZm9ybWF0aW9uOwogICAgdmFyIHRyYW5zZm9ybSA9IHJldmVyc2libGUgPyBuZXcgUmV2ZXJzaWJsZVRyYW5zZm9ybSgpIDogbmV3IElycmV2ZXJzaWJsZVRyYW5zZm9ybSgpOwogICAgdmFyIHN1YmJhbmRDb2VmZmljaWVudHMgPSBbXTsKICAgIHZhciBiID0gMDsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBkZWNvbXBvc2l0aW9uTGV2ZWxzQ291bnQ7IGkrKykgewogICAgICB2YXIgcmVzb2x1dGlvbiA9IGNvbXBvbmVudC5yZXNvbHV0aW9uc1tpXTsKICAgICAgdmFyIHdpZHRoID0gcmVzb2x1dGlvbi50cngxIC0gcmVzb2x1dGlvbi50cngwOwogICAgICB2YXIgaGVpZ2h0ID0gcmVzb2x1dGlvbi50cnkxIC0gcmVzb2x1dGlvbi50cnkwOwogICAgICB2YXIgY29lZmZpY2llbnRzID0gbmV3IEZsb2F0MzJBcnJheSh3aWR0aCAqIGhlaWdodCk7CgogICAgICBmb3IgKHZhciBqID0gMCwgamogPSByZXNvbHV0aW9uLnN1YmJhbmRzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICB2YXIgbXUsIGVwc2lsb247CgogICAgICAgIGlmICghc2NhbGFyRXhwb3VuZGVkKSB7CiAgICAgICAgICBtdSA9IHNwcWNkc1swXS5tdTsKICAgICAgICAgIGVwc2lsb24gPSBzcHFjZHNbMF0uZXBzaWxvbiArIChpID4gMCA/IDEgLSBpIDogMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG11ID0gc3BxY2RzW2JdLm11OwogICAgICAgICAgZXBzaWxvbiA9IHNwcWNkc1tiXS5lcHNpbG9uOwogICAgICAgICAgYisrOwogICAgICAgIH0KCiAgICAgICAgdmFyIHN1YmJhbmQgPSByZXNvbHV0aW9uLnN1YmJhbmRzW2pdOwogICAgICAgIHZhciBnYWluTG9nMiA9IFN1YmJhbmRzR2FpbkxvZzJbc3ViYmFuZC50eXBlXTsKICAgICAgICB2YXIgZGVsdGEgPSByZXZlcnNpYmxlID8gMSA6IE1hdGgucG93KDIsIHByZWNpc2lvbiArIGdhaW5Mb2cyIC0gZXBzaWxvbikgKiAoMSArIG11IC8gMjA0OCk7CiAgICAgICAgdmFyIG1iID0gZ3VhcmRCaXRzICsgZXBzaWxvbiAtIDE7CiAgICAgICAgY29weUNvZWZmaWNpZW50cyhjb2VmZmljaWVudHMsIHdpZHRoLCBoZWlnaHQsIHN1YmJhbmQsIGRlbHRhLCBtYiwgcmV2ZXJzaWJsZSwgc2VnbWVudGF0aW9uU3ltYm9sVXNlZCk7CiAgICAgIH0KCiAgICAgIHN1YmJhbmRDb2VmZmljaWVudHMucHVzaCh7CiAgICAgICAgd2lkdGg6IHdpZHRoLAogICAgICAgIGhlaWdodDogaGVpZ2h0LAogICAgICAgIGl0ZW1zOiBjb2VmZmljaWVudHMKICAgICAgfSk7CiAgICB9CgogICAgdmFyIHJlc3VsdCA9IHRyYW5zZm9ybS5jYWxjdWxhdGUoc3ViYmFuZENvZWZmaWNpZW50cywgY29tcG9uZW50LnRjeDAsIGNvbXBvbmVudC50Y3kwKTsKICAgIHJldHVybiB7CiAgICAgIGxlZnQ6IGNvbXBvbmVudC50Y3gwLAogICAgICB0b3A6IGNvbXBvbmVudC50Y3kwLAogICAgICB3aWR0aDogcmVzdWx0LndpZHRoLAogICAgICBoZWlnaHQ6IHJlc3VsdC5oZWlnaHQsCiAgICAgIGl0ZW1zOiByZXN1bHQuaXRlbXMKICAgIH07CiAgfQoKICBmdW5jdGlvbiB0cmFuc2Zvcm1Db21wb25lbnRzKGNvbnRleHQpIHsKICAgIHZhciBzaXogPSBjb250ZXh0LlNJWjsKICAgIHZhciBjb21wb25lbnRzID0gY29udGV4dC5jb21wb25lbnRzOwogICAgdmFyIGNvbXBvbmVudHNDb3VudCA9IHNpei5Dc2l6OwogICAgdmFyIHJlc3VsdEltYWdlcyA9IFtdOwoKICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGNvbnRleHQudGlsZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICB2YXIgdGlsZSA9IGNvbnRleHQudGlsZXNbaV07CiAgICAgIHZhciB0cmFuc2Zvcm1lZFRpbGVzID0gW107CiAgICAgIHZhciBjOwoKICAgICAgZm9yIChjID0gMDsgYyA8IGNvbXBvbmVudHNDb3VudDsgYysrKSB7CiAgICAgICAgdHJhbnNmb3JtZWRUaWxlc1tjXSA9IHRyYW5zZm9ybVRpbGUoY29udGV4dCwgdGlsZSwgYyk7CiAgICAgIH0KCiAgICAgIHZhciB0aWxlMCA9IHRyYW5zZm9ybWVkVGlsZXNbMF07CiAgICAgIHZhciBvdXQgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkodGlsZTAuaXRlbXMubGVuZ3RoICogY29tcG9uZW50c0NvdW50KTsKICAgICAgdmFyIHJlc3VsdCA9IHsKICAgICAgICBsZWZ0OiB0aWxlMC5sZWZ0LAogICAgICAgIHRvcDogdGlsZTAudG9wLAogICAgICAgIHdpZHRoOiB0aWxlMC53aWR0aCwKICAgICAgICBoZWlnaHQ6IHRpbGUwLmhlaWdodCwKICAgICAgICBpdGVtczogb3V0CiAgICAgIH07CiAgICAgIHZhciBzaGlmdCwgb2Zmc2V0OwogICAgICB2YXIgcG9zID0gMCwKICAgICAgICAgIGosCiAgICAgICAgICBqaiwKICAgICAgICAgIHkwLAogICAgICAgICAgeTEsCiAgICAgICAgICB5MjsKCiAgICAgIGlmICh0aWxlLmNvZGluZ1N0eWxlRGVmYXVsdFBhcmFtZXRlcnMubXVsdGlwbGVDb21wb25lbnRUcmFuc2Zvcm0pIHsKICAgICAgICB2YXIgZm91ckNvbXBvbmVudHMgPSBjb21wb25lbnRzQ291bnQgPT09IDQ7CiAgICAgICAgdmFyIHkwaXRlbXMgPSB0cmFuc2Zvcm1lZFRpbGVzWzBdLml0ZW1zOwogICAgICAgIHZhciB5MWl0ZW1zID0gdHJhbnNmb3JtZWRUaWxlc1sxXS5pdGVtczsKICAgICAgICB2YXIgeTJpdGVtcyA9IHRyYW5zZm9ybWVkVGlsZXNbMl0uaXRlbXM7CiAgICAgICAgdmFyIHkzaXRlbXMgPSBmb3VyQ29tcG9uZW50cyA/IHRyYW5zZm9ybWVkVGlsZXNbM10uaXRlbXMgOiBudWxsOwogICAgICAgIHNoaWZ0ID0gY29tcG9uZW50c1swXS5wcmVjaXNpb24gLSA4OwogICAgICAgIG9mZnNldCA9ICgxMjggPDwgc2hpZnQpICsgMC41OwogICAgICAgIHZhciBjb21wb25lbnQwID0gdGlsZS5jb21wb25lbnRzWzBdOwogICAgICAgIHZhciBhbHBoYTAxID0gY29tcG9uZW50c0NvdW50IC0gMzsKICAgICAgICBqaiA9IHkwaXRlbXMubGVuZ3RoOwoKICAgICAgICBpZiAoIWNvbXBvbmVudDAuY29kaW5nU3R5bGVQYXJhbWV0ZXJzLnJldmVyc2libGVUcmFuc2Zvcm1hdGlvbikgewogICAgICAgICAgZm9yIChqID0gMDsgaiA8IGpqOyBqKyssIHBvcyArPSBhbHBoYTAxKSB7CiAgICAgICAgICAgIHkwID0geTBpdGVtc1tqXSArIG9mZnNldDsKICAgICAgICAgICAgeTEgPSB5MWl0ZW1zW2pdOwogICAgICAgICAgICB5MiA9IHkyaXRlbXNbal07CiAgICAgICAgICAgIG91dFtwb3MrK10gPSB5MCArIDEuNDAyICogeTIgPj4gc2hpZnQ7CiAgICAgICAgICAgIG91dFtwb3MrK10gPSB5MCAtIDAuMzQ0MTMgKiB5MSAtIDAuNzE0MTQgKiB5MiA+PiBzaGlmdDsKICAgICAgICAgICAgb3V0W3BvcysrXSA9IHkwICsgMS43NzIgKiB5MSA+PiBzaGlmdDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZm9yIChqID0gMDsgaiA8IGpqOyBqKyssIHBvcyArPSBhbHBoYTAxKSB7CiAgICAgICAgICAgIHkwID0geTBpdGVtc1tqXSArIG9mZnNldDsKICAgICAgICAgICAgeTEgPSB5MWl0ZW1zW2pdOwogICAgICAgICAgICB5MiA9IHkyaXRlbXNbal07CiAgICAgICAgICAgIHZhciBnID0geTAgLSAoeTIgKyB5MSA+PiAyKTsKICAgICAgICAgICAgb3V0W3BvcysrXSA9IGcgKyB5MiA+PiBzaGlmdDsKICAgICAgICAgICAgb3V0W3BvcysrXSA9IGcgPj4gc2hpZnQ7CiAgICAgICAgICAgIG91dFtwb3MrK10gPSBnICsgeTEgPj4gc2hpZnQ7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZm91ckNvbXBvbmVudHMpIHsKICAgICAgICAgIGZvciAoaiA9IDAsIHBvcyA9IDM7IGogPCBqajsgaisrLCBwb3MgKz0gNCkgewogICAgICAgICAgICBvdXRbcG9zXSA9IHkzaXRlbXNbal0gKyBvZmZzZXQgPj4gc2hpZnQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAoYyA9IDA7IGMgPCBjb21wb25lbnRzQ291bnQ7IGMrKykgewogICAgICAgICAgdmFyIGl0ZW1zID0gdHJhbnNmb3JtZWRUaWxlc1tjXS5pdGVtczsKICAgICAgICAgIHNoaWZ0ID0gY29tcG9uZW50c1tjXS5wcmVjaXNpb24gLSA4OwogICAgICAgICAgb2Zmc2V0ID0gKDEyOCA8PCBzaGlmdCkgKyAwLjU7CgogICAgICAgICAgZm9yIChwb3MgPSBjLCBqID0gMCwgamogPSBpdGVtcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICAgIG91dFtwb3NdID0gaXRlbXNbal0gKyBvZmZzZXQgPj4gc2hpZnQ7CiAgICAgICAgICAgIHBvcyArPSBjb21wb25lbnRzQ291bnQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXN1bHRJbWFnZXMucHVzaChyZXN1bHQpOwogICAgfQoKICAgIHJldHVybiByZXN1bHRJbWFnZXM7CiAgfQoKICBmdW5jdGlvbiBpbml0aWFsaXplVGlsZShjb250ZXh0LCB0aWxlSW5kZXgpIHsKICAgIHZhciBzaXogPSBjb250ZXh0LlNJWjsKICAgIHZhciBjb21wb25lbnRzQ291bnQgPSBzaXouQ3NpejsKICAgIHZhciB0aWxlID0gY29udGV4dC50aWxlc1t0aWxlSW5kZXhdOwoKICAgIGZvciAodmFyIGMgPSAwOyBjIDwgY29tcG9uZW50c0NvdW50OyBjKyspIHsKICAgICAgdmFyIGNvbXBvbmVudCA9IHRpbGUuY29tcG9uZW50c1tjXTsKICAgICAgdmFyIHFjZE9yUWNjID0gY29udGV4dC5jdXJyZW50VGlsZS5RQ0NbY10gIT09IHVuZGVmaW5lZCA/IGNvbnRleHQuY3VycmVudFRpbGUuUUNDW2NdIDogY29udGV4dC5jdXJyZW50VGlsZS5RQ0Q7CiAgICAgIGNvbXBvbmVudC5xdWFudGl6YXRpb25QYXJhbWV0ZXJzID0gcWNkT3JRY2M7CiAgICAgIHZhciBjb2RPckNvYyA9IGNvbnRleHQuY3VycmVudFRpbGUuQ09DW2NdICE9PSB1bmRlZmluZWQgPyBjb250ZXh0LmN1cnJlbnRUaWxlLkNPQ1tjXSA6IGNvbnRleHQuY3VycmVudFRpbGUuQ09EOwogICAgICBjb21wb25lbnQuY29kaW5nU3R5bGVQYXJhbWV0ZXJzID0gY29kT3JDb2M7CiAgICB9CgogICAgdGlsZS5jb2RpbmdTdHlsZURlZmF1bHRQYXJhbWV0ZXJzID0gY29udGV4dC5jdXJyZW50VGlsZS5DT0Q7CiAgfQoKICB2YXIgVGFnVHJlZSA9IGZ1bmN0aW9uIFRhZ1RyZWVDbG9zdXJlKCkgewogICAgZnVuY3Rpb24gVGFnVHJlZSh3aWR0aCwgaGVpZ2h0KSB7CiAgICAgIHZhciBsZXZlbHNMZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMubG9nMikoTWF0aC5tYXgod2lkdGgsIGhlaWdodCkpICsgMTsKICAgICAgdGhpcy5sZXZlbHMgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGV2ZWxzTGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgbGV2ZWwgPSB7CiAgICAgICAgICB3aWR0aDogd2lkdGgsCiAgICAgICAgICBoZWlnaHQ6IGhlaWdodCwKICAgICAgICAgIGl0ZW1zOiBbXQogICAgICAgIH07CiAgICAgICAgdGhpcy5sZXZlbHMucHVzaChsZXZlbCk7CiAgICAgICAgd2lkdGggPSBNYXRoLmNlaWwod2lkdGggLyAyKTsKICAgICAgICBoZWlnaHQgPSBNYXRoLmNlaWwoaGVpZ2h0IC8gMik7CiAgICAgIH0KICAgIH0KCiAgICBUYWdUcmVlLnByb3RvdHlwZSA9IHsKICAgICAgcmVzZXQ6IGZ1bmN0aW9uIFRhZ1RyZWVfcmVzZXQoaSwgaikgewogICAgICAgIHZhciBjdXJyZW50TGV2ZWwgPSAwLAogICAgICAgICAgICB2YWx1ZSA9IDAsCiAgICAgICAgICAgIGxldmVsOwoKICAgICAgICB3aGlsZSAoY3VycmVudExldmVsIDwgdGhpcy5sZXZlbHMubGVuZ3RoKSB7CiAgICAgICAgICBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICAgICAgICB2YXIgaW5kZXggPSBpICsgaiAqIGxldmVsLndpZHRoOwoKICAgICAgICAgIGlmIChsZXZlbC5pdGVtc1tpbmRleF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICB2YWx1ZSA9IGxldmVsLml0ZW1zW2luZGV4XTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgbGV2ZWwuaW5kZXggPSBpbmRleDsKICAgICAgICAgIGkgPj49IDE7CiAgICAgICAgICBqID4+PSAxOwogICAgICAgICAgY3VycmVudExldmVsKys7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50TGV2ZWwtLTsKICAgICAgICBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICAgICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gdmFsdWU7CiAgICAgICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWw7CiAgICAgICAgZGVsZXRlIHRoaXMudmFsdWU7CiAgICAgIH0sCiAgICAgIGluY3JlbWVudFZhbHVlOiBmdW5jdGlvbiBUYWdUcmVlX2luY3JlbWVudFZhbHVlKCkgewogICAgICAgIHZhciBsZXZlbCA9IHRoaXMubGV2ZWxzW3RoaXMuY3VycmVudExldmVsXTsKICAgICAgICBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF0rKzsKICAgICAgfSwKICAgICAgbmV4dExldmVsOiBmdW5jdGlvbiBUYWdUcmVlX25leHRMZXZlbCgpIHsKICAgICAgICB2YXIgY3VycmVudExldmVsID0gdGhpcy5jdXJyZW50TGV2ZWw7CiAgICAgICAgdmFyIGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgICAgICB2YXIgdmFsdWUgPSBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF07CiAgICAgICAgY3VycmVudExldmVsLS07CgogICAgICAgIGlmIChjdXJyZW50TGV2ZWwgPCAwKSB7CiAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbCA9IGN1cnJlbnRMZXZlbDsKICAgICAgICBsZXZlbCA9IHRoaXMubGV2ZWxzW2N1cnJlbnRMZXZlbF07CiAgICAgICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gdmFsdWU7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gVGFnVHJlZTsKICB9KCk7CgogIHZhciBJbmNsdXNpb25UcmVlID0gZnVuY3Rpb24gSW5jbHVzaW9uVHJlZUNsb3N1cmUoKSB7CiAgICBmdW5jdGlvbiBJbmNsdXNpb25UcmVlKHdpZHRoLCBoZWlnaHQsIGRlZmF1bHRWYWx1ZSkgewogICAgICB2YXIgbGV2ZWxzTGVuZ3RoID0gKDAsIF9jb3JlX3V0aWxzLmxvZzIpKE1hdGgubWF4KHdpZHRoLCBoZWlnaHQpKSArIDE7CiAgICAgIHRoaXMubGV2ZWxzID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxldmVsc0xlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGl0ZW1zID0gbmV3IFVpbnQ4QXJyYXkod2lkdGggKiBoZWlnaHQpOwoKICAgICAgICBmb3IgKHZhciBqID0gMCwgamogPSBpdGVtcy5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICBpdGVtc1tqXSA9IGRlZmF1bHRWYWx1ZTsKICAgICAgICB9CgogICAgICAgIHZhciBsZXZlbCA9IHsKICAgICAgICAgIHdpZHRoOiB3aWR0aCwKICAgICAgICAgIGhlaWdodDogaGVpZ2h0LAogICAgICAgICAgaXRlbXM6IGl0ZW1zCiAgICAgICAgfTsKICAgICAgICB0aGlzLmxldmVscy5wdXNoKGxldmVsKTsKICAgICAgICB3aWR0aCA9IE1hdGguY2VpbCh3aWR0aCAvIDIpOwogICAgICAgIGhlaWdodCA9IE1hdGguY2VpbChoZWlnaHQgLyAyKTsKICAgICAgfQogICAgfQoKICAgIEluY2x1c2lvblRyZWUucHJvdG90eXBlID0gewogICAgICByZXNldDogZnVuY3Rpb24gSW5jbHVzaW9uVHJlZV9yZXNldChpLCBqLCBzdG9wVmFsdWUpIHsKICAgICAgICB2YXIgY3VycmVudExldmVsID0gMDsKCiAgICAgICAgd2hpbGUgKGN1cnJlbnRMZXZlbCA8IHRoaXMubGV2ZWxzLmxlbmd0aCkgewogICAgICAgICAgdmFyIGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgICAgICAgIHZhciBpbmRleCA9IGkgKyBqICogbGV2ZWwud2lkdGg7CiAgICAgICAgICBsZXZlbC5pbmRleCA9IGluZGV4OwogICAgICAgICAgdmFyIHZhbHVlID0gbGV2ZWwuaXRlbXNbaW5kZXhdOwoKICAgICAgICAgIGlmICh2YWx1ZSA9PT0gMHhmZikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodmFsdWUgPiBzdG9wVmFsdWUpIHsKICAgICAgICAgICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWw7CiAgICAgICAgICAgIHRoaXMucHJvcGFnYXRlVmFsdWVzKCk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpID4+PSAxOwogICAgICAgICAgaiA+Pj0gMTsKICAgICAgICAgIGN1cnJlbnRMZXZlbCsrOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jdXJyZW50TGV2ZWwgPSBjdXJyZW50TGV2ZWwgLSAxOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9LAogICAgICBpbmNyZW1lbnRWYWx1ZTogZnVuY3Rpb24gSW5jbHVzaW9uVHJlZV9pbmNyZW1lbnRWYWx1ZShzdG9wVmFsdWUpIHsKICAgICAgICB2YXIgbGV2ZWwgPSB0aGlzLmxldmVsc1t0aGlzLmN1cnJlbnRMZXZlbF07CiAgICAgICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gc3RvcFZhbHVlICsgMTsKICAgICAgICB0aGlzLnByb3BhZ2F0ZVZhbHVlcygpOwogICAgICB9LAogICAgICBwcm9wYWdhdGVWYWx1ZXM6IGZ1bmN0aW9uIEluY2x1c2lvblRyZWVfcHJvcGFnYXRlVmFsdWVzKCkgewogICAgICAgIHZhciBsZXZlbEluZGV4ID0gdGhpcy5jdXJyZW50TGV2ZWw7CiAgICAgICAgdmFyIGxldmVsID0gdGhpcy5sZXZlbHNbbGV2ZWxJbmRleF07CiAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGxldmVsLml0ZW1zW2xldmVsLmluZGV4XTsKCiAgICAgICAgd2hpbGUgKC0tbGV2ZWxJbmRleCA+PSAwKSB7CiAgICAgICAgICBsZXZlbCA9IHRoaXMubGV2ZWxzW2xldmVsSW5kZXhdOwogICAgICAgICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gY3VycmVudFZhbHVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbmV4dExldmVsOiBmdW5jdGlvbiBJbmNsdXNpb25UcmVlX25leHRMZXZlbCgpIHsKICAgICAgICB2YXIgY3VycmVudExldmVsID0gdGhpcy5jdXJyZW50TGV2ZWw7CiAgICAgICAgdmFyIGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgICAgICB2YXIgdmFsdWUgPSBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF07CiAgICAgICAgbGV2ZWwuaXRlbXNbbGV2ZWwuaW5kZXhdID0gMHhmZjsKICAgICAgICBjdXJyZW50TGV2ZWwtLTsKCiAgICAgICAgaWYgKGN1cnJlbnRMZXZlbCA8IDApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuY3VycmVudExldmVsID0gY3VycmVudExldmVsOwogICAgICAgIGxldmVsID0gdGhpcy5sZXZlbHNbY3VycmVudExldmVsXTsKICAgICAgICBsZXZlbC5pdGVtc1tsZXZlbC5pbmRleF0gPSB2YWx1ZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfTsKICAgIHJldHVybiBJbmNsdXNpb25UcmVlOwogIH0oKTsKCiAgdmFyIEJpdE1vZGVsID0gZnVuY3Rpb24gQml0TW9kZWxDbG9zdXJlKCkgewogICAgdmFyIFVOSUZPUk1fQ09OVEVYVCA9IDE3OwogICAgdmFyIFJVTkxFTkdUSF9DT05URVhUID0gMTg7CiAgICB2YXIgTExBbmRMSENvbnRleHRzTGFiZWwgPSBuZXcgVWludDhBcnJheShbMCwgNSwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMSwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOCwgMCwgMCwgMCwgMCwgMCwgMiwgNiwgOCwgMCwgMywgNywgOCwgMCwgNCwgNywgOF0pOwogICAgdmFyIEhMQ29udGV4dExhYmVsID0gbmV3IFVpbnQ4QXJyYXkoWzAsIDMsIDQsIDAsIDUsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDEsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDgsIDAsIDAsIDAsIDAsIDAsIDIsIDMsIDQsIDAsIDYsIDcsIDcsIDAsIDgsIDgsIDhdKTsKICAgIHZhciBISENvbnRleHRMYWJlbCA9IG5ldyBVaW50OEFycmF5KFswLCAxLCAyLCAwLCAxLCAyLCAyLCAwLCAyLCAyLCAyLCAwLCAwLCAwLCAwLCAwLCAzLCA0LCA1LCAwLCA0LCA1LCA1LCAwLCA1LCA1LCA1LCAwLCAwLCAwLCAwLCAwLCA2LCA3LCA3LCAwLCA3LCA3LCA3LCAwLCA3LCA3LCA3LCAwLCAwLCAwLCAwLCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCAwLCAwLCAwLCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4LCAwLCA4LCA4LCA4XSk7CgogICAgZnVuY3Rpb24gQml0TW9kZWwod2lkdGgsIGhlaWdodCwgc3ViYmFuZCwgemVyb0JpdFBsYW5lcywgbWIpIHsKICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwogICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKICAgICAgdmFyIGNvbnRleHRMYWJlbFRhYmxlOwoKICAgICAgaWYgKHN1YmJhbmQgPT09ICJISCIpIHsKICAgICAgICBjb250ZXh0TGFiZWxUYWJsZSA9IEhIQ29udGV4dExhYmVsOwogICAgICB9IGVsc2UgaWYgKHN1YmJhbmQgPT09ICJITCIpIHsKICAgICAgICBjb250ZXh0TGFiZWxUYWJsZSA9IEhMQ29udGV4dExhYmVsOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRleHRMYWJlbFRhYmxlID0gTExBbmRMSENvbnRleHRzTGFiZWw7CiAgICAgIH0KCiAgICAgIHRoaXMuY29udGV4dExhYmVsVGFibGUgPSBjb250ZXh0TGFiZWxUYWJsZTsKICAgICAgdmFyIGNvZWZmaWNpZW50Q291bnQgPSB3aWR0aCAqIGhlaWdodDsKICAgICAgdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2UgPSBuZXcgVWludDhBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgdGhpcy5jb2VmZmljZW50c1NpZ24gPSBuZXcgVWludDhBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgdmFyIGNvZWZmaWNlbnRzTWFnbml0dWRlOwoKICAgICAgaWYgKG1iID4gMTQpIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50MzJBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgfSBlbHNlIGlmIChtYiA+IDYpIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50MTZBcnJheShjb2VmZmljaWVudENvdW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZSA9IG5ldyBVaW50OEFycmF5KGNvZWZmaWNpZW50Q291bnQpOwogICAgICB9CgogICAgICB0aGlzLmNvZWZmaWNlbnRzTWFnbml0dWRlID0gY29lZmZpY2VudHNNYWduaXR1ZGU7CiAgICAgIHRoaXMucHJvY2Vzc2luZ0ZsYWdzID0gbmV3IFVpbnQ4QXJyYXkoY29lZmZpY2llbnRDb3VudCk7CiAgICAgIHZhciBiaXRzRGVjb2RlZCA9IG5ldyBVaW50OEFycmF5KGNvZWZmaWNpZW50Q291bnQpOwoKICAgICAgaWYgKHplcm9CaXRQbGFuZXMgIT09IDApIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvZWZmaWNpZW50Q291bnQ7IGkrKykgewogICAgICAgICAgYml0c0RlY29kZWRbaV0gPSB6ZXJvQml0UGxhbmVzOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5iaXRzRGVjb2RlZCA9IGJpdHNEZWNvZGVkOwogICAgICB0aGlzLnJlc2V0KCk7CiAgICB9CgogICAgQml0TW9kZWwucHJvdG90eXBlID0gewogICAgICBzZXREZWNvZGVyOiBmdW5jdGlvbiBCaXRNb2RlbF9zZXREZWNvZGVyKGRlY29kZXIpIHsKICAgICAgICB0aGlzLmRlY29kZXIgPSBkZWNvZGVyOwogICAgICB9LAogICAgICByZXNldDogZnVuY3Rpb24gQml0TW9kZWxfcmVzZXQoKSB7CiAgICAgICAgdGhpcy5jb250ZXh0cyA9IG5ldyBJbnQ4QXJyYXkoMTkpOwogICAgICAgIHRoaXMuY29udGV4dHNbMF0gPSA0IDw8IDEgfCAwOwogICAgICAgIHRoaXMuY29udGV4dHNbVU5JRk9STV9DT05URVhUXSA9IDQ2IDw8IDEgfCAwOwogICAgICAgIHRoaXMuY29udGV4dHNbUlVOTEVOR1RIX0NPTlRFWFRdID0gMyA8PCAxIHwgMDsKICAgICAgfSwKICAgICAgc2V0TmVpZ2hib3JzU2lnbmlmaWNhbmNlOiBmdW5jdGlvbiBCaXRNb2RlbF9zZXROZWlnaGJvcnNTaWduaWZpY2FuY2Uocm93LCBjb2x1bW4sIGluZGV4KSB7CiAgICAgICAgdmFyIG5laWdoYm9yc1NpZ25pZmljYW5jZSA9IHRoaXMubmVpZ2hib3JzU2lnbmlmaWNhbmNlOwogICAgICAgIHZhciB3aWR0aCA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgICAgIHZhciBsZWZ0ID0gY29sdW1uID4gMDsKICAgICAgICB2YXIgcmlnaHQgPSBjb2x1bW4gKyAxIDwgd2lkdGg7CiAgICAgICAgdmFyIGk7CgogICAgICAgIGlmIChyb3cgPiAwKSB7CiAgICAgICAgICBpID0gaW5kZXggLSB3aWR0aDsKCiAgICAgICAgICBpZiAobGVmdCkgewogICAgICAgICAgICBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaSAtIDFdICs9IDB4MTA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHJpZ2h0KSB7CiAgICAgICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpICsgMV0gKz0gMHgxMDsKICAgICAgICAgIH0KCiAgICAgICAgICBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaV0gKz0gMHgwNDsKICAgICAgICB9CgogICAgICAgIGlmIChyb3cgKyAxIDwgaGVpZ2h0KSB7CiAgICAgICAgICBpID0gaW5kZXggKyB3aWR0aDsKCiAgICAgICAgICBpZiAobGVmdCkgewogICAgICAgICAgICBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaSAtIDFdICs9IDB4MTA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHJpZ2h0KSB7CiAgICAgICAgICAgIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpICsgMV0gKz0gMHgxMDsKICAgICAgICAgIH0KCiAgICAgICAgICBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaV0gKz0gMHgwNDsKICAgICAgICB9CgogICAgICAgIGlmIChsZWZ0KSB7CiAgICAgICAgICBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXggLSAxXSArPSAweDAxOwogICAgICAgIH0KCiAgICAgICAgaWYgKHJpZ2h0KSB7CiAgICAgICAgICBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXggKyAxXSArPSAweDAxOwogICAgICAgIH0KCiAgICAgICAgbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2luZGV4XSB8PSAweDgwOwogICAgICB9LAogICAgICBydW5TaWduaWZpY2FuY2VQcm9wYWdhdGlvblBhc3M6IGZ1bmN0aW9uIEJpdE1vZGVsX3J1blNpZ25pZmljYW5jZVByb3BhZ2F0aW9uUGFzcygpIHsKICAgICAgICB2YXIgZGVjb2RlciA9IHRoaXMuZGVjb2RlcjsKICAgICAgICB2YXIgd2lkdGggPSB0aGlzLndpZHRoLAogICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmhlaWdodDsKICAgICAgICB2YXIgY29lZmZpY2VudHNNYWduaXR1ZGUgPSB0aGlzLmNvZWZmaWNlbnRzTWFnbml0dWRlOwogICAgICAgIHZhciBjb2VmZmljZW50c1NpZ24gPSB0aGlzLmNvZWZmaWNlbnRzU2lnbjsKICAgICAgICB2YXIgbmVpZ2hib3JzU2lnbmlmaWNhbmNlID0gdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2U7CiAgICAgICAgdmFyIHByb2Nlc3NpbmdGbGFncyA9IHRoaXMucHJvY2Vzc2luZ0ZsYWdzOwogICAgICAgIHZhciBjb250ZXh0cyA9IHRoaXMuY29udGV4dHM7CiAgICAgICAgdmFyIGxhYmVscyA9IHRoaXMuY29udGV4dExhYmVsVGFibGU7CiAgICAgICAgdmFyIGJpdHNEZWNvZGVkID0gdGhpcy5iaXRzRGVjb2RlZDsKICAgICAgICB2YXIgcHJvY2Vzc2VkSW52ZXJzZU1hc2sgPSB+MTsKICAgICAgICB2YXIgcHJvY2Vzc2VkTWFzayA9IDE7CiAgICAgICAgdmFyIGZpcnN0TWFnbml0dWRlQml0TWFzayA9IDI7CgogICAgICAgIGZvciAodmFyIGkwID0gMDsgaTAgPCBoZWlnaHQ7IGkwICs9IDQpIHsKICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgd2lkdGg7IGorKykgewogICAgICAgICAgICB2YXIgaW5kZXggPSBpMCAqIHdpZHRoICsgajsKCiAgICAgICAgICAgIGZvciAodmFyIGkxID0gMDsgaTEgPCA0OyBpMSsrLCBpbmRleCArPSB3aWR0aCkgewogICAgICAgICAgICAgIHZhciBpID0gaTAgKyBpMTsKCiAgICAgICAgICAgICAgaWYgKGkgPj0gaGVpZ2h0KSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gJj0gcHJvY2Vzc2VkSW52ZXJzZU1hc2s7CgogICAgICAgICAgICAgIGlmIChjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gfHwgIW5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleF0pIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIGNvbnRleHRMYWJlbCA9IGxhYmVsc1tuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXhdXTsKICAgICAgICAgICAgICB2YXIgZGVjaXNpb24gPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIGNvbnRleHRMYWJlbCk7CgogICAgICAgICAgICAgIGlmIChkZWNpc2lvbikgewogICAgICAgICAgICAgICAgdmFyIHNpZ24gPSB0aGlzLmRlY29kZVNpZ25CaXQoaSwgaiwgaW5kZXgpOwogICAgICAgICAgICAgICAgY29lZmZpY2VudHNTaWduW2luZGV4XSA9IHNpZ247CiAgICAgICAgICAgICAgICBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gPSAxOwogICAgICAgICAgICAgICAgdGhpcy5zZXROZWlnaGJvcnNTaWduaWZpY2FuY2UoaSwgaiwgaW5kZXgpOwogICAgICAgICAgICAgICAgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4XSB8PSBmaXJzdE1hZ25pdHVkZUJpdE1hc2s7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBiaXRzRGVjb2RlZFtpbmRleF0rKzsKICAgICAgICAgICAgICBwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdIHw9IHByb2Nlc3NlZE1hc2s7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlY29kZVNpZ25CaXQ6IGZ1bmN0aW9uIEJpdE1vZGVsX2RlY29kZVNpZ25CaXQocm93LCBjb2x1bW4sIGluZGV4KSB7CiAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aCwKICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICAgICAgdmFyIGNvZWZmaWNlbnRzTWFnbml0dWRlID0gdGhpcy5jb2VmZmljZW50c01hZ25pdHVkZTsKICAgICAgICB2YXIgY29lZmZpY2VudHNTaWduID0gdGhpcy5jb2VmZmljZW50c1NpZ247CiAgICAgICAgdmFyIGNvbnRyaWJ1dGlvbiwgc2lnbjAsIHNpZ24xLCBzaWduaWZpY2FuY2UxOwogICAgICAgIHZhciBjb250ZXh0TGFiZWwsIGRlY29kZWQ7CiAgICAgICAgc2lnbmlmaWNhbmNlMSA9IGNvbHVtbiA+IDAgJiYgY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXggLSAxXSAhPT0gMDsKCiAgICAgICAgaWYgKGNvbHVtbiArIDEgPCB3aWR0aCAmJiBjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleCArIDFdICE9PSAwKSB7CiAgICAgICAgICBzaWduMSA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCArIDFdOwoKICAgICAgICAgIGlmIChzaWduaWZpY2FuY2UxKSB7CiAgICAgICAgICAgIHNpZ24wID0gY29lZmZpY2VudHNTaWduW2luZGV4IC0gMV07CiAgICAgICAgICAgIGNvbnRyaWJ1dGlvbiA9IDEgLSBzaWduMSAtIHNpZ24wOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29udHJpYnV0aW9uID0gMSAtIHNpZ24xIC0gc2lnbjE7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChzaWduaWZpY2FuY2UxKSB7CiAgICAgICAgICBzaWduMCA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCAtIDFdOwogICAgICAgICAgY29udHJpYnV0aW9uID0gMSAtIHNpZ24wIC0gc2lnbjA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnRyaWJ1dGlvbiA9IDA7CiAgICAgICAgfQoKICAgICAgICB2YXIgaG9yaXpvbnRhbENvbnRyaWJ1dGlvbiA9IDMgKiBjb250cmlidXRpb247CiAgICAgICAgc2lnbmlmaWNhbmNlMSA9IHJvdyA+IDAgJiYgY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXggLSB3aWR0aF0gIT09IDA7CgogICAgICAgIGlmIChyb3cgKyAxIDwgaGVpZ2h0ICYmIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4ICsgd2lkdGhdICE9PSAwKSB7CiAgICAgICAgICBzaWduMSA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCArIHdpZHRoXTsKCiAgICAgICAgICBpZiAoc2lnbmlmaWNhbmNlMSkgewogICAgICAgICAgICBzaWduMCA9IGNvZWZmaWNlbnRzU2lnbltpbmRleCAtIHdpZHRoXTsKICAgICAgICAgICAgY29udHJpYnV0aW9uID0gMSAtIHNpZ24xIC0gc2lnbjAgKyBob3Jpem9udGFsQ29udHJpYnV0aW9uOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29udHJpYnV0aW9uID0gMSAtIHNpZ24xIC0gc2lnbjEgKyBob3Jpem9udGFsQ29udHJpYnV0aW9uOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoc2lnbmlmaWNhbmNlMSkgewogICAgICAgICAgc2lnbjAgPSBjb2VmZmljZW50c1NpZ25baW5kZXggLSB3aWR0aF07CiAgICAgICAgICBjb250cmlidXRpb24gPSAxIC0gc2lnbjAgLSBzaWduMCArIGhvcml6b250YWxDb250cmlidXRpb247CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnRyaWJ1dGlvbiA9IGhvcml6b250YWxDb250cmlidXRpb247CiAgICAgICAgfQoKICAgICAgICBpZiAoY29udHJpYnV0aW9uID49IDApIHsKICAgICAgICAgIGNvbnRleHRMYWJlbCA9IDkgKyBjb250cmlidXRpb247CiAgICAgICAgICBkZWNvZGVkID0gdGhpcy5kZWNvZGVyLnJlYWRCaXQodGhpcy5jb250ZXh0cywgY29udGV4dExhYmVsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGV4dExhYmVsID0gOSAtIGNvbnRyaWJ1dGlvbjsKICAgICAgICAgIGRlY29kZWQgPSB0aGlzLmRlY29kZXIucmVhZEJpdCh0aGlzLmNvbnRleHRzLCBjb250ZXh0TGFiZWwpIF4gMTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBkZWNvZGVkOwogICAgICB9LAogICAgICBydW5NYWduaXR1ZGVSZWZpbmVtZW50UGFzczogZnVuY3Rpb24gQml0TW9kZWxfcnVuTWFnbml0dWRlUmVmaW5lbWVudFBhc3MoKSB7CiAgICAgICAgdmFyIGRlY29kZXIgPSB0aGlzLmRlY29kZXI7CiAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aCwKICAgICAgICAgICAgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICAgICAgdmFyIGNvZWZmaWNlbnRzTWFnbml0dWRlID0gdGhpcy5jb2VmZmljZW50c01hZ25pdHVkZTsKICAgICAgICB2YXIgbmVpZ2hib3JzU2lnbmlmaWNhbmNlID0gdGhpcy5uZWlnaGJvcnNTaWduaWZpY2FuY2U7CiAgICAgICAgdmFyIGNvbnRleHRzID0gdGhpcy5jb250ZXh0czsKICAgICAgICB2YXIgYml0c0RlY29kZWQgPSB0aGlzLmJpdHNEZWNvZGVkOwogICAgICAgIHZhciBwcm9jZXNzaW5nRmxhZ3MgPSB0aGlzLnByb2Nlc3NpbmdGbGFnczsKICAgICAgICB2YXIgcHJvY2Vzc2VkTWFzayA9IDE7CiAgICAgICAgdmFyIGZpcnN0TWFnbml0dWRlQml0TWFzayA9IDI7CiAgICAgICAgdmFyIGxlbmd0aCA9IHdpZHRoICogaGVpZ2h0OwogICAgICAgIHZhciB3aWR0aDQgPSB3aWR0aCAqIDQ7CgogICAgICAgIGZvciAodmFyIGluZGV4MCA9IDAsIGluZGV4TmV4dDsgaW5kZXgwIDwgbGVuZ3RoOyBpbmRleDAgPSBpbmRleE5leHQpIHsKICAgICAgICAgIGluZGV4TmV4dCA9IE1hdGgubWluKGxlbmd0aCwgaW5kZXgwICsgd2lkdGg0KTsKCiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSBpbmRleDAgKyBqOyBpbmRleCA8IGluZGV4TmV4dDsgaW5kZXggKz0gd2lkdGgpIHsKICAgICAgICAgICAgICBpZiAoIWNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4XSB8fCAocHJvY2Vzc2luZ0ZsYWdzW2luZGV4XSAmIHByb2Nlc3NlZE1hc2spICE9PSAwKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBjb250ZXh0TGFiZWwgPSAxNjsKCiAgICAgICAgICAgICAgaWYgKChwcm9jZXNzaW5nRmxhZ3NbaW5kZXhdICYgZmlyc3RNYWduaXR1ZGVCaXRNYXNrKSAhPT0gMCkgewogICAgICAgICAgICAgICAgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4XSBePSBmaXJzdE1hZ25pdHVkZUJpdE1hc2s7CiAgICAgICAgICAgICAgICB2YXIgc2lnbmlmaWNhbmNlID0gbmVpZ2hib3JzU2lnbmlmaWNhbmNlW2luZGV4XSAmIDEyNzsKICAgICAgICAgICAgICAgIGNvbnRleHRMYWJlbCA9IHNpZ25pZmljYW5jZSA9PT0gMCA/IDE1IDogMTQ7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgYml0ID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBjb250ZXh0TGFiZWwpOwogICAgICAgICAgICAgIGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4XSA9IGNvZWZmaWNlbnRzTWFnbml0dWRlW2luZGV4XSA8PCAxIHwgYml0OwogICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4XSsrOwogICAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gfD0gcHJvY2Vzc2VkTWFzazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgcnVuQ2xlYW51cFBhc3M6IGZ1bmN0aW9uIEJpdE1vZGVsX3J1bkNsZWFudXBQYXNzKCkgewogICAgICAgIHZhciBkZWNvZGVyID0gdGhpcy5kZWNvZGVyOwogICAgICAgIHZhciB3aWR0aCA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgICAgIHZhciBuZWlnaGJvcnNTaWduaWZpY2FuY2UgPSB0aGlzLm5laWdoYm9yc1NpZ25pZmljYW5jZTsKICAgICAgICB2YXIgY29lZmZpY2VudHNNYWduaXR1ZGUgPSB0aGlzLmNvZWZmaWNlbnRzTWFnbml0dWRlOwogICAgICAgIHZhciBjb2VmZmljZW50c1NpZ24gPSB0aGlzLmNvZWZmaWNlbnRzU2lnbjsKICAgICAgICB2YXIgY29udGV4dHMgPSB0aGlzLmNvbnRleHRzOwogICAgICAgIHZhciBsYWJlbHMgPSB0aGlzLmNvbnRleHRMYWJlbFRhYmxlOwogICAgICAgIHZhciBiaXRzRGVjb2RlZCA9IHRoaXMuYml0c0RlY29kZWQ7CiAgICAgICAgdmFyIHByb2Nlc3NpbmdGbGFncyA9IHRoaXMucHJvY2Vzc2luZ0ZsYWdzOwogICAgICAgIHZhciBwcm9jZXNzZWRNYXNrID0gMTsKICAgICAgICB2YXIgZmlyc3RNYWduaXR1ZGVCaXRNYXNrID0gMjsKICAgICAgICB2YXIgb25lUm93RG93biA9IHdpZHRoOwogICAgICAgIHZhciB0d29Sb3dzRG93biA9IHdpZHRoICogMjsKICAgICAgICB2YXIgdGhyZWVSb3dzRG93biA9IHdpZHRoICogMzsKICAgICAgICB2YXIgaU5leHQ7CgogICAgICAgIGZvciAodmFyIGkwID0gMDsgaTAgPCBoZWlnaHQ7IGkwID0gaU5leHQpIHsKICAgICAgICAgIGlOZXh0ID0gTWF0aC5taW4oaTAgKyA0LCBoZWlnaHQpOwogICAgICAgICAgdmFyIGluZGV4QmFzZSA9IGkwICogd2lkdGg7CiAgICAgICAgICB2YXIgY2hlY2tBbGxFbXB0eSA9IGkwICsgMyA8IGhlaWdodDsKCiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHdpZHRoOyBqKyspIHsKICAgICAgICAgICAgdmFyIGluZGV4MCA9IGluZGV4QmFzZSArIGo7CiAgICAgICAgICAgIHZhciBhbGxFbXB0eSA9IGNoZWNrQWxsRW1wdHkgJiYgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4MF0gPT09IDAgJiYgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4MCArIG9uZVJvd0Rvd25dID09PSAwICYmIHByb2Nlc3NpbmdGbGFnc1tpbmRleDAgKyB0d29Sb3dzRG93bl0gPT09IDAgJiYgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4MCArIHRocmVlUm93c0Rvd25dID09PSAwICYmIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleDBdID09PSAwICYmIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleDAgKyBvbmVSb3dEb3duXSA9PT0gMCAmJiBuZWlnaGJvcnNTaWduaWZpY2FuY2VbaW5kZXgwICsgdHdvUm93c0Rvd25dID09PSAwICYmIG5laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleDAgKyB0aHJlZVJvd3NEb3duXSA9PT0gMDsKICAgICAgICAgICAgdmFyIGkxID0gMCwKICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kZXgwOwogICAgICAgICAgICB2YXIgaSA9IGkwLAogICAgICAgICAgICAgICAgc2lnbjsKCiAgICAgICAgICAgIGlmIChhbGxFbXB0eSkgewogICAgICAgICAgICAgIHZhciBoYXNTaWduaWZpY2FudENvZWZmaWNlbnQgPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIFJVTkxFTkdUSF9DT05URVhUKTsKCiAgICAgICAgICAgICAgaWYgKCFoYXNTaWduaWZpY2FudENvZWZmaWNlbnQpIHsKICAgICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MF0rKzsKICAgICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MCArIG9uZVJvd0Rvd25dKys7CiAgICAgICAgICAgICAgICBiaXRzRGVjb2RlZFtpbmRleDAgKyB0d29Sb3dzRG93bl0rKzsKICAgICAgICAgICAgICAgIGJpdHNEZWNvZGVkW2luZGV4MCArIHRocmVlUm93c0Rvd25dKys7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGkxID0gZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBVTklGT1JNX0NPTlRFWFQpIDw8IDEgfCBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIFVOSUZPUk1fQ09OVEVYVCk7CgogICAgICAgICAgICAgIGlmIChpMSAhPT0gMCkgewogICAgICAgICAgICAgICAgaSA9IGkwICsgaTE7CiAgICAgICAgICAgICAgICBpbmRleCArPSBpMSAqIHdpZHRoOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc2lnbiA9IHRoaXMuZGVjb2RlU2lnbkJpdChpLCBqLCBpbmRleCk7CiAgICAgICAgICAgICAgY29lZmZpY2VudHNTaWduW2luZGV4XSA9IHNpZ247CiAgICAgICAgICAgICAgY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXhdID0gMTsKICAgICAgICAgICAgICB0aGlzLnNldE5laWdoYm9yc1NpZ25pZmljYW5jZShpLCBqLCBpbmRleCk7CiAgICAgICAgICAgICAgcHJvY2Vzc2luZ0ZsYWdzW2luZGV4XSB8PSBmaXJzdE1hZ25pdHVkZUJpdE1hc2s7CiAgICAgICAgICAgICAgaW5kZXggPSBpbmRleDA7CgogICAgICAgICAgICAgIGZvciAodmFyIGkyID0gaTA7IGkyIDw9IGk7IGkyKyssIGluZGV4ICs9IHdpZHRoKSB7CiAgICAgICAgICAgICAgICBiaXRzRGVjb2RlZFtpbmRleF0rKzsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGkxKys7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciAoaSA9IGkwICsgaTE7IGkgPCBpTmV4dDsgaSsrLCBpbmRleCArPSB3aWR0aCkgewogICAgICAgICAgICAgIGlmIChjb2VmZmljZW50c01hZ25pdHVkZVtpbmRleF0gfHwgKHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gJiBwcm9jZXNzZWRNYXNrKSAhPT0gMCkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgY29udGV4dExhYmVsID0gbGFiZWxzW25laWdoYm9yc1NpZ25pZmljYW5jZVtpbmRleF1dOwogICAgICAgICAgICAgIHZhciBkZWNpc2lvbiA9IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgY29udGV4dExhYmVsKTsKCiAgICAgICAgICAgICAgaWYgKGRlY2lzaW9uID09PSAxKSB7CiAgICAgICAgICAgICAgICBzaWduID0gdGhpcy5kZWNvZGVTaWduQml0KGksIGosIGluZGV4KTsKICAgICAgICAgICAgICAgIGNvZWZmaWNlbnRzU2lnbltpbmRleF0gPSBzaWduOwogICAgICAgICAgICAgICAgY29lZmZpY2VudHNNYWduaXR1ZGVbaW5kZXhdID0gMTsKICAgICAgICAgICAgICAgIHRoaXMuc2V0TmVpZ2hib3JzU2lnbmlmaWNhbmNlKGksIGosIGluZGV4KTsKICAgICAgICAgICAgICAgIHByb2Nlc3NpbmdGbGFnc1tpbmRleF0gfD0gZmlyc3RNYWduaXR1ZGVCaXRNYXNrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYml0c0RlY29kZWRbaW5kZXhdKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNoZWNrU2VnbWVudGF0aW9uU3ltYm9sOiBmdW5jdGlvbiBCaXRNb2RlbF9jaGVja1NlZ21lbnRhdGlvblN5bWJvbCgpIHsKICAgICAgICB2YXIgZGVjb2RlciA9IHRoaXMuZGVjb2RlcjsKICAgICAgICB2YXIgY29udGV4dHMgPSB0aGlzLmNvbnRleHRzOwogICAgICAgIHZhciBzeW1ib2wgPSBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIFVOSUZPUk1fQ09OVEVYVCkgPDwgMyB8IGRlY29kZXIucmVhZEJpdChjb250ZXh0cywgVU5JRk9STV9DT05URVhUKSA8PCAyIHwgZGVjb2Rlci5yZWFkQml0KGNvbnRleHRzLCBVTklGT1JNX0NPTlRFWFQpIDw8IDEgfCBkZWNvZGVyLnJlYWRCaXQoY29udGV4dHMsIFVOSUZPUk1fQ09OVEVYVCk7CgogICAgICAgIGlmIChzeW1ib2wgIT09IDB4YSkgewogICAgICAgICAgdGhyb3cgbmV3IEpweEVycm9yKCJJbnZhbGlkIHNlZ21lbnRhdGlvbiBzeW1ib2wiKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gQml0TW9kZWw7CiAgfSgpOwoKICB2YXIgVHJhbnNmb3JtID0gZnVuY3Rpb24gVHJhbnNmb3JtQ2xvc3VyZSgpIHsKICAgIGZ1bmN0aW9uIFRyYW5zZm9ybSgpIHt9CgogICAgVHJhbnNmb3JtLnByb3RvdHlwZS5jYWxjdWxhdGUgPSBmdW5jdGlvbiB0cmFuc2Zvcm1DYWxjdWxhdGUoc3ViYmFuZHMsIHUwLCB2MCkgewogICAgICB2YXIgbGwgPSBzdWJiYW5kc1swXTsKCiAgICAgIGZvciAodmFyIGkgPSAxLCBpaSA9IHN1YmJhbmRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBsbCA9IHRoaXMuaXRlcmF0ZShsbCwgc3ViYmFuZHNbaV0sIHUwLCB2MCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBsbDsKICAgIH07CgogICAgVHJhbnNmb3JtLnByb3RvdHlwZS5leHRlbmQgPSBmdW5jdGlvbiBleHRlbmQoYnVmZmVyLCBvZmZzZXQsIHNpemUpIHsKICAgICAgdmFyIGkxID0gb2Zmc2V0IC0gMSwKICAgICAgICAgIGoxID0gb2Zmc2V0ICsgMTsKICAgICAgdmFyIGkyID0gb2Zmc2V0ICsgc2l6ZSAtIDIsCiAgICAgICAgICBqMiA9IG9mZnNldCArIHNpemU7CiAgICAgIGJ1ZmZlcltpMS0tXSA9IGJ1ZmZlcltqMSsrXTsKICAgICAgYnVmZmVyW2oyKytdID0gYnVmZmVyW2kyLS1dOwogICAgICBidWZmZXJbaTEtLV0gPSBidWZmZXJbajErK107CiAgICAgIGJ1ZmZlcltqMisrXSA9IGJ1ZmZlcltpMi0tXTsKICAgICAgYnVmZmVyW2kxLS1dID0gYnVmZmVyW2oxKytdOwogICAgICBidWZmZXJbajIrK10gPSBidWZmZXJbaTItLV07CiAgICAgIGJ1ZmZlcltpMV0gPSBidWZmZXJbajFdOwogICAgICBidWZmZXJbajJdID0gYnVmZmVyW2kyXTsKICAgIH07CgogICAgVHJhbnNmb3JtLnByb3RvdHlwZS5pdGVyYXRlID0gZnVuY3Rpb24gVHJhbnNmb3JtX2l0ZXJhdGUobGwsIGhsX2xoX2hoLCB1MCwgdjApIHsKICAgICAgdmFyIGxsV2lkdGggPSBsbC53aWR0aCwKICAgICAgICAgIGxsSGVpZ2h0ID0gbGwuaGVpZ2h0LAogICAgICAgICAgbGxJdGVtcyA9IGxsLml0ZW1zOwogICAgICB2YXIgd2lkdGggPSBobF9saF9oaC53aWR0aDsKICAgICAgdmFyIGhlaWdodCA9IGhsX2xoX2hoLmhlaWdodDsKICAgICAgdmFyIGl0ZW1zID0gaGxfbGhfaGguaXRlbXM7CiAgICAgIHZhciBpLCBqLCBrLCBsLCB1LCB2OwoKICAgICAgZm9yIChrID0gMCwgaSA9IDA7IGkgPCBsbEhlaWdodDsgaSsrKSB7CiAgICAgICAgbCA9IGkgKiAyICogd2lkdGg7CgogICAgICAgIGZvciAoaiA9IDA7IGogPCBsbFdpZHRoOyBqKyssIGsrKywgbCArPSAyKSB7CiAgICAgICAgICBpdGVtc1tsXSA9IGxsSXRlbXNba107CiAgICAgICAgfQogICAgICB9CgogICAgICBsbEl0ZW1zID0gbGwuaXRlbXMgPSBudWxsOwogICAgICB2YXIgYnVmZmVyUGFkZGluZyA9IDQ7CiAgICAgIHZhciByb3dCdWZmZXIgPSBuZXcgRmxvYXQzMkFycmF5KHdpZHRoICsgMiAqIGJ1ZmZlclBhZGRpbmcpOwoKICAgICAgaWYgKHdpZHRoID09PSAxKSB7CiAgICAgICAgaWYgKCh1MCAmIDEpICE9PSAwKSB7CiAgICAgICAgICBmb3IgKHYgPSAwLCBrID0gMDsgdiA8IGhlaWdodDsgdisrLCBrICs9IHdpZHRoKSB7CiAgICAgICAgICAgIGl0ZW1zW2tdICo9IDAuNTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yICh2ID0gMCwgayA9IDA7IHYgPCBoZWlnaHQ7IHYrKywgayArPSB3aWR0aCkgewogICAgICAgICAgcm93QnVmZmVyLnNldChpdGVtcy5zdWJhcnJheShrLCBrICsgd2lkdGgpLCBidWZmZXJQYWRkaW5nKTsKICAgICAgICAgIHRoaXMuZXh0ZW5kKHJvd0J1ZmZlciwgYnVmZmVyUGFkZGluZywgd2lkdGgpOwogICAgICAgICAgdGhpcy5maWx0ZXIocm93QnVmZmVyLCBidWZmZXJQYWRkaW5nLCB3aWR0aCk7CiAgICAgICAgICBpdGVtcy5zZXQocm93QnVmZmVyLnN1YmFycmF5KGJ1ZmZlclBhZGRpbmcsIGJ1ZmZlclBhZGRpbmcgKyB3aWR0aCksIGspOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIG51bUJ1ZmZlcnMgPSAxNjsKICAgICAgdmFyIGNvbEJ1ZmZlcnMgPSBbXTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBudW1CdWZmZXJzOyBpKyspIHsKICAgICAgICBjb2xCdWZmZXJzLnB1c2gobmV3IEZsb2F0MzJBcnJheShoZWlnaHQgKyAyICogYnVmZmVyUGFkZGluZykpOwogICAgICB9CgogICAgICB2YXIgYiwKICAgICAgICAgIGN1cnJlbnRCdWZmZXIgPSAwOwogICAgICBsbCA9IGJ1ZmZlclBhZGRpbmcgKyBoZWlnaHQ7CgogICAgICBpZiAoaGVpZ2h0ID09PSAxKSB7CiAgICAgICAgaWYgKCh2MCAmIDEpICE9PSAwKSB7CiAgICAgICAgICBmb3IgKHUgPSAwOyB1IDwgd2lkdGg7IHUrKykgewogICAgICAgICAgICBpdGVtc1t1XSAqPSAwLjU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAodSA9IDA7IHUgPCB3aWR0aDsgdSsrKSB7CiAgICAgICAgICBpZiAoY3VycmVudEJ1ZmZlciA9PT0gMCkgewogICAgICAgICAgICBudW1CdWZmZXJzID0gTWF0aC5taW4od2lkdGggLSB1LCBudW1CdWZmZXJzKTsKCiAgICAgICAgICAgIGZvciAoayA9IHUsIGwgPSBidWZmZXJQYWRkaW5nOyBsIDwgbGw7IGsgKz0gd2lkdGgsIGwrKykgewogICAgICAgICAgICAgIGZvciAoYiA9IDA7IGIgPCBudW1CdWZmZXJzOyBiKyspIHsKICAgICAgICAgICAgICAgIGNvbEJ1ZmZlcnNbYl1bbF0gPSBpdGVtc1trICsgYl07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBjdXJyZW50QnVmZmVyID0gbnVtQnVmZmVyczsKICAgICAgICAgIH0KCiAgICAgICAgICBjdXJyZW50QnVmZmVyLS07CiAgICAgICAgICB2YXIgYnVmZmVyID0gY29sQnVmZmVyc1tjdXJyZW50QnVmZmVyXTsKICAgICAgICAgIHRoaXMuZXh0ZW5kKGJ1ZmZlciwgYnVmZmVyUGFkZGluZywgaGVpZ2h0KTsKICAgICAgICAgIHRoaXMuZmlsdGVyKGJ1ZmZlciwgYnVmZmVyUGFkZGluZywgaGVpZ2h0KTsKCiAgICAgICAgICBpZiAoY3VycmVudEJ1ZmZlciA9PT0gMCkgewogICAgICAgICAgICBrID0gdSAtIG51bUJ1ZmZlcnMgKyAxOwoKICAgICAgICAgICAgZm9yIChsID0gYnVmZmVyUGFkZGluZzsgbCA8IGxsOyBrICs9IHdpZHRoLCBsKyspIHsKICAgICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgbnVtQnVmZmVyczsgYisrKSB7CiAgICAgICAgICAgICAgICBpdGVtc1trICsgYl0gPSBjb2xCdWZmZXJzW2JdW2xdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogd2lkdGgsCiAgICAgICAgaGVpZ2h0OiBoZWlnaHQsCiAgICAgICAgaXRlbXM6IGl0ZW1zCiAgICAgIH07CiAgICB9OwoKICAgIHJldHVybiBUcmFuc2Zvcm07CiAgfSgpOwoKICB2YXIgSXJyZXZlcnNpYmxlVHJhbnNmb3JtID0gZnVuY3Rpb24gSXJyZXZlcnNpYmxlVHJhbnNmb3JtQ2xvc3VyZSgpIHsKICAgIGZ1bmN0aW9uIElycmV2ZXJzaWJsZVRyYW5zZm9ybSgpIHsKICAgICAgVHJhbnNmb3JtLmNhbGwodGhpcyk7CiAgICB9CgogICAgSXJyZXZlcnNpYmxlVHJhbnNmb3JtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoVHJhbnNmb3JtLnByb3RvdHlwZSk7CgogICAgSXJyZXZlcnNpYmxlVHJhbnNmb3JtLnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbiBpcnJldmVyc2libGVUcmFuc2Zvcm1GaWx0ZXIoeCwgb2Zmc2V0LCBsZW5ndGgpIHsKICAgICAgdmFyIGxlbiA9IGxlbmd0aCA+PiAxOwogICAgICBvZmZzZXQgPSBvZmZzZXQgfCAwOwogICAgICB2YXIgaiwgbiwgY3VycmVudCwgbmV4dDsKICAgICAgdmFyIGFscGhhID0gLTEuNTg2MTM0MzQyMDU5OTI0OwogICAgICB2YXIgYmV0YSA9IC0wLjA1Mjk4MDExODU3Mjk2MTsKICAgICAgdmFyIGdhbW1hID0gMC44ODI5MTEwNzU1MzA5MzQ7CiAgICAgIHZhciBkZWx0YSA9IDAuNDQzNTA2ODUyMDQzOTcxOwogICAgICB2YXIgSyA9IDEuMjMwMTc0MTA0OTE0MDAxOwogICAgICB2YXIgS18gPSAxIC8gSzsKICAgICAgaiA9IG9mZnNldCAtIDM7CgogICAgICBmb3IgKG4gPSBsZW4gKyA0OyBuLS07IGogKz0gMikgewogICAgICAgIHhbal0gKj0gS187CiAgICAgIH0KCiAgICAgIGogPSBvZmZzZXQgLSAyOwogICAgICBjdXJyZW50ID0gZGVsdGEgKiB4W2ogLSAxXTsKCiAgICAgIGZvciAobiA9IGxlbiArIDM7IG4tLTsgaiArPSAyKSB7CiAgICAgICAgbmV4dCA9IGRlbHRhICogeFtqICsgMV07CiAgICAgICAgeFtqXSA9IEsgKiB4W2pdIC0gY3VycmVudCAtIG5leHQ7CgogICAgICAgIGlmIChuLS0pIHsKICAgICAgICAgIGogKz0gMjsKICAgICAgICAgIGN1cnJlbnQgPSBkZWx0YSAqIHhbaiArIDFdOwogICAgICAgICAgeFtqXSA9IEsgKiB4W2pdIC0gY3VycmVudCAtIG5leHQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IG9mZnNldCAtIDE7CiAgICAgIGN1cnJlbnQgPSBnYW1tYSAqIHhbaiAtIDFdOwoKICAgICAgZm9yIChuID0gbGVuICsgMjsgbi0tOyBqICs9IDIpIHsKICAgICAgICBuZXh0ID0gZ2FtbWEgKiB4W2ogKyAxXTsKICAgICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwoKICAgICAgICBpZiAobi0tKSB7CiAgICAgICAgICBqICs9IDI7CiAgICAgICAgICBjdXJyZW50ID0gZ2FtbWEgKiB4W2ogKyAxXTsKICAgICAgICAgIHhbal0gLT0gY3VycmVudCArIG5leHQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IG9mZnNldDsKICAgICAgY3VycmVudCA9IGJldGEgKiB4W2ogLSAxXTsKCiAgICAgIGZvciAobiA9IGxlbiArIDE7IG4tLTsgaiArPSAyKSB7CiAgICAgICAgbmV4dCA9IGJldGEgKiB4W2ogKyAxXTsKICAgICAgICB4W2pdIC09IGN1cnJlbnQgKyBuZXh0OwoKICAgICAgICBpZiAobi0tKSB7CiAgICAgICAgICBqICs9IDI7CiAgICAgICAgICBjdXJyZW50ID0gYmV0YSAqIHhbaiArIDFdOwogICAgICAgICAgeFtqXSAtPSBjdXJyZW50ICsgbmV4dDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAobGVuICE9PSAwKSB7CiAgICAgICAgaiA9IG9mZnNldCArIDE7CiAgICAgICAgY3VycmVudCA9IGFscGhhICogeFtqIC0gMV07CgogICAgICAgIGZvciAobiA9IGxlbjsgbi0tOyBqICs9IDIpIHsKICAgICAgICAgIG5leHQgPSBhbHBoYSAqIHhbaiArIDFdOwogICAgICAgICAgeFtqXSAtPSBjdXJyZW50ICsgbmV4dDsKCiAgICAgICAgICBpZiAobi0tKSB7CiAgICAgICAgICAgIGogKz0gMjsKICAgICAgICAgICAgY3VycmVudCA9IGFscGhhICogeFtqICsgMV07CiAgICAgICAgICAgIHhbal0gLT0gY3VycmVudCArIG5leHQ7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIElycmV2ZXJzaWJsZVRyYW5zZm9ybTsKICB9KCk7CgogIHZhciBSZXZlcnNpYmxlVHJhbnNmb3JtID0gZnVuY3Rpb24gUmV2ZXJzaWJsZVRyYW5zZm9ybUNsb3N1cmUoKSB7CiAgICBmdW5jdGlvbiBSZXZlcnNpYmxlVHJhbnNmb3JtKCkgewogICAgICBUcmFuc2Zvcm0uY2FsbCh0aGlzKTsKICAgIH0KCiAgICBSZXZlcnNpYmxlVHJhbnNmb3JtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoVHJhbnNmb3JtLnByb3RvdHlwZSk7CgogICAgUmV2ZXJzaWJsZVRyYW5zZm9ybS5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gcmV2ZXJzaWJsZVRyYW5zZm9ybUZpbHRlcih4LCBvZmZzZXQsIGxlbmd0aCkgewogICAgICB2YXIgbGVuID0gbGVuZ3RoID4+IDE7CiAgICAgIG9mZnNldCA9IG9mZnNldCB8IDA7CiAgICAgIHZhciBqLCBuOwoKICAgICAgZm9yIChqID0gb2Zmc2V0LCBuID0gbGVuICsgMTsgbi0tOyBqICs9IDIpIHsKICAgICAgICB4W2pdIC09IHhbaiAtIDFdICsgeFtqICsgMV0gKyAyID4+IDI7CiAgICAgIH0KCiAgICAgIGZvciAoaiA9IG9mZnNldCArIDEsIG4gPSBsZW47IG4tLTsgaiArPSAyKSB7CiAgICAgICAgeFtqXSArPSB4W2ogLSAxXSArIHhbaiArIDFdID4+IDE7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIFJldmVyc2libGVUcmFuc2Zvcm07CiAgfSgpOwoKICByZXR1cm4gSnB4SW1hZ2U7Cn0oKTsKCmV4cG9ydHMuSnB4SW1hZ2UgPSBKcHhJbWFnZTsKCi8qKiovIH0pLAovKiAyMTUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5jYWxjdWxhdGVTSEE1MTIgPSBleHBvcnRzLmNhbGN1bGF0ZVNIQTM4NCA9IGV4cG9ydHMuY2FsY3VsYXRlU0hBMjU2ID0gZXhwb3J0cy5jYWxjdWxhdGVNRDUgPSBleHBvcnRzLlBERjIwID0gZXhwb3J0cy5QREYxNyA9IGV4cG9ydHMuQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeSA9IGV4cG9ydHMuQVJDRm91ckNpcGhlciA9IGV4cG9ydHMuQUVTMjU2Q2lwaGVyID0gZXhwb3J0cy5BRVMxMjhDaXBoZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTgpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNSk7CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9Cgp2YXIgQVJDRm91ckNpcGhlciA9IGZ1bmN0aW9uIEFSQ0ZvdXJDaXBoZXJDbG9zdXJlKCkgewogIGZ1bmN0aW9uIEFSQ0ZvdXJDaXBoZXIoa2V5KSB7CiAgICB0aGlzLmEgPSAwOwogICAgdGhpcy5iID0gMDsKICAgIHZhciBzID0gbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICAgIHZhciBpLAogICAgICAgIGogPSAwLAogICAgICAgIHRtcCwKICAgICAgICBrZXlMZW5ndGggPSBrZXkubGVuZ3RoOwoKICAgIGZvciAoaSA9IDA7IGkgPCAyNTY7ICsraSkgewogICAgICBzW2ldID0gaTsKICAgIH0KCiAgICBmb3IgKGkgPSAwOyBpIDwgMjU2OyArK2kpIHsKICAgICAgdG1wID0gc1tpXTsKICAgICAgaiA9IGogKyB0bXAgKyBrZXlbaSAlIGtleUxlbmd0aF0gJiAweGZmOwogICAgICBzW2ldID0gc1tqXTsKICAgICAgc1tqXSA9IHRtcDsKICAgIH0KCiAgICB0aGlzLnMgPSBzOwogIH0KCiAgQVJDRm91ckNpcGhlci5wcm90b3R5cGUgPSB7CiAgICBlbmNyeXB0QmxvY2s6IGZ1bmN0aW9uIEFSQ0ZvdXJDaXBoZXJfZW5jcnlwdEJsb2NrKGRhdGEpIHsKICAgICAgdmFyIGksCiAgICAgICAgICBuID0gZGF0YS5sZW5ndGgsCiAgICAgICAgICB0bXAsCiAgICAgICAgICB0bXAyOwogICAgICB2YXIgYSA9IHRoaXMuYSwKICAgICAgICAgIGIgPSB0aGlzLmIsCiAgICAgICAgICBzID0gdGhpcy5zOwogICAgICB2YXIgb3V0cHV0ID0gbmV3IFVpbnQ4QXJyYXkobik7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgICAgYSA9IGEgKyAxICYgMHhmZjsKICAgICAgICB0bXAgPSBzW2FdOwogICAgICAgIGIgPSBiICsgdG1wICYgMHhmZjsKICAgICAgICB0bXAyID0gc1tiXTsKICAgICAgICBzW2FdID0gdG1wMjsKICAgICAgICBzW2JdID0gdG1wOwogICAgICAgIG91dHB1dFtpXSA9IGRhdGFbaV0gXiBzW3RtcCArIHRtcDIgJiAweGZmXTsKICAgICAgfQoKICAgICAgdGhpcy5hID0gYTsKICAgICAgdGhpcy5iID0gYjsKICAgICAgcmV0dXJuIG91dHB1dDsKICAgIH0KICB9OwogIEFSQ0ZvdXJDaXBoZXIucHJvdG90eXBlLmRlY3J5cHRCbG9jayA9IEFSQ0ZvdXJDaXBoZXIucHJvdG90eXBlLmVuY3J5cHRCbG9jazsKICByZXR1cm4gQVJDRm91ckNpcGhlcjsKfSgpOwoKZXhwb3J0cy5BUkNGb3VyQ2lwaGVyID0gQVJDRm91ckNpcGhlcjsKCnZhciBjYWxjdWxhdGVNRDUgPSBmdW5jdGlvbiBjYWxjdWxhdGVNRDVDbG9zdXJlKCkgewogIHZhciByID0gbmV3IFVpbnQ4QXJyYXkoWzcsIDEyLCAxNywgMjIsIDcsIDEyLCAxNywgMjIsIDcsIDEyLCAxNywgMjIsIDcsIDEyLCAxNywgMjIsIDUsIDksIDE0LCAyMCwgNSwgOSwgMTQsIDIwLCA1LCA5LCAxNCwgMjAsIDUsIDksIDE0LCAyMCwgNCwgMTEsIDE2LCAyMywgNCwgMTEsIDE2LCAyMywgNCwgMTEsIDE2LCAyMywgNCwgMTEsIDE2LCAyMywgNiwgMTAsIDE1LCAyMSwgNiwgMTAsIDE1LCAyMSwgNiwgMTAsIDE1LCAyMSwgNiwgMTAsIDE1LCAyMV0pOwogIHZhciBrID0gbmV3IEludDMyQXJyYXkoWy02ODA4NzY5MzYsIC0zODk1NjQ1ODYsIDYwNjEwNTgxOSwgLTEwNDQ1MjUzMzAsIC0xNzY0MTg4OTcsIDEyMDAwODA0MjYsIC0xNDczMjMxMzQxLCAtNDU3MDU5ODMsIDE3NzAwMzU0MTYsIC0xOTU4NDE0NDE3LCAtNDIwNjMsIC0xOTkwNDA0MTYyLCAxODA0NjAzNjgyLCAtNDAzNDExMDEsIC0xNTAyMDAyMjkwLCAxMjM2NTM1MzI5LCAtMTY1Nzk2NTEwLCAtMTA2OTUwMTYzMiwgNjQzNzE3NzEzLCAtMzczODk3MzAyLCAtNzAxNTU4NjkxLCAzODAxNjA4MywgLTY2MDQ3ODMzNSwgLTQwNTUzNzg0OCwgNTY4NDQ2NDM4LCAtMTAxOTgwMzY5MCwgLTE4NzM2Mzk2MSwgMTE2MzUzMTUwMSwgLTE0NDQ2ODE0NjcsIC01MTQwMzc4NCwgMTczNTMyODQ3MywgLTE5MjY2MDc3MzQsIC0zNzg1NTgsIC0yMDIyNTc0NDYzLCAxODM5MDMwNTYyLCAtMzUzMDk1NTYsIC0xNTMwOTkyMDYwLCAxMjcyODkzMzUzLCAtMTU1NDk3NjMyLCAtMTA5NDczMDY0MCwgNjgxMjc5MTc0LCAtMzU4NTM3MjIyLCAtNzIyNTIxOTc5LCA3NjAyOTE4OSwgLTY0MDM2NDQ4NywgLTQyMTgxNTgzNSwgNTMwNzQyNTIwLCAtOTk1MzM4NjUxLCAtMTk4NjMwODQ0LCAxMTI2ODkxNDE1LCAtMTQxNjM1NDkwNSwgLTU3NDM0MDU1LCAxNzAwNDg1NTcxLCAtMTg5NDk4NjYwNiwgLTEwNTE1MjMsIC0yMDU0OTIyNzk5LCAxODczMzEzMzU5LCAtMzA2MTE3NDQsIC0xNTYwMTk4MzgwLCAxMzA5MTUxNjQ5LCAtMTQ1NTIzMDcwLCAtMTEyMDIxMDM3OSwgNzE4Nzg3MjU5LCAtMzQzNDg1NTUxXSk7CgogIGZ1bmN0aW9uIGhhc2goZGF0YSwgb2Zmc2V0LCBsZW5ndGgpIHsKICAgIHZhciBoMCA9IDE3MzI1ODQxOTMsCiAgICAgICAgaDEgPSAtMjcxNzMzODc5LAogICAgICAgIGgyID0gLTE3MzI1ODQxOTQsCiAgICAgICAgaDMgPSAyNzE3MzM4Nzg7CiAgICB2YXIgcGFkZGVkTGVuZ3RoID0gbGVuZ3RoICsgNzIgJiB+NjM7CiAgICB2YXIgcGFkZGVkID0gbmV3IFVpbnQ4QXJyYXkocGFkZGVkTGVuZ3RoKTsKICAgIHZhciBpLCBqLCBuOwoKICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICBwYWRkZWRbaV0gPSBkYXRhW29mZnNldCsrXTsKICAgIH0KCiAgICBwYWRkZWRbaSsrXSA9IDB4ODA7CiAgICBuID0gcGFkZGVkTGVuZ3RoIC0gODsKCiAgICB3aGlsZSAoaSA8IG4pIHsKICAgICAgcGFkZGVkW2krK10gPSAwOwogICAgfQoKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoIDw8IDMgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4gNSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiAxMyAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiAyMSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+Pj4gMjkgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSAwOwogICAgcGFkZGVkW2krK10gPSAwOwogICAgcGFkZGVkW2krK10gPSAwOwogICAgdmFyIHcgPSBuZXcgSW50MzJBcnJheSgxNik7CgogICAgZm9yIChpID0gMDsgaSA8IHBhZGRlZExlbmd0aDspIHsKICAgICAgZm9yIChqID0gMDsgaiA8IDE2OyArK2osIGkgKz0gNCkgewogICAgICAgIHdbal0gPSBwYWRkZWRbaV0gfCBwYWRkZWRbaSArIDFdIDw8IDggfCBwYWRkZWRbaSArIDJdIDw8IDE2IHwgcGFkZGVkW2kgKyAzXSA8PCAyNDsKICAgICAgfQoKICAgICAgdmFyIGEgPSBoMCwKICAgICAgICAgIGIgPSBoMSwKICAgICAgICAgIGMgPSBoMiwKICAgICAgICAgIGQgPSBoMywKICAgICAgICAgIGYsCiAgICAgICAgICBnOwoKICAgICAgZm9yIChqID0gMDsgaiA8IDY0OyArK2opIHsKICAgICAgICBpZiAoaiA8IDE2KSB7CiAgICAgICAgICBmID0gYiAmIGMgfCB+YiAmIGQ7CiAgICAgICAgICBnID0gajsKICAgICAgICB9IGVsc2UgaWYgKGogPCAzMikgewogICAgICAgICAgZiA9IGQgJiBiIHwgfmQgJiBjOwogICAgICAgICAgZyA9IDUgKiBqICsgMSAmIDE1OwogICAgICAgIH0gZWxzZSBpZiAoaiA8IDQ4KSB7CiAgICAgICAgICBmID0gYiBeIGMgXiBkOwogICAgICAgICAgZyA9IDMgKiBqICsgNSAmIDE1OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmID0gYyBeIChiIHwgfmQpOwogICAgICAgICAgZyA9IDcgKiBqICYgMTU7CiAgICAgICAgfQoKICAgICAgICB2YXIgdG1wID0gZCwKICAgICAgICAgICAgcm90YXRlQXJnID0gYSArIGYgKyBrW2pdICsgd1tnXSB8IDAsCiAgICAgICAgICAgIHJvdGF0ZSA9IHJbal07CiAgICAgICAgZCA9IGM7CiAgICAgICAgYyA9IGI7CiAgICAgICAgYiA9IGIgKyAocm90YXRlQXJnIDw8IHJvdGF0ZSB8IHJvdGF0ZUFyZyA+Pj4gMzIgLSByb3RhdGUpIHwgMDsKICAgICAgICBhID0gdG1wOwogICAgICB9CgogICAgICBoMCA9IGgwICsgYSB8IDA7CiAgICAgIGgxID0gaDEgKyBiIHwgMDsKICAgICAgaDIgPSBoMiArIGMgfCAwOwogICAgICBoMyA9IGgzICsgZCB8IDA7CiAgICB9CgogICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFtoMCAmIDB4RkYsIGgwID4+IDggJiAweEZGLCBoMCA+PiAxNiAmIDB4RkYsIGgwID4+PiAyNCAmIDB4RkYsIGgxICYgMHhGRiwgaDEgPj4gOCAmIDB4RkYsIGgxID4+IDE2ICYgMHhGRiwgaDEgPj4+IDI0ICYgMHhGRiwgaDIgJiAweEZGLCBoMiA+PiA4ICYgMHhGRiwgaDIgPj4gMTYgJiAweEZGLCBoMiA+Pj4gMjQgJiAweEZGLCBoMyAmIDB4RkYsIGgzID4+IDggJiAweEZGLCBoMyA+PiAxNiAmIDB4RkYsIGgzID4+PiAyNCAmIDB4RkZdKTsKICB9CgogIHJldHVybiBoYXNoOwp9KCk7CgpleHBvcnRzLmNhbGN1bGF0ZU1ENSA9IGNhbGN1bGF0ZU1ENTsKCnZhciBXb3JkNjQgPSBmdW5jdGlvbiBXb3JkNjRDbG9zdXJlKCkgewogIGZ1bmN0aW9uIFdvcmQ2NChoaWdoSW50ZWdlciwgbG93SW50ZWdlcikgewogICAgdGhpcy5oaWdoID0gaGlnaEludGVnZXIgfCAwOwogICAgdGhpcy5sb3cgPSBsb3dJbnRlZ2VyIHwgMDsKICB9CgogIFdvcmQ2NC5wcm90b3R5cGUgPSB7CiAgICBhbmQ6IGZ1bmN0aW9uIFdvcmQ2NF9hbmQod29yZCkgewogICAgICB0aGlzLmhpZ2ggJj0gd29yZC5oaWdoOwogICAgICB0aGlzLmxvdyAmPSB3b3JkLmxvdzsKICAgIH0sCiAgICB4b3I6IGZ1bmN0aW9uIFdvcmQ2NF94b3Iod29yZCkgewogICAgICB0aGlzLmhpZ2ggXj0gd29yZC5oaWdoOwogICAgICB0aGlzLmxvdyBePSB3b3JkLmxvdzsKICAgIH0sCiAgICBvcjogZnVuY3Rpb24gV29yZDY0X29yKHdvcmQpIHsKICAgICAgdGhpcy5oaWdoIHw9IHdvcmQuaGlnaDsKICAgICAgdGhpcy5sb3cgfD0gd29yZC5sb3c7CiAgICB9LAogICAgc2hpZnRSaWdodDogZnVuY3Rpb24gV29yZDY0X3NoaWZ0UmlnaHQocGxhY2VzKSB7CiAgICAgIGlmIChwbGFjZXMgPj0gMzIpIHsKICAgICAgICB0aGlzLmxvdyA9IHRoaXMuaGlnaCA+Pj4gcGxhY2VzIC0gMzIgfCAwOwogICAgICAgIHRoaXMuaGlnaCA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5sb3cgPSB0aGlzLmxvdyA+Pj4gcGxhY2VzIHwgdGhpcy5oaWdoIDw8IDMyIC0gcGxhY2VzOwogICAgICAgIHRoaXMuaGlnaCA9IHRoaXMuaGlnaCA+Pj4gcGxhY2VzIHwgMDsKICAgICAgfQogICAgfSwKICAgIHNoaWZ0TGVmdDogZnVuY3Rpb24gV29yZDY0X3NoaWZ0TGVmdChwbGFjZXMpIHsKICAgICAgaWYgKHBsYWNlcyA+PSAzMikgewogICAgICAgIHRoaXMuaGlnaCA9IHRoaXMubG93IDw8IHBsYWNlcyAtIDMyOwogICAgICAgIHRoaXMubG93ID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmhpZ2ggPSB0aGlzLmhpZ2ggPDwgcGxhY2VzIHwgdGhpcy5sb3cgPj4+IDMyIC0gcGxhY2VzOwogICAgICAgIHRoaXMubG93ID0gdGhpcy5sb3cgPDwgcGxhY2VzOwogICAgICB9CiAgICB9LAogICAgcm90YXRlUmlnaHQ6IGZ1bmN0aW9uIFdvcmQ2NF9yb3RhdGVSaWdodChwbGFjZXMpIHsKICAgICAgdmFyIGxvdywgaGlnaDsKCiAgICAgIGlmIChwbGFjZXMgJiAzMikgewogICAgICAgIGhpZ2ggPSB0aGlzLmxvdzsKICAgICAgICBsb3cgPSB0aGlzLmhpZ2g7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbG93ID0gdGhpcy5sb3c7CiAgICAgICAgaGlnaCA9IHRoaXMuaGlnaDsKICAgICAgfQoKICAgICAgcGxhY2VzICY9IDMxOwogICAgICB0aGlzLmxvdyA9IGxvdyA+Pj4gcGxhY2VzIHwgaGlnaCA8PCAzMiAtIHBsYWNlczsKICAgICAgdGhpcy5oaWdoID0gaGlnaCA+Pj4gcGxhY2VzIHwgbG93IDw8IDMyIC0gcGxhY2VzOwogICAgfSwKICAgIG5vdDogZnVuY3Rpb24gV29yZDY0X25vdCgpIHsKICAgICAgdGhpcy5oaWdoID0gfnRoaXMuaGlnaDsKICAgICAgdGhpcy5sb3cgPSB+dGhpcy5sb3c7CiAgICB9LAogICAgYWRkOiBmdW5jdGlvbiBXb3JkNjRfYWRkKHdvcmQpIHsKICAgICAgdmFyIGxvd0FkZCA9ICh0aGlzLmxvdyA+Pj4gMCkgKyAod29yZC5sb3cgPj4+IDApOwogICAgICB2YXIgaGlnaEFkZCA9ICh0aGlzLmhpZ2ggPj4+IDApICsgKHdvcmQuaGlnaCA+Pj4gMCk7CgogICAgICBpZiAobG93QWRkID4gMHhmZmZmZmZmZikgewogICAgICAgIGhpZ2hBZGQgKz0gMTsKICAgICAgfQoKICAgICAgdGhpcy5sb3cgPSBsb3dBZGQgfCAwOwogICAgICB0aGlzLmhpZ2ggPSBoaWdoQWRkIHwgMDsKICAgIH0sCiAgICBjb3B5VG86IGZ1bmN0aW9uIFdvcmQ2NF9jb3B5VG8oYnl0ZXMsIG9mZnNldCkgewogICAgICBieXRlc1tvZmZzZXRdID0gdGhpcy5oaWdoID4+PiAyNCAmIDB4ZmY7CiAgICAgIGJ5dGVzW29mZnNldCArIDFdID0gdGhpcy5oaWdoID4+IDE2ICYgMHhmZjsKICAgICAgYnl0ZXNbb2Zmc2V0ICsgMl0gPSB0aGlzLmhpZ2ggPj4gOCAmIDB4ZmY7CiAgICAgIGJ5dGVzW29mZnNldCArIDNdID0gdGhpcy5oaWdoICYgMHhmZjsKICAgICAgYnl0ZXNbb2Zmc2V0ICsgNF0gPSB0aGlzLmxvdyA+Pj4gMjQgJiAweGZmOwogICAgICBieXRlc1tvZmZzZXQgKyA1XSA9IHRoaXMubG93ID4+IDE2ICYgMHhmZjsKICAgICAgYnl0ZXNbb2Zmc2V0ICsgNl0gPSB0aGlzLmxvdyA+PiA4ICYgMHhmZjsKICAgICAgYnl0ZXNbb2Zmc2V0ICsgN10gPSB0aGlzLmxvdyAmIDB4ZmY7CiAgICB9LAogICAgYXNzaWduOiBmdW5jdGlvbiBXb3JkNjRfYXNzaWduKHdvcmQpIHsKICAgICAgdGhpcy5oaWdoID0gd29yZC5oaWdoOwogICAgICB0aGlzLmxvdyA9IHdvcmQubG93OwogICAgfQogIH07CiAgcmV0dXJuIFdvcmQ2NDsKfSgpOwoKdmFyIGNhbGN1bGF0ZVNIQTI1NiA9IGZ1bmN0aW9uIGNhbGN1bGF0ZVNIQTI1NkNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gcm90cih4LCBuKSB7CiAgICByZXR1cm4geCA+Pj4gbiB8IHggPDwgMzIgLSBuOwogIH0KCiAgZnVuY3Rpb24gY2goeCwgeSwgeikgewogICAgcmV0dXJuIHggJiB5IF4gfnggJiB6OwogIH0KCiAgZnVuY3Rpb24gbWFqKHgsIHksIHopIHsKICAgIHJldHVybiB4ICYgeSBeIHggJiB6IF4geSAmIHo7CiAgfQoKICBmdW5jdGlvbiBzaWdtYSh4KSB7CiAgICByZXR1cm4gcm90cih4LCAyKSBeIHJvdHIoeCwgMTMpIF4gcm90cih4LCAyMik7CiAgfQoKICBmdW5jdGlvbiBzaWdtYVByaW1lKHgpIHsKICAgIHJldHVybiByb3RyKHgsIDYpIF4gcm90cih4LCAxMSkgXiByb3RyKHgsIDI1KTsKICB9CgogIGZ1bmN0aW9uIGxpdHRsZVNpZ21hKHgpIHsKICAgIHJldHVybiByb3RyKHgsIDcpIF4gcm90cih4LCAxOCkgXiB4ID4+PiAzOwogIH0KCiAgZnVuY3Rpb24gbGl0dGxlU2lnbWFQcmltZSh4KSB7CiAgICByZXR1cm4gcm90cih4LCAxNykgXiByb3RyKHgsIDE5KSBeIHggPj4+IDEwOwogIH0KCiAgdmFyIGsgPSBbMHg0MjhhMmY5OCwgMHg3MTM3NDQ5MSwgMHhiNWMwZmJjZiwgMHhlOWI1ZGJhNSwgMHgzOTU2YzI1YiwgMHg1OWYxMTFmMSwgMHg5MjNmODJhNCwgMHhhYjFjNWVkNSwgMHhkODA3YWE5OCwgMHgxMjgzNWIwMSwgMHgyNDMxODViZSwgMHg1NTBjN2RjMywgMHg3MmJlNWQ3NCwgMHg4MGRlYjFmZSwgMHg5YmRjMDZhNywgMHhjMTliZjE3NCwgMHhlNDliNjljMSwgMHhlZmJlNDc4NiwgMHgwZmMxOWRjNiwgMHgyNDBjYTFjYywgMHgyZGU5MmM2ZiwgMHg0YTc0ODRhYSwgMHg1Y2IwYTlkYywgMHg3NmY5ODhkYSwgMHg5ODNlNTE1MiwgMHhhODMxYzY2ZCwgMHhiMDAzMjdjOCwgMHhiZjU5N2ZjNywgMHhjNmUwMGJmMywgMHhkNWE3OTE0NywgMHgwNmNhNjM1MSwgMHgxNDI5Mjk2NywgMHgyN2I3MGE4NSwgMHgyZTFiMjEzOCwgMHg0ZDJjNmRmYywgMHg1MzM4MGQxMywgMHg2NTBhNzM1NCwgMHg3NjZhMGFiYiwgMHg4MWMyYzkyZSwgMHg5MjcyMmM4NSwgMHhhMmJmZThhMSwgMHhhODFhNjY0YiwgMHhjMjRiOGI3MCwgMHhjNzZjNTFhMywgMHhkMTkyZTgxOSwgMHhkNjk5MDYyNCwgMHhmNDBlMzU4NSwgMHgxMDZhYTA3MCwgMHgxOWE0YzExNiwgMHgxZTM3NmMwOCwgMHgyNzQ4Nzc0YywgMHgzNGIwYmNiNSwgMHgzOTFjMGNiMywgMHg0ZWQ4YWE0YSwgMHg1YjljY2E0ZiwgMHg2ODJlNmZmMywgMHg3NDhmODJlZSwgMHg3OGE1NjM2ZiwgMHg4NGM4NzgxNCwgMHg4Y2M3MDIwOCwgMHg5MGJlZmZmYSwgMHhhNDUwNmNlYiwgMHhiZWY5YTNmNywgMHhjNjcxNzhmMl07CgogIGZ1bmN0aW9uIGhhc2goZGF0YSwgb2Zmc2V0LCBsZW5ndGgpIHsKICAgIHZhciBoMCA9IDB4NmEwOWU2NjcsCiAgICAgICAgaDEgPSAweGJiNjdhZTg1LAogICAgICAgIGgyID0gMHgzYzZlZjM3MiwKICAgICAgICBoMyA9IDB4YTU0ZmY1M2EsCiAgICAgICAgaDQgPSAweDUxMGU1MjdmLAogICAgICAgIGg1ID0gMHg5YjA1Njg4YywKICAgICAgICBoNiA9IDB4MWY4M2Q5YWIsCiAgICAgICAgaDcgPSAweDViZTBjZDE5OwogICAgdmFyIHBhZGRlZExlbmd0aCA9IE1hdGguY2VpbCgobGVuZ3RoICsgOSkgLyA2NCkgKiA2NDsKICAgIHZhciBwYWRkZWQgPSBuZXcgVWludDhBcnJheShwYWRkZWRMZW5ndGgpOwogICAgdmFyIGksIGosIG47CgogICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgIHBhZGRlZFtpXSA9IGRhdGFbb2Zmc2V0KytdOwogICAgfQoKICAgIHBhZGRlZFtpKytdID0gMHg4MDsKICAgIG4gPSBwYWRkZWRMZW5ndGggLSA4OwoKICAgIHdoaWxlIChpIDwgbikgewogICAgICBwYWRkZWRbaSsrXSA9IDA7CiAgICB9CgogICAgcGFkZGVkW2krK10gPSAwOwogICAgcGFkZGVkW2krK10gPSAwOwogICAgcGFkZGVkW2krK10gPSAwOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPj4+IDI5ICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+IDIxICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+IDEzICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+IDUgJiAweGZmOwogICAgcGFkZGVkW2krK10gPSBsZW5ndGggPDwgMyAmIDB4ZmY7CiAgICB2YXIgdyA9IG5ldyBVaW50MzJBcnJheSg2NCk7CgogICAgZm9yIChpID0gMDsgaSA8IHBhZGRlZExlbmd0aDspIHsKICAgICAgZm9yIChqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgICB3W2pdID0gcGFkZGVkW2ldIDw8IDI0IHwgcGFkZGVkW2kgKyAxXSA8PCAxNiB8IHBhZGRlZFtpICsgMl0gPDwgOCB8IHBhZGRlZFtpICsgM107CiAgICAgICAgaSArPSA0OwogICAgICB9CgogICAgICBmb3IgKGogPSAxNjsgaiA8IDY0OyArK2opIHsKICAgICAgICB3W2pdID0gbGl0dGxlU2lnbWFQcmltZSh3W2ogLSAyXSkgKyB3W2ogLSA3XSArIGxpdHRsZVNpZ21hKHdbaiAtIDE1XSkgKyB3W2ogLSAxNl0gfCAwOwogICAgICB9CgogICAgICB2YXIgYSA9IGgwLAogICAgICAgICAgYiA9IGgxLAogICAgICAgICAgYyA9IGgyLAogICAgICAgICAgZCA9IGgzLAogICAgICAgICAgZSA9IGg0LAogICAgICAgICAgZiA9IGg1LAogICAgICAgICAgZyA9IGg2LAogICAgICAgICAgaCA9IGg3LAogICAgICAgICAgdDEsCiAgICAgICAgICB0MjsKCiAgICAgIGZvciAoaiA9IDA7IGogPCA2NDsgKytqKSB7CiAgICAgICAgdDEgPSBoICsgc2lnbWFQcmltZShlKSArIGNoKGUsIGYsIGcpICsga1tqXSArIHdbal07CiAgICAgICAgdDIgPSBzaWdtYShhKSArIG1haihhLCBiLCBjKTsKICAgICAgICBoID0gZzsKICAgICAgICBnID0gZjsKICAgICAgICBmID0gZTsKICAgICAgICBlID0gZCArIHQxIHwgMDsKICAgICAgICBkID0gYzsKICAgICAgICBjID0gYjsKICAgICAgICBiID0gYTsKICAgICAgICBhID0gdDEgKyB0MiB8IDA7CiAgICAgIH0KCiAgICAgIGgwID0gaDAgKyBhIHwgMDsKICAgICAgaDEgPSBoMSArIGIgfCAwOwogICAgICBoMiA9IGgyICsgYyB8IDA7CiAgICAgIGgzID0gaDMgKyBkIHwgMDsKICAgICAgaDQgPSBoNCArIGUgfCAwOwogICAgICBoNSA9IGg1ICsgZiB8IDA7CiAgICAgIGg2ID0gaDYgKyBnIHwgMDsKICAgICAgaDcgPSBoNyArIGggfCAwOwogICAgfQoKICAgIHJldHVybiBuZXcgVWludDhBcnJheShbaDAgPj4gMjQgJiAweEZGLCBoMCA+PiAxNiAmIDB4RkYsIGgwID4+IDggJiAweEZGLCBoMCAmIDB4RkYsIGgxID4+IDI0ICYgMHhGRiwgaDEgPj4gMTYgJiAweEZGLCBoMSA+PiA4ICYgMHhGRiwgaDEgJiAweEZGLCBoMiA+PiAyNCAmIDB4RkYsIGgyID4+IDE2ICYgMHhGRiwgaDIgPj4gOCAmIDB4RkYsIGgyICYgMHhGRiwgaDMgPj4gMjQgJiAweEZGLCBoMyA+PiAxNiAmIDB4RkYsIGgzID4+IDggJiAweEZGLCBoMyAmIDB4RkYsIGg0ID4+IDI0ICYgMHhGRiwgaDQgPj4gMTYgJiAweEZGLCBoNCA+PiA4ICYgMHhGRiwgaDQgJiAweEZGLCBoNSA+PiAyNCAmIDB4RkYsIGg1ID4+IDE2ICYgMHhGRiwgaDUgPj4gOCAmIDB4RkYsIGg1ICYgMHhGRiwgaDYgPj4gMjQgJiAweEZGLCBoNiA+PiAxNiAmIDB4RkYsIGg2ID4+IDggJiAweEZGLCBoNiAmIDB4RkYsIGg3ID4+IDI0ICYgMHhGRiwgaDcgPj4gMTYgJiAweEZGLCBoNyA+PiA4ICYgMHhGRiwgaDcgJiAweEZGXSk7CiAgfQoKICByZXR1cm4gaGFzaDsKfSgpOwoKZXhwb3J0cy5jYWxjdWxhdGVTSEEyNTYgPSBjYWxjdWxhdGVTSEEyNTY7Cgp2YXIgY2FsY3VsYXRlU0hBNTEyID0gZnVuY3Rpb24gY2FsY3VsYXRlU0hBNTEyQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBjaChyZXN1bHQsIHgsIHksIHosIHRtcCkgewogICAgcmVzdWx0LmFzc2lnbih4KTsKICAgIHJlc3VsdC5hbmQoeSk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLm5vdCgpOwogICAgdG1wLmFuZCh6KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGZ1bmN0aW9uIG1haihyZXN1bHQsIHgsIHksIHosIHRtcCkgewogICAgcmVzdWx0LmFzc2lnbih4KTsKICAgIHJlc3VsdC5hbmQoeSk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLmFuZCh6KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICAgIHRtcC5hc3NpZ24oeSk7CiAgICB0bXAuYW5kKHopOwogICAgcmVzdWx0Lnhvcih0bXApOwogIH0KCiAgZnVuY3Rpb24gc2lnbWEocmVzdWx0LCB4LCB0bXApIHsKICAgIHJlc3VsdC5hc3NpZ24oeCk7CiAgICByZXN1bHQucm90YXRlUmlnaHQoMjgpOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5yb3RhdGVSaWdodCgzNCk7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnJvdGF0ZVJpZ2h0KDM5KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGZ1bmN0aW9uIHNpZ21hUHJpbWUocmVzdWx0LCB4LCB0bXApIHsKICAgIHJlc3VsdC5hc3NpZ24oeCk7CiAgICByZXN1bHQucm90YXRlUmlnaHQoMTQpOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5yb3RhdGVSaWdodCgxOCk7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnJvdGF0ZVJpZ2h0KDQxKTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGZ1bmN0aW9uIGxpdHRsZVNpZ21hKHJlc3VsdCwgeCwgdG1wKSB7CiAgICByZXN1bHQuYXNzaWduKHgpOwogICAgcmVzdWx0LnJvdGF0ZVJpZ2h0KDEpOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5yb3RhdGVSaWdodCg4KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICAgIHRtcC5hc3NpZ24oeCk7CiAgICB0bXAuc2hpZnRSaWdodCg3KTsKICAgIHJlc3VsdC54b3IodG1wKTsKICB9CgogIGZ1bmN0aW9uIGxpdHRsZVNpZ21hUHJpbWUocmVzdWx0LCB4LCB0bXApIHsKICAgIHJlc3VsdC5hc3NpZ24oeCk7CiAgICByZXN1bHQucm90YXRlUmlnaHQoMTkpOwogICAgdG1wLmFzc2lnbih4KTsKICAgIHRtcC5yb3RhdGVSaWdodCg2MSk7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgICB0bXAuYXNzaWduKHgpOwogICAgdG1wLnNoaWZ0UmlnaHQoNik7CiAgICByZXN1bHQueG9yKHRtcCk7CiAgfQoKICB2YXIgayA9IFtuZXcgV29yZDY0KDB4NDI4YTJmOTgsIDB4ZDcyOGFlMjIpLCBuZXcgV29yZDY0KDB4NzEzNzQ0OTEsIDB4MjNlZjY1Y2QpLCBuZXcgV29yZDY0KDB4YjVjMGZiY2YsIDB4ZWM0ZDNiMmYpLCBuZXcgV29yZDY0KDB4ZTliNWRiYTUsIDB4ODE4OWRiYmMpLCBuZXcgV29yZDY0KDB4Mzk1NmMyNWIsIDB4ZjM0OGI1MzgpLCBuZXcgV29yZDY0KDB4NTlmMTExZjEsIDB4YjYwNWQwMTkpLCBuZXcgV29yZDY0KDB4OTIzZjgyYTQsIDB4YWYxOTRmOWIpLCBuZXcgV29yZDY0KDB4YWIxYzVlZDUsIDB4ZGE2ZDgxMTgpLCBuZXcgV29yZDY0KDB4ZDgwN2FhOTgsIDB4YTMwMzAyNDIpLCBuZXcgV29yZDY0KDB4MTI4MzViMDEsIDB4NDU3MDZmYmUpLCBuZXcgV29yZDY0KDB4MjQzMTg1YmUsIDB4NGVlNGIyOGMpLCBuZXcgV29yZDY0KDB4NTUwYzdkYzMsIDB4ZDVmZmI0ZTIpLCBuZXcgV29yZDY0KDB4NzJiZTVkNzQsIDB4ZjI3Yjg5NmYpLCBuZXcgV29yZDY0KDB4ODBkZWIxZmUsIDB4M2IxNjk2YjEpLCBuZXcgV29yZDY0KDB4OWJkYzA2YTcsIDB4MjVjNzEyMzUpLCBuZXcgV29yZDY0KDB4YzE5YmYxNzQsIDB4Y2Y2OTI2OTQpLCBuZXcgV29yZDY0KDB4ZTQ5YjY5YzEsIDB4OWVmMTRhZDIpLCBuZXcgV29yZDY0KDB4ZWZiZTQ3ODYsIDB4Mzg0ZjI1ZTMpLCBuZXcgV29yZDY0KDB4MGZjMTlkYzYsIDB4OGI4Y2Q1YjUpLCBuZXcgV29yZDY0KDB4MjQwY2ExY2MsIDB4NzdhYzljNjUpLCBuZXcgV29yZDY0KDB4MmRlOTJjNmYsIDB4NTkyYjAyNzUpLCBuZXcgV29yZDY0KDB4NGE3NDg0YWEsIDB4NmVhNmU0ODMpLCBuZXcgV29yZDY0KDB4NWNiMGE5ZGMsIDB4YmQ0MWZiZDQpLCBuZXcgV29yZDY0KDB4NzZmOTg4ZGEsIDB4ODMxMTUzYjUpLCBuZXcgV29yZDY0KDB4OTgzZTUxNTIsIDB4ZWU2NmRmYWIpLCBuZXcgV29yZDY0KDB4YTgzMWM2NmQsIDB4MmRiNDMyMTApLCBuZXcgV29yZDY0KDB4YjAwMzI3YzgsIDB4OThmYjIxM2YpLCBuZXcgV29yZDY0KDB4YmY1OTdmYzcsIDB4YmVlZjBlZTQpLCBuZXcgV29yZDY0KDB4YzZlMDBiZjMsIDB4M2RhODhmYzIpLCBuZXcgV29yZDY0KDB4ZDVhNzkxNDcsIDB4OTMwYWE3MjUpLCBuZXcgV29yZDY0KDB4MDZjYTYzNTEsIDB4ZTAwMzgyNmYpLCBuZXcgV29yZDY0KDB4MTQyOTI5NjcsIDB4MGEwZTZlNzApLCBuZXcgV29yZDY0KDB4MjdiNzBhODUsIDB4NDZkMjJmZmMpLCBuZXcgV29yZDY0KDB4MmUxYjIxMzgsIDB4NWMyNmM5MjYpLCBuZXcgV29yZDY0KDB4NGQyYzZkZmMsIDB4NWFjNDJhZWQpLCBuZXcgV29yZDY0KDB4NTMzODBkMTMsIDB4OWQ5NWIzZGYpLCBuZXcgV29yZDY0KDB4NjUwYTczNTQsIDB4OGJhZjYzZGUpLCBuZXcgV29yZDY0KDB4NzY2YTBhYmIsIDB4M2M3N2IyYTgpLCBuZXcgV29yZDY0KDB4ODFjMmM5MmUsIDB4NDdlZGFlZTYpLCBuZXcgV29yZDY0KDB4OTI3MjJjODUsIDB4MTQ4MjM1M2IpLCBuZXcgV29yZDY0KDB4YTJiZmU4YTEsIDB4NGNmMTAzNjQpLCBuZXcgV29yZDY0KDB4YTgxYTY2NGIsIDB4YmM0MjMwMDEpLCBuZXcgV29yZDY0KDB4YzI0YjhiNzAsIDB4ZDBmODk3OTEpLCBuZXcgV29yZDY0KDB4Yzc2YzUxYTMsIDB4MDY1NGJlMzApLCBuZXcgV29yZDY0KDB4ZDE5MmU4MTksIDB4ZDZlZjUyMTgpLCBuZXcgV29yZDY0KDB4ZDY5OTA2MjQsIDB4NTU2NWE5MTApLCBuZXcgV29yZDY0KDB4ZjQwZTM1ODUsIDB4NTc3MTIwMmEpLCBuZXcgV29yZDY0KDB4MTA2YWEwNzAsIDB4MzJiYmQxYjgpLCBuZXcgV29yZDY0KDB4MTlhNGMxMTYsIDB4YjhkMmQwYzgpLCBuZXcgV29yZDY0KDB4MWUzNzZjMDgsIDB4NTE0MWFiNTMpLCBuZXcgV29yZDY0KDB4Mjc0ODc3NGMsIDB4ZGY4ZWViOTkpLCBuZXcgV29yZDY0KDB4MzRiMGJjYjUsIDB4ZTE5YjQ4YTgpLCBuZXcgV29yZDY0KDB4MzkxYzBjYjMsIDB4YzVjOTVhNjMpLCBuZXcgV29yZDY0KDB4NGVkOGFhNGEsIDB4ZTM0MThhY2IpLCBuZXcgV29yZDY0KDB4NWI5Y2NhNGYsIDB4Nzc2M2UzNzMpLCBuZXcgV29yZDY0KDB4NjgyZTZmZjMsIDB4ZDZiMmI4YTMpLCBuZXcgV29yZDY0KDB4NzQ4ZjgyZWUsIDB4NWRlZmIyZmMpLCBuZXcgV29yZDY0KDB4NzhhNTYzNmYsIDB4NDMxNzJmNjApLCBuZXcgV29yZDY0KDB4ODRjODc4MTQsIDB4YTFmMGFiNzIpLCBuZXcgV29yZDY0KDB4OGNjNzAyMDgsIDB4MWE2NDM5ZWMpLCBuZXcgV29yZDY0KDB4OTBiZWZmZmEsIDB4MjM2MzFlMjgpLCBuZXcgV29yZDY0KDB4YTQ1MDZjZWIsIDB4ZGU4MmJkZTkpLCBuZXcgV29yZDY0KDB4YmVmOWEzZjcsIDB4YjJjNjc5MTUpLCBuZXcgV29yZDY0KDB4YzY3MTc4ZjIsIDB4ZTM3MjUzMmIpLCBuZXcgV29yZDY0KDB4Y2EyNzNlY2UsIDB4ZWEyNjYxOWMpLCBuZXcgV29yZDY0KDB4ZDE4NmI4YzcsIDB4MjFjMGMyMDcpLCBuZXcgV29yZDY0KDB4ZWFkYTdkZDYsIDB4Y2RlMGViMWUpLCBuZXcgV29yZDY0KDB4ZjU3ZDRmN2YsIDB4ZWU2ZWQxNzgpLCBuZXcgV29yZDY0KDB4MDZmMDY3YWEsIDB4NzIxNzZmYmEpLCBuZXcgV29yZDY0KDB4MGE2MzdkYzUsIDB4YTJjODk4YTYpLCBuZXcgV29yZDY0KDB4MTEzZjk4MDQsIDB4YmVmOTBkYWUpLCBuZXcgV29yZDY0KDB4MWI3MTBiMzUsIDB4MTMxYzQ3MWIpLCBuZXcgV29yZDY0KDB4MjhkYjc3ZjUsIDB4MjMwNDdkODQpLCBuZXcgV29yZDY0KDB4MzJjYWFiN2IsIDB4NDBjNzI0OTMpLCBuZXcgV29yZDY0KDB4M2M5ZWJlMGEsIDB4MTVjOWJlYmMpLCBuZXcgV29yZDY0KDB4NDMxZDY3YzQsIDB4OWMxMDBkNGMpLCBuZXcgV29yZDY0KDB4NGNjNWQ0YmUsIDB4Y2IzZTQyYjYpLCBuZXcgV29yZDY0KDB4NTk3ZjI5OWMsIDB4ZmM2NTdlMmEpLCBuZXcgV29yZDY0KDB4NWZjYjZmYWIsIDB4M2FkNmZhZWMpLCBuZXcgV29yZDY0KDB4NmM0NDE5OGMsIDB4NGE0NzU4MTcpXTsKCiAgZnVuY3Rpb24gaGFzaChkYXRhLCBvZmZzZXQsIGxlbmd0aCwgbW9kZTM4NCkgewogICAgbW9kZTM4NCA9ICEhbW9kZTM4NDsKICAgIHZhciBoMCwgaDEsIGgyLCBoMywgaDQsIGg1LCBoNiwgaDc7CgogICAgaWYgKCFtb2RlMzg0KSB7CiAgICAgIGgwID0gbmV3IFdvcmQ2NCgweDZhMDllNjY3LCAweGYzYmNjOTA4KTsKICAgICAgaDEgPSBuZXcgV29yZDY0KDB4YmI2N2FlODUsIDB4ODRjYWE3M2IpOwogICAgICBoMiA9IG5ldyBXb3JkNjQoMHgzYzZlZjM3MiwgMHhmZTk0ZjgyYik7CiAgICAgIGgzID0gbmV3IFdvcmQ2NCgweGE1NGZmNTNhLCAweDVmMWQzNmYxKTsKICAgICAgaDQgPSBuZXcgV29yZDY0KDB4NTEwZTUyN2YsIDB4YWRlNjgyZDEpOwogICAgICBoNSA9IG5ldyBXb3JkNjQoMHg5YjA1Njg4YywgMHgyYjNlNmMxZik7CiAgICAgIGg2ID0gbmV3IFdvcmQ2NCgweDFmODNkOWFiLCAweGZiNDFiZDZiKTsKICAgICAgaDcgPSBuZXcgV29yZDY0KDB4NWJlMGNkMTksIDB4MTM3ZTIxNzkpOwogICAgfSBlbHNlIHsKICAgICAgaDAgPSBuZXcgV29yZDY0KDB4Y2JiYjlkNWQsIDB4YzEwNTllZDgpOwogICAgICBoMSA9IG5ldyBXb3JkNjQoMHg2MjlhMjkyYSwgMHgzNjdjZDUwNyk7CiAgICAgIGgyID0gbmV3IFdvcmQ2NCgweDkxNTkwMTVhLCAweDMwNzBkZDE3KTsKICAgICAgaDMgPSBuZXcgV29yZDY0KDB4MTUyZmVjZDgsIDB4ZjcwZTU5MzkpOwogICAgICBoNCA9IG5ldyBXb3JkNjQoMHg2NzMzMjY2NywgMHhmZmMwMGIzMSk7CiAgICAgIGg1ID0gbmV3IFdvcmQ2NCgweDhlYjQ0YTg3LCAweDY4NTgxNTExKTsKICAgICAgaDYgPSBuZXcgV29yZDY0KDB4ZGIwYzJlMGQsIDB4NjRmOThmYTcpOwogICAgICBoNyA9IG5ldyBXb3JkNjQoMHg0N2I1NDgxZCwgMHhiZWZhNGZhNCk7CiAgICB9CgogICAgdmFyIHBhZGRlZExlbmd0aCA9IE1hdGguY2VpbCgobGVuZ3RoICsgMTcpIC8gMTI4KSAqIDEyODsKICAgIHZhciBwYWRkZWQgPSBuZXcgVWludDhBcnJheShwYWRkZWRMZW5ndGgpOwogICAgdmFyIGksIGosIG47CgogICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgIHBhZGRlZFtpXSA9IGRhdGFbb2Zmc2V0KytdOwogICAgfQoKICAgIHBhZGRlZFtpKytdID0gMHg4MDsKICAgIG4gPSBwYWRkZWRMZW5ndGggLSAxNjsKCiAgICB3aGlsZSAoaSA8IG4pIHsKICAgICAgcGFkZGVkW2krK10gPSAwOwogICAgfQoKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gMDsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoID4+PiAyOSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiAyMSAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiAxMyAmIDB4ZmY7CiAgICBwYWRkZWRbaSsrXSA9IGxlbmd0aCA+PiA1ICYgMHhmZjsKICAgIHBhZGRlZFtpKytdID0gbGVuZ3RoIDw8IDMgJiAweGZmOwogICAgdmFyIHcgPSBuZXcgQXJyYXkoODApOwoKICAgIGZvciAoaSA9IDA7IGkgPCA4MDsgaSsrKSB7CiAgICAgIHdbaV0gPSBuZXcgV29yZDY0KDAsIDApOwogICAgfQoKICAgIHZhciBhID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBiID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBjID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIHZhciBkID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBlID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBmID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIHZhciBnID0gbmV3IFdvcmQ2NCgwLCAwKSwKICAgICAgICBoID0gbmV3IFdvcmQ2NCgwLCAwKTsKICAgIHZhciB0MSA9IG5ldyBXb3JkNjQoMCwgMCksCiAgICAgICAgdDIgPSBuZXcgV29yZDY0KDAsIDApOwogICAgdmFyIHRtcDEgPSBuZXcgV29yZDY0KDAsIDApLAogICAgICAgIHRtcDIgPSBuZXcgV29yZDY0KDAsIDApLAogICAgICAgIHRtcDM7CgogICAgZm9yIChpID0gMDsgaSA8IHBhZGRlZExlbmd0aDspIHsKICAgICAgZm9yIChqID0gMDsgaiA8IDE2OyArK2opIHsKICAgICAgICB3W2pdLmhpZ2ggPSBwYWRkZWRbaV0gPDwgMjQgfCBwYWRkZWRbaSArIDFdIDw8IDE2IHwgcGFkZGVkW2kgKyAyXSA8PCA4IHwgcGFkZGVkW2kgKyAzXTsKICAgICAgICB3W2pdLmxvdyA9IHBhZGRlZFtpICsgNF0gPDwgMjQgfCBwYWRkZWRbaSArIDVdIDw8IDE2IHwgcGFkZGVkW2kgKyA2XSA8PCA4IHwgcGFkZGVkW2kgKyA3XTsKICAgICAgICBpICs9IDg7CiAgICAgIH0KCiAgICAgIGZvciAoaiA9IDE2OyBqIDwgODA7ICsraikgewogICAgICAgIHRtcDMgPSB3W2pdOwogICAgICAgIGxpdHRsZVNpZ21hUHJpbWUodG1wMywgd1tqIC0gMl0sIHRtcDIpOwogICAgICAgIHRtcDMuYWRkKHdbaiAtIDddKTsKICAgICAgICBsaXR0bGVTaWdtYSh0bXAxLCB3W2ogLSAxNV0sIHRtcDIpOwogICAgICAgIHRtcDMuYWRkKHRtcDEpOwogICAgICAgIHRtcDMuYWRkKHdbaiAtIDE2XSk7CiAgICAgIH0KCiAgICAgIGEuYXNzaWduKGgwKTsKICAgICAgYi5hc3NpZ24oaDEpOwogICAgICBjLmFzc2lnbihoMik7CiAgICAgIGQuYXNzaWduKGgzKTsKICAgICAgZS5hc3NpZ24oaDQpOwogICAgICBmLmFzc2lnbihoNSk7CiAgICAgIGcuYXNzaWduKGg2KTsKICAgICAgaC5hc3NpZ24oaDcpOwoKICAgICAgZm9yIChqID0gMDsgaiA8IDgwOyArK2opIHsKICAgICAgICB0MS5hc3NpZ24oaCk7CiAgICAgICAgc2lnbWFQcmltZSh0bXAxLCBlLCB0bXAyKTsKICAgICAgICB0MS5hZGQodG1wMSk7CiAgICAgICAgY2godG1wMSwgZSwgZiwgZywgdG1wMik7CiAgICAgICAgdDEuYWRkKHRtcDEpOwogICAgICAgIHQxLmFkZChrW2pdKTsKICAgICAgICB0MS5hZGQod1tqXSk7CiAgICAgICAgc2lnbWEodDIsIGEsIHRtcDIpOwogICAgICAgIG1haih0bXAxLCBhLCBiLCBjLCB0bXAyKTsKICAgICAgICB0Mi5hZGQodG1wMSk7CiAgICAgICAgdG1wMyA9IGg7CiAgICAgICAgaCA9IGc7CiAgICAgICAgZyA9IGY7CiAgICAgICAgZiA9IGU7CiAgICAgICAgZC5hZGQodDEpOwogICAgICAgIGUgPSBkOwogICAgICAgIGQgPSBjOwogICAgICAgIGMgPSBiOwogICAgICAgIGIgPSBhOwogICAgICAgIHRtcDMuYXNzaWduKHQxKTsKICAgICAgICB0bXAzLmFkZCh0Mik7CiAgICAgICAgYSA9IHRtcDM7CiAgICAgIH0KCiAgICAgIGgwLmFkZChhKTsKICAgICAgaDEuYWRkKGIpOwogICAgICBoMi5hZGQoYyk7CiAgICAgIGgzLmFkZChkKTsKICAgICAgaDQuYWRkKGUpOwogICAgICBoNS5hZGQoZik7CiAgICAgIGg2LmFkZChnKTsKICAgICAgaDcuYWRkKGgpOwogICAgfQoKICAgIHZhciByZXN1bHQ7CgogICAgaWYgKCFtb2RlMzg0KSB7CiAgICAgIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KDY0KTsKICAgICAgaDAuY29weVRvKHJlc3VsdCwgMCk7CiAgICAgIGgxLmNvcHlUbyhyZXN1bHQsIDgpOwogICAgICBoMi5jb3B5VG8ocmVzdWx0LCAxNik7CiAgICAgIGgzLmNvcHlUbyhyZXN1bHQsIDI0KTsKICAgICAgaDQuY29weVRvKHJlc3VsdCwgMzIpOwogICAgICBoNS5jb3B5VG8ocmVzdWx0LCA0MCk7CiAgICAgIGg2LmNvcHlUbyhyZXN1bHQsIDQ4KTsKICAgICAgaDcuY29weVRvKHJlc3VsdCwgNTYpOwogICAgfSBlbHNlIHsKICAgICAgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoNDgpOwogICAgICBoMC5jb3B5VG8ocmVzdWx0LCAwKTsKICAgICAgaDEuY29weVRvKHJlc3VsdCwgOCk7CiAgICAgIGgyLmNvcHlUbyhyZXN1bHQsIDE2KTsKICAgICAgaDMuY29weVRvKHJlc3VsdCwgMjQpOwogICAgICBoNC5jb3B5VG8ocmVzdWx0LCAzMik7CiAgICAgIGg1LmNvcHlUbyhyZXN1bHQsIDQwKTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgcmV0dXJuIGhhc2g7Cn0oKTsKCmV4cG9ydHMuY2FsY3VsYXRlU0hBNTEyID0gY2FsY3VsYXRlU0hBNTEyOwoKdmFyIGNhbGN1bGF0ZVNIQTM4NCA9IGZ1bmN0aW9uIGNhbGN1bGF0ZVNIQTM4NENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gaGFzaChkYXRhLCBvZmZzZXQsIGxlbmd0aCkgewogICAgcmV0dXJuIGNhbGN1bGF0ZVNIQTUxMihkYXRhLCBvZmZzZXQsIGxlbmd0aCwgdHJ1ZSk7CiAgfQoKICByZXR1cm4gaGFzaDsKfSgpOwoKZXhwb3J0cy5jYWxjdWxhdGVTSEEzODQgPSBjYWxjdWxhdGVTSEEzODQ7Cgp2YXIgTnVsbENpcGhlciA9IGZ1bmN0aW9uIE51bGxDaXBoZXJDbG9zdXJlKCkgewogIGZ1bmN0aW9uIE51bGxDaXBoZXIoKSB7fQoKICBOdWxsQ2lwaGVyLnByb3RvdHlwZSA9IHsKICAgIGRlY3J5cHRCbG9jazogZnVuY3Rpb24gTnVsbENpcGhlcl9kZWNyeXB0QmxvY2soZGF0YSkgewogICAgICByZXR1cm4gZGF0YTsKICAgIH0KICB9OwogIHJldHVybiBOdWxsQ2lwaGVyOwp9KCk7Cgp2YXIgQUVTQmFzZUNpcGhlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQUVTQmFzZUNpcGhlcigpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBRVNCYXNlQ2lwaGVyKTsKCiAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gQUVTQmFzZUNpcGhlcikgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBBRVNCYXNlQ2lwaGVyLiIpOwogICAgfQoKICAgIHRoaXMuX3MgPSBuZXcgVWludDhBcnJheShbMHg2MywgMHg3YywgMHg3NywgMHg3YiwgMHhmMiwgMHg2YiwgMHg2ZiwgMHhjNSwgMHgzMCwgMHgwMSwgMHg2NywgMHgyYiwgMHhmZSwgMHhkNywgMHhhYiwgMHg3NiwgMHhjYSwgMHg4MiwgMHhjOSwgMHg3ZCwgMHhmYSwgMHg1OSwgMHg0NywgMHhmMCwgMHhhZCwgMHhkNCwgMHhhMiwgMHhhZiwgMHg5YywgMHhhNCwgMHg3MiwgMHhjMCwgMHhiNywgMHhmZCwgMHg5MywgMHgyNiwgMHgzNiwgMHgzZiwgMHhmNywgMHhjYywgMHgzNCwgMHhhNSwgMHhlNSwgMHhmMSwgMHg3MSwgMHhkOCwgMHgzMSwgMHgxNSwgMHgwNCwgMHhjNywgMHgyMywgMHhjMywgMHgxOCwgMHg5NiwgMHgwNSwgMHg5YSwgMHgwNywgMHgxMiwgMHg4MCwgMHhlMiwgMHhlYiwgMHgyNywgMHhiMiwgMHg3NSwgMHgwOSwgMHg4MywgMHgyYywgMHgxYSwgMHgxYiwgMHg2ZSwgMHg1YSwgMHhhMCwgMHg1MiwgMHgzYiwgMHhkNiwgMHhiMywgMHgyOSwgMHhlMywgMHgyZiwgMHg4NCwgMHg1MywgMHhkMSwgMHgwMCwgMHhlZCwgMHgyMCwgMHhmYywgMHhiMSwgMHg1YiwgMHg2YSwgMHhjYiwgMHhiZSwgMHgzOSwgMHg0YSwgMHg0YywgMHg1OCwgMHhjZiwgMHhkMCwgMHhlZiwgMHhhYSwgMHhmYiwgMHg0MywgMHg0ZCwgMHgzMywgMHg4NSwgMHg0NSwgMHhmOSwgMHgwMiwgMHg3ZiwgMHg1MCwgMHgzYywgMHg5ZiwgMHhhOCwgMHg1MSwgMHhhMywgMHg0MCwgMHg4ZiwgMHg5MiwgMHg5ZCwgMHgzOCwgMHhmNSwgMHhiYywgMHhiNiwgMHhkYSwgMHgyMSwgMHgxMCwgMHhmZiwgMHhmMywgMHhkMiwgMHhjZCwgMHgwYywgMHgxMywgMHhlYywgMHg1ZiwgMHg5NywgMHg0NCwgMHgxNywgMHhjNCwgMHhhNywgMHg3ZSwgMHgzZCwgMHg2NCwgMHg1ZCwgMHgxOSwgMHg3MywgMHg2MCwgMHg4MSwgMHg0ZiwgMHhkYywgMHgyMiwgMHgyYSwgMHg5MCwgMHg4OCwgMHg0NiwgMHhlZSwgMHhiOCwgMHgxNCwgMHhkZSwgMHg1ZSwgMHgwYiwgMHhkYiwgMHhlMCwgMHgzMiwgMHgzYSwgMHgwYSwgMHg0OSwgMHgwNiwgMHgyNCwgMHg1YywgMHhjMiwgMHhkMywgMHhhYywgMHg2MiwgMHg5MSwgMHg5NSwgMHhlNCwgMHg3OSwgMHhlNywgMHhjOCwgMHgzNywgMHg2ZCwgMHg4ZCwgMHhkNSwgMHg0ZSwgMHhhOSwgMHg2YywgMHg1NiwgMHhmNCwgMHhlYSwgMHg2NSwgMHg3YSwgMHhhZSwgMHgwOCwgMHhiYSwgMHg3OCwgMHgyNSwgMHgyZSwgMHgxYywgMHhhNiwgMHhiNCwgMHhjNiwgMHhlOCwgMHhkZCwgMHg3NCwgMHgxZiwgMHg0YiwgMHhiZCwgMHg4YiwgMHg4YSwgMHg3MCwgMHgzZSwgMHhiNSwgMHg2NiwgMHg0OCwgMHgwMywgMHhmNiwgMHgwZSwgMHg2MSwgMHgzNSwgMHg1NywgMHhiOSwgMHg4NiwgMHhjMSwgMHgxZCwgMHg5ZSwgMHhlMSwgMHhmOCwgMHg5OCwgMHgxMSwgMHg2OSwgMHhkOSwgMHg4ZSwgMHg5NCwgMHg5YiwgMHgxZSwgMHg4NywgMHhlOSwgMHhjZSwgMHg1NSwgMHgyOCwgMHhkZiwgMHg4YywgMHhhMSwgMHg4OSwgMHgwZCwgMHhiZiwgMHhlNiwgMHg0MiwgMHg2OCwgMHg0MSwgMHg5OSwgMHgyZCwgMHgwZiwgMHhiMCwgMHg1NCwgMHhiYiwgMHgxNl0pOwogICAgdGhpcy5faW52X3MgPSBuZXcgVWludDhBcnJheShbMHg1MiwgMHgwOSwgMHg2YSwgMHhkNSwgMHgzMCwgMHgzNiwgMHhhNSwgMHgzOCwgMHhiZiwgMHg0MCwgMHhhMywgMHg5ZSwgMHg4MSwgMHhmMywgMHhkNywgMHhmYiwgMHg3YywgMHhlMywgMHgzOSwgMHg4MiwgMHg5YiwgMHgyZiwgMHhmZiwgMHg4NywgMHgzNCwgMHg4ZSwgMHg0MywgMHg0NCwgMHhjNCwgMHhkZSwgMHhlOSwgMHhjYiwgMHg1NCwgMHg3YiwgMHg5NCwgMHgzMiwgMHhhNiwgMHhjMiwgMHgyMywgMHgzZCwgMHhlZSwgMHg0YywgMHg5NSwgMHgwYiwgMHg0MiwgMHhmYSwgMHhjMywgMHg0ZSwgMHgwOCwgMHgyZSwgMHhhMSwgMHg2NiwgMHgyOCwgMHhkOSwgMHgyNCwgMHhiMiwgMHg3NiwgMHg1YiwgMHhhMiwgMHg0OSwgMHg2ZCwgMHg4YiwgMHhkMSwgMHgyNSwgMHg3MiwgMHhmOCwgMHhmNiwgMHg2NCwgMHg4NiwgMHg2OCwgMHg5OCwgMHgxNiwgMHhkNCwgMHhhNCwgMHg1YywgMHhjYywgMHg1ZCwgMHg2NSwgMHhiNiwgMHg5MiwgMHg2YywgMHg3MCwgMHg0OCwgMHg1MCwgMHhmZCwgMHhlZCwgMHhiOSwgMHhkYSwgMHg1ZSwgMHgxNSwgMHg0NiwgMHg1NywgMHhhNywgMHg4ZCwgMHg5ZCwgMHg4NCwgMHg5MCwgMHhkOCwgMHhhYiwgMHgwMCwgMHg4YywgMHhiYywgMHhkMywgMHgwYSwgMHhmNywgMHhlNCwgMHg1OCwgMHgwNSwgMHhiOCwgMHhiMywgMHg0NSwgMHgwNiwgMHhkMCwgMHgyYywgMHgxZSwgMHg4ZiwgMHhjYSwgMHgzZiwgMHgwZiwgMHgwMiwgMHhjMSwgMHhhZiwgMHhiZCwgMHgwMywgMHgwMSwgMHgxMywgMHg4YSwgMHg2YiwgMHgzYSwgMHg5MSwgMHgxMSwgMHg0MSwgMHg0ZiwgMHg2NywgMHhkYywgMHhlYSwgMHg5NywgMHhmMiwgMHhjZiwgMHhjZSwgMHhmMCwgMHhiNCwgMHhlNiwgMHg3MywgMHg5NiwgMHhhYywgMHg3NCwgMHgyMiwgMHhlNywgMHhhZCwgMHgzNSwgMHg4NSwgMHhlMiwgMHhmOSwgMHgzNywgMHhlOCwgMHgxYywgMHg3NSwgMHhkZiwgMHg2ZSwgMHg0NywgMHhmMSwgMHgxYSwgMHg3MSwgMHgxZCwgMHgyOSwgMHhjNSwgMHg4OSwgMHg2ZiwgMHhiNywgMHg2MiwgMHgwZSwgMHhhYSwgMHgxOCwgMHhiZSwgMHgxYiwgMHhmYywgMHg1NiwgMHgzZSwgMHg0YiwgMHhjNiwgMHhkMiwgMHg3OSwgMHgyMCwgMHg5YSwgMHhkYiwgMHhjMCwgMHhmZSwgMHg3OCwgMHhjZCwgMHg1YSwgMHhmNCwgMHgxZiwgMHhkZCwgMHhhOCwgMHgzMywgMHg4OCwgMHgwNywgMHhjNywgMHgzMSwgMHhiMSwgMHgxMiwgMHgxMCwgMHg1OSwgMHgyNywgMHg4MCwgMHhlYywgMHg1ZiwgMHg2MCwgMHg1MSwgMHg3ZiwgMHhhOSwgMHgxOSwgMHhiNSwgMHg0YSwgMHgwZCwgMHgyZCwgMHhlNSwgMHg3YSwgMHg5ZiwgMHg5MywgMHhjOSwgMHg5YywgMHhlZiwgMHhhMCwgMHhlMCwgMHgzYiwgMHg0ZCwgMHhhZSwgMHgyYSwgMHhmNSwgMHhiMCwgMHhjOCwgMHhlYiwgMHhiYiwgMHgzYywgMHg4MywgMHg1MywgMHg5OSwgMHg2MSwgMHgxNywgMHgyYiwgMHgwNCwgMHg3ZSwgMHhiYSwgMHg3NywgMHhkNiwgMHgyNiwgMHhlMSwgMHg2OSwgMHgxNCwgMHg2MywgMHg1NSwgMHgyMSwgMHgwYywgMHg3ZF0pOwogICAgdGhpcy5fbWl4ID0gbmV3IFVpbnQzMkFycmF5KFsweDAwMDAwMDAwLCAweDBlMDkwZDBiLCAweDFjMTIxYTE2LCAweDEyMWIxNzFkLCAweDM4MjQzNDJjLCAweDM2MmQzOTI3LCAweDI0MzYyZTNhLCAweDJhM2YyMzMxLCAweDcwNDg2ODU4LCAweDdlNDE2NTUzLCAweDZjNWE3MjRlLCAweDYyNTM3ZjQ1LCAweDQ4NmM1Yzc0LCAweDQ2NjU1MTdmLCAweDU0N2U0NjYyLCAweDVhNzc0YjY5LCAweGUwOTBkMGIwLCAweGVlOTlkZGJiLCAweGZjODJjYWE2LCAweGYyOGJjN2FkLCAweGQ4YjRlNDljLCAweGQ2YmRlOTk3LCAweGM0YTZmZThhLCAweGNhYWZmMzgxLCAweDkwZDhiOGU4LCAweDllZDFiNWUzLCAweDhjY2FhMmZlLCAweDgyYzNhZmY1LCAweGE4ZmM4Y2M0LCAweGE2ZjU4MWNmLCAweGI0ZWU5NmQyLCAweGJhZTc5YmQ5LCAweGRiM2JiYjdiLCAweGQ1MzJiNjcwLCAweGM3MjlhMTZkLCAweGM5MjBhYzY2LCAweGUzMWY4ZjU3LCAweGVkMTY4MjVjLCAweGZmMGQ5NTQxLCAweGYxMDQ5ODRhLCAweGFiNzNkMzIzLCAweGE1N2FkZTI4LCAweGI3NjFjOTM1LCAweGI5NjhjNDNlLCAweDkzNTdlNzBmLCAweDlkNWVlYTA0LCAweDhmNDVmZDE5LCAweDgxNGNmMDEyLCAweDNiYWI2YmNiLCAweDM1YTI2NmMwLCAweDI3Yjk3MWRkLCAweDI5YjA3Y2Q2LCAweDAzOGY1ZmU3LCAweDBkODY1MmVjLCAweDFmOWQ0NWYxLCAweDExOTQ0OGZhLCAweDRiZTMwMzkzLCAweDQ1ZWEwZTk4LCAweDU3ZjExOTg1LCAweDU5ZjgxNDhlLCAweDczYzczN2JmLCAweDdkY2UzYWI0LCAweDZmZDUyZGE5LCAweDYxZGMyMGEyLCAweGFkNzY2ZGY2LCAweGEzN2Y2MGZkLCAweGIxNjQ3N2UwLCAweGJmNmQ3YWViLCAweDk1NTI1OWRhLCAweDliNWI1NGQxLCAweDg5NDA0M2NjLCAweDg3NDk0ZWM3LCAweGRkM2UwNWFlLCAweGQzMzcwOGE1LCAweGMxMmMxZmI4LCAweGNmMjUxMmIzLCAweGU1MWEzMTgyLCAweGViMTMzYzg5LCAweGY5MDgyYjk0LCAweGY3MDEyNjlmLCAweDRkZTZiZDQ2LCAweDQzZWZiMDRkLCAweDUxZjRhNzUwLCAweDVmZmRhYTViLCAweDc1YzI4OTZhLCAweDdiY2I4NDYxLCAweDY5ZDA5MzdjLCAweDY3ZDk5ZTc3LCAweDNkYWVkNTFlLCAweDMzYTdkODE1LCAweDIxYmNjZjA4LCAweDJmYjVjMjAzLCAweDA1OGFlMTMyLCAweDBiODNlYzM5LCAweDE5OThmYjI0LCAweDE3OTFmNjJmLCAweDc2NGRkNjhkLCAweDc4NDRkYjg2LCAweDZhNWZjYzliLCAweDY0NTZjMTkwLCAweDRlNjllMmExLCAweDQwNjBlZmFhLCAweDUyN2JmOGI3LCAweDVjNzJmNWJjLCAweDA2MDViZWQ1LCAweDA4MGNiM2RlLCAweDFhMTdhNGMzLCAweDE0MWVhOWM4LCAweDNlMjE4YWY5LCAweDMwMjg4N2YyLCAweDIyMzM5MGVmLCAweDJjM2E5ZGU0LCAweDk2ZGQwNjNkLCAweDk4ZDQwYjM2LCAweDhhY2YxYzJiLCAweDg0YzYxMTIwLCAweGFlZjkzMjExLCAweGEwZjAzZjFhLCAweGIyZWIyODA3LCAweGJjZTIyNTBjLCAweGU2OTU2ZTY1LCAweGU4OWM2MzZlLCAweGZhODc3NDczLCAweGY0OGU3OTc4LCAweGRlYjE1YTQ5LCAweGQwYjg1NzQyLCAweGMyYTM0MDVmLCAweGNjYWE0ZDU0LCAweDQxZWNkYWY3LCAweDRmZTVkN2ZjLCAweDVkZmVjMGUxLCAweDUzZjdjZGVhLCAweDc5YzhlZWRiLCAweDc3YzFlM2QwLCAweDY1ZGFmNGNkLCAweDZiZDNmOWM2LCAweDMxYTRiMmFmLCAweDNmYWRiZmE0LCAweDJkYjZhOGI5LCAweDIzYmZhNWIyLCAweDA5ODA4NjgzLCAweDA3ODk4Yjg4LCAweDE1OTI5Yzk1LCAweDFiOWI5MTllLCAweGExN2MwYTQ3LCAweGFmNzUwNzRjLCAweGJkNmUxMDUxLCAweGIzNjcxZDVhLCAweDk5NTgzZTZiLCAweDk3NTEzMzYwLCAweDg1NGEyNDdkLCAweDhiNDMyOTc2LCAweGQxMzQ2MjFmLCAweGRmM2Q2ZjE0LCAweGNkMjY3ODA5LCAweGMzMmY3NTAyLCAweGU5MTA1NjMzLCAweGU3MTk1YjM4LCAweGY1MDI0YzI1LCAweGZiMGI0MTJlLCAweDlhZDc2MThjLCAweDk0ZGU2Yzg3LCAweDg2YzU3YjlhLCAweDg4Y2M3NjkxLCAweGEyZjM1NWEwLCAweGFjZmE1OGFiLCAweGJlZTE0ZmI2LCAweGIwZTg0MmJkLCAweGVhOWYwOWQ0LCAweGU0OTYwNGRmLCAweGY2OGQxM2MyLCAweGY4ODQxZWM5LCAweGQyYmIzZGY4LCAweGRjYjIzMGYzLCAweGNlYTkyN2VlLCAweGMwYTAyYWU1LCAweDdhNDdiMTNjLCAweDc0NGViYzM3LCAweDY2NTVhYjJhLCAweDY4NWNhNjIxLCAweDQyNjM4NTEwLCAweDRjNmE4ODFiLCAweDVlNzE5ZjA2LCAweDUwNzg5MjBkLCAweDBhMGZkOTY0LCAweDA0MDZkNDZmLCAweDE2MWRjMzcyLCAweDE4MTRjZTc5LCAweDMyMmJlZDQ4LCAweDNjMjJlMDQzLCAweDJlMzlmNzVlLCAweDIwMzBmYTU1LCAweGVjOWFiNzAxLCAweGUyOTNiYTBhLCAweGYwODhhZDE3LCAweGZlODFhMDFjLCAweGQ0YmU4MzJkLCAweGRhYjc4ZTI2LCAweGM4YWM5OTNiLCAweGM2YTU5NDMwLCAweDljZDJkZjU5LCAweDkyZGJkMjUyLCAweDgwYzBjNTRmLCAweDhlYzljODQ0LCAweGE0ZjZlYjc1LCAweGFhZmZlNjdlLCAweGI4ZTRmMTYzLCAweGI2ZWRmYzY4LCAweDBjMGE2N2IxLCAweDAyMDM2YWJhLCAweDEwMTg3ZGE3LCAweDFlMTE3MGFjLCAweDM0MmU1MzlkLCAweDNhMjc1ZTk2LCAweDI4M2M0OThiLCAweDI2MzU0NDgwLCAweDdjNDIwZmU5LCAweDcyNGIwMmUyLCAweDYwNTAxNWZmLCAweDZlNTkxOGY0LCAweDQ0NjYzYmM1LCAweDRhNmYzNmNlLCAweDU4NzQyMWQzLCAweDU2N2QyY2Q4LCAweDM3YTEwYzdhLCAweDM5YTgwMTcxLCAweDJiYjMxNjZjLCAweDI1YmExYjY3LCAweDBmODUzODU2LCAweDAxOGMzNTVkLCAweDEzOTcyMjQwLCAweDFkOWUyZjRiLCAweDQ3ZTk2NDIyLCAweDQ5ZTA2OTI5LCAweDViZmI3ZTM0LCAweDU1ZjI3MzNmLCAweDdmY2Q1MDBlLCAweDcxYzQ1ZDA1LCAweDYzZGY0YTE4LCAweDZkZDY0NzEzLCAweGQ3MzFkY2NhLCAweGQ5MzhkMWMxLCAweGNiMjNjNmRjLCAweGM1MmFjYmQ3LCAweGVmMTVlOGU2LCAweGUxMWNlNWVkLCAweGYzMDdmMmYwLCAweGZkMGVmZmZiLCAweGE3NzliNDkyLCAweGE5NzBiOTk5LCAweGJiNmJhZTg0LCAweGI1NjJhMzhmLCAweDlmNWQ4MGJlLCAweDkxNTQ4ZGI1LCAweDgzNGY5YWE4LCAweDhkNDY5N2EzXSk7CiAgICB0aGlzLl9taXhDb2wgPSBuZXcgVWludDhBcnJheSgyNTYpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyBpKyspIHsKICAgICAgaWYgKGkgPCAxMjgpIHsKICAgICAgICB0aGlzLl9taXhDb2xbaV0gPSBpIDw8IDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5fbWl4Q29sW2ldID0gaSA8PCAxIF4gMHgxYjsKICAgICAgfQogICAgfQoKICAgIHRoaXMuYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMTYpOwogICAgdGhpcy5idWZmZXJQb3NpdGlvbiA9IDA7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQUVTQmFzZUNpcGhlciwgW3sKICAgIGtleTogIl9leHBhbmRLZXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9leHBhbmRLZXkoY2lwaGVyS2V5KSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBjYWxsIGBfZXhwYW5kS2V5YCBvbiB0aGUgYmFzZSBjbGFzcyIpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9kZWNyeXB0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVjcnlwdChpbnB1dCwga2V5KSB7CiAgICAgIHZhciB0LCB1LCB2OwogICAgICB2YXIgc3RhdGUgPSBuZXcgVWludDhBcnJheSgxNik7CiAgICAgIHN0YXRlLnNldChpbnB1dCk7CgogICAgICBmb3IgKHZhciBqID0gMCwgayA9IHRoaXMuX2tleVNpemU7IGogPCAxNjsgKytqLCArK2spIHsKICAgICAgICBzdGF0ZVtqXSBePSBrZXlba107CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSB0aGlzLl9jeWNsZXNPZlJlcGV0aXRpb24gLSAxOyBpID49IDE7IC0taSkgewogICAgICAgIHQgPSBzdGF0ZVsxM107CiAgICAgICAgc3RhdGVbMTNdID0gc3RhdGVbOV07CiAgICAgICAgc3RhdGVbOV0gPSBzdGF0ZVs1XTsKICAgICAgICBzdGF0ZVs1XSA9IHN0YXRlWzFdOwogICAgICAgIHN0YXRlWzFdID0gdDsKICAgICAgICB0ID0gc3RhdGVbMTRdOwogICAgICAgIHUgPSBzdGF0ZVsxMF07CiAgICAgICAgc3RhdGVbMTRdID0gc3RhdGVbNl07CiAgICAgICAgc3RhdGVbMTBdID0gc3RhdGVbMl07CiAgICAgICAgc3RhdGVbNl0gPSB0OwogICAgICAgIHN0YXRlWzJdID0gdTsKICAgICAgICB0ID0gc3RhdGVbMTVdOwogICAgICAgIHUgPSBzdGF0ZVsxMV07CiAgICAgICAgdiA9IHN0YXRlWzddOwogICAgICAgIHN0YXRlWzE1XSA9IHN0YXRlWzNdOwogICAgICAgIHN0YXRlWzExXSA9IHQ7CiAgICAgICAgc3RhdGVbN10gPSB1OwogICAgICAgIHN0YXRlWzNdID0gdjsKCiAgICAgICAgZm9yICh2YXIgX2ogPSAwOyBfaiA8IDE2OyArK19qKSB7CiAgICAgICAgICBzdGF0ZVtfal0gPSB0aGlzLl9pbnZfc1tzdGF0ZVtfal1dOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgX2oyID0gMCwgX2sgPSBpICogMTY7IF9qMiA8IDE2OyArK19qMiwgKytfaykgewogICAgICAgICAgc3RhdGVbX2oyXSBePSBrZXlbX2tdOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgX2ozID0gMDsgX2ozIDwgMTY7IF9qMyArPSA0KSB7CiAgICAgICAgICB2YXIgczAgPSB0aGlzLl9taXhbc3RhdGVbX2ozXV07CiAgICAgICAgICB2YXIgczEgPSB0aGlzLl9taXhbc3RhdGVbX2ozICsgMV1dOwogICAgICAgICAgdmFyIHMyID0gdGhpcy5fbWl4W3N0YXRlW19qMyArIDJdXTsKICAgICAgICAgIHZhciBzMyA9IHRoaXMuX21peFtzdGF0ZVtfajMgKyAzXV07CiAgICAgICAgICB0ID0gczAgXiBzMSA+Pj4gOCBeIHMxIDw8IDI0IF4gczIgPj4+IDE2IF4gczIgPDwgMTYgXiBzMyA+Pj4gMjQgXiBzMyA8PCA4OwogICAgICAgICAgc3RhdGVbX2ozXSA9IHQgPj4+IDI0ICYgMHhmZjsKICAgICAgICAgIHN0YXRlW19qMyArIDFdID0gdCA+PiAxNiAmIDB4ZmY7CiAgICAgICAgICBzdGF0ZVtfajMgKyAyXSA9IHQgPj4gOCAmIDB4ZmY7CiAgICAgICAgICBzdGF0ZVtfajMgKyAzXSA9IHQgJiAweGZmOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdCA9IHN0YXRlWzEzXTsKICAgICAgc3RhdGVbMTNdID0gc3RhdGVbOV07CiAgICAgIHN0YXRlWzldID0gc3RhdGVbNV07CiAgICAgIHN0YXRlWzVdID0gc3RhdGVbMV07CiAgICAgIHN0YXRlWzFdID0gdDsKICAgICAgdCA9IHN0YXRlWzE0XTsKICAgICAgdSA9IHN0YXRlWzEwXTsKICAgICAgc3RhdGVbMTRdID0gc3RhdGVbNl07CiAgICAgIHN0YXRlWzEwXSA9IHN0YXRlWzJdOwogICAgICBzdGF0ZVs2XSA9IHQ7CiAgICAgIHN0YXRlWzJdID0gdTsKICAgICAgdCA9IHN0YXRlWzE1XTsKICAgICAgdSA9IHN0YXRlWzExXTsKICAgICAgdiA9IHN0YXRlWzddOwogICAgICBzdGF0ZVsxNV0gPSBzdGF0ZVszXTsKICAgICAgc3RhdGVbMTFdID0gdDsKICAgICAgc3RhdGVbN10gPSB1OwogICAgICBzdGF0ZVszXSA9IHY7CgogICAgICBmb3IgKHZhciBfajQgPSAwOyBfajQgPCAxNjsgKytfajQpIHsKICAgICAgICBzdGF0ZVtfajRdID0gdGhpcy5faW52X3Nbc3RhdGVbX2o0XV07CiAgICAgICAgc3RhdGVbX2o0XSBePSBrZXlbX2o0XTsKICAgICAgfQoKICAgICAgcmV0dXJuIHN0YXRlOwogICAgfQogIH0sIHsKICAgIGtleTogIl9lbmNyeXB0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZW5jcnlwdChpbnB1dCwga2V5KSB7CiAgICAgIHZhciBzID0gdGhpcy5fczsKICAgICAgdmFyIHQsIHUsIHY7CiAgICAgIHZhciBzdGF0ZSA9IG5ldyBVaW50OEFycmF5KDE2KTsKICAgICAgc3RhdGUuc2V0KGlucHV0KTsKCiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTY7ICsraikgewogICAgICAgIHN0YXRlW2pdIF49IGtleVtqXTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLl9jeWNsZXNPZlJlcGV0aXRpb247IGkrKykgewogICAgICAgIGZvciAodmFyIF9qNSA9IDA7IF9qNSA8IDE2OyArK19qNSkgewogICAgICAgICAgc3RhdGVbX2o1XSA9IHNbc3RhdGVbX2o1XV07CiAgICAgICAgfQoKICAgICAgICB2ID0gc3RhdGVbMV07CiAgICAgICAgc3RhdGVbMV0gPSBzdGF0ZVs1XTsKICAgICAgICBzdGF0ZVs1XSA9IHN0YXRlWzldOwogICAgICAgIHN0YXRlWzldID0gc3RhdGVbMTNdOwogICAgICAgIHN0YXRlWzEzXSA9IHY7CiAgICAgICAgdiA9IHN0YXRlWzJdOwogICAgICAgIHUgPSBzdGF0ZVs2XTsKICAgICAgICBzdGF0ZVsyXSA9IHN0YXRlWzEwXTsKICAgICAgICBzdGF0ZVs2XSA9IHN0YXRlWzE0XTsKICAgICAgICBzdGF0ZVsxMF0gPSB2OwogICAgICAgIHN0YXRlWzE0XSA9IHU7CiAgICAgICAgdiA9IHN0YXRlWzNdOwogICAgICAgIHUgPSBzdGF0ZVs3XTsKICAgICAgICB0ID0gc3RhdGVbMTFdOwogICAgICAgIHN0YXRlWzNdID0gc3RhdGVbMTVdOwogICAgICAgIHN0YXRlWzddID0gdjsKICAgICAgICBzdGF0ZVsxMV0gPSB1OwogICAgICAgIHN0YXRlWzE1XSA9IHQ7CgogICAgICAgIGZvciAodmFyIF9qNiA9IDA7IF9qNiA8IDE2OyBfajYgKz0gNCkgewogICAgICAgICAgdmFyIHMwID0gc3RhdGVbX2o2ICsgMF07CiAgICAgICAgICB2YXIgczEgPSBzdGF0ZVtfajYgKyAxXTsKICAgICAgICAgIHZhciBzMiA9IHN0YXRlW19qNiArIDJdOwogICAgICAgICAgdmFyIHMzID0gc3RhdGVbX2o2ICsgM107CiAgICAgICAgICB0ID0gczAgXiBzMSBeIHMyIF4gczM7CiAgICAgICAgICBzdGF0ZVtfajYgKyAwXSBePSB0IF4gdGhpcy5fbWl4Q29sW3MwIF4gczFdOwogICAgICAgICAgc3RhdGVbX2o2ICsgMV0gXj0gdCBeIHRoaXMuX21peENvbFtzMSBeIHMyXTsKICAgICAgICAgIHN0YXRlW19qNiArIDJdIF49IHQgXiB0aGlzLl9taXhDb2xbczIgXiBzM107CiAgICAgICAgICBzdGF0ZVtfajYgKyAzXSBePSB0IF4gdGhpcy5fbWl4Q29sW3MzIF4gczBdOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgX2o3ID0gMCwgayA9IGkgKiAxNjsgX2o3IDwgMTY7ICsrX2o3LCArK2spIHsKICAgICAgICAgIHN0YXRlW19qN10gXj0ga2V5W2tdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yICh2YXIgX2o4ID0gMDsgX2o4IDwgMTY7ICsrX2o4KSB7CiAgICAgICAgc3RhdGVbX2o4XSA9IHNbc3RhdGVbX2o4XV07CiAgICAgIH0KCiAgICAgIHYgPSBzdGF0ZVsxXTsKICAgICAgc3RhdGVbMV0gPSBzdGF0ZVs1XTsKICAgICAgc3RhdGVbNV0gPSBzdGF0ZVs5XTsKICAgICAgc3RhdGVbOV0gPSBzdGF0ZVsxM107CiAgICAgIHN0YXRlWzEzXSA9IHY7CiAgICAgIHYgPSBzdGF0ZVsyXTsKICAgICAgdSA9IHN0YXRlWzZdOwogICAgICBzdGF0ZVsyXSA9IHN0YXRlWzEwXTsKICAgICAgc3RhdGVbNl0gPSBzdGF0ZVsxNF07CiAgICAgIHN0YXRlWzEwXSA9IHY7CiAgICAgIHN0YXRlWzE0XSA9IHU7CiAgICAgIHYgPSBzdGF0ZVszXTsKICAgICAgdSA9IHN0YXRlWzddOwogICAgICB0ID0gc3RhdGVbMTFdOwogICAgICBzdGF0ZVszXSA9IHN0YXRlWzE1XTsKICAgICAgc3RhdGVbN10gPSB2OwogICAgICBzdGF0ZVsxMV0gPSB1OwogICAgICBzdGF0ZVsxNV0gPSB0OwoKICAgICAgZm9yICh2YXIgX2o5ID0gMCwgX2syID0gdGhpcy5fa2V5U2l6ZTsgX2o5IDwgMTY7ICsrX2o5LCArK19rMikgewogICAgICAgIHN0YXRlW19qOV0gXj0ga2V5W19rMl07CiAgICAgIH0KCiAgICAgIHJldHVybiBzdGF0ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZGVjcnlwdEJsb2NrMiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlY3J5cHRCbG9jazIoZGF0YSwgZmluYWxpemUpIHsKICAgICAgdmFyIHNvdXJjZUxlbmd0aCA9IGRhdGEubGVuZ3RoOwogICAgICB2YXIgYnVmZmVyID0gdGhpcy5idWZmZXIsCiAgICAgICAgICBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlclBvc2l0aW9uOwogICAgICB2YXIgcmVzdWx0ID0gW107CiAgICAgIHZhciBpdiA9IHRoaXMuaXY7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNvdXJjZUxlbmd0aDsgKytpKSB7CiAgICAgICAgYnVmZmVyW2J1ZmZlckxlbmd0aF0gPSBkYXRhW2ldOwogICAgICAgICsrYnVmZmVyTGVuZ3RoOwoKICAgICAgICBpZiAoYnVmZmVyTGVuZ3RoIDwgMTYpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHBsYWluID0gdGhpcy5fZGVjcnlwdChidWZmZXIsIHRoaXMuX2tleSk7CgogICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTY7ICsraikgewogICAgICAgICAgcGxhaW5bal0gXj0gaXZbal07CiAgICAgICAgfQoKICAgICAgICBpdiA9IGJ1ZmZlcjsKICAgICAgICByZXN1bHQucHVzaChwbGFpbik7CiAgICAgICAgYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMTYpOwogICAgICAgIGJ1ZmZlckxlbmd0aCA9IDA7CiAgICAgIH0KCiAgICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyOwogICAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGJ1ZmZlckxlbmd0aDsKICAgICAgdGhpcy5pdiA9IGl2OwoKICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoMCk7CiAgICAgIH0KCiAgICAgIHZhciBvdXRwdXRMZW5ndGggPSAxNiAqIHJlc3VsdC5sZW5ndGg7CgogICAgICBpZiAoZmluYWxpemUpIHsKICAgICAgICB2YXIgbGFzdEJsb2NrID0gcmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXTsKICAgICAgICB2YXIgcHNMZW4gPSBsYXN0QmxvY2tbMTVdOwoKICAgICAgICBpZiAocHNMZW4gPD0gMTYpIHsKICAgICAgICAgIGZvciAodmFyIF9pID0gMTUsIGlpID0gMTYgLSBwc0xlbjsgX2kgPj0gaWk7IC0tX2kpIHsKICAgICAgICAgICAgaWYgKGxhc3RCbG9ja1tfaV0gIT09IHBzTGVuKSB7CiAgICAgICAgICAgICAgcHNMZW4gPSAwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgb3V0cHV0TGVuZ3RoIC09IHBzTGVuOwogICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXSA9IGxhc3RCbG9jay5zdWJhcnJheSgwLCAxNiAtIHBzTGVuKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBvdXRwdXQgPSBuZXcgVWludDhBcnJheShvdXRwdXRMZW5ndGgpOwoKICAgICAgZm9yICh2YXIgX2kyID0gMCwgX2oxMCA9IDAsIF9paSA9IHJlc3VsdC5sZW5ndGg7IF9pMiA8IF9paTsgKytfaTIsIF9qMTAgKz0gMTYpIHsKICAgICAgICBvdXRwdXQuc2V0KHJlc3VsdFtfaTJdLCBfajEwKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG91dHB1dDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZWNyeXB0QmxvY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlY3J5cHRCbG9jayhkYXRhLCBmaW5hbGl6ZSkgewogICAgICB2YXIgaXYgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IG51bGw7CiAgICAgIHZhciBzb3VyY2VMZW5ndGggPSBkYXRhLmxlbmd0aDsKICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMuYnVmZmVyOwogICAgICB2YXIgYnVmZmVyTGVuZ3RoID0gdGhpcy5idWZmZXJQb3NpdGlvbjsKCiAgICAgIGlmIChpdikgewogICAgICAgIHRoaXMuaXYgPSBpdjsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgYnVmZmVyTGVuZ3RoIDwgMTYgJiYgaSA8IHNvdXJjZUxlbmd0aDsgKytpLCArK2J1ZmZlckxlbmd0aCkgewogICAgICAgICAgYnVmZmVyW2J1ZmZlckxlbmd0aF0gPSBkYXRhW2ldOwogICAgICAgIH0KCiAgICAgICAgaWYgKGJ1ZmZlckxlbmd0aCA8IDE2KSB7CiAgICAgICAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IGJ1ZmZlckxlbmd0aDsKICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSgwKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuaXYgPSBidWZmZXI7CiAgICAgICAgZGF0YSA9IGRhdGEuc3ViYXJyYXkoMTYpOwogICAgICB9CgogICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDE2KTsKICAgICAgdGhpcy5idWZmZXJMZW5ndGggPSAwOwogICAgICB0aGlzLmRlY3J5cHRCbG9jayA9IHRoaXMuX2RlY3J5cHRCbG9jazI7CiAgICAgIHJldHVybiB0aGlzLmRlY3J5cHRCbG9jayhkYXRhLCBmaW5hbGl6ZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZW5jcnlwdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZW5jcnlwdChkYXRhLCBpdikgewogICAgICB2YXIgc291cmNlTGVuZ3RoID0gZGF0YS5sZW5ndGg7CiAgICAgIHZhciBidWZmZXIgPSB0aGlzLmJ1ZmZlciwKICAgICAgICAgIGJ1ZmZlckxlbmd0aCA9IHRoaXMuYnVmZmVyUG9zaXRpb247CiAgICAgIHZhciByZXN1bHQgPSBbXTsKCiAgICAgIGlmICghaXYpIHsKICAgICAgICBpdiA9IG5ldyBVaW50OEFycmF5KDE2KTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzb3VyY2VMZW5ndGg7ICsraSkgewogICAgICAgIGJ1ZmZlcltidWZmZXJMZW5ndGhdID0gZGF0YVtpXTsKICAgICAgICArK2J1ZmZlckxlbmd0aDsKCiAgICAgICAgaWYgKGJ1ZmZlckxlbmd0aCA8IDE2KSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTY7ICsraikgewogICAgICAgICAgYnVmZmVyW2pdIF49IGl2W2pdOwogICAgICAgIH0KCiAgICAgICAgdmFyIGNpcGhlciA9IHRoaXMuX2VuY3J5cHQoYnVmZmVyLCB0aGlzLl9rZXkpOwoKICAgICAgICBpdiA9IGNpcGhlcjsKICAgICAgICByZXN1bHQucHVzaChjaXBoZXIpOwogICAgICAgIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDE2KTsKICAgICAgICBidWZmZXJMZW5ndGggPSAwOwogICAgICB9CgogICAgICB0aGlzLmJ1ZmZlciA9IGJ1ZmZlcjsKICAgICAgdGhpcy5idWZmZXJMZW5ndGggPSBidWZmZXJMZW5ndGg7CiAgICAgIHRoaXMuaXYgPSBpdjsKCiAgICAgIGlmIChyZXN1bHQubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApOwogICAgICB9CgogICAgICB2YXIgb3V0cHV0TGVuZ3RoID0gMTYgKiByZXN1bHQubGVuZ3RoOwogICAgICB2YXIgb3V0cHV0ID0gbmV3IFVpbnQ4QXJyYXkob3V0cHV0TGVuZ3RoKTsKCiAgICAgIGZvciAodmFyIF9pMyA9IDAsIF9qMTEgPSAwLCBpaSA9IHJlc3VsdC5sZW5ndGg7IF9pMyA8IGlpOyArK19pMywgX2oxMSArPSAxNikgewogICAgICAgIG91dHB1dC5zZXQocmVzdWx0W19pM10sIF9qMTEpOwogICAgICB9CgogICAgICByZXR1cm4gb3V0cHV0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFFU0Jhc2VDaXBoZXI7Cn0oKTsKCnZhciBBRVMxMjhDaXBoZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9BRVNCYXNlQ2lwaGVyKSB7CiAgX2luaGVyaXRzKEFFUzEyOENpcGhlciwgX0FFU0Jhc2VDaXBoZXIpOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKEFFUzEyOENpcGhlcik7CgogIGZ1bmN0aW9uIEFFUzEyOENpcGhlcihrZXkpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQUVTMTI4Q2lwaGVyKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpOwogICAgX3RoaXMuX2N5Y2xlc09mUmVwZXRpdGlvbiA9IDEwOwogICAgX3RoaXMuX2tleVNpemUgPSAxNjA7CiAgICBfdGhpcy5fcmNvbiA9IG5ldyBVaW50OEFycmF5KFsweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkLCAweDAxLCAweDAyLCAweDA0LCAweDA4LCAweDEwLCAweDIwLCAweDQwLCAweDgwLCAweDFiLCAweDM2LCAweDZjLCAweGQ4LCAweGFiLCAweDRkLCAweDlhLCAweDJmLCAweDVlLCAweGJjLCAweDYzLCAweGM2LCAweDk3LCAweDM1LCAweDZhLCAweGQ0LCAweGIzLCAweDdkLCAweGZhLCAweGVmLCAweGM1LCAweDkxLCAweDM5LCAweDcyLCAweGU0LCAweGQzLCAweGJkLCAweDYxLCAweGMyLCAweDlmLCAweDI1LCAweDRhLCAweDk0LCAweDMzLCAweDY2LCAweGNjLCAweDgzLCAweDFkLCAweDNhLCAweDc0LCAweGU4LCAweGNiLCAweDhkXSk7CiAgICBfdGhpcy5fa2V5ID0gX3RoaXMuX2V4cGFuZEtleShrZXkpOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEFFUzEyOENpcGhlciwgW3sKICAgIGtleTogIl9leHBhbmRLZXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9leHBhbmRLZXkoY2lwaGVyS2V5KSB7CiAgICAgIHZhciBiID0gMTc2OwogICAgICB2YXIgcyA9IHRoaXMuX3M7CiAgICAgIHZhciByY29uID0gdGhpcy5fcmNvbjsKICAgICAgdmFyIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KGIpOwogICAgICByZXN1bHQuc2V0KGNpcGhlcktleSk7CgogICAgICBmb3IgKHZhciBqID0gMTYsIGkgPSAxOyBqIDwgYjsgKytpKSB7CiAgICAgICAgdmFyIHQxID0gcmVzdWx0W2ogLSAzXTsKICAgICAgICB2YXIgdDIgPSByZXN1bHRbaiAtIDJdOwogICAgICAgIHZhciB0MyA9IHJlc3VsdFtqIC0gMV07CiAgICAgICAgdmFyIHQ0ID0gcmVzdWx0W2ogLSA0XTsKICAgICAgICB0MSA9IHNbdDFdOwogICAgICAgIHQyID0gc1t0Ml07CiAgICAgICAgdDMgPSBzW3QzXTsKICAgICAgICB0NCA9IHNbdDRdOwogICAgICAgIHQxID0gdDEgXiByY29uW2ldOwoKICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IDQ7ICsrbikgewogICAgICAgICAgcmVzdWx0W2pdID0gdDEgXj0gcmVzdWx0W2ogLSAxNl07CiAgICAgICAgICBqKys7CiAgICAgICAgICByZXN1bHRbal0gPSB0MiBePSByZXN1bHRbaiAtIDE2XTsKICAgICAgICAgIGorKzsKICAgICAgICAgIHJlc3VsdFtqXSA9IHQzIF49IHJlc3VsdFtqIC0gMTZdOwogICAgICAgICAgaisrOwogICAgICAgICAgcmVzdWx0W2pdID0gdDQgXj0gcmVzdWx0W2ogLSAxNl07CiAgICAgICAgICBqKys7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFFUzEyOENpcGhlcjsKfShBRVNCYXNlQ2lwaGVyKTsKCmV4cG9ydHMuQUVTMTI4Q2lwaGVyID0gQUVTMTI4Q2lwaGVyOwoKdmFyIEFFUzI1NkNpcGhlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0FFU0Jhc2VDaXBoZXIyKSB7CiAgX2luaGVyaXRzKEFFUzI1NkNpcGhlciwgX0FFU0Jhc2VDaXBoZXIyKTsKCiAgdmFyIF9zdXBlcjIgPSBfY3JlYXRlU3VwZXIoQUVTMjU2Q2lwaGVyKTsKCiAgZnVuY3Rpb24gQUVTMjU2Q2lwaGVyKGtleSkgewogICAgdmFyIF90aGlzMjsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQUVTMjU2Q2lwaGVyKTsKCiAgICBfdGhpczIgPSBfc3VwZXIyLmNhbGwodGhpcyk7CiAgICBfdGhpczIuX2N5Y2xlc09mUmVwZXRpdGlvbiA9IDE0OwogICAgX3RoaXMyLl9rZXlTaXplID0gMjI0OwogICAgX3RoaXMyLl9rZXkgPSBfdGhpczIuX2V4cGFuZEtleShrZXkpOwogICAgcmV0dXJuIF90aGlzMjsKICB9CgogIF9jcmVhdGVDbGFzcyhBRVMyNTZDaXBoZXIsIFt7CiAgICBrZXk6ICJfZXhwYW5kS2V5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZXhwYW5kS2V5KGNpcGhlcktleSkgewogICAgICB2YXIgYiA9IDI0MDsKICAgICAgdmFyIHMgPSB0aGlzLl9zOwogICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoYik7CiAgICAgIHJlc3VsdC5zZXQoY2lwaGVyS2V5KTsKICAgICAgdmFyIHIgPSAxOwogICAgICB2YXIgdDEsIHQyLCB0MywgdDQ7CgogICAgICBmb3IgKHZhciBqID0gMzIsIGkgPSAxOyBqIDwgYjsgKytpKSB7CiAgICAgICAgaWYgKGogJSAzMiA9PT0gMTYpIHsKICAgICAgICAgIHQxID0gc1t0MV07CiAgICAgICAgICB0MiA9IHNbdDJdOwogICAgICAgICAgdDMgPSBzW3QzXTsKICAgICAgICAgIHQ0ID0gc1t0NF07CiAgICAgICAgfSBlbHNlIGlmIChqICUgMzIgPT09IDApIHsKICAgICAgICAgIHQxID0gcmVzdWx0W2ogLSAzXTsKICAgICAgICAgIHQyID0gcmVzdWx0W2ogLSAyXTsKICAgICAgICAgIHQzID0gcmVzdWx0W2ogLSAxXTsKICAgICAgICAgIHQ0ID0gcmVzdWx0W2ogLSA0XTsKICAgICAgICAgIHQxID0gc1t0MV07CiAgICAgICAgICB0MiA9IHNbdDJdOwogICAgICAgICAgdDMgPSBzW3QzXTsKICAgICAgICAgIHQ0ID0gc1t0NF07CiAgICAgICAgICB0MSA9IHQxIF4gcjsKCiAgICAgICAgICBpZiAoKHIgPDw9IDEpID49IDI1NikgewogICAgICAgICAgICByID0gKHIgXiAweDFiKSAmIDB4ZmY7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IDQ7ICsrbikgewogICAgICAgICAgcmVzdWx0W2pdID0gdDEgXj0gcmVzdWx0W2ogLSAzMl07CiAgICAgICAgICBqKys7CiAgICAgICAgICByZXN1bHRbal0gPSB0MiBePSByZXN1bHRbaiAtIDMyXTsKICAgICAgICAgIGorKzsKICAgICAgICAgIHJlc3VsdFtqXSA9IHQzIF49IHJlc3VsdFtqIC0gMzJdOwogICAgICAgICAgaisrOwogICAgICAgICAgcmVzdWx0W2pdID0gdDQgXj0gcmVzdWx0W2ogLSAzMl07CiAgICAgICAgICBqKys7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFFUzI1NkNpcGhlcjsKfShBRVNCYXNlQ2lwaGVyKTsKCmV4cG9ydHMuQUVTMjU2Q2lwaGVyID0gQUVTMjU2Q2lwaGVyOwoKdmFyIFBERjE3ID0gZnVuY3Rpb24gUERGMTdDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGNvbXBhcmVCeXRlQXJyYXlzKGFycmF5MSwgYXJyYXkyKSB7CiAgICBpZiAoYXJyYXkxLmxlbmd0aCAhPT0gYXJyYXkyLmxlbmd0aCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheTEubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKGFycmF5MVtpXSAhPT0gYXJyYXkyW2ldKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfQoKICBmdW5jdGlvbiBQREYxNygpIHt9CgogIFBERjE3LnByb3RvdHlwZSA9IHsKICAgIGNoZWNrT3duZXJQYXNzd29yZDogZnVuY3Rpb24gUERGMTdfY2hlY2tPd25lclBhc3N3b3JkKHBhc3N3b3JkLCBvd25lclZhbGlkYXRpb25TYWx0LCB1c2VyQnl0ZXMsIG93bmVyUGFzc3dvcmQpIHsKICAgICAgdmFyIGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkocGFzc3dvcmQubGVuZ3RoICsgNTYpOwogICAgICBoYXNoRGF0YS5zZXQocGFzc3dvcmQsIDApOwogICAgICBoYXNoRGF0YS5zZXQob3duZXJWYWxpZGF0aW9uU2FsdCwgcGFzc3dvcmQubGVuZ3RoKTsKICAgICAgaGFzaERhdGEuc2V0KHVzZXJCeXRlcywgcGFzc3dvcmQubGVuZ3RoICsgb3duZXJWYWxpZGF0aW9uU2FsdC5sZW5ndGgpOwogICAgICB2YXIgcmVzdWx0ID0gY2FsY3VsYXRlU0hBMjU2KGhhc2hEYXRhLCAwLCBoYXNoRGF0YS5sZW5ndGgpOwogICAgICByZXR1cm4gY29tcGFyZUJ5dGVBcnJheXMocmVzdWx0LCBvd25lclBhc3N3b3JkKTsKICAgIH0sCiAgICBjaGVja1VzZXJQYXNzd29yZDogZnVuY3Rpb24gUERGMTdfY2hlY2tVc2VyUGFzc3dvcmQocGFzc3dvcmQsIHVzZXJWYWxpZGF0aW9uU2FsdCwgdXNlclBhc3N3b3JkKSB7CiAgICAgIHZhciBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KHBhc3N3b3JkLmxlbmd0aCArIDgpOwogICAgICBoYXNoRGF0YS5zZXQocGFzc3dvcmQsIDApOwogICAgICBoYXNoRGF0YS5zZXQodXNlclZhbGlkYXRpb25TYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgICB2YXIgcmVzdWx0ID0gY2FsY3VsYXRlU0hBMjU2KGhhc2hEYXRhLCAwLCBoYXNoRGF0YS5sZW5ndGgpOwogICAgICByZXR1cm4gY29tcGFyZUJ5dGVBcnJheXMocmVzdWx0LCB1c2VyUGFzc3dvcmQpOwogICAgfSwKICAgIGdldE93bmVyS2V5OiBmdW5jdGlvbiBQREYxN19nZXRPd25lcktleShwYXNzd29yZCwgb3duZXJLZXlTYWx0LCB1c2VyQnl0ZXMsIG93bmVyRW5jcnlwdGlvbikgewogICAgICB2YXIgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA1Nik7CiAgICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICAgIGhhc2hEYXRhLnNldChvd25lcktleVNhbHQsIHBhc3N3b3JkLmxlbmd0aCk7CiAgICAgIGhhc2hEYXRhLnNldCh1c2VyQnl0ZXMsIHBhc3N3b3JkLmxlbmd0aCArIG93bmVyS2V5U2FsdC5sZW5ndGgpOwogICAgICB2YXIga2V5ID0gY2FsY3VsYXRlU0hBMjU2KGhhc2hEYXRhLCAwLCBoYXNoRGF0YS5sZW5ndGgpOwogICAgICB2YXIgY2lwaGVyID0gbmV3IEFFUzI1NkNpcGhlcihrZXkpOwogICAgICByZXR1cm4gY2lwaGVyLmRlY3J5cHRCbG9jayhvd25lckVuY3J5cHRpb24sIGZhbHNlLCBuZXcgVWludDhBcnJheSgxNikpOwogICAgfSwKICAgIGdldFVzZXJLZXk6IGZ1bmN0aW9uIFBERjE3X2dldFVzZXJLZXkocGFzc3dvcmQsIHVzZXJLZXlTYWx0LCB1c2VyRW5jcnlwdGlvbikgewogICAgICB2YXIgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA4KTsKICAgICAgaGFzaERhdGEuc2V0KHBhc3N3b3JkLCAwKTsKICAgICAgaGFzaERhdGEuc2V0KHVzZXJLZXlTYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgICB2YXIga2V5ID0gY2FsY3VsYXRlU0hBMjU2KGhhc2hEYXRhLCAwLCBoYXNoRGF0YS5sZW5ndGgpOwogICAgICB2YXIgY2lwaGVyID0gbmV3IEFFUzI1NkNpcGhlcihrZXkpOwogICAgICByZXR1cm4gY2lwaGVyLmRlY3J5cHRCbG9jayh1c2VyRW5jcnlwdGlvbiwgZmFsc2UsIG5ldyBVaW50OEFycmF5KDE2KSk7CiAgICB9CiAgfTsKICByZXR1cm4gUERGMTc7Cn0oKTsKCmV4cG9ydHMuUERGMTcgPSBQREYxNzsKCnZhciBQREYyMCA9IGZ1bmN0aW9uIFBERjIwQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBjb25jYXRBcnJheXMoYXJyYXkxLCBhcnJheTIpIHsKICAgIHZhciB0ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXkxLmxlbmd0aCArIGFycmF5Mi5sZW5ndGgpOwogICAgdC5zZXQoYXJyYXkxLCAwKTsKICAgIHQuc2V0KGFycmF5MiwgYXJyYXkxLmxlbmd0aCk7CiAgICByZXR1cm4gdDsKICB9CgogIGZ1bmN0aW9uIGNhbGN1bGF0ZVBERjIwSGFzaChwYXNzd29yZCwgaW5wdXQsIHVzZXJCeXRlcykgewogICAgdmFyIGsgPSBjYWxjdWxhdGVTSEEyNTYoaW5wdXQsIDAsIGlucHV0Lmxlbmd0aCkuc3ViYXJyYXkoMCwgMzIpOwogICAgdmFyIGUgPSBbMF07CiAgICB2YXIgaSA9IDA7CgogICAgd2hpbGUgKGkgPCA2NCB8fCBlW2UubGVuZ3RoIC0gMV0gPiBpIC0gMzIpIHsKICAgICAgdmFyIGFycmF5TGVuZ3RoID0gcGFzc3dvcmQubGVuZ3RoICsgay5sZW5ndGggKyB1c2VyQnl0ZXMubGVuZ3RoOwogICAgICB2YXIgazEgPSBuZXcgVWludDhBcnJheShhcnJheUxlbmd0aCAqIDY0KTsKICAgICAgdmFyIGFycmF5ID0gY29uY2F0QXJyYXlzKHBhc3N3b3JkLCBrKTsKICAgICAgYXJyYXkgPSBjb25jYXRBcnJheXMoYXJyYXksIHVzZXJCeXRlcyk7CgogICAgICBmb3IgKHZhciBqID0gMCwgcG9zID0gMDsgaiA8IDY0OyBqKyssIHBvcyArPSBhcnJheUxlbmd0aCkgewogICAgICAgIGsxLnNldChhcnJheSwgcG9zKTsKICAgICAgfQoKICAgICAgdmFyIGNpcGhlciA9IG5ldyBBRVMxMjhDaXBoZXIoay5zdWJhcnJheSgwLCAxNikpOwogICAgICBlID0gY2lwaGVyLmVuY3J5cHQoazEsIGsuc3ViYXJyYXkoMTYsIDMyKSk7CiAgICAgIHZhciByZW1haW5kZXIgPSAwOwoKICAgICAgZm9yICh2YXIgeiA9IDA7IHogPCAxNjsgeisrKSB7CiAgICAgICAgcmVtYWluZGVyICo9IDI1NiAlIDM7CiAgICAgICAgcmVtYWluZGVyICU9IDM7CiAgICAgICAgcmVtYWluZGVyICs9IChlW3pdID4+PiAwKSAlIDM7CiAgICAgICAgcmVtYWluZGVyICU9IDM7CiAgICAgIH0KCiAgICAgIGlmIChyZW1haW5kZXIgPT09IDApIHsKICAgICAgICBrID0gY2FsY3VsYXRlU0hBMjU2KGUsIDAsIGUubGVuZ3RoKTsKICAgICAgfSBlbHNlIGlmIChyZW1haW5kZXIgPT09IDEpIHsKICAgICAgICBrID0gY2FsY3VsYXRlU0hBMzg0KGUsIDAsIGUubGVuZ3RoKTsKICAgICAgfSBlbHNlIGlmIChyZW1haW5kZXIgPT09IDIpIHsKICAgICAgICBrID0gY2FsY3VsYXRlU0hBNTEyKGUsIDAsIGUubGVuZ3RoKTsKICAgICAgfQoKICAgICAgaSsrOwogICAgfQoKICAgIHJldHVybiBrLnN1YmFycmF5KDAsIDMyKTsKICB9CgogIGZ1bmN0aW9uIFBERjIwKCkge30KCiAgZnVuY3Rpb24gY29tcGFyZUJ5dGVBcnJheXMoYXJyYXkxLCBhcnJheTIpIHsKICAgIGlmIChhcnJheTEubGVuZ3RoICE9PSBhcnJheTIubGVuZ3RoKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5MS5sZW5ndGg7IGkrKykgewogICAgICBpZiAoYXJyYXkxW2ldICE9PSBhcnJheTJbaV0pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIFBERjIwLnByb3RvdHlwZSA9IHsKICAgIGhhc2g6IGZ1bmN0aW9uIFBERjIwX2hhc2gocGFzc3dvcmQsIGNvbmNhdEJ5dGVzLCB1c2VyQnl0ZXMpIHsKICAgICAgcmV0dXJuIGNhbGN1bGF0ZVBERjIwSGFzaChwYXNzd29yZCwgY29uY2F0Qnl0ZXMsIHVzZXJCeXRlcyk7CiAgICB9LAogICAgY2hlY2tPd25lclBhc3N3b3JkOiBmdW5jdGlvbiBQREYyMF9jaGVja093bmVyUGFzc3dvcmQocGFzc3dvcmQsIG93bmVyVmFsaWRhdGlvblNhbHQsIHVzZXJCeXRlcywgb3duZXJQYXNzd29yZCkgewogICAgICB2YXIgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA1Nik7CiAgICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICAgIGhhc2hEYXRhLnNldChvd25lclZhbGlkYXRpb25TYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgICBoYXNoRGF0YS5zZXQodXNlckJ5dGVzLCBwYXNzd29yZC5sZW5ndGggKyBvd25lclZhbGlkYXRpb25TYWx0Lmxlbmd0aCk7CiAgICAgIHZhciByZXN1bHQgPSBjYWxjdWxhdGVQREYyMEhhc2gocGFzc3dvcmQsIGhhc2hEYXRhLCB1c2VyQnl0ZXMpOwogICAgICByZXR1cm4gY29tcGFyZUJ5dGVBcnJheXMocmVzdWx0LCBvd25lclBhc3N3b3JkKTsKICAgIH0sCiAgICBjaGVja1VzZXJQYXNzd29yZDogZnVuY3Rpb24gUERGMjBfY2hlY2tVc2VyUGFzc3dvcmQocGFzc3dvcmQsIHVzZXJWYWxpZGF0aW9uU2FsdCwgdXNlclBhc3N3b3JkKSB7CiAgICAgIHZhciBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KHBhc3N3b3JkLmxlbmd0aCArIDgpOwogICAgICBoYXNoRGF0YS5zZXQocGFzc3dvcmQsIDApOwogICAgICBoYXNoRGF0YS5zZXQodXNlclZhbGlkYXRpb25TYWx0LCBwYXNzd29yZC5sZW5ndGgpOwogICAgICB2YXIgcmVzdWx0ID0gY2FsY3VsYXRlUERGMjBIYXNoKHBhc3N3b3JkLCBoYXNoRGF0YSwgW10pOwogICAgICByZXR1cm4gY29tcGFyZUJ5dGVBcnJheXMocmVzdWx0LCB1c2VyUGFzc3dvcmQpOwogICAgfSwKICAgIGdldE93bmVyS2V5OiBmdW5jdGlvbiBQREYyMF9nZXRPd25lcktleShwYXNzd29yZCwgb3duZXJLZXlTYWx0LCB1c2VyQnl0ZXMsIG93bmVyRW5jcnlwdGlvbikgewogICAgICB2YXIgaGFzaERhdGEgPSBuZXcgVWludDhBcnJheShwYXNzd29yZC5sZW5ndGggKyA1Nik7CiAgICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICAgIGhhc2hEYXRhLnNldChvd25lcktleVNhbHQsIHBhc3N3b3JkLmxlbmd0aCk7CiAgICAgIGhhc2hEYXRhLnNldCh1c2VyQnl0ZXMsIHBhc3N3b3JkLmxlbmd0aCArIG93bmVyS2V5U2FsdC5sZW5ndGgpOwogICAgICB2YXIga2V5ID0gY2FsY3VsYXRlUERGMjBIYXNoKHBhc3N3b3JkLCBoYXNoRGF0YSwgdXNlckJ5dGVzKTsKICAgICAgdmFyIGNpcGhlciA9IG5ldyBBRVMyNTZDaXBoZXIoa2V5KTsKICAgICAgcmV0dXJuIGNpcGhlci5kZWNyeXB0QmxvY2sob3duZXJFbmNyeXB0aW9uLCBmYWxzZSwgbmV3IFVpbnQ4QXJyYXkoMTYpKTsKICAgIH0sCiAgICBnZXRVc2VyS2V5OiBmdW5jdGlvbiBQREYyMF9nZXRVc2VyS2V5KHBhc3N3b3JkLCB1c2VyS2V5U2FsdCwgdXNlckVuY3J5cHRpb24pIHsKICAgICAgdmFyIGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkocGFzc3dvcmQubGVuZ3RoICsgOCk7CiAgICAgIGhhc2hEYXRhLnNldChwYXNzd29yZCwgMCk7CiAgICAgIGhhc2hEYXRhLnNldCh1c2VyS2V5U2FsdCwgcGFzc3dvcmQubGVuZ3RoKTsKICAgICAgdmFyIGtleSA9IGNhbGN1bGF0ZVBERjIwSGFzaChwYXNzd29yZCwgaGFzaERhdGEsIFtdKTsKICAgICAgdmFyIGNpcGhlciA9IG5ldyBBRVMyNTZDaXBoZXIoa2V5KTsKICAgICAgcmV0dXJuIGNpcGhlci5kZWNyeXB0QmxvY2sodXNlckVuY3J5cHRpb24sIGZhbHNlLCBuZXcgVWludDhBcnJheSgxNikpOwogICAgfQogIH07CiAgcmV0dXJuIFBERjIwOwp9KCk7CgpleHBvcnRzLlBERjIwID0gUERGMjA7Cgp2YXIgQ2lwaGVyVHJhbnNmb3JtID0gZnVuY3Rpb24gQ2lwaGVyVHJhbnNmb3JtQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBDaXBoZXJUcmFuc2Zvcm0oc3RyaW5nQ2lwaGVyQ29uc3RydWN0b3IsIHN0cmVhbUNpcGhlckNvbnN0cnVjdG9yKSB7CiAgICB0aGlzLlN0cmluZ0NpcGhlckNvbnN0cnVjdG9yID0gc3RyaW5nQ2lwaGVyQ29uc3RydWN0b3I7CiAgICB0aGlzLlN0cmVhbUNpcGhlckNvbnN0cnVjdG9yID0gc3RyZWFtQ2lwaGVyQ29uc3RydWN0b3I7CiAgfQoKICBDaXBoZXJUcmFuc2Zvcm0ucHJvdG90eXBlID0gewogICAgY3JlYXRlU3RyZWFtOiBmdW5jdGlvbiBDaXBoZXJUcmFuc2Zvcm1fY3JlYXRlU3RyZWFtKHN0cmVhbSwgbGVuZ3RoKSB7CiAgICAgIHZhciBjaXBoZXIgPSBuZXcgdGhpcy5TdHJlYW1DaXBoZXJDb25zdHJ1Y3RvcigpOwogICAgICByZXR1cm4gbmV3IF9zdHJlYW0uRGVjcnlwdFN0cmVhbShzdHJlYW0sIGxlbmd0aCwgZnVuY3Rpb24gY2lwaGVyVHJhbnNmb3JtRGVjcnlwdFN0cmVhbShkYXRhLCBmaW5hbGl6ZSkgewogICAgICAgIHJldHVybiBjaXBoZXIuZGVjcnlwdEJsb2NrKGRhdGEsIGZpbmFsaXplKTsKICAgICAgfSk7CiAgICB9LAogICAgZGVjcnlwdFN0cmluZzogZnVuY3Rpb24gQ2lwaGVyVHJhbnNmb3JtX2RlY3J5cHRTdHJpbmcocykgewogICAgICB2YXIgY2lwaGVyID0gbmV3IHRoaXMuU3RyaW5nQ2lwaGVyQ29uc3RydWN0b3IoKTsKICAgICAgdmFyIGRhdGEgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykocyk7CiAgICAgIGRhdGEgPSBjaXBoZXIuZGVjcnlwdEJsb2NrKGRhdGEsIHRydWUpOwogICAgICByZXR1cm4gKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKGRhdGEpOwogICAgfQogIH07CiAgcmV0dXJuIENpcGhlclRyYW5zZm9ybTsKfSgpOwoKdmFyIENpcGhlclRyYW5zZm9ybUZhY3RvcnkgPSBmdW5jdGlvbiBDaXBoZXJUcmFuc2Zvcm1GYWN0b3J5Q2xvc3VyZSgpIHsKICB2YXIgZGVmYXVsdFBhc3N3b3JkQnl0ZXMgPSBuZXcgVWludDhBcnJheShbMHgyOCwgMHhCRiwgMHg0RSwgMHg1RSwgMHg0RSwgMHg3NSwgMHg4QSwgMHg0MSwgMHg2NCwgMHgwMCwgMHg0RSwgMHg1NiwgMHhGRiwgMHhGQSwgMHgwMSwgMHgwOCwgMHgyRSwgMHgyRSwgMHgwMCwgMHhCNiwgMHhEMCwgMHg2OCwgMHgzRSwgMHg4MCwgMHgyRiwgMHgwQywgMHhBOSwgMHhGRSwgMHg2NCwgMHg1MywgMHg2OSwgMHg3QV0pOwoKICBmdW5jdGlvbiBjcmVhdGVFbmNyeXB0aW9uS2V5MjAocmV2aXNpb24sIHBhc3N3b3JkLCBvd25lclBhc3N3b3JkLCBvd25lclZhbGlkYXRpb25TYWx0LCBvd25lcktleVNhbHQsIHVCeXRlcywgdXNlclBhc3N3b3JkLCB1c2VyVmFsaWRhdGlvblNhbHQsIHVzZXJLZXlTYWx0LCBvd25lckVuY3J5cHRpb24sIHVzZXJFbmNyeXB0aW9uLCBwZXJtcykgewogICAgaWYgKHBhc3N3b3JkKSB7CiAgICAgIHZhciBwYXNzd29yZExlbmd0aCA9IE1hdGgubWluKDEyNywgcGFzc3dvcmQubGVuZ3RoKTsKICAgICAgcGFzc3dvcmQgPSBwYXNzd29yZC5zdWJhcnJheSgwLCBwYXNzd29yZExlbmd0aCk7CiAgICB9IGVsc2UgewogICAgICBwYXNzd29yZCA9IFtdOwogICAgfQoKICAgIHZhciBwZGZBbGdvcml0aG07CgogICAgaWYgKHJldmlzaW9uID09PSA2KSB7CiAgICAgIHBkZkFsZ29yaXRobSA9IG5ldyBQREYyMCgpOwogICAgfSBlbHNlIHsKICAgICAgcGRmQWxnb3JpdGhtID0gbmV3IFBERjE3KCk7CiAgICB9CgogICAgaWYgKHBkZkFsZ29yaXRobS5jaGVja1VzZXJQYXNzd29yZChwYXNzd29yZCwgdXNlclZhbGlkYXRpb25TYWx0LCB1c2VyUGFzc3dvcmQpKSB7CiAgICAgIHJldHVybiBwZGZBbGdvcml0aG0uZ2V0VXNlcktleShwYXNzd29yZCwgdXNlcktleVNhbHQsIHVzZXJFbmNyeXB0aW9uKTsKICAgIH0gZWxzZSBpZiAocGFzc3dvcmQubGVuZ3RoICYmIHBkZkFsZ29yaXRobS5jaGVja093bmVyUGFzc3dvcmQocGFzc3dvcmQsIG93bmVyVmFsaWRhdGlvblNhbHQsIHVCeXRlcywgb3duZXJQYXNzd29yZCkpIHsKICAgICAgcmV0dXJuIHBkZkFsZ29yaXRobS5nZXRPd25lcktleShwYXNzd29yZCwgb3duZXJLZXlTYWx0LCB1Qnl0ZXMsIG93bmVyRW5jcnlwdGlvbik7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfQoKICBmdW5jdGlvbiBwcmVwYXJlS2V5RGF0YShmaWxlSWQsIHBhc3N3b3JkLCBvd25lclBhc3N3b3JkLCB1c2VyUGFzc3dvcmQsIGZsYWdzLCByZXZpc2lvbiwga2V5TGVuZ3RoLCBlbmNyeXB0TWV0YWRhdGEpIHsKICAgIHZhciBoYXNoRGF0YVNpemUgPSA0MCArIG93bmVyUGFzc3dvcmQubGVuZ3RoICsgZmlsZUlkLmxlbmd0aDsKICAgIHZhciBoYXNoRGF0YSA9IG5ldyBVaW50OEFycmF5KGhhc2hEYXRhU2l6ZSksCiAgICAgICAgaSA9IDAsCiAgICAgICAgaiwKICAgICAgICBuOwoKICAgIGlmIChwYXNzd29yZCkgewogICAgICBuID0gTWF0aC5taW4oMzIsIHBhc3N3b3JkLmxlbmd0aCk7CgogICAgICBmb3IgKDsgaSA8IG47ICsraSkgewogICAgICAgIGhhc2hEYXRhW2ldID0gcGFzc3dvcmRbaV07CiAgICAgIH0KICAgIH0KCiAgICBqID0gMDsKCiAgICB3aGlsZSAoaSA8IDMyKSB7CiAgICAgIGhhc2hEYXRhW2krK10gPSBkZWZhdWx0UGFzc3dvcmRCeXRlc1tqKytdOwogICAgfQoKICAgIGZvciAoaiA9IDAsIG4gPSBvd25lclBhc3N3b3JkLmxlbmd0aDsgaiA8IG47ICsraikgewogICAgICBoYXNoRGF0YVtpKytdID0gb3duZXJQYXNzd29yZFtqXTsKICAgIH0KCiAgICBoYXNoRGF0YVtpKytdID0gZmxhZ3MgJiAweGZmOwogICAgaGFzaERhdGFbaSsrXSA9IGZsYWdzID4+IDggJiAweGZmOwogICAgaGFzaERhdGFbaSsrXSA9IGZsYWdzID4+IDE2ICYgMHhmZjsKICAgIGhhc2hEYXRhW2krK10gPSBmbGFncyA+Pj4gMjQgJiAweGZmOwoKICAgIGZvciAoaiA9IDAsIG4gPSBmaWxlSWQubGVuZ3RoOyBqIDwgbjsgKytqKSB7CiAgICAgIGhhc2hEYXRhW2krK10gPSBmaWxlSWRbal07CiAgICB9CgogICAgaWYgKHJldmlzaW9uID49IDQgJiYgIWVuY3J5cHRNZXRhZGF0YSkgewogICAgICBoYXNoRGF0YVtpKytdID0gMHhmZjsKICAgICAgaGFzaERhdGFbaSsrXSA9IDB4ZmY7CiAgICAgIGhhc2hEYXRhW2krK10gPSAweGZmOwogICAgICBoYXNoRGF0YVtpKytdID0gMHhmZjsKICAgIH0KCiAgICB2YXIgaGFzaCA9IGNhbGN1bGF0ZU1ENShoYXNoRGF0YSwgMCwgaSk7CiAgICB2YXIga2V5TGVuZ3RoSW5CeXRlcyA9IGtleUxlbmd0aCA+PiAzOwoKICAgIGlmIChyZXZpc2lvbiA+PSAzKSB7CiAgICAgIGZvciAoaiA9IDA7IGogPCA1MDsgKytqKSB7CiAgICAgICAgaGFzaCA9IGNhbGN1bGF0ZU1ENShoYXNoLCAwLCBrZXlMZW5ndGhJbkJ5dGVzKTsKICAgICAgfQogICAgfQoKICAgIHZhciBlbmNyeXB0aW9uS2V5ID0gaGFzaC5zdWJhcnJheSgwLCBrZXlMZW5ndGhJbkJ5dGVzKTsKICAgIHZhciBjaXBoZXIsIGNoZWNrRGF0YTsKCiAgICBpZiAocmV2aXNpb24gPj0gMykgewogICAgICBmb3IgKGkgPSAwOyBpIDwgMzI7ICsraSkgewogICAgICAgIGhhc2hEYXRhW2ldID0gZGVmYXVsdFBhc3N3b3JkQnl0ZXNbaV07CiAgICAgIH0KCiAgICAgIGZvciAoaiA9IDAsIG4gPSBmaWxlSWQubGVuZ3RoOyBqIDwgbjsgKytqKSB7CiAgICAgICAgaGFzaERhdGFbaSsrXSA9IGZpbGVJZFtqXTsKICAgICAgfQoKICAgICAgY2lwaGVyID0gbmV3IEFSQ0ZvdXJDaXBoZXIoZW5jcnlwdGlvbktleSk7CiAgICAgIGNoZWNrRGF0YSA9IGNpcGhlci5lbmNyeXB0QmxvY2soY2FsY3VsYXRlTUQ1KGhhc2hEYXRhLCAwLCBpKSk7CiAgICAgIG4gPSBlbmNyeXB0aW9uS2V5Lmxlbmd0aDsKICAgICAgdmFyIGRlcml2ZWRLZXkgPSBuZXcgVWludDhBcnJheShuKSwKICAgICAgICAgIGs7CgogICAgICBmb3IgKGogPSAxOyBqIDw9IDE5OyArK2opIHsKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgbjsgKytrKSB7CiAgICAgICAgICBkZXJpdmVkS2V5W2tdID0gZW5jcnlwdGlvbktleVtrXSBeIGo7CiAgICAgICAgfQoKICAgICAgICBjaXBoZXIgPSBuZXcgQVJDRm91ckNpcGhlcihkZXJpdmVkS2V5KTsKICAgICAgICBjaGVja0RhdGEgPSBjaXBoZXIuZW5jcnlwdEJsb2NrKGNoZWNrRGF0YSk7CiAgICAgIH0KCiAgICAgIGZvciAoaiA9IDAsIG4gPSBjaGVja0RhdGEubGVuZ3RoOyBqIDwgbjsgKytqKSB7CiAgICAgICAgaWYgKHVzZXJQYXNzd29yZFtqXSAhPT0gY2hlY2tEYXRhW2pdKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGNpcGhlciA9IG5ldyBBUkNGb3VyQ2lwaGVyKGVuY3J5cHRpb25LZXkpOwogICAgICBjaGVja0RhdGEgPSBjaXBoZXIuZW5jcnlwdEJsb2NrKGRlZmF1bHRQYXNzd29yZEJ5dGVzKTsKCiAgICAgIGZvciAoaiA9IDAsIG4gPSBjaGVja0RhdGEubGVuZ3RoOyBqIDwgbjsgKytqKSB7CiAgICAgICAgaWYgKHVzZXJQYXNzd29yZFtqXSAhPT0gY2hlY2tEYXRhW2pdKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZW5jcnlwdGlvbktleTsKICB9CgogIGZ1bmN0aW9uIGRlY29kZVVzZXJQYXNzd29yZChwYXNzd29yZCwgb3duZXJQYXNzd29yZCwgcmV2aXNpb24sIGtleUxlbmd0aCkgewogICAgdmFyIGhhc2hEYXRhID0gbmV3IFVpbnQ4QXJyYXkoMzIpLAogICAgICAgIGkgPSAwLAogICAgICAgIGosCiAgICAgICAgbjsKICAgIG4gPSBNYXRoLm1pbigzMiwgcGFzc3dvcmQubGVuZ3RoKTsKCiAgICBmb3IgKDsgaSA8IG47ICsraSkgewogICAgICBoYXNoRGF0YVtpXSA9IHBhc3N3b3JkW2ldOwogICAgfQoKICAgIGogPSAwOwoKICAgIHdoaWxlIChpIDwgMzIpIHsKICAgICAgaGFzaERhdGFbaSsrXSA9IGRlZmF1bHRQYXNzd29yZEJ5dGVzW2orK107CiAgICB9CgogICAgdmFyIGhhc2ggPSBjYWxjdWxhdGVNRDUoaGFzaERhdGEsIDAsIGkpOwogICAgdmFyIGtleUxlbmd0aEluQnl0ZXMgPSBrZXlMZW5ndGggPj4gMzsKCiAgICBpZiAocmV2aXNpb24gPj0gMykgewogICAgICBmb3IgKGogPSAwOyBqIDwgNTA7ICsraikgewogICAgICAgIGhhc2ggPSBjYWxjdWxhdGVNRDUoaGFzaCwgMCwgaGFzaC5sZW5ndGgpOwogICAgICB9CiAgICB9CgogICAgdmFyIGNpcGhlciwgdXNlclBhc3N3b3JkOwoKICAgIGlmIChyZXZpc2lvbiA+PSAzKSB7CiAgICAgIHVzZXJQYXNzd29yZCA9IG93bmVyUGFzc3dvcmQ7CiAgICAgIHZhciBkZXJpdmVkS2V5ID0gbmV3IFVpbnQ4QXJyYXkoa2V5TGVuZ3RoSW5CeXRlcyksCiAgICAgICAgICBrOwoKICAgICAgZm9yIChqID0gMTk7IGogPj0gMDsgai0tKSB7CiAgICAgICAgZm9yIChrID0gMDsgayA8IGtleUxlbmd0aEluQnl0ZXM7ICsraykgewogICAgICAgICAgZGVyaXZlZEtleVtrXSA9IGhhc2hba10gXiBqOwogICAgICAgIH0KCiAgICAgICAgY2lwaGVyID0gbmV3IEFSQ0ZvdXJDaXBoZXIoZGVyaXZlZEtleSk7CiAgICAgICAgdXNlclBhc3N3b3JkID0gY2lwaGVyLmVuY3J5cHRCbG9jayh1c2VyUGFzc3dvcmQpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjaXBoZXIgPSBuZXcgQVJDRm91ckNpcGhlcihoYXNoLnN1YmFycmF5KDAsIGtleUxlbmd0aEluQnl0ZXMpKTsKICAgICAgdXNlclBhc3N3b3JkID0gY2lwaGVyLmVuY3J5cHRCbG9jayhvd25lclBhc3N3b3JkKTsKICAgIH0KCiAgICByZXR1cm4gdXNlclBhc3N3b3JkOwogIH0KCiAgdmFyIGlkZW50aXR5TmFtZSA9IF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJJZGVudGl0eSIpOwoKICBmdW5jdGlvbiBDaXBoZXJUcmFuc2Zvcm1GYWN0b3J5KGRpY3QsIGZpbGVJZCwgcGFzc3dvcmQpIHsKICAgIHZhciBmaWx0ZXIgPSBkaWN0LmdldCgiRmlsdGVyIik7CgogICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShmaWx0ZXIsICJTdGFuZGFyZCIpKSB7CiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigidW5rbm93biBlbmNyeXB0aW9uIG1ldGhvZCIpOwogICAgfQoKICAgIHRoaXMuZGljdCA9IGRpY3Q7CiAgICB2YXIgYWxnb3JpdGhtID0gZGljdC5nZXQoIlYiKTsKCiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoYWxnb3JpdGhtKSB8fCBhbGdvcml0aG0gIT09IDEgJiYgYWxnb3JpdGhtICE9PSAyICYmIGFsZ29yaXRobSAhPT0gNCAmJiBhbGdvcml0aG0gIT09IDUpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ1bnN1cHBvcnRlZCBlbmNyeXB0aW9uIGFsZ29yaXRobSIpOwogICAgfQoKICAgIHRoaXMuYWxnb3JpdGhtID0gYWxnb3JpdGhtOwogICAgdmFyIGtleUxlbmd0aCA9IGRpY3QuZ2V0KCJMZW5ndGgiKTsKCiAgICBpZiAoIWtleUxlbmd0aCkgewogICAgICBpZiAoYWxnb3JpdGhtIDw9IDMpIHsKICAgICAgICBrZXlMZW5ndGggPSA0MDsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgY2ZEaWN0ID0gZGljdC5nZXQoIkNGIik7CiAgICAgICAgdmFyIHN0cmVhbUNyeXB0b05hbWUgPSBkaWN0LmdldCgiU3RtRiIpOwoKICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoY2ZEaWN0KSAmJiAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShzdHJlYW1DcnlwdG9OYW1lKSkgewogICAgICAgICAgY2ZEaWN0LnN1cHByZXNzRW5jcnlwdGlvbiA9IHRydWU7CiAgICAgICAgICB2YXIgaGFuZGxlckRpY3QgPSBjZkRpY3QuZ2V0KHN0cmVhbUNyeXB0b05hbWUubmFtZSk7CiAgICAgICAgICBrZXlMZW5ndGggPSBoYW5kbGVyRGljdCAmJiBoYW5kbGVyRGljdC5nZXQoIkxlbmd0aCIpIHx8IDEyODsKCiAgICAgICAgICBpZiAoa2V5TGVuZ3RoIDwgNDApIHsKICAgICAgICAgICAga2V5TGVuZ3RoIDw8PSAzOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihrZXlMZW5ndGgpIHx8IGtleUxlbmd0aCA8IDQwIHx8IGtleUxlbmd0aCAlIDggIT09IDApIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJpbnZhbGlkIGtleSBsZW5ndGgiKTsKICAgIH0KCiAgICB2YXIgb3duZXJQYXNzd29yZCA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiTyIpKS5zdWJhcnJheSgwLCAzMik7CiAgICB2YXIgdXNlclBhc3N3b3JkID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJVIikpLnN1YmFycmF5KDAsIDMyKTsKICAgIHZhciBmbGFncyA9IGRpY3QuZ2V0KCJQIik7CiAgICB2YXIgcmV2aXNpb24gPSBkaWN0LmdldCgiUiIpOwogICAgdmFyIGVuY3J5cHRNZXRhZGF0YSA9IChhbGdvcml0aG0gPT09IDQgfHwgYWxnb3JpdGhtID09PSA1KSAmJiBkaWN0LmdldCgiRW5jcnlwdE1ldGFkYXRhIikgIT09IGZhbHNlOwogICAgdGhpcy5lbmNyeXB0TWV0YWRhdGEgPSBlbmNyeXB0TWV0YWRhdGE7CiAgICB2YXIgZmlsZUlkQnl0ZXMgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZmlsZUlkKTsKICAgIHZhciBwYXNzd29yZEJ5dGVzOwoKICAgIGlmIChwYXNzd29yZCkgewogICAgICBpZiAocmV2aXNpb24gPT09IDYpIHsKICAgICAgICB0cnkgewogICAgICAgICAgcGFzc3dvcmQgPSAoMCwgX3V0aWwudXRmOFN0cmluZ1RvU3RyaW5nKShwYXNzd29yZCk7CiAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeTogIiArICJVbmFibGUgdG8gY29udmVydCBVVEY4IGVuY29kZWQgcGFzc3dvcmQuIik7CiAgICAgICAgfQogICAgICB9CgogICAgICBwYXNzd29yZEJ5dGVzID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKHBhc3N3b3JkKTsKICAgIH0KCiAgICB2YXIgZW5jcnlwdGlvbktleTsKCiAgICBpZiAoYWxnb3JpdGhtICE9PSA1KSB7CiAgICAgIGVuY3J5cHRpb25LZXkgPSBwcmVwYXJlS2V5RGF0YShmaWxlSWRCeXRlcywgcGFzc3dvcmRCeXRlcywgb3duZXJQYXNzd29yZCwgdXNlclBhc3N3b3JkLCBmbGFncywgcmV2aXNpb24sIGtleUxlbmd0aCwgZW5jcnlwdE1ldGFkYXRhKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBvd25lclZhbGlkYXRpb25TYWx0ID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJPIikpLnN1YmFycmF5KDMyLCA0MCk7CiAgICAgIHZhciBvd25lcktleVNhbHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIk8iKSkuc3ViYXJyYXkoNDAsIDQ4KTsKICAgICAgdmFyIHVCeXRlcyA9ICgwLCBfdXRpbC5zdHJpbmdUb0J5dGVzKShkaWN0LmdldCgiVSIpKS5zdWJhcnJheSgwLCA0OCk7CiAgICAgIHZhciB1c2VyVmFsaWRhdGlvblNhbHQgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIlUiKSkuc3ViYXJyYXkoMzIsIDQwKTsKICAgICAgdmFyIHVzZXJLZXlTYWx0ID0gKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKGRpY3QuZ2V0KCJVIikpLnN1YmFycmF5KDQwLCA0OCk7CiAgICAgIHZhciBvd25lckVuY3J5cHRpb24gPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIk9FIikpOwogICAgICB2YXIgdXNlckVuY3J5cHRpb24gPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIlVFIikpOwogICAgICB2YXIgcGVybXMgPSAoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoZGljdC5nZXQoIlBlcm1zIikpOwogICAgICBlbmNyeXB0aW9uS2V5ID0gY3JlYXRlRW5jcnlwdGlvbktleTIwKHJldmlzaW9uLCBwYXNzd29yZEJ5dGVzLCBvd25lclBhc3N3b3JkLCBvd25lclZhbGlkYXRpb25TYWx0LCBvd25lcktleVNhbHQsIHVCeXRlcywgdXNlclBhc3N3b3JkLCB1c2VyVmFsaWRhdGlvblNhbHQsIHVzZXJLZXlTYWx0LCBvd25lckVuY3J5cHRpb24sIHVzZXJFbmNyeXB0aW9uLCBwZXJtcyk7CiAgICB9CgogICAgaWYgKCFlbmNyeXB0aW9uS2V5ICYmICFwYXNzd29yZCkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuUGFzc3dvcmRFeGNlcHRpb24oIk5vIHBhc3N3b3JkIGdpdmVuIiwgX3V0aWwuUGFzc3dvcmRSZXNwb25zZXMuTkVFRF9QQVNTV09SRCk7CiAgICB9IGVsc2UgaWYgKCFlbmNyeXB0aW9uS2V5ICYmIHBhc3N3b3JkKSB7CiAgICAgIHZhciBkZWNvZGVkUGFzc3dvcmQgPSBkZWNvZGVVc2VyUGFzc3dvcmQocGFzc3dvcmRCeXRlcywgb3duZXJQYXNzd29yZCwgcmV2aXNpb24sIGtleUxlbmd0aCk7CiAgICAgIGVuY3J5cHRpb25LZXkgPSBwcmVwYXJlS2V5RGF0YShmaWxlSWRCeXRlcywgZGVjb2RlZFBhc3N3b3JkLCBvd25lclBhc3N3b3JkLCB1c2VyUGFzc3dvcmQsIGZsYWdzLCByZXZpc2lvbiwga2V5TGVuZ3RoLCBlbmNyeXB0TWV0YWRhdGEpOwogICAgfQoKICAgIGlmICghZW5jcnlwdGlvbktleSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuUGFzc3dvcmRFeGNlcHRpb24oIkluY29ycmVjdCBQYXNzd29yZCIsIF91dGlsLlBhc3N3b3JkUmVzcG9uc2VzLklOQ09SUkVDVF9QQVNTV09SRCk7CiAgICB9CgogICAgdGhpcy5lbmNyeXB0aW9uS2V5ID0gZW5jcnlwdGlvbktleTsKCiAgICBpZiAoYWxnb3JpdGhtID49IDQpIHsKICAgICAgdmFyIGNmID0gZGljdC5nZXQoIkNGIik7CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoY2YpKSB7CiAgICAgICAgY2Yuc3VwcHJlc3NFbmNyeXB0aW9uID0gdHJ1ZTsKICAgICAgfQoKICAgICAgdGhpcy5jZiA9IGNmOwogICAgICB0aGlzLnN0bWYgPSBkaWN0LmdldCgiU3RtRiIpIHx8IGlkZW50aXR5TmFtZTsKICAgICAgdGhpcy5zdHJmID0gZGljdC5nZXQoIlN0ckYiKSB8fCBpZGVudGl0eU5hbWU7CiAgICAgIHRoaXMuZWZmID0gZGljdC5nZXQoIkVGRiIpIHx8IHRoaXMuc3RtZjsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGJ1aWxkT2JqZWN0S2V5KG51bSwgZ2VuLCBlbmNyeXB0aW9uS2V5LCBpc0FlcykgewogICAgdmFyIGtleSA9IG5ldyBVaW50OEFycmF5KGVuY3J5cHRpb25LZXkubGVuZ3RoICsgOSksCiAgICAgICAgaSwKICAgICAgICBuOwoKICAgIGZvciAoaSA9IDAsIG4gPSBlbmNyeXB0aW9uS2V5Lmxlbmd0aDsgaSA8IG47ICsraSkgewogICAgICBrZXlbaV0gPSBlbmNyeXB0aW9uS2V5W2ldOwogICAgfQoKICAgIGtleVtpKytdID0gbnVtICYgMHhmZjsKICAgIGtleVtpKytdID0gbnVtID4+IDggJiAweGZmOwogICAga2V5W2krK10gPSBudW0gPj4gMTYgJiAweGZmOwogICAga2V5W2krK10gPSBnZW4gJiAweGZmOwogICAga2V5W2krK10gPSBnZW4gPj4gOCAmIDB4ZmY7CgogICAgaWYgKGlzQWVzKSB7CiAgICAgIGtleVtpKytdID0gMHg3MzsKICAgICAga2V5W2krK10gPSAweDQxOwogICAgICBrZXlbaSsrXSA9IDB4NmM7CiAgICAgIGtleVtpKytdID0gMHg1NDsKICAgIH0KCiAgICB2YXIgaGFzaCA9IGNhbGN1bGF0ZU1ENShrZXksIDAsIGkpOwogICAgcmV0dXJuIGhhc2guc3ViYXJyYXkoMCwgTWF0aC5taW4oZW5jcnlwdGlvbktleS5sZW5ndGggKyA1LCAxNikpOwogIH0KCiAgZnVuY3Rpb24gYnVpbGRDaXBoZXJDb25zdHJ1Y3RvcihjZiwgbmFtZSwgbnVtLCBnZW4sIGtleSkgewogICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShuYW1lKSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgY3J5cHQgZmlsdGVyIG5hbWUuIik7CiAgICB9CgogICAgdmFyIGNyeXB0RmlsdGVyID0gY2YuZ2V0KG5hbWUubmFtZSk7CiAgICB2YXIgY2ZtOwoKICAgIGlmIChjcnlwdEZpbHRlciAhPT0gbnVsbCAmJiBjcnlwdEZpbHRlciAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGNmbSA9IGNyeXB0RmlsdGVyLmdldCgiQ0ZNIik7CiAgICB9CgogICAgaWYgKCFjZm0gfHwgY2ZtLm5hbWUgPT09ICJOb25lIikgewogICAgICByZXR1cm4gZnVuY3Rpb24gY2lwaGVyVHJhbnNmb3JtRmFjdG9yeUJ1aWxkQ2lwaGVyQ29uc3RydWN0b3JOb25lKCkgewogICAgICAgIHJldHVybiBuZXcgTnVsbENpcGhlcigpOwogICAgICB9OwogICAgfQoKICAgIGlmIChjZm0ubmFtZSA9PT0gIlYyIikgewogICAgICByZXR1cm4gZnVuY3Rpb24gY2lwaGVyVHJhbnNmb3JtRmFjdG9yeUJ1aWxkQ2lwaGVyQ29uc3RydWN0b3JWMigpIHsKICAgICAgICByZXR1cm4gbmV3IEFSQ0ZvdXJDaXBoZXIoYnVpbGRPYmplY3RLZXkobnVtLCBnZW4sIGtleSwgZmFsc2UpKTsKICAgICAgfTsKICAgIH0KCiAgICBpZiAoY2ZtLm5hbWUgPT09ICJBRVNWMiIpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIGNpcGhlclRyYW5zZm9ybUZhY3RvcnlCdWlsZENpcGhlckNvbnN0cnVjdG9yQUVTVjIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBRVMxMjhDaXBoZXIoYnVpbGRPYmplY3RLZXkobnVtLCBnZW4sIGtleSwgdHJ1ZSkpOwogICAgICB9OwogICAgfQoKICAgIGlmIChjZm0ubmFtZSA9PT0gIkFFU1YzIikgewogICAgICByZXR1cm4gZnVuY3Rpb24gY2lwaGVyVHJhbnNmb3JtRmFjdG9yeUJ1aWxkQ2lwaGVyQ29uc3RydWN0b3JBRVNWMygpIHsKICAgICAgICByZXR1cm4gbmV3IEFFUzI1NkNpcGhlcihrZXkpOwogICAgICB9OwogICAgfQoKICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biBjcnlwdG8gbWV0aG9kIik7CiAgfQoKICBDaXBoZXJUcmFuc2Zvcm1GYWN0b3J5LnByb3RvdHlwZSA9IHsKICAgIGNyZWF0ZUNpcGhlclRyYW5zZm9ybTogZnVuY3Rpb24gQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeV9jcmVhdGVDaXBoZXJUcmFuc2Zvcm0obnVtLCBnZW4pIHsKICAgICAgaWYgKHRoaXMuYWxnb3JpdGhtID09PSA0IHx8IHRoaXMuYWxnb3JpdGhtID09PSA1KSB7CiAgICAgICAgcmV0dXJuIG5ldyBDaXBoZXJUcmFuc2Zvcm0oYnVpbGRDaXBoZXJDb25zdHJ1Y3Rvcih0aGlzLmNmLCB0aGlzLnN0bWYsIG51bSwgZ2VuLCB0aGlzLmVuY3J5cHRpb25LZXkpLCBidWlsZENpcGhlckNvbnN0cnVjdG9yKHRoaXMuY2YsIHRoaXMuc3RyZiwgbnVtLCBnZW4sIHRoaXMuZW5jcnlwdGlvbktleSkpOwogICAgICB9CgogICAgICB2YXIga2V5ID0gYnVpbGRPYmplY3RLZXkobnVtLCBnZW4sIHRoaXMuZW5jcnlwdGlvbktleSwgZmFsc2UpOwoKICAgICAgdmFyIGNpcGhlckNvbnN0cnVjdG9yID0gZnVuY3Rpb24gYnVpbGRDaXBoZXJDaXBoZXJDb25zdHJ1Y3RvcigpIHsKICAgICAgICByZXR1cm4gbmV3IEFSQ0ZvdXJDaXBoZXIoa2V5KTsKICAgICAgfTsKCiAgICAgIHJldHVybiBuZXcgQ2lwaGVyVHJhbnNmb3JtKGNpcGhlckNvbnN0cnVjdG9yLCBjaXBoZXJDb25zdHJ1Y3Rvcik7CiAgICB9CiAgfTsKICByZXR1cm4gQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeTsKfSgpOwoKZXhwb3J0cy5DaXBoZXJUcmFuc2Zvcm1GYWN0b3J5ID0gQ2lwaGVyVHJhbnNmb3JtRmFjdG9yeTsKCi8qKiovIH0pLAovKiAyMTYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5Db2xvclNwYWNlID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOyB0cnkgeyBEYXRlLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKFJlZmxlY3QuY29uc3RydWN0KERhdGUsIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCmZ1bmN0aW9uIHJlc2l6ZVJnYkltYWdlKHNyYywgZGVzdCwgdzEsIGgxLCB3MiwgaDIsIGFscGhhMDEpIHsKICB2YXIgQ09NUE9ORU5UUyA9IDM7CiAgYWxwaGEwMSA9IGFscGhhMDEgIT09IDEgPyAwIDogYWxwaGEwMTsKICB2YXIgeFJhdGlvID0gdzEgLyB3MjsKICB2YXIgeVJhdGlvID0gaDEgLyBoMjsKICB2YXIgbmV3SW5kZXggPSAwLAogICAgICBvbGRJbmRleDsKICB2YXIgeFNjYWxlZCA9IG5ldyBVaW50MTZBcnJheSh3Mik7CiAgdmFyIHcxU2NhbmxpbmUgPSB3MSAqIENPTVBPTkVOVFM7CgogIGZvciAodmFyIGkgPSAwOyBpIDwgdzI7IGkrKykgewogICAgeFNjYWxlZFtpXSA9IE1hdGguZmxvb3IoaSAqIHhSYXRpbykgKiBDT01QT05FTlRTOwogIH0KCiAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGgyOyBfaSsrKSB7CiAgICB2YXIgcHkgPSBNYXRoLmZsb29yKF9pICogeVJhdGlvKSAqIHcxU2NhbmxpbmU7CgogICAgZm9yICh2YXIgaiA9IDA7IGogPCB3MjsgaisrKSB7CiAgICAgIG9sZEluZGV4ID0gcHkgKyB4U2NhbGVkW2pdOwogICAgICBkZXN0W25ld0luZGV4KytdID0gc3JjW29sZEluZGV4KytdOwogICAgICBkZXN0W25ld0luZGV4KytdID0gc3JjW29sZEluZGV4KytdOwogICAgICBkZXN0W25ld0luZGV4KytdID0gc3JjW29sZEluZGV4KytdOwogICAgICBuZXdJbmRleCArPSBhbHBoYTAxOwogICAgfQogIH0KfQoKdmFyIENvbG9yU3BhY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbG9yU3BhY2UobmFtZSwgbnVtQ29tcHMpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb2xvclNwYWNlKTsKCiAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gQ29sb3JTcGFjZSkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJDYW5ub3QgaW5pdGlhbGl6ZSBDb2xvclNwYWNlLiIpOwogICAgfQoKICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICB0aGlzLm51bUNvbXBzID0gbnVtQ29tcHM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQ29sb3JTcGFjZSwgW3sKICAgIGtleTogImdldFJnYiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmdiKHNyYywgc3JjT2Zmc2V0KSB7CiAgICAgIHZhciByZ2IgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoMyk7CiAgICAgIHRoaXMuZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgcmdiLCAwKTsKICAgICAgcmV0dXJuIHJnYjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRSZ2JJdGVtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZ2JJdGVtKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBDb2xvclNwYWNlLmdldFJnYkl0ZW0iKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRSZ2JCdWZmZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiU2hvdWxkIG5vdCBjYWxsIENvbG9yU3BhY2UuZ2V0UmdiQnVmZmVyIik7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0T3V0cHV0TGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiU2hvdWxkIG5vdCBjYWxsIENvbG9yU3BhY2UuZ2V0T3V0cHV0TGVuZ3RoIik7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNQYXNzdGhyb3VnaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNQYXNzdGhyb3VnaChiaXRzKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0RlZmF1bHREZWNvZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzRGVmYXVsdERlY29kZShkZWNvZGVNYXAsIGJwYykgewogICAgICByZXR1cm4gQ29sb3JTcGFjZS5pc0RlZmF1bHREZWNvZGUoZGVjb2RlTWFwLCB0aGlzLm51bUNvbXBzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaWxsUmdiIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaWxsUmdiKGRlc3QsIG9yaWdpbmFsV2lkdGgsIG9yaWdpbmFsSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBhY3R1YWxIZWlnaHQsIGJwYywgY29tcHMsIGFscGhhMDEpIHsKICAgICAgdmFyIGNvdW50ID0gb3JpZ2luYWxXaWR0aCAqIG9yaWdpbmFsSGVpZ2h0OwogICAgICB2YXIgcmdiQnVmID0gbnVsbDsKICAgICAgdmFyIG51bUNvbXBvbmVudENvbG9ycyA9IDEgPDwgYnBjOwogICAgICB2YXIgbmVlZHNSZXNpemluZyA9IG9yaWdpbmFsSGVpZ2h0ICE9PSBoZWlnaHQgfHwgb3JpZ2luYWxXaWR0aCAhPT0gd2lkdGg7CgogICAgICBpZiAodGhpcy5pc1Bhc3N0aHJvdWdoKGJwYykpIHsKICAgICAgICByZ2JCdWYgPSBjb21wczsKICAgICAgfSBlbHNlIGlmICh0aGlzLm51bUNvbXBzID09PSAxICYmIGNvdW50ID4gbnVtQ29tcG9uZW50Q29sb3JzICYmIHRoaXMubmFtZSAhPT0gIkRldmljZUdyYXkiICYmIHRoaXMubmFtZSAhPT0gIkRldmljZVJHQiIpIHsKICAgICAgICB2YXIgYWxsQ29sb3JzID0gYnBjIDw9IDggPyBuZXcgVWludDhBcnJheShudW1Db21wb25lbnRDb2xvcnMpIDogbmV3IFVpbnQxNkFycmF5KG51bUNvbXBvbmVudENvbG9ycyk7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQ29tcG9uZW50Q29sb3JzOyBpKyspIHsKICAgICAgICAgIGFsbENvbG9yc1tpXSA9IGk7CiAgICAgICAgfQoKICAgICAgICB2YXIgY29sb3JNYXAgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobnVtQ29tcG9uZW50Q29sb3JzICogMyk7CiAgICAgICAgdGhpcy5nZXRSZ2JCdWZmZXIoYWxsQ29sb3JzLCAwLCBudW1Db21wb25lbnRDb2xvcnMsIGNvbG9yTWFwLCAwLCBicGMsIDApOwoKICAgICAgICBpZiAoIW5lZWRzUmVzaXppbmcpIHsKICAgICAgICAgIHZhciBkZXN0UG9zID0gMDsKCiAgICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBjb3VudDsgKytfaTIpIHsKICAgICAgICAgICAgdmFyIGtleSA9IGNvbXBzW19pMl0gKiAzOwogICAgICAgICAgICBkZXN0W2Rlc3RQb3MrK10gPSBjb2xvck1hcFtrZXldOwogICAgICAgICAgICBkZXN0W2Rlc3RQb3MrK10gPSBjb2xvck1hcFtrZXkgKyAxXTsKICAgICAgICAgICAgZGVzdFtkZXN0UG9zKytdID0gY29sb3JNYXBba2V5ICsgMl07CiAgICAgICAgICAgIGRlc3RQb3MgKz0gYWxwaGEwMTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmdiQnVmID0gbmV3IFVpbnQ4QXJyYXkoY291bnQgKiAzKTsKICAgICAgICAgIHZhciByZ2JQb3MgPSAwOwoKICAgICAgICAgIGZvciAodmFyIF9pMyA9IDA7IF9pMyA8IGNvdW50OyArK19pMykgewogICAgICAgICAgICB2YXIgX2tleSA9IGNvbXBzW19pM10gKiAzOwoKICAgICAgICAgICAgcmdiQnVmW3JnYlBvcysrXSA9IGNvbG9yTWFwW19rZXldOwogICAgICAgICAgICByZ2JCdWZbcmdiUG9zKytdID0gY29sb3JNYXBbX2tleSArIDFdOwogICAgICAgICAgICByZ2JCdWZbcmdiUG9zKytdID0gY29sb3JNYXBbX2tleSArIDJdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIW5lZWRzUmVzaXppbmcpIHsKICAgICAgICAgIHRoaXMuZ2V0UmdiQnVmZmVyKGNvbXBzLCAwLCB3aWR0aCAqIGFjdHVhbEhlaWdodCwgZGVzdCwgMCwgYnBjLCBhbHBoYTAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmdiQnVmID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGNvdW50ICogMyk7CiAgICAgICAgICB0aGlzLmdldFJnYkJ1ZmZlcihjb21wcywgMCwgY291bnQsIHJnYkJ1ZiwgMCwgYnBjLCAwKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChyZ2JCdWYpIHsKICAgICAgICBpZiAobmVlZHNSZXNpemluZykgewogICAgICAgICAgcmVzaXplUmdiSW1hZ2UocmdiQnVmLCBkZXN0LCBvcmlnaW5hbFdpZHRoLCBvcmlnaW5hbEhlaWdodCwgd2lkdGgsIGhlaWdodCwgYWxwaGEwMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBfZGVzdFBvcyA9IDAsCiAgICAgICAgICAgICAgX3JnYlBvcyA9IDA7CgogICAgICAgICAgZm9yICh2YXIgX2k0ID0gMCwgaWkgPSB3aWR0aCAqIGFjdHVhbEhlaWdodDsgX2k0IDwgaWk7IF9pNCsrKSB7CiAgICAgICAgICAgIGRlc3RbX2Rlc3RQb3MrK10gPSByZ2JCdWZbX3JnYlBvcysrXTsKICAgICAgICAgICAgZGVzdFtfZGVzdFBvcysrXSA9IHJnYkJ1ZltfcmdiUG9zKytdOwogICAgICAgICAgICBkZXN0W19kZXN0UG9zKytdID0gcmdiQnVmW19yZ2JQb3MrK107CiAgICAgICAgICAgIF9kZXN0UG9zICs9IGFscGhhMDE7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAidXNlc1plcm9Ub09uZVJhbmdlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInVzZXNaZXJvVG9PbmVSYW5nZSIsIHRydWUpOwogICAgfQogIH1dLCBbewogICAga2V5OiAicGFyc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlKGNzLCB4cmVmLCByZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSkgewogICAgICB2YXIgSVIgPSB0aGlzLnBhcnNlVG9JUihjcywgeHJlZiwgcmVzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwogICAgICByZXR1cm4gdGhpcy5mcm9tSVIoSVIpOwogICAgfQogIH0sIHsKICAgIGtleTogImZyb21JUiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZnJvbUlSKElSKSB7CiAgICAgIHZhciBuYW1lID0gQXJyYXkuaXNBcnJheShJUikgPyBJUlswXSA6IElSOwogICAgICB2YXIgd2hpdGVQb2ludCwgYmxhY2tQb2ludCwgZ2FtbWE7CgogICAgICBzd2l0Y2ggKG5hbWUpIHsKICAgICAgICBjYXNlICJEZXZpY2VHcmF5Q1MiOgogICAgICAgICAgcmV0dXJuIHRoaXMuc2luZ2xldG9ucy5ncmF5OwoKICAgICAgICBjYXNlICJEZXZpY2VSZ2JDUyI6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaW5nbGV0b25zLnJnYjsKCiAgICAgICAgY2FzZSAiRGV2aWNlQ215a0NTIjoKICAgICAgICAgIHJldHVybiB0aGlzLnNpbmdsZXRvbnMuY215azsKCiAgICAgICAgY2FzZSAiQ2FsR3JheUNTIjoKICAgICAgICAgIHdoaXRlUG9pbnQgPSBJUlsxXTsKICAgICAgICAgIGJsYWNrUG9pbnQgPSBJUlsyXTsKICAgICAgICAgIGdhbW1hID0gSVJbM107CiAgICAgICAgICByZXR1cm4gbmV3IENhbEdyYXlDUyh3aGl0ZVBvaW50LCBibGFja1BvaW50LCBnYW1tYSk7CgogICAgICAgIGNhc2UgIkNhbFJHQkNTIjoKICAgICAgICAgIHdoaXRlUG9pbnQgPSBJUlsxXTsKICAgICAgICAgIGJsYWNrUG9pbnQgPSBJUlsyXTsKICAgICAgICAgIGdhbW1hID0gSVJbM107CiAgICAgICAgICB2YXIgbWF0cml4ID0gSVJbNF07CiAgICAgICAgICByZXR1cm4gbmV3IENhbFJHQkNTKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIGdhbW1hLCBtYXRyaXgpOwoKICAgICAgICBjYXNlICJQYXR0ZXJuQ1MiOgogICAgICAgICAgdmFyIGJhc2VQYXR0ZXJuQ1MgPSBJUlsxXTsKCiAgICAgICAgICBpZiAoYmFzZVBhdHRlcm5DUykgewogICAgICAgICAgICBiYXNlUGF0dGVybkNTID0gdGhpcy5mcm9tSVIoYmFzZVBhdHRlcm5DUyk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG5ldyBQYXR0ZXJuQ1MoYmFzZVBhdHRlcm5DUyk7CgogICAgICAgIGNhc2UgIkluZGV4ZWRDUyI6CiAgICAgICAgICB2YXIgYmFzZUluZGV4ZWRDUyA9IElSWzFdOwogICAgICAgICAgdmFyIGhpVmFsID0gSVJbMl07CiAgICAgICAgICB2YXIgbG9va3VwID0gSVJbM107CiAgICAgICAgICByZXR1cm4gbmV3IEluZGV4ZWRDUyh0aGlzLmZyb21JUihiYXNlSW5kZXhlZENTKSwgaGlWYWwsIGxvb2t1cCk7CgogICAgICAgIGNhc2UgIkFsdGVybmF0ZUNTIjoKICAgICAgICAgIHZhciBudW1Db21wcyA9IElSWzFdOwogICAgICAgICAgdmFyIGFsdCA9IElSWzJdOwogICAgICAgICAgdmFyIHRpbnRGbiA9IElSWzNdOwogICAgICAgICAgcmV0dXJuIG5ldyBBbHRlcm5hdGVDUyhudW1Db21wcywgdGhpcy5mcm9tSVIoYWx0KSwgdGludEZuKTsKCiAgICAgICAgY2FzZSAiTGFiQ1MiOgogICAgICAgICAgd2hpdGVQb2ludCA9IElSWzFdOwogICAgICAgICAgYmxhY2tQb2ludCA9IElSWzJdOwogICAgICAgICAgdmFyIHJhbmdlID0gSVJbM107CiAgICAgICAgICByZXR1cm4gbmV3IExhYkNTKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIHJhbmdlKTsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biBjb2xvcnNwYWNlIG5hbWU6ICIuY29uY2F0KG5hbWUpKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInBhcnNlVG9JUiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VUb0lSKGNzLCB4cmVmKSB7CiAgICAgIHZhciByZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IG51bGw7CiAgICAgIHZhciBwZGZGdW5jdGlvbkZhY3RvcnkgPSBhcmd1bWVudHMubGVuZ3RoID4gMyA/IGFyZ3VtZW50c1szXSA6IHVuZGVmaW5lZDsKICAgICAgY3MgPSB4cmVmLmZldGNoSWZSZWYoY3MpOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGNzKSkgewogICAgICAgIHN3aXRjaCAoY3MubmFtZSkgewogICAgICAgICAgY2FzZSAiRGV2aWNlR3JheSI6CiAgICAgICAgICBjYXNlICJHIjoKICAgICAgICAgICAgcmV0dXJuICJEZXZpY2VHcmF5Q1MiOwoKICAgICAgICAgIGNhc2UgIkRldmljZVJHQiI6CiAgICAgICAgICBjYXNlICJSR0IiOgogICAgICAgICAgICByZXR1cm4gIkRldmljZVJnYkNTIjsKCiAgICAgICAgICBjYXNlICJEZXZpY2VDTVlLIjoKICAgICAgICAgIGNhc2UgIkNNWUsiOgogICAgICAgICAgICByZXR1cm4gIkRldmljZUNteWtDUyI7CgogICAgICAgICAgY2FzZSAiUGF0dGVybiI6CiAgICAgICAgICAgIHJldHVybiBbIlBhdHRlcm5DUyIsIG51bGxdOwoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShyZXMpKSB7CiAgICAgICAgICAgICAgdmFyIGNvbG9yU3BhY2VzID0gcmVzLmdldCgiQ29sb3JTcGFjZSIpOwoKICAgICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoY29sb3JTcGFjZXMpKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVzQ1MgPSBjb2xvclNwYWNlcy5nZXQoY3MubmFtZSk7CgogICAgICAgICAgICAgICAgaWYgKHJlc0NTKSB7CiAgICAgICAgICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShyZXNDUykpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZVRvSVIocmVzQ1MsIHhyZWYsIHJlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgY3MgPSByZXNDUzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoInVucmVjb2duaXplZCBjb2xvcnNwYWNlICIuY29uY2F0KGNzLm5hbWUpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNzKSkgewogICAgICAgIHZhciBtb2RlID0geHJlZi5mZXRjaElmUmVmKGNzWzBdKS5uYW1lOwogICAgICAgIHZhciBudW1Db21wcywgcGFyYW1zLCBhbHQsIHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIGdhbW1hOwoKICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKICAgICAgICAgIGNhc2UgIkRldmljZUdyYXkiOgogICAgICAgICAgY2FzZSAiRyI6CiAgICAgICAgICAgIHJldHVybiAiRGV2aWNlR3JheUNTIjsKCiAgICAgICAgICBjYXNlICJEZXZpY2VSR0IiOgogICAgICAgICAgY2FzZSAiUkdCIjoKICAgICAgICAgICAgcmV0dXJuICJEZXZpY2VSZ2JDUyI7CgogICAgICAgICAgY2FzZSAiRGV2aWNlQ01ZSyI6CiAgICAgICAgICBjYXNlICJDTVlLIjoKICAgICAgICAgICAgcmV0dXJuICJEZXZpY2VDbXlrQ1MiOwoKICAgICAgICAgIGNhc2UgIkNhbEdyYXkiOgogICAgICAgICAgICBwYXJhbXMgPSB4cmVmLmZldGNoSWZSZWYoY3NbMV0pOwogICAgICAgICAgICB3aGl0ZVBvaW50ID0gcGFyYW1zLmdldEFycmF5KCJXaGl0ZVBvaW50Iik7CiAgICAgICAgICAgIGJsYWNrUG9pbnQgPSBwYXJhbXMuZ2V0QXJyYXkoIkJsYWNrUG9pbnQiKTsKICAgICAgICAgICAgZ2FtbWEgPSBwYXJhbXMuZ2V0KCJHYW1tYSIpOwogICAgICAgICAgICByZXR1cm4gWyJDYWxHcmF5Q1MiLCB3aGl0ZVBvaW50LCBibGFja1BvaW50LCBnYW1tYV07CgogICAgICAgICAgY2FzZSAiQ2FsUkdCIjoKICAgICAgICAgICAgcGFyYW1zID0geHJlZi5mZXRjaElmUmVmKGNzWzFdKTsKICAgICAgICAgICAgd2hpdGVQb2ludCA9IHBhcmFtcy5nZXRBcnJheSgiV2hpdGVQb2ludCIpOwogICAgICAgICAgICBibGFja1BvaW50ID0gcGFyYW1zLmdldEFycmF5KCJCbGFja1BvaW50Iik7CiAgICAgICAgICAgIGdhbW1hID0gcGFyYW1zLmdldEFycmF5KCJHYW1tYSIpOwogICAgICAgICAgICB2YXIgbWF0cml4ID0gcGFyYW1zLmdldEFycmF5KCJNYXRyaXgiKTsKICAgICAgICAgICAgcmV0dXJuIFsiQ2FsUkdCQ1MiLCB3aGl0ZVBvaW50LCBibGFja1BvaW50LCBnYW1tYSwgbWF0cml4XTsKCiAgICAgICAgICBjYXNlICJJQ0NCYXNlZCI6CiAgICAgICAgICAgIHZhciBzdHJlYW0gPSB4cmVmLmZldGNoSWZSZWYoY3NbMV0pOwogICAgICAgICAgICB2YXIgZGljdCA9IHN0cmVhbS5kaWN0OwogICAgICAgICAgICBudW1Db21wcyA9IGRpY3QuZ2V0KCJOIik7CiAgICAgICAgICAgIGFsdCA9IGRpY3QuZ2V0KCJBbHRlcm5hdGUiKTsKCiAgICAgICAgICAgIGlmIChhbHQpIHsKICAgICAgICAgICAgICB2YXIgYWx0SVIgPSB0aGlzLnBhcnNlVG9JUihhbHQsIHhyZWYsIHJlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKICAgICAgICAgICAgICB2YXIgYWx0Q1MgPSB0aGlzLmZyb21JUihhbHRJUiwgcGRmRnVuY3Rpb25GYWN0b3J5KTsKCiAgICAgICAgICAgICAgaWYgKGFsdENTLm51bUNvbXBzID09PSBudW1Db21wcykgewogICAgICAgICAgICAgICAgcmV0dXJuIGFsdElSOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJJQ0NCYXNlZCBjb2xvciBzcGFjZTogSWdub3JpbmcgaW5jb3JyZWN0IC9BbHRlcm5hdGUgZW50cnkuIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChudW1Db21wcyA9PT0gMSkgewogICAgICAgICAgICAgIHJldHVybiAiRGV2aWNlR3JheUNTIjsKICAgICAgICAgICAgfSBlbHNlIGlmIChudW1Db21wcyA9PT0gMykgewogICAgICAgICAgICAgIHJldHVybiAiRGV2aWNlUmdiQ1MiOwogICAgICAgICAgICB9IGVsc2UgaWYgKG51bUNvbXBzID09PSA0KSB7CiAgICAgICAgICAgICAgcmV0dXJuICJEZXZpY2VDbXlrQ1MiOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJQYXR0ZXJuIjoKICAgICAgICAgICAgdmFyIGJhc2VQYXR0ZXJuQ1MgPSBjc1sxXSB8fCBudWxsOwoKICAgICAgICAgICAgaWYgKGJhc2VQYXR0ZXJuQ1MpIHsKICAgICAgICAgICAgICBiYXNlUGF0dGVybkNTID0gdGhpcy5wYXJzZVRvSVIoYmFzZVBhdHRlcm5DUywgeHJlZiwgcmVzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gWyJQYXR0ZXJuQ1MiLCBiYXNlUGF0dGVybkNTXTsKCiAgICAgICAgICBjYXNlICJJbmRleGVkIjoKICAgICAgICAgIGNhc2UgIkkiOgogICAgICAgICAgICB2YXIgYmFzZUluZGV4ZWRDUyA9IHRoaXMucGFyc2VUb0lSKGNzWzFdLCB4cmVmLCByZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSk7CiAgICAgICAgICAgIHZhciBoaVZhbCA9IHhyZWYuZmV0Y2hJZlJlZihjc1syXSkgKyAxOwogICAgICAgICAgICB2YXIgbG9va3VwID0geHJlZi5mZXRjaElmUmVmKGNzWzNdKTsKCiAgICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKGxvb2t1cCkpIHsKICAgICAgICAgICAgICBsb29rdXAgPSBsb29rdXAuZ2V0Qnl0ZXMoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIFsiSW5kZXhlZENTIiwgYmFzZUluZGV4ZWRDUywgaGlWYWwsIGxvb2t1cF07CgogICAgICAgICAgY2FzZSAiU2VwYXJhdGlvbiI6CiAgICAgICAgICBjYXNlICJEZXZpY2VOIjoKICAgICAgICAgICAgdmFyIG5hbWUgPSB4cmVmLmZldGNoSWZSZWYoY3NbMV0pOwogICAgICAgICAgICBudW1Db21wcyA9IEFycmF5LmlzQXJyYXkobmFtZSkgPyBuYW1lLmxlbmd0aCA6IDE7CiAgICAgICAgICAgIGFsdCA9IHRoaXMucGFyc2VUb0lSKGNzWzJdLCB4cmVmLCByZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSk7CiAgICAgICAgICAgIHZhciB0aW50Rm4gPSBwZGZGdW5jdGlvbkZhY3RvcnkuY3JlYXRlKHhyZWYuZmV0Y2hJZlJlZihjc1szXSkpOwogICAgICAgICAgICByZXR1cm4gWyJBbHRlcm5hdGVDUyIsIG51bUNvbXBzLCBhbHQsIHRpbnRGbl07CgogICAgICAgICAgY2FzZSAiTGFiIjoKICAgICAgICAgICAgcGFyYW1zID0geHJlZi5mZXRjaElmUmVmKGNzWzFdKTsKICAgICAgICAgICAgd2hpdGVQb2ludCA9IHBhcmFtcy5nZXRBcnJheSgiV2hpdGVQb2ludCIpOwogICAgICAgICAgICBibGFja1BvaW50ID0gcGFyYW1zLmdldEFycmF5KCJCbGFja1BvaW50Iik7CiAgICAgICAgICAgIHZhciByYW5nZSA9IHBhcmFtcy5nZXRBcnJheSgiUmFuZ2UiKTsKICAgICAgICAgICAgcmV0dXJuIFsiTGFiQ1MiLCB3aGl0ZVBvaW50LCBibGFja1BvaW50LCByYW5nZV07CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ1bmltcGxlbWVudGVkIGNvbG9yIHNwYWNlIG9iamVjdCBcIiIuY29uY2F0KG1vZGUsICJcIiIpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigidW5yZWNvZ25pemVkIGNvbG9yIHNwYWNlIG9iamVjdDogXCIiLmNvbmNhdChjcywgIlwiIikpOwogICAgfQogIH0sIHsKICAgIGtleTogImlzRGVmYXVsdERlY29kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNEZWZhdWx0RGVjb2RlKGRlY29kZSwgbnVtQ29tcHMpIHsKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGRlY29kZSkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKG51bUNvbXBzICogMiAhPT0gZGVjb2RlLmxlbmd0aCkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiVGhlIGRlY29kZSBtYXAgaXMgbm90IHRoZSBjb3JyZWN0IGxlbmd0aCIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBkZWNvZGUubGVuZ3RoOyBpIDwgaWk7IGkgKz0gMikgewogICAgICAgIGlmIChkZWNvZGVbaV0gIT09IDAgfHwgZGVjb2RlW2kgKyAxXSAhPT0gMSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAic2luZ2xldG9ucyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJzaW5nbGV0b25zIiwgewogICAgICAgIGdldCBncmF5KCkgewogICAgICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJncmF5IiwgbmV3IERldmljZUdyYXlDUygpKTsKICAgICAgICB9LAoKICAgICAgICBnZXQgcmdiKCkgewogICAgICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJyZ2IiLCBuZXcgRGV2aWNlUmdiQ1MoKSk7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0IGNteWsoKSB7CiAgICAgICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgImNteWsiLCBuZXcgRGV2aWNlQ215a0NTKCkpOwogICAgICAgIH0KCiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbG9yU3BhY2U7Cn0oKTsKCmV4cG9ydHMuQ29sb3JTcGFjZSA9IENvbG9yU3BhY2U7Cgp2YXIgQWx0ZXJuYXRlQ1MgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db2xvclNwYWNlKSB7CiAgX2luaGVyaXRzKEFsdGVybmF0ZUNTLCBfQ29sb3JTcGFjZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoQWx0ZXJuYXRlQ1MpOwoKICBmdW5jdGlvbiBBbHRlcm5hdGVDUyhudW1Db21wcywgYmFzZSwgdGludEZuKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFsdGVybmF0ZUNTKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsICJBbHRlcm5hdGUiLCBudW1Db21wcyk7CiAgICBfdGhpcy5iYXNlID0gYmFzZTsKICAgIF90aGlzLnRpbnRGbiA9IHRpbnRGbjsKICAgIF90aGlzLnRtcEJ1ZiA9IG5ldyBGbG9hdDMyQXJyYXkoYmFzZS5udW1Db21wcyk7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQWx0ZXJuYXRlQ1MsIFt7CiAgICBrZXk6ICJnZXRSZ2JJdGVtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZ2JJdGVtKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgIHZhciB0bXBCdWYgPSB0aGlzLnRtcEJ1ZjsKICAgICAgdGhpcy50aW50Rm4oc3JjLCBzcmNPZmZzZXQsIHRtcEJ1ZiwgMCk7CiAgICAgIHRoaXMuYmFzZS5nZXRSZ2JJdGVtKHRtcEJ1ZiwgMCwgZGVzdCwgZGVzdE9mZnNldCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UmdiQnVmZmVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICAgIHZhciB0aW50Rm4gPSB0aGlzLnRpbnRGbjsKICAgICAgdmFyIGJhc2UgPSB0aGlzLmJhc2U7CiAgICAgIHZhciBzY2FsZSA9IDEgLyAoKDEgPDwgYml0cykgLSAxKTsKICAgICAgdmFyIGJhc2VOdW1Db21wcyA9IGJhc2UubnVtQ29tcHM7CiAgICAgIHZhciB1c2VzWmVyb1RvT25lUmFuZ2UgPSBiYXNlLnVzZXNaZXJvVG9PbmVSYW5nZTsKICAgICAgdmFyIGlzUGFzc3Rocm91Z2ggPSAoYmFzZS5pc1Bhc3N0aHJvdWdoKDgpIHx8ICF1c2VzWmVyb1RvT25lUmFuZ2UpICYmIGFscGhhMDEgPT09IDA7CiAgICAgIHZhciBwb3MgPSBpc1Bhc3N0aHJvdWdoID8gZGVzdE9mZnNldCA6IDA7CiAgICAgIHZhciBiYXNlQnVmID0gaXNQYXNzdGhyb3VnaCA/IGRlc3QgOiBuZXcgVWludDhDbGFtcGVkQXJyYXkoYmFzZU51bUNvbXBzICogY291bnQpOwogICAgICB2YXIgbnVtQ29tcHMgPSB0aGlzLm51bUNvbXBzOwogICAgICB2YXIgc2NhbGVkID0gbmV3IEZsb2F0MzJBcnJheShudW1Db21wcyk7CiAgICAgIHZhciB0aW50ZWQgPSBuZXcgRmxvYXQzMkFycmF5KGJhc2VOdW1Db21wcyk7CiAgICAgIHZhciBpLCBqOwoKICAgICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgbnVtQ29tcHM7IGorKykgewogICAgICAgICAgc2NhbGVkW2pdID0gc3JjW3NyY09mZnNldCsrXSAqIHNjYWxlOwogICAgICAgIH0KCiAgICAgICAgdGludEZuKHNjYWxlZCwgMCwgdGludGVkLCAwKTsKCiAgICAgICAgaWYgKHVzZXNaZXJvVG9PbmVSYW5nZSkgewogICAgICAgICAgZm9yIChqID0gMDsgaiA8IGJhc2VOdW1Db21wczsgaisrKSB7CiAgICAgICAgICAgIGJhc2VCdWZbcG9zKytdID0gdGludGVkW2pdICogMjU1OwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBiYXNlLmdldFJnYkl0ZW0odGludGVkLCAwLCBiYXNlQnVmLCBwb3MpOwogICAgICAgICAgcG9zICs9IGJhc2VOdW1Db21wczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghaXNQYXNzdGhyb3VnaCkgewogICAgICAgIGJhc2UuZ2V0UmdiQnVmZmVyKGJhc2VCdWYsIDAsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCA4LCBhbHBoYTAxKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImdldE91dHB1dExlbmd0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0T3V0cHV0TGVuZ3RoKGlucHV0TGVuZ3RoLCBhbHBoYTAxKSB7CiAgICAgIHJldHVybiB0aGlzLmJhc2UuZ2V0T3V0cHV0TGVuZ3RoKGlucHV0TGVuZ3RoICogdGhpcy5iYXNlLm51bUNvbXBzIC8gdGhpcy5udW1Db21wcywgYWxwaGEwMSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQWx0ZXJuYXRlQ1M7Cn0oQ29sb3JTcGFjZSk7Cgp2YXIgUGF0dGVybkNTID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29sb3JTcGFjZTIpIHsKICBfaW5oZXJpdHMoUGF0dGVybkNTLCBfQ29sb3JTcGFjZTIpOwoKICB2YXIgX3N1cGVyMiA9IF9jcmVhdGVTdXBlcihQYXR0ZXJuQ1MpOwoKICBmdW5jdGlvbiBQYXR0ZXJuQ1MoYmFzZUNTKSB7CiAgICB2YXIgX3RoaXMyOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQYXR0ZXJuQ1MpOwoKICAgIF90aGlzMiA9IF9zdXBlcjIuY2FsbCh0aGlzLCAiUGF0dGVybiIsIG51bGwpOwogICAgX3RoaXMyLmJhc2UgPSBiYXNlQ1M7CiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFBhdHRlcm5DUywgW3sKICAgIGtleTogImlzRGVmYXVsdERlY29kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXNEZWZhdWx0RGVjb2RlKGRlY29kZU1hcCwgYnBjKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBQYXR0ZXJuQ1MuaXNEZWZhdWx0RGVjb2RlIik7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUGF0dGVybkNTOwp9KENvbG9yU3BhY2UpOwoKdmFyIEluZGV4ZWRDUyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbG9yU3BhY2UzKSB7CiAgX2luaGVyaXRzKEluZGV4ZWRDUywgX0NvbG9yU3BhY2UzKTsKCiAgdmFyIF9zdXBlcjMgPSBfY3JlYXRlU3VwZXIoSW5kZXhlZENTKTsKCiAgZnVuY3Rpb24gSW5kZXhlZENTKGJhc2UsIGhpZ2hWYWwsIGxvb2t1cCkgewogICAgdmFyIF90aGlzMzsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW5kZXhlZENTKTsKCiAgICBfdGhpczMgPSBfc3VwZXIzLmNhbGwodGhpcywgIkluZGV4ZWQiLCAxKTsKICAgIF90aGlzMy5iYXNlID0gYmFzZTsKICAgIF90aGlzMy5oaWdoVmFsID0gaGlnaFZhbDsKICAgIHZhciBiYXNlTnVtQ29tcHMgPSBiYXNlLm51bUNvbXBzOwogICAgdmFyIGxlbmd0aCA9IGJhc2VOdW1Db21wcyAqIGhpZ2hWYWw7CgogICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkobG9va3VwKSkgewogICAgICBfdGhpczMubG9va3VwID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKICAgICAgdmFyIGJ5dGVzID0gbG9va3VwLmdldEJ5dGVzKGxlbmd0aCk7CgogICAgICBfdGhpczMubG9va3VwLnNldChieXRlcyk7CiAgICB9IGVsc2UgaWYgKCgwLCBfdXRpbC5pc1N0cmluZykobG9va3VwKSkgewogICAgICBfdGhpczMubG9va3VwID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHsKICAgICAgICBfdGhpczMubG9va3VwW2ldID0gbG9va3VwLmNoYXJDb2RlQXQoaSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAobG9va3VwIGluc3RhbmNlb2YgVWludDhBcnJheSkgewogICAgICBfdGhpczMubG9va3VwID0gbG9va3VwOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbnJlY29nbml6ZWQgbG9va3VwIHRhYmxlOiAiLmNvbmNhdChsb29rdXApKTsKICAgIH0KCiAgICByZXR1cm4gX3RoaXMzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEluZGV4ZWRDUywgW3sKICAgIGtleTogImdldFJnYkl0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgdmFyIG51bUNvbXBzID0gdGhpcy5iYXNlLm51bUNvbXBzOwogICAgICB2YXIgc3RhcnQgPSBzcmNbc3JjT2Zmc2V0XSAqIG51bUNvbXBzOwogICAgICB0aGlzLmJhc2UuZ2V0UmdiQnVmZmVyKHRoaXMubG9va3VwLCBzdGFydCwgMSwgZGVzdCwgZGVzdE9mZnNldCwgOCwgMCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UmdiQnVmZmVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICAgIHZhciBiYXNlID0gdGhpcy5iYXNlOwogICAgICB2YXIgbnVtQ29tcHMgPSBiYXNlLm51bUNvbXBzOwogICAgICB2YXIgb3V0cHV0RGVsdGEgPSBiYXNlLmdldE91dHB1dExlbmd0aChudW1Db21wcywgYWxwaGEwMSk7CiAgICAgIHZhciBsb29rdXAgPSB0aGlzLmxvb2t1cDsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewogICAgICAgIHZhciBsb29rdXBQb3MgPSBzcmNbc3JjT2Zmc2V0KytdICogbnVtQ29tcHM7CiAgICAgICAgYmFzZS5nZXRSZ2JCdWZmZXIobG9va3VwLCBsb29rdXBQb3MsIDEsIGRlc3QsIGRlc3RPZmZzZXQsIDgsIGFscGhhMDEpOwogICAgICAgIGRlc3RPZmZzZXQgKz0gb3V0cHV0RGVsdGE7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRPdXRwdXRMZW5ndGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgICByZXR1cm4gdGhpcy5iYXNlLmdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCAqIHRoaXMuYmFzZS5udW1Db21wcywgYWxwaGEwMSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNEZWZhdWx0RGVjb2RlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0RlZmF1bHREZWNvZGUoZGVjb2RlTWFwLCBicGMpIHsKICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGRlY29kZU1hcCkpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKGRlY29kZU1hcC5sZW5ndGggIT09IDIpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIkRlY29kZSBtYXAgbGVuZ3RoIGlzIG5vdCBjb3JyZWN0Iik7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihicGMpIHx8IGJwYyA8IDEpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIkJpdHMgcGVyIGNvbXBvbmVudCBpcyBub3QgY29ycmVjdCIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZGVjb2RlTWFwWzBdID09PSAwICYmIGRlY29kZU1hcFsxXSA9PT0gKDEgPDwgYnBjKSAtIDE7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gSW5kZXhlZENTOwp9KENvbG9yU3BhY2UpOwoKdmFyIERldmljZUdyYXlDUyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbG9yU3BhY2U0KSB7CiAgX2luaGVyaXRzKERldmljZUdyYXlDUywgX0NvbG9yU3BhY2U0KTsKCiAgdmFyIF9zdXBlcjQgPSBfY3JlYXRlU3VwZXIoRGV2aWNlR3JheUNTKTsKCiAgZnVuY3Rpb24gRGV2aWNlR3JheUNTKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERldmljZUdyYXlDUyk7CgogICAgcmV0dXJuIF9zdXBlcjQuY2FsbCh0aGlzLCAiRGV2aWNlR3JheSIsIDEpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKERldmljZUdyYXlDUywgW3sKICAgIGtleTogImdldFJnYkl0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgdmFyIGMgPSBzcmNbc3JjT2Zmc2V0XSAqIDI1NTsKICAgICAgZGVzdFtkZXN0T2Zmc2V0XSA9IGRlc3RbZGVzdE9mZnNldCArIDFdID0gZGVzdFtkZXN0T2Zmc2V0ICsgMl0gPSBjOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFJnYkJ1ZmZlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmdiQnVmZmVyKHNyYywgc3JjT2Zmc2V0LCBjb3VudCwgZGVzdCwgZGVzdE9mZnNldCwgYml0cywgYWxwaGEwMSkgewogICAgICB2YXIgc2NhbGUgPSAyNTUgLyAoKDEgPDwgYml0cykgLSAxKTsKICAgICAgdmFyIGogPSBzcmNPZmZzZXQsCiAgICAgICAgICBxID0gZGVzdE9mZnNldDsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewogICAgICAgIHZhciBjID0gc2NhbGUgKiBzcmNbaisrXTsKICAgICAgICBkZXN0W3ErK10gPSBjOwogICAgICAgIGRlc3RbcSsrXSA9IGM7CiAgICAgICAgZGVzdFtxKytdID0gYzsKICAgICAgICBxICs9IGFscGhhMDE7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRPdXRwdXRMZW5ndGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgICByZXR1cm4gaW5wdXRMZW5ndGggKiAoMyArIGFscGhhMDEpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIERldmljZUdyYXlDUzsKfShDb2xvclNwYWNlKTsKCnZhciBEZXZpY2VSZ2JDUyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbG9yU3BhY2U1KSB7CiAgX2luaGVyaXRzKERldmljZVJnYkNTLCBfQ29sb3JTcGFjZTUpOwoKICB2YXIgX3N1cGVyNSA9IF9jcmVhdGVTdXBlcihEZXZpY2VSZ2JDUyk7CgogIGZ1bmN0aW9uIERldmljZVJnYkNTKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERldmljZVJnYkNTKTsKCiAgICByZXR1cm4gX3N1cGVyNS5jYWxsKHRoaXMsICJEZXZpY2VSR0IiLCAzKTsKICB9CgogIF9jcmVhdGVDbGFzcyhEZXZpY2VSZ2JDUywgW3sKICAgIGtleTogImdldFJnYkl0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgZGVzdFtkZXN0T2Zmc2V0XSA9IHNyY1tzcmNPZmZzZXRdICogMjU1OwogICAgICBkZXN0W2Rlc3RPZmZzZXQgKyAxXSA9IHNyY1tzcmNPZmZzZXQgKyAxXSAqIDI1NTsKICAgICAgZGVzdFtkZXN0T2Zmc2V0ICsgMl0gPSBzcmNbc3JjT2Zmc2V0ICsgMl0gKiAyNTU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UmdiQnVmZmVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZ2JCdWZmZXIoc3JjLCBzcmNPZmZzZXQsIGNvdW50LCBkZXN0LCBkZXN0T2Zmc2V0LCBiaXRzLCBhbHBoYTAxKSB7CiAgICAgIGlmIChiaXRzID09PSA4ICYmIGFscGhhMDEgPT09IDApIHsKICAgICAgICBkZXN0LnNldChzcmMuc3ViYXJyYXkoc3JjT2Zmc2V0LCBzcmNPZmZzZXQgKyBjb3VudCAqIDMpLCBkZXN0T2Zmc2V0KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBzY2FsZSA9IDI1NSAvICgoMSA8PCBiaXRzKSAtIDEpOwogICAgICB2YXIgaiA9IHNyY09mZnNldCwKICAgICAgICAgIHEgPSBkZXN0T2Zmc2V0OwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CiAgICAgICAgZGVzdFtxKytdID0gc2NhbGUgKiBzcmNbaisrXTsKICAgICAgICBkZXN0W3ErK10gPSBzY2FsZSAqIHNyY1tqKytdOwogICAgICAgIGRlc3RbcSsrXSA9IHNjYWxlICogc3JjW2orK107CiAgICAgICAgcSArPSBhbHBoYTAxOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0T3V0cHV0TGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgICAgcmV0dXJuIGlucHV0TGVuZ3RoICogKDMgKyBhbHBoYTAxKSAvIDMgfCAwOwogICAgfQogIH0sIHsKICAgIGtleTogImlzUGFzc3Rocm91Z2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzUGFzc3Rocm91Z2goYml0cykgewogICAgICByZXR1cm4gYml0cyA9PT0gODsKICAgIH0KICB9XSk7CgogIHJldHVybiBEZXZpY2VSZ2JDUzsKfShDb2xvclNwYWNlKTsKCnZhciBEZXZpY2VDbXlrQ1MgPSBmdW5jdGlvbiBEZXZpY2VDbXlrQ1NDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGNvbnZlcnRUb1JnYihzcmMsIHNyY09mZnNldCwgc3JjU2NhbGUsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgIHZhciBjID0gc3JjW3NyY09mZnNldF0gKiBzcmNTY2FsZTsKICAgIHZhciBtID0gc3JjW3NyY09mZnNldCArIDFdICogc3JjU2NhbGU7CiAgICB2YXIgeSA9IHNyY1tzcmNPZmZzZXQgKyAyXSAqIHNyY1NjYWxlOwogICAgdmFyIGsgPSBzcmNbc3JjT2Zmc2V0ICsgM10gKiBzcmNTY2FsZTsKICAgIGRlc3RbZGVzdE9mZnNldF0gPSAyNTUgKyBjICogKC00LjM4NzMzMjM4NDYwOTk4OCAqIGMgKyA1NC40ODYxNTE5NDE4OTE3NiAqIG0gKyAxOC44MjI5MDUwMjE2NTMwMiAqIHkgKyAyMTIuMjU2NjI0NTE2Mzk1ODUgKiBrICsgLTI4NS4yMzMxMDI2MTM3MDA0KSArIG0gKiAoMS43MTQ5NzYzNDc3MzYyMTM0ICogbSAtIDUuNjA5NjczNjkwNDA0NzMxNSAqIHkgKyAtMTcuODczODcwODYxNDE1NDQ0ICogayAtIDUuNDk3MDA2NDI3MTk2MzY2KSArIHkgKiAoLTIuNTIxNzM0MDEzMTY4MzAzMyAqIHkgLSAyMS4yNDg5MjMzMzczNTMwNzMgKiBrICsgMTcuNTExOTI3MDg0MTgxMykgKyBrICogKC0yMS44NjEyMjE0NzQ2MzYwNSAqIGsgLSAxODkuNDgxODA4MzU5MjI3NDcpOwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMV0gPSAyNTUgKyBjICogKDguODQxMDQxNDIyMDM2MTQ5ICogYyArIDYwLjExODAyNzA0NTU5NzM2NiAqIG0gKyA2Ljg3MTQyNTU5MjA0OTAwNyAqIHkgKyAzMS4xNTkxMDAxMzAwNTU5MjIgKiBrICsgLTc5LjI5NzA4NDQ4MTY1NDgpICsgbSAqICgtMTUuMzEwMzYxMzA2OTY3ODE3ICogbSArIDE3LjU3NTI1MTI2MTEwOTQ4MiAqIHkgKyAxMzEuMzUyNTA5MTI0OTM5NzYgKiBrIC0gMTkwLjk0NTMzMDI1ODg5NTEpICsgeSAqICg0LjQ0NDMzOTEwMjg1MjczOSAqIHkgKyA5Ljg2MzI4NjE0OTM0MDUgKiBrIC0gMjQuODY3NDE1ODI1NTU4NzgpICsgayAqICgtMjAuNzM3MzI1NDcxMTgxMDM0ICogayAtIDE4Ny44MDQ1MzcwOTcxOTU3OCk7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAyXSA9IDI1NSArIGMgKiAoMC44ODQyNTIyNDMwMDAzMjk2ICogYyArIDguMDc4Njc3NTAzMTEyOTI4ICogbSArIDMwLjg5OTc4MzA5NzAzNzI5ICogeSAtIDAuMjM4ODMyMzg2ODkxNzg5MzQgKiBrICsgLTE0LjE4MzU3Njc5OTY3MzI4NikgKyBtICogKDEwLjQ5NTkzMjczNDMyMDcyICogbSArIDYzLjAyMzc4NDk0NzU0MDUyICogeSArIDUwLjYwNjk1NzY1NjM2MDczNCAqIGsgLSAxMTIuMjM4ODQyNTM3MTkyNDgpICsgeSAqICgwLjAzMjk2MDQxMTE0ODczMjE3ICogeSArIDExNS42MDM4NDQ0OTY0NjY0MSAqIGsgKyAtMTkzLjU4MjA5MzU2ODYxNTA1KSArIGsgKiAoLTIyLjMzODE2ODA3MzA5ODg2ICogayAtIDE4MC4xMjYxMzk3NDcwODM2Nyk7CiAgfQoKICB2YXIgRGV2aWNlQ215a0NTID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29sb3JTcGFjZTYpIHsKICAgIF9pbmhlcml0cyhEZXZpY2VDbXlrQ1MsIF9Db2xvclNwYWNlNik7CgogICAgdmFyIF9zdXBlcjYgPSBfY3JlYXRlU3VwZXIoRGV2aWNlQ215a0NTKTsKCiAgICBmdW5jdGlvbiBEZXZpY2VDbXlrQ1MoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEZXZpY2VDbXlrQ1MpOwoKICAgICAgcmV0dXJuIF9zdXBlcjYuY2FsbCh0aGlzLCAiRGV2aWNlQ01ZSyIsIDQpOwogICAgfQoKICAgIF9jcmVhdGVDbGFzcyhEZXZpY2VDbXlrQ1MsIFt7CiAgICAgIGtleTogImdldFJnYkl0ZW0iLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgICAgIGNvbnZlcnRUb1JnYihzcmMsIHNyY09mZnNldCwgMSwgZGVzdCwgZGVzdE9mZnNldCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2V0UmdiQnVmZmVyIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgICAgICB2YXIgc2NhbGUgPSAxIC8gKCgxIDw8IGJpdHMpIC0gMSk7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgICAgY29udmVydFRvUmdiKHNyYywgc3JjT2Zmc2V0LCBzY2FsZSwgZGVzdCwgZGVzdE9mZnNldCk7CiAgICAgICAgICBzcmNPZmZzZXQgKz0gNDsKICAgICAgICAgIGRlc3RPZmZzZXQgKz0gMyArIGFscGhhMDE7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldE91dHB1dExlbmd0aCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgICAgICByZXR1cm4gaW5wdXRMZW5ndGggLyA0ICogKDMgKyBhbHBoYTAxKSB8IDA7CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gRGV2aWNlQ215a0NTOwogIH0oQ29sb3JTcGFjZSk7CgogIHJldHVybiBEZXZpY2VDbXlrQ1M7Cn0oKTsKCnZhciBDYWxHcmF5Q1MgPSBmdW5jdGlvbiBDYWxHcmF5Q1NDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGNvbnZlcnRUb1JnYihjcywgc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQsIHNjYWxlKSB7CiAgICB2YXIgQSA9IHNyY1tzcmNPZmZzZXRdICogc2NhbGU7CiAgICB2YXIgQUcgPSBNYXRoLnBvdyhBLCBjcy5HKTsKICAgIHZhciBMID0gY3MuWVcgKiBBRzsKICAgIHZhciB2YWwgPSBNYXRoLm1heCgyOTUuOCAqIE1hdGgucG93KEwsIDAuMzMzMzMzMzMzMzMzMzMzMzMzKSAtIDQwLjgsIDApOwogICAgZGVzdFtkZXN0T2Zmc2V0XSA9IHZhbDsKICAgIGRlc3RbZGVzdE9mZnNldCArIDFdID0gdmFsOwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMl0gPSB2YWw7CiAgfQoKICB2YXIgQ2FsR3JheUNTID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29sb3JTcGFjZTcpIHsKICAgIF9pbmhlcml0cyhDYWxHcmF5Q1MsIF9Db2xvclNwYWNlNyk7CgogICAgdmFyIF9zdXBlcjcgPSBfY3JlYXRlU3VwZXIoQ2FsR3JheUNTKTsKCiAgICBmdW5jdGlvbiBDYWxHcmF5Q1Mod2hpdGVQb2ludCwgYmxhY2tQb2ludCwgZ2FtbWEpIHsKICAgICAgdmFyIF90aGlzNDsKCiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDYWxHcmF5Q1MpOwoKICAgICAgX3RoaXM0ID0gX3N1cGVyNy5jYWxsKHRoaXMsICJDYWxHcmF5IiwgMSk7CgogICAgICBpZiAoIXdoaXRlUG9pbnQpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIldoaXRlUG9pbnQgbWlzc2luZyAtIHJlcXVpcmVkIGZvciBjb2xvciBzcGFjZSBDYWxHcmF5Iik7CiAgICAgIH0KCiAgICAgIGJsYWNrUG9pbnQgPSBibGFja1BvaW50IHx8IFswLCAwLCAwXTsKICAgICAgZ2FtbWEgPSBnYW1tYSB8fCAxOwogICAgICBfdGhpczQuWFcgPSB3aGl0ZVBvaW50WzBdOwogICAgICBfdGhpczQuWVcgPSB3aGl0ZVBvaW50WzFdOwogICAgICBfdGhpczQuWlcgPSB3aGl0ZVBvaW50WzJdOwogICAgICBfdGhpczQuWEIgPSBibGFja1BvaW50WzBdOwogICAgICBfdGhpczQuWUIgPSBibGFja1BvaW50WzFdOwogICAgICBfdGhpczQuWkIgPSBibGFja1BvaW50WzJdOwogICAgICBfdGhpczQuRyA9IGdhbW1hOwoKICAgICAgaWYgKF90aGlzNC5YVyA8IDAgfHwgX3RoaXM0LlpXIDwgMCB8fCBfdGhpczQuWVcgIT09IDEpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgV2hpdGVQb2ludCBjb21wb25lbnRzIGZvciAiLmNvbmNhdChfdGhpczQubmFtZSkgKyAiLCBubyBmYWxsYmFjayBhdmFpbGFibGUiKTsKICAgICAgfQoKICAgICAgaWYgKF90aGlzNC5YQiA8IDAgfHwgX3RoaXM0LllCIDwgMCB8fCBfdGhpczQuWkIgPCAwKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJbnZhbGlkIEJsYWNrUG9pbnQgZm9yICIuY29uY2F0KF90aGlzNC5uYW1lLCAiLCBmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdC4iKSk7CiAgICAgICAgX3RoaXM0LlhCID0gX3RoaXM0LllCID0gX3RoaXM0LlpCID0gMDsKICAgICAgfQoKICAgICAgaWYgKF90aGlzNC5YQiAhPT0gMCB8fCBfdGhpczQuWUIgIT09IDAgfHwgX3RoaXM0LlpCICE9PSAwKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCIiLmNvbmNhdChfdGhpczQubmFtZSwgIiwgQmxhY2tQb2ludDogWEI6ICIpLmNvbmNhdChfdGhpczQuWEIsICIsIFlCOiAiKS5jb25jYXQoX3RoaXM0LllCLCAiLCAiKSArICJaQjogIi5jb25jYXQoX3RoaXM0LlpCLCAiLCBvbmx5IGRlZmF1bHQgdmFsdWVzIGFyZSBzdXBwb3J0ZWQuIikpOwogICAgICB9CgogICAgICBpZiAoX3RoaXM0LkcgPCAxKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJbnZhbGlkIEdhbW1hOiAiLmNvbmNhdChfdGhpczQuRywgIiBmb3IgIikuY29uY2F0KF90aGlzNC5uYW1lLCAiLCAiKSArICJmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdC4iKTsKICAgICAgICBfdGhpczQuRyA9IDE7CiAgICAgIH0KCiAgICAgIHJldHVybiBfdGhpczQ7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKENhbEdyYXlDUywgW3sKICAgICAga2V5OiAiZ2V0UmdiSXRlbSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZ2JJdGVtKHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgICAgY29udmVydFRvUmdiKHRoaXMsIHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0LCAxKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZXRSZ2JCdWZmZXIiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmdiQnVmZmVyKHNyYywgc3JjT2Zmc2V0LCBjb3VudCwgZGVzdCwgZGVzdE9mZnNldCwgYml0cywgYWxwaGEwMSkgewogICAgICAgIHZhciBzY2FsZSA9IDEgLyAoKDEgPDwgYml0cykgLSAxKTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CiAgICAgICAgICBjb252ZXJ0VG9SZ2IodGhpcywgc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQsIHNjYWxlKTsKICAgICAgICAgIHNyY09mZnNldCArPSAxOwogICAgICAgICAgZGVzdE9mZnNldCArPSAzICsgYWxwaGEwMTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2V0T3V0cHV0TGVuZ3RoIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE91dHB1dExlbmd0aChpbnB1dExlbmd0aCwgYWxwaGEwMSkgewogICAgICAgIHJldHVybiBpbnB1dExlbmd0aCAqICgzICsgYWxwaGEwMSk7CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gQ2FsR3JheUNTOwogIH0oQ29sb3JTcGFjZSk7CgogIHJldHVybiBDYWxHcmF5Q1M7Cn0oKTsKCnZhciBDYWxSR0JDUyA9IGZ1bmN0aW9uIENhbFJHQkNTQ2xvc3VyZSgpIHsKICB2YXIgQlJBREZPUkRfU0NBTEVfTUFUUklYID0gbmV3IEZsb2F0MzJBcnJheShbMC44OTUxLCAwLjI2NjQsIC0wLjE2MTQsIC0wLjc1MDIsIDEuNzEzNSwgMC4wMzY3LCAwLjAzODksIC0wLjA2ODUsIDEuMDI5Nl0pOwogIHZhciBCUkFERk9SRF9TQ0FMRV9JTlZFUlNFX01BVFJJWCA9IG5ldyBGbG9hdDMyQXJyYXkoWzAuOTg2OTkyOSwgLTAuMTQ3MDU0MywgMC4xNTk5NjI3LCAwLjQzMjMwNTMsIDAuNTE4MzYwMywgMC4wNDkyOTEyLCAtMC4wMDg1Mjg3LCAwLjA0MDA0MjgsIDAuOTY4NDg2N10pOwogIHZhciBTUkdCX0Q2NV9YWVpfVE9fUkdCX01BVFJJWCA9IG5ldyBGbG9hdDMyQXJyYXkoWzMuMjQwNDU0MiwgLTEuNTM3MTM4NSwgLTAuNDk4NTMxNCwgLTAuOTY5MjY2MCwgMS44NzYwMTA4LCAwLjA0MTU1NjAsIDAuMDU1NjQzNCwgLTAuMjA0MDI1OSwgMS4wNTcyMjUyXSk7CiAgdmFyIEZMQVRfV0hJVEVQT0lOVF9NQVRSSVggPSBuZXcgRmxvYXQzMkFycmF5KFsxLCAxLCAxXSk7CiAgdmFyIHRlbXBOb3JtYWxpemVNYXRyaXggPSBuZXcgRmxvYXQzMkFycmF5KDMpOwogIHZhciB0ZW1wQ29udmVydE1hdHJpeDEgPSBuZXcgRmxvYXQzMkFycmF5KDMpOwogIHZhciB0ZW1wQ29udmVydE1hdHJpeDIgPSBuZXcgRmxvYXQzMkFycmF5KDMpOwogIHZhciBERUNPREVfTF9DT05TVEFOVCA9IE1hdGgucG93KCg4ICsgMTYpIC8gMTE2LCAzKSAvIDguMDsKCiAgZnVuY3Rpb24gbWF0cml4UHJvZHVjdChhLCBiLCByZXN1bHQpIHsKICAgIHJlc3VsdFswXSA9IGFbMF0gKiBiWzBdICsgYVsxXSAqIGJbMV0gKyBhWzJdICogYlsyXTsKICAgIHJlc3VsdFsxXSA9IGFbM10gKiBiWzBdICsgYVs0XSAqIGJbMV0gKyBhWzVdICogYlsyXTsKICAgIHJlc3VsdFsyXSA9IGFbNl0gKiBiWzBdICsgYVs3XSAqIGJbMV0gKyBhWzhdICogYlsyXTsKICB9CgogIGZ1bmN0aW9uIGNvbnZlcnRUb0ZsYXQoc291cmNlV2hpdGVQb2ludCwgTE1TLCByZXN1bHQpIHsKICAgIHJlc3VsdFswXSA9IExNU1swXSAqIDEgLyBzb3VyY2VXaGl0ZVBvaW50WzBdOwogICAgcmVzdWx0WzFdID0gTE1TWzFdICogMSAvIHNvdXJjZVdoaXRlUG9pbnRbMV07CiAgICByZXN1bHRbMl0gPSBMTVNbMl0gKiAxIC8gc291cmNlV2hpdGVQb2ludFsyXTsKICB9CgogIGZ1bmN0aW9uIGNvbnZlcnRUb0Q2NShzb3VyY2VXaGl0ZVBvaW50LCBMTVMsIHJlc3VsdCkgewogICAgdmFyIEQ2NVggPSAwLjk1MDQ3OwogICAgdmFyIEQ2NVkgPSAxOwogICAgdmFyIEQ2NVogPSAxLjA4ODgzOwogICAgcmVzdWx0WzBdID0gTE1TWzBdICogRDY1WCAvIHNvdXJjZVdoaXRlUG9pbnRbMF07CiAgICByZXN1bHRbMV0gPSBMTVNbMV0gKiBENjVZIC8gc291cmNlV2hpdGVQb2ludFsxXTsKICAgIHJlc3VsdFsyXSA9IExNU1syXSAqIEQ2NVogLyBzb3VyY2VXaGl0ZVBvaW50WzJdOwogIH0KCiAgZnVuY3Rpb24gc1JHQlRyYW5zZmVyRnVuY3Rpb24oY29sb3IpIHsKICAgIGlmIChjb2xvciA8PSAwLjAwMzEzMDgpIHsKICAgICAgcmV0dXJuIGFkanVzdFRvUmFuZ2UoMCwgMSwgMTIuOTIgKiBjb2xvcik7CiAgICB9CgogICAgcmV0dXJuIGFkanVzdFRvUmFuZ2UoMCwgMSwgKDEgKyAwLjA1NSkgKiBNYXRoLnBvdyhjb2xvciwgMSAvIDIuNCkgLSAwLjA1NSk7CiAgfQoKICBmdW5jdGlvbiBhZGp1c3RUb1JhbmdlKG1pbiwgbWF4LCB2YWx1ZSkgewogICAgcmV0dXJuIE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCB2YWx1ZSkpOwogIH0KCiAgZnVuY3Rpb24gZGVjb2RlTChMKSB7CiAgICBpZiAoTCA8IDApIHsKICAgICAgcmV0dXJuIC1kZWNvZGVMKC1MKTsKICAgIH0KCiAgICBpZiAoTCA+IDguMCkgewogICAgICByZXR1cm4gTWF0aC5wb3coKEwgKyAxNikgLyAxMTYsIDMpOwogICAgfQoKICAgIHJldHVybiBMICogREVDT0RFX0xfQ09OU1RBTlQ7CiAgfQoKICBmdW5jdGlvbiBjb21wZW5zYXRlQmxhY2tQb2ludChzb3VyY2VCbGFja1BvaW50LCBYWVpfRmxhdCwgcmVzdWx0KSB7CiAgICBpZiAoc291cmNlQmxhY2tQb2ludFswXSA9PT0gMCAmJiBzb3VyY2VCbGFja1BvaW50WzFdID09PSAwICYmIHNvdXJjZUJsYWNrUG9pbnRbMl0gPT09IDApIHsKICAgICAgcmVzdWx0WzBdID0gWFlaX0ZsYXRbMF07CiAgICAgIHJlc3VsdFsxXSA9IFhZWl9GbGF0WzFdOwogICAgICByZXN1bHRbMl0gPSBYWVpfRmxhdFsyXTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciB6ZXJvRGVjb2RlTCA9IGRlY29kZUwoMCk7CiAgICB2YXIgWF9EU1QgPSB6ZXJvRGVjb2RlTDsKICAgIHZhciBYX1NSQyA9IGRlY29kZUwoc291cmNlQmxhY2tQb2ludFswXSk7CiAgICB2YXIgWV9EU1QgPSB6ZXJvRGVjb2RlTDsKICAgIHZhciBZX1NSQyA9IGRlY29kZUwoc291cmNlQmxhY2tQb2ludFsxXSk7CiAgICB2YXIgWl9EU1QgPSB6ZXJvRGVjb2RlTDsKICAgIHZhciBaX1NSQyA9IGRlY29kZUwoc291cmNlQmxhY2tQb2ludFsyXSk7CiAgICB2YXIgWF9TY2FsZSA9ICgxIC0gWF9EU1QpIC8gKDEgLSBYX1NSQyk7CiAgICB2YXIgWF9PZmZzZXQgPSAxIC0gWF9TY2FsZTsKICAgIHZhciBZX1NjYWxlID0gKDEgLSBZX0RTVCkgLyAoMSAtIFlfU1JDKTsKICAgIHZhciBZX09mZnNldCA9IDEgLSBZX1NjYWxlOwogICAgdmFyIFpfU2NhbGUgPSAoMSAtIFpfRFNUKSAvICgxIC0gWl9TUkMpOwogICAgdmFyIFpfT2Zmc2V0ID0gMSAtIFpfU2NhbGU7CiAgICByZXN1bHRbMF0gPSBYWVpfRmxhdFswXSAqIFhfU2NhbGUgKyBYX09mZnNldDsKICAgIHJlc3VsdFsxXSA9IFhZWl9GbGF0WzFdICogWV9TY2FsZSArIFlfT2Zmc2V0OwogICAgcmVzdWx0WzJdID0gWFlaX0ZsYXRbMl0gKiBaX1NjYWxlICsgWl9PZmZzZXQ7CiAgfQoKICBmdW5jdGlvbiBub3JtYWxpemVXaGl0ZVBvaW50VG9GbGF0KHNvdXJjZVdoaXRlUG9pbnQsIFhZWl9JbiwgcmVzdWx0KSB7CiAgICBpZiAoc291cmNlV2hpdGVQb2ludFswXSA9PT0gMSAmJiBzb3VyY2VXaGl0ZVBvaW50WzJdID09PSAxKSB7CiAgICAgIHJlc3VsdFswXSA9IFhZWl9JblswXTsKICAgICAgcmVzdWx0WzFdID0gWFlaX0luWzFdOwogICAgICByZXN1bHRbMl0gPSBYWVpfSW5bMl07CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgTE1TID0gcmVzdWx0OwogICAgbWF0cml4UHJvZHVjdChCUkFERk9SRF9TQ0FMRV9NQVRSSVgsIFhZWl9JbiwgTE1TKTsKICAgIHZhciBMTVNfRmxhdCA9IHRlbXBOb3JtYWxpemVNYXRyaXg7CiAgICBjb252ZXJ0VG9GbGF0KHNvdXJjZVdoaXRlUG9pbnQsIExNUywgTE1TX0ZsYXQpOwogICAgbWF0cml4UHJvZHVjdChCUkFERk9SRF9TQ0FMRV9JTlZFUlNFX01BVFJJWCwgTE1TX0ZsYXQsIHJlc3VsdCk7CiAgfQoKICBmdW5jdGlvbiBub3JtYWxpemVXaGl0ZVBvaW50VG9ENjUoc291cmNlV2hpdGVQb2ludCwgWFlaX0luLCByZXN1bHQpIHsKICAgIHZhciBMTVMgPSByZXN1bHQ7CiAgICBtYXRyaXhQcm9kdWN0KEJSQURGT1JEX1NDQUxFX01BVFJJWCwgWFlaX0luLCBMTVMpOwogICAgdmFyIExNU19ENjUgPSB0ZW1wTm9ybWFsaXplTWF0cml4OwogICAgY29udmVydFRvRDY1KHNvdXJjZVdoaXRlUG9pbnQsIExNUywgTE1TX0Q2NSk7CiAgICBtYXRyaXhQcm9kdWN0KEJSQURGT1JEX1NDQUxFX0lOVkVSU0VfTUFUUklYLCBMTVNfRDY1LCByZXN1bHQpOwogIH0KCiAgZnVuY3Rpb24gY29udmVydFRvUmdiKGNzLCBzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCwgc2NhbGUpIHsKICAgIHZhciBBID0gYWRqdXN0VG9SYW5nZSgwLCAxLCBzcmNbc3JjT2Zmc2V0XSAqIHNjYWxlKTsKICAgIHZhciBCID0gYWRqdXN0VG9SYW5nZSgwLCAxLCBzcmNbc3JjT2Zmc2V0ICsgMV0gKiBzY2FsZSk7CiAgICB2YXIgQyA9IGFkanVzdFRvUmFuZ2UoMCwgMSwgc3JjW3NyY09mZnNldCArIDJdICogc2NhbGUpOwogICAgdmFyIEFHUiA9IE1hdGgucG93KEEsIGNzLkdSKTsKICAgIHZhciBCR0cgPSBNYXRoLnBvdyhCLCBjcy5HRyk7CiAgICB2YXIgQ0dCID0gTWF0aC5wb3coQywgY3MuR0IpOwogICAgdmFyIFggPSBjcy5NWEEgKiBBR1IgKyBjcy5NWEIgKiBCR0cgKyBjcy5NWEMgKiBDR0I7CiAgICB2YXIgWSA9IGNzLk1ZQSAqIEFHUiArIGNzLk1ZQiAqIEJHRyArIGNzLk1ZQyAqIENHQjsKICAgIHZhciBaID0gY3MuTVpBICogQUdSICsgY3MuTVpCICogQkdHICsgY3MuTVpDICogQ0dCOwogICAgdmFyIFhZWiA9IHRlbXBDb252ZXJ0TWF0cml4MTsKICAgIFhZWlswXSA9IFg7CiAgICBYWVpbMV0gPSBZOwogICAgWFlaWzJdID0gWjsKICAgIHZhciBYWVpfRmxhdCA9IHRlbXBDb252ZXJ0TWF0cml4MjsKICAgIG5vcm1hbGl6ZVdoaXRlUG9pbnRUb0ZsYXQoY3Mud2hpdGVQb2ludCwgWFlaLCBYWVpfRmxhdCk7CiAgICB2YXIgWFlaX0JsYWNrID0gdGVtcENvbnZlcnRNYXRyaXgxOwogICAgY29tcGVuc2F0ZUJsYWNrUG9pbnQoY3MuYmxhY2tQb2ludCwgWFlaX0ZsYXQsIFhZWl9CbGFjayk7CiAgICB2YXIgWFlaX0Q2NSA9IHRlbXBDb252ZXJ0TWF0cml4MjsKICAgIG5vcm1hbGl6ZVdoaXRlUG9pbnRUb0Q2NShGTEFUX1dISVRFUE9JTlRfTUFUUklYLCBYWVpfQmxhY2ssIFhZWl9ENjUpOwogICAgdmFyIFNSR0IgPSB0ZW1wQ29udmVydE1hdHJpeDE7CiAgICBtYXRyaXhQcm9kdWN0KFNSR0JfRDY1X1hZWl9UT19SR0JfTUFUUklYLCBYWVpfRDY1LCBTUkdCKTsKICAgIGRlc3RbZGVzdE9mZnNldF0gPSBzUkdCVHJhbnNmZXJGdW5jdGlvbihTUkdCWzBdKSAqIDI1NTsKICAgIGRlc3RbZGVzdE9mZnNldCArIDFdID0gc1JHQlRyYW5zZmVyRnVuY3Rpb24oU1JHQlsxXSkgKiAyNTU7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAyXSA9IHNSR0JUcmFuc2ZlckZ1bmN0aW9uKFNSR0JbMl0pICogMjU1OwogIH0KCiAgdmFyIENhbFJHQkNTID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29sb3JTcGFjZTgpIHsKICAgIF9pbmhlcml0cyhDYWxSR0JDUywgX0NvbG9yU3BhY2U4KTsKCiAgICB2YXIgX3N1cGVyOCA9IF9jcmVhdGVTdXBlcihDYWxSR0JDUyk7CgogICAgZnVuY3Rpb24gQ2FsUkdCQ1Mod2hpdGVQb2ludCwgYmxhY2tQb2ludCwgZ2FtbWEsIG1hdHJpeCkgewogICAgICB2YXIgX3RoaXM1OwoKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhbFJHQkNTKTsKCiAgICAgIF90aGlzNSA9IF9zdXBlcjguY2FsbCh0aGlzLCAiQ2FsUkdCIiwgMyk7CgogICAgICBpZiAoIXdoaXRlUG9pbnQpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIldoaXRlUG9pbnQgbWlzc2luZyAtIHJlcXVpcmVkIGZvciBjb2xvciBzcGFjZSBDYWxSR0IiKTsKICAgICAgfQoKICAgICAgYmxhY2tQb2ludCA9IGJsYWNrUG9pbnQgfHwgbmV3IEZsb2F0MzJBcnJheSgzKTsKICAgICAgZ2FtbWEgPSBnYW1tYSB8fCBuZXcgRmxvYXQzMkFycmF5KFsxLCAxLCAxXSk7CiAgICAgIG1hdHJpeCA9IG1hdHJpeCB8fCBuZXcgRmxvYXQzMkFycmF5KFsxLCAwLCAwLCAwLCAxLCAwLCAwLCAwLCAxXSk7CiAgICAgIHZhciBYVyA9IHdoaXRlUG9pbnRbMF07CiAgICAgIHZhciBZVyA9IHdoaXRlUG9pbnRbMV07CiAgICAgIHZhciBaVyA9IHdoaXRlUG9pbnRbMl07CiAgICAgIF90aGlzNS53aGl0ZVBvaW50ID0gd2hpdGVQb2ludDsKICAgICAgdmFyIFhCID0gYmxhY2tQb2ludFswXTsKICAgICAgdmFyIFlCID0gYmxhY2tQb2ludFsxXTsKICAgICAgdmFyIFpCID0gYmxhY2tQb2ludFsyXTsKICAgICAgX3RoaXM1LmJsYWNrUG9pbnQgPSBibGFja1BvaW50OwogICAgICBfdGhpczUuR1IgPSBnYW1tYVswXTsKICAgICAgX3RoaXM1LkdHID0gZ2FtbWFbMV07CiAgICAgIF90aGlzNS5HQiA9IGdhbW1hWzJdOwogICAgICBfdGhpczUuTVhBID0gbWF0cml4WzBdOwogICAgICBfdGhpczUuTVlBID0gbWF0cml4WzFdOwogICAgICBfdGhpczUuTVpBID0gbWF0cml4WzJdOwogICAgICBfdGhpczUuTVhCID0gbWF0cml4WzNdOwogICAgICBfdGhpczUuTVlCID0gbWF0cml4WzRdOwogICAgICBfdGhpczUuTVpCID0gbWF0cml4WzVdOwogICAgICBfdGhpczUuTVhDID0gbWF0cml4WzZdOwogICAgICBfdGhpczUuTVlDID0gbWF0cml4WzddOwogICAgICBfdGhpczUuTVpDID0gbWF0cml4WzhdOwoKICAgICAgaWYgKFhXIDwgMCB8fCBaVyA8IDAgfHwgWVcgIT09IDEpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgV2hpdGVQb2ludCBjb21wb25lbnRzIGZvciAiLmNvbmNhdChfdGhpczUubmFtZSkgKyAiLCBubyBmYWxsYmFjayBhdmFpbGFibGUiKTsKICAgICAgfQoKICAgICAgaWYgKFhCIDwgMCB8fCBZQiA8IDAgfHwgWkIgPCAwKSB7CiAgICAgICAgKDAsIF91dGlsLmluZm8pKCJJbnZhbGlkIEJsYWNrUG9pbnQgZm9yICIuY29uY2F0KF90aGlzNS5uYW1lLCAiIFsiKS5jb25jYXQoWEIsICIsICIpLmNvbmNhdChZQiwgIiwgIikuY29uY2F0KFpCLCAiXSwgIikgKyAiZmFsbGluZyBiYWNrIHRvIGRlZmF1bHQuIik7CiAgICAgICAgX3RoaXM1LmJsYWNrUG9pbnQgPSBuZXcgRmxvYXQzMkFycmF5KDMpOwogICAgICB9CgogICAgICBpZiAoX3RoaXM1LkdSIDwgMCB8fCBfdGhpczUuR0cgPCAwIHx8IF90aGlzNS5HQiA8IDApIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkludmFsaWQgR2FtbWEgWyIuY29uY2F0KF90aGlzNS5HUiwgIiwgIikuY29uY2F0KF90aGlzNS5HRywgIiwgIikuY29uY2F0KF90aGlzNS5HQiwgIl0gZm9yICIpICsgIiIuY29uY2F0KF90aGlzNS5uYW1lLCAiLCBmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdC4iKSk7CiAgICAgICAgX3RoaXM1LkdSID0gX3RoaXM1LkdHID0gX3RoaXM1LkdCID0gMTsKICAgICAgfQoKICAgICAgcmV0dXJuIF90aGlzNTsKICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoQ2FsUkdCQ1MsIFt7CiAgICAgIGtleTogImdldFJnYkl0ZW0iLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmdiSXRlbShzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgICAgIGNvbnZlcnRUb1JnYih0aGlzLCBzcmMsIHNyY09mZnNldCwgZGVzdCwgZGVzdE9mZnNldCwgMSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2V0UmdiQnVmZmVyIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJnYkJ1ZmZlcihzcmMsIHNyY09mZnNldCwgY291bnQsIGRlc3QsIGRlc3RPZmZzZXQsIGJpdHMsIGFscGhhMDEpIHsKICAgICAgICB2YXIgc2NhbGUgPSAxIC8gKCgxIDw8IGJpdHMpIC0gMSk7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewogICAgICAgICAgY29udmVydFRvUmdiKHRoaXMsIHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0LCBzY2FsZSk7CiAgICAgICAgICBzcmNPZmZzZXQgKz0gMzsKICAgICAgICAgIGRlc3RPZmZzZXQgKz0gMyArIGFscGhhMDE7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldE91dHB1dExlbmd0aCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGgsIGFscGhhMDEpIHsKICAgICAgICByZXR1cm4gaW5wdXRMZW5ndGggKiAoMyArIGFscGhhMDEpIC8gMyB8IDA7CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gQ2FsUkdCQ1M7CiAgfShDb2xvclNwYWNlKTsKCiAgcmV0dXJuIENhbFJHQkNTOwp9KCk7Cgp2YXIgTGFiQ1MgPSBmdW5jdGlvbiBMYWJDU0Nsb3N1cmUoKSB7CiAgZnVuY3Rpb24gZm5fZyh4KSB7CiAgICB2YXIgcmVzdWx0OwoKICAgIGlmICh4ID49IDYgLyAyOSkgewogICAgICByZXN1bHQgPSB4ICogeCAqIHg7CiAgICB9IGVsc2UgewogICAgICByZXN1bHQgPSAxMDggLyA4NDEgKiAoeCAtIDQgLyAyOSk7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIGZ1bmN0aW9uIGRlY29kZSh2YWx1ZSwgaGlnaDEsIGxvdzIsIGhpZ2gyKSB7CiAgICByZXR1cm4gbG93MiArIHZhbHVlICogKGhpZ2gyIC0gbG93MikgLyBoaWdoMTsKICB9CgogIGZ1bmN0aW9uIGNvbnZlcnRUb1JnYihjcywgc3JjLCBzcmNPZmZzZXQsIG1heFZhbCwgZGVzdCwgZGVzdE9mZnNldCkgewogICAgdmFyIExzID0gc3JjW3NyY09mZnNldF07CiAgICB2YXIgYXMgPSBzcmNbc3JjT2Zmc2V0ICsgMV07CiAgICB2YXIgYnMgPSBzcmNbc3JjT2Zmc2V0ICsgMl07CgogICAgaWYgKG1heFZhbCAhPT0gZmFsc2UpIHsKICAgICAgTHMgPSBkZWNvZGUoTHMsIG1heFZhbCwgMCwgMTAwKTsKICAgICAgYXMgPSBkZWNvZGUoYXMsIG1heFZhbCwgY3MuYW1pbiwgY3MuYW1heCk7CiAgICAgIGJzID0gZGVjb2RlKGJzLCBtYXhWYWwsIGNzLmJtaW4sIGNzLmJtYXgpOwogICAgfQoKICAgIGlmIChhcyA+IGNzLmFtYXgpIHsKICAgICAgYXMgPSBjcy5hbWF4OwogICAgfSBlbHNlIGlmIChhcyA8IGNzLmFtaW4pIHsKICAgICAgYXMgPSBjcy5hbWluOwogICAgfQoKICAgIGlmIChicyA+IGNzLmJtYXgpIHsKICAgICAgYnMgPSBjcy5ibWF4OwogICAgfSBlbHNlIGlmIChicyA8IGNzLmJtaW4pIHsKICAgICAgYnMgPSBjcy5ibWluOwogICAgfQoKICAgIHZhciBNID0gKExzICsgMTYpIC8gMTE2OwogICAgdmFyIEwgPSBNICsgYXMgLyA1MDA7CiAgICB2YXIgTiA9IE0gLSBicyAvIDIwMDsKICAgIHZhciBYID0gY3MuWFcgKiBmbl9nKEwpOwogICAgdmFyIFkgPSBjcy5ZVyAqIGZuX2coTSk7CiAgICB2YXIgWiA9IGNzLlpXICogZm5fZyhOKTsKICAgIHZhciByLCBnLCBiOwoKICAgIGlmIChjcy5aVyA8IDEpIHsKICAgICAgciA9IFggKiAzLjEzMzkgKyBZICogLTEuNjE3ICsgWiAqIC0wLjQ5MDY7CiAgICAgIGcgPSBYICogLTAuOTc4NSArIFkgKiAxLjkxNiArIFogKiAwLjAzMzM7CiAgICAgIGIgPSBYICogMC4wNzIgKyBZICogLTAuMjI5ICsgWiAqIDEuNDA1NzsKICAgIH0gZWxzZSB7CiAgICAgIHIgPSBYICogMy4yNDA2ICsgWSAqIC0xLjUzNzIgKyBaICogLTAuNDk4NjsKICAgICAgZyA9IFggKiAtMC45Njg5ICsgWSAqIDEuODc1OCArIFogKiAwLjA0MTU7CiAgICAgIGIgPSBYICogMC4wNTU3ICsgWSAqIC0wLjIwNCArIFogKiAxLjA1NzsKICAgIH0KCiAgICBkZXN0W2Rlc3RPZmZzZXRdID0gTWF0aC5zcXJ0KHIpICogMjU1OwogICAgZGVzdFtkZXN0T2Zmc2V0ICsgMV0gPSBNYXRoLnNxcnQoZykgKiAyNTU7CiAgICBkZXN0W2Rlc3RPZmZzZXQgKyAyXSA9IE1hdGguc3FydChiKSAqIDI1NTsKICB9CgogIHZhciBMYWJDUyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbG9yU3BhY2U5KSB7CiAgICBfaW5oZXJpdHMoTGFiQ1MsIF9Db2xvclNwYWNlOSk7CgogICAgdmFyIF9zdXBlcjkgPSBfY3JlYXRlU3VwZXIoTGFiQ1MpOwoKICAgIGZ1bmN0aW9uIExhYkNTKHdoaXRlUG9pbnQsIGJsYWNrUG9pbnQsIHJhbmdlKSB7CiAgICAgIHZhciBfdGhpczY7CgogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGFiQ1MpOwoKICAgICAgX3RoaXM2ID0gX3N1cGVyOS5jYWxsKHRoaXMsICJMYWIiLCAzKTsKCiAgICAgIGlmICghd2hpdGVQb2ludCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiV2hpdGVQb2ludCBtaXNzaW5nIC0gcmVxdWlyZWQgZm9yIGNvbG9yIHNwYWNlIExhYiIpOwogICAgICB9CgogICAgICBibGFja1BvaW50ID0gYmxhY2tQb2ludCB8fCBbMCwgMCwgMF07CiAgICAgIHJhbmdlID0gcmFuZ2UgfHwgWy0xMDAsIDEwMCwgLTEwMCwgMTAwXTsKICAgICAgX3RoaXM2LlhXID0gd2hpdGVQb2ludFswXTsKICAgICAgX3RoaXM2LllXID0gd2hpdGVQb2ludFsxXTsKICAgICAgX3RoaXM2LlpXID0gd2hpdGVQb2ludFsyXTsKICAgICAgX3RoaXM2LmFtaW4gPSByYW5nZVswXTsKICAgICAgX3RoaXM2LmFtYXggPSByYW5nZVsxXTsKICAgICAgX3RoaXM2LmJtaW4gPSByYW5nZVsyXTsKICAgICAgX3RoaXM2LmJtYXggPSByYW5nZVszXTsKICAgICAgX3RoaXM2LlhCID0gYmxhY2tQb2ludFswXTsKICAgICAgX3RoaXM2LllCID0gYmxhY2tQb2ludFsxXTsKICAgICAgX3RoaXM2LlpCID0gYmxhY2tQb2ludFsyXTsKCiAgICAgIGlmIChfdGhpczYuWFcgPCAwIHx8IF90aGlzNi5aVyA8IDAgfHwgX3RoaXM2LllXICE9PSAxKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFdoaXRlUG9pbnQgY29tcG9uZW50cywgbm8gZmFsbGJhY2sgYXZhaWxhYmxlIik7CiAgICAgIH0KCiAgICAgIGlmIChfdGhpczYuWEIgPCAwIHx8IF90aGlzNi5ZQiA8IDAgfHwgX3RoaXM2LlpCIDwgMCkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKSgiSW52YWxpZCBCbGFja1BvaW50LCBmYWxsaW5nIGJhY2sgdG8gZGVmYXVsdCIpOwogICAgICAgIF90aGlzNi5YQiA9IF90aGlzNi5ZQiA9IF90aGlzNi5aQiA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChfdGhpczYuYW1pbiA+IF90aGlzNi5hbWF4IHx8IF90aGlzNi5ibWluID4gX3RoaXM2LmJtYXgpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkludmFsaWQgUmFuZ2UsIGZhbGxpbmcgYmFjayB0byBkZWZhdWx0cyIpOwogICAgICAgIF90aGlzNi5hbWluID0gLTEwMDsKICAgICAgICBfdGhpczYuYW1heCA9IDEwMDsKICAgICAgICBfdGhpczYuYm1pbiA9IC0xMDA7CiAgICAgICAgX3RoaXM2LmJtYXggPSAxMDA7CiAgICAgIH0KCiAgICAgIHJldHVybiBfdGhpczY7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKExhYkNTLCBbewogICAgICBrZXk6ICJnZXRSZ2JJdGVtIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJnYkl0ZW0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgICBjb252ZXJ0VG9SZ2IodGhpcywgc3JjLCBzcmNPZmZzZXQsIGZhbHNlLCBkZXN0LCBkZXN0T2Zmc2V0KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZXRSZ2JCdWZmZXIiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmdiQnVmZmVyKHNyYywgc3JjT2Zmc2V0LCBjb3VudCwgZGVzdCwgZGVzdE9mZnNldCwgYml0cywgYWxwaGEwMSkgewogICAgICAgIHZhciBtYXhWYWwgPSAoMSA8PCBiaXRzKSAtIDE7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgICAgY29udmVydFRvUmdiKHRoaXMsIHNyYywgc3JjT2Zmc2V0LCBtYXhWYWwsIGRlc3QsIGRlc3RPZmZzZXQpOwogICAgICAgICAgc3JjT2Zmc2V0ICs9IDM7CiAgICAgICAgICBkZXN0T2Zmc2V0ICs9IDMgKyBhbHBoYTAxOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZXRPdXRwdXRMZW5ndGgiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0T3V0cHV0TGVuZ3RoKGlucHV0TGVuZ3RoLCBhbHBoYTAxKSB7CiAgICAgICAgcmV0dXJuIGlucHV0TGVuZ3RoICogKDMgKyBhbHBoYTAxKSAvIDMgfCAwOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImlzRGVmYXVsdERlY29kZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc0RlZmF1bHREZWNvZGUoZGVjb2RlTWFwLCBicGMpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ1c2VzWmVyb1RvT25lUmFuZ2UiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInVzZXNaZXJvVG9PbmVSYW5nZSIsIGZhbHNlKTsKICAgICAgfQogICAgfV0pOwoKICAgIHJldHVybiBMYWJDUzsKICB9KENvbG9yU3BhY2UpOwoKICByZXR1cm4gTGFiQ1M7Cn0oKTsKCi8qKiovIH0pLAovKiAyMTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5HbG9iYWxJbWFnZUNhY2hlID0gZXhwb3J0cy5Mb2NhbEltYWdlQ2FjaGUgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTgpOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCnZhciBMb2NhbEltYWdlQ2FjaGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIExvY2FsSW1hZ2VDYWNoZSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMb2NhbEltYWdlQ2FjaGUpOwoKICAgIHRoaXMuX25hbWVSZWZNYXAgPSBuZXcgTWFwKCk7CiAgICB0aGlzLl9pbWFnZU1hcCA9IG5ldyBNYXAoKTsKICAgIHRoaXMuX2ltYWdlQ2FjaGUgPSBuZXcgX3ByaW1pdGl2ZXMuUmVmU2V0Q2FjaGUoKTsKICB9CgogIF9jcmVhdGVDbGFzcyhMb2NhbEltYWdlQ2FjaGUsIFt7CiAgICBrZXk6ICJnZXRCeU5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJ5TmFtZShuYW1lKSB7CiAgICAgIHZhciByZWYgPSB0aGlzLl9uYW1lUmVmTWFwLmdldChuYW1lKTsKCiAgICAgIGlmIChyZWYpIHsKICAgICAgICByZXR1cm4gdGhpcy5nZXRCeVJlZihyZWYpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5faW1hZ2VNYXAuZ2V0KG5hbWUpIHx8IG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QnlSZWYiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJ5UmVmKHJlZikgewogICAgICByZXR1cm4gdGhpcy5faW1hZ2VDYWNoZS5nZXQocmVmKSB8fCBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogInNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0KG5hbWUpIHsKICAgICAgdmFyIHJlZiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKCiAgICAgIGlmICghbmFtZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignTG9jYWxJbWFnZUNhY2hlLnNldCAtIGV4cGVjdGVkICJuYW1lIiBhcmd1bWVudC4nKTsKICAgICAgfQoKICAgICAgaWYgKHJlZikgewogICAgICAgIGlmICh0aGlzLl9pbWFnZUNhY2hlLmhhcyhyZWYpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0aGlzLl9uYW1lUmVmTWFwLnNldChuYW1lLCByZWYpOwoKICAgICAgICB0aGlzLl9pbWFnZUNhY2hlLnB1dChyZWYsIGRhdGEpOwoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9pbWFnZU1hcC5oYXMobmFtZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuX2ltYWdlTWFwLnNldChuYW1lLCBkYXRhKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBMb2NhbEltYWdlQ2FjaGU7Cn0oKTsKCmV4cG9ydHMuTG9jYWxJbWFnZUNhY2hlID0gTG9jYWxJbWFnZUNhY2hlOwoKdmFyIEdsb2JhbEltYWdlQ2FjaGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIF9jcmVhdGVDbGFzcyhHbG9iYWxJbWFnZUNhY2hlLCBudWxsLCBbewogICAga2V5OiAiTlVNX1BBR0VTX1RIUkVTSE9MRCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJOVU1fUEFHRVNfVEhSRVNIT0xEIiwgMik7CiAgICB9CiAgfSwgewogICAga2V5OiAiTUFYX0lNQUdFU19UT19DQUNIRSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJNQVhfSU1BR0VTX1RPX0NBQ0hFIiwgMTApOwogICAgfQogIH1dKTsKCiAgZnVuY3Rpb24gR2xvYmFsSW1hZ2VDYWNoZSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBHbG9iYWxJbWFnZUNhY2hlKTsKCiAgICB0aGlzLl9yZWZDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogICAgdGhpcy5faW1hZ2VDYWNoZSA9IG5ldyBfcHJpbWl0aXZlcy5SZWZTZXRDYWNoZSgpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEdsb2JhbEltYWdlQ2FjaGUsIFt7CiAgICBrZXk6ICJzaG91bGRDYWNoZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkQ2FjaGUocmVmLCBwYWdlSW5kZXgpIHsKICAgICAgdmFyIHBhZ2VJbmRleFNldCA9IHRoaXMuX3JlZkNhY2hlLmdldChyZWYpOwoKICAgICAgdmFyIG51bVBhZ2VzID0gcGFnZUluZGV4U2V0ID8gcGFnZUluZGV4U2V0LnNpemUgKyAocGFnZUluZGV4U2V0LmhhcyhwYWdlSW5kZXgpID8gMCA6IDEpIDogMTsKCiAgICAgIGlmIChudW1QYWdlcyA8IEdsb2JhbEltYWdlQ2FjaGUuTlVNX1BBR0VTX1RIUkVTSE9MRCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLl9pbWFnZUNhY2hlLmhhcyhyZWYpICYmIHRoaXMuX2ltYWdlQ2FjaGUuc2l6ZSA+PSBHbG9iYWxJbWFnZUNhY2hlLk1BWF9JTUFHRVNfVE9fQ0FDSEUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogImFkZFBhZ2VJbmRleCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkUGFnZUluZGV4KHJlZiwgcGFnZUluZGV4KSB7CiAgICAgIHZhciBwYWdlSW5kZXhTZXQgPSB0aGlzLl9yZWZDYWNoZS5nZXQocmVmKTsKCiAgICAgIGlmICghcGFnZUluZGV4U2V0KSB7CiAgICAgICAgcGFnZUluZGV4U2V0ID0gbmV3IFNldCgpOwoKICAgICAgICB0aGlzLl9yZWZDYWNoZS5wdXQocmVmLCBwYWdlSW5kZXhTZXQpOwogICAgICB9CgogICAgICBwYWdlSW5kZXhTZXQuYWRkKHBhZ2VJbmRleCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YShyZWYsIHBhZ2VJbmRleCkgewogICAgICBpZiAoIXRoaXMuX3JlZkNhY2hlLmhhcyhyZWYpKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBwYWdlSW5kZXhTZXQgPSB0aGlzLl9yZWZDYWNoZS5nZXQocmVmKTsKCiAgICAgIGlmIChwYWdlSW5kZXhTZXQuc2l6ZSA8IEdsb2JhbEltYWdlQ2FjaGUuTlVNX1BBR0VTX1RIUkVTSE9MRCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuX2ltYWdlQ2FjaGUuaGFzKHJlZikpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgcGFnZUluZGV4U2V0LmFkZChwYWdlSW5kZXgpOwogICAgICByZXR1cm4gdGhpcy5faW1hZ2VDYWNoZS5nZXQocmVmKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREYXRhKHJlZiwgZGF0YSkgewogICAgICBpZiAoIXRoaXMuX3JlZkNhY2hlLmhhcyhyZWYpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdHbG9iYWxJbWFnZUNhY2hlLnNldERhdGEgLSBleHBlY3RlZCAiYWRkUGFnZUluZGV4IiB0byBoYXZlIGJlZW4gY2FsbGVkLicpOwogICAgICB9CgogICAgICBpZiAodGhpcy5faW1hZ2VDYWNoZS5oYXMocmVmKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuX2ltYWdlQ2FjaGUuc2l6ZSA+PSBHbG9iYWxJbWFnZUNhY2hlLk1BWF9JTUFHRVNfVE9fQ0FDSEUpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkdsb2JhbEltYWdlQ2FjaGUuc2V0RGF0YSAtIGlnbm9yaW5nIGltYWdlIGFib3ZlIE1BWF9JTUFHRVNfVE9fQ0FDSEUuIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLl9pbWFnZUNhY2hlLnB1dChyZWYsIGRhdGEpOwogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcigpIHsKICAgICAgdmFyIG9ubHlEYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKCiAgICAgIGlmICghb25seURhdGEpIHsKICAgICAgICB0aGlzLl9yZWZDYWNoZS5jbGVhcigpOwogICAgICB9CgogICAgICB0aGlzLl9pbWFnZUNhY2hlLmNsZWFyKCk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gR2xvYmFsSW1hZ2VDYWNoZTsKfSgpOwoKZXhwb3J0cy5HbG9iYWxJbWFnZUNhY2hlID0gR2xvYmFsSW1hZ2VDYWNoZTsKCi8qKiovIH0pLAovKiAyMTggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5nZXRRdWFkUG9pbnRzID0gZ2V0UXVhZFBvaW50czsKZXhwb3J0cy5NYXJrdXBBbm5vdGF0aW9uID0gZXhwb3J0cy5Bbm5vdGF0aW9uRmFjdG9yeSA9IGV4cG9ydHMuQW5ub3RhdGlvbkJvcmRlclN0eWxlID0gZXhwb3J0cy5Bbm5vdGF0aW9uID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfb2JqID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDMpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTgpOwoKdmFyIF9jb2xvcnNwYWNlID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTYpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpOwoKdmFyIF9vcGVyYXRvcl9saXN0ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTkpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNSk7CgpmdW5jdGlvbiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmICh0eXBlb2YgUmVmbGVjdCAhPT0gInVuZGVmaW5lZCIgJiYgUmVmbGVjdC5nZXQpIHsgX2dldCA9IFJlZmxlY3QuZ2V0OyB9IGVsc2UgeyBfZ2V0ID0gZnVuY3Rpb24gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlcikgeyB2YXIgYmFzZSA9IF9zdXBlclByb3BCYXNlKHRhcmdldCwgcHJvcGVydHkpOyBpZiAoIWJhc2UpIHJldHVybjsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGJhc2UsIHByb3BlcnR5KTsgaWYgKGRlc2MuZ2V0KSB7IHJldHVybiBkZXNjLmdldC5jYWxsKHJlY2VpdmVyKTsgfSByZXR1cm4gZGVzYy52YWx1ZTsgfTsgfSByZXR1cm4gX2dldCh0YXJnZXQsIHByb3BlcnR5LCByZWNlaXZlciB8fCB0YXJnZXQpOyB9CgpmdW5jdGlvbiBfc3VwZXJQcm9wQmFzZShvYmplY3QsIHByb3BlcnR5KSB7IHdoaWxlICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpKSB7IG9iamVjdCA9IF9nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAob2JqZWN0ID09PSBudWxsKSBicmVhazsgfSByZXR1cm4gb2JqZWN0OyB9CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7IHZhciBpdDsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJ1bmRlZmluZWQiIHx8IG9bU3ltYm9sLml0ZXJhdG9yXSA9PSBudWxsKSB7IGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSB7IGlmIChpdCkgbyA9IGl0OyB2YXIgaSA9IDA7IHZhciBGID0gZnVuY3Rpb24gRigpIHt9OyByZXR1cm4geyBzOiBGLCBuOiBmdW5jdGlvbiBuKCkgeyBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHsgZG9uZTogdHJ1ZSB9OyByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IG9baSsrXSB9OyB9LCBlOiBmdW5jdGlvbiBlKF9lMikgeyB0aHJvdyBfZTI7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0gdmFyIG5vcm1hbENvbXBsZXRpb24gPSB0cnVlLCBkaWRFcnIgPSBmYWxzZSwgZXJyOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyBpdCA9IG9bU3ltYm9sLml0ZXJhdG9yXSgpOyB9LCBuOiBmdW5jdGlvbiBuKCkgeyB2YXIgc3RlcCA9IGl0Lm5leHQoKTsgbm9ybWFsQ29tcGxldGlvbiA9IHN0ZXAuZG9uZTsgcmV0dXJuIHN0ZXA7IH0sIGU6IGZ1bmN0aW9uIGUoX2UzKSB7IGRpZEVyciA9IHRydWU7IGVyciA9IF9lMzsgfSwgZjogZnVuY3Rpb24gZigpIHsgdHJ5IHsgaWYgKCFub3JtYWxDb21wbGV0aW9uICYmIGl0WyJyZXR1cm4iXSAhPSBudWxsKSBpdFsicmV0dXJuIl0oKTsgfSBmaW5hbGx5IHsgaWYgKGRpZEVycikgdGhyb3cgZXJyOyB9IH0gfTsgfQoKZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7IHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBfbm9uSXRlcmFibGVSZXN0KCk7IH0KCmZ1bmN0aW9uIF9ub25JdGVyYWJsZVJlc3QoKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJ1bmRlZmluZWQiIHx8ICEoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSkgcmV0dXJuOyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsicmV0dXJuIl0gIT0gbnVsbCkgX2lbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfQoKZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKdmFyIEFubm90YXRpb25GYWN0b3J5ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBBbm5vdGF0aW9uRmFjdG9yeSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBbm5vdGF0aW9uRmFjdG9yeSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQW5ub3RhdGlvbkZhY3RvcnksIG51bGwsIFt7CiAgICBrZXk6ICJjcmVhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZSh4cmVmLCByZWYsIHBkZk1hbmFnZXIsIGlkRmFjdG9yeSkgewogICAgICByZXR1cm4gcGRmTWFuYWdlci5lbnN1cmUodGhpcywgIl9jcmVhdGUiLCBbeHJlZiwgcmVmLCBwZGZNYW5hZ2VyLCBpZEZhY3RvcnldKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfY3JlYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlKHhyZWYsIHJlZiwgcGRmTWFuYWdlciwgaWRGYWN0b3J5KSB7CiAgICAgIHZhciBkaWN0ID0geHJlZi5mZXRjaElmUmVmKHJlZik7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGRpY3QpKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgdmFyIGlkID0gKDAsIF9wcmltaXRpdmVzLmlzUmVmKShyZWYpID8gcmVmLnRvU3RyaW5nKCkgOiAiYW5ub3RfIi5jb25jYXQoaWRGYWN0b3J5LmNyZWF0ZU9iaklkKCkpOwogICAgICB2YXIgc3VidHlwZSA9IGRpY3QuZ2V0KCJTdWJ0eXBlIik7CiAgICAgIHN1YnR5cGUgPSAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShzdWJ0eXBlKSA/IHN1YnR5cGUubmFtZSA6IG51bGw7CiAgICAgIHZhciBwYXJhbWV0ZXJzID0gewogICAgICAgIHhyZWY6IHhyZWYsCiAgICAgICAgZGljdDogZGljdCwKICAgICAgICBzdWJ0eXBlOiBzdWJ0eXBlLAogICAgICAgIGlkOiBpZCwKICAgICAgICBwZGZNYW5hZ2VyOiBwZGZNYW5hZ2VyCiAgICAgIH07CgogICAgICBzd2l0Y2ggKHN1YnR5cGUpIHsKICAgICAgICBjYXNlICJMaW5rIjoKICAgICAgICAgIHJldHVybiBuZXcgTGlua0Fubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgIGNhc2UgIlRleHQiOgogICAgICAgICAgcmV0dXJuIG5ldyBUZXh0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgY2FzZSAiV2lkZ2V0IjoKICAgICAgICAgIHZhciBmaWVsZFR5cGUgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eSkoewogICAgICAgICAgICBkaWN0OiBkaWN0LAogICAgICAgICAgICBrZXk6ICJGVCIKICAgICAgICAgIH0pOwogICAgICAgICAgZmllbGRUeXBlID0gKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZmllbGRUeXBlKSA/IGZpZWxkVHlwZS5uYW1lIDogbnVsbDsKCiAgICAgICAgICBzd2l0Y2ggKGZpZWxkVHlwZSkgewogICAgICAgICAgICBjYXNlICJUeCI6CiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUZXh0V2lkZ2V0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgICAgIGNhc2UgIkJ0biI6CiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCdXR0b25XaWRnZXRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgICAgICAgY2FzZSAiQ2giOgogICAgICAgICAgICAgIHJldHVybiBuZXcgQ2hvaWNlV2lkZ2V0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKICAgICAgICAgIH0KCiAgICAgICAgICAoMCwgX3V0aWwud2FybikoJ1VuaW1wbGVtZW50ZWQgd2lkZ2V0IGZpZWxkIHR5cGUgIicgKyBmaWVsZFR5cGUgKyAnIiwgJyArICJmYWxsaW5nIGJhY2sgdG8gYmFzZSBmaWVsZCB0eXBlLiIpOwogICAgICAgICAgcmV0dXJuIG5ldyBXaWRnZXRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgICBjYXNlICJQb3B1cCI6CiAgICAgICAgICByZXR1cm4gbmV3IFBvcHVwQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgY2FzZSAiRnJlZVRleHQiOgogICAgICAgICAgcmV0dXJuIG5ldyBGcmVlVGV4dEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgIGNhc2UgIkxpbmUiOgogICAgICAgICAgcmV0dXJuIG5ldyBMaW5lQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgY2FzZSAiU3F1YXJlIjoKICAgICAgICAgIHJldHVybiBuZXcgU3F1YXJlQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgY2FzZSAiQ2lyY2xlIjoKICAgICAgICAgIHJldHVybiBuZXcgQ2lyY2xlQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgY2FzZSAiUG9seUxpbmUiOgogICAgICAgICAgcmV0dXJuIG5ldyBQb2x5bGluZUFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgIGNhc2UgIlBvbHlnb24iOgogICAgICAgICAgcmV0dXJuIG5ldyBQb2x5Z29uQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgY2FzZSAiQ2FyZXQiOgogICAgICAgICAgcmV0dXJuIG5ldyBDYXJldEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgIGNhc2UgIkluayI6CiAgICAgICAgICByZXR1cm4gbmV3IElua0Fubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgIGNhc2UgIkhpZ2hsaWdodCI6CiAgICAgICAgICByZXR1cm4gbmV3IEhpZ2hsaWdodEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgIGNhc2UgIlVuZGVybGluZSI6CiAgICAgICAgICByZXR1cm4gbmV3IFVuZGVybGluZUFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgIGNhc2UgIlNxdWlnZ2x5IjoKICAgICAgICAgIHJldHVybiBuZXcgU3F1aWdnbHlBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgICBjYXNlICJTdHJpa2VPdXQiOgogICAgICAgICAgcmV0dXJuIG5ldyBTdHJpa2VPdXRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpOwoKICAgICAgICBjYXNlICJTdGFtcCI6CiAgICAgICAgICByZXR1cm4gbmV3IFN0YW1wQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKCiAgICAgICAgY2FzZSAiRmlsZUF0dGFjaG1lbnQiOgogICAgICAgICAgcmV0dXJuIG5ldyBGaWxlQXR0YWNobWVudEFubm90YXRpb24ocGFyYW1ldGVycyk7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAoIXN1YnR5cGUpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJBbm5vdGF0aW9uIGlzIG1pc3NpbmcgdGhlIHJlcXVpcmVkIC9TdWJ0eXBlLiIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCdVbmltcGxlbWVudGVkIGFubm90YXRpb24gdHlwZSAiJyArIHN1YnR5cGUgKyAnIiwgJyArICJmYWxsaW5nIGJhY2sgdG8gYmFzZSBhbm5vdGF0aW9uLiIpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuZXcgQW5ub3RhdGlvbihwYXJhbWV0ZXJzKTsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIEFubm90YXRpb25GYWN0b3J5Owp9KCk7CgpleHBvcnRzLkFubm90YXRpb25GYWN0b3J5ID0gQW5ub3RhdGlvbkZhY3Rvcnk7CgpmdW5jdGlvbiBnZXRRdWFkUG9pbnRzKGRpY3QsIHJlY3QpIHsKICBpZiAoIWRpY3QuaGFzKCJRdWFkUG9pbnRzIikpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgdmFyIHF1YWRQb2ludHMgPSBkaWN0LmdldEFycmF5KCJRdWFkUG9pbnRzIik7CgogIGlmICghQXJyYXkuaXNBcnJheShxdWFkUG9pbnRzKSB8fCBxdWFkUG9pbnRzLmxlbmd0aCAlIDggPiAwKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIHZhciBxdWFkUG9pbnRzTGlzdHMgPSBbXTsKCiAgZm9yICh2YXIgaSA9IDAsIGlpID0gcXVhZFBvaW50cy5sZW5ndGggLyA4OyBpIDwgaWk7IGkrKykgewogICAgcXVhZFBvaW50c0xpc3RzLnB1c2goW10pOwoKICAgIGZvciAodmFyIGogPSBpICogOCwgamogPSBpICogOCArIDg7IGogPCBqajsgaiArPSAyKSB7CiAgICAgIHZhciB4ID0gcXVhZFBvaW50c1tqXTsKICAgICAgdmFyIHkgPSBxdWFkUG9pbnRzW2ogKyAxXTsKCiAgICAgIGlmICh4IDwgcmVjdFswXSB8fCB4ID4gcmVjdFsyXSB8fCB5IDwgcmVjdFsxXSB8fCB5ID4gcmVjdFszXSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICBxdWFkUG9pbnRzTGlzdHNbaV0ucHVzaCh7CiAgICAgICAgeDogeCwKICAgICAgICB5OiB5CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHF1YWRQb2ludHNMaXN0czsKfQoKZnVuY3Rpb24gZ2V0VHJhbnNmb3JtTWF0cml4KHJlY3QsIGJib3gsIG1hdHJpeCkgewogIHZhciBfVXRpbCRnZXRBeGlhbEFsaWduZWQgPSBfdXRpbC5VdGlsLmdldEF4aWFsQWxpZ25lZEJvdW5kaW5nQm94KGJib3gsIG1hdHJpeCksCiAgICAgIF9VdGlsJGdldEF4aWFsQWxpZ25lZDIgPSBfc2xpY2VkVG9BcnJheShfVXRpbCRnZXRBeGlhbEFsaWduZWQsIDQpLAogICAgICBtaW5YID0gX1V0aWwkZ2V0QXhpYWxBbGlnbmVkMlswXSwKICAgICAgbWluWSA9IF9VdGlsJGdldEF4aWFsQWxpZ25lZDJbMV0sCiAgICAgIG1heFggPSBfVXRpbCRnZXRBeGlhbEFsaWduZWQyWzJdLAogICAgICBtYXhZID0gX1V0aWwkZ2V0QXhpYWxBbGlnbmVkMlszXTsKCiAgaWYgKG1pblggPT09IG1heFggfHwgbWluWSA9PT0gbWF4WSkgewogICAgcmV0dXJuIFsxLCAwLCAwLCAxLCByZWN0WzBdLCByZWN0WzFdXTsKICB9CgogIHZhciB4UmF0aW8gPSAocmVjdFsyXSAtIHJlY3RbMF0pIC8gKG1heFggLSBtaW5YKTsKICB2YXIgeVJhdGlvID0gKHJlY3RbM10gLSByZWN0WzFdKSAvIChtYXhZIC0gbWluWSk7CiAgcmV0dXJuIFt4UmF0aW8sIDAsIDAsIHlSYXRpbywgcmVjdFswXSAtIG1pblggKiB4UmF0aW8sIHJlY3RbMV0gLSBtaW5ZICogeVJhdGlvXTsKfQoKdmFyIEFubm90YXRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEFubm90YXRpb24ocGFyYW1zKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQW5ub3RhdGlvbik7CgogICAgdmFyIGRpY3QgPSBwYXJhbXMuZGljdDsKICAgIHRoaXMuc2V0Q29udGVudHMoZGljdC5nZXQoIkNvbnRlbnRzIikpOwogICAgdGhpcy5zZXRNb2RpZmljYXRpb25EYXRlKGRpY3QuZ2V0KCJNIikpOwogICAgdGhpcy5zZXRGbGFncyhkaWN0LmdldCgiRiIpKTsKICAgIHRoaXMuc2V0UmVjdGFuZ2xlKGRpY3QuZ2V0QXJyYXkoIlJlY3QiKSk7CiAgICB0aGlzLnNldENvbG9yKGRpY3QuZ2V0QXJyYXkoIkMiKSk7CiAgICB0aGlzLnNldEJvcmRlclN0eWxlKGRpY3QpOwogICAgdGhpcy5zZXRBcHBlYXJhbmNlKGRpY3QpOwogICAgdGhpcy5kYXRhID0gewogICAgICBhbm5vdGF0aW9uRmxhZ3M6IHRoaXMuZmxhZ3MsCiAgICAgIGJvcmRlclN0eWxlOiB0aGlzLmJvcmRlclN0eWxlLAogICAgICBjb2xvcjogdGhpcy5jb2xvciwKICAgICAgY29udGVudHM6IHRoaXMuY29udGVudHMsCiAgICAgIGhhc0FwcGVhcmFuY2U6ICEhdGhpcy5hcHBlYXJhbmNlLAogICAgICBpZDogcGFyYW1zLmlkLAogICAgICBtb2RpZmljYXRpb25EYXRlOiB0aGlzLm1vZGlmaWNhdGlvbkRhdGUsCiAgICAgIHJlY3Q6IHRoaXMucmVjdGFuZ2xlLAogICAgICBzdWJ0eXBlOiBwYXJhbXMuc3VidHlwZQogICAgfTsKICB9CgogIF9jcmVhdGVDbGFzcyhBbm5vdGF0aW9uLCBbewogICAga2V5OiAiX2hhc0ZsYWciLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9oYXNGbGFnKGZsYWdzLCBmbGFnKSB7CiAgICAgIHJldHVybiAhIShmbGFncyAmIGZsYWcpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9pc1ZpZXdhYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNWaWV3YWJsZShmbGFncykgewogICAgICByZXR1cm4gIXRoaXMuX2hhc0ZsYWcoZmxhZ3MsIF91dGlsLkFubm90YXRpb25GbGFnLklOVklTSUJMRSkgJiYgIXRoaXMuX2hhc0ZsYWcoZmxhZ3MsIF91dGlsLkFubm90YXRpb25GbGFnLkhJRERFTikgJiYgIXRoaXMuX2hhc0ZsYWcoZmxhZ3MsIF91dGlsLkFubm90YXRpb25GbGFnLk5PVklFVyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2lzUHJpbnRhYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNQcmludGFibGUoZmxhZ3MpIHsKICAgICAgcmV0dXJuIHRoaXMuX2hhc0ZsYWcoZmxhZ3MsIF91dGlsLkFubm90YXRpb25GbGFnLlBSSU5UKSAmJiAhdGhpcy5faGFzRmxhZyhmbGFncywgX3V0aWwuQW5ub3RhdGlvbkZsYWcuSU5WSVNJQkxFKSAmJiAhdGhpcy5faGFzRmxhZyhmbGFncywgX3V0aWwuQW5ub3RhdGlvbkZsYWcuSElEREVOKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRDb250ZW50cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q29udGVudHMoY29udGVudHMpIHsKICAgICAgdGhpcy5jb250ZW50cyA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoY29udGVudHMgfHwgIiIpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldE1vZGlmaWNhdGlvbkRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldE1vZGlmaWNhdGlvbkRhdGUobW9kaWZpY2F0aW9uRGF0ZSkgewogICAgICB0aGlzLm1vZGlmaWNhdGlvbkRhdGUgPSAoMCwgX3V0aWwuaXNTdHJpbmcpKG1vZGlmaWNhdGlvbkRhdGUpID8gbW9kaWZpY2F0aW9uRGF0ZSA6IG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0RmxhZ3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZsYWdzKGZsYWdzKSB7CiAgICAgIHRoaXMuZmxhZ3MgPSBOdW1iZXIuaXNJbnRlZ2VyKGZsYWdzKSAmJiBmbGFncyA+IDAgPyBmbGFncyA6IDA7CiAgICB9CiAgfSwgewogICAga2V5OiAiaGFzRmxhZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzRmxhZyhmbGFnKSB7CiAgICAgIHJldHVybiB0aGlzLl9oYXNGbGFnKHRoaXMuZmxhZ3MsIGZsYWcpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFJlY3RhbmdsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0UmVjdGFuZ2xlKHJlY3RhbmdsZSkgewogICAgICBpZiAoQXJyYXkuaXNBcnJheShyZWN0YW5nbGUpICYmIHJlY3RhbmdsZS5sZW5ndGggPT09IDQpIHsKICAgICAgICB0aGlzLnJlY3RhbmdsZSA9IF91dGlsLlV0aWwubm9ybWFsaXplUmVjdChyZWN0YW5nbGUpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucmVjdGFuZ2xlID0gWzAsIDAsIDAsIDBdOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Q29sb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbG9yKGNvbG9yKSB7CiAgICAgIHZhciByZ2JDb2xvciA9IG5ldyBVaW50OENsYW1wZWRBcnJheSgzKTsKCiAgICAgIGlmICghQXJyYXkuaXNBcnJheShjb2xvcikpIHsKICAgICAgICB0aGlzLmNvbG9yID0gcmdiQ29sb3I7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBzd2l0Y2ggKGNvbG9yLmxlbmd0aCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHRoaXMuY29sb3IgPSBudWxsOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5ncmF5LmdldFJnYkl0ZW0oY29sb3IsIDAsIHJnYkNvbG9yLCAwKTsKCiAgICAgICAgICB0aGlzLmNvbG9yID0gcmdiQ29sb3I7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLnJnYi5nZXRSZ2JJdGVtKGNvbG9yLCAwLCByZ2JDb2xvciwgMCk7CgogICAgICAgICAgdGhpcy5jb2xvciA9IHJnYkNvbG9yOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgNDoKICAgICAgICAgIF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5jbXlrLmdldFJnYkl0ZW0oY29sb3IsIDAsIHJnYkNvbG9yLCAwKTsKCiAgICAgICAgICB0aGlzLmNvbG9yID0gcmdiQ29sb3I7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRoaXMuY29sb3IgPSByZ2JDb2xvcjsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Qm9yZGVyU3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEJvcmRlclN0eWxlKGJvcmRlclN0eWxlKSB7CiAgICAgIHRoaXMuYm9yZGVyU3R5bGUgPSBuZXcgQW5ub3RhdGlvbkJvcmRlclN0eWxlKCk7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGJvcmRlclN0eWxlKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGJvcmRlclN0eWxlLmhhcygiQlMiKSkgewogICAgICAgIHZhciBkaWN0ID0gYm9yZGVyU3R5bGUuZ2V0KCJCUyIpOwogICAgICAgIHZhciBkaWN0VHlwZSA9IGRpY3QuZ2V0KCJUeXBlIik7CgogICAgICAgIGlmICghZGljdFR5cGUgfHwgKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZGljdFR5cGUsICJCb3JkZXIiKSkgewogICAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXRXaWR0aChkaWN0LmdldCgiVyIpLCB0aGlzLnJlY3RhbmdsZSk7CiAgICAgICAgICB0aGlzLmJvcmRlclN0eWxlLnNldFN0eWxlKGRpY3QuZ2V0KCJTIikpOwogICAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXREYXNoQXJyYXkoZGljdC5nZXRBcnJheSgiRCIpKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoYm9yZGVyU3R5bGUuaGFzKCJCb3JkZXIiKSkgewogICAgICAgIHZhciBhcnJheSA9IGJvcmRlclN0eWxlLmdldEFycmF5KCJCb3JkZXIiKTsKCiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyYXkpICYmIGFycmF5Lmxlbmd0aCA+PSAzKSB7CiAgICAgICAgICB0aGlzLmJvcmRlclN0eWxlLnNldEhvcml6b250YWxDb3JuZXJSYWRpdXMoYXJyYXlbMF0pOwogICAgICAgICAgdGhpcy5ib3JkZXJTdHlsZS5zZXRWZXJ0aWNhbENvcm5lclJhZGl1cyhhcnJheVsxXSk7CiAgICAgICAgICB0aGlzLmJvcmRlclN0eWxlLnNldFdpZHRoKGFycmF5WzJdLCB0aGlzLnJlY3RhbmdsZSk7CgogICAgICAgICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gNCkgewogICAgICAgICAgICB0aGlzLmJvcmRlclN0eWxlLnNldERhc2hBcnJheShhcnJheVszXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYm9yZGVyU3R5bGUuc2V0V2lkdGgoMCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRBcHBlYXJhbmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRBcHBlYXJhbmNlKGRpY3QpIHsKICAgICAgdGhpcy5hcHBlYXJhbmNlID0gbnVsbDsKICAgICAgdmFyIGFwcGVhcmFuY2VTdGF0ZXMgPSBkaWN0LmdldCgiQVAiKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoYXBwZWFyYW5jZVN0YXRlcykpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBub3JtYWxBcHBlYXJhbmNlU3RhdGUgPSBhcHBlYXJhbmNlU3RhdGVzLmdldCgiTiIpOwoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkobm9ybWFsQXBwZWFyYW5jZVN0YXRlKSkgewogICAgICAgIHRoaXMuYXBwZWFyYW5jZSA9IG5vcm1hbEFwcGVhcmFuY2VTdGF0ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkobm9ybWFsQXBwZWFyYW5jZVN0YXRlKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGFzID0gZGljdC5nZXQoIkFTIik7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGFzKSB8fCAhbm9ybWFsQXBwZWFyYW5jZVN0YXRlLmhhcyhhcy5uYW1lKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5hcHBlYXJhbmNlID0gbm9ybWFsQXBwZWFyYW5jZVN0YXRlLmdldChhcy5uYW1lKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2FkUmVzb3VyY2VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkUmVzb3VyY2VzKGtleXMpIHsKICAgICAgcmV0dXJuIHRoaXMuYXBwZWFyYW5jZS5kaWN0LmdldEFzeW5jKCJSZXNvdXJjZXMiKS50aGVuKGZ1bmN0aW9uIChyZXNvdXJjZXMpIHsKICAgICAgICBpZiAoIXJlc291cmNlcykgewogICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICB9CgogICAgICAgIHZhciBvYmplY3RMb2FkZXIgPSBuZXcgX29iai5PYmplY3RMb2FkZXIocmVzb3VyY2VzLCBrZXlzLCByZXNvdXJjZXMueHJlZik7CiAgICAgICAgcmV0dXJuIG9iamVjdExvYWRlci5sb2FkKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gcmVzb3VyY2VzOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRPcGVyYXRvckxpc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE9wZXJhdG9yTGlzdChldmFsdWF0b3IsIHRhc2ssIHJlbmRlckZvcm1zKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuYXBwZWFyYW5jZSkgewogICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpKTsKICAgICAgfQoKICAgICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIHZhciBhcHBlYXJhbmNlRGljdCA9IHRoaXMuYXBwZWFyYW5jZS5kaWN0OwogICAgICB2YXIgcmVzb3VyY2VzUHJvbWlzZSA9IHRoaXMubG9hZFJlc291cmNlcyhbIkV4dEdTdGF0ZSIsICJDb2xvclNwYWNlIiwgIlBhdHRlcm4iLCAiU2hhZGluZyIsICJYT2JqZWN0IiwgIkZvbnQiXSk7CiAgICAgIHZhciBiYm94ID0gYXBwZWFyYW5jZURpY3QuZ2V0QXJyYXkoIkJCb3giKSB8fCBbMCwgMCwgMSwgMV07CiAgICAgIHZhciBtYXRyaXggPSBhcHBlYXJhbmNlRGljdC5nZXRBcnJheSgiTWF0cml4IikgfHwgWzEsIDAsIDAsIDEsIDAsIDBdOwogICAgICB2YXIgdHJhbnNmb3JtID0gZ2V0VHJhbnNmb3JtTWF0cml4KGRhdGEucmVjdCwgYmJveCwgbWF0cml4KTsKICAgICAgcmV0dXJuIHJlc291cmNlc1Byb21pc2UudGhlbihmdW5jdGlvbiAocmVzb3VyY2VzKSB7CiAgICAgICAgdmFyIG9wTGlzdCA9IG5ldyBfb3BlcmF0b3JfbGlzdC5PcGVyYXRvckxpc3QoKTsKICAgICAgICBvcExpc3QuYWRkT3AoX3V0aWwuT1BTLmJlZ2luQW5ub3RhdGlvbiwgW2RhdGEucmVjdCwgdHJhbnNmb3JtLCBtYXRyaXhdKTsKICAgICAgICByZXR1cm4gZXZhbHVhdG9yLmdldE9wZXJhdG9yTGlzdCh7CiAgICAgICAgICBzdHJlYW06IF90aGlzLmFwcGVhcmFuY2UsCiAgICAgICAgICB0YXNrOiB0YXNrLAogICAgICAgICAgcmVzb3VyY2VzOiByZXNvdXJjZXMsCiAgICAgICAgICBvcGVyYXRvckxpc3Q6IG9wTGlzdAogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgb3BMaXN0LmFkZE9wKF91dGlsLk9QUy5lbmRBbm5vdGF0aW9uLCBbXSk7CgogICAgICAgICAgX3RoaXMuYXBwZWFyYW5jZS5yZXNldCgpOwoKICAgICAgICAgIHJldHVybiBvcExpc3Q7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInZpZXdhYmxlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICBpZiAodGhpcy5mbGFncyA9PT0gMCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5faXNWaWV3YWJsZSh0aGlzLmZsYWdzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwcmludGFibGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIGlmICh0aGlzLmZsYWdzID09PSAwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5faXNQcmludGFibGUodGhpcy5mbGFncyk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQW5ub3RhdGlvbjsKfSgpOwoKZXhwb3J0cy5Bbm5vdGF0aW9uID0gQW5ub3RhdGlvbjsKCnZhciBBbm5vdGF0aW9uQm9yZGVyU3R5bGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEFubm90YXRpb25Cb3JkZXJTdHlsZSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBbm5vdGF0aW9uQm9yZGVyU3R5bGUpOwoKICAgIHRoaXMud2lkdGggPSAxOwogICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuU09MSUQ7CiAgICB0aGlzLmRhc2hBcnJheSA9IFszXTsKICAgIHRoaXMuaG9yaXpvbnRhbENvcm5lclJhZGl1cyA9IDA7CiAgICB0aGlzLnZlcnRpY2FsQ29ybmVyUmFkaXVzID0gMDsKICB9CgogIF9jcmVhdGVDbGFzcyhBbm5vdGF0aW9uQm9yZGVyU3R5bGUsIFt7CiAgICBrZXk6ICJzZXRXaWR0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0V2lkdGgod2lkdGgpIHsKICAgICAgdmFyIHJlY3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFswLCAwLCAwLCAwXTsKCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKSh3aWR0aCkpIHsKICAgICAgICB0aGlzLndpZHRoID0gMDsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKHdpZHRoKSkgewogICAgICAgIGlmICh3aWR0aCA+IDApIHsKICAgICAgICAgIHZhciBtYXhXaWR0aCA9IChyZWN0WzJdIC0gcmVjdFswXSkgLyAyOwogICAgICAgICAgdmFyIG1heEhlaWdodCA9IChyZWN0WzNdIC0gcmVjdFsxXSkgLyAyOwoKICAgICAgICAgIGlmIChtYXhXaWR0aCA+IDAgJiYgbWF4SGVpZ2h0ID4gMCAmJiAod2lkdGggPiBtYXhXaWR0aCB8fCB3aWR0aCA+IG1heEhlaWdodCkpIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJBbm5vdGF0aW9uQm9yZGVyU3R5bGUuc2V0V2lkdGggLSBpZ25vcmluZyB3aWR0aDogIi5jb25jYXQod2lkdGgpKTsKICAgICAgICAgICAgd2lkdGggPSAxOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0U3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN0eWxlKHN0eWxlKSB7CiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoc3R5bGUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBzd2l0Y2ggKHN0eWxlLm5hbWUpIHsKICAgICAgICBjYXNlICJTIjoKICAgICAgICAgIHRoaXMuc3R5bGUgPSBfdXRpbC5Bbm5vdGF0aW9uQm9yZGVyU3R5bGVUeXBlLlNPTElEOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIkQiOgogICAgICAgICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuREFTSEVEOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIkIiOgogICAgICAgICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuQkVWRUxFRDsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICJJIjoKICAgICAgICAgIHRoaXMuc3R5bGUgPSBfdXRpbC5Bbm5vdGF0aW9uQm9yZGVyU3R5bGVUeXBlLklOU0VUOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlUiOgogICAgICAgICAgdGhpcy5zdHlsZSA9IF91dGlsLkFubm90YXRpb25Cb3JkZXJTdHlsZVR5cGUuVU5ERVJMSU5FOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInNldERhc2hBcnJheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RGFzaEFycmF5KGRhc2hBcnJheSkgewogICAgICBpZiAoQXJyYXkuaXNBcnJheShkYXNoQXJyYXkpICYmIGRhc2hBcnJheS5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIGlzVmFsaWQgPSB0cnVlOwogICAgICAgIHZhciBhbGxaZXJvcyA9IHRydWU7CgogICAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihkYXNoQXJyYXkpLAogICAgICAgICAgICBfc3RlcDsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgIHZhciB2YWxpZE51bWJlciA9ICtlbGVtZW50ID49IDA7CgogICAgICAgICAgICBpZiAoIXZhbGlkTnVtYmVyKSB7CiAgICAgICAgICAgICAgaXNWYWxpZCA9IGZhbHNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQgPiAwKSB7CiAgICAgICAgICAgICAgYWxsWmVyb3MgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICB9CgogICAgICAgIGlmIChpc1ZhbGlkICYmICFhbGxaZXJvcykgewogICAgICAgICAgdGhpcy5kYXNoQXJyYXkgPSBkYXNoQXJyYXk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMud2lkdGggPSAwOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkYXNoQXJyYXkpIHsKICAgICAgICB0aGlzLndpZHRoID0gMDsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInNldEhvcml6b250YWxDb3JuZXJSYWRpdXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEhvcml6b250YWxDb3JuZXJSYWRpdXMocmFkaXVzKSB7CiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKHJhZGl1cykpIHsKICAgICAgICB0aGlzLmhvcml6b250YWxDb3JuZXJSYWRpdXMgPSByYWRpdXM7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRWZXJ0aWNhbENvcm5lclJhZGl1cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VmVydGljYWxDb3JuZXJSYWRpdXMocmFkaXVzKSB7CiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKHJhZGl1cykpIHsKICAgICAgICB0aGlzLnZlcnRpY2FsQ29ybmVyUmFkaXVzID0gcmFkaXVzOwogICAgICB9CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQW5ub3RhdGlvbkJvcmRlclN0eWxlOwp9KCk7CgpleHBvcnRzLkFubm90YXRpb25Cb3JkZXJTdHlsZSA9IEFubm90YXRpb25Cb3JkZXJTdHlsZTsKCnZhciBNYXJrdXBBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQW5ub3RhdGlvbikgewogIF9pbmhlcml0cyhNYXJrdXBBbm5vdGF0aW9uLCBfQW5ub3RhdGlvbik7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoTWFya3VwQW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIE1hcmt1cEFubm90YXRpb24ocGFyYW1ldGVycykgewogICAgdmFyIF90aGlzMjsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWFya3VwQW5ub3RhdGlvbik7CgogICAgX3RoaXMyID0gX3N1cGVyLmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICB2YXIgZGljdCA9IHBhcmFtZXRlcnMuZGljdDsKCiAgICBpZiAoZGljdC5oYXMoIklSVCIpKSB7CiAgICAgIHZhciByYXdJUlQgPSBkaWN0LmdldFJhdygiSVJUIik7CiAgICAgIF90aGlzMi5kYXRhLmluUmVwbHlUbyA9ICgwLCBfcHJpbWl0aXZlcy5pc1JlZikocmF3SVJUKSA/IHJhd0lSVC50b1N0cmluZygpIDogbnVsbDsKICAgICAgdmFyIHJ0ID0gZGljdC5nZXQoIlJUIik7CiAgICAgIF90aGlzMi5kYXRhLnJlcGx5VHlwZSA9ICgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHJ0KSA/IHJ0Lm5hbWUgOiBfdXRpbC5Bbm5vdGF0aW9uUmVwbHlUeXBlLlJFUExZOwogICAgfQoKICAgIGlmIChfdGhpczIuZGF0YS5yZXBseVR5cGUgPT09IF91dGlsLkFubm90YXRpb25SZXBseVR5cGUuR1JPVVApIHsKICAgICAgdmFyIHBhcmVudCA9IGRpY3QuZ2V0KCJJUlQiKTsKICAgICAgX3RoaXMyLmRhdGEudGl0bGUgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKHBhcmVudC5nZXQoIlQiKSB8fCAiIik7CgogICAgICBfdGhpczIuc2V0Q29udGVudHMocGFyZW50LmdldCgiQ29udGVudHMiKSk7CgogICAgICBfdGhpczIuZGF0YS5jb250ZW50cyA9IF90aGlzMi5jb250ZW50czsKCiAgICAgIGlmICghcGFyZW50LmhhcygiQ3JlYXRpb25EYXRlIikpIHsKICAgICAgICBfdGhpczIuZGF0YS5jcmVhdGlvbkRhdGUgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzMi5zZXRDcmVhdGlvbkRhdGUocGFyZW50LmdldCgiQ3JlYXRpb25EYXRlIikpOwoKICAgICAgICBfdGhpczIuZGF0YS5jcmVhdGlvbkRhdGUgPSBfdGhpczIuY3JlYXRpb25EYXRlOwogICAgICB9CgogICAgICBpZiAoIXBhcmVudC5oYXMoIk0iKSkgewogICAgICAgIF90aGlzMi5kYXRhLm1vZGlmaWNhdGlvbkRhdGUgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzMi5zZXRNb2RpZmljYXRpb25EYXRlKHBhcmVudC5nZXQoIk0iKSk7CgogICAgICAgIF90aGlzMi5kYXRhLm1vZGlmaWNhdGlvbkRhdGUgPSBfdGhpczIubW9kaWZpY2F0aW9uRGF0ZTsKICAgICAgfQoKICAgICAgX3RoaXMyLmRhdGEuaGFzUG9wdXAgPSBwYXJlbnQuaGFzKCJQb3B1cCIpOwoKICAgICAgaWYgKCFwYXJlbnQuaGFzKCJDIikpIHsKICAgICAgICBfdGhpczIuZGF0YS5jb2xvciA9IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMyLnNldENvbG9yKHBhcmVudC5nZXRBcnJheSgiQyIpKTsKCiAgICAgICAgX3RoaXMyLmRhdGEuY29sb3IgPSBfdGhpczIuY29sb3I7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIF90aGlzMi5kYXRhLnRpdGxlID0gKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkaWN0LmdldCgiVCIpIHx8ICIiKTsKCiAgICAgIF90aGlzMi5zZXRDcmVhdGlvbkRhdGUoZGljdC5nZXQoIkNyZWF0aW9uRGF0ZSIpKTsKCiAgICAgIF90aGlzMi5kYXRhLmNyZWF0aW9uRGF0ZSA9IF90aGlzMi5jcmVhdGlvbkRhdGU7CiAgICAgIF90aGlzMi5kYXRhLmhhc1BvcHVwID0gZGljdC5oYXMoIlBvcHVwIik7CgogICAgICBpZiAoIWRpY3QuaGFzKCJDIikpIHsKICAgICAgICBfdGhpczIuZGF0YS5jb2xvciA9IG51bGw7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gX3RoaXMyOwogIH0KCiAgX2NyZWF0ZUNsYXNzKE1hcmt1cEFubm90YXRpb24sIFt7CiAgICBrZXk6ICJzZXRDcmVhdGlvbkRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldENyZWF0aW9uRGF0ZShjcmVhdGlvbkRhdGUpIHsKICAgICAgdGhpcy5jcmVhdGlvbkRhdGUgPSAoMCwgX3V0aWwuaXNTdHJpbmcpKGNyZWF0aW9uRGF0ZSkgPyBjcmVhdGlvbkRhdGUgOiBudWxsOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE1hcmt1cEFubm90YXRpb247Cn0oQW5ub3RhdGlvbik7CgpleHBvcnRzLk1hcmt1cEFubm90YXRpb24gPSBNYXJrdXBBbm5vdGF0aW9uOwoKdmFyIFdpZGdldEFubm90YXRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Bbm5vdGF0aW9uMikgewogIF9pbmhlcml0cyhXaWRnZXRBbm5vdGF0aW9uLCBfQW5ub3RhdGlvbjIpOwoKICB2YXIgX3N1cGVyMiA9IF9jcmVhdGVTdXBlcihXaWRnZXRBbm5vdGF0aW9uKTsKCiAgZnVuY3Rpb24gV2lkZ2V0QW5ub3RhdGlvbihwYXJhbXMpIHsKICAgIHZhciBfdGhpczM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFdpZGdldEFubm90YXRpb24pOwoKICAgIF90aGlzMyA9IF9zdXBlcjIuY2FsbCh0aGlzLCBwYXJhbXMpOwogICAgdmFyIGRpY3QgPSBwYXJhbXMuZGljdDsKICAgIHZhciBkYXRhID0gX3RoaXMzLmRhdGE7CiAgICBkYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuV0lER0VUOwogICAgZGF0YS5maWVsZE5hbWUgPSBfdGhpczMuX2NvbnN0cnVjdEZpZWxkTmFtZShkaWN0KTsKICAgIGRhdGEuZmllbGRWYWx1ZSA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3Q6IGRpY3QsCiAgICAgIGtleTogIlYiLAogICAgICBnZXRBcnJheTogdHJ1ZQogICAgfSk7CiAgICBkYXRhLmFsdGVybmF0aXZlVGV4dCA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZGljdC5nZXQoIlRVIikgfHwgIiIpOwogICAgZGF0YS5kZWZhdWx0QXBwZWFyYW5jZSA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3Q6IGRpY3QsCiAgICAgIGtleTogIkRBIgogICAgfSkgfHwgIiI7CiAgICB2YXIgZmllbGRUeXBlID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdDogZGljdCwKICAgICAga2V5OiAiRlQiCiAgICB9KTsKICAgIGRhdGEuZmllbGRUeXBlID0gKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZmllbGRUeXBlKSA/IGZpZWxkVHlwZS5uYW1lIDogbnVsbDsKICAgIF90aGlzMy5maWVsZFJlc291cmNlcyA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3Q6IGRpY3QsCiAgICAgIGtleTogIkRSIgogICAgfSkgfHwgX3ByaW1pdGl2ZXMuRGljdC5lbXB0eTsKICAgIGRhdGEuZmllbGRGbGFncyA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3Q6IGRpY3QsCiAgICAgIGtleTogIkZmIgogICAgfSk7CgogICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKGRhdGEuZmllbGRGbGFncykgfHwgZGF0YS5maWVsZEZsYWdzIDwgMCkgewogICAgICBkYXRhLmZpZWxkRmxhZ3MgPSAwOwogICAgfQoKICAgIGRhdGEucmVhZE9ubHkgPSBfdGhpczMuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUkVBRE9OTFkpOwoKICAgIGlmIChkYXRhLmZpZWxkVHlwZSA9PT0gIlNpZyIpIHsKICAgICAgZGF0YS5maWVsZFZhbHVlID0gbnVsbDsKCiAgICAgIF90aGlzMy5zZXRGbGFncyhfdXRpbC5Bbm5vdGF0aW9uRmxhZy5ISURERU4pOwogICAgfQoKICAgIHJldHVybiBfdGhpczM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoV2lkZ2V0QW5ub3RhdGlvbiwgW3sKICAgIGtleTogIl9jb25zdHJ1Y3RGaWVsZE5hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jb25zdHJ1Y3RGaWVsZE5hbWUoZGljdCkgewogICAgICBpZiAoIWRpY3QuaGFzKCJUIikgJiYgIWRpY3QuaGFzKCJQYXJlbnQiKSkgewogICAgICAgICgwLCBfdXRpbC53YXJuKSgiVW5rbm93biBmaWVsZCBuYW1lLCBmYWxsaW5nIGJhY2sgdG8gZW1wdHkgZmllbGQgbmFtZS4iKTsKICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KCiAgICAgIGlmICghZGljdC5oYXMoIlBhcmVudCIpKSB7CiAgICAgICAgcmV0dXJuICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoZGljdC5nZXQoIlQiKSk7CiAgICAgIH0KCiAgICAgIHZhciBmaWVsZE5hbWUgPSBbXTsKCiAgICAgIGlmIChkaWN0LmhhcygiVCIpKSB7CiAgICAgICAgZmllbGROYW1lLnVuc2hpZnQoKDAsIF91dGlsLnN0cmluZ1RvUERGU3RyaW5nKShkaWN0LmdldCgiVCIpKSk7CiAgICAgIH0KCiAgICAgIHZhciBsb29wRGljdCA9IGRpY3Q7CgogICAgICB3aGlsZSAobG9vcERpY3QuaGFzKCJQYXJlbnQiKSkgewogICAgICAgIGxvb3BEaWN0ID0gbG9vcERpY3QuZ2V0KCJQYXJlbnQiKTsKCiAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShsb29wRGljdCkpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgaWYgKGxvb3BEaWN0LmhhcygiVCIpKSB7CiAgICAgICAgICBmaWVsZE5hbWUudW5zaGlmdCgoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGxvb3BEaWN0LmdldCgiVCIpKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gZmllbGROYW1lLmpvaW4oIi4iKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoYXNGaWVsZEZsYWciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhc0ZpZWxkRmxhZyhmbGFnKSB7CiAgICAgIHJldHVybiAhISh0aGlzLmRhdGEuZmllbGRGbGFncyAmIGZsYWcpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldE9wZXJhdG9yTGlzdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0T3BlcmF0b3JMaXN0KGV2YWx1YXRvciwgdGFzaywgcmVuZGVyRm9ybXMpIHsKICAgICAgaWYgKHJlbmRlckZvcm1zKSB7CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgX29wZXJhdG9yX2xpc3QuT3BlcmF0b3JMaXN0KCkpOwogICAgICB9CgogICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoV2lkZ2V0QW5ub3RhdGlvbi5wcm90b3R5cGUpLCAiZ2V0T3BlcmF0b3JMaXN0IiwgdGhpcykuY2FsbCh0aGlzLCBldmFsdWF0b3IsIHRhc2ssIHJlbmRlckZvcm1zKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBXaWRnZXRBbm5vdGF0aW9uOwp9KEFubm90YXRpb24pOwoKdmFyIFRleHRXaWRnZXRBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfV2lkZ2V0QW5ub3RhdGlvbikgewogIF9pbmhlcml0cyhUZXh0V2lkZ2V0QW5ub3RhdGlvbiwgX1dpZGdldEFubm90YXRpb24pOwoKICB2YXIgX3N1cGVyMyA9IF9jcmVhdGVTdXBlcihUZXh0V2lkZ2V0QW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIFRleHRXaWRnZXRBbm5vdGF0aW9uKHBhcmFtcykgewogICAgdmFyIF90aGlzNDsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGV4dFdpZGdldEFubm90YXRpb24pOwoKICAgIF90aGlzNCA9IF9zdXBlcjMuY2FsbCh0aGlzLCBwYXJhbXMpOwogICAgdmFyIGRpY3QgPSBwYXJhbXMuZGljdDsKICAgIF90aGlzNC5kYXRhLmZpZWxkVmFsdWUgPSAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKF90aGlzNC5kYXRhLmZpZWxkVmFsdWUgfHwgIiIpOwogICAgdmFyIGFsaWdubWVudCA9ICgwLCBfY29yZV91dGlscy5nZXRJbmhlcml0YWJsZVByb3BlcnR5KSh7CiAgICAgIGRpY3Q6IGRpY3QsCiAgICAgIGtleTogIlEiCiAgICB9KTsKCiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoYWxpZ25tZW50KSB8fCBhbGlnbm1lbnQgPCAwIHx8IGFsaWdubWVudCA+IDIpIHsKICAgICAgYWxpZ25tZW50ID0gbnVsbDsKICAgIH0KCiAgICBfdGhpczQuZGF0YS50ZXh0QWxpZ25tZW50ID0gYWxpZ25tZW50OwogICAgdmFyIG1heGltdW1MZW5ndGggPSAoMCwgX2NvcmVfdXRpbHMuZ2V0SW5oZXJpdGFibGVQcm9wZXJ0eSkoewogICAgICBkaWN0OiBkaWN0LAogICAgICBrZXk6ICJNYXhMZW4iCiAgICB9KTsKCiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIobWF4aW11bUxlbmd0aCkgfHwgbWF4aW11bUxlbmd0aCA8IDApIHsKICAgICAgbWF4aW11bUxlbmd0aCA9IG51bGw7CiAgICB9CgogICAgX3RoaXM0LmRhdGEubWF4TGVuID0gbWF4aW11bUxlbmd0aDsKICAgIF90aGlzNC5kYXRhLm11bHRpTGluZSA9IF90aGlzNC5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5NVUxUSUxJTkUpOwogICAgX3RoaXM0LmRhdGEuY29tYiA9IF90aGlzNC5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5DT01CKSAmJiAhX3RoaXM0Lmhhc0ZpZWxkRmxhZyhfdXRpbC5Bbm5vdGF0aW9uRmllbGRGbGFnLk1VTFRJTElORSkgJiYgIV90aGlzNC5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5QQVNTV09SRCkgJiYgIV90aGlzNC5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5GSUxFU0VMRUNUKSAmJiBfdGhpczQuZGF0YS5tYXhMZW4gIT09IG51bGw7CiAgICByZXR1cm4gX3RoaXM0OwogIH0KCiAgX2NyZWF0ZUNsYXNzKFRleHRXaWRnZXRBbm5vdGF0aW9uLCBbewogICAga2V5OiAiZ2V0T3BlcmF0b3JMaXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPcGVyYXRvckxpc3QoZXZhbHVhdG9yLCB0YXNrLCByZW5kZXJGb3JtcykgewogICAgICBpZiAocmVuZGVyRm9ybXMgfHwgdGhpcy5hcHBlYXJhbmNlKSB7CiAgICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKFRleHRXaWRnZXRBbm5vdGF0aW9uLnByb3RvdHlwZSksICJnZXRPcGVyYXRvckxpc3QiLCB0aGlzKS5jYWxsKHRoaXMsIGV2YWx1YXRvciwgdGFzaywgcmVuZGVyRm9ybXMpOwogICAgICB9CgogICAgICB2YXIgb3BlcmF0b3JMaXN0ID0gbmV3IF9vcGVyYXRvcl9saXN0Lk9wZXJhdG9yTGlzdCgpOwoKICAgICAgaWYgKCF0aGlzLmRhdGEuZGVmYXVsdEFwcGVhcmFuY2UpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG9wZXJhdG9yTGlzdCk7CiAgICAgIH0KCiAgICAgIHZhciBzdHJlYW0gPSBuZXcgX3N0cmVhbS5TdHJlYW0oKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKHRoaXMuZGF0YS5kZWZhdWx0QXBwZWFyYW5jZSkpOwogICAgICByZXR1cm4gZXZhbHVhdG9yLmdldE9wZXJhdG9yTGlzdCh7CiAgICAgICAgc3RyZWFtOiBzdHJlYW0sCiAgICAgICAgdGFzazogdGFzaywKICAgICAgICByZXNvdXJjZXM6IHRoaXMuZmllbGRSZXNvdXJjZXMsCiAgICAgICAgb3BlcmF0b3JMaXN0OiBvcGVyYXRvckxpc3QKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIG9wZXJhdG9yTGlzdDsKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVGV4dFdpZGdldEFubm90YXRpb247Cn0oV2lkZ2V0QW5ub3RhdGlvbik7Cgp2YXIgQnV0dG9uV2lkZ2V0QW5ub3RhdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1dpZGdldEFubm90YXRpb24yKSB7CiAgX2luaGVyaXRzKEJ1dHRvbldpZGdldEFubm90YXRpb24sIF9XaWRnZXRBbm5vdGF0aW9uMik7CgogIHZhciBfc3VwZXI0ID0gX2NyZWF0ZVN1cGVyKEJ1dHRvbldpZGdldEFubm90YXRpb24pOwoKICBmdW5jdGlvbiBCdXR0b25XaWRnZXRBbm5vdGF0aW9uKHBhcmFtcykgewogICAgdmFyIF90aGlzNTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQnV0dG9uV2lkZ2V0QW5ub3RhdGlvbik7CgogICAgX3RoaXM1ID0gX3N1cGVyNC5jYWxsKHRoaXMsIHBhcmFtcyk7CiAgICBfdGhpczUuZGF0YS5jaGVja0JveCA9ICFfdGhpczUuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUkFESU8pICYmICFfdGhpczUuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUFVTSEJVVFRPTik7CiAgICBfdGhpczUuZGF0YS5yYWRpb0J1dHRvbiA9IF90aGlzNS5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5SQURJTykgJiYgIV90aGlzNS5oYXNGaWVsZEZsYWcoX3V0aWwuQW5ub3RhdGlvbkZpZWxkRmxhZy5QVVNIQlVUVE9OKTsKICAgIF90aGlzNS5kYXRhLnB1c2hCdXR0b24gPSBfdGhpczUuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuUFVTSEJVVFRPTik7CgogICAgaWYgKF90aGlzNS5kYXRhLmNoZWNrQm94KSB7CiAgICAgIF90aGlzNS5fcHJvY2Vzc0NoZWNrQm94KHBhcmFtcyk7CiAgICB9IGVsc2UgaWYgKF90aGlzNS5kYXRhLnJhZGlvQnV0dG9uKSB7CiAgICAgIF90aGlzNS5fcHJvY2Vzc1JhZGlvQnV0dG9uKHBhcmFtcyk7CiAgICB9IGVsc2UgaWYgKF90aGlzNS5kYXRhLnB1c2hCdXR0b24pIHsKICAgICAgX3RoaXM1Ll9wcm9jZXNzUHVzaEJ1dHRvbihwYXJhbXMpOwogICAgfSBlbHNlIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJJbnZhbGlkIGZpZWxkIGZsYWdzIGZvciBidXR0b24gd2lkZ2V0IGFubm90YXRpb24iKTsKICAgIH0KCiAgICByZXR1cm4gX3RoaXM1OwogIH0KCiAgX2NyZWF0ZUNsYXNzKEJ1dHRvbldpZGdldEFubm90YXRpb24sIFt7CiAgICBrZXk6ICJfcHJvY2Vzc0NoZWNrQm94IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJvY2Vzc0NoZWNrQm94KHBhcmFtcykgewogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodGhpcy5kYXRhLmZpZWxkVmFsdWUpKSB7CiAgICAgICAgdGhpcy5kYXRhLmZpZWxkVmFsdWUgPSB0aGlzLmRhdGEuZmllbGRWYWx1ZS5uYW1lOwogICAgICB9CgogICAgICB2YXIgY3VzdG9tQXBwZWFyYW5jZSA9IHBhcmFtcy5kaWN0LmdldCgiQVAiKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoY3VzdG9tQXBwZWFyYW5jZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBleHBvcnRWYWx1ZU9wdGlvbnNEaWN0ID0gY3VzdG9tQXBwZWFyYW5jZS5nZXQoIkQiKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoZXhwb3J0VmFsdWVPcHRpb25zRGljdCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBleHBvcnRWYWx1ZXMgPSBleHBvcnRWYWx1ZU9wdGlvbnNEaWN0LmdldEtleXMoKTsKICAgICAgdmFyIGhhc0NvcnJlY3RPcHRpb25Db3VudCA9IGV4cG9ydFZhbHVlcy5sZW5ndGggPT09IDI7CgogICAgICBpZiAoIWhhc0NvcnJlY3RPcHRpb25Db3VudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhLmV4cG9ydFZhbHVlID0gZXhwb3J0VmFsdWVzWzBdID09PSAiT2ZmIiA/IGV4cG9ydFZhbHVlc1sxXSA6IGV4cG9ydFZhbHVlc1swXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcHJvY2Vzc1JhZGlvQnV0dG9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJvY2Vzc1JhZGlvQnV0dG9uKHBhcmFtcykgewogICAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9IHRoaXMuZGF0YS5idXR0b25WYWx1ZSA9IG51bGw7CiAgICAgIHZhciBmaWVsZFBhcmVudCA9IHBhcmFtcy5kaWN0LmdldCgiUGFyZW50Iik7CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoZmllbGRQYXJlbnQpICYmIGZpZWxkUGFyZW50LmhhcygiViIpKSB7CiAgICAgICAgdmFyIGZpZWxkUGFyZW50VmFsdWUgPSBmaWVsZFBhcmVudC5nZXQoIlYiKTsKCiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGZpZWxkUGFyZW50VmFsdWUpKSB7CiAgICAgICAgICB0aGlzLmRhdGEuZmllbGRWYWx1ZSA9IGZpZWxkUGFyZW50VmFsdWUubmFtZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBhcHBlYXJhbmNlU3RhdGVzID0gcGFyYW1zLmRpY3QuZ2V0KCJBUCIpOwoKICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShhcHBlYXJhbmNlU3RhdGVzKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG5vcm1hbEFwcGVhcmFuY2VTdGF0ZSA9IGFwcGVhcmFuY2VTdGF0ZXMuZ2V0KCJOIik7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKG5vcm1hbEFwcGVhcmFuY2VTdGF0ZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobm9ybWFsQXBwZWFyYW5jZVN0YXRlLmdldEtleXMoKSksCiAgICAgICAgICBfc3RlcDI7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIga2V5ID0gX3N0ZXAyLnZhbHVlOwoKICAgICAgICAgIGlmIChrZXkgIT09ICJPZmYiKSB7CiAgICAgICAgICAgIHRoaXMuZGF0YS5idXR0b25WYWx1ZSA9IGtleTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIl9wcm9jZXNzUHVzaEJ1dHRvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3Byb2Nlc3NQdXNoQnV0dG9uKHBhcmFtcykgewogICAgICBpZiAoIXBhcmFtcy5kaWN0LmhhcygiQSIpKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJQdXNoIGJ1dHRvbnMgd2l0aG91dCBhY3Rpb24gZGljdGlvbmFyaWVzIGFyZSBub3Qgc3VwcG9ydGVkIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBfb2JqLkNhdGFsb2cucGFyc2VEZXN0RGljdGlvbmFyeSh7CiAgICAgICAgZGVzdERpY3Q6IHBhcmFtcy5kaWN0LAogICAgICAgIHJlc3VsdE9iajogdGhpcy5kYXRhLAogICAgICAgIGRvY0Jhc2VVcmw6IHBhcmFtcy5wZGZNYW5hZ2VyLmRvY0Jhc2VVcmwKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQnV0dG9uV2lkZ2V0QW5ub3RhdGlvbjsKfShXaWRnZXRBbm5vdGF0aW9uKTsKCnZhciBDaG9pY2VXaWRnZXRBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfV2lkZ2V0QW5ub3RhdGlvbjMpIHsKICBfaW5oZXJpdHMoQ2hvaWNlV2lkZ2V0QW5ub3RhdGlvbiwgX1dpZGdldEFubm90YXRpb24zKTsKCiAgdmFyIF9zdXBlcjUgPSBfY3JlYXRlU3VwZXIoQ2hvaWNlV2lkZ2V0QW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIENob2ljZVdpZGdldEFubm90YXRpb24ocGFyYW1zKSB7CiAgICB2YXIgX3RoaXM2OwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDaG9pY2VXaWRnZXRBbm5vdGF0aW9uKTsKCiAgICBfdGhpczYgPSBfc3VwZXI1LmNhbGwodGhpcywgcGFyYW1zKTsKICAgIF90aGlzNi5kYXRhLm9wdGlvbnMgPSBbXTsKICAgIHZhciBvcHRpb25zID0gKDAsIF9jb3JlX3V0aWxzLmdldEluaGVyaXRhYmxlUHJvcGVydHkpKHsKICAgICAgZGljdDogcGFyYW1zLmRpY3QsCiAgICAgIGtleTogIk9wdCIKICAgIH0pOwoKICAgIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnMpKSB7CiAgICAgIHZhciB4cmVmID0gcGFyYW1zLnhyZWY7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBvcHRpb25zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICB2YXIgb3B0aW9uID0geHJlZi5mZXRjaElmUmVmKG9wdGlvbnNbaV0pOwogICAgICAgIHZhciBpc09wdGlvbkFycmF5ID0gQXJyYXkuaXNBcnJheShvcHRpb24pOwogICAgICAgIF90aGlzNi5kYXRhLm9wdGlvbnNbaV0gPSB7CiAgICAgICAgICBleHBvcnRWYWx1ZTogaXNPcHRpb25BcnJheSA/IHhyZWYuZmV0Y2hJZlJlZihvcHRpb25bMF0pIDogb3B0aW9uLAogICAgICAgICAgZGlzcGxheVZhbHVlOiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGlzT3B0aW9uQXJyYXkgPyB4cmVmLmZldGNoSWZSZWYob3B0aW9uWzFdKSA6IG9wdGlvbikKICAgICAgICB9OwogICAgICB9CiAgICB9CgogICAgaWYgKCFBcnJheS5pc0FycmF5KF90aGlzNi5kYXRhLmZpZWxkVmFsdWUpKSB7CiAgICAgIF90aGlzNi5kYXRhLmZpZWxkVmFsdWUgPSBbX3RoaXM2LmRhdGEuZmllbGRWYWx1ZV07CiAgICB9CgogICAgX3RoaXM2LmRhdGEuY29tYm8gPSBfdGhpczYuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuQ09NQk8pOwogICAgX3RoaXM2LmRhdGEubXVsdGlTZWxlY3QgPSBfdGhpczYuaGFzRmllbGRGbGFnKF91dGlsLkFubm90YXRpb25GaWVsZEZsYWcuTVVMVElTRUxFQ1QpOwogICAgcmV0dXJuIF90aGlzNjsKICB9CgogIHJldHVybiBDaG9pY2VXaWRnZXRBbm5vdGF0aW9uOwp9KFdpZGdldEFubm90YXRpb24pOwoKdmFyIFRleHRBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTWFya3VwQW5ub3RhdGlvbikgewogIF9pbmhlcml0cyhUZXh0QW5ub3RhdGlvbiwgX01hcmt1cEFubm90YXRpb24pOwoKICB2YXIgX3N1cGVyNiA9IF9jcmVhdGVTdXBlcihUZXh0QW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIFRleHRBbm5vdGF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIHZhciBfdGhpczc7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRleHRBbm5vdGF0aW9uKTsKCiAgICB2YXIgREVGQVVMVF9JQ09OX1NJWkUgPSAyMjsKICAgIF90aGlzNyA9IF9zdXBlcjYuY2FsbCh0aGlzLCBwYXJhbWV0ZXJzKTsKICAgIHZhciBkaWN0ID0gcGFyYW1ldGVycy5kaWN0OwogICAgX3RoaXM3LmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5URVhUOwoKICAgIGlmIChfdGhpczcuZGF0YS5oYXNBcHBlYXJhbmNlKSB7CiAgICAgIF90aGlzNy5kYXRhLm5hbWUgPSAiTm9JY29uIjsKICAgIH0gZWxzZSB7CiAgICAgIF90aGlzNy5kYXRhLnJlY3RbMV0gPSBfdGhpczcuZGF0YS5yZWN0WzNdIC0gREVGQVVMVF9JQ09OX1NJWkU7CiAgICAgIF90aGlzNy5kYXRhLnJlY3RbMl0gPSBfdGhpczcuZGF0YS5yZWN0WzBdICsgREVGQVVMVF9JQ09OX1NJWkU7CiAgICAgIF90aGlzNy5kYXRhLm5hbWUgPSBkaWN0LmhhcygiTmFtZSIpID8gZGljdC5nZXQoIk5hbWUiKS5uYW1lIDogIk5vdGUiOwogICAgfQoKICAgIGlmIChkaWN0LmhhcygiU3RhdGUiKSkgewogICAgICBfdGhpczcuZGF0YS5zdGF0ZSA9IGRpY3QuZ2V0KCJTdGF0ZSIpIHx8IG51bGw7CiAgICAgIF90aGlzNy5kYXRhLnN0YXRlTW9kZWwgPSBkaWN0LmdldCgiU3RhdGVNb2RlbCIpIHx8IG51bGw7CiAgICB9IGVsc2UgewogICAgICBfdGhpczcuZGF0YS5zdGF0ZSA9IG51bGw7CiAgICAgIF90aGlzNy5kYXRhLnN0YXRlTW9kZWwgPSBudWxsOwogICAgfQoKICAgIHJldHVybiBfdGhpczc7CiAgfQoKICByZXR1cm4gVGV4dEFubm90YXRpb247Cn0oTWFya3VwQW5ub3RhdGlvbik7Cgp2YXIgTGlua0Fubm90YXRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Bbm5vdGF0aW9uMykgewogIF9pbmhlcml0cyhMaW5rQW5ub3RhdGlvbiwgX0Fubm90YXRpb24zKTsKCiAgdmFyIF9zdXBlcjcgPSBfY3JlYXRlU3VwZXIoTGlua0Fubm90YXRpb24pOwoKICBmdW5jdGlvbiBMaW5rQW5ub3RhdGlvbihwYXJhbXMpIHsKICAgIHZhciBfdGhpczg7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmtBbm5vdGF0aW9uKTsKCiAgICBfdGhpczggPSBfc3VwZXI3LmNhbGwodGhpcywgcGFyYW1zKTsKICAgIF90aGlzOC5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuTElOSzsKICAgIHZhciBxdWFkUG9pbnRzID0gZ2V0UXVhZFBvaW50cyhwYXJhbXMuZGljdCwgX3RoaXM4LnJlY3RhbmdsZSk7CgogICAgaWYgKHF1YWRQb2ludHMpIHsKICAgICAgX3RoaXM4LmRhdGEucXVhZFBvaW50cyA9IHF1YWRQb2ludHM7CiAgICB9CgogICAgX29iai5DYXRhbG9nLnBhcnNlRGVzdERpY3Rpb25hcnkoewogICAgICBkZXN0RGljdDogcGFyYW1zLmRpY3QsCiAgICAgIHJlc3VsdE9iajogX3RoaXM4LmRhdGEsCiAgICAgIGRvY0Jhc2VVcmw6IHBhcmFtcy5wZGZNYW5hZ2VyLmRvY0Jhc2VVcmwKICAgIH0pOwoKICAgIHJldHVybiBfdGhpczg7CiAgfQoKICByZXR1cm4gTGlua0Fubm90YXRpb247Cn0oQW5ub3RhdGlvbik7Cgp2YXIgUG9wdXBBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQW5ub3RhdGlvbjQpIHsKICBfaW5oZXJpdHMoUG9wdXBBbm5vdGF0aW9uLCBfQW5ub3RhdGlvbjQpOwoKICB2YXIgX3N1cGVyOCA9IF9jcmVhdGVTdXBlcihQb3B1cEFubm90YXRpb24pOwoKICBmdW5jdGlvbiBQb3B1cEFubm90YXRpb24ocGFyYW1ldGVycykgewogICAgdmFyIF90aGlzOTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUG9wdXBBbm5vdGF0aW9uKTsKCiAgICBfdGhpczkgPSBfc3VwZXI4LmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczkuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlBPUFVQOwogICAgdmFyIHBhcmVudEl0ZW0gPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0KCJQYXJlbnQiKTsKCiAgICBpZiAoIXBhcmVudEl0ZW0pIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJQb3B1cCBhbm5vdGF0aW9uIGhhcyBhIG1pc3Npbmcgb3IgaW52YWxpZCBwYXJlbnQgYW5ub3RhdGlvbi4iKTsKICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzOSk7CiAgICB9CgogICAgdmFyIHBhcmVudFN1YnR5cGUgPSBwYXJlbnRJdGVtLmdldCgiU3VidHlwZSIpOwogICAgX3RoaXM5LmRhdGEucGFyZW50VHlwZSA9ICgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHBhcmVudFN1YnR5cGUpID8gcGFyZW50U3VidHlwZS5uYW1lIDogbnVsbDsKICAgIHZhciByYXdQYXJlbnQgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0UmF3KCJQYXJlbnQiKTsKICAgIF90aGlzOS5kYXRhLnBhcmVudElkID0gKDAsIF9wcmltaXRpdmVzLmlzUmVmKShyYXdQYXJlbnQpID8gcmF3UGFyZW50LnRvU3RyaW5nKCkgOiBudWxsOwogICAgdmFyIHJ0ID0gcGFyZW50SXRlbS5nZXQoIlJUIik7CgogICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHJ0LCBfdXRpbC5Bbm5vdGF0aW9uUmVwbHlUeXBlLkdST1VQKSkgewogICAgICBwYXJlbnRJdGVtID0gcGFyZW50SXRlbS5nZXQoIklSVCIpOwogICAgfQoKICAgIGlmICghcGFyZW50SXRlbS5oYXMoIk0iKSkgewogICAgICBfdGhpczkuZGF0YS5tb2RpZmljYXRpb25EYXRlID0gbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIF90aGlzOS5zZXRNb2RpZmljYXRpb25EYXRlKHBhcmVudEl0ZW0uZ2V0KCJNIikpOwoKICAgICAgX3RoaXM5LmRhdGEubW9kaWZpY2F0aW9uRGF0ZSA9IF90aGlzOS5tb2RpZmljYXRpb25EYXRlOwogICAgfQoKICAgIGlmICghcGFyZW50SXRlbS5oYXMoIkMiKSkgewogICAgICBfdGhpczkuZGF0YS5jb2xvciA9IG51bGw7CiAgICB9IGVsc2UgewogICAgICBfdGhpczkuc2V0Q29sb3IocGFyZW50SXRlbS5nZXRBcnJheSgiQyIpKTsKCiAgICAgIF90aGlzOS5kYXRhLmNvbG9yID0gX3RoaXM5LmNvbG9yOwogICAgfQoKICAgIGlmICghX3RoaXM5LnZpZXdhYmxlKSB7CiAgICAgIHZhciBwYXJlbnRGbGFncyA9IHBhcmVudEl0ZW0uZ2V0KCJGIik7CgogICAgICBpZiAoX3RoaXM5Ll9pc1ZpZXdhYmxlKHBhcmVudEZsYWdzKSkgewogICAgICAgIF90aGlzOS5zZXRGbGFncyhwYXJlbnRGbGFncyk7CiAgICAgIH0KICAgIH0KCiAgICBfdGhpczkuZGF0YS50aXRsZSA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykocGFyZW50SXRlbS5nZXQoIlQiKSB8fCAiIik7CiAgICBfdGhpczkuZGF0YS5jb250ZW50cyA9ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykocGFyZW50SXRlbS5nZXQoIkNvbnRlbnRzIikgfHwgIiIpOwogICAgcmV0dXJuIF90aGlzOTsKICB9CgogIHJldHVybiBQb3B1cEFubm90YXRpb247Cn0oQW5ub3RhdGlvbik7Cgp2YXIgRnJlZVRleHRBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTWFya3VwQW5ub3RhdGlvbjIpIHsKICBfaW5oZXJpdHMoRnJlZVRleHRBbm5vdGF0aW9uLCBfTWFya3VwQW5ub3RhdGlvbjIpOwoKICB2YXIgX3N1cGVyOSA9IF9jcmVhdGVTdXBlcihGcmVlVGV4dEFubm90YXRpb24pOwoKICBmdW5jdGlvbiBGcmVlVGV4dEFubm90YXRpb24ocGFyYW1ldGVycykgewogICAgdmFyIF90aGlzMTA7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZyZWVUZXh0QW5ub3RhdGlvbik7CgogICAgX3RoaXMxMCA9IF9zdXBlcjkuY2FsbCh0aGlzLCBwYXJhbWV0ZXJzKTsKICAgIF90aGlzMTAuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLkZSRUVURVhUOwogICAgcmV0dXJuIF90aGlzMTA7CiAgfQoKICByZXR1cm4gRnJlZVRleHRBbm5vdGF0aW9uOwp9KE1hcmt1cEFubm90YXRpb24pOwoKdmFyIExpbmVBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTWFya3VwQW5ub3RhdGlvbjMpIHsKICBfaW5oZXJpdHMoTGluZUFubm90YXRpb24sIF9NYXJrdXBBbm5vdGF0aW9uMyk7CgogIHZhciBfc3VwZXIxMCA9IF9jcmVhdGVTdXBlcihMaW5lQW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIExpbmVBbm5vdGF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIHZhciBfdGhpczExOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMaW5lQW5ub3RhdGlvbik7CgogICAgX3RoaXMxMSA9IF9zdXBlcjEwLmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczExLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5MSU5FOwogICAgX3RoaXMxMS5kYXRhLmxpbmVDb29yZGluYXRlcyA9IF91dGlsLlV0aWwubm9ybWFsaXplUmVjdChwYXJhbWV0ZXJzLmRpY3QuZ2V0QXJyYXkoIkwiKSk7CiAgICByZXR1cm4gX3RoaXMxMTsKICB9CgogIHJldHVybiBMaW5lQW5ub3RhdGlvbjsKfShNYXJrdXBBbm5vdGF0aW9uKTsKCnZhciBTcXVhcmVBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTWFya3VwQW5ub3RhdGlvbjQpIHsKICBfaW5oZXJpdHMoU3F1YXJlQW5ub3RhdGlvbiwgX01hcmt1cEFubm90YXRpb240KTsKCiAgdmFyIF9zdXBlcjExID0gX2NyZWF0ZVN1cGVyKFNxdWFyZUFubm90YXRpb24pOwoKICBmdW5jdGlvbiBTcXVhcmVBbm5vdGF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIHZhciBfdGhpczEyOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTcXVhcmVBbm5vdGF0aW9uKTsKCiAgICBfdGhpczEyID0gX3N1cGVyMTEuY2FsbCh0aGlzLCBwYXJhbWV0ZXJzKTsKICAgIF90aGlzMTIuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlNRVUFSRTsKICAgIHJldHVybiBfdGhpczEyOwogIH0KCiAgcmV0dXJuIFNxdWFyZUFubm90YXRpb247Cn0oTWFya3VwQW5ub3RhdGlvbik7Cgp2YXIgQ2lyY2xlQW5ub3RhdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX01hcmt1cEFubm90YXRpb241KSB7CiAgX2luaGVyaXRzKENpcmNsZUFubm90YXRpb24sIF9NYXJrdXBBbm5vdGF0aW9uNSk7CgogIHZhciBfc3VwZXIxMiA9IF9jcmVhdGVTdXBlcihDaXJjbGVBbm5vdGF0aW9uKTsKCiAgZnVuY3Rpb24gQ2lyY2xlQW5ub3RhdGlvbihwYXJhbWV0ZXJzKSB7CiAgICB2YXIgX3RoaXMxMzsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2lyY2xlQW5ub3RhdGlvbik7CgogICAgX3RoaXMxMyA9IF9zdXBlcjEyLmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczEzLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5DSVJDTEU7CiAgICByZXR1cm4gX3RoaXMxMzsKICB9CgogIHJldHVybiBDaXJjbGVBbm5vdGF0aW9uOwp9KE1hcmt1cEFubm90YXRpb24pOwoKdmFyIFBvbHlsaW5lQW5ub3RhdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX01hcmt1cEFubm90YXRpb242KSB7CiAgX2luaGVyaXRzKFBvbHlsaW5lQW5ub3RhdGlvbiwgX01hcmt1cEFubm90YXRpb242KTsKCiAgdmFyIF9zdXBlcjEzID0gX2NyZWF0ZVN1cGVyKFBvbHlsaW5lQW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIFBvbHlsaW5lQW5ub3RhdGlvbihwYXJhbWV0ZXJzKSB7CiAgICB2YXIgX3RoaXMxNDsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUG9seWxpbmVBbm5vdGF0aW9uKTsKCiAgICBfdGhpczE0ID0gX3N1cGVyMTMuY2FsbCh0aGlzLCBwYXJhbWV0ZXJzKTsKICAgIF90aGlzMTQuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLlBPTFlMSU5FOwogICAgdmFyIHJhd1ZlcnRpY2VzID0gcGFyYW1ldGVycy5kaWN0LmdldEFycmF5KCJWZXJ0aWNlcyIpOwogICAgX3RoaXMxNC5kYXRhLnZlcnRpY2VzID0gW107CgogICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcmF3VmVydGljZXMubGVuZ3RoOyBpIDwgaWk7IGkgKz0gMikgewogICAgICBfdGhpczE0LmRhdGEudmVydGljZXMucHVzaCh7CiAgICAgICAgeDogcmF3VmVydGljZXNbaV0sCiAgICAgICAgeTogcmF3VmVydGljZXNbaSArIDFdCiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBfdGhpczE0OwogIH0KCiAgcmV0dXJuIFBvbHlsaW5lQW5ub3RhdGlvbjsKfShNYXJrdXBBbm5vdGF0aW9uKTsKCnZhciBQb2x5Z29uQW5ub3RhdGlvbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1BvbHlsaW5lQW5ub3RhdGlvbikgewogIF9pbmhlcml0cyhQb2x5Z29uQW5ub3RhdGlvbiwgX1BvbHlsaW5lQW5ub3RhdGlvbik7CgogIHZhciBfc3VwZXIxNCA9IF9jcmVhdGVTdXBlcihQb2x5Z29uQW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIFBvbHlnb25Bbm5vdGF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIHZhciBfdGhpczE1OwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQb2x5Z29uQW5ub3RhdGlvbik7CgogICAgX3RoaXMxNSA9IF9zdXBlcjE0LmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczE1LmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5QT0xZR09OOwogICAgcmV0dXJuIF90aGlzMTU7CiAgfQoKICByZXR1cm4gUG9seWdvbkFubm90YXRpb247Cn0oUG9seWxpbmVBbm5vdGF0aW9uKTsKCnZhciBDYXJldEFubm90YXRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9NYXJrdXBBbm5vdGF0aW9uNykgewogIF9pbmhlcml0cyhDYXJldEFubm90YXRpb24sIF9NYXJrdXBBbm5vdGF0aW9uNyk7CgogIHZhciBfc3VwZXIxNSA9IF9jcmVhdGVTdXBlcihDYXJldEFubm90YXRpb24pOwoKICBmdW5jdGlvbiBDYXJldEFubm90YXRpb24ocGFyYW1ldGVycykgewogICAgdmFyIF90aGlzMTY7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhcmV0QW5ub3RhdGlvbik7CgogICAgX3RoaXMxNiA9IF9zdXBlcjE1LmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczE2LmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5DQVJFVDsKICAgIHJldHVybiBfdGhpczE2OwogIH0KCiAgcmV0dXJuIENhcmV0QW5ub3RhdGlvbjsKfShNYXJrdXBBbm5vdGF0aW9uKTsKCnZhciBJbmtBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTWFya3VwQW5ub3RhdGlvbjgpIHsKICBfaW5oZXJpdHMoSW5rQW5ub3RhdGlvbiwgX01hcmt1cEFubm90YXRpb244KTsKCiAgdmFyIF9zdXBlcjE2ID0gX2NyZWF0ZVN1cGVyKElua0Fubm90YXRpb24pOwoKICBmdW5jdGlvbiBJbmtBbm5vdGF0aW9uKHBhcmFtZXRlcnMpIHsKICAgIHZhciBfdGhpczE3OwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmtBbm5vdGF0aW9uKTsKCiAgICBfdGhpczE3ID0gX3N1cGVyMTYuY2FsbCh0aGlzLCBwYXJhbWV0ZXJzKTsKICAgIF90aGlzMTcuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLklOSzsKICAgIHZhciB4cmVmID0gcGFyYW1ldGVycy54cmVmOwogICAgdmFyIG9yaWdpbmFsSW5rTGlzdHMgPSBwYXJhbWV0ZXJzLmRpY3QuZ2V0QXJyYXkoIklua0xpc3QiKTsKICAgIF90aGlzMTcuZGF0YS5pbmtMaXN0cyA9IFtdOwoKICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IG9yaWdpbmFsSW5rTGlzdHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICBfdGhpczE3LmRhdGEuaW5rTGlzdHMucHVzaChbXSk7CgogICAgICBmb3IgKHZhciBqID0gMCwgamogPSBvcmlnaW5hbElua0xpc3RzW2ldLmxlbmd0aDsgaiA8IGpqOyBqICs9IDIpIHsKICAgICAgICBfdGhpczE3LmRhdGEuaW5rTGlzdHNbaV0ucHVzaCh7CiAgICAgICAgICB4OiB4cmVmLmZldGNoSWZSZWYob3JpZ2luYWxJbmtMaXN0c1tpXVtqXSksCiAgICAgICAgICB5OiB4cmVmLmZldGNoSWZSZWYob3JpZ2luYWxJbmtMaXN0c1tpXVtqICsgMV0pCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gX3RoaXMxNzsKICB9CgogIHJldHVybiBJbmtBbm5vdGF0aW9uOwp9KE1hcmt1cEFubm90YXRpb24pOwoKdmFyIEhpZ2hsaWdodEFubm90YXRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9NYXJrdXBBbm5vdGF0aW9uOSkgewogIF9pbmhlcml0cyhIaWdobGlnaHRBbm5vdGF0aW9uLCBfTWFya3VwQW5ub3RhdGlvbjkpOwoKICB2YXIgX3N1cGVyMTcgPSBfY3JlYXRlU3VwZXIoSGlnaGxpZ2h0QW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIEhpZ2hsaWdodEFubm90YXRpb24ocGFyYW1ldGVycykgewogICAgdmFyIF90aGlzMTg7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEhpZ2hsaWdodEFubm90YXRpb24pOwoKICAgIF90aGlzMTggPSBfc3VwZXIxNy5jYWxsKHRoaXMsIHBhcmFtZXRlcnMpOwogICAgX3RoaXMxOC5kYXRhLmFubm90YXRpb25UeXBlID0gX3V0aWwuQW5ub3RhdGlvblR5cGUuSElHSExJR0hUOwogICAgdmFyIHF1YWRQb2ludHMgPSBnZXRRdWFkUG9pbnRzKHBhcmFtZXRlcnMuZGljdCwgX3RoaXMxOC5yZWN0YW5nbGUpOwoKICAgIGlmIChxdWFkUG9pbnRzKSB7CiAgICAgIF90aGlzMTguZGF0YS5xdWFkUG9pbnRzID0gcXVhZFBvaW50czsKICAgIH0KCiAgICByZXR1cm4gX3RoaXMxODsKICB9CgogIHJldHVybiBIaWdobGlnaHRBbm5vdGF0aW9uOwp9KE1hcmt1cEFubm90YXRpb24pOwoKdmFyIFVuZGVybGluZUFubm90YXRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9NYXJrdXBBbm5vdGF0aW9uMTApIHsKICBfaW5oZXJpdHMoVW5kZXJsaW5lQW5ub3RhdGlvbiwgX01hcmt1cEFubm90YXRpb24xMCk7CgogIHZhciBfc3VwZXIxOCA9IF9jcmVhdGVTdXBlcihVbmRlcmxpbmVBbm5vdGF0aW9uKTsKCiAgZnVuY3Rpb24gVW5kZXJsaW5lQW5ub3RhdGlvbihwYXJhbWV0ZXJzKSB7CiAgICB2YXIgX3RoaXMxOTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVW5kZXJsaW5lQW5ub3RhdGlvbik7CgogICAgX3RoaXMxOSA9IF9zdXBlcjE4LmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczE5LmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5VTkRFUkxJTkU7CiAgICB2YXIgcXVhZFBvaW50cyA9IGdldFF1YWRQb2ludHMocGFyYW1ldGVycy5kaWN0LCBfdGhpczE5LnJlY3RhbmdsZSk7CgogICAgaWYgKHF1YWRQb2ludHMpIHsKICAgICAgX3RoaXMxOS5kYXRhLnF1YWRQb2ludHMgPSBxdWFkUG9pbnRzOwogICAgfQoKICAgIHJldHVybiBfdGhpczE5OwogIH0KCiAgcmV0dXJuIFVuZGVybGluZUFubm90YXRpb247Cn0oTWFya3VwQW5ub3RhdGlvbik7Cgp2YXIgU3F1aWdnbHlBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTWFya3VwQW5ub3RhdGlvbjExKSB7CiAgX2luaGVyaXRzKFNxdWlnZ2x5QW5ub3RhdGlvbiwgX01hcmt1cEFubm90YXRpb24xMSk7CgogIHZhciBfc3VwZXIxOSA9IF9jcmVhdGVTdXBlcihTcXVpZ2dseUFubm90YXRpb24pOwoKICBmdW5jdGlvbiBTcXVpZ2dseUFubm90YXRpb24ocGFyYW1ldGVycykgewogICAgdmFyIF90aGlzMjA7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNxdWlnZ2x5QW5ub3RhdGlvbik7CgogICAgX3RoaXMyMCA9IF9zdXBlcjE5LmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczIwLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5TUVVJR0dMWTsKICAgIHZhciBxdWFkUG9pbnRzID0gZ2V0UXVhZFBvaW50cyhwYXJhbWV0ZXJzLmRpY3QsIF90aGlzMjAucmVjdGFuZ2xlKTsKCiAgICBpZiAocXVhZFBvaW50cykgewogICAgICBfdGhpczIwLmRhdGEucXVhZFBvaW50cyA9IHF1YWRQb2ludHM7CiAgICB9CgogICAgcmV0dXJuIF90aGlzMjA7CiAgfQoKICByZXR1cm4gU3F1aWdnbHlBbm5vdGF0aW9uOwp9KE1hcmt1cEFubm90YXRpb24pOwoKdmFyIFN0cmlrZU91dEFubm90YXRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9NYXJrdXBBbm5vdGF0aW9uMTIpIHsKICBfaW5oZXJpdHMoU3RyaWtlT3V0QW5ub3RhdGlvbiwgX01hcmt1cEFubm90YXRpb24xMik7CgogIHZhciBfc3VwZXIyMCA9IF9jcmVhdGVTdXBlcihTdHJpa2VPdXRBbm5vdGF0aW9uKTsKCiAgZnVuY3Rpb24gU3RyaWtlT3V0QW5ub3RhdGlvbihwYXJhbWV0ZXJzKSB7CiAgICB2YXIgX3RoaXMyMTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3RyaWtlT3V0QW5ub3RhdGlvbik7CgogICAgX3RoaXMyMSA9IF9zdXBlcjIwLmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczIxLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5TVFJJS0VPVVQ7CiAgICB2YXIgcXVhZFBvaW50cyA9IGdldFF1YWRQb2ludHMocGFyYW1ldGVycy5kaWN0LCBfdGhpczIxLnJlY3RhbmdsZSk7CgogICAgaWYgKHF1YWRQb2ludHMpIHsKICAgICAgX3RoaXMyMS5kYXRhLnF1YWRQb2ludHMgPSBxdWFkUG9pbnRzOwogICAgfQoKICAgIHJldHVybiBfdGhpczIxOwogIH0KCiAgcmV0dXJuIFN0cmlrZU91dEFubm90YXRpb247Cn0oTWFya3VwQW5ub3RhdGlvbik7Cgp2YXIgU3RhbXBBbm5vdGF0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfTWFya3VwQW5ub3RhdGlvbjEzKSB7CiAgX2luaGVyaXRzKFN0YW1wQW5ub3RhdGlvbiwgX01hcmt1cEFubm90YXRpb24xMyk7CgogIHZhciBfc3VwZXIyMSA9IF9jcmVhdGVTdXBlcihTdGFtcEFubm90YXRpb24pOwoKICBmdW5jdGlvbiBTdGFtcEFubm90YXRpb24ocGFyYW1ldGVycykgewogICAgdmFyIF90aGlzMjI7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0YW1wQW5ub3RhdGlvbik7CgogICAgX3RoaXMyMiA9IF9zdXBlcjIxLmNhbGwodGhpcywgcGFyYW1ldGVycyk7CiAgICBfdGhpczIyLmRhdGEuYW5ub3RhdGlvblR5cGUgPSBfdXRpbC5Bbm5vdGF0aW9uVHlwZS5TVEFNUDsKICAgIHJldHVybiBfdGhpczIyOwogIH0KCiAgcmV0dXJuIFN0YW1wQW5ub3RhdGlvbjsKfShNYXJrdXBBbm5vdGF0aW9uKTsKCnZhciBGaWxlQXR0YWNobWVudEFubm90YXRpb24gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9NYXJrdXBBbm5vdGF0aW9uMTQpIHsKICBfaW5oZXJpdHMoRmlsZUF0dGFjaG1lbnRBbm5vdGF0aW9uLCBfTWFya3VwQW5ub3RhdGlvbjE0KTsKCiAgdmFyIF9zdXBlcjIyID0gX2NyZWF0ZVN1cGVyKEZpbGVBdHRhY2htZW50QW5ub3RhdGlvbik7CgogIGZ1bmN0aW9uIEZpbGVBdHRhY2htZW50QW5ub3RhdGlvbihwYXJhbWV0ZXJzKSB7CiAgICB2YXIgX3RoaXMyMzsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmlsZUF0dGFjaG1lbnRBbm5vdGF0aW9uKTsKCiAgICBfdGhpczIzID0gX3N1cGVyMjIuY2FsbCh0aGlzLCBwYXJhbWV0ZXJzKTsKICAgIHZhciBmaWxlID0gbmV3IF9vYmouRmlsZVNwZWMocGFyYW1ldGVycy5kaWN0LmdldCgiRlMiKSwgcGFyYW1ldGVycy54cmVmKTsKICAgIF90aGlzMjMuZGF0YS5hbm5vdGF0aW9uVHlwZSA9IF91dGlsLkFubm90YXRpb25UeXBlLkZJTEVBVFRBQ0hNRU5UOwogICAgX3RoaXMyMy5kYXRhLmZpbGUgPSBmaWxlLnNlcmlhbGl6YWJsZTsKICAgIHJldHVybiBfdGhpczIzOwogIH0KCiAgcmV0dXJuIEZpbGVBdHRhY2htZW50QW5ub3RhdGlvbjsKfShNYXJrdXBBbm5vdGF0aW9uKTsKCi8qKiovIH0pLAovKiAyMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5PcGVyYXRvckxpc3QgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIFF1ZXVlT3B0aW1pemVyID0gZnVuY3Rpb24gUXVldWVPcHRpbWl6ZXJDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGFkZFN0YXRlKHBhcmVudFN0YXRlLCBwYXR0ZXJuLCBjaGVja0ZuLCBpdGVyYXRlRm4sIHByb2Nlc3NGbikgewogICAgdmFyIHN0YXRlID0gcGFyZW50U3RhdGU7CgogICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcGF0dGVybi5sZW5ndGggLSAxOyBpIDwgaWk7IGkrKykgewogICAgICB2YXIgaXRlbSA9IHBhdHRlcm5baV07CiAgICAgIHN0YXRlID0gc3RhdGVbaXRlbV0gfHwgKHN0YXRlW2l0ZW1dID0gW10pOwogICAgfQoKICAgIHN0YXRlW3BhdHRlcm5bcGF0dGVybi5sZW5ndGggLSAxXV0gPSB7CiAgICAgIGNoZWNrRm46IGNoZWNrRm4sCiAgICAgIGl0ZXJhdGVGbjogaXRlcmF0ZUZuLAogICAgICBwcm9jZXNzRm46IHByb2Nlc3NGbgogICAgfTsKICB9CgogIGZ1bmN0aW9uIGhhbmRsZVBhaW50U29saWRDb2xvckltYWdlTWFzayhpRmlyc3RTYXZlLCBjb3VudCwgZm5BcnJheSwgYXJnc0FycmF5KSB7CiAgICB2YXIgaUZpcnN0UElNWE8gPSBpRmlyc3RTYXZlICsgMjsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgdmFyIGFyZyA9IGFyZ3NBcnJheVtpRmlyc3RQSU1YTyArIDQgKiBpXTsKICAgICAgdmFyIGltYWdlTWFzayA9IGFyZy5sZW5ndGggPT09IDEgJiYgYXJnWzBdOwoKICAgICAgaWYgKGltYWdlTWFzayAmJiBpbWFnZU1hc2sud2lkdGggPT09IDEgJiYgaW1hZ2VNYXNrLmhlaWdodCA9PT0gMSAmJiAoIWltYWdlTWFzay5kYXRhLmxlbmd0aCB8fCBpbWFnZU1hc2suZGF0YS5sZW5ndGggPT09IDEgJiYgaW1hZ2VNYXNrLmRhdGFbMF0gPT09IDApKSB7CiAgICAgICAgZm5BcnJheVtpRmlyc3RQSU1YTyArIDQgKiBpXSA9IF91dGlsLk9QUy5wYWludFNvbGlkQ29sb3JJbWFnZU1hc2s7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGJyZWFrOwogICAgfQoKICAgIHJldHVybiBjb3VudCAtIGk7CiAgfQoKICB2YXIgSW5pdGlhbFN0YXRlID0gW107CiAgYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLnNhdmUsIF91dGlsLk9QUy50cmFuc2Zvcm0sIF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdCwgX3V0aWwuT1BTLnJlc3RvcmVdLCBudWxsLCBmdW5jdGlvbiBpdGVyYXRlSW5saW5lSW1hZ2VHcm91cChjb250ZXh0LCBpKSB7CiAgICB2YXIgZm5BcnJheSA9IGNvbnRleHQuZm5BcnJheTsKICAgIHZhciBpRmlyc3RTYXZlID0gY29udGV4dC5pQ3VyciAtIDM7CiAgICB2YXIgcG9zID0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CgogICAgc3dpdGNoIChwb3MpIHsKICAgICAgY2FzZSAwOgogICAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuc2F2ZTsKCiAgICAgIGNhc2UgMToKICAgICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnRyYW5zZm9ybTsKCiAgICAgIGNhc2UgMjoKICAgICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnBhaW50SW5saW5lSW1hZ2VYT2JqZWN0OwoKICAgICAgY2FzZSAzOgogICAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMucmVzdG9yZTsKICAgIH0KCiAgICB0aHJvdyBuZXcgRXJyb3IoIml0ZXJhdGVJbmxpbmVJbWFnZUdyb3VwIC0gaW52YWxpZCBwb3M6ICIuY29uY2F0KHBvcykpOwogIH0sIGZ1bmN0aW9uIGZvdW5kSW5saW5lSW1hZ2VHcm91cChjb250ZXh0LCBpKSB7CiAgICB2YXIgTUlOX0lNQUdFU19JTl9JTkxJTkVfSU1BR0VTX0JMT0NLID0gMTA7CiAgICB2YXIgTUFYX0lNQUdFU19JTl9JTkxJTkVfSU1BR0VTX0JMT0NLID0gMjAwOwogICAgdmFyIE1BWF9XSURUSCA9IDEwMDA7CiAgICB2YXIgSU1BR0VfUEFERElORyA9IDE7CiAgICB2YXIgZm5BcnJheSA9IGNvbnRleHQuZm5BcnJheSwKICAgICAgICBhcmdzQXJyYXkgPSBjb250ZXh0LmFyZ3NBcnJheTsKICAgIHZhciBjdXJyID0gY29udGV4dC5pQ3VycjsKICAgIHZhciBpRmlyc3RTYXZlID0gY3VyciAtIDM7CiAgICB2YXIgaUZpcnN0VHJhbnNmb3JtID0gY3VyciAtIDI7CiAgICB2YXIgaUZpcnN0UElJWE8gPSBjdXJyIC0gMTsKICAgIHZhciBjb3VudCA9IE1hdGgubWluKE1hdGguZmxvb3IoKGkgLSBpRmlyc3RTYXZlKSAvIDQpLCBNQVhfSU1BR0VTX0lOX0lOTElORV9JTUFHRVNfQkxPQ0spOwoKICAgIGlmIChjb3VudCA8IE1JTl9JTUFHRVNfSU5fSU5MSU5FX0lNQUdFU19CTE9DSykgewogICAgICByZXR1cm4gaSAtIChpIC0gaUZpcnN0U2F2ZSkgJSA0OwogICAgfQoKICAgIHZhciBtYXhYID0gMDsKICAgIHZhciBtYXAgPSBbXSwKICAgICAgICBtYXhMaW5lSGVpZ2h0ID0gMDsKICAgIHZhciBjdXJyZW50WCA9IElNQUdFX1BBRERJTkcsCiAgICAgICAgY3VycmVudFkgPSBJTUFHRV9QQURESU5HOwogICAgdmFyIHE7CgogICAgZm9yIChxID0gMDsgcSA8IGNvdW50OyBxKyspIHsKICAgICAgdmFyIHRyYW5zZm9ybSA9IGFyZ3NBcnJheVtpRmlyc3RUcmFuc2Zvcm0gKyAocSA8PCAyKV07CiAgICAgIHZhciBpbWcgPSBhcmdzQXJyYXlbaUZpcnN0UElJWE8gKyAocSA8PCAyKV1bMF07CgogICAgICBpZiAoY3VycmVudFggKyBpbWcud2lkdGggPiBNQVhfV0lEVEgpIHsKICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgY3VycmVudFgpOwogICAgICAgIGN1cnJlbnRZICs9IG1heExpbmVIZWlnaHQgKyAyICogSU1BR0VfUEFERElORzsKICAgICAgICBjdXJyZW50WCA9IDA7CiAgICAgICAgbWF4TGluZUhlaWdodCA9IDA7CiAgICAgIH0KCiAgICAgIG1hcC5wdXNoKHsKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zZm9ybSwKICAgICAgICB4OiBjdXJyZW50WCwKICAgICAgICB5OiBjdXJyZW50WSwKICAgICAgICB3OiBpbWcud2lkdGgsCiAgICAgICAgaDogaW1nLmhlaWdodAogICAgICB9KTsKICAgICAgY3VycmVudFggKz0gaW1nLndpZHRoICsgMiAqIElNQUdFX1BBRERJTkc7CiAgICAgIG1heExpbmVIZWlnaHQgPSBNYXRoLm1heChtYXhMaW5lSGVpZ2h0LCBpbWcuaGVpZ2h0KTsKICAgIH0KCiAgICB2YXIgaW1nV2lkdGggPSBNYXRoLm1heChtYXhYLCBjdXJyZW50WCkgKyBJTUFHRV9QQURESU5HOwogICAgdmFyIGltZ0hlaWdodCA9IGN1cnJlbnRZICsgbWF4TGluZUhlaWdodCArIElNQUdFX1BBRERJTkc7CiAgICB2YXIgaW1nRGF0YSA9IG5ldyBVaW50OENsYW1wZWRBcnJheShpbWdXaWR0aCAqIGltZ0hlaWdodCAqIDQpOwogICAgdmFyIGltZ1Jvd1NpemUgPSBpbWdXaWR0aCA8PCAyOwoKICAgIGZvciAocSA9IDA7IHEgPCBjb3VudDsgcSsrKSB7CiAgICAgIHZhciBkYXRhID0gYXJnc0FycmF5W2lGaXJzdFBJSVhPICsgKHEgPDwgMildWzBdLmRhdGE7CiAgICAgIHZhciByb3dTaXplID0gbWFwW3FdLncgPDwgMjsKICAgICAgdmFyIGRhdGFPZmZzZXQgPSAwOwogICAgICB2YXIgb2Zmc2V0ID0gbWFwW3FdLnggKyBtYXBbcV0ueSAqIGltZ1dpZHRoIDw8IDI7CiAgICAgIGltZ0RhdGEuc2V0KGRhdGEuc3ViYXJyYXkoMCwgcm93U2l6ZSksIG9mZnNldCAtIGltZ1Jvd1NpemUpOwoKICAgICAgZm9yICh2YXIgayA9IDAsIGtrID0gbWFwW3FdLmg7IGsgPCBrazsgaysrKSB7CiAgICAgICAgaW1nRGF0YS5zZXQoZGF0YS5zdWJhcnJheShkYXRhT2Zmc2V0LCBkYXRhT2Zmc2V0ICsgcm93U2l6ZSksIG9mZnNldCk7CiAgICAgICAgZGF0YU9mZnNldCArPSByb3dTaXplOwogICAgICAgIG9mZnNldCArPSBpbWdSb3dTaXplOwogICAgICB9CgogICAgICBpbWdEYXRhLnNldChkYXRhLnN1YmFycmF5KGRhdGFPZmZzZXQgLSByb3dTaXplLCBkYXRhT2Zmc2V0KSwgb2Zmc2V0KTsKCiAgICAgIHdoaWxlIChvZmZzZXQgPj0gMCkgewogICAgICAgIGRhdGFbb2Zmc2V0IC0gNF0gPSBkYXRhW29mZnNldF07CiAgICAgICAgZGF0YVtvZmZzZXQgLSAzXSA9IGRhdGFbb2Zmc2V0ICsgMV07CiAgICAgICAgZGF0YVtvZmZzZXQgLSAyXSA9IGRhdGFbb2Zmc2V0ICsgMl07CiAgICAgICAgZGF0YVtvZmZzZXQgLSAxXSA9IGRhdGFbb2Zmc2V0ICsgM107CiAgICAgICAgZGF0YVtvZmZzZXQgKyByb3dTaXplXSA9IGRhdGFbb2Zmc2V0ICsgcm93U2l6ZSAtIDRdOwogICAgICAgIGRhdGFbb2Zmc2V0ICsgcm93U2l6ZSArIDFdID0gZGF0YVtvZmZzZXQgKyByb3dTaXplIC0gM107CiAgICAgICAgZGF0YVtvZmZzZXQgKyByb3dTaXplICsgMl0gPSBkYXRhW29mZnNldCArIHJvd1NpemUgLSAyXTsKICAgICAgICBkYXRhW29mZnNldCArIHJvd1NpemUgKyAzXSA9IGRhdGFbb2Zmc2V0ICsgcm93U2l6ZSAtIDFdOwogICAgICAgIG9mZnNldCAtPSBpbWdSb3dTaXplOwogICAgICB9CiAgICB9CgogICAgZm5BcnJheS5zcGxpY2UoaUZpcnN0U2F2ZSwgY291bnQgKiA0LCBfdXRpbC5PUFMucGFpbnRJbmxpbmVJbWFnZVhPYmplY3RHcm91cCk7CiAgICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgW3sKICAgICAgd2lkdGg6IGltZ1dpZHRoLAogICAgICBoZWlnaHQ6IGltZ0hlaWdodCwKICAgICAga2luZDogX3V0aWwuSW1hZ2VLaW5kLlJHQkFfMzJCUFAsCiAgICAgIGRhdGE6IGltZ0RhdGEKICAgIH0sIG1hcF0pOwogICAgcmV0dXJuIGlGaXJzdFNhdmUgKyAxOwogIH0pOwogIGFkZFN0YXRlKEluaXRpYWxTdGF0ZSwgW191dGlsLk9QUy5zYXZlLCBfdXRpbC5PUFMudHJhbnNmb3JtLCBfdXRpbC5PUFMucGFpbnRJbWFnZU1hc2tYT2JqZWN0LCBfdXRpbC5PUFMucmVzdG9yZV0sIG51bGwsIGZ1bmN0aW9uIGl0ZXJhdGVJbWFnZU1hc2tHcm91cChjb250ZXh0LCBpKSB7CiAgICB2YXIgZm5BcnJheSA9IGNvbnRleHQuZm5BcnJheTsKICAgIHZhciBpRmlyc3RTYXZlID0gY29udGV4dC5pQ3VyciAtIDM7CiAgICB2YXIgcG9zID0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CgogICAgc3dpdGNoIChwb3MpIHsKICAgICAgY2FzZSAwOgogICAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMuc2F2ZTsKCiAgICAgIGNhc2UgMToKICAgICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnRyYW5zZm9ybTsKCiAgICAgIGNhc2UgMjoKICAgICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdDsKCiAgICAgIGNhc2UgMzoKICAgICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnJlc3RvcmU7CiAgICB9CgogICAgdGhyb3cgbmV3IEVycm9yKCJpdGVyYXRlSW1hZ2VNYXNrR3JvdXAgLSBpbnZhbGlkIHBvczogIi5jb25jYXQocG9zKSk7CiAgfSwgZnVuY3Rpb24gZm91bmRJbWFnZU1hc2tHcm91cChjb250ZXh0LCBpKSB7CiAgICB2YXIgTUlOX0lNQUdFU19JTl9NQVNLU19CTE9DSyA9IDEwOwogICAgdmFyIE1BWF9JTUFHRVNfSU5fTUFTS1NfQkxPQ0sgPSAxMDA7CiAgICB2YXIgTUFYX1NBTUVfSU1BR0VTX0lOX01BU0tTX0JMT0NLID0gMTAwMDsKICAgIHZhciBmbkFycmF5ID0gY29udGV4dC5mbkFycmF5LAogICAgICAgIGFyZ3NBcnJheSA9IGNvbnRleHQuYXJnc0FycmF5OwogICAgdmFyIGN1cnIgPSBjb250ZXh0LmlDdXJyOwogICAgdmFyIGlGaXJzdFNhdmUgPSBjdXJyIC0gMzsKICAgIHZhciBpRmlyc3RUcmFuc2Zvcm0gPSBjdXJyIC0gMjsKICAgIHZhciBpRmlyc3RQSU1YTyA9IGN1cnIgLSAxOwogICAgdmFyIGNvdW50ID0gTWF0aC5mbG9vcigoaSAtIGlGaXJzdFNhdmUpIC8gNCk7CiAgICBjb3VudCA9IGhhbmRsZVBhaW50U29saWRDb2xvckltYWdlTWFzayhpRmlyc3RTYXZlLCBjb3VudCwgZm5BcnJheSwgYXJnc0FycmF5KTsKCiAgICBpZiAoY291bnQgPCBNSU5fSU1BR0VTX0lOX01BU0tTX0JMT0NLKSB7CiAgICAgIHJldHVybiBpIC0gKGkgLSBpRmlyc3RTYXZlKSAlIDQ7CiAgICB9CgogICAgdmFyIHE7CiAgICB2YXIgaXNTYW1lSW1hZ2UgPSBmYWxzZTsKICAgIHZhciBpVHJhbnNmb3JtLCB0cmFuc2Zvcm1BcmdzOwogICAgdmFyIGZpcnN0UElNWE9BcmcwID0gYXJnc0FycmF5W2lGaXJzdFBJTVhPXVswXTsKCiAgICBpZiAoYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMV0gPT09IDAgJiYgYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMl0gPT09IDApIHsKICAgICAgaXNTYW1lSW1hZ2UgPSB0cnVlOwogICAgICB2YXIgZmlyc3RUcmFuc2Zvcm1BcmcwID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMF07CiAgICAgIHZhciBmaXJzdFRyYW5zZm9ybUFyZzMgPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVszXTsKICAgICAgaVRyYW5zZm9ybSA9IGlGaXJzdFRyYW5zZm9ybSArIDQ7CiAgICAgIHZhciBpUElNWE8gPSBpRmlyc3RQSU1YTyArIDQ7CgogICAgICBmb3IgKHEgPSAxOyBxIDwgY291bnQ7IHErKywgaVRyYW5zZm9ybSArPSA0LCBpUElNWE8gKz0gNCkgewogICAgICAgIHRyYW5zZm9ybUFyZ3MgPSBhcmdzQXJyYXlbaVRyYW5zZm9ybV07CgogICAgICAgIGlmIChhcmdzQXJyYXlbaVBJTVhPXVswXSAhPT0gZmlyc3RQSU1YT0FyZzAgfHwgdHJhbnNmb3JtQXJnc1swXSAhPT0gZmlyc3RUcmFuc2Zvcm1BcmcwIHx8IHRyYW5zZm9ybUFyZ3NbMV0gIT09IDAgfHwgdHJhbnNmb3JtQXJnc1syXSAhPT0gMCB8fCB0cmFuc2Zvcm1BcmdzWzNdICE9PSBmaXJzdFRyYW5zZm9ybUFyZzMpIHsKICAgICAgICAgIGlmIChxIDwgTUlOX0lNQUdFU19JTl9NQVNLU19CTE9DSykgewogICAgICAgICAgICBpc1NhbWVJbWFnZSA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY291bnQgPSBxOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChpc1NhbWVJbWFnZSkgewogICAgICBjb3VudCA9IE1hdGgubWluKGNvdW50LCBNQVhfU0FNRV9JTUFHRVNfSU5fTUFTS1NfQkxPQ0spOwogICAgICB2YXIgcG9zaXRpb25zID0gbmV3IEZsb2F0MzJBcnJheShjb3VudCAqIDIpOwogICAgICBpVHJhbnNmb3JtID0gaUZpcnN0VHJhbnNmb3JtOwoKICAgICAgZm9yIChxID0gMDsgcSA8IGNvdW50OyBxKyssIGlUcmFuc2Zvcm0gKz0gNCkgewogICAgICAgIHRyYW5zZm9ybUFyZ3MgPSBhcmdzQXJyYXlbaVRyYW5zZm9ybV07CiAgICAgICAgcG9zaXRpb25zW3EgPDwgMV0gPSB0cmFuc2Zvcm1BcmdzWzRdOwogICAgICAgIHBvc2l0aW9uc1socSA8PCAxKSArIDFdID0gdHJhbnNmb3JtQXJnc1s1XTsKICAgICAgfQoKICAgICAgZm5BcnJheS5zcGxpY2UoaUZpcnN0U2F2ZSwgY291bnQgKiA0LCBfdXRpbC5PUFMucGFpbnRJbWFnZU1hc2tYT2JqZWN0UmVwZWF0KTsKICAgICAgYXJnc0FycmF5LnNwbGljZShpRmlyc3RTYXZlLCBjb3VudCAqIDQsIFtmaXJzdFBJTVhPQXJnMCwgZmlyc3RUcmFuc2Zvcm1BcmcwLCBmaXJzdFRyYW5zZm9ybUFyZzMsIHBvc2l0aW9uc10pOwogICAgfSBlbHNlIHsKICAgICAgY291bnQgPSBNYXRoLm1pbihjb3VudCwgTUFYX0lNQUdFU19JTl9NQVNLU19CTE9DSyk7CiAgICAgIHZhciBpbWFnZXMgPSBbXTsKCiAgICAgIGZvciAocSA9IDA7IHEgPCBjb3VudDsgcSsrKSB7CiAgICAgICAgdHJhbnNmb3JtQXJncyA9IGFyZ3NBcnJheVtpRmlyc3RUcmFuc2Zvcm0gKyAocSA8PCAyKV07CiAgICAgICAgdmFyIG1hc2tQYXJhbXMgPSBhcmdzQXJyYXlbaUZpcnN0UElNWE8gKyAocSA8PCAyKV1bMF07CiAgICAgICAgaW1hZ2VzLnB1c2goewogICAgICAgICAgZGF0YTogbWFza1BhcmFtcy5kYXRhLAogICAgICAgICAgd2lkdGg6IG1hc2tQYXJhbXMud2lkdGgsCiAgICAgICAgICBoZWlnaHQ6IG1hc2tQYXJhbXMuaGVpZ2h0LAogICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2Zvcm1BcmdzCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZuQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgX3V0aWwuT1BTLnBhaW50SW1hZ2VNYXNrWE9iamVjdEdyb3VwKTsKICAgICAgYXJnc0FycmF5LnNwbGljZShpRmlyc3RTYXZlLCBjb3VudCAqIDQsIFtpbWFnZXNdKTsKICAgIH0KCiAgICByZXR1cm4gaUZpcnN0U2F2ZSArIDE7CiAgfSk7CiAgYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLnNhdmUsIF91dGlsLk9QUy50cmFuc2Zvcm0sIF91dGlsLk9QUy5wYWludEltYWdlWE9iamVjdCwgX3V0aWwuT1BTLnJlc3RvcmVdLCBmdW5jdGlvbiAoY29udGV4dCkgewogICAgdmFyIGFyZ3NBcnJheSA9IGNvbnRleHQuYXJnc0FycmF5OwogICAgdmFyIGlGaXJzdFRyYW5zZm9ybSA9IGNvbnRleHQuaUN1cnIgLSAyOwogICAgcmV0dXJuIGFyZ3NBcnJheVtpRmlyc3RUcmFuc2Zvcm1dWzFdID09PSAwICYmIGFyZ3NBcnJheVtpRmlyc3RUcmFuc2Zvcm1dWzJdID09PSAwOwogIH0sIGZ1bmN0aW9uIGl0ZXJhdGVJbWFnZUdyb3VwKGNvbnRleHQsIGkpIHsKICAgIHZhciBmbkFycmF5ID0gY29udGV4dC5mbkFycmF5LAogICAgICAgIGFyZ3NBcnJheSA9IGNvbnRleHQuYXJnc0FycmF5OwogICAgdmFyIGlGaXJzdFNhdmUgPSBjb250ZXh0LmlDdXJyIC0gMzsKICAgIHZhciBwb3MgPSAoaSAtIGlGaXJzdFNhdmUpICUgNDsKCiAgICBzd2l0Y2ggKHBvcykgewogICAgICBjYXNlIDA6CiAgICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy5zYXZlOwoKICAgICAgY2FzZSAxOgogICAgICAgIGlmIChmbkFycmF5W2ldICE9PSBfdXRpbC5PUFMudHJhbnNmb3JtKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB2YXIgaUZpcnN0VHJhbnNmb3JtID0gY29udGV4dC5pQ3VyciAtIDI7CiAgICAgICAgdmFyIGZpcnN0VHJhbnNmb3JtQXJnMCA9IGFyZ3NBcnJheVtpRmlyc3RUcmFuc2Zvcm1dWzBdOwogICAgICAgIHZhciBmaXJzdFRyYW5zZm9ybUFyZzMgPSBhcmdzQXJyYXlbaUZpcnN0VHJhbnNmb3JtXVszXTsKCiAgICAgICAgaWYgKGFyZ3NBcnJheVtpXVswXSAhPT0gZmlyc3RUcmFuc2Zvcm1BcmcwIHx8IGFyZ3NBcnJheVtpXVsxXSAhPT0gMCB8fCBhcmdzQXJyYXlbaV1bMl0gIT09IDAgfHwgYXJnc0FycmF5W2ldWzNdICE9PSBmaXJzdFRyYW5zZm9ybUFyZzMpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgY2FzZSAyOgogICAgICAgIGlmIChmbkFycmF5W2ldICE9PSBfdXRpbC5PUFMucGFpbnRJbWFnZVhPYmplY3QpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciBpRmlyc3RQSVhPID0gY29udGV4dC5pQ3VyciAtIDE7CiAgICAgICAgdmFyIGZpcnN0UElYT0FyZzAgPSBhcmdzQXJyYXlbaUZpcnN0UElYT11bMF07CgogICAgICAgIGlmIChhcmdzQXJyYXlbaV1bMF0gIT09IGZpcnN0UElYT0FyZzApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgY2FzZSAzOgogICAgICAgIHJldHVybiBmbkFycmF5W2ldID09PSBfdXRpbC5PUFMucmVzdG9yZTsKICAgIH0KCiAgICB0aHJvdyBuZXcgRXJyb3IoIml0ZXJhdGVJbWFnZUdyb3VwIC0gaW52YWxpZCBwb3M6ICIuY29uY2F0KHBvcykpOwogIH0sIGZ1bmN0aW9uIChjb250ZXh0LCBpKSB7CiAgICB2YXIgTUlOX0lNQUdFU19JTl9CTE9DSyA9IDM7CiAgICB2YXIgTUFYX0lNQUdFU19JTl9CTE9DSyA9IDEwMDA7CiAgICB2YXIgZm5BcnJheSA9IGNvbnRleHQuZm5BcnJheSwKICAgICAgICBhcmdzQXJyYXkgPSBjb250ZXh0LmFyZ3NBcnJheTsKICAgIHZhciBjdXJyID0gY29udGV4dC5pQ3VycjsKICAgIHZhciBpRmlyc3RTYXZlID0gY3VyciAtIDM7CiAgICB2YXIgaUZpcnN0VHJhbnNmb3JtID0gY3VyciAtIDI7CiAgICB2YXIgaUZpcnN0UElYTyA9IGN1cnIgLSAxOwogICAgdmFyIGZpcnN0UElYT0FyZzAgPSBhcmdzQXJyYXlbaUZpcnN0UElYT11bMF07CiAgICB2YXIgZmlyc3RUcmFuc2Zvcm1BcmcwID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bMF07CiAgICB2YXIgZmlyc3RUcmFuc2Zvcm1BcmczID0gYXJnc0FycmF5W2lGaXJzdFRyYW5zZm9ybV1bM107CiAgICB2YXIgY291bnQgPSBNYXRoLm1pbihNYXRoLmZsb29yKChpIC0gaUZpcnN0U2F2ZSkgLyA0KSwgTUFYX0lNQUdFU19JTl9CTE9DSyk7CgogICAgaWYgKGNvdW50IDwgTUlOX0lNQUdFU19JTl9CTE9DSykgewogICAgICByZXR1cm4gaSAtIChpIC0gaUZpcnN0U2F2ZSkgJSA0OwogICAgfQoKICAgIHZhciBwb3NpdGlvbnMgPSBuZXcgRmxvYXQzMkFycmF5KGNvdW50ICogMik7CiAgICB2YXIgaVRyYW5zZm9ybSA9IGlGaXJzdFRyYW5zZm9ybTsKCiAgICBmb3IgKHZhciBxID0gMDsgcSA8IGNvdW50OyBxKyssIGlUcmFuc2Zvcm0gKz0gNCkgewogICAgICB2YXIgdHJhbnNmb3JtQXJncyA9IGFyZ3NBcnJheVtpVHJhbnNmb3JtXTsKICAgICAgcG9zaXRpb25zW3EgPDwgMV0gPSB0cmFuc2Zvcm1BcmdzWzRdOwogICAgICBwb3NpdGlvbnNbKHEgPDwgMSkgKyAxXSA9IHRyYW5zZm9ybUFyZ3NbNV07CiAgICB9CgogICAgdmFyIGFyZ3MgPSBbZmlyc3RQSVhPQXJnMCwgZmlyc3RUcmFuc2Zvcm1BcmcwLCBmaXJzdFRyYW5zZm9ybUFyZzMsIHBvc2l0aW9uc107CiAgICBmbkFycmF5LnNwbGljZShpRmlyc3RTYXZlLCBjb3VudCAqIDQsIF91dGlsLk9QUy5wYWludEltYWdlWE9iamVjdFJlcGVhdCk7CiAgICBhcmdzQXJyYXkuc3BsaWNlKGlGaXJzdFNhdmUsIGNvdW50ICogNCwgYXJncyk7CiAgICByZXR1cm4gaUZpcnN0U2F2ZSArIDE7CiAgfSk7CiAgYWRkU3RhdGUoSW5pdGlhbFN0YXRlLCBbX3V0aWwuT1BTLmJlZ2luVGV4dCwgX3V0aWwuT1BTLnNldEZvbnQsIF91dGlsLk9QUy5zZXRUZXh0TWF0cml4LCBfdXRpbC5PUFMuc2hvd1RleHQsIF91dGlsLk9QUy5lbmRUZXh0XSwgbnVsbCwgZnVuY3Rpb24gaXRlcmF0ZVNob3dUZXh0R3JvdXAoY29udGV4dCwgaSkgewogICAgdmFyIGZuQXJyYXkgPSBjb250ZXh0LmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5ID0gY29udGV4dC5hcmdzQXJyYXk7CiAgICB2YXIgaUZpcnN0U2F2ZSA9IGNvbnRleHQuaUN1cnIgLSA0OwogICAgdmFyIHBvcyA9IChpIC0gaUZpcnN0U2F2ZSkgJSA1OwoKICAgIHN3aXRjaCAocG9zKSB7CiAgICAgIGNhc2UgMDoKICAgICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLmJlZ2luVGV4dDsKCiAgICAgIGNhc2UgMToKICAgICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLnNldEZvbnQ7CgogICAgICBjYXNlIDI6CiAgICAgICAgcmV0dXJuIGZuQXJyYXlbaV0gPT09IF91dGlsLk9QUy5zZXRUZXh0TWF0cml4OwoKICAgICAgY2FzZSAzOgogICAgICAgIGlmIChmbkFycmF5W2ldICE9PSBfdXRpbC5PUFMuc2hvd1RleHQpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciBpRmlyc3RTZXRGb250ID0gY29udGV4dC5pQ3VyciAtIDM7CiAgICAgICAgdmFyIGZpcnN0U2V0Rm9udEFyZzAgPSBhcmdzQXJyYXlbaUZpcnN0U2V0Rm9udF1bMF07CiAgICAgICAgdmFyIGZpcnN0U2V0Rm9udEFyZzEgPSBhcmdzQXJyYXlbaUZpcnN0U2V0Rm9udF1bMV07CgogICAgICAgIGlmIChhcmdzQXJyYXlbaV1bMF0gIT09IGZpcnN0U2V0Rm9udEFyZzAgfHwgYXJnc0FycmF5W2ldWzFdICE9PSBmaXJzdFNldEZvbnRBcmcxKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgIGNhc2UgNDoKICAgICAgICByZXR1cm4gZm5BcnJheVtpXSA9PT0gX3V0aWwuT1BTLmVuZFRleHQ7CiAgICB9CgogICAgdGhyb3cgbmV3IEVycm9yKCJpdGVyYXRlU2hvd1RleHRHcm91cCAtIGludmFsaWQgcG9zOiAiLmNvbmNhdChwb3MpKTsKICB9LCBmdW5jdGlvbiAoY29udGV4dCwgaSkgewogICAgdmFyIE1JTl9DSEFSU19JTl9CTE9DSyA9IDM7CiAgICB2YXIgTUFYX0NIQVJTX0lOX0JMT0NLID0gMTAwMDsKICAgIHZhciBmbkFycmF5ID0gY29udGV4dC5mbkFycmF5LAogICAgICAgIGFyZ3NBcnJheSA9IGNvbnRleHQuYXJnc0FycmF5OwogICAgdmFyIGN1cnIgPSBjb250ZXh0LmlDdXJyOwogICAgdmFyIGlGaXJzdEJlZ2luVGV4dCA9IGN1cnIgLSA0OwogICAgdmFyIGlGaXJzdFNldEZvbnQgPSBjdXJyIC0gMzsKICAgIHZhciBpRmlyc3RTZXRUZXh0TWF0cml4ID0gY3VyciAtIDI7CiAgICB2YXIgaUZpcnN0U2hvd1RleHQgPSBjdXJyIC0gMTsKICAgIHZhciBpRmlyc3RFbmRUZXh0ID0gY3VycjsKICAgIHZhciBmaXJzdFNldEZvbnRBcmcwID0gYXJnc0FycmF5W2lGaXJzdFNldEZvbnRdWzBdOwogICAgdmFyIGZpcnN0U2V0Rm9udEFyZzEgPSBhcmdzQXJyYXlbaUZpcnN0U2V0Rm9udF1bMV07CiAgICB2YXIgY291bnQgPSBNYXRoLm1pbihNYXRoLmZsb29yKChpIC0gaUZpcnN0QmVnaW5UZXh0KSAvIDUpLCBNQVhfQ0hBUlNfSU5fQkxPQ0spOwoKICAgIGlmIChjb3VudCA8IE1JTl9DSEFSU19JTl9CTE9DSykgewogICAgICByZXR1cm4gaSAtIChpIC0gaUZpcnN0QmVnaW5UZXh0KSAlIDU7CiAgICB9CgogICAgdmFyIGlGaXJzdCA9IGlGaXJzdEJlZ2luVGV4dDsKCiAgICBpZiAoaUZpcnN0QmVnaW5UZXh0ID49IDQgJiYgZm5BcnJheVtpRmlyc3RCZWdpblRleHQgLSA0XSA9PT0gZm5BcnJheVtpRmlyc3RTZXRGb250XSAmJiBmbkFycmF5W2lGaXJzdEJlZ2luVGV4dCAtIDNdID09PSBmbkFycmF5W2lGaXJzdFNldFRleHRNYXRyaXhdICYmIGZuQXJyYXlbaUZpcnN0QmVnaW5UZXh0IC0gMl0gPT09IGZuQXJyYXlbaUZpcnN0U2hvd1RleHRdICYmIGZuQXJyYXlbaUZpcnN0QmVnaW5UZXh0IC0gMV0gPT09IGZuQXJyYXlbaUZpcnN0RW5kVGV4dF0gJiYgYXJnc0FycmF5W2lGaXJzdEJlZ2luVGV4dCAtIDRdWzBdID09PSBmaXJzdFNldEZvbnRBcmcwICYmIGFyZ3NBcnJheVtpRmlyc3RCZWdpblRleHQgLSA0XVsxXSA9PT0gZmlyc3RTZXRGb250QXJnMSkgewogICAgICBjb3VudCsrOwogICAgICBpRmlyc3QgLT0gNTsKICAgIH0KCiAgICB2YXIgaUVuZFRleHQgPSBpRmlyc3QgKyA0OwoKICAgIGZvciAodmFyIHEgPSAxOyBxIDwgY291bnQ7IHErKykgewogICAgICBmbkFycmF5LnNwbGljZShpRW5kVGV4dCwgMyk7CiAgICAgIGFyZ3NBcnJheS5zcGxpY2UoaUVuZFRleHQsIDMpOwogICAgICBpRW5kVGV4dCArPSAyOwogICAgfQoKICAgIHJldHVybiBpRW5kVGV4dCArIDE7CiAgfSk7CgogIGZ1bmN0aW9uIFF1ZXVlT3B0aW1pemVyKHF1ZXVlKSB7CiAgICB0aGlzLnF1ZXVlID0gcXVldWU7CiAgICB0aGlzLnN0YXRlID0gbnVsbDsKICAgIHRoaXMuY29udGV4dCA9IHsKICAgICAgaUN1cnI6IDAsCiAgICAgIGZuQXJyYXk6IHF1ZXVlLmZuQXJyYXksCiAgICAgIGFyZ3NBcnJheTogcXVldWUuYXJnc0FycmF5CiAgICB9OwogICAgdGhpcy5tYXRjaCA9IG51bGw7CiAgICB0aGlzLmxhc3RQcm9jZXNzZWQgPSAwOwogIH0KCiAgUXVldWVPcHRpbWl6ZXIucHJvdG90eXBlID0gewogICAgX29wdGltaXplOiBmdW5jdGlvbiBfb3B0aW1pemUoKSB7CiAgICAgIHZhciBmbkFycmF5ID0gdGhpcy5xdWV1ZS5mbkFycmF5OwogICAgICB2YXIgaSA9IHRoaXMubGFzdFByb2Nlc3NlZCwKICAgICAgICAgIGlpID0gZm5BcnJheS5sZW5ndGg7CiAgICAgIHZhciBzdGF0ZSA9IHRoaXMuc3RhdGU7CiAgICAgIHZhciBtYXRjaCA9IHRoaXMubWF0Y2g7CgogICAgICBpZiAoIXN0YXRlICYmICFtYXRjaCAmJiBpICsgMSA9PT0gaWkgJiYgIUluaXRpYWxTdGF0ZVtmbkFycmF5W2ldXSkgewogICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZCA9IGlpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLmNvbnRleHQ7CgogICAgICB3aGlsZSAoaSA8IGlpKSB7CiAgICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgICB2YXIgaXRlcmF0ZSA9ICgwLCBtYXRjaC5pdGVyYXRlRm4pKGNvbnRleHQsIGkpOwoKICAgICAgICAgIGlmIChpdGVyYXRlKSB7CiAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaSA9ICgwLCBtYXRjaC5wcm9jZXNzRm4pKGNvbnRleHQsIGkgKyAxKTsKICAgICAgICAgIGlpID0gZm5BcnJheS5sZW5ndGg7CiAgICAgICAgICBtYXRjaCA9IG51bGw7CiAgICAgICAgICBzdGF0ZSA9IG51bGw7CgogICAgICAgICAgaWYgKGkgPj0gaWkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzdGF0ZSA9IChzdGF0ZSB8fCBJbml0aWFsU3RhdGUpW2ZuQXJyYXlbaV1dOwoKICAgICAgICBpZiAoIXN0YXRlIHx8IEFycmF5LmlzQXJyYXkoc3RhdGUpKSB7CiAgICAgICAgICBpKys7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGNvbnRleHQuaUN1cnIgPSBpOwogICAgICAgIGkrKzsKCiAgICAgICAgaWYgKHN0YXRlLmNoZWNrRm4gJiYgISgwLCBzdGF0ZS5jaGVja0ZuKShjb250ZXh0KSkgewogICAgICAgICAgc3RhdGUgPSBudWxsOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBtYXRjaCA9IHN0YXRlOwogICAgICAgIHN0YXRlID0gbnVsbDsKICAgICAgfQoKICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgICB0aGlzLm1hdGNoID0gbWF0Y2g7CiAgICAgIHRoaXMubGFzdFByb2Nlc3NlZCA9IGk7CiAgICB9LAogICAgcHVzaDogZnVuY3Rpb24gcHVzaChmbiwgYXJncykgewogICAgICB0aGlzLnF1ZXVlLmZuQXJyYXkucHVzaChmbik7CiAgICAgIHRoaXMucXVldWUuYXJnc0FycmF5LnB1c2goYXJncyk7CgogICAgICB0aGlzLl9vcHRpbWl6ZSgpOwogICAgfSwKICAgIGZsdXNoOiBmdW5jdGlvbiBmbHVzaCgpIHsKICAgICAgd2hpbGUgKHRoaXMubWF0Y2gpIHsKICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5xdWV1ZS5mbkFycmF5Lmxlbmd0aDsKICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWQgPSAoMCwgdGhpcy5tYXRjaC5wcm9jZXNzRm4pKHRoaXMuY29udGV4dCwgbGVuZ3RoKTsKICAgICAgICB0aGlzLm1hdGNoID0gbnVsbDsKICAgICAgICB0aGlzLnN0YXRlID0gbnVsbDsKCiAgICAgICAgdGhpcy5fb3B0aW1pemUoKTsKICAgICAgfQogICAgfSwKICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgdGhpcy5zdGF0ZSA9IG51bGw7CiAgICAgIHRoaXMubWF0Y2ggPSBudWxsOwogICAgICB0aGlzLmxhc3RQcm9jZXNzZWQgPSAwOwogICAgfQogIH07CiAgcmV0dXJuIFF1ZXVlT3B0aW1pemVyOwp9KCk7Cgp2YXIgTnVsbE9wdGltaXplciA9IGZ1bmN0aW9uIE51bGxPcHRpbWl6ZXJDbG9zdXJlKCkgewogIGZ1bmN0aW9uIE51bGxPcHRpbWl6ZXIocXVldWUpIHsKICAgIHRoaXMucXVldWUgPSBxdWV1ZTsKICB9CgogIE51bGxPcHRpbWl6ZXIucHJvdG90eXBlID0gewogICAgcHVzaDogZnVuY3Rpb24gcHVzaChmbiwgYXJncykgewogICAgICB0aGlzLnF1ZXVlLmZuQXJyYXkucHVzaChmbik7CiAgICAgIHRoaXMucXVldWUuYXJnc0FycmF5LnB1c2goYXJncyk7CiAgICB9LAogICAgZmx1c2g6IGZ1bmN0aW9uIGZsdXNoKCkge30sCiAgICByZXNldDogZnVuY3Rpb24gcmVzZXQoKSB7fQogIH07CiAgcmV0dXJuIE51bGxPcHRpbWl6ZXI7Cn0oKTsKCnZhciBPcGVyYXRvckxpc3QgPSBmdW5jdGlvbiBPcGVyYXRvckxpc3RDbG9zdXJlKCkgewogIHZhciBDSFVOS19TSVpFID0gMTAwMDsKICB2YXIgQ0hVTktfU0laRV9BQk9VVCA9IENIVU5LX1NJWkUgLSA1OwoKICBmdW5jdGlvbiBPcGVyYXRvckxpc3QoaW50ZW50LCBzdHJlYW1TaW5rLCBwYWdlSW5kZXgpIHsKICAgIHRoaXMuX3N0cmVhbVNpbmsgPSBzdHJlYW1TaW5rOwogICAgdGhpcy5mbkFycmF5ID0gW107CiAgICB0aGlzLmFyZ3NBcnJheSA9IFtdOwoKICAgIGlmIChzdHJlYW1TaW5rICYmIGludGVudCAhPT0gIm9wbGlzdCIpIHsKICAgICAgdGhpcy5vcHRpbWl6ZXIgPSBuZXcgUXVldWVPcHRpbWl6ZXIodGhpcyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLm9wdGltaXplciA9IG5ldyBOdWxsT3B0aW1pemVyKHRoaXMpOwogICAgfQoKICAgIHRoaXMuZGVwZW5kZW5jaWVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMuX3RvdGFsTGVuZ3RoID0gMDsKICAgIHRoaXMucGFnZUluZGV4ID0gcGFnZUluZGV4OwogICAgdGhpcy5pbnRlbnQgPSBpbnRlbnQ7CiAgICB0aGlzLndlaWdodCA9IDA7CiAgICB0aGlzLl9yZXNvbHZlZCA9IHN0cmVhbVNpbmsgPyBudWxsIDogUHJvbWlzZS5yZXNvbHZlKCk7CiAgfQoKICBPcGVyYXRvckxpc3QucHJvdG90eXBlID0gewogICAgZ2V0IGxlbmd0aCgpIHsKICAgICAgcmV0dXJuIHRoaXMuYXJnc0FycmF5Lmxlbmd0aDsKICAgIH0sCgogICAgZ2V0IHJlYWR5KCkgewogICAgICByZXR1cm4gdGhpcy5fcmVzb2x2ZWQgfHwgdGhpcy5fc3RyZWFtU2luay5yZWFkeTsKICAgIH0sCgogICAgZ2V0IHRvdGFsTGVuZ3RoKCkgewogICAgICByZXR1cm4gdGhpcy5fdG90YWxMZW5ndGggKyB0aGlzLmxlbmd0aDsKICAgIH0sCgogICAgYWRkT3A6IGZ1bmN0aW9uIGFkZE9wKGZuLCBhcmdzKSB7CiAgICAgIHRoaXMub3B0aW1pemVyLnB1c2goZm4sIGFyZ3MpOwogICAgICB0aGlzLndlaWdodCsrOwoKICAgICAgaWYgKHRoaXMuX3N0cmVhbVNpbmspIHsKICAgICAgICBpZiAodGhpcy53ZWlnaHQgPj0gQ0hVTktfU0laRSkgewogICAgICAgICAgdGhpcy5mbHVzaCgpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy53ZWlnaHQgPj0gQ0hVTktfU0laRV9BQk9VVCAmJiAoZm4gPT09IF91dGlsLk9QUy5yZXN0b3JlIHx8IGZuID09PSBfdXRpbC5PUFMuZW5kVGV4dCkpIHsKICAgICAgICAgIHRoaXMuZmx1c2goKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhZGREZXBlbmRlbmN5OiBmdW5jdGlvbiBhZGREZXBlbmRlbmN5KGRlcGVuZGVuY3kpIHsKICAgICAgaWYgKGRlcGVuZGVuY3kgaW4gdGhpcy5kZXBlbmRlbmNpZXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuZGVwZW5kZW5jaWVzW2RlcGVuZGVuY3ldID0gdHJ1ZTsKICAgICAgdGhpcy5hZGRPcChfdXRpbC5PUFMuZGVwZW5kZW5jeSwgW2RlcGVuZGVuY3ldKTsKICAgIH0sCiAgICBhZGREZXBlbmRlbmNpZXM6IGZ1bmN0aW9uIGFkZERlcGVuZGVuY2llcyhkZXBlbmRlbmNpZXMpIHsKICAgICAgZm9yICh2YXIga2V5IGluIGRlcGVuZGVuY2llcykgewogICAgICAgIHRoaXMuYWRkRGVwZW5kZW5jeShrZXkpOwogICAgICB9CiAgICB9LAogICAgYWRkT3BMaXN0OiBmdW5jdGlvbiBhZGRPcExpc3Qob3BMaXN0KSB7CiAgICAgIGlmICghKG9wTGlzdCBpbnN0YW5jZW9mIE9wZXJhdG9yTGlzdCkpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoJ2FkZE9wTGlzdCAtIGlnbm9yaW5nIGludmFsaWQgIm9wTGlzdCIgcGFyYW1ldGVyLicpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmRlcGVuZGVuY2llcywgb3BMaXN0LmRlcGVuZGVuY2llcyk7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBvcExpc3QubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIHRoaXMuYWRkT3Aob3BMaXN0LmZuQXJyYXlbaV0sIG9wTGlzdC5hcmdzQXJyYXlbaV0pOwogICAgICB9CiAgICB9LAogICAgZ2V0SVI6IGZ1bmN0aW9uIGdldElSKCkgewogICAgICByZXR1cm4gewogICAgICAgIGZuQXJyYXk6IHRoaXMuZm5BcnJheSwKICAgICAgICBhcmdzQXJyYXk6IHRoaXMuYXJnc0FycmF5LAogICAgICAgIGxlbmd0aDogdGhpcy5sZW5ndGgKICAgICAgfTsKICAgIH0sCgogICAgZ2V0IF90cmFuc2ZlcnMoKSB7CiAgICAgIHZhciB0cmFuc2ZlcnMgPSBbXTsKICAgICAgdmFyIGZuQXJyYXkgPSB0aGlzLmZuQXJyYXksCiAgICAgICAgICBhcmdzQXJyYXkgPSB0aGlzLmFyZ3NBcnJheSwKICAgICAgICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgIHN3aXRjaCAoZm5BcnJheVtpXSkgewogICAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRJbmxpbmVJbWFnZVhPYmplY3Q6CiAgICAgICAgICBjYXNlIF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdEdyb3VwOgogICAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRJbWFnZU1hc2tYT2JqZWN0OgogICAgICAgICAgICB2YXIgYXJnID0gYXJnc0FycmF5W2ldWzBdOwogICAgICAgICAgICA7CgogICAgICAgICAgICBpZiAoIWFyZy5jYWNoZWQpIHsKICAgICAgICAgICAgICB0cmFuc2ZlcnMucHVzaChhcmcuZGF0YS5idWZmZXIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0cmFuc2ZlcnM7CiAgICB9LAoKICAgIGZsdXNoOiBmdW5jdGlvbiBmbHVzaCgpIHsKICAgICAgdmFyIGxhc3RDaHVuayA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICAgIHRoaXMub3B0aW1pemVyLmZsdXNoKCk7CiAgICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aDsKICAgICAgdGhpcy5fdG90YWxMZW5ndGggKz0gbGVuZ3RoOwoKICAgICAgdGhpcy5fc3RyZWFtU2luay5lbnF1ZXVlKHsKICAgICAgICBmbkFycmF5OiB0aGlzLmZuQXJyYXksCiAgICAgICAgYXJnc0FycmF5OiB0aGlzLmFyZ3NBcnJheSwKICAgICAgICBsYXN0Q2h1bms6IGxhc3RDaHVuaywKICAgICAgICBsZW5ndGg6IGxlbmd0aAogICAgICB9LCAxLCB0aGlzLl90cmFuc2ZlcnMpOwoKICAgICAgdGhpcy5kZXBlbmRlbmNpZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB0aGlzLmZuQXJyYXkubGVuZ3RoID0gMDsKICAgICAgdGhpcy5hcmdzQXJyYXkubGVuZ3RoID0gMDsKICAgICAgdGhpcy53ZWlnaHQgPSAwOwogICAgICB0aGlzLm9wdGltaXplci5yZXNldCgpOwogICAgfQogIH07CiAgcmV0dXJuIE9wZXJhdG9yTGlzdDsKfSgpOwoKZXhwb3J0cy5PcGVyYXRvckxpc3QgPSBPcGVyYXRvckxpc3Q7CgovKioqLyB9KSwKLyogMjIwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuUGFydGlhbEV2YWx1YXRvciA9IHZvaWQgMDsKCnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9fd19wZGZqc19yZXF1aXJlX18oMikpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfY21hcCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjIxKTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyMik7Cgp2YXIgX2VuY29kaW5ncyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI1KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCnZhciBfdW5pY29kZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI4KTsKCnZhciBfc3RhbmRhcmRfZm9udHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyNyk7Cgp2YXIgX3BhdHRlcm4gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzMSk7Cgp2YXIgX3BhcnNlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA0KTsKCnZhciBfYmlkaSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjMyKTsKCnZhciBfY29sb3JzcGFjZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjE2KTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDUpOwoKdmFyIF9nbHlwaGxpc3QgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyNik7Cgp2YXIgX21ldHJpY3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzMyk7Cgp2YXIgX2Z1bmN0aW9uID0gX193X3BkZmpzX3JlcXVpcmVfXygyMzQpOwoKdmFyIF9pbWFnZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjE3KTsKCnZhciBfbXVybXVyaGFzaCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjM2KTsKCnZhciBfb3BlcmF0b3JfbGlzdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjE5KTsKCnZhciBfaW1hZ2UgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzNyk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAiZGVmYXVsdCI6IG9iaiB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobywgYWxsb3dBcnJheUxpa2UpIHsgdmFyIGl0OyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gInVuZGVmaW5lZCIgfHwgb1tTeW1ib2wuaXRlcmF0b3JdID09IG51bGwpIHsgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHsgaWYgKGl0KSBvID0gaXQ7IHZhciBpID0gMDsgdmFyIEYgPSBmdW5jdGlvbiBGKCkge307IHJldHVybiB7IHM6IEYsIG46IGZ1bmN0aW9uIG4oKSB7IGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4geyBkb25lOiB0cnVlIH07IHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogb1tpKytdIH07IH0sIGU6IGZ1bmN0aW9uIGUoX2UpIHsgdGhyb3cgX2U7IH0sIGY6IEYgfTsgfSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuIik7IH0gdmFyIG5vcm1hbENvbXBsZXRpb24gPSB0cnVlLCBkaWRFcnIgPSBmYWxzZSwgZXJyOyByZXR1cm4geyBzOiBmdW5jdGlvbiBzKCkgeyBpdCA9IG9bU3ltYm9sLml0ZXJhdG9yXSgpOyB9LCBuOiBmdW5jdGlvbiBuKCkgeyB2YXIgc3RlcCA9IGl0Lm5leHQoKTsgbm9ybWFsQ29tcGxldGlvbiA9IHN0ZXAuZG9uZTsgcmV0dXJuIHN0ZXA7IH0sIGU6IGZ1bmN0aW9uIGUoX2UyKSB7IGRpZEVyciA9IHRydWU7IGVyciA9IF9lMjsgfSwgZjogZnVuY3Rpb24gZigpIHsgdHJ5IHsgaWYgKCFub3JtYWxDb21wbGV0aW9uICYmIGl0WyJyZXR1cm4iXSAhPSBudWxsKSBpdFsicmV0dXJuIl0oKTsgfSBmaW5hbGx5IHsgaWYgKGRpZEVycikgdGhyb3cgZXJyOyB9IH0gfTsgfQoKZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikgeyBpZiAoIW8pIHJldHVybjsgaWYgKHR5cGVvZiBvID09PSAic3RyaW5nIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSAiTWFwIiB8fCBuID09PSAiU2V0IikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSAiQXJndW1lbnRzIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH0KCmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7IGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoOyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCnZhciBQYXJ0aWFsRXZhbHVhdG9yID0gZnVuY3Rpb24gUGFydGlhbEV2YWx1YXRvckNsb3N1cmUoKSB7CiAgdmFyIERlZmF1bHRQYXJ0aWFsRXZhbHVhdG9yT3B0aW9ucyA9IHsKICAgIG1heEltYWdlU2l6ZTogLTEsCiAgICBkaXNhYmxlRm9udEZhY2U6IGZhbHNlLAogICAgaWdub3JlRXJyb3JzOiBmYWxzZSwKICAgIGlzRXZhbFN1cHBvcnRlZDogdHJ1ZSwKICAgIGZvbnRFeHRyYVByb3BlcnRpZXM6IGZhbHNlCiAgfTsKCiAgZnVuY3Rpb24gUGFydGlhbEV2YWx1YXRvcihfcmVmKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHZhciB4cmVmID0gX3JlZi54cmVmLAogICAgICAgIGhhbmRsZXIgPSBfcmVmLmhhbmRsZXIsCiAgICAgICAgcGFnZUluZGV4ID0gX3JlZi5wYWdlSW5kZXgsCiAgICAgICAgaWRGYWN0b3J5ID0gX3JlZi5pZEZhY3RvcnksCiAgICAgICAgZm9udENhY2hlID0gX3JlZi5mb250Q2FjaGUsCiAgICAgICAgYnVpbHRJbkNNYXBDYWNoZSA9IF9yZWYuYnVpbHRJbkNNYXBDYWNoZSwKICAgICAgICBnbG9iYWxJbWFnZUNhY2hlID0gX3JlZi5nbG9iYWxJbWFnZUNhY2hlLAogICAgICAgIF9yZWYkb3B0aW9ucyA9IF9yZWYub3B0aW9ucywKICAgICAgICBvcHRpb25zID0gX3JlZiRvcHRpb25zID09PSB2b2lkIDAgPyBudWxsIDogX3JlZiRvcHRpb25zLAogICAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeSA9IF9yZWYucGRmRnVuY3Rpb25GYWN0b3J5OwogICAgdGhpcy54cmVmID0geHJlZjsKICAgIHRoaXMuaGFuZGxlciA9IGhhbmRsZXI7CiAgICB0aGlzLnBhZ2VJbmRleCA9IHBhZ2VJbmRleDsKICAgIHRoaXMuaWRGYWN0b3J5ID0gaWRGYWN0b3J5OwogICAgdGhpcy5mb250Q2FjaGUgPSBmb250Q2FjaGU7CiAgICB0aGlzLmJ1aWx0SW5DTWFwQ2FjaGUgPSBidWlsdEluQ01hcENhY2hlOwogICAgdGhpcy5nbG9iYWxJbWFnZUNhY2hlID0gZ2xvYmFsSW1hZ2VDYWNoZTsKICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwgRGVmYXVsdFBhcnRpYWxFdmFsdWF0b3JPcHRpb25zOwogICAgdGhpcy5wZGZGdW5jdGlvbkZhY3RvcnkgPSBwZGZGdW5jdGlvbkZhY3Rvcnk7CiAgICB0aGlzLnBhcnNpbmdUeXBlM0ZvbnQgPSBmYWxzZTsKCiAgICB0aGlzLmZldGNoQnVpbHRJbkNNYXAgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShuYW1lKSB7CiAgICAgICAgdmFyIHJlYWRhYmxlU3RyZWFtLCByZWFkZXIsIGRhdGE7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclsiZGVmYXVsdCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzLmJ1aWx0SW5DTWFwQ2FjaGUuaGFzKG5hbWUpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBfdGhpcy5idWlsdEluQ01hcENhY2hlLmdldChuYW1lKSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJlYWRhYmxlU3RyZWFtID0gX3RoaXMuaGFuZGxlci5zZW5kV2l0aFN0cmVhbSgiRmV0Y2hCdWlsdEluQ01hcCIsIHsKICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZWFkZXIgPSByZWFkYWJsZVN0cmVhbS5nZXRSZWFkZXIoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gcHVtcCgpIHsKICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZCgpLnRoZW4oZnVuY3Rpb24gKF9yZWYzKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBfcmVmMy52YWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gX3JlZjMuZG9uZTsKCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9uZSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICBwdW1wKCk7CiAgICAgICAgICAgICAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcHVtcCgpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGRhdGEgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvbXByZXNzaW9uVHlwZSAhPT0gX3V0aWwuQ01hcENvbXByZXNzaW9uVHlwZS5OT05FKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLmJ1aWx0SW5DTWFwQ2FjaGUuc2V0KG5hbWUsIGRhdGEpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpOwogIH0KCiAgdmFyIFRJTUVfU0xPVF9EVVJBVElPTl9NUyA9IDIwOwogIHZhciBDSEVDS19USU1FX0VWRVJZID0gMTAwOwoKICBmdW5jdGlvbiBUaW1lU2xvdE1hbmFnZXIoKSB7CiAgICB0aGlzLnJlc2V0KCk7CiAgfQoKICBUaW1lU2xvdE1hbmFnZXIucHJvdG90eXBlID0gewogICAgY2hlY2s6IGZ1bmN0aW9uIFRpbWVTbG90TWFuYWdlcl9jaGVjaygpIHsKICAgICAgaWYgKCsrdGhpcy5jaGVja2VkIDwgQ0hFQ0tfVElNRV9FVkVSWSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5jaGVja2VkID0gMDsKICAgICAgcmV0dXJuIHRoaXMuZW5kVGltZSA8PSBEYXRlLm5vdygpOwogICAgfSwKICAgIHJlc2V0OiBmdW5jdGlvbiBUaW1lU2xvdE1hbmFnZXJfcmVzZXQoKSB7CiAgICAgIHRoaXMuZW5kVGltZSA9IERhdGUubm93KCkgKyBUSU1FX1NMT1RfRFVSQVRJT05fTVM7CiAgICAgIHRoaXMuY2hlY2tlZCA9IDA7CiAgICB9CiAgfTsKCiAgZnVuY3Rpb24gbm9ybWFsaXplQmxlbmRNb2RlKHZhbHVlKSB7CiAgICB2YXIgcGFyc2luZ0FycmF5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKCiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdmFsdWUubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIHZhciBtYXliZUJNID0gbm9ybWFsaXplQmxlbmRNb2RlKHZhbHVlW2ldLCB0cnVlKTsKCiAgICAgICAgaWYgKG1heWJlQk0pIHsKICAgICAgICAgIHJldHVybiBtYXliZUJNOwogICAgICAgIH0KICAgICAgfQoKICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnN1cHBvcnRlZCBibGVuZCBtb2RlIEFycmF5OiAiLmNvbmNhdCh2YWx1ZSkpOwogICAgICByZXR1cm4gInNvdXJjZS1vdmVyIjsKICAgIH0KCiAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHZhbHVlKSkgewogICAgICBpZiAocGFyc2luZ0FycmF5KSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiAic291cmNlLW92ZXIiOwogICAgfQoKICAgIHN3aXRjaCAodmFsdWUubmFtZSkgewogICAgICBjYXNlICJOb3JtYWwiOgogICAgICBjYXNlICJDb21wYXRpYmxlIjoKICAgICAgICByZXR1cm4gInNvdXJjZS1vdmVyIjsKCiAgICAgIGNhc2UgIk11bHRpcGx5IjoKICAgICAgICByZXR1cm4gIm11bHRpcGx5IjsKCiAgICAgIGNhc2UgIlNjcmVlbiI6CiAgICAgICAgcmV0dXJuICJzY3JlZW4iOwoKICAgICAgY2FzZSAiT3ZlcmxheSI6CiAgICAgICAgcmV0dXJuICJvdmVybGF5IjsKCiAgICAgIGNhc2UgIkRhcmtlbiI6CiAgICAgICAgcmV0dXJuICJkYXJrZW4iOwoKICAgICAgY2FzZSAiTGlnaHRlbiI6CiAgICAgICAgcmV0dXJuICJsaWdodGVuIjsKCiAgICAgIGNhc2UgIkNvbG9yRG9kZ2UiOgogICAgICAgIHJldHVybiAiY29sb3ItZG9kZ2UiOwoKICAgICAgY2FzZSAiQ29sb3JCdXJuIjoKICAgICAgICByZXR1cm4gImNvbG9yLWJ1cm4iOwoKICAgICAgY2FzZSAiSGFyZExpZ2h0IjoKICAgICAgICByZXR1cm4gImhhcmQtbGlnaHQiOwoKICAgICAgY2FzZSAiU29mdExpZ2h0IjoKICAgICAgICByZXR1cm4gInNvZnQtbGlnaHQiOwoKICAgICAgY2FzZSAiRGlmZmVyZW5jZSI6CiAgICAgICAgcmV0dXJuICJkaWZmZXJlbmNlIjsKCiAgICAgIGNhc2UgIkV4Y2x1c2lvbiI6CiAgICAgICAgcmV0dXJuICJleGNsdXNpb24iOwoKICAgICAgY2FzZSAiSHVlIjoKICAgICAgICByZXR1cm4gImh1ZSI7CgogICAgICBjYXNlICJTYXR1cmF0aW9uIjoKICAgICAgICByZXR1cm4gInNhdHVyYXRpb24iOwoKICAgICAgY2FzZSAiQ29sb3IiOgogICAgICAgIHJldHVybiAiY29sb3IiOwoKICAgICAgY2FzZSAiTHVtaW5vc2l0eSI6CiAgICAgICAgcmV0dXJuICJsdW1pbm9zaXR5IjsKICAgIH0KCiAgICBpZiAocGFyc2luZ0FycmF5KSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgICgwLCBfdXRpbC53YXJuKSgiVW5zdXBwb3J0ZWQgYmxlbmQgbW9kZTogIi5jb25jYXQodmFsdWUubmFtZSkpOwogICAgcmV0dXJuICJzb3VyY2Utb3ZlciI7CiAgfQoKICB2YXIgZGVmZXJyZWQgPSBQcm9taXNlLnJlc29sdmUoKTsKICB2YXIgVElMSU5HX1BBVFRFUk4gPSAxLAogICAgICBTSEFESU5HX1BBVFRFUk4gPSAyOwogIFBhcnRpYWxFdmFsdWF0b3IucHJvdG90eXBlID0gewogICAgY2xvbmU6IGZ1bmN0aW9uIGNsb25lKCkgewogICAgICB2YXIgbmV3T3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogRGVmYXVsdFBhcnRpYWxFdmFsdWF0b3JPcHRpb25zOwogICAgICB2YXIgbmV3RXZhbHVhdG9yID0gT2JqZWN0LmNyZWF0ZSh0aGlzKTsKICAgICAgbmV3RXZhbHVhdG9yLm9wdGlvbnMgPSBuZXdPcHRpb25zOwogICAgICByZXR1cm4gbmV3RXZhbHVhdG9yOwogICAgfSwKICAgIGhhc0JsZW5kTW9kZXM6IGZ1bmN0aW9uIFBhcnRpYWxFdmFsdWF0b3JfaGFzQmxlbmRNb2RlcyhyZXNvdXJjZXMpIHsKICAgICAgaWYgKCEocmVzb3VyY2VzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBwcm9jZXNzZWQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgICAgaWYgKHJlc291cmNlcy5vYmpJZCkgewogICAgICAgIHByb2Nlc3NlZFtyZXNvdXJjZXMub2JqSWRdID0gdHJ1ZTsKICAgICAgfQoKICAgICAgdmFyIG5vZGVzID0gW3Jlc291cmNlc10sCiAgICAgICAgICB4cmVmID0gdGhpcy54cmVmOwoKICAgICAgd2hpbGUgKG5vZGVzLmxlbmd0aCkgewogICAgICAgIHZhciBub2RlID0gbm9kZXMuc2hpZnQoKTsKICAgICAgICB2YXIgZ3JhcGhpY1N0YXRlcyA9IG5vZGUuZ2V0KCJFeHRHU3RhdGUiKTsKCiAgICAgICAgaWYgKGdyYXBoaWNTdGF0ZXMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICB2YXIgZ3JhcGhpY1N0YXRlc0tleXMgPSBncmFwaGljU3RhdGVzLmdldEtleXMoKTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBncmFwaGljU3RhdGVzS2V5cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgIHZhciBrZXkgPSBncmFwaGljU3RhdGVzS2V5c1tpXTsKICAgICAgICAgICAgdmFyIGdyYXBoaWNTdGF0ZSA9IGdyYXBoaWNTdGF0ZXMuZ2V0UmF3KGtleSk7CgogICAgICAgICAgICBpZiAoZ3JhcGhpY1N0YXRlIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuUmVmKSB7CiAgICAgICAgICAgICAgaWYgKHByb2Nlc3NlZFtncmFwaGljU3RhdGUudG9TdHJpbmcoKV0pIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGdyYXBoaWNTdGF0ZSA9IHhyZWYuZmV0Y2goZ3JhcGhpY1N0YXRlKTsKICAgICAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAgICAgICAgICAgaWYgKGdyYXBoaWNTdGF0ZSBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZFtncmFwaGljU3RhdGUudG9TdHJpbmcoKV0gPSB0cnVlOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JFeHRHU3RhdGUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiaGFzQmxlbmRNb2RlcyAtIGlnbm9yaW5nIEV4dEdTdGF0ZTogXCIiLmNvbmNhdChleCwgIlwiLiIpKTsKICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIShncmFwaGljU3RhdGUgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZ3JhcGhpY1N0YXRlLm9iaklkKSB7CiAgICAgICAgICAgICAgcHJvY2Vzc2VkW2dyYXBoaWNTdGF0ZS5vYmpJZF0gPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgYm0gPSBncmFwaGljU3RhdGUuZ2V0KCJCTSIpOwoKICAgICAgICAgICAgaWYgKGJtIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuTmFtZSkgewogICAgICAgICAgICAgIGlmIChibS5uYW1lICE9PSAiTm9ybWFsIikgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGJtICE9PSB1bmRlZmluZWQgJiYgQXJyYXkuaXNBcnJheShibSkpIHsKICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgamogPSBibS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICAgICAgICBpZiAoYm1bal0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5OYW1lICYmIGJtW2pdLm5hbWUgIT09ICJOb3JtYWwiKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFyIHhPYmplY3RzID0gbm9kZS5nZXQoIlhPYmplY3QiKTsKCiAgICAgICAgaWYgKCEoeE9iamVjdHMgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgeE9iamVjdHNLZXlzID0geE9iamVjdHMuZ2V0S2V5cygpOwoKICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9paSA9IHhPYmplY3RzS2V5cy5sZW5ndGg7IF9pIDwgX2lpOyBfaSsrKSB7CiAgICAgICAgICB2YXIgX2tleSA9IHhPYmplY3RzS2V5c1tfaV07CiAgICAgICAgICB2YXIgeE9iamVjdCA9IHhPYmplY3RzLmdldFJhdyhfa2V5KTsKCiAgICAgICAgICBpZiAoeE9iamVjdCBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICBpZiAocHJvY2Vzc2VkW3hPYmplY3QudG9TdHJpbmcoKV0pIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICB4T2JqZWN0ID0geHJlZi5mZXRjaCh4T2JqZWN0KTsKICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgICAgICAgaWYgKHhPYmplY3QgaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkW3hPYmplY3QudG9TdHJpbmcoKV0gPSB0cnVlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JYT2JqZWN0CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiaGFzQmxlbmRNb2RlcyAtIGlnbm9yaW5nIFhPYmplY3Q6IFwiIi5jb25jYXQoZXgsICJcIi4iKSk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRocm93IGV4OwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKHhPYmplY3QpKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh4T2JqZWN0LmRpY3Qub2JqSWQpIHsKICAgICAgICAgICAgaWYgKHByb2Nlc3NlZFt4T2JqZWN0LmRpY3Qub2JqSWRdKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb2Nlc3NlZFt4T2JqZWN0LmRpY3Qub2JqSWRdID0gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgeFJlc291cmNlcyA9IHhPYmplY3QuZGljdC5nZXQoIlJlc291cmNlcyIpOwoKICAgICAgICAgIGlmICh4UmVzb3VyY2VzIGluc3RhbmNlb2YgX3ByaW1pdGl2ZXMuRGljdCAmJiAoIXhSZXNvdXJjZXMub2JqSWQgfHwgIXByb2Nlc3NlZFt4UmVzb3VyY2VzLm9iaklkXSkpIHsKICAgICAgICAgICAgbm9kZXMucHVzaCh4UmVzb3VyY2VzKTsKCiAgICAgICAgICAgIGlmICh4UmVzb3VyY2VzLm9iaklkKSB7CiAgICAgICAgICAgICAgcHJvY2Vzc2VkW3hSZXNvdXJjZXMub2JqSWRdID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIGJ1aWxkRm9ybVhPYmplY3Q6IGZ1bmN0aW9uIGJ1aWxkRm9ybVhPYmplY3QocmVzb3VyY2VzLCB4b2JqLCBzbWFzaywgb3BlcmF0b3JMaXN0LCB0YXNrLCBpbml0aWFsU3RhdGUpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JbImRlZmF1bHQiXS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBkaWN0LCBtYXRyaXgsIGJib3gsIGdyb3VwLCBncm91cE9wdGlvbnMsIGdyb3VwU3VidHlwZSwgY29sb3JTcGFjZTsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkaWN0ID0geG9iai5kaWN0OwogICAgICAgICAgICAgICAgbWF0cml4ID0gZGljdC5nZXRBcnJheSgiTWF0cml4Iik7CiAgICAgICAgICAgICAgICBiYm94ID0gZGljdC5nZXRBcnJheSgiQkJveCIpOwoKICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGJib3gpICYmIGJib3gubGVuZ3RoID09PSA0KSB7CiAgICAgICAgICAgICAgICAgIGJib3ggPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QoYmJveCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBiYm94ID0gbnVsbDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBncm91cCA9IGRpY3QuZ2V0KCJHcm91cCIpOwoKICAgICAgICAgICAgICAgIGlmICghZ3JvdXApIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZ3JvdXBPcHRpb25zID0gewogICAgICAgICAgICAgICAgICBtYXRyaXg6IG1hdHJpeCwKICAgICAgICAgICAgICAgICAgYmJveDogYmJveCwKICAgICAgICAgICAgICAgICAgc21hc2s6IHNtYXNrLAogICAgICAgICAgICAgICAgICBpc29sYXRlZDogZmFsc2UsCiAgICAgICAgICAgICAgICAgIGtub2Nrb3V0OiBmYWxzZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGdyb3VwU3VidHlwZSA9IGdyb3VwLmdldCgiUyIpOwogICAgICAgICAgICAgICAgY29sb3JTcGFjZSA9IG51bGw7CgogICAgICAgICAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShncm91cFN1YnR5cGUsICJUcmFuc3BhcmVuY3kiKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBncm91cE9wdGlvbnMuaXNvbGF0ZWQgPSBncm91cC5nZXQoIkkiKSB8fCBmYWxzZTsKICAgICAgICAgICAgICAgIGdyb3VwT3B0aW9ucy5rbm9ja291dCA9IGdyb3VwLmdldCgiSyIpIHx8IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmICghZ3JvdXAuaGFzKCJDUyIpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLnBhcnNlQ29sb3JTcGFjZSh7CiAgICAgICAgICAgICAgICAgIGNzOiBncm91cC5nZXQoIkNTIiksCiAgICAgICAgICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIGNvbG9yU3BhY2UgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIGlmIChzbWFzayAmJiBzbWFzay5iYWNrZHJvcCkgewogICAgICAgICAgICAgICAgICBjb2xvclNwYWNlID0gY29sb3JTcGFjZSB8fCBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMucmdiOwogICAgICAgICAgICAgICAgICBzbWFzay5iYWNrZHJvcCA9IGNvbG9yU3BhY2UuZ2V0UmdiKHNtYXNrLmJhY2tkcm9wLCAwKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLmJlZ2luR3JvdXAsIFtncm91cE9wdGlvbnNdKTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMucGFpbnRGb3JtWE9iamVjdEJlZ2luLCBbbWF0cml4LCBiYm94XSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgX3RoaXMyLmdldE9wZXJhdG9yTGlzdCh7CiAgICAgICAgICAgICAgICAgIHN0cmVhbTogeG9iaiwKICAgICAgICAgICAgICAgICAgdGFzazogdGFzaywKICAgICAgICAgICAgICAgICAgcmVzb3VyY2VzOiBkaWN0LmdldCgiUmVzb3VyY2VzIikgfHwgcmVzb3VyY2VzLAogICAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3Q6IG9wZXJhdG9yTGlzdCwKICAgICAgICAgICAgICAgICAgaW5pdGlhbFN0YXRlOiBpbml0aWFsU3RhdGUKICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnBhaW50Rm9ybVhPYmplY3RFbmQsIFtdKTsKCiAgICAgICAgICAgICAgICAgIGlmIChncm91cCkgewogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuZW5kR3JvdXAsIFtncm91cE9wdGlvbnNdKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgYnVpbGRQYWludEltYWdlWE9iamVjdDogZnVuY3Rpb24gYnVpbGRQYWludEltYWdlWE9iamVjdChfcmVmNCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIHJlc291cmNlcywgaW1hZ2UsIF9yZWY0JGlzSW5saW5lLCBpc0lubGluZSwgb3BlcmF0b3JMaXN0LCBjYWNoZUtleSwgbG9jYWxJbWFnZUNhY2hlLCBkaWN0LCBpbWFnZVJlZiwgdywgaCwgbWF4SW1hZ2VTaXplLCBpbWFnZU1hc2ssIGltZ0RhdGEsIGFyZ3MsIHdpZHRoLCBoZWlnaHQsIGJpdFN0cmlkZUxlbmd0aCwgaW1nQXJyYXksIGRlY29kZSwgc29mdE1hc2ssIG1hc2ssIFNNQUxMX0lNQUdFX0RJTUVOU0lPTlMsIGltYWdlT2JqLCBvYmpJZCwgY2FjaGVHbG9iYWxseSwgaW1nUHJvbWlzZTsKCiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclsiZGVmYXVsdCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmVzb3VyY2VzID0gX3JlZjQucmVzb3VyY2VzLCBpbWFnZSA9IF9yZWY0LmltYWdlLCBfcmVmNCRpc0lubGluZSA9IF9yZWY0LmlzSW5saW5lLCBpc0lubGluZSA9IF9yZWY0JGlzSW5saW5lID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWY0JGlzSW5saW5lLCBvcGVyYXRvckxpc3QgPSBfcmVmNC5vcGVyYXRvckxpc3QsIGNhY2hlS2V5ID0gX3JlZjQuY2FjaGVLZXksIGxvY2FsSW1hZ2VDYWNoZSA9IF9yZWY0LmxvY2FsSW1hZ2VDYWNoZTsKICAgICAgICAgICAgICAgIGRpY3QgPSBpbWFnZS5kaWN0OwogICAgICAgICAgICAgICAgaW1hZ2VSZWYgPSBkaWN0Lm9iaklkOwogICAgICAgICAgICAgICAgdyA9IGRpY3QuZ2V0KCJXaWR0aCIsICJXIik7CiAgICAgICAgICAgICAgICBoID0gZGljdC5nZXQoIkhlaWdodCIsICJIIik7CgogICAgICAgICAgICAgICAgaWYgKCEoISh3ICYmICgwLCBfdXRpbC5pc051bSkodykpIHx8ICEoaCAmJiAoMCwgX3V0aWwuaXNOdW0pKGgpKSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkltYWdlIGRpbWVuc2lvbnMgYXJlIG1pc3NpbmcsIG9yIG5vdCBudW1iZXJzLiIpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHVuZGVmaW5lZCk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIG1heEltYWdlU2l6ZSA9IF90aGlzMy5vcHRpb25zLm1heEltYWdlU2l6ZTsKCiAgICAgICAgICAgICAgICBpZiAoIShtYXhJbWFnZVNpemUgIT09IC0xICYmIHcgKiBoID4gbWF4SW1hZ2VTaXplKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkltYWdlIGV4Y2VlZGVkIG1heGltdW0gYWxsb3dlZCBzaXplIGFuZCB3YXMgcmVtb3ZlZC4iKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCB1bmRlZmluZWQpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgaW1hZ2VNYXNrID0gZGljdC5nZXQoIkltYWdlTWFzayIsICJJTSIpIHx8IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmICghaW1hZ2VNYXNrKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHdpZHRoID0gZGljdC5nZXQoIldpZHRoIiwgIlciKTsKICAgICAgICAgICAgICAgIGhlaWdodCA9IGRpY3QuZ2V0KCJIZWlnaHQiLCAiSCIpOwogICAgICAgICAgICAgICAgYml0U3RyaWRlTGVuZ3RoID0gd2lkdGggKyA3ID4+IDM7CiAgICAgICAgICAgICAgICBpbWdBcnJheSA9IGltYWdlLmdldEJ5dGVzKGJpdFN0cmlkZUxlbmd0aCAqIGhlaWdodCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICBkZWNvZGUgPSBkaWN0LmdldEFycmF5KCJEZWNvZGUiLCAiRCIpOwogICAgICAgICAgICAgICAgaW1nRGF0YSA9IF9pbWFnZS5QREZJbWFnZS5jcmVhdGVNYXNrKHsKICAgICAgICAgICAgICAgICAgaW1nQXJyYXk6IGltZ0FycmF5LAogICAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsCiAgICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LAogICAgICAgICAgICAgICAgICBpbWFnZUlzRnJvbURlY29kZVN0cmVhbTogaW1hZ2UgaW5zdGFuY2VvZiBfc3RyZWFtLkRlY29kZVN0cmVhbSwKICAgICAgICAgICAgICAgICAgaW52ZXJzZURlY29kZTogISFkZWNvZGUgJiYgZGVjb2RlWzBdID4gMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpbWdEYXRhLmNhY2hlZCA9ICEhY2FjaGVLZXk7CiAgICAgICAgICAgICAgICBhcmdzID0gW2ltZ0RhdGFdOwogICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5wYWludEltYWdlTWFza1hPYmplY3QsIGFyZ3MpOwoKICAgICAgICAgICAgICAgIGlmIChjYWNoZUtleSkgewogICAgICAgICAgICAgICAgICBsb2NhbEltYWdlQ2FjaGUuc2V0KGNhY2hlS2V5LCBpbWFnZVJlZiwgewogICAgICAgICAgICAgICAgICAgIGZuOiBfdXRpbC5PUFMucGFpbnRJbWFnZU1hc2tYT2JqZWN0LAogICAgICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHVuZGVmaW5lZCk7CgogICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgICBzb2Z0TWFzayA9IGRpY3QuZ2V0KCJTTWFzayIsICJTTSIpIHx8IGZhbHNlOwogICAgICAgICAgICAgICAgbWFzayA9IGRpY3QuZ2V0KCJNYXNrIikgfHwgZmFsc2U7CiAgICAgICAgICAgICAgICBTTUFMTF9JTUFHRV9ESU1FTlNJT05TID0gMjAwOwoKICAgICAgICAgICAgICAgIGlmICghKGlzSW5saW5lICYmICFzb2Z0TWFzayAmJiAhbWFzayAmJiB3ICsgaCA8IFNNQUxMX0lNQUdFX0RJTUVOU0lPTlMpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMzM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGltYWdlT2JqID0gbmV3IF9pbWFnZS5QREZJbWFnZSh7CiAgICAgICAgICAgICAgICAgIHhyZWY6IF90aGlzMy54cmVmLAogICAgICAgICAgICAgICAgICByZXM6IHJlc291cmNlcywKICAgICAgICAgICAgICAgICAgaW1hZ2U6IGltYWdlLAogICAgICAgICAgICAgICAgICBpc0lubGluZTogaXNJbmxpbmUsCiAgICAgICAgICAgICAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeTogX3RoaXMzLnBkZkZ1bmN0aW9uRmFjdG9yeQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpbWdEYXRhID0gaW1hZ2VPYmouY3JlYXRlSW1hZ2VEYXRhKHRydWUpOwogICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5wYWludElubGluZUltYWdlWE9iamVjdCwgW2ltZ0RhdGFdKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCB1bmRlZmluZWQpOwoKICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgICAgb2JqSWQgPSAiaW1nXyIuY29uY2F0KF90aGlzMy5pZEZhY3RvcnkuY3JlYXRlT2JqSWQoKSksIGNhY2hlR2xvYmFsbHkgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLnBhcnNpbmdUeXBlM0ZvbnQpIHsKICAgICAgICAgICAgICAgICAgb2JqSWQgPSAiIi5jb25jYXQoX3RoaXMzLmlkRmFjdG9yeS5nZXREb2NJZCgpLCAiX3R5cGUzcmVzXyIpLmNvbmNhdChvYmpJZCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGltYWdlUmVmKSB7CiAgICAgICAgICAgICAgICAgIGNhY2hlR2xvYmFsbHkgPSBfdGhpczMuZ2xvYmFsSW1hZ2VDYWNoZS5zaG91bGRDYWNoZShpbWFnZVJlZiwgX3RoaXMzLnBhZ2VJbmRleCk7CgogICAgICAgICAgICAgICAgICBpZiAoY2FjaGVHbG9iYWxseSkgewogICAgICAgICAgICAgICAgICAgIG9iaklkID0gIiIuY29uY2F0KF90aGlzMy5pZEZhY3RvcnkuZ2V0RG9jSWQoKSwgIl8iKS5jb25jYXQob2JqSWQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZERlcGVuZGVuY3kob2JqSWQpOwogICAgICAgICAgICAgICAgYXJncyA9IFtvYmpJZCwgdywgaF07CiAgICAgICAgICAgICAgICBpbWdQcm9taXNlID0gX2ltYWdlLlBERkltYWdlLmJ1aWxkSW1hZ2UoewogICAgICAgICAgICAgICAgICB4cmVmOiBfdGhpczMueHJlZiwKICAgICAgICAgICAgICAgICAgcmVzOiByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICAgIGltYWdlOiBpbWFnZSwKICAgICAgICAgICAgICAgICAgaXNJbmxpbmU6IGlzSW5saW5lLAogICAgICAgICAgICAgICAgICBwZGZGdW5jdGlvbkZhY3Rvcnk6IF90aGlzMy5wZGZGdW5jdGlvbkZhY3RvcnkKICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGltYWdlT2JqKSB7CiAgICAgICAgICAgICAgICAgIGltZ0RhdGEgPSBpbWFnZU9iai5jcmVhdGVJbWFnZURhdGEoZmFsc2UpOwoKICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5wYXJzaW5nVHlwZTNGb250KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5oYW5kbGVyLnNlbmRXaXRoUHJvbWlzZSgiY29tbW9ub2JqIiwgW29iaklkLCAiRm9udFR5cGUzUmVzIiwgaW1nRGF0YV0sIFtpbWdEYXRhLmRhdGEuYnVmZmVyXSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2FjaGVHbG9iYWxseSkgewogICAgICAgICAgICAgICAgICAgIF90aGlzMy5oYW5kbGVyLnNlbmQoImNvbW1vbm9iaiIsIFtvYmpJZCwgIkltYWdlIiwgaW1nRGF0YV0sIFtpbWdEYXRhLmRhdGEuYnVmZmVyXSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIF90aGlzMy5oYW5kbGVyLnNlbmQoIm9iaiIsIFtvYmpJZCwgX3RoaXMzLnBhZ2VJbmRleCwgIkltYWdlIiwgaW1nRGF0YV0sIFtpbWdEYXRhLmRhdGEuYnVmZmVyXSk7CgogICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVuYWJsZSB0byBkZWNvZGUgaW1hZ2U6ICIgKyByZWFzb24pOwoKICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5wYXJzaW5nVHlwZTNGb250KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5oYW5kbGVyLnNlbmRXaXRoUHJvbWlzZSgiY29tbW9ub2JqIiwgW29iaklkLCAiRm9udFR5cGUzUmVzIiwgbnVsbF0pOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNhY2hlR2xvYmFsbHkpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczMuaGFuZGxlci5zZW5kKCJjb21tb25vYmoiLCBbb2JqSWQsICJJbWFnZSIsIG51bGxdKTsKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgX3RoaXMzLmhhbmRsZXIuc2VuZCgib2JqIiwgW29iaklkLCBfdGhpczMucGFnZUluZGV4LCAiSW1hZ2UiLCBudWxsXSk7CgogICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczMucGFyc2luZ1R5cGUzRm9udCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQxOwogICAgICAgICAgICAgICAgcmV0dXJuIGltZ1Byb21pc2U7CgogICAgICAgICAgICAgIGNhc2UgNDE6CiAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnBhaW50SW1hZ2VYT2JqZWN0LCBhcmdzKTsKCiAgICAgICAgICAgICAgICBpZiAoY2FjaGVLZXkpIHsKICAgICAgICAgICAgICAgICAgbG9jYWxJbWFnZUNhY2hlLnNldChjYWNoZUtleSwgaW1hZ2VSZWYsIHsKICAgICAgICAgICAgICAgICAgICBmbjogX3V0aWwuT1BTLnBhaW50SW1hZ2VYT2JqZWN0LAogICAgICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBpZiAoaW1hZ2VSZWYpIHsKICAgICAgICAgICAgICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KSghaXNJbmxpbmUsICJDYW5ub3QgY2FjaGUgYW4gaW5saW5lIGltYWdlIGdsb2JhbGx5LiIpOwoKICAgICAgICAgICAgICAgICAgICBfdGhpczMuZ2xvYmFsSW1hZ2VDYWNoZS5hZGRQYWdlSW5kZXgoaW1hZ2VSZWYsIF90aGlzMy5wYWdlSW5kZXgpOwoKICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGVHbG9iYWxseSkgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLmdsb2JhbEltYWdlQ2FjaGUuc2V0RGF0YShpbWFnZVJlZiwgewogICAgICAgICAgICAgICAgICAgICAgICBvYmpJZDogb2JqSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGZuOiBfdXRpbC5PUFMucGFpbnRJbWFnZVhPYmplY3QsCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCB1bmRlZmluZWQpOwoKICAgICAgICAgICAgICBjYXNlIDQ0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgaGFuZGxlU01hc2s6IGZ1bmN0aW9uIFBhcnRpYWxFdmFsdWF0b3JfaGFuZGxlU21hc2soc21hc2ssIHJlc291cmNlcywgb3BlcmF0b3JMaXN0LCB0YXNrLCBzdGF0ZU1hbmFnZXIpIHsKICAgICAgdmFyIHNtYXNrQ29udGVudCA9IHNtYXNrLmdldCgiRyIpOwogICAgICB2YXIgc21hc2tPcHRpb25zID0gewogICAgICAgIHN1YnR5cGU6IHNtYXNrLmdldCgiUyIpLm5hbWUsCiAgICAgICAgYmFja2Ryb3A6IHNtYXNrLmdldCgiQkMiKQogICAgICB9OwogICAgICB2YXIgdHJhbnNmZXJPYmogPSBzbWFzay5nZXQoIlRSIik7CgogICAgICBpZiAoKDAsIF9mdW5jdGlvbi5pc1BERkZ1bmN0aW9uKSh0cmFuc2Zlck9iaikpIHsKICAgICAgICB2YXIgdHJhbnNmZXJGbiA9IHRoaXMucGRmRnVuY3Rpb25GYWN0b3J5LmNyZWF0ZSh0cmFuc2Zlck9iaik7CiAgICAgICAgdmFyIHRyYW5zZmVyTWFwID0gbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICAgICAgICB2YXIgdG1wID0gbmV3IEZsb2F0MzJBcnJheSgxKTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7IGkrKykgewogICAgICAgICAgdG1wWzBdID0gaSAvIDI1NTsKICAgICAgICAgIHRyYW5zZmVyRm4odG1wLCAwLCB0bXAsIDApOwogICAgICAgICAgdHJhbnNmZXJNYXBbaV0gPSB0bXBbMF0gKiAyNTUgfCAwOwogICAgICAgIH0KCiAgICAgICAgc21hc2tPcHRpb25zLnRyYW5zZmVyTWFwID0gdHJhbnNmZXJNYXA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmJ1aWxkRm9ybVhPYmplY3QocmVzb3VyY2VzLCBzbWFza0NvbnRlbnQsIHNtYXNrT3B0aW9ucywgb3BlcmF0b3JMaXN0LCB0YXNrLCBzdGF0ZU1hbmFnZXIuc3RhdGUuY2xvbmUoKSk7CiAgICB9LAogICAgaGFuZGxlVGlsaW5nVHlwZTogZnVuY3Rpb24gaGFuZGxlVGlsaW5nVHlwZShmbiwgYXJncywgcmVzb3VyY2VzLCBwYXR0ZXJuLCBwYXR0ZXJuRGljdCwgb3BlcmF0b3JMaXN0LCB0YXNrKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIHRpbGluZ09wTGlzdCA9IG5ldyBfb3BlcmF0b3JfbGlzdC5PcGVyYXRvckxpc3QoKTsKICAgICAgdmFyIHJlc291cmNlc0FycmF5ID0gW3BhdHRlcm5EaWN0LmdldCgiUmVzb3VyY2VzIiksIHJlc291cmNlc107CgogICAgICB2YXIgcGF0dGVyblJlc291cmNlcyA9IF9wcmltaXRpdmVzLkRpY3QubWVyZ2UodGhpcy54cmVmLCByZXNvdXJjZXNBcnJheSk7CgogICAgICByZXR1cm4gdGhpcy5nZXRPcGVyYXRvckxpc3QoewogICAgICAgIHN0cmVhbTogcGF0dGVybiwKICAgICAgICB0YXNrOiB0YXNrLAogICAgICAgIHJlc291cmNlczogcGF0dGVyblJlc291cmNlcywKICAgICAgICBvcGVyYXRvckxpc3Q6IHRpbGluZ09wTGlzdAogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gKDAsIF9wYXR0ZXJuLmdldFRpbGluZ1BhdHRlcm5JUikoewogICAgICAgICAgZm5BcnJheTogdGlsaW5nT3BMaXN0LmZuQXJyYXksCiAgICAgICAgICBhcmdzQXJyYXk6IHRpbGluZ09wTGlzdC5hcmdzQXJyYXkKICAgICAgICB9LCBwYXR0ZXJuRGljdCwgYXJncyk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHRpbGluZ1BhdHRlcm5JUikgewogICAgICAgIG9wZXJhdG9yTGlzdC5hZGREZXBlbmRlbmNpZXModGlsaW5nT3BMaXN0LmRlcGVuZGVuY2llcyk7CiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKGZuLCB0aWxpbmdQYXR0ZXJuSVIpOwogICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgaWYgKHJlYXNvbiBpbnN0YW5jZW9mIF91dGlsLkFib3J0RXhjZXB0aW9uKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoX3RoaXM0Lm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICBfdGhpczQuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JUaWxpbmdQYXR0ZXJuCiAgICAgICAgICB9KTsKCiAgICAgICAgICAoMCwgX3V0aWwud2FybikoImhhbmRsZVRpbGluZ1R5cGUgLSBpZ25vcmluZyBwYXR0ZXJuOiBcIiIuY29uY2F0KHJlYXNvbiwgIlwiLiIpKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlU2V0Rm9udDogZnVuY3Rpb24gUGFydGlhbEV2YWx1YXRvcl9oYW5kbGVTZXRGb250KHJlc291cmNlcywgZm9udEFyZ3MsIGZvbnRSZWYsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGUpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB2YXIgZm9udE5hbWU7CgogICAgICBpZiAoZm9udEFyZ3MpIHsKICAgICAgICBmb250QXJncyA9IGZvbnRBcmdzLnNsaWNlKCk7CiAgICAgICAgZm9udE5hbWUgPSBmb250QXJnc1swXS5uYW1lOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5sb2FkRm9udChmb250TmFtZSwgZm9udFJlZiwgcmVzb3VyY2VzKS50aGVuKGZ1bmN0aW9uICh0cmFuc2xhdGVkKSB7CiAgICAgICAgaWYgKCF0cmFuc2xhdGVkLmZvbnQuaXNUeXBlM0ZvbnQpIHsKICAgICAgICAgIHJldHVybiB0cmFuc2xhdGVkOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZWQubG9hZFR5cGUzRGF0YShfdGhpczUsIHJlc291cmNlcywgb3BlcmF0b3JMaXN0LCB0YXNrKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiB0cmFuc2xhdGVkOwogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgIF90aGlzNS5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvckZvbnRMb2FkVHlwZTMKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRlZEZvbnQoewogICAgICAgICAgICBsb2FkZWROYW1lOiAiZ19mb250X2Vycm9yIiwKICAgICAgICAgICAgZm9udDogbmV3IF9mb250cy5FcnJvckZvbnQoIlR5cGUzIGZvbnQgbG9hZCBlcnJvcjogIi5jb25jYXQocmVhc29uKSksCiAgICAgICAgICAgIGRpY3Q6IHRyYW5zbGF0ZWQuZm9udCwKICAgICAgICAgICAgZXh0cmFQcm9wZXJ0aWVzOiBfdGhpczUub3B0aW9ucy5mb250RXh0cmFQcm9wZXJ0aWVzCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSkudGhlbihmdW5jdGlvbiAodHJhbnNsYXRlZCkgewogICAgICAgIHN0YXRlLmZvbnQgPSB0cmFuc2xhdGVkLmZvbnQ7CiAgICAgICAgdHJhbnNsYXRlZC5zZW5kKF90aGlzNS5oYW5kbGVyKTsKICAgICAgICByZXR1cm4gdHJhbnNsYXRlZC5sb2FkZWROYW1lOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVUZXh0OiBmdW5jdGlvbiBoYW5kbGVUZXh0KGNoYXJzLCBzdGF0ZSkgewogICAgICB2YXIgZm9udCA9IHN0YXRlLmZvbnQ7CiAgICAgIHZhciBnbHlwaHMgPSBmb250LmNoYXJzVG9HbHlwaHMoY2hhcnMpOwoKICAgICAgaWYgKGZvbnQuZGF0YSkgewogICAgICAgIHZhciBpc0FkZFRvUGF0aFNldCA9ICEhKHN0YXRlLnRleHRSZW5kZXJpbmdNb2RlICYgX3V0aWwuVGV4dFJlbmRlcmluZ01vZGUuQUREX1RPX1BBVEhfRkxBRyk7CgogICAgICAgIGlmIChpc0FkZFRvUGF0aFNldCB8fCBzdGF0ZS5maWxsQ29sb3JTcGFjZS5uYW1lID09PSAiUGF0dGVybiIgfHwgZm9udC5kaXNhYmxlRm9udEZhY2UgfHwgdGhpcy5vcHRpb25zLmRpc2FibGVGb250RmFjZSkgewogICAgICAgICAgUGFydGlhbEV2YWx1YXRvci5idWlsZEZvbnRQYXRocyhmb250LCBnbHlwaHMsIHRoaXMuaGFuZGxlcik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gZ2x5cGhzOwogICAgfSwKICAgIGVuc3VyZVN0YXRlRm9udDogZnVuY3Rpb24gZW5zdXJlU3RhdGVGb250KHN0YXRlKSB7CiAgICAgIGlmIChzdGF0ZS5mb250KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgcmVhc29uID0gbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNaXNzaW5nIHNldEZvbnQgKFRmKSBvcGVyYXRvciBiZWZvcmUgdGV4dCByZW5kZXJpbmcgb3BlcmF0b3IuIik7CgogICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgIHRoaXMuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yRm9udFN0YXRlCiAgICAgICAgfSk7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJlbnN1cmVTdGF0ZUZvbnQ6IFwiIi5jb25jYXQocmVhc29uLCAiXCIuIikpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhyb3cgcmVhc29uOwogICAgfSwKICAgIHNldEdTdGF0ZTogZnVuY3Rpb24gUGFydGlhbEV2YWx1YXRvcl9zZXRHU3RhdGUocmVzb3VyY2VzLCBnU3RhdGUsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGVNYW5hZ2VyKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdmFyIGdTdGF0ZU9iaiA9IFtdOwogICAgICB2YXIgZ1N0YXRlS2V5cyA9IGdTdGF0ZS5nZXRLZXlzKCk7CiAgICAgIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7CgogICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHsKICAgICAgICB2YXIga2V5ID0gZ1N0YXRlS2V5c1tpXTsKICAgICAgICB2YXIgdmFsdWUgPSBnU3RhdGUuZ2V0KGtleSk7CgogICAgICAgIHN3aXRjaCAoa2V5KSB7CiAgICAgICAgICBjYXNlICJUeXBlIjoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiTFciOgogICAgICAgICAgY2FzZSAiTEMiOgogICAgICAgICAgY2FzZSAiTEoiOgogICAgICAgICAgY2FzZSAiTUwiOgogICAgICAgICAgY2FzZSAiRCI6CiAgICAgICAgICBjYXNlICJSSSI6CiAgICAgICAgICBjYXNlICJGTCI6CiAgICAgICAgICBjYXNlICJDQSI6CiAgICAgICAgICBjYXNlICJjYSI6CiAgICAgICAgICAgIGdTdGF0ZU9iai5wdXNoKFtrZXksIHZhbHVlXSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIkZvbnQiOgogICAgICAgICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2LmhhbmRsZVNldEZvbnQocmVzb3VyY2VzLCBudWxsLCB2YWx1ZVswXSwgb3BlcmF0b3JMaXN0LCB0YXNrLCBzdGF0ZU1hbmFnZXIuc3RhdGUpLnRoZW4oZnVuY3Rpb24gKGxvYWRlZE5hbWUpIHsKICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGREZXBlbmRlbmN5KGxvYWRlZE5hbWUpOwogICAgICAgICAgICAgICAgZ1N0YXRlT2JqLnB1c2goW2tleSwgW2xvYWRlZE5hbWUsIHZhbHVlWzFdXV0pOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiQk0iOgogICAgICAgICAgICBnU3RhdGVPYmoucHVzaChba2V5LCBub3JtYWxpemVCbGVuZE1vZGUodmFsdWUpXSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIlNNYXNrIjoKICAgICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHZhbHVlLCAiTm9uZSIpKSB7CiAgICAgICAgICAgICAgZ1N0YXRlT2JqLnB1c2goW2tleSwgZmFsc2VdKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKHZhbHVlKSkgewogICAgICAgICAgICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5oYW5kbGVTTWFzayh2YWx1ZSwgcmVzb3VyY2VzLCBvcGVyYXRvckxpc3QsIHRhc2ssIHN0YXRlTWFuYWdlcik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgZ1N0YXRlT2JqLnB1c2goW2tleSwgdHJ1ZV0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVW5zdXBwb3J0ZWQgU01hc2sgdHlwZSIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJPUCI6CiAgICAgICAgICBjYXNlICJvcCI6CiAgICAgICAgICBjYXNlICJPUE0iOgogICAgICAgICAgY2FzZSAiQkciOgogICAgICAgICAgY2FzZSAiQkcyIjoKICAgICAgICAgIGNhc2UgIlVDUiI6CiAgICAgICAgICBjYXNlICJVQ1IyIjoKICAgICAgICAgIGNhc2UgIlRSIjoKICAgICAgICAgIGNhc2UgIlRSMiI6CiAgICAgICAgICBjYXNlICJIVCI6CiAgICAgICAgICBjYXNlICJTTSI6CiAgICAgICAgICBjYXNlICJTQSI6CiAgICAgICAgICBjYXNlICJBSVMiOgogICAgICAgICAgY2FzZSAiVEsiOgogICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoImdyYXBoaWMgc3RhdGUgb3BlcmF0b3IgIiArIGtleSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiVW5rbm93biBncmFwaGljIHN0YXRlIG9wZXJhdG9yICIgKyBrZXkpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH07CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBnU3RhdGVLZXlzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBfbG9vcCgpOwogICAgICB9CgogICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoZ1N0YXRlT2JqLmxlbmd0aCA+IDApIHsKICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0R1N0YXRlLCBbZ1N0YXRlT2JqXSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBsb2FkRm9udDogZnVuY3Rpb24gUGFydGlhbEV2YWx1YXRvcl9sb2FkRm9udChmb250TmFtZSwgZm9udCwgcmVzb3VyY2VzKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdmFyIGVycm9yRm9udCA9IGZ1bmN0aW9uIGVycm9yRm9udCgpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBUcmFuc2xhdGVkRm9udCh7CiAgICAgICAgICBsb2FkZWROYW1lOiAiZ19mb250X2Vycm9yIiwKICAgICAgICAgIGZvbnQ6IG5ldyBfZm9udHMuRXJyb3JGb250KCJGb250IFwiIi5jb25jYXQoZm9udE5hbWUsICJcIiBpcyBub3QgYXZhaWxhYmxlLiIpKSwKICAgICAgICAgIGRpY3Q6IGZvbnQsCiAgICAgICAgICBleHRyYVByb3BlcnRpZXM6IF90aGlzNy5vcHRpb25zLmZvbnRFeHRyYVByb3BlcnRpZXMKICAgICAgICB9KSk7CiAgICAgIH07CgogICAgICB2YXIgZm9udFJlZiwKICAgICAgICAgIHhyZWYgPSB0aGlzLnhyZWY7CgogICAgICBpZiAoZm9udCkgewogICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzUmVmKShmb250KSkgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCdUaGUgImZvbnQiIG9iamVjdCBzaG91bGQgYmUgYSByZWZlcmVuY2UuJyk7CiAgICAgICAgfQoKICAgICAgICBmb250UmVmID0gZm9udDsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgZm9udFJlcyA9IHJlc291cmNlcy5nZXQoIkZvbnQiKTsKCiAgICAgICAgaWYgKGZvbnRSZXMpIHsKICAgICAgICAgIGZvbnRSZWYgPSBmb250UmVzLmdldFJhdyhmb250TmFtZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWZvbnRSZWYpIHsKICAgICAgICB2YXIgcGFydGlhbE1zZyA9ICJGb250IFwiIi5jb25jYXQoZm9udE5hbWUgfHwgZm9udCAmJiBmb250LnRvU3RyaW5nKCksICJcIiBpcyBub3QgYXZhaWxhYmxlIik7CgogICAgICAgIGlmICghdGhpcy5vcHRpb25zLmlnbm9yZUVycm9ycyAmJiAhdGhpcy5wYXJzaW5nVHlwZTNGb250KSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIiIuY29uY2F0KHBhcnRpYWxNc2csICIuIikpOwogICAgICAgICAgcmV0dXJuIGVycm9yRm9udCgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250TWlzc2luZwogICAgICAgIH0pOwogICAgICAgICgwLCBfdXRpbC53YXJuKSgiIi5jb25jYXQocGFydGlhbE1zZywgIiAtLSBhdHRlbXB0aW5nIHRvIGZhbGxiYWNrIHRvIGEgZGVmYXVsdCBmb250LiIpKTsKICAgICAgICBmb250UmVmID0gUGFydGlhbEV2YWx1YXRvci5nZXRGYWxsYmFja0ZvbnREaWN0KCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmZvbnRDYWNoZS5oYXMoZm9udFJlZikpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb250Q2FjaGUuZ2V0KGZvbnRSZWYpOwogICAgICB9CgogICAgICBmb250ID0geHJlZi5mZXRjaElmUmVmKGZvbnRSZWYpOwoKICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShmb250KSkgewogICAgICAgIHJldHVybiBlcnJvckZvbnQoKTsKICAgICAgfQoKICAgICAgaWYgKGZvbnQudHJhbnNsYXRlZCkgewogICAgICAgIHJldHVybiBmb250LnRyYW5zbGF0ZWQ7CiAgICAgIH0KCiAgICAgIHZhciBmb250Q2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICAgICAgdmFyIHByZUV2YWx1YXRlZEZvbnQgPSB0aGlzLnByZUV2YWx1YXRlRm9udChmb250KTsKICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcmVFdmFsdWF0ZWRGb250LmRlc2NyaXB0b3IsCiAgICAgICAgICBoYXNoID0gcHJlRXZhbHVhdGVkRm9udC5oYXNoOwogICAgICB2YXIgZm9udFJlZklzUmVmID0gKDAsIF9wcmltaXRpdmVzLmlzUmVmKShmb250UmVmKSwKICAgICAgICAgIGZvbnRJRDsKCiAgICAgIGlmIChmb250UmVmSXNSZWYpIHsKICAgICAgICBmb250SUQgPSBmb250UmVmLnRvU3RyaW5nKCk7CiAgICAgIH0KCiAgICAgIGlmIChoYXNoICYmICgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGRlc2NyaXB0b3IpKSB7CiAgICAgICAgaWYgKCFkZXNjcmlwdG9yLmZvbnRBbGlhc2VzKSB7CiAgICAgICAgICBkZXNjcmlwdG9yLmZvbnRBbGlhc2VzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgICB9CgogICAgICAgIHZhciBmb250QWxpYXNlcyA9IGRlc2NyaXB0b3IuZm9udEFsaWFzZXM7CgogICAgICAgIGlmIChmb250QWxpYXNlc1toYXNoXSkgewogICAgICAgICAgdmFyIGFsaWFzRm9udFJlZiA9IGZvbnRBbGlhc2VzW2hhc2hdLmFsaWFzUmVmOwoKICAgICAgICAgIGlmIChmb250UmVmSXNSZWYgJiYgYWxpYXNGb250UmVmICYmIHRoaXMuZm9udENhY2hlLmhhcyhhbGlhc0ZvbnRSZWYpKSB7CiAgICAgICAgICAgIHRoaXMuZm9udENhY2hlLnB1dEFsaWFzKGZvbnRSZWYsIGFsaWFzRm9udFJlZik7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvbnRDYWNoZS5nZXQoZm9udFJlZik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvbnRBbGlhc2VzW2hhc2hdID0gewogICAgICAgICAgICBmb250SUQ6IF9mb250cy5Gb250LmdldEZvbnRJRCgpCiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgaWYgKGZvbnRSZWZJc1JlZikgewogICAgICAgICAgZm9udEFsaWFzZXNbaGFzaF0uYWxpYXNSZWYgPSBmb250UmVmOwogICAgICAgIH0KCiAgICAgICAgZm9udElEID0gZm9udEFsaWFzZXNbaGFzaF0uZm9udElEOwogICAgICB9CgogICAgICBpZiAoZm9udFJlZklzUmVmKSB7CiAgICAgICAgdGhpcy5mb250Q2FjaGUucHV0KGZvbnRSZWYsIGZvbnRDYXBhYmlsaXR5LnByb21pc2UpOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICghZm9udElEKSB7CiAgICAgICAgICBmb250SUQgPSB0aGlzLmlkRmFjdG9yeS5jcmVhdGVPYmpJZCgpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5mb250Q2FjaGUucHV0KCJpZF8iLmNvbmNhdChmb250SUQpLCBmb250Q2FwYWJpbGl0eS5wcm9taXNlKTsKICAgICAgfQoKICAgICAgKDAsIF91dGlsLmFzc2VydCkoZm9udElELCAnVGhlICJmb250SUQiIG11c3QgYmUgZGVmaW5lZC4nKTsKICAgICAgZm9udC5sb2FkZWROYW1lID0gIiIuY29uY2F0KHRoaXMuaWRGYWN0b3J5LmdldERvY0lkKCksICJfZiIpLmNvbmNhdChmb250SUQpOwogICAgICBmb250LnRyYW5zbGF0ZWQgPSBmb250Q2FwYWJpbGl0eS5wcm9taXNlOwogICAgICB2YXIgdHJhbnNsYXRlZFByb21pc2U7CgogICAgICB0cnkgewogICAgICAgIHRyYW5zbGF0ZWRQcm9taXNlID0gdGhpcy50cmFuc2xhdGVGb250KHByZUV2YWx1YXRlZEZvbnQpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdHJhbnNsYXRlZFByb21pc2UgPSBQcm9taXNlLnJlamVjdChlKTsKICAgICAgfQoKICAgICAgdHJhbnNsYXRlZFByb21pc2UudGhlbihmdW5jdGlvbiAodHJhbnNsYXRlZEZvbnQpIHsKICAgICAgICBpZiAodHJhbnNsYXRlZEZvbnQuZm9udFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdmFyIHhyZWZGb250U3RhdHMgPSB4cmVmLnN0YXRzLmZvbnRUeXBlczsKICAgICAgICAgIHhyZWZGb250U3RhdHNbdHJhbnNsYXRlZEZvbnQuZm9udFR5cGVdID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGZvbnRDYXBhYmlsaXR5LnJlc29sdmUobmV3IFRyYW5zbGF0ZWRGb250KHsKICAgICAgICAgIGxvYWRlZE5hbWU6IGZvbnQubG9hZGVkTmFtZSwKICAgICAgICAgIGZvbnQ6IHRyYW5zbGF0ZWRGb250LAogICAgICAgICAgZGljdDogZm9udCwKICAgICAgICAgIGV4dHJhUHJvcGVydGllczogX3RoaXM3Lm9wdGlvbnMuZm9udEV4dHJhUHJvcGVydGllcwogICAgICAgIH0pKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgIF90aGlzNy5oYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250VHJhbnNsYXRlCiAgICAgICAgfSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICB2YXIgZm9udEZpbGUzID0gZGVzY3JpcHRvciAmJiBkZXNjcmlwdG9yLmdldCgiRm9udEZpbGUzIik7CiAgICAgICAgICB2YXIgc3VidHlwZSA9IGZvbnRGaWxlMyAmJiBmb250RmlsZTMuZ2V0KCJTdWJ0eXBlIik7CiAgICAgICAgICB2YXIgZm9udFR5cGUgPSAoMCwgX2ZvbnRzLmdldEZvbnRUeXBlKShwcmVFdmFsdWF0ZWRGb250LnR5cGUsIHN1YnR5cGUgJiYgc3VidHlwZS5uYW1lKTsKICAgICAgICAgIHZhciB4cmVmRm9udFN0YXRzID0geHJlZi5zdGF0cy5mb250VHlwZXM7CiAgICAgICAgICB4cmVmRm9udFN0YXRzW2ZvbnRUeXBlXSA9IHRydWU7CiAgICAgICAgfSBjYXRjaCAoZXgpIHt9CgogICAgICAgIGZvbnRDYXBhYmlsaXR5LnJlc29sdmUobmV3IFRyYW5zbGF0ZWRGb250KHsKICAgICAgICAgIGxvYWRlZE5hbWU6IGZvbnQubG9hZGVkTmFtZSwKICAgICAgICAgIGZvbnQ6IG5ldyBfZm9udHMuRXJyb3JGb250KHJlYXNvbiBpbnN0YW5jZW9mIEVycm9yID8gcmVhc29uLm1lc3NhZ2UgOiByZWFzb24pLAogICAgICAgICAgZGljdDogZm9udCwKICAgICAgICAgIGV4dHJhUHJvcGVydGllczogX3RoaXM3Lm9wdGlvbnMuZm9udEV4dHJhUHJvcGVydGllcwogICAgICAgIH0pKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBmb250Q2FwYWJpbGl0eS5wcm9taXNlOwogICAgfSwKICAgIGJ1aWxkUGF0aDogZnVuY3Rpb24gYnVpbGRQYXRoKG9wZXJhdG9yTGlzdCwgZm4sIGFyZ3MpIHsKICAgICAgdmFyIHBhcnNpbmdUZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKICAgICAgdmFyIGxhc3RJbmRleCA9IG9wZXJhdG9yTGlzdC5sZW5ndGggLSAxOwoKICAgICAgaWYgKCFhcmdzKSB7CiAgICAgICAgYXJncyA9IFtdOwogICAgICB9CgogICAgICBpZiAobGFzdEluZGV4IDwgMCB8fCBvcGVyYXRvckxpc3QuZm5BcnJheVtsYXN0SW5kZXhdICE9PSBfdXRpbC5PUFMuY29uc3RydWN0UGF0aCkgewogICAgICAgIGlmIChwYXJzaW5nVGV4dCkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJFbmNvdW50ZXJlZCBwYXRoIG9wZXJhdG9yIFwiIi5jb25jYXQoZm4sICJcIiBpbnNpZGUgb2YgYSB0ZXh0IG9iamVjdC4iKSk7CiAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnNhdmUsIG51bGwpOwogICAgICAgIH0KCiAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF91dGlsLk9QUy5jb25zdHJ1Y3RQYXRoLCBbW2ZuXSwgYXJnc10pOwoKICAgICAgICBpZiAocGFyc2luZ1RleHQpIHsKICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMucmVzdG9yZSwgbnVsbCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBvcEFyZ3MgPSBvcGVyYXRvckxpc3QuYXJnc0FycmF5W2xhc3RJbmRleF07CiAgICAgICAgb3BBcmdzWzBdLnB1c2goZm4pOwogICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KG9wQXJnc1sxXSwgYXJncyk7CiAgICAgIH0KICAgIH0sCiAgICBwYXJzZUNvbG9yU3BhY2U6IGZ1bmN0aW9uIHBhcnNlQ29sb3JTcGFjZShfcmVmNSkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHZhciBjcyA9IF9yZWY1LmNzLAogICAgICAgICAgcmVzb3VyY2VzID0gX3JlZjUucmVzb3VyY2VzOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICByZXNvbHZlKF9jb2xvcnNwYWNlLkNvbG9yU3BhY2UucGFyc2UoY3MsIF90aGlzOC54cmVmLCByZXNvdXJjZXMsIF90aGlzOC5wZGZGdW5jdGlvbkZhY3RvcnkpKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfdXRpbC5BYm9ydEV4Y2VwdGlvbikgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAoX3RoaXM4Lm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICBfdGhpczguaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JDb2xvclNwYWNlCiAgICAgICAgICB9KTsKCiAgICAgICAgICAoMCwgX3V0aWwud2FybikoInBhcnNlQ29sb3JTcGFjZSAtIGlnbm9yaW5nIENvbG9yU3BhY2U6IFwiIi5jb25jYXQocmVhc29uLCAiXCIuIikpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICB0aHJvdyByZWFzb247CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZUNvbG9yTjogZnVuY3Rpb24gaGFuZGxlQ29sb3JOKG9wZXJhdG9yTGlzdCwgZm4sIGFyZ3MsIGNzLCBwYXR0ZXJucywgcmVzb3VyY2VzLCB0YXNrKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICB2YXIgcGF0dGVybk5hbWUsIHBhdHRlcm4sIGRpY3QsIHR5cGVOdW0sIGNvbG9yLCBzaGFkaW5nLCBtYXRyaXg7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclsiZGVmYXVsdCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcGF0dGVybk5hbWUgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07CgogICAgICAgICAgICAgICAgaWYgKCEoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkocGF0dGVybk5hbWUpICYmIChwYXR0ZXJuID0gcGF0dGVybnMuZ2V0KHBhdHRlcm5OYW1lLm5hbWUpKSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZGljdCA9ICgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkocGF0dGVybikgPyBwYXR0ZXJuLmRpY3QgOiBwYXR0ZXJuOwogICAgICAgICAgICAgICAgdHlwZU51bSA9IGRpY3QuZ2V0KCJQYXR0ZXJuVHlwZSIpOwoKICAgICAgICAgICAgICAgIGlmICghKHR5cGVOdW0gPT09IFRJTElOR19QQVRURVJOKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbG9yID0gY3MuYmFzZSA/IGNzLmJhc2UuZ2V0UmdiKGFyZ3MsIDApIDogbnVsbDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBfdGhpczkuaGFuZGxlVGlsaW5nVHlwZShmbiwgY29sb3IsIHJlc291cmNlcywgcGF0dGVybiwgZGljdCwgb3BlcmF0b3JMaXN0LCB0YXNrKSk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIGlmICghKHR5cGVOdW0gPT09IFNIQURJTkdfUEFUVEVSTikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgc2hhZGluZyA9IGRpY3QuZ2V0KCJTaGFkaW5nIik7CiAgICAgICAgICAgICAgICBtYXRyaXggPSBkaWN0LmdldEFycmF5KCJNYXRyaXgiKTsKICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBfcGF0dGVybi5QYXR0ZXJuLnBhcnNlU2hhZGluZyhzaGFkaW5nLCBtYXRyaXgsIF90aGlzOS54cmVmLCByZXNvdXJjZXMsIF90aGlzOS5oYW5kbGVyLCBfdGhpczkucGRmRnVuY3Rpb25GYWN0b3J5KTsKICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChmbiwgcGF0dGVybi5nZXRJUigpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCB1bmRlZmluZWQpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIFBhdHRlcm5UeXBlOiAiLmNvbmNhdCh0eXBlTnVtKSk7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gUGF0dGVybk5hbWU6ICIuY29uY2F0KHBhdHRlcm5OYW1lKSk7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBnZXRPcGVyYXRvckxpc3Q6IGZ1bmN0aW9uIGdldE9wZXJhdG9yTGlzdChfcmVmNikgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICB2YXIgc3RyZWFtID0gX3JlZjYuc3RyZWFtLAogICAgICAgICAgdGFzayA9IF9yZWY2LnRhc2ssCiAgICAgICAgICByZXNvdXJjZXMgPSBfcmVmNi5yZXNvdXJjZXMsCiAgICAgICAgICBvcGVyYXRvckxpc3QgPSBfcmVmNi5vcGVyYXRvckxpc3QsCiAgICAgICAgICBfcmVmNiRpbml0aWFsU3RhdGUgPSBfcmVmNi5pbml0aWFsU3RhdGUsCiAgICAgICAgICBpbml0aWFsU3RhdGUgPSBfcmVmNiRpbml0aWFsU3RhdGUgPT09IHZvaWQgMCA/IG51bGwgOiBfcmVmNiRpbml0aWFsU3RhdGU7CiAgICAgIHJlc291cmNlcyA9IHJlc291cmNlcyB8fCBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5OwogICAgICBpbml0aWFsU3RhdGUgPSBpbml0aWFsU3RhdGUgfHwgbmV3IEV2YWxTdGF0ZSgpOwoKICAgICAgaWYgKCFvcGVyYXRvckxpc3QpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2dldE9wZXJhdG9yTGlzdDogbWlzc2luZyAib3BlcmF0b3JMaXN0IiBwYXJhbWV0ZXInKTsKICAgICAgfQoKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgeHJlZiA9IHRoaXMueHJlZjsKICAgICAgdmFyIHBhcnNpbmdUZXh0ID0gZmFsc2U7CiAgICAgIHZhciBsb2NhbEltYWdlQ2FjaGUgPSBuZXcgX2ltYWdlX3V0aWxzLkxvY2FsSW1hZ2VDYWNoZSgpOwoKICAgICAgdmFyIHhvYmpzID0gcmVzb3VyY2VzLmdldCgiWE9iamVjdCIpIHx8IF9wcmltaXRpdmVzLkRpY3QuZW1wdHk7CgogICAgICB2YXIgcGF0dGVybnMgPSByZXNvdXJjZXMuZ2V0KCJQYXR0ZXJuIikgfHwgX3ByaW1pdGl2ZXMuRGljdC5lbXB0eTsKCiAgICAgIHZhciBzdGF0ZU1hbmFnZXIgPSBuZXcgU3RhdGVNYW5hZ2VyKGluaXRpYWxTdGF0ZSk7CiAgICAgIHZhciBwcmVwcm9jZXNzb3IgPSBuZXcgRXZhbHVhdG9yUHJlcHJvY2Vzc29yKHN0cmVhbSwgeHJlZiwgc3RhdGVNYW5hZ2VyKTsKICAgICAgdmFyIHRpbWVTbG90TWFuYWdlciA9IG5ldyBUaW1lU2xvdE1hbmFnZXIoKTsKCiAgICAgIGZ1bmN0aW9uIGNsb3NlUGVuZGluZ1Jlc3RvcmVPUFMoYXJndW1lbnQpIHsKICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBwcmVwcm9jZXNzb3Iuc2F2ZWRTdGF0ZXNEZXB0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMucmVzdG9yZSwgW10pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIHByb21pc2VCb2R5KHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciBuZXh0ID0gZnVuY3Rpb24gbmV4dChwcm9taXNlKSB7CiAgICAgICAgICBQcm9taXNlLmFsbChbcHJvbWlzZSwgb3BlcmF0b3JMaXN0LnJlYWR5XSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgcHJvbWlzZUJvZHkocmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgICByZWplY3QoZXgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCByZWplY3QpOwogICAgICAgIH07CgogICAgICAgIHRhc2suZW5zdXJlTm90VGVybWluYXRlZCgpOwogICAgICAgIHRpbWVTbG90TWFuYWdlci5yZXNldCgpOwogICAgICAgIHZhciBzdG9wLAogICAgICAgICAgICBvcGVyYXRpb24gPSB7fSwKICAgICAgICAgICAgaSwKICAgICAgICAgICAgaWksCiAgICAgICAgICAgIGNzOwoKICAgICAgICB3aGlsZSAoIShzdG9wID0gdGltZVNsb3RNYW5hZ2VyLmNoZWNrKCkpKSB7CiAgICAgICAgICBvcGVyYXRpb24uYXJncyA9IG51bGw7CgogICAgICAgICAgaWYgKCFwcmVwcm9jZXNzb3IucmVhZChvcGVyYXRpb24pKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBhcmdzID0gb3BlcmF0aW9uLmFyZ3M7CiAgICAgICAgICB2YXIgZm4gPSBvcGVyYXRpb24uZm47CgogICAgICAgICAgc3dpdGNoIChmbiB8IDApIHsKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRYT2JqZWN0OgogICAgICAgICAgICAgIHZhciBuYW1lID0gYXJnc1swXS5uYW1lOwoKICAgICAgICAgICAgICBpZiAobmFtZSkgewogICAgICAgICAgICAgICAgdmFyIGxvY2FsSW1hZ2UgPSBsb2NhbEltYWdlQ2FjaGUuZ2V0QnlOYW1lKG5hbWUpOwoKICAgICAgICAgICAgICAgIGlmIChsb2NhbEltYWdlKSB7CiAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChsb2NhbEltYWdlLmZuLCBsb2NhbEltYWdlLmFyZ3MpOwogICAgICAgICAgICAgICAgICBhcmdzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBuZXh0KG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlWE9iamVjdCwgcmVqZWN0WE9iamVjdCkgewogICAgICAgICAgICAgICAgaWYgKCFuYW1lKSB7CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiWE9iamVjdCBtdXN0IGJlIHJlZmVycmVkIHRvIGJ5IG5hbWUuIik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFyIHhvYmogPSB4b2Jqcy5nZXRSYXcobmFtZSk7CgogICAgICAgICAgICAgICAgaWYgKHhvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5SZWYpIHsKICAgICAgICAgICAgICAgICAgdmFyIF9sb2NhbEltYWdlID0gbG9jYWxJbWFnZUNhY2hlLmdldEJ5UmVmKHhvYmopOwoKICAgICAgICAgICAgICAgICAgaWYgKF9sb2NhbEltYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKF9sb2NhbEltYWdlLmZuLCBfbG9jYWxJbWFnZS5hcmdzKTsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbEltYWdlID0gc2VsZi5nbG9iYWxJbWFnZUNhY2hlLmdldERhdGEoeG9iaiwgc2VsZi5wYWdlSW5kZXgpOwoKICAgICAgICAgICAgICAgICAgaWYgKGdsb2JhbEltYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZERlcGVuZGVuY3koZ2xvYmFsSW1hZ2Uub2JqSWQpOwogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChnbG9iYWxJbWFnZS5mbiwgZ2xvYmFsSW1hZ2UuYXJncyk7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHhvYmogPSB4cmVmLmZldGNoKHhvYmopOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICgheG9iaikgewogICAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoZm4sIGFyZ3MpOwogICAgICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKHhvYmopKSB7CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiWE9iamVjdCBzaG91bGQgYmUgYSBzdHJlYW0iKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IHhvYmouZGljdC5nZXQoIlN1YnR5cGUiKTsKCiAgICAgICAgICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHR5cGUpKSB7CiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiWE9iamVjdCBzaG91bGQgaGF2ZSBhIE5hbWUgc3VidHlwZSIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0eXBlLm5hbWUgPT09ICJGb3JtIikgewogICAgICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc2F2ZSgpOwogICAgICAgICAgICAgICAgICBzZWxmLmJ1aWxkRm9ybVhPYmplY3QocmVzb3VyY2VzLCB4b2JqLCBudWxsLCBvcGVyYXRvckxpc3QsIHRhc2ssIHN0YXRlTWFuYWdlci5zdGF0ZS5jbG9uZSgpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIucmVzdG9yZSgpOwogICAgICAgICAgICAgICAgICAgIHJlc29sdmVYT2JqZWN0KCk7CiAgICAgICAgICAgICAgICAgIH0sIHJlamVjdFhPYmplY3QpOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUubmFtZSA9PT0gIkltYWdlIikgewogICAgICAgICAgICAgICAgICBzZWxmLmJ1aWxkUGFpbnRJbWFnZVhPYmplY3QoewogICAgICAgICAgICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzLAogICAgICAgICAgICAgICAgICAgIGltYWdlOiB4b2JqLAogICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdDogb3BlcmF0b3JMaXN0LAogICAgICAgICAgICAgICAgICAgIGNhY2hlS2V5OiBuYW1lLAogICAgICAgICAgICAgICAgICAgIGxvY2FsSW1hZ2VDYWNoZTogbG9jYWxJbWFnZUNhY2hlCiAgICAgICAgICAgICAgICAgIH0pLnRoZW4ocmVzb2x2ZVhPYmplY3QsIHJlamVjdFhPYmplY3QpOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUubmFtZSA9PT0gIlBTIikgewogICAgICAgICAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoIklnbm9yZWQgWE9iamVjdCBzdWJ0eXBlIFBTIik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVuaGFuZGxlZCBYT2JqZWN0IHN1YnR5cGUgIi5jb25jYXQodHlwZS5uYW1lKSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgICAgICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX3V0aWwuQWJvcnRFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYuaGFuZGxlci5zZW5kKCJVbnN1cHBvcnRlZEZlYXR1cmUiLCB7CiAgICAgICAgICAgICAgICAgICAgZmVhdHVyZUlkOiBfdXRpbC5VTlNVUFBPUlRFRF9GRUFUVVJFUy5lcnJvclhPYmplY3QKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiZ2V0T3BlcmF0b3JMaXN0IC0gaWdub3JpbmcgWE9iamVjdDogXCIiLmNvbmNhdChyZWFzb24sICJcIi4iKSk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aHJvdyByZWFzb247CiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZvbnQ6CiAgICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gYXJnc1sxXTsKICAgICAgICAgICAgICBuZXh0KHNlbGYuaGFuZGxlU2V0Rm9udChyZXNvdXJjZXMsIGFyZ3MsIG51bGwsIG9wZXJhdG9yTGlzdCwgdGFzaywgc3RhdGVNYW5hZ2VyLnN0YXRlKS50aGVuKGZ1bmN0aW9uIChsb2FkZWROYW1lKSB7CiAgICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkRGVwZW5kZW5jeShsb2FkZWROYW1lKTsKICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0Rm9udCwgW2xvYWRlZE5hbWUsIGZvbnRTaXplXSk7CiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmJlZ2luVGV4dDoKICAgICAgICAgICAgICBwYXJzaW5nVGV4dCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5lbmRUZXh0OgogICAgICAgICAgICAgIHBhcnNpbmdUZXh0ID0gZmFsc2U7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5lbmRJbmxpbmVJbWFnZToKICAgICAgICAgICAgICB2YXIgY2FjaGVLZXkgPSBhcmdzWzBdLmNhY2hlS2V5OwoKICAgICAgICAgICAgICBpZiAoY2FjaGVLZXkpIHsKICAgICAgICAgICAgICAgIHZhciBfbG9jYWxJbWFnZTIgPSBsb2NhbEltYWdlQ2FjaGUuZ2V0QnlOYW1lKGNhY2hlS2V5KTsKCiAgICAgICAgICAgICAgICBpZiAoX2xvY2FsSW1hZ2UyKSB7CiAgICAgICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfbG9jYWxJbWFnZTIuZm4sIF9sb2NhbEltYWdlMi5hcmdzKTsKICAgICAgICAgICAgICAgICAgYXJncyA9IG51bGw7CiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbmV4dChzZWxmLmJ1aWxkUGFpbnRJbWFnZVhPYmplY3QoewogICAgICAgICAgICAgICAgcmVzb3VyY2VzOiByZXNvdXJjZXMsCiAgICAgICAgICAgICAgICBpbWFnZTogYXJnc1swXSwKICAgICAgICAgICAgICAgIGlzSW5saW5lOiB0cnVlLAogICAgICAgICAgICAgICAgb3BlcmF0b3JMaXN0OiBvcGVyYXRvckxpc3QsCiAgICAgICAgICAgICAgICBjYWNoZUtleTogY2FjaGVLZXksCiAgICAgICAgICAgICAgICBsb2NhbEltYWdlQ2FjaGU6IGxvY2FsSW1hZ2VDYWNoZQogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaG93VGV4dDoKICAgICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBhcmdzWzBdID0gc2VsZi5oYW5kbGVUZXh0KGFyZ3NbMF0sIHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaG93U3BhY2VkVGV4dDoKICAgICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgYXJyID0gYXJnc1swXTsKICAgICAgICAgICAgICB2YXIgY29tYmluZWRHbHlwaHMgPSBbXTsKICAgICAgICAgICAgICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aDsKICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBzdGF0ZU1hbmFnZXIuc3RhdGU7CgogICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcnJMZW5ndGg7ICsraSkgewogICAgICAgICAgICAgICAgdmFyIGFyckl0ZW0gPSBhcnJbaV07CgogICAgICAgICAgICAgICAgaWYgKCgwLCBfdXRpbC5pc1N0cmluZykoYXJySXRlbSkpIHsKICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoY29tYmluZWRHbHlwaHMsIHNlbGYuaGFuZGxlVGV4dChhcnJJdGVtLCBzdGF0ZSkpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoMCwgX3V0aWwuaXNOdW0pKGFyckl0ZW0pKSB7CiAgICAgICAgICAgICAgICAgIGNvbWJpbmVkR2x5cGhzLnB1c2goYXJySXRlbSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBhcmdzWzBdID0gY29tYmluZWRHbHlwaHM7CiAgICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2hvd1RleHQ7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5uZXh0TGluZVNob3dUZXh0OgogICAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICAgIHNlbGYuZW5zdXJlU3RhdGVGb250KHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMubmV4dExpbmUpOwogICAgICAgICAgICAgIGFyZ3NbMF0gPSBzZWxmLmhhbmRsZVRleHQoYXJnc1swXSwgc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgICBmbiA9IF91dGlsLk9QUy5zaG93VGV4dDsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lU2V0U3BhY2luZ1Nob3dUZXh0OgogICAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICAgIHNlbGYuZW5zdXJlU3RhdGVGb250KHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMubmV4dExpbmUpOwogICAgICAgICAgICAgIG9wZXJhdG9yTGlzdC5hZGRPcChfdXRpbC5PUFMuc2V0V29yZFNwYWNpbmcsIFthcmdzLnNoaWZ0KCldKTsKICAgICAgICAgICAgICBvcGVyYXRvckxpc3QuYWRkT3AoX3V0aWwuT1BTLnNldENoYXJTcGFjaW5nLCBbYXJncy5zaGlmdCgpXSk7CiAgICAgICAgICAgICAgYXJnc1swXSA9IHNlbGYuaGFuZGxlVGV4dChhcmdzWzBdLCBzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNob3dUZXh0OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0VGV4dFJlbmRlcmluZ01vZGU6CiAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLnRleHRSZW5kZXJpbmdNb2RlID0gYXJnc1swXTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEZpbGxDb2xvclNwYWNlOgogICAgICAgICAgICAgIG5leHQoc2VsZi5wYXJzZUNvbG9yU3BhY2UoewogICAgICAgICAgICAgICAgY3M6IGFyZ3NbMF0sCiAgICAgICAgICAgICAgICByZXNvdXJjZXM6IHJlc291cmNlcwogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvbG9yU3BhY2UpIHsKICAgICAgICAgICAgICAgIGlmIChjb2xvclNwYWNlKSB7CiAgICAgICAgICAgICAgICAgIHN0YXRlTWFuYWdlci5zdGF0ZS5maWxsQ29sb3JTcGFjZSA9IGNvbG9yU3BhY2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFN0cm9rZUNvbG9yU3BhY2U6CiAgICAgICAgICAgICAgbmV4dChzZWxmLnBhcnNlQ29sb3JTcGFjZSh7CiAgICAgICAgICAgICAgICBjczogYXJnc1swXSwKICAgICAgICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VzCiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoY29sb3JTcGFjZSkgewogICAgICAgICAgICAgICAgaWYgKGNvbG9yU3BhY2UpIHsKICAgICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLnN0cm9rZUNvbG9yU3BhY2UgPSBjb2xvclNwYWNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsQ29sb3I6CiAgICAgICAgICAgICAgY3MgPSBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2U7CiAgICAgICAgICAgICAgYXJncyA9IGNzLmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgICBmbiA9IF91dGlsLk9QUy5zZXRGaWxsUkdCQ29sb3I7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VDb2xvcjoKICAgICAgICAgICAgICBjcyA9IHN0YXRlTWFuYWdlci5zdGF0ZS5zdHJva2VDb2xvclNwYWNlOwogICAgICAgICAgICAgIGFyZ3MgPSBjcy5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2V0U3Ryb2tlUkdCQ29sb3I7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsR3JheToKICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuZ3JheTsKICAgICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXkuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldEZpbGxSR0JDb2xvcjsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFN0cm9rZUdyYXk6CiAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLnN0cm9rZUNvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuZ3JheTsKICAgICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXkuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldFN0cm9rZVJHQkNvbG9yOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENNWUtDb2xvcjoKICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuZmlsbENvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuY215azsKICAgICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmNteWsuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldEZpbGxSR0JDb2xvcjsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFN0cm9rZUNNWUtDb2xvcjoKICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5jbXlrOwogICAgICAgICAgICAgIGFyZ3MgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnNpbmdsZXRvbnMuY215ay5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgICAgZm4gPSBfdXRpbC5PUFMuc2V0U3Ryb2tlUkdCQ29sb3I7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRGaWxsUkdCQ29sb3I6CiAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyLnN0YXRlLmZpbGxDb2xvclNwYWNlID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLnJnYjsKICAgICAgICAgICAgICBhcmdzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLnJnYi5nZXRSZ2IoYXJncywgMCk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VSR0JDb2xvcjoKICAgICAgICAgICAgICBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5yZ2I7CiAgICAgICAgICAgICAgYXJncyA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5yZ2IuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0RmlsbENvbG9yTjoKICAgICAgICAgICAgICBjcyA9IHN0YXRlTWFuYWdlci5zdGF0ZS5maWxsQ29sb3JTcGFjZTsKCiAgICAgICAgICAgICAgaWYgKGNzLm5hbWUgPT09ICJQYXR0ZXJuIikgewogICAgICAgICAgICAgICAgbmV4dChzZWxmLmhhbmRsZUNvbG9yTihvcGVyYXRvckxpc3QsIF91dGlsLk9QUy5zZXRGaWxsQ29sb3JOLCBhcmdzLCBjcywgcGF0dGVybnMsIHJlc291cmNlcywgdGFzaykpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYXJncyA9IGNzLmdldFJnYihhcmdzLCAwKTsKICAgICAgICAgICAgICBmbiA9IF91dGlsLk9QUy5zZXRGaWxsUkdCQ29sb3I7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRTdHJva2VDb2xvck46CiAgICAgICAgICAgICAgY3MgPSBzdGF0ZU1hbmFnZXIuc3RhdGUuc3Ryb2tlQ29sb3JTcGFjZTsKCiAgICAgICAgICAgICAgaWYgKGNzLm5hbWUgPT09ICJQYXR0ZXJuIikgewogICAgICAgICAgICAgICAgbmV4dChzZWxmLmhhbmRsZUNvbG9yTihvcGVyYXRvckxpc3QsIF91dGlsLk9QUy5zZXRTdHJva2VDb2xvck4sIGFyZ3MsIGNzLCBwYXR0ZXJucywgcmVzb3VyY2VzLCB0YXNrKSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBhcmdzID0gY3MuZ2V0UmdiKGFyZ3MsIDApOwogICAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNldFN0cm9rZVJHQkNvbG9yOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2hhZGluZ0ZpbGw6CiAgICAgICAgICAgICAgdmFyIHNoYWRpbmdSZXMgPSByZXNvdXJjZXMuZ2V0KCJTaGFkaW5nIik7CgogICAgICAgICAgICAgIGlmICghc2hhZGluZ1JlcykgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJObyBzaGFkaW5nIHJlc291cmNlIGZvdW5kIik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgc2hhZGluZyA9IHNoYWRpbmdSZXMuZ2V0KGFyZ3NbMF0ubmFtZSk7CgogICAgICAgICAgICAgIGlmICghc2hhZGluZykgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJObyBzaGFkaW5nIG9iamVjdCBmb3VuZCIpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIHNoYWRpbmdGaWxsID0gX3BhdHRlcm4uUGF0dGVybi5wYXJzZVNoYWRpbmcoc2hhZGluZywgbnVsbCwgeHJlZiwgcmVzb3VyY2VzLCBzZWxmLmhhbmRsZXIsIHNlbGYucGRmRnVuY3Rpb25GYWN0b3J5KTsKCiAgICAgICAgICAgICAgdmFyIHBhdHRlcm5JUiA9IHNoYWRpbmdGaWxsLmdldElSKCk7CiAgICAgICAgICAgICAgYXJncyA9IFtwYXR0ZXJuSVJdOwogICAgICAgICAgICAgIGZuID0gX3V0aWwuT1BTLnNoYWRpbmdGaWxsOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0R1N0YXRlOgogICAgICAgICAgICAgIHZhciBkaWN0TmFtZSA9IGFyZ3NbMF07CiAgICAgICAgICAgICAgdmFyIGV4dEdTdGF0ZSA9IHJlc291cmNlcy5nZXQoIkV4dEdTdGF0ZSIpOwoKICAgICAgICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGV4dEdTdGF0ZSkgfHwgIWV4dEdTdGF0ZS5oYXMoZGljdE5hbWUubmFtZSkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIGdTdGF0ZSA9IGV4dEdTdGF0ZS5nZXQoZGljdE5hbWUubmFtZSk7CiAgICAgICAgICAgICAgbmV4dChzZWxmLnNldEdTdGF0ZShyZXNvdXJjZXMsIGdTdGF0ZSwgb3BlcmF0b3JMaXN0LCB0YXNrLCBzdGF0ZU1hbmFnZXIpKTsKICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5tb3ZlVG86CiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmxpbmVUbzoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuY3VydmVUbzoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuY3VydmVUbzI6CiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmN1cnZlVG8zOgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5jbG9zZVBhdGg6CiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnJlY3RhbmdsZToKICAgICAgICAgICAgICBzZWxmLmJ1aWxkUGF0aChvcGVyYXRvckxpc3QsIGZuLCBhcmdzLCBwYXJzaW5nVGV4dCk7CiAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5tYXJrUG9pbnQ6CiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm1hcmtQb2ludFByb3BzOgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnQ6CiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmJlZ2luTWFya2VkQ29udGVudFByb3BzOgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5lbmRNYXJrZWRDb250ZW50OgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5iZWdpbkNvbXBhdDoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuZW5kQ29tcGF0OgogICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBpZiAoYXJncyAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgZm9yIChpID0gMCwgaWkgPSBhcmdzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgICAgICAgICAgaWYgKGFyZ3NbaV0gaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5EaWN0KSB7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoaSA8IGlpKSB7CiAgICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiZ2V0T3BlcmF0b3JMaXN0IC0gaWdub3Jpbmcgb3BlcmF0b3I6ICIgKyBmbik7CiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICB9CgogICAgICAgICAgb3BlcmF0b3JMaXN0LmFkZE9wKGZuLCBhcmdzKTsKICAgICAgICB9CgogICAgICAgIGlmIChzdG9wKSB7CiAgICAgICAgICBuZXh0KGRlZmVycmVkKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNsb3NlUGVuZGluZ1Jlc3RvcmVPUFMoKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgX3V0aWwuQWJvcnRFeGNlcHRpb24pIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChfdGhpczEwLm9wdGlvbnMuaWdub3JlRXJyb3JzKSB7CiAgICAgICAgICBfdGhpczEwLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLmVycm9yT3BlcmF0b3JMaXN0CiAgICAgICAgICB9KTsKCiAgICAgICAgICAoMCwgX3V0aWwud2FybikoImdldE9wZXJhdG9yTGlzdCAtIGlnbm9yaW5nIGVycm9ycyBkdXJpbmcgXCIiLmNvbmNhdCh0YXNrLm5hbWUsICJcIiAiKSArICJ0YXNrOiBcIiIuY29uY2F0KHJlYXNvbiwgIlwiLiIpKTsKICAgICAgICAgIGNsb3NlUGVuZGluZ1Jlc3RvcmVPUFMoKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0VGV4dENvbnRlbnQ6IGZ1bmN0aW9uIGdldFRleHRDb250ZW50KF9yZWY3KSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHZhciBzdHJlYW0gPSBfcmVmNy5zdHJlYW0sCiAgICAgICAgICB0YXNrID0gX3JlZjcudGFzaywKICAgICAgICAgIHJlc291cmNlcyA9IF9yZWY3LnJlc291cmNlcywKICAgICAgICAgIF9yZWY3JHN0YXRlTWFuYWdlciA9IF9yZWY3LnN0YXRlTWFuYWdlciwKICAgICAgICAgIHN0YXRlTWFuYWdlciA9IF9yZWY3JHN0YXRlTWFuYWdlciA9PT0gdm9pZCAwID8gbnVsbCA6IF9yZWY3JHN0YXRlTWFuYWdlciwKICAgICAgICAgIF9yZWY3JG5vcm1hbGl6ZVdoaXRlcyA9IF9yZWY3Lm5vcm1hbGl6ZVdoaXRlc3BhY2UsCiAgICAgICAgICBub3JtYWxpemVXaGl0ZXNwYWNlID0gX3JlZjckbm9ybWFsaXplV2hpdGVzID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWY3JG5vcm1hbGl6ZVdoaXRlcywKICAgICAgICAgIF9yZWY3JGNvbWJpbmVUZXh0SXRlbSA9IF9yZWY3LmNvbWJpbmVUZXh0SXRlbXMsCiAgICAgICAgICBjb21iaW5lVGV4dEl0ZW1zID0gX3JlZjckY29tYmluZVRleHRJdGVtID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWY3JGNvbWJpbmVUZXh0SXRlbSwKICAgICAgICAgIHNpbmsgPSBfcmVmNy5zaW5rLAogICAgICAgICAgX3JlZjckc2VlblN0eWxlcyA9IF9yZWY3LnNlZW5TdHlsZXMsCiAgICAgICAgICBzZWVuU3R5bGVzID0gX3JlZjckc2VlblN0eWxlcyA9PT0gdm9pZCAwID8gT2JqZWN0LmNyZWF0ZShudWxsKSA6IF9yZWY3JHNlZW5TdHlsZXM7CiAgICAgIHJlc291cmNlcyA9IHJlc291cmNlcyB8fCBfcHJpbWl0aXZlcy5EaWN0LmVtcHR5OwogICAgICBzdGF0ZU1hbmFnZXIgPSBzdGF0ZU1hbmFnZXIgfHwgbmV3IFN0YXRlTWFuYWdlcihuZXcgVGV4dFN0YXRlKCkpOwogICAgICB2YXIgV2hpdGVzcGFjZVJlZ2V4cCA9IC9ccy9nOwogICAgICB2YXIgdGV4dENvbnRlbnQgPSB7CiAgICAgICAgaXRlbXM6IFtdLAogICAgICAgIHN0eWxlczogT2JqZWN0LmNyZWF0ZShudWxsKQogICAgICB9OwogICAgICB2YXIgdGV4dENvbnRlbnRJdGVtID0gewogICAgICAgIGluaXRpYWxpemVkOiBmYWxzZSwKICAgICAgICBzdHI6IFtdLAogICAgICAgIHdpZHRoOiAwLAogICAgICAgIGhlaWdodDogMCwKICAgICAgICB2ZXJ0aWNhbDogZmFsc2UsCiAgICAgICAgbGFzdEFkdmFuY2VXaWR0aDogMCwKICAgICAgICBsYXN0QWR2YW5jZUhlaWdodDogMCwKICAgICAgICB0ZXh0QWR2YW5jZVNjYWxlOiAwLAogICAgICAgIHNwYWNlV2lkdGg6IDAsCiAgICAgICAgZmFrZVNwYWNlTWluOiBJbmZpbml0eSwKICAgICAgICBmYWtlTXVsdGlTcGFjZU1pbjogSW5maW5pdHksCiAgICAgICAgZmFrZU11bHRpU3BhY2VNYXg6IC0wLAogICAgICAgIHRleHRSdW5CcmVha0FsbG93ZWQ6IGZhbHNlLAogICAgICAgIHRyYW5zZm9ybTogbnVsbCwKICAgICAgICBmb250TmFtZTogbnVsbAogICAgICB9OwogICAgICB2YXIgU1BBQ0VfRkFDVE9SID0gMC4zOwogICAgICB2YXIgTVVMVElfU1BBQ0VfRkFDVE9SID0gMS41OwogICAgICB2YXIgTVVMVElfU1BBQ0VfRkFDVE9SX01BWCA9IDQ7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIHhyZWYgPSB0aGlzLnhyZWY7CiAgICAgIHZhciB4b2JqcyA9IG51bGw7CiAgICAgIHZhciBlbXB0eVhPYmplY3RDYWNoZSA9IG5ldyBfaW1hZ2VfdXRpbHMuTG9jYWxJbWFnZUNhY2hlKCk7CiAgICAgIHZhciBwcmVwcm9jZXNzb3IgPSBuZXcgRXZhbHVhdG9yUHJlcHJvY2Vzc29yKHN0cmVhbSwgeHJlZiwgc3RhdGVNYW5hZ2VyKTsKICAgICAgdmFyIHRleHRTdGF0ZTsKCiAgICAgIGZ1bmN0aW9uIGVuc3VyZVRleHRDb250ZW50SXRlbSgpIHsKICAgICAgICBpZiAodGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkKSB7CiAgICAgICAgICByZXR1cm4gdGV4dENvbnRlbnRJdGVtOwogICAgICAgIH0KCiAgICAgICAgdmFyIGZvbnQgPSB0ZXh0U3RhdGUuZm9udDsKCiAgICAgICAgaWYgKCEoZm9udC5sb2FkZWROYW1lIGluIHNlZW5TdHlsZXMpKSB7CiAgICAgICAgICBzZWVuU3R5bGVzW2ZvbnQubG9hZGVkTmFtZV0gPSB0cnVlOwogICAgICAgICAgdGV4dENvbnRlbnQuc3R5bGVzW2ZvbnQubG9hZGVkTmFtZV0gPSB7CiAgICAgICAgICAgIGZvbnRGYW1pbHk6IGZvbnQuZmFsbGJhY2tOYW1lLAogICAgICAgICAgICBhc2NlbnQ6IGZvbnQuYXNjZW50LAogICAgICAgICAgICBkZXNjZW50OiBmb250LmRlc2NlbnQsCiAgICAgICAgICAgIHZlcnRpY2FsOiBmb250LnZlcnRpY2FsCiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgdGV4dENvbnRlbnRJdGVtLmZvbnROYW1lID0gZm9udC5sb2FkZWROYW1lOwogICAgICAgIHZhciB0c20gPSBbdGV4dFN0YXRlLmZvbnRTaXplICogdGV4dFN0YXRlLnRleHRIU2NhbGUsIDAsIDAsIHRleHRTdGF0ZS5mb250U2l6ZSwgMCwgdGV4dFN0YXRlLnRleHRSaXNlXTsKCiAgICAgICAgaWYgKGZvbnQuaXNUeXBlM0ZvbnQgJiYgdGV4dFN0YXRlLmZvbnRTaXplIDw9IDEgJiYgISgwLCBfdXRpbC5pc0FycmF5RXF1YWwpKHRleHRTdGF0ZS5mb250TWF0cml4LCBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWCkpIHsKICAgICAgICAgIHZhciBnbHlwaEhlaWdodCA9IGZvbnQuYmJveFszXSAtIGZvbnQuYmJveFsxXTsKCiAgICAgICAgICBpZiAoZ2x5cGhIZWlnaHQgPiAwKSB7CiAgICAgICAgICAgIHRzbVszXSAqPSBnbHlwaEhlaWdodCAqIHRleHRTdGF0ZS5mb250TWF0cml4WzNdOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFyIHRybSA9IF91dGlsLlV0aWwudHJhbnNmb3JtKHRleHRTdGF0ZS5jdG0sIF91dGlsLlV0aWwudHJhbnNmb3JtKHRleHRTdGF0ZS50ZXh0TWF0cml4LCB0c20pKTsKCiAgICAgICAgdGV4dENvbnRlbnRJdGVtLnRyYW5zZm9ybSA9IHRybTsKCiAgICAgICAgaWYgKCFmb250LnZlcnRpY2FsKSB7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0ud2lkdGggPSAwOwogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhlaWdodCA9IE1hdGguc3FydCh0cm1bMl0gKiB0cm1bMl0gKyB0cm1bM10gKiB0cm1bM10pOwogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLnZlcnRpY2FsID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRleHRDb250ZW50SXRlbS53aWR0aCA9IE1hdGguc3FydCh0cm1bMF0gKiB0cm1bMF0gKyB0cm1bMV0gKiB0cm1bMV0pOwogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhlaWdodCA9IDA7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0udmVydGljYWwgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIGEgPSB0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXhbMF07CiAgICAgICAgdmFyIGIgPSB0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXhbMV07CiAgICAgICAgdmFyIHNjYWxlTGluZVggPSBNYXRoLnNxcnQoYSAqIGEgKyBiICogYik7CiAgICAgICAgYSA9IHRleHRTdGF0ZS5jdG1bMF07CiAgICAgICAgYiA9IHRleHRTdGF0ZS5jdG1bMV07CiAgICAgICAgdmFyIHNjYWxlQ3RtWCA9IE1hdGguc3FydChhICogYSArIGIgKiBiKTsKICAgICAgICB0ZXh0Q29udGVudEl0ZW0udGV4dEFkdmFuY2VTY2FsZSA9IHNjYWxlQ3RtWCAqIHNjYWxlTGluZVg7CiAgICAgICAgdGV4dENvbnRlbnRJdGVtLmxhc3RBZHZhbmNlV2lkdGggPSAwOwogICAgICAgIHRleHRDb250ZW50SXRlbS5sYXN0QWR2YW5jZUhlaWdodCA9IDA7CiAgICAgICAgdmFyIHNwYWNlV2lkdGggPSBmb250LnNwYWNlV2lkdGggLyAxMDAwICogdGV4dFN0YXRlLmZvbnRTaXplOwoKICAgICAgICBpZiAoc3BhY2VXaWR0aCkgewogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLnNwYWNlV2lkdGggPSBzcGFjZVdpZHRoOwogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLmZha2VTcGFjZU1pbiA9IHNwYWNlV2lkdGggKiBTUEFDRV9GQUNUT1I7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0uZmFrZU11bHRpU3BhY2VNaW4gPSBzcGFjZVdpZHRoICogTVVMVElfU1BBQ0VfRkFDVE9SOwogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLmZha2VNdWx0aVNwYWNlTWF4ID0gc3BhY2VXaWR0aCAqIE1VTFRJX1NQQUNFX0ZBQ1RPUl9NQVg7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0udGV4dFJ1bkJyZWFrQWxsb3dlZCA9ICFmb250LmlzTW9ub3NwYWNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0uc3BhY2VXaWR0aCA9IDA7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0uZmFrZVNwYWNlTWluID0gSW5maW5pdHk7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0uZmFrZU11bHRpU3BhY2VNaW4gPSBJbmZpbml0eTsKICAgICAgICAgIHRleHRDb250ZW50SXRlbS5mYWtlTXVsdGlTcGFjZU1heCA9IDA7CiAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0udGV4dFJ1bkJyZWFrQWxsb3dlZCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGV4dENvbnRlbnRJdGVtLmluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdGV4dENvbnRlbnRJdGVtOwogICAgICB9CgogICAgICBmdW5jdGlvbiByZXBsYWNlV2hpdGVzcGFjZShzdHIpIHsKICAgICAgICB2YXIgaSA9IDAsCiAgICAgICAgICAgIGlpID0gc3RyLmxlbmd0aCwKICAgICAgICAgICAgY29kZTsKCiAgICAgICAgd2hpbGUgKGkgPCBpaSAmJiAoY29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpKSA+PSAweDIwICYmIGNvZGUgPD0gMHg3ZikgewogICAgICAgICAgaSsrOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGkgPCBpaSA/IHN0ci5yZXBsYWNlKFdoaXRlc3BhY2VSZWdleHAsICIgIikgOiBzdHI7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHJ1bkJpZGlUcmFuc2Zvcm0odGV4dENodW5rKSB7CiAgICAgICAgdmFyIHN0ciA9IHRleHRDaHVuay5zdHIuam9pbigiIik7CiAgICAgICAgdmFyIGJpZGlSZXN1bHQgPSAoMCwgX2JpZGkuYmlkaSkoc3RyLCAtMSwgdGV4dENodW5rLnZlcnRpY2FsKTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgc3RyOiBub3JtYWxpemVXaGl0ZXNwYWNlID8gcmVwbGFjZVdoaXRlc3BhY2UoYmlkaVJlc3VsdC5zdHIpIDogYmlkaVJlc3VsdC5zdHIsCiAgICAgICAgICBkaXI6IGJpZGlSZXN1bHQuZGlyLAogICAgICAgICAgd2lkdGg6IHRleHRDaHVuay53aWR0aCwKICAgICAgICAgIGhlaWdodDogdGV4dENodW5rLmhlaWdodCwKICAgICAgICAgIHRyYW5zZm9ybTogdGV4dENodW5rLnRyYW5zZm9ybSwKICAgICAgICAgIGZvbnROYW1lOiB0ZXh0Q2h1bmsuZm9udE5hbWUKICAgICAgICB9OwogICAgICB9CgogICAgICBmdW5jdGlvbiBoYW5kbGVTZXRGb250KGZvbnROYW1lLCBmb250UmVmKSB7CiAgICAgICAgcmV0dXJuIHNlbGYubG9hZEZvbnQoZm9udE5hbWUsIGZvbnRSZWYsIHJlc291cmNlcykudGhlbihmdW5jdGlvbiAodHJhbnNsYXRlZCkgewogICAgICAgICAgdGV4dFN0YXRlLmZvbnQgPSB0cmFuc2xhdGVkLmZvbnQ7CiAgICAgICAgICB0ZXh0U3RhdGUuZm9udE1hdHJpeCA9IHRyYW5zbGF0ZWQuZm9udC5mb250TWF0cml4IHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBidWlsZFRleHRDb250ZW50SXRlbShjaGFycykgewogICAgICAgIHZhciBmb250ID0gdGV4dFN0YXRlLmZvbnQ7CiAgICAgICAgdmFyIHRleHRDaHVuayA9IGVuc3VyZVRleHRDb250ZW50SXRlbSgpOwogICAgICAgIHZhciB3aWR0aCA9IDA7CiAgICAgICAgdmFyIGhlaWdodCA9IDA7CiAgICAgICAgdmFyIGdseXBocyA9IGZvbnQuY2hhcnNUb0dseXBocyhjaGFycyk7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ2x5cGhzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgZ2x5cGggPSBnbHlwaHNbaV07CiAgICAgICAgICB2YXIgZ2x5cGhXaWR0aCA9IG51bGw7CgogICAgICAgICAgaWYgKGZvbnQudmVydGljYWwgJiYgZ2x5cGgudm1ldHJpYykgewogICAgICAgICAgICBnbHlwaFdpZHRoID0gZ2x5cGgudm1ldHJpY1swXTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGdseXBoV2lkdGggPSBnbHlwaC53aWR0aDsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZ2x5cGhVbmljb2RlID0gZ2x5cGgudW5pY29kZTsKICAgICAgICAgIHZhciBOb3JtYWxpemVkVW5pY29kZXMgPSAoMCwgX3VuaWNvZGUuZ2V0Tm9ybWFsaXplZFVuaWNvZGVzKSgpOwoKICAgICAgICAgIGlmIChOb3JtYWxpemVkVW5pY29kZXNbZ2x5cGhVbmljb2RlXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGdseXBoVW5pY29kZSA9IE5vcm1hbGl6ZWRVbmljb2Rlc1tnbHlwaFVuaWNvZGVdOwogICAgICAgICAgfQoKICAgICAgICAgIGdseXBoVW5pY29kZSA9ICgwLCBfdW5pY29kZS5yZXZlcnNlSWZSdGwpKGdseXBoVW5pY29kZSk7CiAgICAgICAgICB2YXIgY2hhclNwYWNpbmcgPSB0ZXh0U3RhdGUuY2hhclNwYWNpbmc7CgogICAgICAgICAgaWYgKGdseXBoLmlzU3BhY2UpIHsKICAgICAgICAgICAgdmFyIHdvcmRTcGFjaW5nID0gdGV4dFN0YXRlLndvcmRTcGFjaW5nOwogICAgICAgICAgICBjaGFyU3BhY2luZyArPSB3b3JkU3BhY2luZzsKCiAgICAgICAgICAgIGlmICh3b3JkU3BhY2luZyA+IDApIHsKICAgICAgICAgICAgICBhZGRGYWtlU3BhY2VzKHdvcmRTcGFjaW5nLCB0ZXh0Q2h1bmsuc3RyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHZhciB0eCA9IDA7CiAgICAgICAgICB2YXIgdHkgPSAwOwoKICAgICAgICAgIGlmICghZm9udC52ZXJ0aWNhbCkgewogICAgICAgICAgICB2YXIgdzAgPSBnbHlwaFdpZHRoICogdGV4dFN0YXRlLmZvbnRNYXRyaXhbMF07CiAgICAgICAgICAgIHR4ID0gKHcwICogdGV4dFN0YXRlLmZvbnRTaXplICsgY2hhclNwYWNpbmcpICogdGV4dFN0YXRlLnRleHRIU2NhbGU7CiAgICAgICAgICAgIHdpZHRoICs9IHR4OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIHcxID0gZ2x5cGhXaWR0aCAqIHRleHRTdGF0ZS5mb250TWF0cml4WzBdOwogICAgICAgICAgICB0eSA9IHcxICogdGV4dFN0YXRlLmZvbnRTaXplICsgY2hhclNwYWNpbmc7CiAgICAgICAgICAgIGhlaWdodCArPSB0eTsKICAgICAgICAgIH0KCiAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dE1hdHJpeCh0eCwgdHkpOwogICAgICAgICAgdGV4dENodW5rLnN0ci5wdXNoKGdseXBoVW5pY29kZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWZvbnQudmVydGljYWwpIHsKICAgICAgICAgIHRleHRDaHVuay5sYXN0QWR2YW5jZVdpZHRoID0gd2lkdGg7CiAgICAgICAgICB0ZXh0Q2h1bmsud2lkdGggKz0gd2lkdGg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRleHRDaHVuay5sYXN0QWR2YW5jZUhlaWdodCA9IGhlaWdodDsKICAgICAgICAgIHRleHRDaHVuay5oZWlnaHQgKz0gTWF0aC5hYnMoaGVpZ2h0KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0ZXh0Q2h1bms7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFkZEZha2VTcGFjZXMod2lkdGgsIHN0ckJ1ZikgewogICAgICAgIGlmICh3aWR0aCA8IHRleHRDb250ZW50SXRlbS5mYWtlU3BhY2VNaW4pIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh3aWR0aCA8IHRleHRDb250ZW50SXRlbS5mYWtlTXVsdGlTcGFjZU1pbikgewogICAgICAgICAgc3RyQnVmLnB1c2goIiAiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBmYWtlU3BhY2VzID0gTWF0aC5yb3VuZCh3aWR0aCAvIHRleHRDb250ZW50SXRlbS5zcGFjZVdpZHRoKTsKCiAgICAgICAgd2hpbGUgKGZha2VTcGFjZXMtLSA+IDApIHsKICAgICAgICAgIHN0ckJ1Zi5wdXNoKCIgIik7CiAgICAgICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiBmbHVzaFRleHRDb250ZW50SXRlbSgpIHsKICAgICAgICBpZiAoIXRleHRDb250ZW50SXRlbS5pbml0aWFsaXplZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF0ZXh0Q29udGVudEl0ZW0udmVydGljYWwpIHsKICAgICAgICAgIHRleHRDb250ZW50SXRlbS53aWR0aCAqPSB0ZXh0Q29udGVudEl0ZW0udGV4dEFkdmFuY2VTY2FsZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhlaWdodCAqPSB0ZXh0Q29udGVudEl0ZW0udGV4dEFkdmFuY2VTY2FsZTsKICAgICAgICB9CgogICAgICAgIHRleHRDb250ZW50Lml0ZW1zLnB1c2gocnVuQmlkaVRyYW5zZm9ybSh0ZXh0Q29udGVudEl0ZW0pKTsKICAgICAgICB0ZXh0Q29udGVudEl0ZW0uaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgICAgICB0ZXh0Q29udGVudEl0ZW0uc3RyLmxlbmd0aCA9IDA7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGVucXVldWVDaHVuaygpIHsKICAgICAgICB2YXIgbGVuZ3RoID0gdGV4dENvbnRlbnQuaXRlbXMubGVuZ3RoOwoKICAgICAgICBpZiAobGVuZ3RoID4gMCkgewogICAgICAgICAgc2luay5lbnF1ZXVlKHRleHRDb250ZW50LCBsZW5ndGgpOwogICAgICAgICAgdGV4dENvbnRlbnQuaXRlbXMgPSBbXTsKICAgICAgICAgIHRleHRDb250ZW50LnN0eWxlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgdGltZVNsb3RNYW5hZ2VyID0gbmV3IFRpbWVTbG90TWFuYWdlcigpOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gcHJvbWlzZUJvZHkocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIG5leHQgPSBmdW5jdGlvbiBuZXh0KHByb21pc2UpIHsKICAgICAgICAgIGVucXVldWVDaHVuaygpOwogICAgICAgICAgUHJvbWlzZS5hbGwoW3Byb21pc2UsIHNpbmsucmVhZHldKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBwcm9taXNlQm9keShyZXNvbHZlLCByZWplY3QpOwogICAgICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgICAgIHJlamVjdChleCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIHJlamVjdCk7CiAgICAgICAgfTsKCiAgICAgICAgdGFzay5lbnN1cmVOb3RUZXJtaW5hdGVkKCk7CiAgICAgICAgdGltZVNsb3RNYW5hZ2VyLnJlc2V0KCk7CiAgICAgICAgdmFyIHN0b3AsCiAgICAgICAgICAgIG9wZXJhdGlvbiA9IHt9LAogICAgICAgICAgICBhcmdzID0gW107CgogICAgICAgIHdoaWxlICghKHN0b3AgPSB0aW1lU2xvdE1hbmFnZXIuY2hlY2soKSkpIHsKICAgICAgICAgIGFyZ3MubGVuZ3RoID0gMDsKICAgICAgICAgIG9wZXJhdGlvbi5hcmdzID0gYXJnczsKCiAgICAgICAgICBpZiAoIXByZXByb2Nlc3Nvci5yZWFkKG9wZXJhdGlvbikpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGV4dFN0YXRlID0gc3RhdGVNYW5hZ2VyLnN0YXRlOwogICAgICAgICAgdmFyIGZuID0gb3BlcmF0aW9uLmZuOwogICAgICAgICAgYXJncyA9IG9wZXJhdGlvbi5hcmdzOwogICAgICAgICAgdmFyIGFkdmFuY2UsIGRpZmY7CgogICAgICAgICAgc3dpdGNoIChmbiB8IDApIHsKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0Rm9udDoKICAgICAgICAgICAgICB2YXIgZm9udE5hbWVBcmcgPSBhcmdzWzBdLm5hbWUsCiAgICAgICAgICAgICAgICAgIGZvbnRTaXplQXJnID0gYXJnc1sxXTsKCiAgICAgICAgICAgICAgaWYgKHRleHRTdGF0ZS5mb250ICYmIGZvbnROYW1lQXJnID09PSB0ZXh0U3RhdGUuZm9udE5hbWUgJiYgZm9udFNpemVBcmcgPT09IHRleHRTdGF0ZS5mb250U2l6ZSkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgICAgICAgIHRleHRTdGF0ZS5mb250TmFtZSA9IGZvbnROYW1lQXJnOwogICAgICAgICAgICAgIHRleHRTdGF0ZS5mb250U2l6ZSA9IGZvbnRTaXplQXJnOwogICAgICAgICAgICAgIG5leHQoaGFuZGxlU2V0Rm9udChmb250TmFtZUFyZywgbnVsbCkpOwogICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldFRleHRSaXNlOgogICAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgICAgICAgdGV4dFN0YXRlLnRleHRSaXNlID0gYXJnc1swXTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldEhTY2FsZToKICAgICAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgICAgICAgIHRleHRTdGF0ZS50ZXh0SFNjYWxlID0gYXJnc1swXSAvIDEwMDsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLnNldExlYWRpbmc6CiAgICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKICAgICAgICAgICAgICB0ZXh0U3RhdGUubGVhZGluZyA9IGFyZ3NbMF07CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5tb3ZlVGV4dDoKICAgICAgICAgICAgICB2YXIgaXNTYW1lVGV4dExpbmUgPSAhdGV4dFN0YXRlLmZvbnQgPyBmYWxzZSA6ICh0ZXh0U3RhdGUuZm9udC52ZXJ0aWNhbCA/IGFyZ3NbMF0gOiBhcmdzWzFdKSA9PT0gMDsKICAgICAgICAgICAgICBhZHZhbmNlID0gYXJnc1swXSAtIGFyZ3NbMV07CgogICAgICAgICAgICAgIGlmIChjb21iaW5lVGV4dEl0ZW1zICYmIGlzU2FtZVRleHRMaW5lICYmIHRleHRDb250ZW50SXRlbS5pbml0aWFsaXplZCAmJiBhZHZhbmNlID4gMCAmJiBhZHZhbmNlIDw9IHRleHRDb250ZW50SXRlbS5mYWtlTXVsdGlTcGFjZU1heCkgewogICAgICAgICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRMaW5lTWF0cml4KGFyZ3NbMF0sIGFyZ3NbMV0pOwogICAgICAgICAgICAgICAgdGV4dENvbnRlbnRJdGVtLndpZHRoICs9IGFyZ3NbMF0gLSB0ZXh0Q29udGVudEl0ZW0ubGFzdEFkdmFuY2VXaWR0aDsKICAgICAgICAgICAgICAgIHRleHRDb250ZW50SXRlbS5oZWlnaHQgKz0gYXJnc1sxXSAtIHRleHRDb250ZW50SXRlbS5sYXN0QWR2YW5jZUhlaWdodDsKICAgICAgICAgICAgICAgIGRpZmYgPSBhcmdzWzBdIC0gdGV4dENvbnRlbnRJdGVtLmxhc3RBZHZhbmNlV2lkdGggLSAoYXJnc1sxXSAtIHRleHRDb250ZW50SXRlbS5sYXN0QWR2YW5jZUhlaWdodCk7CiAgICAgICAgICAgICAgICBhZGRGYWtlU3BhY2VzKGRpZmYsIHRleHRDb250ZW50SXRlbS5zdHIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TGluZU1hdHJpeChhcmdzWzBdLCBhcmdzWzFdKTsKICAgICAgICAgICAgICB0ZXh0U3RhdGUudGV4dE1hdHJpeCA9IHRleHRTdGF0ZS50ZXh0TGluZU1hdHJpeC5zbGljZSgpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0TGVhZGluZ01vdmVUZXh0OgogICAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgICAgICAgdGV4dFN0YXRlLmxlYWRpbmcgPSAtYXJnc1sxXTsKICAgICAgICAgICAgICB0ZXh0U3RhdGUudHJhbnNsYXRlVGV4dExpbmVNYXRyaXgoYXJnc1swXSwgYXJnc1sxXSk7CiAgICAgICAgICAgICAgdGV4dFN0YXRlLnRleHRNYXRyaXggPSB0ZXh0U3RhdGUudGV4dExpbmVNYXRyaXguc2xpY2UoKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lOgogICAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgICAgICAgdGV4dFN0YXRlLmNhcnJpYWdlUmV0dXJuKCk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRUZXh0TWF0cml4OgogICAgICAgICAgICAgIGFkdmFuY2UgPSB0ZXh0U3RhdGUuY2FsY1RleHRMaW5lTWF0cml4QWR2YW5jZShhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdLCBhcmdzWzRdLCBhcmdzWzVdKTsKCiAgICAgICAgICAgICAgaWYgKGNvbWJpbmVUZXh0SXRlbXMgJiYgYWR2YW5jZSAhPT0gbnVsbCAmJiB0ZXh0Q29udGVudEl0ZW0uaW5pdGlhbGl6ZWQgJiYgYWR2YW5jZS52YWx1ZSA+IDAgJiYgYWR2YW5jZS52YWx1ZSA8PSB0ZXh0Q29udGVudEl0ZW0uZmFrZU11bHRpU3BhY2VNYXgpIHsKICAgICAgICAgICAgICAgIHRleHRTdGF0ZS50cmFuc2xhdGVUZXh0TGluZU1hdHJpeChhZHZhbmNlLndpZHRoLCBhZHZhbmNlLmhlaWdodCk7CiAgICAgICAgICAgICAgICB0ZXh0Q29udGVudEl0ZW0ud2lkdGggKz0gYWR2YW5jZS53aWR0aCAtIHRleHRDb250ZW50SXRlbS5sYXN0QWR2YW5jZVdpZHRoOwogICAgICAgICAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhlaWdodCArPSBhZHZhbmNlLmhlaWdodCAtIHRleHRDb250ZW50SXRlbS5sYXN0QWR2YW5jZUhlaWdodDsKICAgICAgICAgICAgICAgIGRpZmYgPSBhZHZhbmNlLndpZHRoIC0gdGV4dENvbnRlbnRJdGVtLmxhc3RBZHZhbmNlV2lkdGggLSAoYWR2YW5jZS5oZWlnaHQgLSB0ZXh0Q29udGVudEl0ZW0ubGFzdEFkdmFuY2VIZWlnaHQpOwogICAgICAgICAgICAgICAgYWRkRmFrZVNwYWNlcyhkaWZmLCB0ZXh0Q29udGVudEl0ZW0uc3RyKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKICAgICAgICAgICAgICB0ZXh0U3RhdGUuc2V0VGV4dE1hdHJpeChhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdLCBhcmdzWzNdLCBhcmdzWzRdLCBhcmdzWzVdKTsKICAgICAgICAgICAgICB0ZXh0U3RhdGUuc2V0VGV4dExpbmVNYXRyaXgoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSwgYXJnc1s0XSwgYXJnc1s1XSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRDaGFyU3BhY2luZzoKICAgICAgICAgICAgICB0ZXh0U3RhdGUuY2hhclNwYWNpbmcgPSBhcmdzWzBdOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2V0V29yZFNwYWNpbmc6CiAgICAgICAgICAgICAgdGV4dFN0YXRlLndvcmRTcGFjaW5nID0gYXJnc1swXTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLmJlZ2luVGV4dDoKICAgICAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgICAgICAgIHRleHRTdGF0ZS50ZXh0TWF0cml4ID0gX3V0aWwuSURFTlRJVFlfTUFUUklYLnNsaWNlKCk7CiAgICAgICAgICAgICAgdGV4dFN0YXRlLnRleHRMaW5lTWF0cml4ID0gX3V0aWwuSURFTlRJVFlfTUFUUklYLnNsaWNlKCk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaG93U3BhY2VkVGV4dDoKICAgICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgaXRlbXMgPSBhcmdzWzBdOwogICAgICAgICAgICAgIHZhciBvZmZzZXQ7CgogICAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IGl0ZW1zLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbXNbal0gPT09ICJzdHJpbmciKSB7CiAgICAgICAgICAgICAgICAgIGJ1aWxkVGV4dENvbnRlbnRJdGVtKGl0ZW1zW2pdKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDAsIF91dGlsLmlzTnVtKShpdGVtc1tqXSkpIHsKICAgICAgICAgICAgICAgICAgZW5zdXJlVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgICAgICAgICAgIGFkdmFuY2UgPSBpdGVtc1tqXSAqIHRleHRTdGF0ZS5mb250U2l6ZSAvIDEwMDA7CiAgICAgICAgICAgICAgICAgIHZhciBicmVha1RleHRSdW4gPSBmYWxzZTsKCiAgICAgICAgICAgICAgICAgIGlmICh0ZXh0U3RhdGUuZm9udC52ZXJ0aWNhbCkgewogICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IGFkdmFuY2U7CiAgICAgICAgICAgICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRNYXRyaXgoMCwgb2Zmc2V0KTsKICAgICAgICAgICAgICAgICAgICBicmVha1RleHRSdW4gPSB0ZXh0Q29udGVudEl0ZW0udGV4dFJ1bkJyZWFrQWxsb3dlZCAmJiBhZHZhbmNlID4gdGV4dENvbnRlbnRJdGVtLmZha2VNdWx0aVNwYWNlTWF4OwoKICAgICAgICAgICAgICAgICAgICBpZiAoIWJyZWFrVGV4dFJ1bikgewogICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnRJdGVtLmhlaWdodCArPSBvZmZzZXQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFkdmFuY2UgPSAtYWR2YW5jZTsKICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBhZHZhbmNlICogdGV4dFN0YXRlLnRleHRIU2NhbGU7CiAgICAgICAgICAgICAgICAgICAgdGV4dFN0YXRlLnRyYW5zbGF0ZVRleHRNYXRyaXgob2Zmc2V0LCAwKTsKICAgICAgICAgICAgICAgICAgICBicmVha1RleHRSdW4gPSB0ZXh0Q29udGVudEl0ZW0udGV4dFJ1bkJyZWFrQWxsb3dlZCAmJiBhZHZhbmNlID4gdGV4dENvbnRlbnRJdGVtLmZha2VNdWx0aVNwYWNlTWF4OwoKICAgICAgICAgICAgICAgICAgICBpZiAoIWJyZWFrVGV4dFJ1bikgewogICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnRJdGVtLndpZHRoICs9IG9mZnNldDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmIChicmVha1RleHRSdW4pIHsKICAgICAgICAgICAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFkdmFuY2UgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkRmFrZVNwYWNlcyhhZHZhbmNlLCB0ZXh0Q29udGVudEl0ZW0uc3RyKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zaG93VGV4dDoKICAgICAgICAgICAgICBpZiAoIXN0YXRlTWFuYWdlci5zdGF0ZS5mb250KSB7CiAgICAgICAgICAgICAgICBzZWxmLmVuc3VyZVN0YXRlRm9udChzdGF0ZU1hbmFnZXIuc3RhdGUpOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBidWlsZFRleHRDb250ZW50SXRlbShhcmdzWzBdKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lU2hvd1RleHQ6CiAgICAgICAgICAgICAgaWYgKCFzdGF0ZU1hbmFnZXIuc3RhdGUuZm9udCkgewogICAgICAgICAgICAgICAgc2VsZi5lbnN1cmVTdGF0ZUZvbnQoc3RhdGVNYW5hZ2VyLnN0YXRlKTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKICAgICAgICAgICAgICB0ZXh0U3RhdGUuY2FycmlhZ2VSZXR1cm4oKTsKICAgICAgICAgICAgICBidWlsZFRleHRDb250ZW50SXRlbShhcmdzWzBdKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgX3V0aWwuT1BTLm5leHRMaW5lU2V0U3BhY2luZ1Nob3dUZXh0OgogICAgICAgICAgICAgIGlmICghc3RhdGVNYW5hZ2VyLnN0YXRlLmZvbnQpIHsKICAgICAgICAgICAgICAgIHNlbGYuZW5zdXJlU3RhdGVGb250KHN0YXRlTWFuYWdlci5zdGF0ZSk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CiAgICAgICAgICAgICAgdGV4dFN0YXRlLndvcmRTcGFjaW5nID0gYXJnc1swXTsKICAgICAgICAgICAgICB0ZXh0U3RhdGUuY2hhclNwYWNpbmcgPSBhcmdzWzFdOwogICAgICAgICAgICAgIHRleHRTdGF0ZS5jYXJyaWFnZVJldHVybigpOwogICAgICAgICAgICAgIGJ1aWxkVGV4dENvbnRlbnRJdGVtKGFyZ3NbMl0pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSBfdXRpbC5PUFMucGFpbnRYT2JqZWN0OgogICAgICAgICAgICAgIGZsdXNoVGV4dENvbnRlbnRJdGVtKCk7CgogICAgICAgICAgICAgIGlmICgheG9ianMpIHsKICAgICAgICAgICAgICAgIHhvYmpzID0gcmVzb3VyY2VzLmdldCgiWE9iamVjdCIpIHx8IF9wcmltaXRpdmVzLkRpY3QuZW1wdHk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgbmFtZSA9IGFyZ3NbMF0ubmFtZTsKCiAgICAgICAgICAgICAgaWYgKG5hbWUgJiYgZW1wdHlYT2JqZWN0Q2FjaGUuZ2V0QnlOYW1lKG5hbWUpKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIG5leHQobmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmVYT2JqZWN0LCByZWplY3RYT2JqZWN0KSB7CiAgICAgICAgICAgICAgICBpZiAoIW5hbWUpIHsKICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJYT2JqZWN0IG11c3QgYmUgcmVmZXJyZWQgdG8gYnkgbmFtZS4iKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB2YXIgeG9iaiA9IHhvYmpzLmdldFJhdyhuYW1lKTsKCiAgICAgICAgICAgICAgICBpZiAoeG9iaiBpbnN0YW5jZW9mIF9wcmltaXRpdmVzLlJlZikgewogICAgICAgICAgICAgICAgICBpZiAoZW1wdHlYT2JqZWN0Q2FjaGUuZ2V0QnlSZWYoeG9iaikpIHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgeG9iaiA9IHhyZWYuZmV0Y2goeG9iaik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCF4b2JqKSB7CiAgICAgICAgICAgICAgICAgIHJlc29sdmVYT2JqZWN0KCk7CiAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkoeG9iaikpIHsKICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJYT2JqZWN0IHNob3VsZCBiZSBhIHN0cmVhbSIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciB0eXBlID0geG9iai5kaWN0LmdldCgiU3VidHlwZSIpOwoKICAgICAgICAgICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodHlwZSkpIHsKICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJYT2JqZWN0IHNob3VsZCBoYXZlIGEgTmFtZSBzdWJ0eXBlIik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHR5cGUubmFtZSAhPT0gIkZvcm0iKSB7CiAgICAgICAgICAgICAgICAgIGVtcHR5WE9iamVjdENhY2hlLnNldChuYW1lLCB4b2JqLmRpY3Qub2JqSWQsIHRydWUpOwogICAgICAgICAgICAgICAgICByZXNvbHZlWE9iamVjdCgpOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IHN0YXRlTWFuYWdlci5zdGF0ZS5jbG9uZSgpOwogICAgICAgICAgICAgICAgdmFyIHhPYmpTdGF0ZU1hbmFnZXIgPSBuZXcgU3RhdGVNYW5hZ2VyKGN1cnJlbnRTdGF0ZSk7CiAgICAgICAgICAgICAgICB2YXIgbWF0cml4ID0geG9iai5kaWN0LmdldEFycmF5KCJNYXRyaXgiKTsKCiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShtYXRyaXgpICYmIG1hdHJpeC5sZW5ndGggPT09IDYpIHsKICAgICAgICAgICAgICAgICAgeE9ialN0YXRlTWFuYWdlci50cmFuc2Zvcm0obWF0cml4KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBlbnF1ZXVlQ2h1bmsoKTsKICAgICAgICAgICAgICAgIHZhciBzaW5rV3JhcHBlciA9IHsKICAgICAgICAgICAgICAgICAgZW5xdWV1ZUludm9rZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICBlbnF1ZXVlOiBmdW5jdGlvbiBlbnF1ZXVlKGNodW5rLCBzaXplKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnF1ZXVlSW52b2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgc2luay5lbnF1ZXVlKGNodW5rLCBzaXplKTsKICAgICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICAgIGdldCBkZXNpcmVkU2l6ZSgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2luay5kZXNpcmVkU2l6ZTsKICAgICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICAgIGdldCByZWFkeSgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2luay5yZWFkeTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBzZWxmLmdldFRleHRDb250ZW50KHsKICAgICAgICAgICAgICAgICAgc3RyZWFtOiB4b2JqLAogICAgICAgICAgICAgICAgICB0YXNrOiB0YXNrLAogICAgICAgICAgICAgICAgICByZXNvdXJjZXM6IHhvYmouZGljdC5nZXQoIlJlc291cmNlcyIpIHx8IHJlc291cmNlcywKICAgICAgICAgICAgICAgICAgc3RhdGVNYW5hZ2VyOiB4T2JqU3RhdGVNYW5hZ2VyLAogICAgICAgICAgICAgICAgICBub3JtYWxpemVXaGl0ZXNwYWNlOiBub3JtYWxpemVXaGl0ZXNwYWNlLAogICAgICAgICAgICAgICAgICBjb21iaW5lVGV4dEl0ZW1zOiBjb21iaW5lVGV4dEl0ZW1zLAogICAgICAgICAgICAgICAgICBzaW5rOiBzaW5rV3JhcHBlciwKICAgICAgICAgICAgICAgICAgc2VlblN0eWxlczogc2VlblN0eWxlcwogICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIGlmICghc2lua1dyYXBwZXIuZW5xdWV1ZUludm9rZWQpIHsKICAgICAgICAgICAgICAgICAgICBlbXB0eVhPYmplY3RDYWNoZS5zZXQobmFtZSwgeG9iai5kaWN0Lm9iaklkLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcmVzb2x2ZVhPYmplY3QoKTsKICAgICAgICAgICAgICAgIH0sIHJlamVjdFhPYmplY3QpOwogICAgICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfdXRpbC5BYm9ydEV4Y2VwdGlvbikgewogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJnZXRUZXh0Q29udGVudCAtIGlnbm9yaW5nIFhPYmplY3Q6IFwiIi5jb25jYXQocmVhc29uLCAiXCIuIikpOwogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhyb3cgcmVhc29uOwogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICBjYXNlIF91dGlsLk9QUy5zZXRHU3RhdGU6CiAgICAgICAgICAgICAgZmx1c2hUZXh0Q29udGVudEl0ZW0oKTsKICAgICAgICAgICAgICB2YXIgZGljdE5hbWUgPSBhcmdzWzBdOwogICAgICAgICAgICAgIHZhciBleHRHU3RhdGUgPSByZXNvdXJjZXMuZ2V0KCJFeHRHU3RhdGUiKTsKCiAgICAgICAgICAgICAgaWYgKCEoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShleHRHU3RhdGUpIHx8ICEoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShkaWN0TmFtZSkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIGdTdGF0ZSA9IGV4dEdTdGF0ZS5nZXQoZGljdE5hbWUubmFtZSk7CgogICAgICAgICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoZ1N0YXRlKSkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YXIgZ1N0YXRlRm9udCA9IGdTdGF0ZS5nZXQoIkZvbnQiKTsKCiAgICAgICAgICAgICAgaWYgKGdTdGF0ZUZvbnQpIHsKICAgICAgICAgICAgICAgIHRleHRTdGF0ZS5mb250TmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgICB0ZXh0U3RhdGUuZm9udFNpemUgPSBnU3RhdGVGb250WzFdOwogICAgICAgICAgICAgICAgbmV4dChoYW5kbGVTZXRGb250KG51bGwsIGdTdGF0ZUZvbnRbMF0pKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0ZXh0Q29udGVudC5pdGVtcy5sZW5ndGggPj0gc2luay5kZXNpcmVkU2l6ZSkgewogICAgICAgICAgICBzdG9wID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RvcCkgewogICAgICAgICAgbmV4dChkZWZlcnJlZCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgIGVucXVldWVDaHVuaygpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfdXRpbC5BYm9ydEV4Y2VwdGlvbikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKF90aGlzMTEub3B0aW9ucy5pZ25vcmVFcnJvcnMpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiZ2V0VGV4dENvbnRlbnQgLSBpZ25vcmluZyBlcnJvcnMgZHVyaW5nIFwiIi5jb25jYXQodGFzay5uYW1lLCAiXCIgIikgKyAidGFzazogXCIiLmNvbmNhdChyZWFzb24sICJcIi4iKSk7CiAgICAgICAgICBmbHVzaFRleHRDb250ZW50SXRlbSgpOwogICAgICAgICAgZW5xdWV1ZUNodW5rKCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0aHJvdyByZWFzb247CiAgICAgIH0pOwogICAgfSwKICAgIGV4dHJhY3REYXRhU3RydWN0dXJlczogZnVuY3Rpb24gUGFydGlhbEV2YWx1YXRvcl9leHRyYWN0RGF0YVN0cnVjdHVyZXMoZGljdCwgYmFzZURpY3QsIHByb3BlcnRpZXMpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgdmFyIHhyZWYgPSB0aGlzLnhyZWY7CiAgICAgIHZhciBjaWRUb0dpZEJ5dGVzOwogICAgICB2YXIgdG9Vbmljb2RlID0gZGljdC5nZXQoIlRvVW5pY29kZSIpIHx8IGJhc2VEaWN0LmdldCgiVG9Vbmljb2RlIik7CiAgICAgIHZhciB0b1VuaWNvZGVQcm9taXNlID0gdG9Vbmljb2RlID8gdGhpcy5yZWFkVG9Vbmljb2RlKHRvVW5pY29kZSkgOiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKTsKCiAgICAgIGlmIChwcm9wZXJ0aWVzLmNvbXBvc2l0ZSkgewogICAgICAgIHZhciBjaWRTeXN0ZW1JbmZvID0gZGljdC5nZXQoIkNJRFN5c3RlbUluZm8iKTsKCiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0RpY3QpKGNpZFN5c3RlbUluZm8pKSB7CiAgICAgICAgICBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm8gPSB7CiAgICAgICAgICAgIHJlZ2lzdHJ5OiAoMCwgX3V0aWwuc3RyaW5nVG9QREZTdHJpbmcpKGNpZFN5c3RlbUluZm8uZ2V0KCJSZWdpc3RyeSIpKSwKICAgICAgICAgICAgb3JkZXJpbmc6ICgwLCBfdXRpbC5zdHJpbmdUb1BERlN0cmluZykoY2lkU3lzdGVtSW5mby5nZXQoIk9yZGVyaW5nIikpLAogICAgICAgICAgICBzdXBwbGVtZW50OiBjaWRTeXN0ZW1JbmZvLmdldCgiU3VwcGxlbWVudCIpCiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgdmFyIGNpZFRvR2lkTWFwID0gZGljdC5nZXQoIkNJRFRvR0lETWFwIik7CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKGNpZFRvR2lkTWFwKSkgewogICAgICAgICAgY2lkVG9HaWRCeXRlcyA9IGNpZFRvR2lkTWFwLmdldEJ5dGVzKCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZGlmZmVyZW5jZXMgPSBbXTsKICAgICAgdmFyIGJhc2VFbmNvZGluZ05hbWUgPSBudWxsOwogICAgICB2YXIgZW5jb2Rpbmc7CgogICAgICBpZiAoZGljdC5oYXMoIkVuY29kaW5nIikpIHsKICAgICAgICBlbmNvZGluZyA9IGRpY3QuZ2V0KCJFbmNvZGluZyIpOwoKICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRGljdCkoZW5jb2RpbmcpKSB7CiAgICAgICAgICBiYXNlRW5jb2RpbmdOYW1lID0gZW5jb2RpbmcuZ2V0KCJCYXNlRW5jb2RpbmciKTsKICAgICAgICAgIGJhc2VFbmNvZGluZ05hbWUgPSAoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShiYXNlRW5jb2RpbmdOYW1lKSA/IGJhc2VFbmNvZGluZ05hbWUubmFtZSA6IG51bGw7CgogICAgICAgICAgaWYgKGVuY29kaW5nLmhhcygiRGlmZmVyZW5jZXMiKSkgewogICAgICAgICAgICB2YXIgZGlmZkVuY29kaW5nID0gZW5jb2RpbmcuZ2V0KCJEaWZmZXJlbmNlcyIpOwogICAgICAgICAgICB2YXIgaW5kZXggPSAwOwoKICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGpqID0gZGlmZkVuY29kaW5nLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICAgICAgICB2YXIgZGF0YSA9IHhyZWYuZmV0Y2hJZlJlZihkaWZmRW5jb2Rpbmdbal0pOwoKICAgICAgICAgICAgICBpZiAoKDAsIF91dGlsLmlzTnVtKShkYXRhKSkgewogICAgICAgICAgICAgICAgaW5kZXggPSBkYXRhOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZGF0YSkpIHsKICAgICAgICAgICAgICAgIGRpZmZlcmVuY2VzW2luZGV4KytdID0gZGF0YS5uYW1lOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgZW50cnkgaW4gJ0RpZmZlcmVuY2VzJyBhcnJheTogIi5jb25jYXQoZGF0YSkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZW5jb2RpbmcpKSB7CiAgICAgICAgICBiYXNlRW5jb2RpbmdOYW1lID0gZW5jb2RpbmcubmFtZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJFbmNvZGluZyBpcyBub3QgYSBOYW1lIG5vciBhIERpY3QiKTsKICAgICAgICB9CgogICAgICAgIGlmIChiYXNlRW5jb2RpbmdOYW1lICE9PSAiTWFjUm9tYW5FbmNvZGluZyIgJiYgYmFzZUVuY29kaW5nTmFtZSAhPT0gIk1hY0V4cGVydEVuY29kaW5nIiAmJiBiYXNlRW5jb2RpbmdOYW1lICE9PSAiV2luQW5zaUVuY29kaW5nIikgewogICAgICAgICAgYmFzZUVuY29kaW5nTmFtZSA9IG51bGw7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoYmFzZUVuY29kaW5nTmFtZSkgewogICAgICAgIHByb3BlcnRpZXMuZGVmYXVsdEVuY29kaW5nID0gKDAsIF9lbmNvZGluZ3MuZ2V0RW5jb2RpbmcpKGJhc2VFbmNvZGluZ05hbWUpLnNsaWNlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGlzU3ltYm9saWNGb250ID0gISEocHJvcGVydGllcy5mbGFncyAmIF9mb250cy5Gb250RmxhZ3MuU3ltYm9saWMpOwogICAgICAgIHZhciBpc05vbnN5bWJvbGljRm9udCA9ICEhKHByb3BlcnRpZXMuZmxhZ3MgJiBfZm9udHMuRm9udEZsYWdzLk5vbnN5bWJvbGljKTsKICAgICAgICBlbmNvZGluZyA9IF9lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZzsKCiAgICAgICAgaWYgKHByb3BlcnRpZXMudHlwZSA9PT0gIlRydWVUeXBlIiAmJiAhaXNOb25zeW1ib2xpY0ZvbnQpIHsKICAgICAgICAgIGVuY29kaW5nID0gX2VuY29kaW5ncy5XaW5BbnNpRW5jb2Rpbmc7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXNTeW1ib2xpY0ZvbnQpIHsKICAgICAgICAgIGVuY29kaW5nID0gX2VuY29kaW5ncy5NYWNSb21hbkVuY29kaW5nOwoKICAgICAgICAgIGlmICghcHJvcGVydGllcy5maWxlKSB7CiAgICAgICAgICAgIGlmICgvU3ltYm9sL2kudGVzdChwcm9wZXJ0aWVzLm5hbWUpKSB7CiAgICAgICAgICAgICAgZW5jb2RpbmcgPSBfZW5jb2RpbmdzLlN5bWJvbFNldEVuY29kaW5nOwogICAgICAgICAgICB9IGVsc2UgaWYgKC9EaW5nYmF0c3xXaW5nZGluZ3MvaS50ZXN0KHByb3BlcnRpZXMubmFtZSkpIHsKICAgICAgICAgICAgICBlbmNvZGluZyA9IF9lbmNvZGluZ3MuWmFwZkRpbmdiYXRzRW5jb2Rpbmc7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByb3BlcnRpZXMuZGVmYXVsdEVuY29kaW5nID0gZW5jb2Rpbmc7CiAgICAgIH0KCiAgICAgIHByb3BlcnRpZXMuZGlmZmVyZW5jZXMgPSBkaWZmZXJlbmNlczsKICAgICAgcHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lID0gYmFzZUVuY29kaW5nTmFtZTsKICAgICAgcHJvcGVydGllcy5oYXNFbmNvZGluZyA9ICEhYmFzZUVuY29kaW5nTmFtZSB8fCBkaWZmZXJlbmNlcy5sZW5ndGggPiAwOwogICAgICBwcm9wZXJ0aWVzLmRpY3QgPSBkaWN0OwogICAgICByZXR1cm4gdG9Vbmljb2RlUHJvbWlzZS50aGVuKGZ1bmN0aW9uIChyZWFkVG9Vbmljb2RlKSB7CiAgICAgICAgcHJvcGVydGllcy50b1VuaWNvZGUgPSByZWFkVG9Vbmljb2RlOwogICAgICAgIHJldHVybiBfdGhpczEyLmJ1aWxkVG9Vbmljb2RlKHByb3BlcnRpZXMpOwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChidWlsdFRvVW5pY29kZSkgewogICAgICAgIHByb3BlcnRpZXMudG9Vbmljb2RlID0gYnVpbHRUb1VuaWNvZGU7CgogICAgICAgIGlmIChjaWRUb0dpZEJ5dGVzKSB7CiAgICAgICAgICBwcm9wZXJ0aWVzLmNpZFRvR2lkTWFwID0gX3RoaXMxMi5yZWFkQ2lkVG9HaWRNYXAoY2lkVG9HaWRCeXRlcywgYnVpbHRUb1VuaWNvZGUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHByb3BlcnRpZXM7CiAgICAgIH0pOwogICAgfSwKICAgIF9idWlsZFNpbXBsZUZvbnRUb1VuaWNvZGU6IGZ1bmN0aW9uIF9idWlsZFNpbXBsZUZvbnRUb1VuaWNvZGUocHJvcGVydGllcykgewogICAgICB2YXIgZm9yY2VHbHlwaHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICAoMCwgX3V0aWwuYXNzZXJ0KSghcHJvcGVydGllcy5jb21wb3NpdGUsICJNdXN0IGJlIGEgc2ltcGxlIGZvbnQuIik7CiAgICAgIHZhciB0b1VuaWNvZGUgPSBbXTsKICAgICAgdmFyIGVuY29kaW5nID0gcHJvcGVydGllcy5kZWZhdWx0RW5jb2Rpbmcuc2xpY2UoKTsKICAgICAgdmFyIGJhc2VFbmNvZGluZ05hbWUgPSBwcm9wZXJ0aWVzLmJhc2VFbmNvZGluZ05hbWU7CiAgICAgIHZhciBkaWZmZXJlbmNlcyA9IHByb3BlcnRpZXMuZGlmZmVyZW5jZXM7CgogICAgICBmb3IgKHZhciBjaGFyY29kZSBpbiBkaWZmZXJlbmNlcykgewogICAgICAgIHZhciBnbHlwaE5hbWUgPSBkaWZmZXJlbmNlc1tjaGFyY29kZV07CgogICAgICAgIGlmIChnbHlwaE5hbWUgPT09ICIubm90ZGVmIikgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBlbmNvZGluZ1tjaGFyY29kZV0gPSBnbHlwaE5hbWU7CiAgICAgIH0KCiAgICAgIHZhciBnbHlwaHNVbmljb2RlTWFwID0gKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKCiAgICAgIGZvciAodmFyIF9jaGFyY29kZSBpbiBlbmNvZGluZykgewogICAgICAgIHZhciBfZ2x5cGhOYW1lID0gZW5jb2RpbmdbX2NoYXJjb2RlXTsKCiAgICAgICAgaWYgKF9nbHlwaE5hbWUgPT09ICIiKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IGVsc2UgaWYgKGdseXBoc1VuaWNvZGVNYXBbX2dseXBoTmFtZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdmFyIGNvZGUgPSAwOwoKICAgICAgICAgIHN3aXRjaCAoX2dseXBoTmFtZVswXSkgewogICAgICAgICAgICBjYXNlICJHIjoKICAgICAgICAgICAgICBpZiAoX2dseXBoTmFtZS5sZW5ndGggPT09IDMpIHsKICAgICAgICAgICAgICAgIGNvZGUgPSBwYXJzZUludChfZ2x5cGhOYW1lLnN1YnN0cmluZygxKSwgMTYpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICJnIjoKICAgICAgICAgICAgICBpZiAoX2dseXBoTmFtZS5sZW5ndGggPT09IDUpIHsKICAgICAgICAgICAgICAgIGNvZGUgPSBwYXJzZUludChfZ2x5cGhOYW1lLnN1YnN0cmluZygxKSwgMTYpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICJDIjoKICAgICAgICAgICAgY2FzZSAiYyI6CiAgICAgICAgICAgICAgaWYgKF9nbHlwaE5hbWUubGVuZ3RoID49IDMgJiYgX2dseXBoTmFtZS5sZW5ndGggPD0gNCkgewogICAgICAgICAgICAgICAgdmFyIGNvZGVTdHIgPSBfZ2x5cGhOYW1lLnN1YnN0cmluZygxKTsKCiAgICAgICAgICAgICAgICBpZiAoZm9yY2VHbHlwaHMpIHsKICAgICAgICAgICAgICAgICAgY29kZSA9IHBhcnNlSW50KGNvZGVTdHIsIDE2KTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29kZSA9ICtjb2RlU3RyOwoKICAgICAgICAgICAgICAgIGlmIChOdW1iZXIuaXNOYU4oY29kZSkgJiYgTnVtYmVyLmlzSW50ZWdlcihwYXJzZUludChjb2RlU3RyLCAxNikpKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9idWlsZFNpbXBsZUZvbnRUb1VuaWNvZGUocHJvcGVydGllcywgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdmFyIHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShfZ2x5cGhOYW1lLCBnbHlwaHNVbmljb2RlTWFwKTsKCiAgICAgICAgICAgICAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICAgICAgICAgICAgICBjb2RlID0gdW5pY29kZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjb2RlID4gMCAmJiBjb2RlIDw9IDB4MTBmZmZmICYmIE51bWJlci5pc0ludGVnZXIoY29kZSkpIHsKICAgICAgICAgICAgaWYgKGJhc2VFbmNvZGluZ05hbWUgJiYgY29kZSA9PT0gK19jaGFyY29kZSkgewogICAgICAgICAgICAgIHZhciBiYXNlRW5jb2RpbmcgPSAoMCwgX2VuY29kaW5ncy5nZXRFbmNvZGluZykoYmFzZUVuY29kaW5nTmFtZSk7CgogICAgICAgICAgICAgIGlmIChiYXNlRW5jb2RpbmcgJiYgKF9nbHlwaE5hbWUgPSBiYXNlRW5jb2RpbmdbX2NoYXJjb2RlXSkpIHsKICAgICAgICAgICAgICAgIHRvVW5pY29kZVtfY2hhcmNvZGVdID0gU3RyaW5nLmZyb21DaGFyQ29kZShnbHlwaHNVbmljb2RlTWFwW19nbHlwaE5hbWVdKTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdG9Vbmljb2RlW19jaGFyY29kZV0gPSBTdHJpbmcuZnJvbUNvZGVQb2ludChjb2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHRvVW5pY29kZVtfY2hhcmNvZGVdID0gU3RyaW5nLmZyb21DaGFyQ29kZShnbHlwaHNVbmljb2RlTWFwW19nbHlwaE5hbWVdKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBfZm9udHMuVG9Vbmljb2RlTWFwKHRvVW5pY29kZSk7CiAgICB9LAogICAgYnVpbGRUb1VuaWNvZGU6IGZ1bmN0aW9uIGJ1aWxkVG9Vbmljb2RlKHByb3BlcnRpZXMpIHsKICAgICAgcHJvcGVydGllcy5oYXNJbmNsdWRlZFRvVW5pY29kZU1hcCA9ICEhcHJvcGVydGllcy50b1VuaWNvZGUgJiYgcHJvcGVydGllcy50b1VuaWNvZGUubGVuZ3RoID4gMDsKCiAgICAgIGlmIChwcm9wZXJ0aWVzLmhhc0luY2x1ZGVkVG9Vbmljb2RlTWFwKSB7CiAgICAgICAgaWYgKCFwcm9wZXJ0aWVzLmNvbXBvc2l0ZSAmJiBwcm9wZXJ0aWVzLmhhc0VuY29kaW5nKSB7CiAgICAgICAgICBwcm9wZXJ0aWVzLmZhbGxiYWNrVG9Vbmljb2RlID0gdGhpcy5fYnVpbGRTaW1wbGVGb250VG9Vbmljb2RlKHByb3BlcnRpZXMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShwcm9wZXJ0aWVzLnRvVW5pY29kZSk7CiAgICAgIH0KCiAgICAgIGlmICghcHJvcGVydGllcy5jb21wb3NpdGUpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2J1aWxkU2ltcGxlRm9udFRvVW5pY29kZShwcm9wZXJ0aWVzKSk7CiAgICAgIH0KCiAgICAgIGlmIChwcm9wZXJ0aWVzLmNvbXBvc2l0ZSAmJiAocHJvcGVydGllcy5jTWFwLmJ1aWx0SW5DTWFwICYmICEocHJvcGVydGllcy5jTWFwIGluc3RhbmNlb2YgX2NtYXAuSWRlbnRpdHlDTWFwKSB8fCBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm8ucmVnaXN0cnkgPT09ICJBZG9iZSIgJiYgKHByb3BlcnRpZXMuY2lkU3lzdGVtSW5mby5vcmRlcmluZyA9PT0gIkdCMSIgfHwgcHJvcGVydGllcy5jaWRTeXN0ZW1JbmZvLm9yZGVyaW5nID09PSAiQ05TMSIgfHwgcHJvcGVydGllcy5jaWRTeXN0ZW1JbmZvLm9yZGVyaW5nID09PSAiSmFwYW4xIiB8fCBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm8ub3JkZXJpbmcgPT09ICJLb3JlYTEiKSkpIHsKICAgICAgICB2YXIgcmVnaXN0cnkgPSBwcm9wZXJ0aWVzLmNpZFN5c3RlbUluZm8ucmVnaXN0cnk7CiAgICAgICAgdmFyIG9yZGVyaW5nID0gcHJvcGVydGllcy5jaWRTeXN0ZW1JbmZvLm9yZGVyaW5nOwoKICAgICAgICB2YXIgdWNzMkNNYXBOYW1lID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQocmVnaXN0cnkgKyAiLSIgKyBvcmRlcmluZyArICItVUNTMiIpOwoKICAgICAgICByZXR1cm4gX2NtYXAuQ01hcEZhY3RvcnkuY3JlYXRlKHsKICAgICAgICAgIGVuY29kaW5nOiB1Y3MyQ01hcE5hbWUsCiAgICAgICAgICBmZXRjaEJ1aWx0SW5DTWFwOiB0aGlzLmZldGNoQnVpbHRJbkNNYXAsCiAgICAgICAgICB1c2VDTWFwOiBudWxsCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAodWNzMkNNYXApIHsKICAgICAgICAgIHZhciBjTWFwID0gcHJvcGVydGllcy5jTWFwOwogICAgICAgICAgdmFyIHRvVW5pY29kZSA9IFtdOwogICAgICAgICAgY01hcC5mb3JFYWNoKGZ1bmN0aW9uIChjaGFyY29kZSwgY2lkKSB7CiAgICAgICAgICAgIGlmIChjaWQgPiAweGZmZmYpIHsKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk1heCBzaXplIG9mIENJRCBpcyA2NSw1MzUiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHVjczIgPSB1Y3MyQ01hcC5sb29rdXAoY2lkKTsKCiAgICAgICAgICAgIGlmICh1Y3MyKSB7CiAgICAgICAgICAgICAgdG9Vbmljb2RlW2NoYXJjb2RlXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKHVjczIuY2hhckNvZGVBdCgwKSA8PCA4KSArIHVjczIuY2hhckNvZGVBdCgxKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIG5ldyBfZm9udHMuVG9Vbmljb2RlTWFwKHRvVW5pY29kZSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IF9mb250cy5JZGVudGl0eVRvVW5pY29kZU1hcChwcm9wZXJ0aWVzLmZpcnN0Q2hhciwgcHJvcGVydGllcy5sYXN0Q2hhcikpOwogICAgfSwKICAgIHJlYWRUb1VuaWNvZGU6IGZ1bmN0aW9uIFBhcnRpYWxFdmFsdWF0b3JfcmVhZFRvVW5pY29kZSh0b1VuaWNvZGUpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgdmFyIGNtYXBPYmogPSB0b1VuaWNvZGU7CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoY21hcE9iaikpIHsKICAgICAgICByZXR1cm4gX2NtYXAuQ01hcEZhY3RvcnkuY3JlYXRlKHsKICAgICAgICAgIGVuY29kaW5nOiBjbWFwT2JqLAogICAgICAgICAgZmV0Y2hCdWlsdEluQ01hcDogdGhpcy5mZXRjaEJ1aWx0SW5DTWFwLAogICAgICAgICAgdXNlQ01hcDogbnVsbAogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNtYXApIHsKICAgICAgICAgIGlmIChjbWFwIGluc3RhbmNlb2YgX2NtYXAuSWRlbnRpdHlDTWFwKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgX2ZvbnRzLklkZW50aXR5VG9Vbmljb2RlTWFwKDAsIDB4ZmZmZik7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIG5ldyBfZm9udHMuVG9Vbmljb2RlTWFwKGNtYXAuZ2V0TWFwKCkpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkoY21hcE9iaikpIHsKICAgICAgICByZXR1cm4gX2NtYXAuQ01hcEZhY3RvcnkuY3JlYXRlKHsKICAgICAgICAgIGVuY29kaW5nOiBjbWFwT2JqLAogICAgICAgICAgZmV0Y2hCdWlsdEluQ01hcDogdGhpcy5mZXRjaEJ1aWx0SW5DTWFwLAogICAgICAgICAgdXNlQ01hcDogbnVsbAogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNtYXApIHsKICAgICAgICAgIGlmIChjbWFwIGluc3RhbmNlb2YgX2NtYXAuSWRlbnRpdHlDTWFwKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgX2ZvbnRzLklkZW50aXR5VG9Vbmljb2RlTWFwKDAsIDB4ZmZmZik7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG1hcCA9IG5ldyBBcnJheShjbWFwLmxlbmd0aCk7CiAgICAgICAgICBjbWFwLmZvckVhY2goZnVuY3Rpb24gKGNoYXJDb2RlLCB0b2tlbikgewogICAgICAgICAgICB2YXIgc3RyID0gW107CgogICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHRva2VuLmxlbmd0aDsgayArPSAyKSB7CiAgICAgICAgICAgICAgdmFyIHcxID0gdG9rZW4uY2hhckNvZGVBdChrKSA8PCA4IHwgdG9rZW4uY2hhckNvZGVBdChrICsgMSk7CgogICAgICAgICAgICAgIGlmICgodzEgJiAweGY4MDApICE9PSAweGQ4MDApIHsKICAgICAgICAgICAgICAgIHN0ci5wdXNoKHcxKTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgayArPSAyOwogICAgICAgICAgICAgIHZhciB3MiA9IHRva2VuLmNoYXJDb2RlQXQoaykgPDwgOCB8IHRva2VuLmNoYXJDb2RlQXQoayArIDEpOwogICAgICAgICAgICAgIHN0ci5wdXNoKCgodzEgJiAweDNmZikgPDwgMTApICsgKHcyICYgMHgzZmYpICsgMHgxMDAwMCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1hcFtjaGFyQ29kZV0gPSBTdHJpbmcuZnJvbUNvZGVQb2ludC5hcHBseShTdHJpbmcsIHN0cik7CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBuZXcgX2ZvbnRzLlRvVW5pY29kZU1hcChtYXApOwogICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgIGlmIChyZWFzb24gaW5zdGFuY2VvZiBfdXRpbC5BYm9ydEV4Y2VwdGlvbikgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoX3RoaXMxMy5vcHRpb25zLmlnbm9yZUVycm9ycykgewogICAgICAgICAgICBfdGhpczEzLmhhbmRsZXIuc2VuZCgiVW5zdXBwb3J0ZWRGZWF0dXJlIiwgewogICAgICAgICAgICAgIGZlYXR1cmVJZDogX3V0aWwuVU5TVVBQT1JURURfRkVBVFVSRVMuZXJyb3JGb250VG9Vbmljb2RlCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJyZWFkVG9Vbmljb2RlIC0gaWdub3JpbmcgVG9Vbmljb2RlIGRhdGE6IFwiIi5jb25jYXQocmVhc29uLCAiXCIuIikpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KCiAgICAgICAgICB0aHJvdyByZWFzb247CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7CiAgICB9LAogICAgcmVhZENpZFRvR2lkTWFwOiBmdW5jdGlvbiByZWFkQ2lkVG9HaWRNYXAoZ2x5cGhzRGF0YSwgdG9Vbmljb2RlKSB7CiAgICAgIHZhciByZXN1bHQgPSBbXTsKCiAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IGdseXBoc0RhdGEubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgIHZhciBnbHlwaElEID0gZ2x5cGhzRGF0YVtqKytdIDw8IDggfCBnbHlwaHNEYXRhW2pdOwogICAgICAgIHZhciBjb2RlID0gaiA+PiAxOwoKICAgICAgICBpZiAoZ2x5cGhJRCA9PT0gMCAmJiAhdG9Vbmljb2RlLmhhcyhjb2RlKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICByZXN1bHRbY29kZV0gPSBnbHlwaElEOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIGV4dHJhY3RXaWR0aHM6IGZ1bmN0aW9uIFBhcnRpYWxFdmFsdWF0b3JfZXh0cmFjdFdpZHRocyhkaWN0LCBkZXNjcmlwdG9yLCBwcm9wZXJ0aWVzKSB7CiAgICAgIHZhciB4cmVmID0gdGhpcy54cmVmOwogICAgICB2YXIgZ2x5cGhzV2lkdGhzID0gW107CiAgICAgIHZhciBkZWZhdWx0V2lkdGggPSAwOwogICAgICB2YXIgZ2x5cGhzVk1ldHJpY3MgPSBbXTsKICAgICAgdmFyIGRlZmF1bHRWTWV0cmljczsKICAgICAgdmFyIGksIGlpLCBqLCBqaiwgc3RhcnQsIGNvZGUsIHdpZHRoczsKCiAgICAgIGlmIChwcm9wZXJ0aWVzLmNvbXBvc2l0ZSkgewogICAgICAgIGRlZmF1bHRXaWR0aCA9IGRpY3QuaGFzKCJEVyIpID8gZGljdC5nZXQoIkRXIikgOiAxMDAwOwogICAgICAgIHdpZHRocyA9IGRpY3QuZ2V0KCJXIik7CgogICAgICAgIGlmICh3aWR0aHMpIHsKICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gd2lkdGhzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgICAgc3RhcnQgPSB4cmVmLmZldGNoSWZSZWYod2lkdGhzW2krK10pOwogICAgICAgICAgICBjb2RlID0geHJlZi5mZXRjaElmUmVmKHdpZHRoc1tpXSk7CgogICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2RlKSkgewogICAgICAgICAgICAgIGZvciAoaiA9IDAsIGpqID0gY29kZS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICAgICAgICBnbHlwaHNXaWR0aHNbc3RhcnQrK10gPSB4cmVmLmZldGNoSWZSZWYoY29kZVtqXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhciB3aWR0aCA9IHhyZWYuZmV0Y2hJZlJlZih3aWR0aHNbKytpXSk7CgogICAgICAgICAgICAgIGZvciAoaiA9IHN0YXJ0OyBqIDw9IGNvZGU7IGorKykgewogICAgICAgICAgICAgICAgZ2x5cGhzV2lkdGhzW2pdID0gd2lkdGg7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocHJvcGVydGllcy52ZXJ0aWNhbCkgewogICAgICAgICAgdmFyIHZtZXRyaWNzID0gZGljdC5nZXRBcnJheSgiRFcyIikgfHwgWzg4MCwgLTEwMDBdOwogICAgICAgICAgZGVmYXVsdFZNZXRyaWNzID0gW3ZtZXRyaWNzWzFdLCBkZWZhdWx0V2lkdGggKiAwLjUsIHZtZXRyaWNzWzBdXTsKICAgICAgICAgIHZtZXRyaWNzID0gZGljdC5nZXQoIlcyIik7CgogICAgICAgICAgaWYgKHZtZXRyaWNzKSB7CiAgICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gdm1ldHJpY3MubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICAgIHN0YXJ0ID0geHJlZi5mZXRjaElmUmVmKHZtZXRyaWNzW2krK10pOwogICAgICAgICAgICAgIGNvZGUgPSB4cmVmLmZldGNoSWZSZWYodm1ldHJpY3NbaV0pOwoKICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjb2RlKSkgewogICAgICAgICAgICAgICAgZm9yIChqID0gMCwgamogPSBjb2RlLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICAgICAgICAgICAgZ2x5cGhzVk1ldHJpY3Nbc3RhcnQrK10gPSBbeHJlZi5mZXRjaElmUmVmKGNvZGVbaisrXSksIHhyZWYuZmV0Y2hJZlJlZihjb2RlW2orK10pLCB4cmVmLmZldGNoSWZSZWYoY29kZVtqXSldOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgdm1ldHJpYyA9IFt4cmVmLmZldGNoSWZSZWYodm1ldHJpY3NbKytpXSksIHhyZWYuZmV0Y2hJZlJlZih2bWV0cmljc1srK2ldKSwgeHJlZi5mZXRjaElmUmVmKHZtZXRyaWNzWysraV0pXTsKCiAgICAgICAgICAgICAgICBmb3IgKGogPSBzdGFydDsgaiA8PSBjb2RlOyBqKyspIHsKICAgICAgICAgICAgICAgICAgZ2x5cGhzVk1ldHJpY3Nbal0gPSB2bWV0cmljOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgZmlyc3RDaGFyID0gcHJvcGVydGllcy5maXJzdENoYXI7CiAgICAgICAgd2lkdGhzID0gZGljdC5nZXQoIldpZHRocyIpOwoKICAgICAgICBpZiAod2lkdGhzKSB7CiAgICAgICAgICBqID0gZmlyc3RDaGFyOwoKICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gd2lkdGhzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgICAgZ2x5cGhzV2lkdGhzW2orK10gPSB4cmVmLmZldGNoSWZSZWYod2lkdGhzW2ldKTsKICAgICAgICAgIH0KCiAgICAgICAgICBkZWZhdWx0V2lkdGggPSBwYXJzZUZsb2F0KGRlc2NyaXB0b3IuZ2V0KCJNaXNzaW5nV2lkdGgiKSkgfHwgMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGJhc2VGb250TmFtZSA9IGRpY3QuZ2V0KCJCYXNlRm9udCIpOwoKICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShiYXNlRm9udE5hbWUpKSB7CiAgICAgICAgICAgIHZhciBtZXRyaWNzID0gdGhpcy5nZXRCYXNlRm9udE1ldHJpY3MoYmFzZUZvbnROYW1lLm5hbWUpOwogICAgICAgICAgICBnbHlwaHNXaWR0aHMgPSB0aGlzLmJ1aWxkQ2hhckNvZGVUb1dpZHRoKG1ldHJpY3Mud2lkdGhzLCBwcm9wZXJ0aWVzKTsKICAgICAgICAgICAgZGVmYXVsdFdpZHRoID0gbWV0cmljcy5kZWZhdWx0V2lkdGg7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgaXNNb25vc3BhY2UgPSB0cnVlOwogICAgICB2YXIgZmlyc3RXaWR0aCA9IGRlZmF1bHRXaWR0aDsKCiAgICAgIGZvciAodmFyIGdseXBoIGluIGdseXBoc1dpZHRocykgewogICAgICAgIHZhciBnbHlwaFdpZHRoID0gZ2x5cGhzV2lkdGhzW2dseXBoXTsKCiAgICAgICAgaWYgKCFnbHlwaFdpZHRoKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmICghZmlyc3RXaWR0aCkgewogICAgICAgICAgZmlyc3RXaWR0aCA9IGdseXBoV2lkdGg7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGlmIChmaXJzdFdpZHRoICE9PSBnbHlwaFdpZHRoKSB7CiAgICAgICAgICBpc01vbm9zcGFjZSA9IGZhbHNlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoaXNNb25vc3BhY2UpIHsKICAgICAgICBwcm9wZXJ0aWVzLmZsYWdzIHw9IF9mb250cy5Gb250RmxhZ3MuRml4ZWRQaXRjaDsKICAgICAgfQoKICAgICAgcHJvcGVydGllcy5kZWZhdWx0V2lkdGggPSBkZWZhdWx0V2lkdGg7CiAgICAgIHByb3BlcnRpZXMud2lkdGhzID0gZ2x5cGhzV2lkdGhzOwogICAgICBwcm9wZXJ0aWVzLmRlZmF1bHRWTWV0cmljcyA9IGRlZmF1bHRWTWV0cmljczsKICAgICAgcHJvcGVydGllcy52bWV0cmljcyA9IGdseXBoc1ZNZXRyaWNzOwogICAgfSwKICAgIGlzU2VyaWZGb250OiBmdW5jdGlvbiBQYXJ0aWFsRXZhbHVhdG9yX2lzU2VyaWZGb250KGJhc2VGb250TmFtZSkgewogICAgICB2YXIgZm9udE5hbWVXb1N0eWxlID0gYmFzZUZvbnROYW1lLnNwbGl0KCItIilbMF07CiAgICAgIHJldHVybiBmb250TmFtZVdvU3R5bGUgaW4gKDAsIF9zdGFuZGFyZF9mb250cy5nZXRTZXJpZkZvbnRzKSgpIHx8IGZvbnROYW1lV29TdHlsZS5zZWFyY2goL3NlcmlmL2dpKSAhPT0gLTE7CiAgICB9LAogICAgZ2V0QmFzZUZvbnRNZXRyaWNzOiBmdW5jdGlvbiBQYXJ0aWFsRXZhbHVhdG9yX2dldEJhc2VGb250TWV0cmljcyhuYW1lKSB7CiAgICAgIHZhciBkZWZhdWx0V2lkdGggPSAwOwogICAgICB2YXIgd2lkdGhzID0gW107CiAgICAgIHZhciBtb25vc3BhY2UgPSBmYWxzZTsKICAgICAgdmFyIHN0ZEZvbnRNYXAgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldFN0ZEZvbnRNYXApKCk7CiAgICAgIHZhciBsb29rdXBOYW1lID0gc3RkRm9udE1hcFtuYW1lXSB8fCBuYW1lOwogICAgICB2YXIgTWV0cmljcyA9ICgwLCBfbWV0cmljcy5nZXRNZXRyaWNzKSgpOwoKICAgICAgaWYgKCEobG9va3VwTmFtZSBpbiBNZXRyaWNzKSkgewogICAgICAgIGlmICh0aGlzLmlzU2VyaWZGb250KG5hbWUpKSB7CiAgICAgICAgICBsb29rdXBOYW1lID0gIlRpbWVzLVJvbWFuIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbG9va3VwTmFtZSA9ICJIZWx2ZXRpY2EiOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGdseXBoV2lkdGhzID0gTWV0cmljc1tsb29rdXBOYW1lXTsKCiAgICAgIGlmICgoMCwgX3V0aWwuaXNOdW0pKGdseXBoV2lkdGhzKSkgewogICAgICAgIGRlZmF1bHRXaWR0aCA9IGdseXBoV2lkdGhzOwogICAgICAgIG1vbm9zcGFjZSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd2lkdGhzID0gZ2x5cGhXaWR0aHMoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBkZWZhdWx0V2lkdGg6IGRlZmF1bHRXaWR0aCwKICAgICAgICBtb25vc3BhY2U6IG1vbm9zcGFjZSwKICAgICAgICB3aWR0aHM6IHdpZHRocwogICAgICB9OwogICAgfSwKICAgIGJ1aWxkQ2hhckNvZGVUb1dpZHRoOiBmdW5jdGlvbiBQYXJ0aWFsRXZhbHVhdG9yX2J1bGlsZENoYXJDb2RlVG9XaWR0aCh3aWR0aHNCeUdseXBoTmFtZSwgcHJvcGVydGllcykgewogICAgICB2YXIgd2lkdGhzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgdmFyIGRpZmZlcmVuY2VzID0gcHJvcGVydGllcy5kaWZmZXJlbmNlczsKICAgICAgdmFyIGVuY29kaW5nID0gcHJvcGVydGllcy5kZWZhdWx0RW5jb2Rpbmc7CgogICAgICBmb3IgKHZhciBjaGFyQ29kZSA9IDA7IGNoYXJDb2RlIDwgMjU2OyBjaGFyQ29kZSsrKSB7CiAgICAgICAgaWYgKGNoYXJDb2RlIGluIGRpZmZlcmVuY2VzICYmIHdpZHRoc0J5R2x5cGhOYW1lW2RpZmZlcmVuY2VzW2NoYXJDb2RlXV0pIHsKICAgICAgICAgIHdpZHRoc1tjaGFyQ29kZV0gPSB3aWR0aHNCeUdseXBoTmFtZVtkaWZmZXJlbmNlc1tjaGFyQ29kZV1dOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoY2hhckNvZGUgaW4gZW5jb2RpbmcgJiYgd2lkdGhzQnlHbHlwaE5hbWVbZW5jb2RpbmdbY2hhckNvZGVdXSkgewogICAgICAgICAgd2lkdGhzW2NoYXJDb2RlXSA9IHdpZHRoc0J5R2x5cGhOYW1lW2VuY29kaW5nW2NoYXJDb2RlXV07CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB3aWR0aHM7CiAgICB9LAogICAgcHJlRXZhbHVhdGVGb250OiBmdW5jdGlvbiBQYXJ0aWFsRXZhbHVhdG9yX3ByZUV2YWx1YXRlRm9udChkaWN0KSB7CiAgICAgIHZhciBiYXNlRGljdCA9IGRpY3Q7CiAgICAgIHZhciB0eXBlID0gZGljdC5nZXQoIlN1YnR5cGUiKTsKCiAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodHlwZSkpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoImludmFsaWQgZm9udCBTdWJ0eXBlIik7CiAgICAgIH0KCiAgICAgIHZhciBjb21wb3NpdGUgPSBmYWxzZTsKICAgICAgdmFyIHVpbnQ4YXJyYXk7CgogICAgICBpZiAodHlwZS5uYW1lID09PSAiVHlwZTAiKSB7CiAgICAgICAgdmFyIGRmID0gZGljdC5nZXQoIkRlc2NlbmRhbnRGb250cyIpOwoKICAgICAgICBpZiAoIWRmKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkRlc2NlbmRhbnQgZm9udHMgYXJlIG5vdCBzcGVjaWZpZWQiKTsKICAgICAgICB9CgogICAgICAgIGRpY3QgPSBBcnJheS5pc0FycmF5KGRmKSA/IHRoaXMueHJlZi5mZXRjaElmUmVmKGRmWzBdKSA6IGRmOwogICAgICAgIHR5cGUgPSBkaWN0LmdldCgiU3VidHlwZSIpOwoKICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKHR5cGUpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoImludmFsaWQgZm9udCBTdWJ0eXBlIik7CiAgICAgICAgfQoKICAgICAgICBjb21wb3NpdGUgPSB0cnVlOwogICAgICB9CgogICAgICB2YXIgZGVzY3JpcHRvciA9IGRpY3QuZ2V0KCJGb250RGVzY3JpcHRvciIpOwoKICAgICAgaWYgKGRlc2NyaXB0b3IpIHsKICAgICAgICB2YXIgaGFzaCA9IG5ldyBfbXVybXVyaGFzaC5NdXJtdXJIYXNoM182NCgpOwogICAgICAgIHZhciBlbmNvZGluZyA9IGJhc2VEaWN0LmdldFJhdygiRW5jb2RpbmciKTsKCiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGVuY29kaW5nKSkgewogICAgICAgICAgaGFzaC51cGRhdGUoZW5jb2RpbmcubmFtZSk7CiAgICAgICAgfSBlbHNlIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNSZWYpKGVuY29kaW5nKSkgewogICAgICAgICAgaGFzaC51cGRhdGUoZW5jb2RpbmcudG9TdHJpbmcoKSk7CiAgICAgICAgfSBlbHNlIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KShlbmNvZGluZykpIHsKICAgICAgICAgIHZhciBrZXlzID0gZW5jb2RpbmcuZ2V0S2V5cygpOwoKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGtleXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgICB2YXIgZW50cnkgPSBlbmNvZGluZy5nZXRSYXcoa2V5c1tpXSk7CgogICAgICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoZW50cnkpKSB7CiAgICAgICAgICAgICAgaGFzaC51cGRhdGUoZW50cnkubmFtZSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoKDAsIF9wcmltaXRpdmVzLmlzUmVmKShlbnRyeSkpIHsKICAgICAgICAgICAgICBoYXNoLnVwZGF0ZShlbnRyeS50b1N0cmluZygpKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGVudHJ5KSkgewogICAgICAgICAgICAgIHZhciBkaWZmTGVuZ3RoID0gZW50cnkubGVuZ3RoLAogICAgICAgICAgICAgICAgICBkaWZmQnVmID0gbmV3IEFycmF5KGRpZmZMZW5ndGgpOwoKICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRpZmZMZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgdmFyIGRpZmZFbnRyeSA9IGVudHJ5W2pdOwoKICAgICAgICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShkaWZmRW50cnkpKSB7CiAgICAgICAgICAgICAgICAgIGRpZmZCdWZbal0gPSBkaWZmRW50cnkubmFtZTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKDAsIF91dGlsLmlzTnVtKShkaWZmRW50cnkpIHx8ICgwLCBfcHJpbWl0aXZlcy5pc1JlZikoZGlmZkVudHJ5KSkgewogICAgICAgICAgICAgICAgICBkaWZmQnVmW2pdID0gZGlmZkVudHJ5LnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBoYXNoLnVwZGF0ZShkaWZmQnVmLmpvaW4oKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciBmaXJzdENoYXIgPSBkaWN0LmdldCgiRmlyc3RDaGFyIikgfHwgMDsKICAgICAgICB2YXIgbGFzdENoYXIgPSBkaWN0LmdldCgiTGFzdENoYXIiKSB8fCAoY29tcG9zaXRlID8gMHhmZmZmIDogMHhmZik7CiAgICAgICAgaGFzaC51cGRhdGUoIiIuY29uY2F0KGZpcnN0Q2hhciwgIi0iKS5jb25jYXQobGFzdENoYXIpKTsKICAgICAgICB2YXIgdG9Vbmljb2RlID0gZGljdC5nZXQoIlRvVW5pY29kZSIpIHx8IGJhc2VEaWN0LmdldCgiVG9Vbmljb2RlIik7CgogICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKHRvVW5pY29kZSkpIHsKICAgICAgICAgIHZhciBzdHJlYW0gPSB0b1VuaWNvZGUuc3RyIHx8IHRvVW5pY29kZTsKICAgICAgICAgIHVpbnQ4YXJyYXkgPSBzdHJlYW0uYnVmZmVyID8gbmV3IFVpbnQ4QXJyYXkoc3RyZWFtLmJ1ZmZlci5idWZmZXIsIDAsIHN0cmVhbS5idWZmZXJMZW5ndGgpIDogbmV3IFVpbnQ4QXJyYXkoc3RyZWFtLmJ5dGVzLmJ1ZmZlciwgc3RyZWFtLnN0YXJ0LCBzdHJlYW0uZW5kIC0gc3RyZWFtLnN0YXJ0KTsKICAgICAgICAgIGhhc2gudXBkYXRlKHVpbnQ4YXJyYXkpOwogICAgICAgIH0gZWxzZSBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkodG9Vbmljb2RlKSkgewogICAgICAgICAgaGFzaC51cGRhdGUodG9Vbmljb2RlLm5hbWUpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHdpZHRocyA9IGRpY3QuZ2V0KCJXaWR0aHMiKSB8fCBiYXNlRGljdC5nZXQoIldpZHRocyIpOwoKICAgICAgICBpZiAod2lkdGhzKSB7CiAgICAgICAgICB1aW50OGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3IFVpbnQzMkFycmF5KHdpZHRocykuYnVmZmVyKTsKICAgICAgICAgIGhhc2gudXBkYXRlKHVpbnQ4YXJyYXkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBkZXNjcmlwdG9yOiBkZXNjcmlwdG9yLAogICAgICAgIGRpY3Q6IGRpY3QsCiAgICAgICAgYmFzZURpY3Q6IGJhc2VEaWN0LAogICAgICAgIGNvbXBvc2l0ZTogY29tcG9zaXRlLAogICAgICAgIHR5cGU6IHR5cGUubmFtZSwKICAgICAgICBoYXNoOiBoYXNoID8gaGFzaC5oZXhkaWdlc3QoKSA6ICIiCiAgICAgIH07CiAgICB9LAogICAgdHJhbnNsYXRlRm9udDogZnVuY3Rpb24gUGFydGlhbEV2YWx1YXRvcl90cmFuc2xhdGVGb250KHByZUV2YWx1YXRlZEZvbnQpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgICAgdmFyIGJhc2VEaWN0ID0gcHJlRXZhbHVhdGVkRm9udC5iYXNlRGljdDsKICAgICAgdmFyIGRpY3QgPSBwcmVFdmFsdWF0ZWRGb250LmRpY3Q7CiAgICAgIHZhciBjb21wb3NpdGUgPSBwcmVFdmFsdWF0ZWRGb250LmNvbXBvc2l0ZTsKICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcmVFdmFsdWF0ZWRGb250LmRlc2NyaXB0b3I7CiAgICAgIHZhciB0eXBlID0gcHJlRXZhbHVhdGVkRm9udC50eXBlOwogICAgICB2YXIgbWF4Q2hhckluZGV4ID0gY29tcG9zaXRlID8gMHhmZmZmIDogMHhmZjsKICAgICAgdmFyIHByb3BlcnRpZXM7CiAgICAgIHZhciBmaXJzdENoYXIgPSBkaWN0LmdldCgiRmlyc3RDaGFyIikgfHwgMDsKICAgICAgdmFyIGxhc3RDaGFyID0gZGljdC5nZXQoIkxhc3RDaGFyIikgfHwgbWF4Q2hhckluZGV4OwoKICAgICAgaWYgKCFkZXNjcmlwdG9yKSB7CiAgICAgICAgaWYgKHR5cGUgPT09ICJUeXBlMyIpIHsKICAgICAgICAgIGRlc2NyaXB0b3IgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdChudWxsKTsKICAgICAgICAgIGRlc2NyaXB0b3Iuc2V0KCJGb250TmFtZSIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KHR5cGUpKTsKICAgICAgICAgIGRlc2NyaXB0b3Iuc2V0KCJGb250QkJveCIsIGRpY3QuZ2V0QXJyYXkoIkZvbnRCQm94IikgfHwgWzAsIDAsIDAsIDBdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGJhc2VGb250TmFtZSA9IGRpY3QuZ2V0KCJCYXNlRm9udCIpOwoKICAgICAgICAgIGlmICghKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoYmFzZUZvbnROYW1lKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkJhc2UgZm9udCBpcyBub3Qgc3BlY2lmaWVkIik7CiAgICAgICAgICB9CgogICAgICAgICAgYmFzZUZvbnROYW1lID0gYmFzZUZvbnROYW1lLm5hbWUucmVwbGFjZSgvWyxfXS9nLCAiLSIpOwogICAgICAgICAgdmFyIG1ldHJpY3MgPSB0aGlzLmdldEJhc2VGb250TWV0cmljcyhiYXNlRm9udE5hbWUpOwogICAgICAgICAgdmFyIGZvbnROYW1lV29TdHlsZSA9IGJhc2VGb250TmFtZS5zcGxpdCgiLSIpWzBdOwogICAgICAgICAgdmFyIGZsYWdzID0gKHRoaXMuaXNTZXJpZkZvbnQoZm9udE5hbWVXb1N0eWxlKSA/IF9mb250cy5Gb250RmxhZ3MuU2VyaWYgOiAwKSB8IChtZXRyaWNzLm1vbm9zcGFjZSA/IF9mb250cy5Gb250RmxhZ3MuRml4ZWRQaXRjaCA6IDApIHwgKCgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3ltYm9sc0ZvbnRzKSgpW2ZvbnROYW1lV29TdHlsZV0gPyBfZm9udHMuRm9udEZsYWdzLlN5bWJvbGljIDogX2ZvbnRzLkZvbnRGbGFncy5Ob25zeW1ib2xpYyk7CiAgICAgICAgICBwcm9wZXJ0aWVzID0gewogICAgICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgICAgICBuYW1lOiBiYXNlRm9udE5hbWUsCiAgICAgICAgICAgIHdpZHRoczogbWV0cmljcy53aWR0aHMsCiAgICAgICAgICAgIGRlZmF1bHRXaWR0aDogbWV0cmljcy5kZWZhdWx0V2lkdGgsCiAgICAgICAgICAgIGZsYWdzOiBmbGFncywKICAgICAgICAgICAgZmlyc3RDaGFyOiBmaXJzdENoYXIsCiAgICAgICAgICAgIGxhc3RDaGFyOiBsYXN0Q2hhcgogICAgICAgICAgfTsKICAgICAgICAgIHZhciB3aWR0aHMgPSBkaWN0LmdldCgiV2lkdGhzIik7CiAgICAgICAgICByZXR1cm4gdGhpcy5leHRyYWN0RGF0YVN0cnVjdHVyZXMoZGljdCwgZGljdCwgcHJvcGVydGllcykudGhlbihmdW5jdGlvbiAobmV3UHJvcGVydGllcykgewogICAgICAgICAgICBpZiAod2lkdGhzKSB7CiAgICAgICAgICAgICAgdmFyIGdseXBoV2lkdGhzID0gW107CiAgICAgICAgICAgICAgdmFyIGogPSBmaXJzdENoYXI7CgogICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHdpZHRocy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgICAgICBnbHlwaFdpZHRoc1tqKytdID0gX3RoaXMxNC54cmVmLmZldGNoSWZSZWYod2lkdGhzW2ldKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIG5ld1Byb3BlcnRpZXMud2lkdGhzID0gZ2x5cGhXaWR0aHM7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmV3UHJvcGVydGllcy53aWR0aHMgPSBfdGhpczE0LmJ1aWxkQ2hhckNvZGVUb1dpZHRoKG1ldHJpY3Mud2lkdGhzLCBuZXdQcm9wZXJ0aWVzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIG5ldyBfZm9udHMuRm9udChiYXNlRm9udE5hbWUsIG51bGwsIG5ld1Byb3BlcnRpZXMpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZm9udE5hbWUgPSBkZXNjcmlwdG9yLmdldCgiRm9udE5hbWUiKTsKICAgICAgdmFyIGJhc2VGb250ID0gZGljdC5nZXQoIkJhc2VGb250Iik7CgogICAgICBpZiAoKDAsIF91dGlsLmlzU3RyaW5nKShmb250TmFtZSkpIHsKICAgICAgICBmb250TmFtZSA9IF9wcmltaXRpdmVzLk5hbWUuZ2V0KGZvbnROYW1lKTsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfdXRpbC5pc1N0cmluZykoYmFzZUZvbnQpKSB7CiAgICAgICAgYmFzZUZvbnQgPSBfcHJpbWl0aXZlcy5OYW1lLmdldChiYXNlRm9udCk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlICE9PSAiVHlwZTMiKSB7CiAgICAgICAgdmFyIGZvbnROYW1lU3RyID0gZm9udE5hbWUgJiYgZm9udE5hbWUubmFtZTsKICAgICAgICB2YXIgYmFzZUZvbnRTdHIgPSBiYXNlRm9udCAmJiBiYXNlRm9udC5uYW1lOwoKICAgICAgICBpZiAoZm9udE5hbWVTdHIgIT09IGJhc2VGb250U3RyKSB7CiAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoIlRoZSBGb250RGVzY3JpcHRvcidzIEZvbnROYW1lIGlzIFwiIi5jb25jYXQoZm9udE5hbWVTdHIsICJcIiBidXQgIikgKyAic2hvdWxkIGJlIHRoZSBzYW1lIGFzIHRoZSBGb250J3MgQmFzZUZvbnQgXCIiLmNvbmNhdChiYXNlRm9udFN0ciwgIlwiLiIpKTsKCiAgICAgICAgICBpZiAoZm9udE5hbWVTdHIgJiYgYmFzZUZvbnRTdHIgJiYgYmFzZUZvbnRTdHIuc3RhcnRzV2l0aChmb250TmFtZVN0cikpIHsKICAgICAgICAgICAgZm9udE5hbWUgPSBiYXNlRm9udDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvbnROYW1lID0gZm9udE5hbWUgfHwgYmFzZUZvbnQ7CgogICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGZvbnROYW1lKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiaW52YWxpZCBmb250IG5hbWUiKTsKICAgICAgfQoKICAgICAgdmFyIGZvbnRGaWxlID0gZGVzY3JpcHRvci5nZXQoIkZvbnRGaWxlIiwgIkZvbnRGaWxlMiIsICJGb250RmlsZTMiKTsKCiAgICAgIGlmIChmb250RmlsZSkgewogICAgICAgIGlmIChmb250RmlsZS5kaWN0KSB7CiAgICAgICAgICB2YXIgc3VidHlwZSA9IGZvbnRGaWxlLmRpY3QuZ2V0KCJTdWJ0eXBlIik7CgogICAgICAgICAgaWYgKHN1YnR5cGUpIHsKICAgICAgICAgICAgc3VidHlwZSA9IHN1YnR5cGUubmFtZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgbGVuZ3RoMSA9IGZvbnRGaWxlLmRpY3QuZ2V0KCJMZW5ndGgxIik7CiAgICAgICAgICB2YXIgbGVuZ3RoMiA9IGZvbnRGaWxlLmRpY3QuZ2V0KCJMZW5ndGgyIik7CiAgICAgICAgICB2YXIgbGVuZ3RoMyA9IGZvbnRGaWxlLmRpY3QuZ2V0KCJMZW5ndGgzIik7CiAgICAgICAgfQogICAgICB9CgogICAgICBwcm9wZXJ0aWVzID0gewogICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgbmFtZTogZm9udE5hbWUubmFtZSwKICAgICAgICBzdWJ0eXBlOiBzdWJ0eXBlLAogICAgICAgIGZpbGU6IGZvbnRGaWxlLAogICAgICAgIGxlbmd0aDE6IGxlbmd0aDEsCiAgICAgICAgbGVuZ3RoMjogbGVuZ3RoMiwKICAgICAgICBsZW5ndGgzOiBsZW5ndGgzLAogICAgICAgIGxvYWRlZE5hbWU6IGJhc2VEaWN0LmxvYWRlZE5hbWUsCiAgICAgICAgY29tcG9zaXRlOiBjb21wb3NpdGUsCiAgICAgICAgZml4ZWRQaXRjaDogZmFsc2UsCiAgICAgICAgZm9udE1hdHJpeDogZGljdC5nZXRBcnJheSgiRm9udE1hdHJpeCIpIHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYLAogICAgICAgIGZpcnN0Q2hhcjogZmlyc3RDaGFyIHx8IDAsCiAgICAgICAgbGFzdENoYXI6IGxhc3RDaGFyIHx8IG1heENoYXJJbmRleCwKICAgICAgICBiYm94OiBkZXNjcmlwdG9yLmdldEFycmF5KCJGb250QkJveCIpLAogICAgICAgIGFzY2VudDogZGVzY3JpcHRvci5nZXQoIkFzY2VudCIpLAogICAgICAgIGRlc2NlbnQ6IGRlc2NyaXB0b3IuZ2V0KCJEZXNjZW50IiksCiAgICAgICAgeEhlaWdodDogZGVzY3JpcHRvci5nZXQoIlhIZWlnaHQiKSwKICAgICAgICBjYXBIZWlnaHQ6IGRlc2NyaXB0b3IuZ2V0KCJDYXBIZWlnaHQiKSwKICAgICAgICBmbGFnczogZGVzY3JpcHRvci5nZXQoIkZsYWdzIiksCiAgICAgICAgaXRhbGljQW5nbGU6IGRlc2NyaXB0b3IuZ2V0KCJJdGFsaWNBbmdsZSIpLAogICAgICAgIGlzVHlwZTNGb250OiBmYWxzZQogICAgICB9OwogICAgICB2YXIgY01hcFByb21pc2U7CgogICAgICBpZiAoY29tcG9zaXRlKSB7CiAgICAgICAgdmFyIGNpZEVuY29kaW5nID0gYmFzZURpY3QuZ2V0KCJFbmNvZGluZyIpOwoKICAgICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkoY2lkRW5jb2RpbmcpKSB7CiAgICAgICAgICBwcm9wZXJ0aWVzLmNpZEVuY29kaW5nID0gY2lkRW5jb2RpbmcubmFtZTsKICAgICAgICB9CgogICAgICAgIGNNYXBQcm9taXNlID0gX2NtYXAuQ01hcEZhY3RvcnkuY3JlYXRlKHsKICAgICAgICAgIGVuY29kaW5nOiBjaWRFbmNvZGluZywKICAgICAgICAgIGZldGNoQnVpbHRJbkNNYXA6IHRoaXMuZmV0Y2hCdWlsdEluQ01hcCwKICAgICAgICAgIHVzZUNNYXA6IG51bGwKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChjTWFwKSB7CiAgICAgICAgICBwcm9wZXJ0aWVzLmNNYXAgPSBjTWFwOwogICAgICAgICAgcHJvcGVydGllcy52ZXJ0aWNhbCA9IHByb3BlcnRpZXMuY01hcC52ZXJ0aWNhbDsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjTWFwUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpOwogICAgICB9CgogICAgICByZXR1cm4gY01hcFByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTQuZXh0cmFjdERhdGFTdHJ1Y3R1cmVzKGRpY3QsIGJhc2VEaWN0LCBwcm9wZXJ0aWVzKTsKICAgICAgfSkudGhlbihmdW5jdGlvbiAobmV3UHJvcGVydGllcykgewogICAgICAgIF90aGlzMTQuZXh0cmFjdFdpZHRocyhkaWN0LCBkZXNjcmlwdG9yLCBuZXdQcm9wZXJ0aWVzKTsKCiAgICAgICAgaWYgKHR5cGUgPT09ICJUeXBlMyIpIHsKICAgICAgICAgIG5ld1Byb3BlcnRpZXMuaXNUeXBlM0ZvbnQgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyBfZm9udHMuRm9udChmb250TmFtZS5uYW1lLCBmb250RmlsZSwgbmV3UHJvcGVydGllcyk7CiAgICAgIH0pOwogICAgfQogIH07CgogIFBhcnRpYWxFdmFsdWF0b3IuYnVpbGRGb250UGF0aHMgPSBmdW5jdGlvbiAoZm9udCwgZ2x5cGhzLCBoYW5kbGVyKSB7CiAgICBmdW5jdGlvbiBidWlsZFBhdGgoZm9udENoYXIpIHsKICAgICAgaWYgKGZvbnQucmVuZGVyZXIuaGFzQnVpbHRQYXRoKGZvbnRDaGFyKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaGFuZGxlci5zZW5kKCJjb21tb25vYmoiLCBbIiIuY29uY2F0KGZvbnQubG9hZGVkTmFtZSwgIl9wYXRoXyIpLmNvbmNhdChmb250Q2hhciksICJGb250UGF0aCIsIGZvbnQucmVuZGVyZXIuZ2V0UGF0aEpzKGZvbnRDaGFyKV0pOwogICAgfQoKICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihnbHlwaHMpLAogICAgICAgIF9zdGVwOwoKICAgIHRyeSB7CiAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgdmFyIGdseXBoID0gX3N0ZXAudmFsdWU7CiAgICAgICAgYnVpbGRQYXRoKGdseXBoLmZvbnRDaGFyKTsKICAgICAgICB2YXIgYWNjZW50ID0gZ2x5cGguYWNjZW50OwoKICAgICAgICBpZiAoYWNjZW50ICYmIGFjY2VudC5mb250Q2hhcikgewogICAgICAgICAgYnVpbGRQYXRoKGFjY2VudC5mb250Q2hhcik7CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgIH0gZmluYWxseSB7CiAgICAgIF9pdGVyYXRvci5mKCk7CiAgICB9CiAgfTsKCiAgUGFydGlhbEV2YWx1YXRvci5nZXRGYWxsYmFja0ZvbnREaWN0ID0gZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMuX2ZhbGxiYWNrRm9udERpY3QpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ZhbGxiYWNrRm9udERpY3Q7CiAgICB9CgogICAgdmFyIGRpY3QgPSBuZXcgX3ByaW1pdGl2ZXMuRGljdCgpOwogICAgZGljdC5zZXQoIkJhc2VGb250IiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIlBERkpTLUZhbGxiYWNrRm9udCIpKTsKICAgIGRpY3Quc2V0KCJUeXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZhbGxiYWNrVHlwZSIpKTsKICAgIGRpY3Quc2V0KCJTdWJ0eXBlIiwgX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkZhbGxiYWNrVHlwZSIpKTsKICAgIGRpY3Quc2V0KCJFbmNvZGluZyIsIF9wcmltaXRpdmVzLk5hbWUuZ2V0KCJXaW5BbnNpRW5jb2RpbmciKSk7CiAgICByZXR1cm4gdGhpcy5fZmFsbGJhY2tGb250RGljdCA9IGRpY3Q7CiAgfTsKCiAgcmV0dXJuIFBhcnRpYWxFdmFsdWF0b3I7Cn0oKTsKCmV4cG9ydHMuUGFydGlhbEV2YWx1YXRvciA9IFBhcnRpYWxFdmFsdWF0b3I7Cgp2YXIgVHJhbnNsYXRlZEZvbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFRyYW5zbGF0ZWRGb250KF9yZWY4KSB7CiAgICB2YXIgbG9hZGVkTmFtZSA9IF9yZWY4LmxvYWRlZE5hbWUsCiAgICAgICAgZm9udCA9IF9yZWY4LmZvbnQsCiAgICAgICAgZGljdCA9IF9yZWY4LmRpY3QsCiAgICAgICAgX3JlZjgkZXh0cmFQcm9wZXJ0aWVzID0gX3JlZjguZXh0cmFQcm9wZXJ0aWVzLAogICAgICAgIGV4dHJhUHJvcGVydGllcyA9IF9yZWY4JGV4dHJhUHJvcGVydGllcyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmOCRleHRyYVByb3BlcnRpZXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRyYW5zbGF0ZWRGb250KTsKCiAgICB0aGlzLmxvYWRlZE5hbWUgPSBsb2FkZWROYW1lOwogICAgdGhpcy5mb250ID0gZm9udDsKICAgIHRoaXMuZGljdCA9IGRpY3Q7CiAgICB0aGlzLl9leHRyYVByb3BlcnRpZXMgPSBleHRyYVByb3BlcnRpZXM7CiAgICB0aGlzLnR5cGUzTG9hZGVkID0gbnVsbDsKICAgIHRoaXMuc2VudCA9IGZhbHNlOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFRyYW5zbGF0ZWRGb250LCBbewogICAga2V5OiAic2VuZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZChoYW5kbGVyKSB7CiAgICAgIGlmICh0aGlzLnNlbnQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuc2VudCA9IHRydWU7CiAgICAgIGhhbmRsZXIuc2VuZCgiY29tbW9ub2JqIiwgW3RoaXMubG9hZGVkTmFtZSwgIkZvbnQiLCB0aGlzLmZvbnQuZXhwb3J0RGF0YSh0aGlzLl9leHRyYVByb3BlcnRpZXMpXSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmFsbGJhY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZhbGxiYWNrKGhhbmRsZXIpIHsKICAgICAgaWYgKCF0aGlzLmZvbnQuZGF0YSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5mb250LmRpc2FibGVGb250RmFjZSA9IHRydWU7CiAgICAgIHZhciBnbHlwaHMgPSB0aGlzLmZvbnQuZ2x5cGhDYWNoZVZhbHVlczsKICAgICAgUGFydGlhbEV2YWx1YXRvci5idWlsZEZvbnRQYXRocyh0aGlzLmZvbnQsIGdseXBocywgaGFuZGxlcik7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9hZFR5cGUzRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFR5cGUzRGF0YShldmFsdWF0b3IsIHJlc291cmNlcywgcGFyZW50T3BlcmF0b3JMaXN0LCB0YXNrKSB7CiAgICAgIGlmICghdGhpcy5mb250LmlzVHlwZTNGb250KSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJNdXN0IGJlIGEgVHlwZTMgZm9udC4iKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudHlwZTNMb2FkZWQpIHsKICAgICAgICByZXR1cm4gdGhpcy50eXBlM0xvYWRlZDsKICAgICAgfQoKICAgICAgdmFyIHR5cGUzT3B0aW9ucyA9IE9iamVjdC5jcmVhdGUoZXZhbHVhdG9yLm9wdGlvbnMpOwogICAgICB0eXBlM09wdGlvbnMuaWdub3JlRXJyb3JzID0gZmFsc2U7CiAgICAgIHZhciB0eXBlM0V2YWx1YXRvciA9IGV2YWx1YXRvci5jbG9uZSh0eXBlM09wdGlvbnMpOwogICAgICB0eXBlM0V2YWx1YXRvci5wYXJzaW5nVHlwZTNGb250ID0gdHJ1ZTsKICAgICAgdmFyIHRyYW5zbGF0ZWRGb250ID0gdGhpcy5mb250OwogICAgICB2YXIgbG9hZENoYXJQcm9jc1Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTsKICAgICAgdmFyIGNoYXJQcm9jcyA9IHRoaXMuZGljdC5nZXQoIkNoYXJQcm9jcyIpOwogICAgICB2YXIgZm9udFJlc291cmNlcyA9IHRoaXMuZGljdC5nZXQoIlJlc291cmNlcyIpIHx8IHJlc291cmNlczsKICAgICAgdmFyIGNoYXJQcm9jS2V5cyA9IGNoYXJQcm9jcy5nZXRLZXlzKCk7CiAgICAgIHZhciBjaGFyUHJvY09wZXJhdG9yTGlzdCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKCkgewogICAgICAgIHZhciBrZXkgPSBjaGFyUHJvY0tleXNbaV07CiAgICAgICAgbG9hZENoYXJQcm9jc1Byb21pc2UgPSBsb2FkQ2hhclByb2NzUHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBnbHlwaFN0cmVhbSA9IGNoYXJQcm9jcy5nZXQoa2V5KTsKICAgICAgICAgIHZhciBvcGVyYXRvckxpc3QgPSBuZXcgX29wZXJhdG9yX2xpc3QuT3BlcmF0b3JMaXN0KCk7CiAgICAgICAgICByZXR1cm4gdHlwZTNFdmFsdWF0b3IuZ2V0T3BlcmF0b3JMaXN0KHsKICAgICAgICAgICAgc3RyZWFtOiBnbHlwaFN0cmVhbSwKICAgICAgICAgICAgdGFzazogdGFzaywKICAgICAgICAgICAgcmVzb3VyY2VzOiBmb250UmVzb3VyY2VzLAogICAgICAgICAgICBvcGVyYXRvckxpc3Q6IG9wZXJhdG9yTGlzdAogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNoYXJQcm9jT3BlcmF0b3JMaXN0W2tleV0gPSBvcGVyYXRvckxpc3QuZ2V0SVIoKTsKICAgICAgICAgICAgcGFyZW50T3BlcmF0b3JMaXN0LmFkZERlcGVuZGVuY2llcyhvcGVyYXRvckxpc3QuZGVwZW5kZW5jaWVzKTsKICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUeXBlMyBmb250IHJlc291cmNlIFwiIi5jb25jYXQoa2V5LCAiXCIgaXMgbm90IGF2YWlsYWJsZS4iKSk7CiAgICAgICAgICAgIHZhciBkdW1teU9wZXJhdG9yTGlzdCA9IG5ldyBfb3BlcmF0b3JfbGlzdC5PcGVyYXRvckxpc3QoKTsKICAgICAgICAgICAgY2hhclByb2NPcGVyYXRvckxpc3Rba2V5XSA9IGR1bW15T3BlcmF0b3JMaXN0LmdldElSKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBuID0gY2hhclByb2NLZXlzLmxlbmd0aDsgaSA8IG47ICsraSkgewogICAgICAgIF9sb29wMigpOwogICAgICB9CgogICAgICB0aGlzLnR5cGUzTG9hZGVkID0gbG9hZENoYXJQcm9jc1Byb21pc2UudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgdHJhbnNsYXRlZEZvbnQuY2hhclByb2NPcGVyYXRvckxpc3QgPSBjaGFyUHJvY09wZXJhdG9yTGlzdDsKICAgICAgfSk7CiAgICAgIHJldHVybiB0aGlzLnR5cGUzTG9hZGVkOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFRyYW5zbGF0ZWRGb250Owp9KCk7Cgp2YXIgU3RhdGVNYW5hZ2VyID0gZnVuY3Rpb24gU3RhdGVNYW5hZ2VyQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBTdGF0ZU1hbmFnZXIoaW5pdGlhbFN0YXRlKSB7CiAgICB0aGlzLnN0YXRlID0gaW5pdGlhbFN0YXRlOwogICAgdGhpcy5zdGF0ZVN0YWNrID0gW107CiAgfQoKICBTdGF0ZU1hbmFnZXIucHJvdG90eXBlID0gewogICAgc2F2ZTogZnVuY3Rpb24gc2F2ZSgpIHsKICAgICAgdmFyIG9sZCA9IHRoaXMuc3RhdGU7CiAgICAgIHRoaXMuc3RhdGVTdGFjay5wdXNoKHRoaXMuc3RhdGUpOwogICAgICB0aGlzLnN0YXRlID0gb2xkLmNsb25lKCk7CiAgICB9LAogICAgcmVzdG9yZTogZnVuY3Rpb24gcmVzdG9yZSgpIHsKICAgICAgdmFyIHByZXYgPSB0aGlzLnN0YXRlU3RhY2sucG9wKCk7CgogICAgICBpZiAocHJldikgewogICAgICAgIHRoaXMuc3RhdGUgPSBwcmV2OwogICAgICB9CiAgICB9LAogICAgdHJhbnNmb3JtOiBmdW5jdGlvbiB0cmFuc2Zvcm0oYXJncykgewogICAgICB0aGlzLnN0YXRlLmN0bSA9IF91dGlsLlV0aWwudHJhbnNmb3JtKHRoaXMuc3RhdGUuY3RtLCBhcmdzKTsKICAgIH0KICB9OwogIHJldHVybiBTdGF0ZU1hbmFnZXI7Cn0oKTsKCnZhciBUZXh0U3RhdGUgPSBmdW5jdGlvbiBUZXh0U3RhdGVDbG9zdXJlKCkgewogIGZ1bmN0aW9uIFRleHRTdGF0ZSgpIHsKICAgIHRoaXMuY3RtID0gbmV3IEZsb2F0MzJBcnJheShfdXRpbC5JREVOVElUWV9NQVRSSVgpOwogICAgdGhpcy5mb250TmFtZSA9IG51bGw7CiAgICB0aGlzLmZvbnRTaXplID0gMDsKICAgIHRoaXMuZm9udCA9IG51bGw7CiAgICB0aGlzLmZvbnRNYXRyaXggPSBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWDsKICAgIHRoaXMudGV4dE1hdHJpeCA9IF91dGlsLklERU5USVRZX01BVFJJWC5zbGljZSgpOwogICAgdGhpcy50ZXh0TGluZU1hdHJpeCA9IF91dGlsLklERU5USVRZX01BVFJJWC5zbGljZSgpOwogICAgdGhpcy5jaGFyU3BhY2luZyA9IDA7CiAgICB0aGlzLndvcmRTcGFjaW5nID0gMDsKICAgIHRoaXMubGVhZGluZyA9IDA7CiAgICB0aGlzLnRleHRIU2NhbGUgPSAxOwogICAgdGhpcy50ZXh0UmlzZSA9IDA7CiAgfQoKICBUZXh0U3RhdGUucHJvdG90eXBlID0gewogICAgc2V0VGV4dE1hdHJpeDogZnVuY3Rpb24gVGV4dFN0YXRlX3NldFRleHRNYXRyaXgoYSwgYiwgYywgZCwgZSwgZikgewogICAgICB2YXIgbSA9IHRoaXMudGV4dE1hdHJpeDsKICAgICAgbVswXSA9IGE7CiAgICAgIG1bMV0gPSBiOwogICAgICBtWzJdID0gYzsKICAgICAgbVszXSA9IGQ7CiAgICAgIG1bNF0gPSBlOwogICAgICBtWzVdID0gZjsKICAgIH0sCiAgICBzZXRUZXh0TGluZU1hdHJpeDogZnVuY3Rpb24gVGV4dFN0YXRlX3NldFRleHRNYXRyaXgoYSwgYiwgYywgZCwgZSwgZikgewogICAgICB2YXIgbSA9IHRoaXMudGV4dExpbmVNYXRyaXg7CiAgICAgIG1bMF0gPSBhOwogICAgICBtWzFdID0gYjsKICAgICAgbVsyXSA9IGM7CiAgICAgIG1bM10gPSBkOwogICAgICBtWzRdID0gZTsKICAgICAgbVs1XSA9IGY7CiAgICB9LAogICAgdHJhbnNsYXRlVGV4dE1hdHJpeDogZnVuY3Rpb24gVGV4dFN0YXRlX3RyYW5zbGF0ZVRleHRNYXRyaXgoeCwgeSkgewogICAgICB2YXIgbSA9IHRoaXMudGV4dE1hdHJpeDsKICAgICAgbVs0XSA9IG1bMF0gKiB4ICsgbVsyXSAqIHkgKyBtWzRdOwogICAgICBtWzVdID0gbVsxXSAqIHggKyBtWzNdICogeSArIG1bNV07CiAgICB9LAogICAgdHJhbnNsYXRlVGV4dExpbmVNYXRyaXg6IGZ1bmN0aW9uIFRleHRTdGF0ZV90cmFuc2xhdGVUZXh0TWF0cml4KHgsIHkpIHsKICAgICAgdmFyIG0gPSB0aGlzLnRleHRMaW5lTWF0cml4OwogICAgICBtWzRdID0gbVswXSAqIHggKyBtWzJdICogeSArIG1bNF07CiAgICAgIG1bNV0gPSBtWzFdICogeCArIG1bM10gKiB5ICsgbVs1XTsKICAgIH0sCiAgICBjYWxjVGV4dExpbmVNYXRyaXhBZHZhbmNlOiBmdW5jdGlvbiBUZXh0U3RhdGVfY2FsY1RleHRMaW5lTWF0cml4QWR2YW5jZShhLCBiLCBjLCBkLCBlLCBmKSB7CiAgICAgIHZhciBmb250ID0gdGhpcy5mb250OwoKICAgICAgaWYgKCFmb250KSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBtID0gdGhpcy50ZXh0TGluZU1hdHJpeDsKCiAgICAgIGlmICghKGEgPT09IG1bMF0gJiYgYiA9PT0gbVsxXSAmJiBjID09PSBtWzJdICYmIGQgPT09IG1bM10pKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciB0eERpZmYgPSBlIC0gbVs0XSwKICAgICAgICAgIHR5RGlmZiA9IGYgLSBtWzVdOwoKICAgICAgaWYgKGZvbnQudmVydGljYWwgJiYgdHhEaWZmICE9PSAwIHx8ICFmb250LnZlcnRpY2FsICYmIHR5RGlmZiAhPT0gMCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIgdHgsCiAgICAgICAgICB0eSwKICAgICAgICAgIGRlbm9taW5hdG9yID0gYSAqIGQgLSBiICogYzsKCiAgICAgIGlmIChmb250LnZlcnRpY2FsKSB7CiAgICAgICAgdHggPSAtdHlEaWZmICogYyAvIGRlbm9taW5hdG9yOwogICAgICAgIHR5ID0gdHlEaWZmICogYSAvIGRlbm9taW5hdG9yOwogICAgICB9IGVsc2UgewogICAgICAgIHR4ID0gdHhEaWZmICogZCAvIGRlbm9taW5hdG9yOwogICAgICAgIHR5ID0gLXR4RGlmZiAqIGIgLyBkZW5vbWluYXRvcjsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogdHgsCiAgICAgICAgaGVpZ2h0OiB0eSwKICAgICAgICB2YWx1ZTogZm9udC52ZXJ0aWNhbCA/IHR5IDogdHgKICAgICAgfTsKICAgIH0sCiAgICBjYWxjUmVuZGVyTWF0cml4OiBmdW5jdGlvbiBUZXh0U3RhdGVfY2FsY1JlbmRlTWF0cml4KGN0bSkgewogICAgICB2YXIgdHNtID0gW3RoaXMuZm9udFNpemUgKiB0aGlzLnRleHRIU2NhbGUsIDAsIDAsIHRoaXMuZm9udFNpemUsIDAsIHRoaXMudGV4dFJpc2VdOwogICAgICByZXR1cm4gX3V0aWwuVXRpbC50cmFuc2Zvcm0oY3RtLCBfdXRpbC5VdGlsLnRyYW5zZm9ybSh0aGlzLnRleHRNYXRyaXgsIHRzbSkpOwogICAgfSwKICAgIGNhcnJpYWdlUmV0dXJuOiBmdW5jdGlvbiBUZXh0U3RhdGVfY2FycmlhZ2VSZXR1cm4oKSB7CiAgICAgIHRoaXMudHJhbnNsYXRlVGV4dExpbmVNYXRyaXgoMCwgLXRoaXMubGVhZGluZyk7CiAgICAgIHRoaXMudGV4dE1hdHJpeCA9IHRoaXMudGV4dExpbmVNYXRyaXguc2xpY2UoKTsKICAgIH0sCiAgICBjbG9uZTogZnVuY3Rpb24gVGV4dFN0YXRlX2Nsb25lKCkgewogICAgICB2YXIgY2xvbmUgPSBPYmplY3QuY3JlYXRlKHRoaXMpOwogICAgICBjbG9uZS50ZXh0TWF0cml4ID0gdGhpcy50ZXh0TWF0cml4LnNsaWNlKCk7CiAgICAgIGNsb25lLnRleHRMaW5lTWF0cml4ID0gdGhpcy50ZXh0TGluZU1hdHJpeC5zbGljZSgpOwogICAgICBjbG9uZS5mb250TWF0cml4ID0gdGhpcy5mb250TWF0cml4LnNsaWNlKCk7CiAgICAgIHJldHVybiBjbG9uZTsKICAgIH0KICB9OwogIHJldHVybiBUZXh0U3RhdGU7Cn0oKTsKCnZhciBFdmFsU3RhdGUgPSBmdW5jdGlvbiBFdmFsU3RhdGVDbG9zdXJlKCkgewogIGZ1bmN0aW9uIEV2YWxTdGF0ZSgpIHsKICAgIHRoaXMuY3RtID0gbmV3IEZsb2F0MzJBcnJheShfdXRpbC5JREVOVElUWV9NQVRSSVgpOwogICAgdGhpcy5mb250ID0gbnVsbDsKICAgIHRoaXMudGV4dFJlbmRlcmluZ01vZGUgPSBfdXRpbC5UZXh0UmVuZGVyaW5nTW9kZS5GSUxMOwogICAgdGhpcy5maWxsQ29sb3JTcGFjZSA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2Uuc2luZ2xldG9ucy5ncmF5OwogICAgdGhpcy5zdHJva2VDb2xvclNwYWNlID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5zaW5nbGV0b25zLmdyYXk7CiAgfQoKICBFdmFsU3RhdGUucHJvdG90eXBlID0gewogICAgY2xvbmU6IGZ1bmN0aW9uIENhbnZhc0V4dHJhU3RhdGVfY2xvbmUoKSB7CiAgICAgIHJldHVybiBPYmplY3QuY3JlYXRlKHRoaXMpOwogICAgfQogIH07CiAgcmV0dXJuIEV2YWxTdGF0ZTsKfSgpOwoKdmFyIEV2YWx1YXRvclByZXByb2Nlc3NvciA9IGZ1bmN0aW9uIEV2YWx1YXRvclByZXByb2Nlc3NvckNsb3N1cmUoKSB7CiAgdmFyIGdldE9QTWFwID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQudyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRMaW5lV2lkdGgsCiAgICAgIG51bUFyZ3M6IDEsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LkogPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuc2V0TGluZUNhcCwKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuaiA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRMaW5lSm9pbiwKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuTSA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRNaXRlckxpbWl0LAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5kID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldERhc2gsCiAgICAgIG51bUFyZ3M6IDIsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LnJpID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldFJlbmRlcmluZ0ludGVudCwKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuaSA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRGbGF0bmVzcywKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuZ3MgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuc2V0R1N0YXRlLAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5xID0gewogICAgICBpZDogX3V0aWwuT1BTLnNhdmUsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LlEgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMucmVzdG9yZSwKICAgICAgbnVtQXJnczogMCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuY20gPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMudHJhbnNmb3JtLAogICAgICBudW1BcmdzOiA2LAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5tID0gewogICAgICBpZDogX3V0aWwuT1BTLm1vdmVUbywKICAgICAgbnVtQXJnczogMiwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQubCA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5saW5lVG8sCiAgICAgIG51bUFyZ3M6IDIsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LmMgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuY3VydmVUbywKICAgICAgbnVtQXJnczogNiwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQudiA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5jdXJ2ZVRvMiwKICAgICAgbnVtQXJnczogNCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQueSA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5jdXJ2ZVRvMywKICAgICAgbnVtQXJnczogNCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuaCA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5jbG9zZVBhdGgsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LnJlID0gewogICAgICBpZDogX3V0aWwuT1BTLnJlY3RhbmdsZSwKICAgICAgbnVtQXJnczogNCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuUyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zdHJva2UsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LnMgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuY2xvc2VTdHJva2UsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LmYgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuZmlsbCwKICAgICAgbnVtQXJnczogMCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuRiA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5maWxsLAogICAgICBudW1BcmdzOiAwLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdFsiZioiXSA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5lb0ZpbGwsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LkIgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuZmlsbFN0cm9rZSwKICAgICAgbnVtQXJnczogMCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHRbIkIqIl0gPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuZW9GaWxsU3Ryb2tlLAogICAgICBudW1BcmdzOiAwLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5iID0gewogICAgICBpZDogX3V0aWwuT1BTLmNsb3NlRmlsbFN0cm9rZSwKICAgICAgbnVtQXJnczogMCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHRbImIqIl0gPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuY2xvc2VFT0ZpbGxTdHJva2UsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0Lm4gPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuZW5kUGF0aCwKICAgICAgbnVtQXJnczogMCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuVyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5jbGlwLAogICAgICBudW1BcmdzOiAwLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdFsiVyoiXSA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5lb0NsaXAsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LkJUID0gewogICAgICBpZDogX3V0aWwuT1BTLmJlZ2luVGV4dCwKICAgICAgbnVtQXJnczogMCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuRVQgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuZW5kVGV4dCwKICAgICAgbnVtQXJnczogMCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuVGMgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuc2V0Q2hhclNwYWNpbmcsCiAgICAgIG51bUFyZ3M6IDEsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LlR3ID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldFdvcmRTcGFjaW5nLAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5UeiA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRIU2NhbGUsCiAgICAgIG51bUFyZ3M6IDEsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LlRMID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldExlYWRpbmcsCiAgICAgIG51bUFyZ3M6IDEsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LlRmID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldEZvbnQsCiAgICAgIG51bUFyZ3M6IDIsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LlRyID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldFRleHRSZW5kZXJpbmdNb2RlLAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5UcyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRUZXh0UmlzZSwKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuVGQgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMubW92ZVRleHQsCiAgICAgIG51bUFyZ3M6IDIsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LlREID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldExlYWRpbmdNb3ZlVGV4dCwKICAgICAgbnVtQXJnczogMiwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuVG0gPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuc2V0VGV4dE1hdHJpeCwKICAgICAgbnVtQXJnczogNiwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHRbIlQqIl0gPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMubmV4dExpbmUsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LlRqID0gewogICAgICBpZDogX3V0aWwuT1BTLnNob3dUZXh0LAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5USiA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zaG93U3BhY2VkVGV4dCwKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHRbIiciXSA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5uZXh0TGluZVNob3dUZXh0LAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdFsnIiddID0gewogICAgICBpZDogX3V0aWwuT1BTLm5leHRMaW5lU2V0U3BhY2luZ1Nob3dUZXh0LAogICAgICBudW1BcmdzOiAzLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5kMCA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRDaGFyV2lkdGgsCiAgICAgIG51bUFyZ3M6IDIsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LmQxID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldENoYXJXaWR0aEFuZEJvdW5kcywKICAgICAgbnVtQXJnczogNiwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuQ1MgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuc2V0U3Ryb2tlQ29sb3JTcGFjZSwKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuY3MgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuc2V0RmlsbENvbG9yU3BhY2UsCiAgICAgIG51bUFyZ3M6IDEsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LlNDID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldFN0cm9rZUNvbG9yLAogICAgICBudW1BcmdzOiA0LAogICAgICB2YXJpYWJsZUFyZ3M6IHRydWUKICAgIH07CiAgICB0LlNDTiA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRTdHJva2VDb2xvck4sCiAgICAgIG51bUFyZ3M6IDMzLAogICAgICB2YXJpYWJsZUFyZ3M6IHRydWUKICAgIH07CiAgICB0LnNjID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldEZpbGxDb2xvciwKICAgICAgbnVtQXJnczogNCwKICAgICAgdmFyaWFibGVBcmdzOiB0cnVlCiAgICB9OwogICAgdC5zY24gPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuc2V0RmlsbENvbG9yTiwKICAgICAgbnVtQXJnczogMzMsCiAgICAgIHZhcmlhYmxlQXJnczogdHJ1ZQogICAgfTsKICAgIHQuRyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRTdHJva2VHcmF5LAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5nID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldEZpbGxHcmF5LAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5SRyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRTdHJva2VSR0JDb2xvciwKICAgICAgbnVtQXJnczogMywKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQucmcgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuc2V0RmlsbFJHQkNvbG9yLAogICAgICBudW1BcmdzOiAzLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5LID0gewogICAgICBpZDogX3V0aWwuT1BTLnNldFN0cm9rZUNNWUtDb2xvciwKICAgICAgbnVtQXJnczogNCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuayA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zZXRGaWxsQ01ZS0NvbG9yLAogICAgICBudW1BcmdzOiA0LAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5zaCA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5zaGFkaW5nRmlsbCwKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuQkkgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuYmVnaW5JbmxpbmVJbWFnZSwKICAgICAgbnVtQXJnczogMCwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuSUQgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMuYmVnaW5JbWFnZURhdGEsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LkVJID0gewogICAgICBpZDogX3V0aWwuT1BTLmVuZElubGluZUltYWdlLAogICAgICBudW1BcmdzOiAxLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5EbyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5wYWludFhPYmplY3QsCiAgICAgIG51bUFyZ3M6IDEsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0Lk1QID0gewogICAgICBpZDogX3V0aWwuT1BTLm1hcmtQb2ludCwKICAgICAgbnVtQXJnczogMSwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuRFAgPSB7CiAgICAgIGlkOiBfdXRpbC5PUFMubWFya1BvaW50UHJvcHMsCiAgICAgIG51bUFyZ3M6IDIsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LkJNQyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnQsCiAgICAgIG51bUFyZ3M6IDEsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LkJEQyA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5iZWdpbk1hcmtlZENvbnRlbnRQcm9wcywKICAgICAgbnVtQXJnczogMiwKICAgICAgdmFyaWFibGVBcmdzOiBmYWxzZQogICAgfTsKICAgIHQuRU1DID0gewogICAgICBpZDogX3V0aWwuT1BTLmVuZE1hcmtlZENvbnRlbnQsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LkJYID0gewogICAgICBpZDogX3V0aWwuT1BTLmJlZ2luQ29tcGF0LAogICAgICBudW1BcmdzOiAwLAogICAgICB2YXJpYWJsZUFyZ3M6IGZhbHNlCiAgICB9OwogICAgdC5FWCA9IHsKICAgICAgaWQ6IF91dGlsLk9QUy5lbmRDb21wYXQsCiAgICAgIG51bUFyZ3M6IDAsCiAgICAgIHZhcmlhYmxlQXJnczogZmFsc2UKICAgIH07CiAgICB0LkJNID0gbnVsbDsKICAgIHQuQkQgPSBudWxsOwogICAgdFsidHJ1ZSJdID0gbnVsbDsKICAgIHQuZmEgPSBudWxsOwogICAgdC5mYWwgPSBudWxsOwogICAgdC5mYWxzID0gbnVsbDsKICAgIHRbImZhbHNlIl0gPSBudWxsOwogICAgdC5udSA9IG51bGw7CiAgICB0Lm51bCA9IG51bGw7CiAgICB0WyJudWxsIl0gPSBudWxsOwogIH0pOwogIHZhciBNQVhfSU5WQUxJRF9QQVRIX09QUyA9IDIwOwoKICBmdW5jdGlvbiBFdmFsdWF0b3JQcmVwcm9jZXNzb3Ioc3RyZWFtLCB4cmVmLCBzdGF0ZU1hbmFnZXIpIHsKICAgIHRoaXMub3BNYXAgPSBnZXRPUE1hcCgpOwogICAgdGhpcy5wYXJzZXIgPSBuZXcgX3BhcnNlci5QYXJzZXIoewogICAgICBsZXhlcjogbmV3IF9wYXJzZXIuTGV4ZXIoc3RyZWFtLCB0aGlzLm9wTWFwKSwKICAgICAgeHJlZjogeHJlZgogICAgfSk7CiAgICB0aGlzLnN0YXRlTWFuYWdlciA9IHN0YXRlTWFuYWdlcjsKICAgIHRoaXMubm9uUHJvY2Vzc2VkQXJncyA9IFtdOwogICAgdGhpcy5fbnVtSW52YWxpZFBhdGhPUFMgPSAwOwogIH0KCiAgRXZhbHVhdG9yUHJlcHJvY2Vzc29yLnByb3RvdHlwZSA9IHsKICAgIGdldCBzYXZlZFN0YXRlc0RlcHRoKCkgewogICAgICByZXR1cm4gdGhpcy5zdGF0ZU1hbmFnZXIuc3RhdGVTdGFjay5sZW5ndGg7CiAgICB9LAoKICAgIHJlYWQ6IGZ1bmN0aW9uIEV2YWx1YXRvclByZXByb2Nlc3Nvcl9yZWFkKG9wZXJhdGlvbikgewogICAgICB2YXIgYXJncyA9IG9wZXJhdGlvbi5hcmdzOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICB2YXIgb2JqID0gdGhpcy5wYXJzZXIuZ2V0T2JqKCk7CgogICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBfcHJpbWl0aXZlcy5DbWQpIHsKICAgICAgICAgIHZhciBjbWQgPSBvYmouY21kOwogICAgICAgICAgdmFyIG9wU3BlYyA9IHRoaXMub3BNYXBbY21kXTsKCiAgICAgICAgICBpZiAoIW9wU3BlYykgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlVua25vd24gY29tbWFuZCBcIiIuY29uY2F0KGNtZCwgIlwiLiIpKTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGZuID0gb3BTcGVjLmlkOwogICAgICAgICAgdmFyIG51bUFyZ3MgPSBvcFNwZWMubnVtQXJnczsKICAgICAgICAgIHZhciBhcmdzTGVuZ3RoID0gYXJncyAhPT0gbnVsbCA/IGFyZ3MubGVuZ3RoIDogMDsKCiAgICAgICAgICBpZiAoIW9wU3BlYy52YXJpYWJsZUFyZ3MpIHsKICAgICAgICAgICAgaWYgKGFyZ3NMZW5ndGggIT09IG51bUFyZ3MpIHsKICAgICAgICAgICAgICB2YXIgbm9uUHJvY2Vzc2VkQXJncyA9IHRoaXMubm9uUHJvY2Vzc2VkQXJnczsKCiAgICAgICAgICAgICAgd2hpbGUgKGFyZ3NMZW5ndGggPiBudW1BcmdzKSB7CiAgICAgICAgICAgICAgICBub25Qcm9jZXNzZWRBcmdzLnB1c2goYXJncy5zaGlmdCgpKTsKICAgICAgICAgICAgICAgIGFyZ3NMZW5ndGgtLTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHdoaWxlIChhcmdzTGVuZ3RoIDwgbnVtQXJncyAmJiBub25Qcm9jZXNzZWRBcmdzLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgICAgICAgaWYgKGFyZ3MgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgYXJncyA9IFtdOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGFyZ3MudW5zaGlmdChub25Qcm9jZXNzZWRBcmdzLnBvcCgpKTsKICAgICAgICAgICAgICAgIGFyZ3NMZW5ndGgrKzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChhcmdzTGVuZ3RoIDwgbnVtQXJncykgewogICAgICAgICAgICAgIHZhciBwYXJ0aWFsTXNnID0gImNvbW1hbmQgIi5jb25jYXQoY21kLCAiOiBleHBlY3RlZCAiKS5jb25jYXQobnVtQXJncywgIiBhcmdzLCAiKSArICJidXQgcmVjZWl2ZWQgIi5jb25jYXQoYXJnc0xlbmd0aCwgIiBhcmdzLiIpOwoKICAgICAgICAgICAgICBpZiAoZm4gPj0gX3V0aWwuT1BTLm1vdmVUbyAmJiBmbiA8PSBfdXRpbC5PUFMuZW5kUGF0aCAmJiArK3RoaXMuX251bUludmFsaWRQYXRoT1BTID4gTUFYX0lOVkFMSURfUEFUSF9PUFMpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCAiLmNvbmNhdChwYXJ0aWFsTXNnKSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlNraXBwaW5nICIuY29uY2F0KHBhcnRpYWxNc2cpKTsKCiAgICAgICAgICAgICAgaWYgKGFyZ3MgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgIGFyZ3MubGVuZ3RoID0gMDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKGFyZ3NMZW5ndGggPiBudW1BcmdzKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiQ29tbWFuZCAiLmNvbmNhdChjbWQsICI6IGV4cGVjdGVkIFswLCAiKS5jb25jYXQobnVtQXJncywgIl0gYXJncywgIikgKyAiYnV0IHJlY2VpdmVkICIuY29uY2F0KGFyZ3NMZW5ndGgsICIgYXJncy4iKSk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5wcmVwcm9jZXNzQ29tbWFuZChmbiwgYXJncyk7CiAgICAgICAgICBvcGVyYXRpb24uZm4gPSBmbjsKICAgICAgICAgIG9wZXJhdGlvbi5hcmdzID0gYXJnczsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKG9iaiA9PT0gX3ByaW1pdGl2ZXMuRU9GKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAob2JqICE9PSBudWxsKSB7CiAgICAgICAgICBpZiAoYXJncyA9PT0gbnVsbCkgewogICAgICAgICAgICBhcmdzID0gW107CiAgICAgICAgICB9CgogICAgICAgICAgYXJncy5wdXNoKG9iaik7CgogICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gMzMpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJUb28gbWFueSBhcmd1bWVudHMiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBwcmVwcm9jZXNzQ29tbWFuZDogZnVuY3Rpb24gRXZhbHVhdG9yUHJlcHJvY2Vzc29yX3ByZXByb2Nlc3NDb21tYW5kKGZuLCBhcmdzKSB7CiAgICAgIHN3aXRjaCAoZm4gfCAwKSB7CiAgICAgICAgY2FzZSBfdXRpbC5PUFMuc2F2ZToKICAgICAgICAgIHRoaXMuc3RhdGVNYW5hZ2VyLnNhdmUoKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIF91dGlsLk9QUy5yZXN0b3JlOgogICAgICAgICAgdGhpcy5zdGF0ZU1hbmFnZXIucmVzdG9yZSgpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgX3V0aWwuT1BTLnRyYW5zZm9ybToKICAgICAgICAgIHRoaXMuc3RhdGVNYW5hZ2VyLnRyYW5zZm9ybShhcmdzKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfTsKICByZXR1cm4gRXZhbHVhdG9yUHJlcHJvY2Vzc29yOwp9KCk7CgovKioqLyB9KSwKLyogMjIxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuQ01hcEZhY3RvcnkgPSBleHBvcnRzLklkZW50aXR5Q01hcCA9IGV4cG9ydHMuQ01hcCA9IHZvaWQgMDsKCnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9fd19wZGZqc19yZXF1aXJlX18oMikpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDQpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNSk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBrZXksIGFyZykgeyB0cnkgeyB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7IHZhciB2YWx1ZSA9IGluZm8udmFsdWU7IH0gY2F0Y2ggKGVycm9yKSB7IHJlamVjdChlcnJvcik7IHJldHVybjsgfSBpZiAoaW5mby5kb25lKSB7IHJlc29sdmUodmFsdWUpOyB9IGVsc2UgeyBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7IH0gfQoKZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gYXJndW1lbnRzOyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2YXIgZ2VuID0gZm4uYXBwbHkoc2VsZiwgYXJncyk7IGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJ0aHJvdyIsIGVycik7IH0gX25leHQodW5kZWZpbmVkKTsgfSk7IH07IH0KCmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IGlmICh0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09ICJzeW1ib2wiKSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTsgfQoKZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHsgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IG8uX19wcm90b19fID0gcDsgcmV0dXJuIG87IH07IHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7IH0KCmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9CgpmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmIChjYWxsICYmIChfdHlwZW9mKGNhbGwpID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikpIHsgcmV0dXJuIGNhbGw7IH0gcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7IH0KCmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIHNlbGY7IH0KCmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOyB0cnkgeyBEYXRlLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKFJlZmxlY3QuY29uc3RydWN0KERhdGUsIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQoKZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgX2dldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHsgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTsgfTsgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCnZhciBCVUlMVF9JTl9DTUFQUyA9IFsiQWRvYmUtR0IxLVVDUzIiLCAiQWRvYmUtQ05TMS1VQ1MyIiwgIkFkb2JlLUphcGFuMS1VQ1MyIiwgIkFkb2JlLUtvcmVhMS1VQ1MyIiwgIjc4LUVVQy1IIiwgIjc4LUVVQy1WIiwgIjc4LUgiLCAiNzgtUktTSi1IIiwgIjc4LVJLU0otViIsICI3OC1WIiwgIjc4bXMtUktTSi1IIiwgIjc4bXMtUktTSi1WIiwgIjgzcHYtUktTSi1IIiwgIjkwbXMtUktTSi1IIiwgIjkwbXMtUktTSi1WIiwgIjkwbXNwLVJLU0otSCIsICI5MG1zcC1SS1NKLVYiLCAiOTBwdi1SS1NKLUgiLCAiOTBwdi1SS1NKLVYiLCAiQWRkLUgiLCAiQWRkLVJLU0otSCIsICJBZGQtUktTSi1WIiwgIkFkZC1WIiwgIkFkb2JlLUNOUzEtMCIsICJBZG9iZS1DTlMxLTEiLCAiQWRvYmUtQ05TMS0yIiwgIkFkb2JlLUNOUzEtMyIsICJBZG9iZS1DTlMxLTQiLCAiQWRvYmUtQ05TMS01IiwgIkFkb2JlLUNOUzEtNiIsICJBZG9iZS1HQjEtMCIsICJBZG9iZS1HQjEtMSIsICJBZG9iZS1HQjEtMiIsICJBZG9iZS1HQjEtMyIsICJBZG9iZS1HQjEtNCIsICJBZG9iZS1HQjEtNSIsICJBZG9iZS1KYXBhbjEtMCIsICJBZG9iZS1KYXBhbjEtMSIsICJBZG9iZS1KYXBhbjEtMiIsICJBZG9iZS1KYXBhbjEtMyIsICJBZG9iZS1KYXBhbjEtNCIsICJBZG9iZS1KYXBhbjEtNSIsICJBZG9iZS1KYXBhbjEtNiIsICJBZG9iZS1Lb3JlYTEtMCIsICJBZG9iZS1Lb3JlYTEtMSIsICJBZG9iZS1Lb3JlYTEtMiIsICJCNS1IIiwgIkI1LVYiLCAiQjVwYy1IIiwgIkI1cGMtViIsICJDTlMtRVVDLUgiLCAiQ05TLUVVQy1WIiwgIkNOUzEtSCIsICJDTlMxLVYiLCAiQ05TMi1IIiwgIkNOUzItViIsICJFVEhLLUI1LUgiLCAiRVRISy1CNS1WIiwgIkVUZW4tQjUtSCIsICJFVGVuLUI1LVYiLCAiRVRlbm1zLUI1LUgiLCAiRVRlbm1zLUI1LVYiLCAiRVVDLUgiLCAiRVVDLVYiLCAiRXh0LUgiLCAiRXh0LVJLU0otSCIsICJFeHQtUktTSi1WIiwgIkV4dC1WIiwgIkdCLUVVQy1IIiwgIkdCLUVVQy1WIiwgIkdCLUgiLCAiR0ItViIsICJHQkstRVVDLUgiLCAiR0JLLUVVQy1WIiwgIkdCSzJLLUgiLCAiR0JLMkstViIsICJHQktwLUVVQy1IIiwgIkdCS3AtRVVDLVYiLCAiR0JULUVVQy1IIiwgIkdCVC1FVUMtViIsICJHQlQtSCIsICJHQlQtViIsICJHQlRwYy1FVUMtSCIsICJHQlRwYy1FVUMtViIsICJHQnBjLUVVQy1IIiwgIkdCcGMtRVVDLVYiLCAiSCIsICJIS2RsYS1CNS1IIiwgIkhLZGxhLUI1LVYiLCAiSEtkbGItQjUtSCIsICJIS2RsYi1CNS1WIiwgIkhLZ2Njcy1CNS1IIiwgIkhLZ2Njcy1CNS1WIiwgIkhLbTMxNC1CNS1IIiwgIkhLbTMxNC1CNS1WIiwgIkhLbTQ3MS1CNS1IIiwgIkhLbTQ3MS1CNS1WIiwgIkhLc2NzLUI1LUgiLCAiSEtzY3MtQjUtViIsICJIYW5rYWt1IiwgIkhpcmFnYW5hIiwgIktTQy1FVUMtSCIsICJLU0MtRVVDLVYiLCAiS1NDLUgiLCAiS1NDLUpvaGFiLUgiLCAiS1NDLUpvaGFiLVYiLCAiS1NDLVYiLCAiS1NDbXMtVUhDLUgiLCAiS1NDbXMtVUhDLUhXLUgiLCAiS1NDbXMtVUhDLUhXLVYiLCAiS1NDbXMtVUhDLVYiLCAiS1NDcGMtRVVDLUgiLCAiS1NDcGMtRVVDLVYiLCAiS2F0YWthbmEiLCAiTldQLUgiLCAiTldQLVYiLCAiUktTSi1IIiwgIlJLU0otViIsICJSb21hbiIsICJVbmlDTlMtVUNTMi1IIiwgIlVuaUNOUy1VQ1MyLVYiLCAiVW5pQ05TLVVURjE2LUgiLCAiVW5pQ05TLVVURjE2LVYiLCAiVW5pQ05TLVVURjMyLUgiLCAiVW5pQ05TLVVURjMyLVYiLCAiVW5pQ05TLVVURjgtSCIsICJVbmlDTlMtVVRGOC1WIiwgIlVuaUdCLVVDUzItSCIsICJVbmlHQi1VQ1MyLVYiLCAiVW5pR0ItVVRGMTYtSCIsICJVbmlHQi1VVEYxNi1WIiwgIlVuaUdCLVVURjMyLUgiLCAiVW5pR0ItVVRGMzItViIsICJVbmlHQi1VVEY4LUgiLCAiVW5pR0ItVVRGOC1WIiwgIlVuaUpJUy1VQ1MyLUgiLCAiVW5pSklTLVVDUzItSFctSCIsICJVbmlKSVMtVUNTMi1IVy1WIiwgIlVuaUpJUy1VQ1MyLVYiLCAiVW5pSklTLVVURjE2LUgiLCAiVW5pSklTLVVURjE2LVYiLCAiVW5pSklTLVVURjMyLUgiLCAiVW5pSklTLVVURjMyLVYiLCAiVW5pSklTLVVURjgtSCIsICJVbmlKSVMtVVRGOC1WIiwgIlVuaUpJUzIwMDQtVVRGMTYtSCIsICJVbmlKSVMyMDA0LVVURjE2LVYiLCAiVW5pSklTMjAwNC1VVEYzMi1IIiwgIlVuaUpJUzIwMDQtVVRGMzItViIsICJVbmlKSVMyMDA0LVVURjgtSCIsICJVbmlKSVMyMDA0LVVURjgtViIsICJVbmlKSVNQcm8tVUNTMi1IVy1WIiwgIlVuaUpJU1Byby1VQ1MyLVYiLCAiVW5pSklTUHJvLVVURjgtViIsICJVbmlKSVNYMDIxMy1VVEYzMi1IIiwgIlVuaUpJU1gwMjEzLVVURjMyLVYiLCAiVW5pSklTWDAyMTMyMDA0LVVURjMyLUgiLCAiVW5pSklTWDAyMTMyMDA0LVVURjMyLVYiLCAiVW5pS1MtVUNTMi1IIiwgIlVuaUtTLVVDUzItViIsICJVbmlLUy1VVEYxNi1IIiwgIlVuaUtTLVVURjE2LVYiLCAiVW5pS1MtVVRGMzItSCIsICJVbmlLUy1VVEYzMi1WIiwgIlVuaUtTLVVURjgtSCIsICJVbmlLUy1VVEY4LVYiLCAiViIsICJXUC1TeW1ib2wiXTsKdmFyIE1BWF9NQVBfUkFOR0UgPSBNYXRoLnBvdygyLCAyNCkgLSAxOwoKdmFyIENNYXAgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENNYXAoKSB7CiAgICB2YXIgYnVpbHRJbkNNYXAgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDTWFwKTsKCiAgICB0aGlzLmNvZGVzcGFjZVJhbmdlcyA9IFtbXSwgW10sIFtdLCBbXV07CiAgICB0aGlzLm51bUNvZGVzcGFjZVJhbmdlcyA9IDA7CiAgICB0aGlzLl9tYXAgPSBbXTsKICAgIHRoaXMubmFtZSA9ICIiOwogICAgdGhpcy52ZXJ0aWNhbCA9IGZhbHNlOwogICAgdGhpcy51c2VDTWFwID0gbnVsbDsKICAgIHRoaXMuYnVpbHRJbkNNYXAgPSBidWlsdEluQ01hcDsKICB9CgogIF9jcmVhdGVDbGFzcyhDTWFwLCBbewogICAga2V5OiAiYWRkQ29kZXNwYWNlUmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENvZGVzcGFjZVJhbmdlKG4sIGxvdywgaGlnaCkgewogICAgICB0aGlzLmNvZGVzcGFjZVJhbmdlc1tuIC0gMV0ucHVzaChsb3csIGhpZ2gpOwogICAgICB0aGlzLm51bUNvZGVzcGFjZVJhbmdlcysrOwogICAgfQogIH0sIHsKICAgIGtleTogIm1hcENpZFJhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYXBDaWRSYW5nZShsb3csIGhpZ2gsIGRzdExvdykgewogICAgICBpZiAoaGlnaCAtIGxvdyA+IE1BWF9NQVBfUkFOR0UpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIm1hcENpZFJhbmdlIC0gaWdub3JpbmcgZGF0YSBhYm92ZSBNQVhfTUFQX1JBTkdFLiIpOwogICAgICB9CgogICAgICB3aGlsZSAobG93IDw9IGhpZ2gpIHsKICAgICAgICB0aGlzLl9tYXBbbG93KytdID0gZHN0TG93Kys7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYXBCZlJhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYXBCZlJhbmdlKGxvdywgaGlnaCwgZHN0TG93KSB7CiAgICAgIGlmIChoaWdoIC0gbG93ID4gTUFYX01BUF9SQU5HRSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigibWFwQmZSYW5nZSAtIGlnbm9yaW5nIGRhdGEgYWJvdmUgTUFYX01BUF9SQU5HRS4iKTsKICAgICAgfQoKICAgICAgdmFyIGxhc3RCeXRlID0gZHN0TG93Lmxlbmd0aCAtIDE7CgogICAgICB3aGlsZSAobG93IDw9IGhpZ2gpIHsKICAgICAgICB0aGlzLl9tYXBbbG93KytdID0gZHN0TG93OwogICAgICAgIGRzdExvdyA9IGRzdExvdy5zdWJzdHJpbmcoMCwgbGFzdEJ5dGUpICsgU3RyaW5nLmZyb21DaGFyQ29kZShkc3RMb3cuY2hhckNvZGVBdChsYXN0Qnl0ZSkgKyAxKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIm1hcEJmUmFuZ2VUb0FycmF5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtYXBCZlJhbmdlVG9BcnJheShsb3csIGhpZ2gsIGFycmF5KSB7CiAgICAgIGlmIChoaWdoIC0gbG93ID4gTUFYX01BUF9SQU5HRSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigibWFwQmZSYW5nZVRvQXJyYXkgLSBpZ25vcmluZyBkYXRhIGFib3ZlIE1BWF9NQVBfUkFOR0UuIik7CiAgICAgIH0KCiAgICAgIHZhciBpaSA9IGFycmF5Lmxlbmd0aDsKICAgICAgdmFyIGkgPSAwOwoKICAgICAgd2hpbGUgKGxvdyA8PSBoaWdoICYmIGkgPCBpaSkgewogICAgICAgIHRoaXMuX21hcFtsb3ddID0gYXJyYXlbaSsrXTsKICAgICAgICArK2xvdzsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIm1hcE9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFwT25lKHNyYywgZHN0KSB7CiAgICAgIHRoaXMuX21hcFtzcmNdID0gZHN0OwogICAgfQogIH0sIHsKICAgIGtleTogImxvb2t1cCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9va3VwKGNvZGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX21hcFtjb2RlXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb250YWlucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29udGFpbnMoY29kZSkgewogICAgICByZXR1cm4gdGhpcy5fbWFwW2NvZGVdICE9PSB1bmRlZmluZWQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZm9yRWFjaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9yRWFjaChjYWxsYmFjaykgewogICAgICB2YXIgbWFwID0gdGhpcy5fbWFwOwogICAgICB2YXIgbGVuZ3RoID0gbWFwLmxlbmd0aDsKCiAgICAgIGlmIChsZW5ndGggPD0gMHgxMDAwMCkgewogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChtYXBbaV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYWxsYmFjayhpLCBtYXBbaV0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKHZhciBfaSBpbiBtYXApIHsKICAgICAgICAgIGNhbGxiYWNrKF9pLCBtYXBbX2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjaGFyQ29kZU9mIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjaGFyQ29kZU9mKHZhbHVlKSB7CiAgICAgIHZhciBtYXAgPSB0aGlzLl9tYXA7CgogICAgICBpZiAobWFwLmxlbmd0aCA8PSAweDEwMDAwKSB7CiAgICAgICAgcmV0dXJuIG1hcC5pbmRleE9mKHZhbHVlKTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgY2hhckNvZGUgaW4gbWFwKSB7CiAgICAgICAgaWYgKG1hcFtjaGFyQ29kZV0gPT09IHZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gY2hhckNvZGUgfCAwOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIC0xOwogICAgfQogIH0sIHsKICAgIGtleTogImdldE1hcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TWFwKCkgewogICAgICByZXR1cm4gdGhpcy5fbWFwOwogICAgfQogIH0sIHsKICAgIGtleTogInJlYWRDaGFyQ29kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZENoYXJDb2RlKHN0ciwgb2Zmc2V0LCBvdXQpIHsKICAgICAgdmFyIGMgPSAwOwogICAgICB2YXIgY29kZXNwYWNlUmFuZ2VzID0gdGhpcy5jb2Rlc3BhY2VSYW5nZXM7CgogICAgICBmb3IgKHZhciBuID0gMCwgbm4gPSBjb2Rlc3BhY2VSYW5nZXMubGVuZ3RoOyBuIDwgbm47IG4rKykgewogICAgICAgIGMgPSAoYyA8PCA4IHwgc3RyLmNoYXJDb2RlQXQob2Zmc2V0ICsgbikpID4+PiAwOwogICAgICAgIHZhciBjb2Rlc3BhY2VSYW5nZSA9IGNvZGVzcGFjZVJhbmdlc1tuXTsKCiAgICAgICAgZm9yICh2YXIgayA9IDAsIGtrID0gY29kZXNwYWNlUmFuZ2UubGVuZ3RoOyBrIDwga2s7KSB7CiAgICAgICAgICB2YXIgbG93ID0gY29kZXNwYWNlUmFuZ2VbaysrXTsKICAgICAgICAgIHZhciBoaWdoID0gY29kZXNwYWNlUmFuZ2VbaysrXTsKCiAgICAgICAgICBpZiAoYyA+PSBsb3cgJiYgYyA8PSBoaWdoKSB7CiAgICAgICAgICAgIG91dC5jaGFyY29kZSA9IGM7CiAgICAgICAgICAgIG91dC5sZW5ndGggPSBuICsgMTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgb3V0LmNoYXJjb2RlID0gMDsKICAgICAgb3V0Lmxlbmd0aCA9IDE7CiAgICB9CiAgfSwgewogICAga2V5OiAibGVuZ3RoIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fbWFwLmxlbmd0aDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0lkZW50aXR5Q01hcCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgaWYgKCEodGhpcy5uYW1lID09PSAiSWRlbnRpdHktSCIgfHwgdGhpcy5uYW1lID09PSAiSWRlbnRpdHktViIpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAodGhpcy5fbWFwLmxlbmd0aCAhPT0gMHgxMDAwMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAweDEwMDAwOyBpKyspIHsKICAgICAgICBpZiAodGhpcy5fbWFwW2ldICE9PSBpKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9XSk7CgogIHJldHVybiBDTWFwOwp9KCk7CgpleHBvcnRzLkNNYXAgPSBDTWFwOwoKdmFyIElkZW50aXR5Q01hcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NNYXApIHsKICBfaW5oZXJpdHMoSWRlbnRpdHlDTWFwLCBfQ01hcCk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoSWRlbnRpdHlDTWFwKTsKCiAgZnVuY3Rpb24gSWRlbnRpdHlDTWFwKHZlcnRpY2FsLCBuKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElkZW50aXR5Q01hcCk7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKTsKICAgIF90aGlzLnZlcnRpY2FsID0gdmVydGljYWw7CgogICAgX3RoaXMuYWRkQ29kZXNwYWNlUmFuZ2UobiwgMCwgMHhmZmZmKTsKCiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoSWRlbnRpdHlDTWFwLCBbewogICAga2V5OiAibWFwQ2lkUmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1hcENpZFJhbmdlKGxvdywgaGlnaCwgZHN0TG93KSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoInNob3VsZCBub3QgY2FsbCBtYXBDaWRSYW5nZSIpOwogICAgfQogIH0sIHsKICAgIGtleTogIm1hcEJmUmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1hcEJmUmFuZ2UobG93LCBoaWdoLCBkc3RMb3cpIHsKICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgic2hvdWxkIG5vdCBjYWxsIG1hcEJmUmFuZ2UiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYXBCZlJhbmdlVG9BcnJheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWFwQmZSYW5nZVRvQXJyYXkobG93LCBoaWdoLCBhcnJheSkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJzaG91bGQgbm90IGNhbGwgbWFwQmZSYW5nZVRvQXJyYXkiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYXBPbmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1hcE9uZShzcmMsIGRzdCkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJzaG91bGQgbm90IGNhbGwgbWFwQ2lkT25lIik7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9va3VwIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb29rdXAoY29kZSkgewogICAgICByZXR1cm4gTnVtYmVyLmlzSW50ZWdlcihjb2RlKSAmJiBjb2RlIDw9IDB4ZmZmZiA/IGNvZGUgOiB1bmRlZmluZWQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29udGFpbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnRhaW5zKGNvZGUpIHsKICAgICAgcmV0dXJuIE51bWJlci5pc0ludGVnZXIoY29kZSkgJiYgY29kZSA8PSAweGZmZmY7CiAgICB9CiAgfSwgewogICAga2V5OiAiZm9yRWFjaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9yRWFjaChjYWxsYmFjaykgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSAweGZmZmY7IGkrKykgewogICAgICAgIGNhbGxiYWNrKGksIGkpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiY2hhckNvZGVPZiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hhckNvZGVPZih2YWx1ZSkgewogICAgICByZXR1cm4gTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSkgJiYgdmFsdWUgPD0gMHhmZmZmID8gdmFsdWUgOiAtMTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRNYXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1hcCgpIHsKICAgICAgdmFyIG1hcCA9IG5ldyBBcnJheSgweDEwMDAwKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IDB4ZmZmZjsgaSsrKSB7CiAgICAgICAgbWFwW2ldID0gaTsKICAgICAgfQoKICAgICAgcmV0dXJuIG1hcDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsZW5ndGgiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiAweDEwMDAwOwogICAgfQogIH0sIHsKICAgIGtleTogImlzSWRlbnRpdHlDTWFwIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJzaG91bGQgbm90IGFjY2VzcyAuaXNJZGVudGl0eUNNYXAiKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBJZGVudGl0eUNNYXA7Cn0oQ01hcCk7CgpleHBvcnRzLklkZW50aXR5Q01hcCA9IElkZW50aXR5Q01hcDsKCnZhciBCaW5hcnlDTWFwUmVhZGVyID0gZnVuY3Rpb24gQmluYXJ5Q01hcFJlYWRlckNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gaGV4VG9JbnQoYSwgc2l6ZSkgewogICAgdmFyIG4gPSAwOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IHNpemU7IGkrKykgewogICAgICBuID0gbiA8PCA4IHwgYVtpXTsKICAgIH0KCiAgICByZXR1cm4gbiA+Pj4gMDsKICB9CgogIGZ1bmN0aW9uIGhleFRvU3RyKGEsIHNpemUpIHsKICAgIGlmIChzaXplID09PSAxKSB7CiAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGFbMF0sIGFbMV0pOwogICAgfQoKICAgIGlmIChzaXplID09PSAzKSB7CiAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10pOwogICAgfQoKICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGEuc3ViYXJyYXkoMCwgc2l6ZSArIDEpKTsKICB9CgogIGZ1bmN0aW9uIGFkZEhleChhLCBiLCBzaXplKSB7CiAgICB2YXIgYyA9IDA7CgogICAgZm9yICh2YXIgaSA9IHNpemU7IGkgPj0gMDsgaS0tKSB7CiAgICAgIGMgKz0gYVtpXSArIGJbaV07CiAgICAgIGFbaV0gPSBjICYgMjU1OwogICAgICBjID4+PSA4OwogICAgfQogIH0KCiAgZnVuY3Rpb24gaW5jSGV4KGEsIHNpemUpIHsKICAgIHZhciBjID0gMTsKCiAgICBmb3IgKHZhciBpID0gc2l6ZTsgaSA+PSAwICYmIGMgPiAwOyBpLS0pIHsKICAgICAgYyArPSBhW2ldOwogICAgICBhW2ldID0gYyAmIDI1NTsKICAgICAgYyA+Pj0gODsKICAgIH0KICB9CgogIHZhciBNQVhfTlVNX1NJWkUgPSAxNjsKICB2YXIgTUFYX0VOQ09ERURfTlVNX1NJWkUgPSAxOTsKCiAgZnVuY3Rpb24gQmluYXJ5Q01hcFN0cmVhbShkYXRhKSB7CiAgICB0aGlzLmJ1ZmZlciA9IGRhdGE7CiAgICB0aGlzLnBvcyA9IDA7CiAgICB0aGlzLmVuZCA9IGRhdGEubGVuZ3RoOwogICAgdGhpcy50bXBCdWYgPSBuZXcgVWludDhBcnJheShNQVhfRU5DT0RFRF9OVU1fU0laRSk7CiAgfQoKICBCaW5hcnlDTWFwU3RyZWFtLnByb3RvdHlwZSA9IHsKICAgIHJlYWRCeXRlOiBmdW5jdGlvbiByZWFkQnl0ZSgpIHsKICAgICAgaWYgKHRoaXMucG9zID49IHRoaXMuZW5kKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5idWZmZXJbdGhpcy5wb3MrK107CiAgICB9LAogICAgcmVhZE51bWJlcjogZnVuY3Rpb24gcmVhZE51bWJlcigpIHsKICAgICAgdmFyIG4gPSAwOwogICAgICB2YXIgbGFzdDsKCiAgICAgIGRvIHsKICAgICAgICB2YXIgYiA9IHRoaXMucmVhZEJ5dGUoKTsKCiAgICAgICAgaWYgKGIgPCAwKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoInVuZXhwZWN0ZWQgRU9GIGluIGJjbWFwIik7CiAgICAgICAgfQoKICAgICAgICBsYXN0ID0gIShiICYgMHg4MCk7CiAgICAgICAgbiA9IG4gPDwgNyB8IGIgJiAweDdmOwogICAgICB9IHdoaWxlICghbGFzdCk7CgogICAgICByZXR1cm4gbjsKICAgIH0sCiAgICByZWFkU2lnbmVkOiBmdW5jdGlvbiByZWFkU2lnbmVkKCkgewogICAgICB2YXIgbiA9IHRoaXMucmVhZE51bWJlcigpOwogICAgICByZXR1cm4gbiAmIDEgPyB+KG4gPj4+IDEpIDogbiA+Pj4gMTsKICAgIH0sCiAgICByZWFkSGV4OiBmdW5jdGlvbiByZWFkSGV4KG51bSwgc2l6ZSkgewogICAgICBudW0uc2V0KHRoaXMuYnVmZmVyLnN1YmFycmF5KHRoaXMucG9zLCB0aGlzLnBvcyArIHNpemUgKyAxKSk7CiAgICAgIHRoaXMucG9zICs9IHNpemUgKyAxOwogICAgfSwKICAgIHJlYWRIZXhOdW1iZXI6IGZ1bmN0aW9uIHJlYWRIZXhOdW1iZXIobnVtLCBzaXplKSB7CiAgICAgIHZhciBsYXN0OwogICAgICB2YXIgc3RhY2sgPSB0aGlzLnRtcEJ1ZiwKICAgICAgICAgIHNwID0gMDsKCiAgICAgIGRvIHsKICAgICAgICB2YXIgYiA9IHRoaXMucmVhZEJ5dGUoKTsKCiAgICAgICAgaWYgKGIgPCAwKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoInVuZXhwZWN0ZWQgRU9GIGluIGJjbWFwIik7CiAgICAgICAgfQoKICAgICAgICBsYXN0ID0gIShiICYgMHg4MCk7CiAgICAgICAgc3RhY2tbc3ArK10gPSBiICYgMHg3ZjsKICAgICAgfSB3aGlsZSAoIWxhc3QpOwoKICAgICAgdmFyIGkgPSBzaXplLAogICAgICAgICAgYnVmZmVyID0gMCwKICAgICAgICAgIGJ1ZmZlclNpemUgPSAwOwoKICAgICAgd2hpbGUgKGkgPj0gMCkgewogICAgICAgIHdoaWxlIChidWZmZXJTaXplIDwgOCAmJiBzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgICAgICBidWZmZXIgPSBzdGFja1stLXNwXSA8PCBidWZmZXJTaXplIHwgYnVmZmVyOwogICAgICAgICAgYnVmZmVyU2l6ZSArPSA3OwogICAgICAgIH0KCiAgICAgICAgbnVtW2ldID0gYnVmZmVyICYgMjU1OwogICAgICAgIGktLTsKICAgICAgICBidWZmZXIgPj49IDg7CiAgICAgICAgYnVmZmVyU2l6ZSAtPSA4OwogICAgICB9CiAgICB9LAogICAgcmVhZEhleFNpZ25lZDogZnVuY3Rpb24gcmVhZEhleFNpZ25lZChudW0sIHNpemUpIHsKICAgICAgdGhpcy5yZWFkSGV4TnVtYmVyKG51bSwgc2l6ZSk7CiAgICAgIHZhciBzaWduID0gbnVtW3NpemVdICYgMSA/IDI1NSA6IDA7CiAgICAgIHZhciBjID0gMDsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IHNpemU7IGkrKykgewogICAgICAgIGMgPSAoYyAmIDEpIDw8IDggfCBudW1baV07CiAgICAgICAgbnVtW2ldID0gYyA+PiAxIF4gc2lnbjsKICAgICAgfQogICAgfSwKICAgIHJlYWRTdHJpbmc6IGZ1bmN0aW9uIHJlYWRTdHJpbmcoKSB7CiAgICAgIHZhciBsZW4gPSB0aGlzLnJlYWROdW1iZXIoKTsKICAgICAgdmFyIHMgPSAiIjsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICBzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5yZWFkTnVtYmVyKCkpOwogICAgICB9CgogICAgICByZXR1cm4gczsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBwcm9jZXNzQmluYXJ5Q01hcChkYXRhLCBjTWFwLCBleHRlbmQpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHZhciBzdHJlYW0gPSBuZXcgQmluYXJ5Q01hcFN0cmVhbShkYXRhKTsKICAgICAgdmFyIGhlYWRlciA9IHN0cmVhbS5yZWFkQnl0ZSgpOwogICAgICBjTWFwLnZlcnRpY2FsID0gISEoaGVhZGVyICYgMSk7CiAgICAgIHZhciB1c2VDTWFwID0gbnVsbDsKICAgICAgdmFyIHN0YXJ0ID0gbmV3IFVpbnQ4QXJyYXkoTUFYX05VTV9TSVpFKTsKICAgICAgdmFyIGVuZCA9IG5ldyBVaW50OEFycmF5KE1BWF9OVU1fU0laRSk7CgogICAgICB2YXIgX2NoYXIgPSBuZXcgVWludDhBcnJheShNQVhfTlVNX1NJWkUpOwoKICAgICAgdmFyIGNoYXJDb2RlID0gbmV3IFVpbnQ4QXJyYXkoTUFYX05VTV9TSVpFKTsKICAgICAgdmFyIHRtcCA9IG5ldyBVaW50OEFycmF5KE1BWF9OVU1fU0laRSk7CiAgICAgIHZhciBjb2RlOwogICAgICB2YXIgYjsKCiAgICAgIHdoaWxlICgoYiA9IHN0cmVhbS5yZWFkQnl0ZSgpKSA+PSAwKSB7CiAgICAgICAgdmFyIHR5cGUgPSBiID4+IDU7CgogICAgICAgIGlmICh0eXBlID09PSA3KSB7CiAgICAgICAgICBzd2l0Y2ggKGIgJiAweDFmKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzdHJlYW0ucmVhZFN0cmluZygpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIHVzZUNNYXAgPSBzdHJlYW0ucmVhZFN0cmluZygpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHNlcXVlbmNlID0gISEoYiAmIDB4MTApOwogICAgICAgIHZhciBkYXRhU2l6ZSA9IGIgJiAxNTsKCiAgICAgICAgaWYgKGRhdGFTaXplICsgMSA+IE1BWF9OVU1fU0laRSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJwcm9jZXNzQmluYXJ5Q01hcDogSW52YWxpZCBkYXRhU2l6ZS4iKTsKICAgICAgICB9CgogICAgICAgIHZhciB1Y3MyRGF0YVNpemUgPSAxOwogICAgICAgIHZhciBzdWJpdGVtc0NvdW50ID0gc3RyZWFtLnJlYWROdW1iZXIoKTsKICAgICAgICB2YXIgaTsKCiAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKGVuZCwgZGF0YVNpemUpOwogICAgICAgICAgICBhZGRIZXgoZW5kLCBzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICBjTWFwLmFkZENvZGVzcGFjZVJhbmdlKGRhdGFTaXplICsgMSwgaGV4VG9JbnQoc3RhcnQsIGRhdGFTaXplKSwgaGV4VG9JbnQoZW5kLCBkYXRhU2l6ZSkpOwoKICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IHN1Yml0ZW1zQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGluY0hleChlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGFkZEhleChzdGFydCwgZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBjTWFwLmFkZENvZGVzcGFjZVJhbmdlKGRhdGFTaXplICsgMSwgaGV4VG9JbnQoc3RhcnQsIGRhdGFTaXplKSwgaGV4VG9JbnQoZW5kLCBkYXRhU2l6ZSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKGVuZCwgZGF0YVNpemUpOwogICAgICAgICAgICBhZGRIZXgoZW5kLCBzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZE51bWJlcigpOwoKICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IHN1Yml0ZW1zQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGluY0hleChlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGFkZEhleChzdGFydCwgZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoZW5kLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBzdHJlYW0ucmVhZE51bWJlcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KF9jaGFyLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIGNvZGUgPSBzdHJlYW0ucmVhZE51bWJlcigpOwogICAgICAgICAgICBjTWFwLm1hcE9uZShoZXhUb0ludChfY2hhciwgZGF0YVNpemUpLCBjb2RlKTsKCiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCBzdWJpdGVtc0NvdW50OyBpKyspIHsKICAgICAgICAgICAgICBpbmNIZXgoX2NoYXIsIGRhdGFTaXplKTsKCiAgICAgICAgICAgICAgaWYgKCFzZXF1ZW5jZSkgewogICAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIodG1wLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgICBhZGRIZXgoX2NoYXIsIHRtcCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29kZSA9IHN0cmVhbS5yZWFkU2lnbmVkKCkgKyAoY29kZSArIDEpOwogICAgICAgICAgICAgIGNNYXAubWFwT25lKGhleFRvSW50KF9jaGFyLCBkYXRhU2l6ZSksIGNvZGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KHN0YXJ0LCBkYXRhU2l6ZSk7CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4TnVtYmVyKGVuZCwgZGF0YVNpemUpOwogICAgICAgICAgICBhZGRIZXgoZW5kLCBzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICBjb2RlID0gc3RyZWFtLnJlYWROdW1iZXIoKTsKICAgICAgICAgICAgY01hcC5tYXBDaWRSYW5nZShoZXhUb0ludChzdGFydCwgZGF0YVNpemUpLCBoZXhUb0ludChlbmQsIGRhdGFTaXplKSwgY29kZSk7CgogICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgc3ViaXRlbXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaW5jSGV4KGVuZCwgZGF0YVNpemUpOwoKICAgICAgICAgICAgICBpZiAoIXNlcXVlbmNlKSB7CiAgICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgICAgYWRkSGV4KHN0YXJ0LCBlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RhcnQuc2V0KGVuZCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihlbmQsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBhZGRIZXgoZW5kLCBzdGFydCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGNvZGUgPSBzdHJlYW0ucmVhZE51bWJlcigpOwogICAgICAgICAgICAgIGNNYXAubWFwQ2lkUmFuZ2UoaGV4VG9JbnQoc3RhcnQsIGRhdGFTaXplKSwgaGV4VG9JbnQoZW5kLCBkYXRhU2l6ZSksIGNvZGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KF9jaGFyLCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZEhleChjaGFyQ29kZSwgZGF0YVNpemUpOwogICAgICAgICAgICBjTWFwLm1hcE9uZShoZXhUb0ludChfY2hhciwgdWNzMkRhdGFTaXplKSwgaGV4VG9TdHIoY2hhckNvZGUsIGRhdGFTaXplKSk7CgogICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgc3ViaXRlbXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaW5jSGV4KF9jaGFyLCB1Y3MyRGF0YVNpemUpOwoKICAgICAgICAgICAgICBpZiAoIXNlcXVlbmNlKSB7CiAgICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcih0bXAsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgICBhZGRIZXgoX2NoYXIsIHRtcCwgdWNzMkRhdGFTaXplKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGluY0hleChjaGFyQ29kZSwgZGF0YVNpemUpOwogICAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4U2lnbmVkKHRtcCwgZGF0YVNpemUpOwogICAgICAgICAgICAgIGFkZEhleChjaGFyQ29kZSwgdG1wLCBkYXRhU2l6ZSk7CiAgICAgICAgICAgICAgY01hcC5tYXBPbmUoaGV4VG9JbnQoX2NoYXIsIHVjczJEYXRhU2l6ZSksIGhleFRvU3RyKGNoYXJDb2RlLCBkYXRhU2l6ZSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIHN0cmVhbS5yZWFkSGV4KHN0YXJ0LCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihlbmQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgIGFkZEhleChlbmQsIHN0YXJ0LCB1Y3MyRGF0YVNpemUpOwogICAgICAgICAgICBzdHJlYW0ucmVhZEhleChjaGFyQ29kZSwgZGF0YVNpemUpOwogICAgICAgICAgICBjTWFwLm1hcEJmUmFuZ2UoaGV4VG9JbnQoc3RhcnQsIHVjczJEYXRhU2l6ZSksIGhleFRvSW50KGVuZCwgdWNzMkRhdGFTaXplKSwgaGV4VG9TdHIoY2hhckNvZGUsIGRhdGFTaXplKSk7CgogICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgc3ViaXRlbXNDb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgaW5jSGV4KGVuZCwgdWNzMkRhdGFTaXplKTsKCiAgICAgICAgICAgICAgaWYgKCFzZXF1ZW5jZSkgewogICAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXhOdW1iZXIoc3RhcnQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgICBhZGRIZXgoc3RhcnQsIGVuZCwgdWNzMkRhdGFTaXplKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RhcnQuc2V0KGVuZCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdHJlYW0ucmVhZEhleE51bWJlcihlbmQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgYWRkSGV4KGVuZCwgc3RhcnQsIHVjczJEYXRhU2l6ZSk7CiAgICAgICAgICAgICAgc3RyZWFtLnJlYWRIZXgoY2hhckNvZGUsIGRhdGFTaXplKTsKICAgICAgICAgICAgICBjTWFwLm1hcEJmUmFuZ2UoaGV4VG9JbnQoc3RhcnQsIHVjczJEYXRhU2l6ZSksIGhleFRvSW50KGVuZCwgdWNzMkRhdGFTaXplKSwgaGV4VG9TdHIoY2hhckNvZGUsIGRhdGFTaXplKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoInByb2Nlc3NCaW5hcnlDTWFwOiBVbmtub3duIHR5cGU6ICIgKyB0eXBlKSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh1c2VDTWFwKSB7CiAgICAgICAgcmVzb2x2ZShleHRlbmQodXNlQ01hcCkpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmVzb2x2ZShjTWFwKTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gQmluYXJ5Q01hcFJlYWRlcigpIHt9CgogIEJpbmFyeUNNYXBSZWFkZXIucHJvdG90eXBlID0gewogICAgcHJvY2VzczogcHJvY2Vzc0JpbmFyeUNNYXAKICB9OwogIHJldHVybiBCaW5hcnlDTWFwUmVhZGVyOwp9KCk7Cgp2YXIgQ01hcEZhY3RvcnkgPSBmdW5jdGlvbiBDTWFwRmFjdG9yeUNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gc3RyVG9JbnQoc3RyKSB7CiAgICB2YXIgYSA9IDA7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHsKICAgICAgYSA9IGEgPDwgOCB8IHN0ci5jaGFyQ29kZUF0KGkpOwogICAgfQoKICAgIHJldHVybiBhID4+PiAwOwogIH0KCiAgZnVuY3Rpb24gZXhwZWN0U3RyaW5nKG9iaikgewogICAgaWYgKCEoMCwgX3V0aWwuaXNTdHJpbmcpKG9iaikpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNYWxmb3JtZWQgQ01hcDogZXhwZWN0ZWQgc3RyaW5nLiIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gZXhwZWN0SW50KG9iaikgewogICAgaWYgKCFOdW1iZXIuaXNJbnRlZ2VyKG9iaikpIHsKICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJNYWxmb3JtZWQgQ01hcDogZXhwZWN0ZWQgaW50LiIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcGFyc2VCZkNoYXIoY01hcCwgbGV4ZXIpIHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIHZhciBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNFT0YpKG9iaikpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiZW5kYmZjaGFyIikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV4cGVjdFN0cmluZyhvYmopOwogICAgICB2YXIgc3JjID0gc3RyVG9JbnQob2JqKTsKICAgICAgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CiAgICAgIGV4cGVjdFN0cmluZyhvYmopOwogICAgICB2YXIgZHN0ID0gb2JqOwogICAgICBjTWFwLm1hcE9uZShzcmMsIGRzdCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwYXJzZUJmUmFuZ2UoY01hcCwgbGV4ZXIpIHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIHZhciBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNFT0YpKG9iaikpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiZW5kYmZyYW5nZSIpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBleHBlY3RTdHJpbmcob2JqKTsKICAgICAgdmFyIGxvdyA9IHN0clRvSW50KG9iaik7CiAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwogICAgICBleHBlY3RTdHJpbmcob2JqKTsKICAgICAgdmFyIGhpZ2ggPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKG9iaikgfHwgKDAsIF91dGlsLmlzU3RyaW5nKShvYmopKSB7CiAgICAgICAgdmFyIGRzdExvdyA9IE51bWJlci5pc0ludGVnZXIob2JqKSA/IFN0cmluZy5mcm9tQ2hhckNvZGUob2JqKSA6IG9iajsKICAgICAgICBjTWFwLm1hcEJmUmFuZ2UobG93LCBoaWdoLCBkc3RMb3cpOwogICAgICB9IGVsc2UgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiWyIpKSB7CiAgICAgICAgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CiAgICAgICAgdmFyIGFycmF5ID0gW107CgogICAgICAgIHdoaWxlICghKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmosICJdIikgJiYgISgwLCBfcHJpbWl0aXZlcy5pc0VPRikob2JqKSkgewogICAgICAgICAgYXJyYXkucHVzaChvYmopOwogICAgICAgICAgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CiAgICAgICAgfQoKICAgICAgICBjTWFwLm1hcEJmUmFuZ2VUb0FycmF5KGxvdywgaGlnaCwgYXJyYXkpOwogICAgICB9IGVsc2UgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIGJmIHJhbmdlLiIpOwogIH0KCiAgZnVuY3Rpb24gcGFyc2VDaWRDaGFyKGNNYXAsIGxleGVyKSB7CiAgICB3aGlsZSAodHJ1ZSkgewogICAgICB2YXIgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CgogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzRU9GKShvYmopKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNDbWQpKG9iaiwgImVuZGNpZGNoYXIiKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIHZhciBzcmMgPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgZXhwZWN0SW50KG9iaik7CiAgICAgIHZhciBkc3QgPSBvYmo7CiAgICAgIGNNYXAubWFwT25lKHNyYywgZHN0KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHBhcnNlQ2lkUmFuZ2UoY01hcCwgbGV4ZXIpIHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIHZhciBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNFT0YpKG9iaikpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiZW5kY2lkcmFuZ2UiKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIHZhciBsb3cgPSBzdHJUb0ludChvYmopOwogICAgICBvYmogPSBsZXhlci5nZXRPYmooKTsKICAgICAgZXhwZWN0U3RyaW5nKG9iaik7CiAgICAgIHZhciBoaWdoID0gc3RyVG9JbnQob2JqKTsKICAgICAgb2JqID0gbGV4ZXIuZ2V0T2JqKCk7CiAgICAgIGV4cGVjdEludChvYmopOwogICAgICB2YXIgZHN0TG93ID0gb2JqOwogICAgICBjTWFwLm1hcENpZFJhbmdlKGxvdywgaGlnaCwgZHN0TG93KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHBhcnNlQ29kZXNwYWNlUmFuZ2UoY01hcCwgbGV4ZXIpIHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgIHZhciBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNFT0YpKG9iaikpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0NtZCkob2JqLCAiZW5kY29kZXNwYWNlcmFuZ2UiKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCEoMCwgX3V0aWwuaXNTdHJpbmcpKG9iaikpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgdmFyIGxvdyA9IHN0clRvSW50KG9iaik7CiAgICAgIG9iaiA9IGxleGVyLmdldE9iaigpOwoKICAgICAgaWYgKCEoMCwgX3V0aWwuaXNTdHJpbmcpKG9iaikpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgdmFyIGhpZ2ggPSBzdHJUb0ludChvYmopOwogICAgICBjTWFwLmFkZENvZGVzcGFjZVJhbmdlKG9iai5sZW5ndGgsIGxvdywgaGlnaCk7CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIGNvZGVzcGFjZSByYW5nZS4iKTsKICB9CgogIGZ1bmN0aW9uIHBhcnNlV01vZGUoY01hcCwgbGV4ZXIpIHsKICAgIHZhciBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihvYmopKSB7CiAgICAgIGNNYXAudmVydGljYWwgPSAhIW9iajsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHBhcnNlQ01hcE5hbWUoY01hcCwgbGV4ZXIpIHsKICAgIHZhciBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzTmFtZSkob2JqKSAmJiAoMCwgX3V0aWwuaXNTdHJpbmcpKG9iai5uYW1lKSkgewogICAgICBjTWFwLm5hbWUgPSBvYmoubmFtZTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHBhcnNlQ01hcChjTWFwLCBsZXhlciwgZmV0Y2hCdWlsdEluQ01hcCwgdXNlQ01hcCkgewogICAgdmFyIHByZXZpb3VzOwogICAgdmFyIGVtYmVkZGVkVXNlQ01hcDsKCiAgICBvYmpMb29wOiB3aGlsZSAodHJ1ZSkgewogICAgICB0cnkgewogICAgICAgIHZhciBvYmogPSBsZXhlci5nZXRPYmooKTsKCiAgICAgICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc0VPRikob2JqKSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfSBlbHNlIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShvYmopKSB7CiAgICAgICAgICBpZiAob2JqLm5hbWUgPT09ICJXTW9kZSIpIHsKICAgICAgICAgICAgcGFyc2VXTW9kZShjTWFwLCBsZXhlcik7CiAgICAgICAgICB9IGVsc2UgaWYgKG9iai5uYW1lID09PSAiQ01hcE5hbWUiKSB7CiAgICAgICAgICAgIHBhcnNlQ01hcE5hbWUoY01hcCwgbGV4ZXIpOwogICAgICAgICAgfQoKICAgICAgICAgIHByZXZpb3VzID0gb2JqOwogICAgICAgIH0gZWxzZSBpZiAoKDAsIF9wcmltaXRpdmVzLmlzQ21kKShvYmopKSB7CiAgICAgICAgICBzd2l0Y2ggKG9iai5jbWQpIHsKICAgICAgICAgICAgY2FzZSAiZW5kY21hcCI6CiAgICAgICAgICAgICAgYnJlYWsgb2JqTG9vcDsKCiAgICAgICAgICAgIGNhc2UgInVzZWNtYXAiOgogICAgICAgICAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNOYW1lKShwcmV2aW91cykpIHsKICAgICAgICAgICAgICAgIGVtYmVkZGVkVXNlQ01hcCA9IHByZXZpb3VzLm5hbWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgImJlZ2luY29kZXNwYWNlcmFuZ2UiOgogICAgICAgICAgICAgIHBhcnNlQ29kZXNwYWNlUmFuZ2UoY01hcCwgbGV4ZXIpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiYmVnaW5iZmNoYXIiOgogICAgICAgICAgICAgIHBhcnNlQmZDaGFyKGNNYXAsIGxleGVyKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgImJlZ2luY2lkY2hhciI6CiAgICAgICAgICAgICAgcGFyc2VDaWRDaGFyKGNNYXAsIGxleGVyKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgImJlZ2luYmZyYW5nZSI6CiAgICAgICAgICAgICAgcGFyc2VCZlJhbmdlKGNNYXAsIGxleGVyKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgImJlZ2luY2lkcmFuZ2UiOgogICAgICAgICAgICAgIHBhcnNlQ2lkUmFuZ2UoY01hcCwgbGV4ZXIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgICAgdGhyb3cgZXg7CiAgICAgICAgfQoKICAgICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgY01hcCBkYXRhOiAiICsgZXgpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICB9CgogICAgaWYgKCF1c2VDTWFwICYmIGVtYmVkZGVkVXNlQ01hcCkgewogICAgICB1c2VDTWFwID0gZW1iZWRkZWRVc2VDTWFwOwogICAgfQoKICAgIGlmICh1c2VDTWFwKSB7CiAgICAgIHJldHVybiBleHRlbmRDTWFwKGNNYXAsIGZldGNoQnVpbHRJbkNNYXAsIHVzZUNNYXApOwogICAgfQoKICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY01hcCk7CiAgfQoKICBmdW5jdGlvbiBleHRlbmRDTWFwKGNNYXAsIGZldGNoQnVpbHRJbkNNYXAsIHVzZUNNYXApIHsKICAgIHJldHVybiBjcmVhdGVCdWlsdEluQ01hcCh1c2VDTWFwLCBmZXRjaEJ1aWx0SW5DTWFwKS50aGVuKGZ1bmN0aW9uIChuZXdDTWFwKSB7CiAgICAgIGNNYXAudXNlQ01hcCA9IG5ld0NNYXA7CgogICAgICBpZiAoY01hcC5udW1Db2Rlc3BhY2VSYW5nZXMgPT09IDApIHsKICAgICAgICB2YXIgdXNlQ29kZXNwYWNlUmFuZ2VzID0gY01hcC51c2VDTWFwLmNvZGVzcGFjZVJhbmdlczsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB1c2VDb2Rlc3BhY2VSYW5nZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNNYXAuY29kZXNwYWNlUmFuZ2VzW2ldID0gdXNlQ29kZXNwYWNlUmFuZ2VzW2ldLnNsaWNlKCk7CiAgICAgICAgfQoKICAgICAgICBjTWFwLm51bUNvZGVzcGFjZVJhbmdlcyA9IGNNYXAudXNlQ01hcC5udW1Db2Rlc3BhY2VSYW5nZXM7CiAgICAgIH0KCiAgICAgIGNNYXAudXNlQ01hcC5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgaWYgKCFjTWFwLmNvbnRhaW5zKGtleSkpIHsKICAgICAgICAgIGNNYXAubWFwT25lKGtleSwgY01hcC51c2VDTWFwLmxvb2t1cChrZXkpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gY01hcDsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlQnVpbHRJbkNNYXAobmFtZSwgZmV0Y2hCdWlsdEluQ01hcCkgewogICAgaWYgKG5hbWUgPT09ICJJZGVudGl0eS1IIikgewogICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBJZGVudGl0eUNNYXAoZmFsc2UsIDIpKTsKICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gIklkZW50aXR5LVYiKSB7CiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IElkZW50aXR5Q01hcCh0cnVlLCAyKSk7CiAgICB9CgogICAgaWYgKCFCVUlMVF9JTl9DTUFQUy5pbmNsdWRlcyhuYW1lKSkgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJVbmtub3duIENNYXAgbmFtZTogIiArIG5hbWUpKTsKICAgIH0KCiAgICBpZiAoIWZldGNoQnVpbHRJbkNNYXApIHsKICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiQnVpbHQtaW4gQ01hcCBwYXJhbWV0ZXJzIGFyZSBub3QgcHJvdmlkZWQuIikpOwogICAgfQoKICAgIHJldHVybiBmZXRjaEJ1aWx0SW5DTWFwKG5hbWUpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgdmFyIGNNYXBEYXRhID0gZGF0YS5jTWFwRGF0YSwKICAgICAgICAgIGNvbXByZXNzaW9uVHlwZSA9IGRhdGEuY29tcHJlc3Npb25UeXBlOwogICAgICB2YXIgY01hcCA9IG5ldyBDTWFwKHRydWUpOwoKICAgICAgaWYgKGNvbXByZXNzaW9uVHlwZSA9PT0gX3V0aWwuQ01hcENvbXByZXNzaW9uVHlwZS5CSU5BUlkpIHsKICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUNNYXBSZWFkZXIoKS5wcm9jZXNzKGNNYXBEYXRhLCBjTWFwLCBmdW5jdGlvbiAodXNlQ01hcCkgewogICAgICAgICAgcmV0dXJuIGV4dGVuZENNYXAoY01hcCwgZmV0Y2hCdWlsdEluQ01hcCwgdXNlQ01hcCk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChjb21wcmVzc2lvblR5cGUgPT09IF91dGlsLkNNYXBDb21wcmVzc2lvblR5cGUuTk9ORSkgewogICAgICAgIHZhciBsZXhlciA9IG5ldyBfcGFyc2VyLkxleGVyKG5ldyBfc3RyZWFtLlN0cmVhbShjTWFwRGF0YSkpOwogICAgICAgIHJldHVybiBwYXJzZUNNYXAoY01hcCwgbGV4ZXIsIGZldGNoQnVpbHRJbkNNYXAsIG51bGwpOwogICAgICB9CgogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCJUT0RPOiBPbmx5IEJJTkFSWS9OT05FIENNYXAgY29tcHJlc3Npb24gaXMgY3VycmVudGx5IHN1cHBvcnRlZC4iKSk7CiAgICB9KTsKICB9CgogIHJldHVybiB7CiAgICBjcmVhdGU6IGZ1bmN0aW9uIGNyZWF0ZShwYXJhbXMpIHsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBlbmNvZGluZywgZmV0Y2hCdWlsdEluQ01hcCwgdXNlQ01hcCwgY01hcCwgbGV4ZXI7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclsiZGVmYXVsdCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBlbmNvZGluZyA9IHBhcmFtcy5lbmNvZGluZzsKICAgICAgICAgICAgICAgIGZldGNoQnVpbHRJbkNNYXAgPSBwYXJhbXMuZmV0Y2hCdWlsdEluQ01hcDsKICAgICAgICAgICAgICAgIHVzZUNNYXAgPSBwYXJhbXMudXNlQ01hcDsKCiAgICAgICAgICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGVuY29kaW5nKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgY3JlYXRlQnVpbHRJbkNNYXAoZW5jb2RpbmcubmFtZSwgZmV0Y2hCdWlsdEluQ01hcCkpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkoZW5jb2RpbmcpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY01hcCA9IG5ldyBDTWFwKCk7CiAgICAgICAgICAgICAgICBsZXhlciA9IG5ldyBfcGFyc2VyLkxleGVyKGVuY29kaW5nKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHBhcnNlQ01hcChjTWFwLCBsZXhlciwgZmV0Y2hCdWlsdEluQ01hcCwgdXNlQ01hcCkudGhlbihmdW5jdGlvbiAocGFyc2VkQ01hcCkgewogICAgICAgICAgICAgICAgICBpZiAocGFyc2VkQ01hcC5pc0lkZW50aXR5Q01hcCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVCdWlsdEluQ01hcChwYXJzZWRDTWFwLm5hbWUsIGZldGNoQnVpbHRJbkNNYXApOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VkQ01hcDsKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRW5jb2RpbmcgcmVxdWlyZWQuIik7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfTsKfSgpOwoKZXhwb3J0cy5DTWFwRmFjdG9yeSA9IENNYXBGYWN0b3J5OwoKLyoqKi8gfSksCi8qIDIyMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldEZvbnRUeXBlID0gZ2V0Rm9udFR5cGU7CmV4cG9ydHMuSWRlbnRpdHlUb1VuaWNvZGVNYXAgPSBleHBvcnRzLlRvVW5pY29kZU1hcCA9IGV4cG9ydHMuRm9udEZsYWdzID0gZXhwb3J0cy5Gb250ID0gZXhwb3J0cy5FcnJvckZvbnQgPSBleHBvcnRzLlNFQUNfQU5BTFlTSVNfRU5BQkxFRCA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2NmZl9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyMyk7Cgp2YXIgX2dseXBobGlzdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI2KTsKCnZhciBfZW5jb2RpbmdzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMjUpOwoKdmFyIF9zdGFuZGFyZF9mb250cyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI3KTsKCnZhciBfdW5pY29kZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI4KTsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCnZhciBfZm9udF9yZW5kZXJlciA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI5KTsKCnZhciBfY21hcCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjIxKTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDUpOwoKdmFyIF90eXBlMV9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIzMCk7CgpmdW5jdGlvbiBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihvLCBhbGxvd0FycmF5TGlrZSkgeyB2YXIgaXQ7IGlmICh0eXBlb2YgU3ltYm9sID09PSAidW5kZWZpbmVkIiB8fCBvW1N5bWJvbC5pdGVyYXRvcl0gPT0gbnVsbCkgeyBpZiAoQXJyYXkuaXNBcnJheShvKSB8fCAoaXQgPSBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobykpIHx8IGFsbG93QXJyYXlMaWtlICYmIG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgeyBpZiAoaXQpIG8gPSBpdDsgdmFyIGkgPSAwOyB2YXIgRiA9IGZ1bmN0aW9uIEYoKSB7fTsgcmV0dXJuIHsgczogRiwgbjogZnVuY3Rpb24gbigpIHsgaWYgKGkgPj0gby5sZW5ndGgpIHJldHVybiB7IGRvbmU6IHRydWUgfTsgcmV0dXJuIHsgZG9uZTogZmFsc2UsIHZhbHVlOiBvW2krK10gfTsgfSwgZTogZnVuY3Rpb24gZShfZTIpIHsgdGhyb3cgX2UyOyB9LCBmOiBGIH07IH0gdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9IHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSwgZGlkRXJyID0gZmFsc2UsIGVycjsgcmV0dXJuIHsgczogZnVuY3Rpb24gcygpIHsgaXQgPSBvW1N5bWJvbC5pdGVyYXRvcl0oKTsgfSwgbjogZnVuY3Rpb24gbigpIHsgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7IG5vcm1hbENvbXBsZXRpb24gPSBzdGVwLmRvbmU7IHJldHVybiBzdGVwOyB9LCBlOiBmdW5jdGlvbiBlKF9lMykgeyBkaWRFcnIgPSB0cnVlOyBlcnIgPSBfZTM7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGlmICghbm9ybWFsQ29tcGxldGlvbiAmJiBpdFsicmV0dXJuIl0gIT0gbnVsbCkgaXRbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChkaWRFcnIpIHRocm93IGVycjsgfSB9IH07IH0KCmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkgeyByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpOyB9CgpmdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9CgpmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOyBpZiAobiA9PT0gIk9iamVjdCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09ICJNYXAiIHx8IG4gPT09ICJTZXQiKSByZXR1cm4gQXJyYXkuZnJvbShvKTsgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfQoKZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9CgpmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSAidW5kZWZpbmVkIiB8fCAhKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoYXJyKSkpIHJldHVybjsgdmFyIF9hcnIgPSBbXTsgdmFyIF9uID0gdHJ1ZTsgdmFyIF9kID0gZmFsc2U7IHZhciBfZSA9IHVuZGVmaW5lZDsgdHJ5IHsgZm9yICh2YXIgX2kgPSBhcnJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfczsgIShfbiA9IChfcyA9IF9pLm5leHQoKSkuZG9uZSk7IF9uID0gdHJ1ZSkgeyBfYXJyLnB1c2goX3MudmFsdWUpOyBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7IH0gfSBjYXRjaCAoZXJyKSB7IF9kID0gdHJ1ZTsgX2UgPSBlcnI7IH0gZmluYWxseSB7IHRyeSB7IGlmICghX24gJiYgX2lbInJldHVybiJdICE9IG51bGwpIF9pWyJyZXR1cm4iXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0KCmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjsgfQoKdmFyIFBSSVZBVEVfVVNFX0FSRUFTID0gW1sweGUwMDAsIDB4ZjhmZl0sIFsweDEwMDAwMCwgMHgxMGZmZmRdXTsKdmFyIFBERl9HTFlQSF9TUEFDRV9VTklUUyA9IDEwMDA7CnZhciBTRUFDX0FOQUxZU0lTX0VOQUJMRUQgPSB0cnVlOwpleHBvcnRzLlNFQUNfQU5BTFlTSVNfRU5BQkxFRCA9IFNFQUNfQU5BTFlTSVNfRU5BQkxFRDsKdmFyIEVYUE9SVF9EQVRBX1BST1BFUlRJRVMgPSBbImFzY2VudCIsICJiYm94IiwgImJsYWNrIiwgImJvbGQiLCAiY2hhclByb2NPcGVyYXRvckxpc3QiLCAiY29tcG9zaXRlIiwgImRhdGEiLCAiZGVmYXVsdFZNZXRyaWNzIiwgImRlZmF1bHRXaWR0aCIsICJkZXNjZW50IiwgImZhbGxiYWNrTmFtZSIsICJmb250TWF0cml4IiwgImZvbnRUeXBlIiwgImlzTW9ub3NwYWNlIiwgImlzU2VyaWZGb250IiwgImlzVHlwZTNGb250IiwgIml0YWxpYyIsICJsb2FkZWROYW1lIiwgIm1pbWV0eXBlIiwgIm1pc3NpbmdGaWxlIiwgIm5hbWUiLCAicmVtZWFzdXJlIiwgInN1YnR5cGUiLCAidHlwZSIsICJ2ZXJ0aWNhbCJdOwp2YXIgRVhQT1JUX0RBVEFfRVhUUkFfUFJPUEVSVElFUyA9IFsiY01hcCIsICJkZWZhdWx0RW5jb2RpbmciLCAiZGlmZmVyZW5jZXMiLCAiaXNTeW1ib2xpY0ZvbnQiLCAic2VhY01hcCIsICJ0b0ZvbnRDaGFyIiwgInRvVW5pY29kZSIsICJ2bWV0cmljcyIsICJ3aWR0aHMiXTsKdmFyIEZvbnRGbGFncyA9IHsKICBGaXhlZFBpdGNoOiAxLAogIFNlcmlmOiAyLAogIFN5bWJvbGljOiA0LAogIFNjcmlwdDogOCwKICBOb25zeW1ib2xpYzogMzIsCiAgSXRhbGljOiA2NCwKICBBbGxDYXA6IDY1NTM2LAogIFNtYWxsQ2FwOiAxMzEwNzIsCiAgRm9yY2VCb2xkOiAyNjIxNDQKfTsKZXhwb3J0cy5Gb250RmxhZ3MgPSBGb250RmxhZ3M7CnZhciBNYWNTdGFuZGFyZEdseXBoT3JkZXJpbmcgPSBbIi5ub3RkZWYiLCAiLm51bGwiLCAibm9ubWFya2luZ3JldHVybiIsICJzcGFjZSIsICJleGNsYW0iLCAicXVvdGVkYmwiLCAibnVtYmVyc2lnbiIsICJkb2xsYXIiLCAicGVyY2VudCIsICJhbXBlcnNhbmQiLCAicXVvdGVzaW5nbGUiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2siLCAicGx1cyIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJhdCIsICJBIiwgIkIiLCAiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkgiLCAiSSIsICJKIiwgIksiLCAiTCIsICJNIiwgIk4iLCAiTyIsICJQIiwgIlEiLCAiUiIsICJTIiwgIlQiLCAiVSIsICJWIiwgIlciLCAiWCIsICJZIiwgIloiLCAiYnJhY2tldGxlZnQiLCAiYmFja3NsYXNoIiwgImJyYWNrZXRyaWdodCIsICJhc2NpaWNpcmN1bSIsICJ1bmRlcnNjb3JlIiwgImdyYXZlIiwgImEiLCAiYiIsICJjIiwgImQiLCAiZSIsICJmIiwgImciLCAiaCIsICJpIiwgImoiLCAiayIsICJsIiwgIm0iLCAibiIsICJvIiwgInAiLCAicSIsICJyIiwgInMiLCAidCIsICJ1IiwgInYiLCAidyIsICJ4IiwgInkiLCAieiIsICJicmFjZWxlZnQiLCAiYmFyIiwgImJyYWNlcmlnaHQiLCAiYXNjaWl0aWxkZSIsICJBZGllcmVzaXMiLCAiQXJpbmciLCAiQ2NlZGlsbGEiLCAiRWFjdXRlIiwgIk50aWxkZSIsICJPZGllcmVzaXMiLCAiVWRpZXJlc2lzIiwgImFhY3V0ZSIsICJhZ3JhdmUiLCAiYWNpcmN1bWZsZXgiLCAiYWRpZXJlc2lzIiwgImF0aWxkZSIsICJhcmluZyIsICJjY2VkaWxsYSIsICJlYWN1dGUiLCAiZWdyYXZlIiwgImVjaXJjdW1mbGV4IiwgImVkaWVyZXNpcyIsICJpYWN1dGUiLCAiaWdyYXZlIiwgImljaXJjdW1mbGV4IiwgImlkaWVyZXNpcyIsICJudGlsZGUiLCAib2FjdXRlIiwgIm9ncmF2ZSIsICJvY2lyY3VtZmxleCIsICJvZGllcmVzaXMiLCAib3RpbGRlIiwgInVhY3V0ZSIsICJ1Z3JhdmUiLCAidWNpcmN1bWZsZXgiLCAidWRpZXJlc2lzIiwgImRhZ2dlciIsICJkZWdyZWUiLCAiY2VudCIsICJzdGVybGluZyIsICJzZWN0aW9uIiwgImJ1bGxldCIsICJwYXJhZ3JhcGgiLCAiZ2VybWFuZGJscyIsICJyZWdpc3RlcmVkIiwgImNvcHlyaWdodCIsICJ0cmFkZW1hcmsiLCAiYWN1dGUiLCAiZGllcmVzaXMiLCAibm90ZXF1YWwiLCAiQUUiLCAiT3NsYXNoIiwgImluZmluaXR5IiwgInBsdXNtaW51cyIsICJsZXNzZXF1YWwiLCAiZ3JlYXRlcmVxdWFsIiwgInllbiIsICJtdSIsICJwYXJ0aWFsZGlmZiIsICJzdW1tYXRpb24iLCAicHJvZHVjdCIsICJwaSIsICJpbnRlZ3JhbCIsICJvcmRmZW1pbmluZSIsICJvcmRtYXNjdWxpbmUiLCAiT21lZ2EiLCAiYWUiLCAib3NsYXNoIiwgInF1ZXN0aW9uZG93biIsICJleGNsYW1kb3duIiwgImxvZ2ljYWxub3QiLCAicmFkaWNhbCIsICJmbG9yaW4iLCAiYXBwcm94ZXF1YWwiLCAiRGVsdGEiLCAiZ3VpbGxlbW90bGVmdCIsICJndWlsbGVtb3RyaWdodCIsICJlbGxpcHNpcyIsICJub25icmVha2luZ3NwYWNlIiwgIkFncmF2ZSIsICJBdGlsZGUiLCAiT3RpbGRlIiwgIk9FIiwgIm9lIiwgImVuZGFzaCIsICJlbWRhc2giLCAicXVvdGVkYmxsZWZ0IiwgInF1b3RlZGJscmlnaHQiLCAicXVvdGVsZWZ0IiwgInF1b3RlcmlnaHQiLCAiZGl2aWRlIiwgImxvemVuZ2UiLCAieWRpZXJlc2lzIiwgIllkaWVyZXNpcyIsICJmcmFjdGlvbiIsICJjdXJyZW5jeSIsICJndWlsc2luZ2xsZWZ0IiwgImd1aWxzaW5nbHJpZ2h0IiwgImZpIiwgImZsIiwgImRhZ2dlcmRibCIsICJwZXJpb2RjZW50ZXJlZCIsICJxdW90ZXNpbmdsYmFzZSIsICJxdW90ZWRibGJhc2UiLCAicGVydGhvdXNhbmQiLCAiQWNpcmN1bWZsZXgiLCAiRWNpcmN1bWZsZXgiLCAiQWFjdXRlIiwgIkVkaWVyZXNpcyIsICJFZ3JhdmUiLCAiSWFjdXRlIiwgIkljaXJjdW1mbGV4IiwgIklkaWVyZXNpcyIsICJJZ3JhdmUiLCAiT2FjdXRlIiwgIk9jaXJjdW1mbGV4IiwgImFwcGxlIiwgIk9ncmF2ZSIsICJVYWN1dGUiLCAiVWNpcmN1bWZsZXgiLCAiVWdyYXZlIiwgImRvdGxlc3NpIiwgImNpcmN1bWZsZXgiLCAidGlsZGUiLCAibWFjcm9uIiwgImJyZXZlIiwgImRvdGFjY2VudCIsICJyaW5nIiwgImNlZGlsbGEiLCAiaHVuZ2FydW1sYXV0IiwgIm9nb25layIsICJjYXJvbiIsICJMc2xhc2giLCAibHNsYXNoIiwgIlNjYXJvbiIsICJzY2Fyb24iLCAiWmNhcm9uIiwgInpjYXJvbiIsICJicm9rZW5iYXIiLCAiRXRoIiwgImV0aCIsICJZYWN1dGUiLCAieWFjdXRlIiwgIlRob3JuIiwgInRob3JuIiwgIm1pbnVzIiwgIm11bHRpcGx5IiwgIm9uZXN1cGVyaW9yIiwgInR3b3N1cGVyaW9yIiwgInRocmVlc3VwZXJpb3IiLCAib25laGFsZiIsICJvbmVxdWFydGVyIiwgInRocmVlcXVhcnRlcnMiLCAiZnJhbmMiLCAiR2JyZXZlIiwgImdicmV2ZSIsICJJZG90YWNjZW50IiwgIlNjZWRpbGxhIiwgInNjZWRpbGxhIiwgIkNhY3V0ZSIsICJjYWN1dGUiLCAiQ2Nhcm9uIiwgImNjYXJvbiIsICJkY3JvYXQiXTsKCmZ1bmN0aW9uIGFkanVzdFdpZHRocyhwcm9wZXJ0aWVzKSB7CiAgaWYgKCFwcm9wZXJ0aWVzLmZvbnRNYXRyaXgpIHsKICAgIHJldHVybjsKICB9CgogIGlmIChwcm9wZXJ0aWVzLmZvbnRNYXRyaXhbMF0gPT09IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYWzBdKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgc2NhbGUgPSAwLjAwMSAvIHByb3BlcnRpZXMuZm9udE1hdHJpeFswXTsKICB2YXIgZ2x5cGhzV2lkdGhzID0gcHJvcGVydGllcy53aWR0aHM7CgogIGZvciAodmFyIGdseXBoIGluIGdseXBoc1dpZHRocykgewogICAgZ2x5cGhzV2lkdGhzW2dseXBoXSAqPSBzY2FsZTsKICB9CgogIHByb3BlcnRpZXMuZGVmYXVsdFdpZHRoICo9IHNjYWxlOwp9CgpmdW5jdGlvbiBhZGp1c3RUb1VuaWNvZGUocHJvcGVydGllcywgYnVpbHRJbkVuY29kaW5nKSB7CiAgaWYgKHByb3BlcnRpZXMuaGFzSW5jbHVkZWRUb1VuaWNvZGVNYXApIHsKICAgIHJldHVybjsKICB9CgogIGlmIChwcm9wZXJ0aWVzLmhhc0VuY29kaW5nKSB7CiAgICByZXR1cm47CiAgfQoKICBpZiAoYnVpbHRJbkVuY29kaW5nID09PSBwcm9wZXJ0aWVzLmRlZmF1bHRFbmNvZGluZykgewogICAgcmV0dXJuOwogIH0KCiAgaWYgKHByb3BlcnRpZXMudG9Vbmljb2RlIGluc3RhbmNlb2YgSWRlbnRpdHlUb1VuaWNvZGVNYXApIHsKICAgIHJldHVybjsKICB9CgogIHZhciB0b1VuaWNvZGUgPSBbXSwKICAgICAgZ2x5cGhzVW5pY29kZU1hcCA9ICgwLCBfZ2x5cGhsaXN0LmdldEdseXBoc1VuaWNvZGUpKCk7CgogIGZvciAodmFyIGNoYXJDb2RlIGluIGJ1aWx0SW5FbmNvZGluZykgewogICAgdmFyIGdseXBoTmFtZSA9IGJ1aWx0SW5FbmNvZGluZ1tjaGFyQ29kZV07CiAgICB2YXIgdW5pY29kZSA9ICgwLCBfdW5pY29kZS5nZXRVbmljb2RlRm9yR2x5cGgpKGdseXBoTmFtZSwgZ2x5cGhzVW5pY29kZU1hcCk7CgogICAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICAgIHRvVW5pY29kZVtjaGFyQ29kZV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHVuaWNvZGUpOwogICAgfQogIH0KCiAgcHJvcGVydGllcy50b1VuaWNvZGUuYW1lbmQodG9Vbmljb2RlKTsKfQoKZnVuY3Rpb24gZ2V0Rm9udFR5cGUodHlwZSwgc3VidHlwZSkgewogIHN3aXRjaCAodHlwZSkgewogICAgY2FzZSAiVHlwZTEiOgogICAgICByZXR1cm4gc3VidHlwZSA9PT0gIlR5cGUxQyIgPyBfdXRpbC5Gb250VHlwZS5UWVBFMUMgOiBfdXRpbC5Gb250VHlwZS5UWVBFMTsKCiAgICBjYXNlICJDSURGb250VHlwZTAiOgogICAgICByZXR1cm4gc3VidHlwZSA9PT0gIkNJREZvbnRUeXBlMEMiID8gX3V0aWwuRm9udFR5cGUuQ0lERk9OVFRZUEUwQyA6IF91dGlsLkZvbnRUeXBlLkNJREZPTlRUWVBFMDsKCiAgICBjYXNlICJPcGVuVHlwZSI6CiAgICAgIHJldHVybiBfdXRpbC5Gb250VHlwZS5PUEVOVFlQRTsKCiAgICBjYXNlICJUcnVlVHlwZSI6CiAgICAgIHJldHVybiBfdXRpbC5Gb250VHlwZS5UUlVFVFlQRTsKCiAgICBjYXNlICJDSURGb250VHlwZTIiOgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuQ0lERk9OVFRZUEUyOwoKICAgIGNhc2UgIk1NVHlwZTEiOgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuTU1UWVBFMTsKCiAgICBjYXNlICJUeXBlMCI6CiAgICAgIHJldHVybiBfdXRpbC5Gb250VHlwZS5UWVBFMDsKCiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gX3V0aWwuRm9udFR5cGUuVU5LTk9XTjsKICB9Cn0KCmZ1bmN0aW9uIHJlY292ZXJHbHlwaE5hbWUobmFtZSwgZ2x5cGhzVW5pY29kZU1hcCkgewogIGlmIChnbHlwaHNVbmljb2RlTWFwW25hbWVdICE9PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBuYW1lOwogIH0KCiAgdmFyIHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShuYW1lLCBnbHlwaHNVbmljb2RlTWFwKTsKCiAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICBmb3IgKHZhciBrZXkgaW4gZ2x5cGhzVW5pY29kZU1hcCkgewogICAgICBpZiAoZ2x5cGhzVW5pY29kZU1hcFtrZXldID09PSB1bmljb2RlKSB7CiAgICAgICAgcmV0dXJuIGtleTsKICAgICAgfQogICAgfQogIH0KCiAgKDAsIF91dGlsLmluZm8pKCJVbmFibGUgdG8gcmVjb3ZlciBhIHN0YW5kYXJkIGdseXBoIG5hbWUgZm9yOiAiICsgbmFtZSk7CiAgcmV0dXJuIG5hbWU7Cn0KCnZhciBHbHlwaCA9IGZ1bmN0aW9uIEdseXBoQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBHbHlwaChmb250Q2hhciwgdW5pY29kZSwgYWNjZW50LCB3aWR0aCwgdm1ldHJpYywgb3BlcmF0b3JMaXN0SWQsIGlzU3BhY2UsIGlzSW5Gb250KSB7CiAgICB0aGlzLmZvbnRDaGFyID0gZm9udENoYXI7CiAgICB0aGlzLnVuaWNvZGUgPSB1bmljb2RlOwogICAgdGhpcy5hY2NlbnQgPSBhY2NlbnQ7CiAgICB0aGlzLndpZHRoID0gd2lkdGg7CiAgICB0aGlzLnZtZXRyaWMgPSB2bWV0cmljOwogICAgdGhpcy5vcGVyYXRvckxpc3RJZCA9IG9wZXJhdG9yTGlzdElkOwogICAgdGhpcy5pc1NwYWNlID0gaXNTcGFjZTsKICAgIHRoaXMuaXNJbkZvbnQgPSBpc0luRm9udDsKICB9CgogIEdseXBoLnByb3RvdHlwZS5tYXRjaGVzRm9yQ2FjaGUgPSBmdW5jdGlvbiAoZm9udENoYXIsIHVuaWNvZGUsIGFjY2VudCwgd2lkdGgsIHZtZXRyaWMsIG9wZXJhdG9yTGlzdElkLCBpc1NwYWNlLCBpc0luRm9udCkgewogICAgcmV0dXJuIHRoaXMuZm9udENoYXIgPT09IGZvbnRDaGFyICYmIHRoaXMudW5pY29kZSA9PT0gdW5pY29kZSAmJiB0aGlzLmFjY2VudCA9PT0gYWNjZW50ICYmIHRoaXMud2lkdGggPT09IHdpZHRoICYmIHRoaXMudm1ldHJpYyA9PT0gdm1ldHJpYyAmJiB0aGlzLm9wZXJhdG9yTGlzdElkID09PSBvcGVyYXRvckxpc3RJZCAmJiB0aGlzLmlzU3BhY2UgPT09IGlzU3BhY2UgJiYgdGhpcy5pc0luRm9udCA9PT0gaXNJbkZvbnQ7CiAgfTsKCiAgcmV0dXJuIEdseXBoOwp9KCk7Cgp2YXIgVG9Vbmljb2RlTWFwID0gZnVuY3Rpb24gVG9Vbmljb2RlTWFwQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBUb1VuaWNvZGVNYXAoKSB7CiAgICB2YXIgY21hcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogW107CiAgICB0aGlzLl9tYXAgPSBjbWFwOwogIH0KCiAgVG9Vbmljb2RlTWFwLnByb3RvdHlwZSA9IHsKICAgIGdldCBsZW5ndGgoKSB7CiAgICAgIHJldHVybiB0aGlzLl9tYXAubGVuZ3RoOwogICAgfSwKCiAgICBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGNhbGxiYWNrKSB7CiAgICAgIGZvciAodmFyIGNoYXJDb2RlIGluIHRoaXMuX21hcCkgewogICAgICAgIGNhbGxiYWNrKGNoYXJDb2RlLCB0aGlzLl9tYXBbY2hhckNvZGVdLmNoYXJDb2RlQXQoMCkpOwogICAgICB9CiAgICB9LAogICAgaGFzOiBmdW5jdGlvbiBoYXMoaSkgewogICAgICByZXR1cm4gdGhpcy5fbWFwW2ldICE9PSB1bmRlZmluZWQ7CiAgICB9LAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoaSkgewogICAgICByZXR1cm4gdGhpcy5fbWFwW2ldOwogICAgfSwKICAgIGNoYXJDb2RlT2Y6IGZ1bmN0aW9uIGNoYXJDb2RlT2YodmFsdWUpIHsKICAgICAgdmFyIG1hcCA9IHRoaXMuX21hcDsKCiAgICAgIGlmIChtYXAubGVuZ3RoIDw9IDB4MTAwMDApIHsKICAgICAgICByZXR1cm4gbWFwLmluZGV4T2YodmFsdWUpOwogICAgICB9CgogICAgICBmb3IgKHZhciBjaGFyQ29kZSBpbiBtYXApIHsKICAgICAgICBpZiAobWFwW2NoYXJDb2RlXSA9PT0gdmFsdWUpIHsKICAgICAgICAgIHJldHVybiBjaGFyQ29kZSB8IDA7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gLTE7CiAgICB9LAogICAgYW1lbmQ6IGZ1bmN0aW9uIGFtZW5kKG1hcCkgewogICAgICBmb3IgKHZhciBjaGFyQ29kZSBpbiBtYXApIHsKICAgICAgICB0aGlzLl9tYXBbY2hhckNvZGVdID0gbWFwW2NoYXJDb2RlXTsKICAgICAgfQogICAgfQogIH07CiAgcmV0dXJuIFRvVW5pY29kZU1hcDsKfSgpOwoKZXhwb3J0cy5Ub1VuaWNvZGVNYXAgPSBUb1VuaWNvZGVNYXA7Cgp2YXIgSWRlbnRpdHlUb1VuaWNvZGVNYXAgPSBmdW5jdGlvbiBJZGVudGl0eVRvVW5pY29kZU1hcENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gSWRlbnRpdHlUb1VuaWNvZGVNYXAoZmlyc3RDaGFyLCBsYXN0Q2hhcikgewogICAgdGhpcy5maXJzdENoYXIgPSBmaXJzdENoYXI7CiAgICB0aGlzLmxhc3RDaGFyID0gbGFzdENoYXI7CiAgfQoKICBJZGVudGl0eVRvVW5pY29kZU1hcC5wcm90b3R5cGUgPSB7CiAgICBnZXQgbGVuZ3RoKCkgewogICAgICByZXR1cm4gdGhpcy5sYXN0Q2hhciArIDEgLSB0aGlzLmZpcnN0Q2hhcjsKICAgIH0sCgogICAgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChjYWxsYmFjaykgewogICAgICBmb3IgKHZhciBpID0gdGhpcy5maXJzdENoYXIsIGlpID0gdGhpcy5sYXN0Q2hhcjsgaSA8PSBpaTsgaSsrKSB7CiAgICAgICAgY2FsbGJhY2soaSwgaSk7CiAgICAgIH0KICAgIH0sCiAgICBoYXM6IGZ1bmN0aW9uIGhhcyhpKSB7CiAgICAgIHJldHVybiB0aGlzLmZpcnN0Q2hhciA8PSBpICYmIGkgPD0gdGhpcy5sYXN0Q2hhcjsKICAgIH0sCiAgICBnZXQ6IGZ1bmN0aW9uIGdldChpKSB7CiAgICAgIGlmICh0aGlzLmZpcnN0Q2hhciA8PSBpICYmIGkgPD0gdGhpcy5sYXN0Q2hhcikgewogICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGkpOwogICAgICB9CgogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSwKICAgIGNoYXJDb2RlT2Y6IGZ1bmN0aW9uIGNoYXJDb2RlT2YodikgewogICAgICByZXR1cm4gTnVtYmVyLmlzSW50ZWdlcih2KSAmJiB2ID49IHRoaXMuZmlyc3RDaGFyICYmIHYgPD0gdGhpcy5sYXN0Q2hhciA/IHYgOiAtMTsKICAgIH0sCiAgICBhbWVuZDogZnVuY3Rpb24gYW1lbmQobWFwKSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBhbWVuZCgpIik7CiAgICB9CiAgfTsKICByZXR1cm4gSWRlbnRpdHlUb1VuaWNvZGVNYXA7Cn0oKTsKCmV4cG9ydHMuSWRlbnRpdHlUb1VuaWNvZGVNYXAgPSBJZGVudGl0eVRvVW5pY29kZU1hcDsKCnZhciBPcGVuVHlwZUZpbGVCdWlsZGVyID0gZnVuY3Rpb24gT3BlblR5cGVGaWxlQnVpbGRlckNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gd3JpdGVJbnQxNihkZXN0LCBvZmZzZXQsIG51bSkgewogICAgZGVzdFtvZmZzZXRdID0gbnVtID4+IDggJiAweGZmOwogICAgZGVzdFtvZmZzZXQgKyAxXSA9IG51bSAmIDB4ZmY7CiAgfQoKICBmdW5jdGlvbiB3cml0ZUludDMyKGRlc3QsIG9mZnNldCwgbnVtKSB7CiAgICBkZXN0W29mZnNldF0gPSBudW0gPj4gMjQgJiAweGZmOwogICAgZGVzdFtvZmZzZXQgKyAxXSA9IG51bSA+PiAxNiAmIDB4ZmY7CiAgICBkZXN0W29mZnNldCArIDJdID0gbnVtID4+IDggJiAweGZmOwogICAgZGVzdFtvZmZzZXQgKyAzXSA9IG51bSAmIDB4ZmY7CiAgfQoKICBmdW5jdGlvbiB3cml0ZURhdGEoZGVzdCwgb2Zmc2V0LCBkYXRhKSB7CiAgICB2YXIgaSwgaWk7CgogICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7CiAgICAgIGRlc3Quc2V0KGRhdGEsIG9mZnNldCk7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSAic3RyaW5nIikgewogICAgICBmb3IgKGkgPSAwLCBpaSA9IGRhdGEubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIGRlc3Rbb2Zmc2V0KytdID0gZGF0YS5jaGFyQ29kZUF0KGkpICYgMHhmZjsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yIChpID0gMCwgaWkgPSBkYXRhLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBkZXN0W29mZnNldCsrXSA9IGRhdGFbaV0gJiAweGZmOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBPcGVuVHlwZUZpbGVCdWlsZGVyKHNmbnQpIHsKICAgIHRoaXMuc2ZudCA9IHNmbnQ7CiAgICB0aGlzLnRhYmxlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgfQoKICBPcGVuVHlwZUZpbGVCdWlsZGVyLmdldFNlYXJjaFBhcmFtcyA9IGZ1bmN0aW9uIE9wZW5UeXBlRmlsZUJ1aWxkZXJfZ2V0U2VhcmNoUGFyYW1zKGVudHJpZXNDb3VudCwgZW50cnlTaXplKSB7CiAgICB2YXIgbWF4UG93ZXIyID0gMSwKICAgICAgICBsb2cyID0gMDsKCiAgICB3aGlsZSAoKG1heFBvd2VyMiBeIGVudHJpZXNDb3VudCkgPiBtYXhQb3dlcjIpIHsKICAgICAgbWF4UG93ZXIyIDw8PSAxOwogICAgICBsb2cyKys7CiAgICB9CgogICAgdmFyIHNlYXJjaFJhbmdlID0gbWF4UG93ZXIyICogZW50cnlTaXplOwogICAgcmV0dXJuIHsKICAgICAgcmFuZ2U6IHNlYXJjaFJhbmdlLAogICAgICBlbnRyeTogbG9nMiwKICAgICAgcmFuZ2VTaGlmdDogZW50cnlTaXplICogZW50cmllc0NvdW50IC0gc2VhcmNoUmFuZ2UKICAgIH07CiAgfTsKCiAgdmFyIE9URl9IRUFERVJfU0laRSA9IDEyOwogIHZhciBPVEZfVEFCTEVfRU5UUllfU0laRSA9IDE2OwogIE9wZW5UeXBlRmlsZUJ1aWxkZXIucHJvdG90eXBlID0gewogICAgdG9BcnJheTogZnVuY3Rpb24gT3BlblR5cGVGaWxlQnVpbGRlcl90b0FycmF5KCkgewogICAgICB2YXIgc2ZudCA9IHRoaXMuc2ZudDsKICAgICAgdmFyIHRhYmxlcyA9IHRoaXMudGFibGVzOwogICAgICB2YXIgdGFibGVzTmFtZXMgPSBPYmplY3Qua2V5cyh0YWJsZXMpOwogICAgICB0YWJsZXNOYW1lcy5zb3J0KCk7CiAgICAgIHZhciBudW1UYWJsZXMgPSB0YWJsZXNOYW1lcy5sZW5ndGg7CiAgICAgIHZhciBpLCBqLCBqaiwgdGFibGUsIHRhYmxlTmFtZTsKICAgICAgdmFyIG9mZnNldCA9IE9URl9IRUFERVJfU0laRSArIG51bVRhYmxlcyAqIE9URl9UQUJMRV9FTlRSWV9TSVpFOwogICAgICB2YXIgdGFibGVPZmZzZXRzID0gW29mZnNldF07CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtVGFibGVzOyBpKyspIHsKICAgICAgICB0YWJsZSA9IHRhYmxlc1t0YWJsZXNOYW1lc1tpXV07CiAgICAgICAgdmFyIHBhZGRlZExlbmd0aCA9ICh0YWJsZS5sZW5ndGggKyAzICYgfjMpID4+PiAwOwogICAgICAgIG9mZnNldCArPSBwYWRkZWRMZW5ndGg7CiAgICAgICAgdGFibGVPZmZzZXRzLnB1c2gob2Zmc2V0KTsKICAgICAgfQoKICAgICAgdmFyIGZpbGUgPSBuZXcgVWludDhBcnJheShvZmZzZXQpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IG51bVRhYmxlczsgaSsrKSB7CiAgICAgICAgdGFibGUgPSB0YWJsZXNbdGFibGVzTmFtZXNbaV1dOwogICAgICAgIHdyaXRlRGF0YShmaWxlLCB0YWJsZU9mZnNldHNbaV0sIHRhYmxlKTsKICAgICAgfQoKICAgICAgaWYgKHNmbnQgPT09ICJ0cnVlIikgewogICAgICAgIHNmbnQgPSAoMCwgX3V0aWwuc3RyaW5nMzIpKDB4MDAwMTAwMDApOwogICAgICB9CgogICAgICBmaWxlWzBdID0gc2ZudC5jaGFyQ29kZUF0KDApICYgMHhmZjsKICAgICAgZmlsZVsxXSA9IHNmbnQuY2hhckNvZGVBdCgxKSAmIDB4ZmY7CiAgICAgIGZpbGVbMl0gPSBzZm50LmNoYXJDb2RlQXQoMikgJiAweGZmOwogICAgICBmaWxlWzNdID0gc2ZudC5jaGFyQ29kZUF0KDMpICYgMHhmZjsKICAgICAgd3JpdGVJbnQxNihmaWxlLCA0LCBudW1UYWJsZXMpOwogICAgICB2YXIgc2VhcmNoUGFyYW1zID0gT3BlblR5cGVGaWxlQnVpbGRlci5nZXRTZWFyY2hQYXJhbXMobnVtVGFibGVzLCAxNik7CiAgICAgIHdyaXRlSW50MTYoZmlsZSwgNiwgc2VhcmNoUGFyYW1zLnJhbmdlKTsKICAgICAgd3JpdGVJbnQxNihmaWxlLCA4LCBzZWFyY2hQYXJhbXMuZW50cnkpOwogICAgICB3cml0ZUludDE2KGZpbGUsIDEwLCBzZWFyY2hQYXJhbXMucmFuZ2VTaGlmdCk7CiAgICAgIG9mZnNldCA9IE9URl9IRUFERVJfU0laRTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBudW1UYWJsZXM7IGkrKykgewogICAgICAgIHRhYmxlTmFtZSA9IHRhYmxlc05hbWVzW2ldOwogICAgICAgIGZpbGVbb2Zmc2V0XSA9IHRhYmxlTmFtZS5jaGFyQ29kZUF0KDApICYgMHhmZjsKICAgICAgICBmaWxlW29mZnNldCArIDFdID0gdGFibGVOYW1lLmNoYXJDb2RlQXQoMSkgJiAweGZmOwogICAgICAgIGZpbGVbb2Zmc2V0ICsgMl0gPSB0YWJsZU5hbWUuY2hhckNvZGVBdCgyKSAmIDB4ZmY7CiAgICAgICAgZmlsZVtvZmZzZXQgKyAzXSA9IHRhYmxlTmFtZS5jaGFyQ29kZUF0KDMpICYgMHhmZjsKICAgICAgICB2YXIgY2hlY2tzdW0gPSAwOwoKICAgICAgICBmb3IgKGogPSB0YWJsZU9mZnNldHNbaV0sIGpqID0gdGFibGVPZmZzZXRzW2kgKyAxXTsgaiA8IGpqOyBqICs9IDQpIHsKICAgICAgICAgIHZhciBxdWFkID0gKDAsIF9jb3JlX3V0aWxzLnJlYWRVaW50MzIpKGZpbGUsIGopOwogICAgICAgICAgY2hlY2tzdW0gPSBjaGVja3N1bSArIHF1YWQgPj4+IDA7CiAgICAgICAgfQoKICAgICAgICB3cml0ZUludDMyKGZpbGUsIG9mZnNldCArIDQsIGNoZWNrc3VtKTsKICAgICAgICB3cml0ZUludDMyKGZpbGUsIG9mZnNldCArIDgsIHRhYmxlT2Zmc2V0c1tpXSk7CiAgICAgICAgd3JpdGVJbnQzMihmaWxlLCBvZmZzZXQgKyAxMiwgdGFibGVzW3RhYmxlTmFtZV0ubGVuZ3RoKTsKICAgICAgICBvZmZzZXQgKz0gT1RGX1RBQkxFX0VOVFJZX1NJWkU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmaWxlOwogICAgfSwKICAgIGFkZFRhYmxlOiBmdW5jdGlvbiBPcGVuVHlwZUZpbGVCdWlsZGVyX2FkZFRhYmxlKHRhZywgZGF0YSkgewogICAgICBpZiAodGFnIGluIHRoaXMudGFibGVzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJUYWJsZSAiICsgdGFnICsgIiBhbHJlYWR5IGV4aXN0cyIpOwogICAgICB9CgogICAgICB0aGlzLnRhYmxlc1t0YWddID0gZGF0YTsKICAgIH0KICB9OwogIHJldHVybiBPcGVuVHlwZUZpbGVCdWlsZGVyOwp9KCk7Cgp2YXIgRm9udCA9IGZ1bmN0aW9uIEZvbnRDbG9zdXJlKCkgewogIGZ1bmN0aW9uIEZvbnQobmFtZSwgZmlsZSwgcHJvcGVydGllcykgewogICAgdmFyIGNoYXJDb2RlOwogICAgdGhpcy5uYW1lID0gbmFtZTsKICAgIHRoaXMubG9hZGVkTmFtZSA9IHByb3BlcnRpZXMubG9hZGVkTmFtZTsKICAgIHRoaXMuaXNUeXBlM0ZvbnQgPSBwcm9wZXJ0aWVzLmlzVHlwZTNGb250OwogICAgdGhpcy5taXNzaW5nRmlsZSA9IGZhbHNlOwogICAgdGhpcy5nbHlwaENhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMuaXNTZXJpZkZvbnQgPSAhIShwcm9wZXJ0aWVzLmZsYWdzICYgRm9udEZsYWdzLlNlcmlmKTsKICAgIHRoaXMuaXNTeW1ib2xpY0ZvbnQgPSAhIShwcm9wZXJ0aWVzLmZsYWdzICYgRm9udEZsYWdzLlN5bWJvbGljKTsKICAgIHRoaXMuaXNNb25vc3BhY2UgPSAhIShwcm9wZXJ0aWVzLmZsYWdzICYgRm9udEZsYWdzLkZpeGVkUGl0Y2gpOwogICAgdmFyIHR5cGUgPSBwcm9wZXJ0aWVzLnR5cGU7CiAgICB2YXIgc3VidHlwZSA9IHByb3BlcnRpZXMuc3VidHlwZTsKICAgIHRoaXMudHlwZSA9IHR5cGU7CiAgICB0aGlzLnN1YnR5cGUgPSBzdWJ0eXBlOwogICAgdmFyIGZhbGxiYWNrTmFtZSA9ICJzYW5zLXNlcmlmIjsKCiAgICBpZiAodGhpcy5pc01vbm9zcGFjZSkgewogICAgICBmYWxsYmFja05hbWUgPSAibW9ub3NwYWNlIjsKICAgIH0gZWxzZSBpZiAodGhpcy5pc1NlcmlmRm9udCkgewogICAgICBmYWxsYmFja05hbWUgPSAic2VyaWYiOwogICAgfQoKICAgIHRoaXMuZmFsbGJhY2tOYW1lID0gZmFsbGJhY2tOYW1lOwogICAgdGhpcy5kaWZmZXJlbmNlcyA9IHByb3BlcnRpZXMuZGlmZmVyZW5jZXM7CiAgICB0aGlzLndpZHRocyA9IHByb3BlcnRpZXMud2lkdGhzOwogICAgdGhpcy5kZWZhdWx0V2lkdGggPSBwcm9wZXJ0aWVzLmRlZmF1bHRXaWR0aDsKICAgIHRoaXMuY29tcG9zaXRlID0gcHJvcGVydGllcy5jb21wb3NpdGU7CiAgICB0aGlzLmNNYXAgPSBwcm9wZXJ0aWVzLmNNYXA7CiAgICB0aGlzLmFzY2VudCA9IHByb3BlcnRpZXMuYXNjZW50IC8gUERGX0dMWVBIX1NQQUNFX1VOSVRTOwogICAgdGhpcy5kZXNjZW50ID0gcHJvcGVydGllcy5kZXNjZW50IC8gUERGX0dMWVBIX1NQQUNFX1VOSVRTOwogICAgdGhpcy5mb250TWF0cml4ID0gcHJvcGVydGllcy5mb250TWF0cml4OwogICAgdGhpcy5iYm94ID0gcHJvcGVydGllcy5iYm94OwogICAgdGhpcy5kZWZhdWx0RW5jb2RpbmcgPSBwcm9wZXJ0aWVzLmRlZmF1bHRFbmNvZGluZzsKICAgIHRoaXMudG9Vbmljb2RlID0gcHJvcGVydGllcy50b1VuaWNvZGU7CiAgICB0aGlzLmZhbGxiYWNrVG9Vbmljb2RlID0gcHJvcGVydGllcy5mYWxsYmFja1RvVW5pY29kZSB8fCBuZXcgVG9Vbmljb2RlTWFwKCk7CiAgICB0aGlzLnRvRm9udENoYXIgPSBbXTsKCiAgICBpZiAocHJvcGVydGllcy50eXBlID09PSAiVHlwZTMiKSB7CiAgICAgIGZvciAoY2hhckNvZGUgPSAwOyBjaGFyQ29kZSA8IDI1NjsgY2hhckNvZGUrKykgewogICAgICAgIHRoaXMudG9Gb250Q2hhcltjaGFyQ29kZV0gPSB0aGlzLmRpZmZlcmVuY2VzW2NoYXJDb2RlXSB8fCBwcm9wZXJ0aWVzLmRlZmF1bHRFbmNvZGluZ1tjaGFyQ29kZV07CiAgICAgIH0KCiAgICAgIHRoaXMuZm9udFR5cGUgPSBfdXRpbC5Gb250VHlwZS5UWVBFMzsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuY2lkRW5jb2RpbmcgPSBwcm9wZXJ0aWVzLmNpZEVuY29kaW5nOwogICAgdGhpcy52ZXJ0aWNhbCA9ICEhcHJvcGVydGllcy52ZXJ0aWNhbDsKCiAgICBpZiAodGhpcy52ZXJ0aWNhbCkgewogICAgICB0aGlzLnZtZXRyaWNzID0gcHJvcGVydGllcy52bWV0cmljczsKICAgICAgdGhpcy5kZWZhdWx0Vk1ldHJpY3MgPSBwcm9wZXJ0aWVzLmRlZmF1bHRWTWV0cmljczsKICAgIH0KCiAgICBpZiAoIWZpbGUgfHwgZmlsZS5pc0VtcHR5KSB7CiAgICAgIGlmIChmaWxlKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCdGb250IGZpbGUgaXMgZW1wdHkgaW4gIicgKyBuYW1lICsgJyIgKCcgKyB0aGlzLmxvYWRlZE5hbWUgKyAiKSIpOwogICAgICB9CgogICAgICB0aGlzLmZhbGxiYWNrVG9TeXN0ZW1Gb250KCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgX2dldEZvbnRGaWxlVHlwZSA9IGdldEZvbnRGaWxlVHlwZShmaWxlLCBwcm9wZXJ0aWVzKTsKCiAgICB2YXIgX2dldEZvbnRGaWxlVHlwZTIgPSBfc2xpY2VkVG9BcnJheShfZ2V0Rm9udEZpbGVUeXBlLCAyKTsKCiAgICB0eXBlID0gX2dldEZvbnRGaWxlVHlwZTJbMF07CiAgICBzdWJ0eXBlID0gX2dldEZvbnRGaWxlVHlwZTJbMV07CgogICAgaWYgKHR5cGUgIT09IHRoaXMudHlwZSB8fCBzdWJ0eXBlICE9PSB0aGlzLnN1YnR5cGUpIHsKICAgICAgKDAsIF91dGlsLmluZm8pKCJJbmNvbnNpc3RlbnQgZm9udCBmaWxlIFR5cGUvU3ViVHlwZSwgZXhwZWN0ZWQ6ICIgKyAiIi5jb25jYXQodGhpcy50eXBlLCAiLyIpLmNvbmNhdCh0aGlzLnN1YnR5cGUsICIgYnV0IGZvdW5kOiAiKS5jb25jYXQodHlwZSwgIi8iKS5jb25jYXQoc3VidHlwZSwgIi4iKSk7CiAgICB9CgogICAgdHJ5IHsKICAgICAgdmFyIGRhdGE7CgogICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICBjYXNlICJNTVR5cGUxIjoKICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiTU1UeXBlMSBmb250ICgiICsgbmFtZSArICIpLCBmYWxsaW5nIGJhY2sgdG8gVHlwZTEuIik7CgogICAgICAgIGNhc2UgIlR5cGUxIjoKICAgICAgICBjYXNlICJDSURGb250VHlwZTAiOgogICAgICAgICAgdGhpcy5taW1ldHlwZSA9ICJmb250L29wZW50eXBlIjsKICAgICAgICAgIHZhciBjZmYgPSBzdWJ0eXBlID09PSAiVHlwZTFDIiB8fCBzdWJ0eXBlID09PSAiQ0lERm9udFR5cGUwQyIgPyBuZXcgQ0ZGRm9udChmaWxlLCBwcm9wZXJ0aWVzKSA6IG5ldyBUeXBlMUZvbnQobmFtZSwgZmlsZSwgcHJvcGVydGllcyk7CiAgICAgICAgICBhZGp1c3RXaWR0aHMocHJvcGVydGllcyk7CiAgICAgICAgICBkYXRhID0gdGhpcy5jb252ZXJ0KG5hbWUsIGNmZiwgcHJvcGVydGllcyk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiT3BlblR5cGUiOgogICAgICAgIGNhc2UgIlRydWVUeXBlIjoKICAgICAgICBjYXNlICJDSURGb250VHlwZTIiOgogICAgICAgICAgdGhpcy5taW1ldHlwZSA9ICJmb250L29wZW50eXBlIjsKICAgICAgICAgIGRhdGEgPSB0aGlzLmNoZWNrQW5kUmVwYWlyKG5hbWUsIGZpbGUsIHByb3BlcnRpZXMpOwoKICAgICAgICAgIGlmICh0aGlzLmlzT3BlblR5cGUpIHsKICAgICAgICAgICAgYWRqdXN0V2lkdGhzKHByb3BlcnRpZXMpOwogICAgICAgICAgICB0eXBlID0gIk9wZW5UeXBlIjsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiRm9udCAiLmNvbmNhdCh0eXBlLCAiIGlzIG5vdCBzdXBwb3J0ZWQiKSk7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKGUpOwogICAgICB0aGlzLmZhbGxiYWNrVG9TeXN0ZW1Gb250KCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5mb250VHlwZSA9IGdldEZvbnRUeXBlKHR5cGUsIHN1YnR5cGUpOwogICAgdGhpcy5mb250TWF0cml4ID0gcHJvcGVydGllcy5mb250TWF0cml4OwogICAgdGhpcy53aWR0aHMgPSBwcm9wZXJ0aWVzLndpZHRoczsKICAgIHRoaXMuZGVmYXVsdFdpZHRoID0gcHJvcGVydGllcy5kZWZhdWx0V2lkdGg7CiAgICB0aGlzLnRvVW5pY29kZSA9IHByb3BlcnRpZXMudG9Vbmljb2RlOwogICAgdGhpcy5zZWFjTWFwID0gcHJvcGVydGllcy5zZWFjTWFwOwogIH0KCiAgRm9udC5nZXRGb250SUQgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgSUQgPSAxOwogICAgcmV0dXJuIGZ1bmN0aW9uIEZvbnRfZ2V0Rm9udElEKCkgewogICAgICByZXR1cm4gU3RyaW5nKElEKyspOwogICAgfTsKICB9KCk7CgogIGZ1bmN0aW9uIGludDE2KGIwLCBiMSkgewogICAgcmV0dXJuIChiMCA8PCA4KSArIGIxOwogIH0KCiAgZnVuY3Rpb24gd3JpdGVTaWduZWRJbnQxNihieXRlcywgaW5kZXgsIHZhbHVlKSB7CiAgICBieXRlc1tpbmRleCArIDFdID0gdmFsdWU7CiAgICBieXRlc1tpbmRleF0gPSB2YWx1ZSA+Pj4gODsKICB9CgogIGZ1bmN0aW9uIHNpZ25lZEludDE2KGIwLCBiMSkgewogICAgdmFyIHZhbHVlID0gKGIwIDw8IDgpICsgYjE7CiAgICByZXR1cm4gdmFsdWUgJiAxIDw8IDE1ID8gdmFsdWUgLSAweDEwMDAwIDogdmFsdWU7CiAgfQoKICBmdW5jdGlvbiBpbnQzMihiMCwgYjEsIGIyLCBiMykgewogICAgcmV0dXJuIChiMCA8PCAyNCkgKyAoYjEgPDwgMTYpICsgKGIyIDw8IDgpICsgYjM7CiAgfQoKICBmdW5jdGlvbiBzdHJpbmcxNih2YWx1ZSkgewogICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUodmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZik7CiAgfQoKICBmdW5jdGlvbiBzYWZlU3RyaW5nMTYodmFsdWUpIHsKICAgIGlmICh2YWx1ZSA+IDB4N2ZmZikgewogICAgICB2YWx1ZSA9IDB4N2ZmZjsKICAgIH0gZWxzZSBpZiAodmFsdWUgPCAtMHg4MDAwKSB7CiAgICAgIHZhbHVlID0gLTB4ODAwMDsKICAgIH0KCiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSh2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmKTsKICB9CgogIGZ1bmN0aW9uIGlzVHJ1ZVR5cGVGaWxlKGZpbGUpIHsKICAgIHZhciBoZWFkZXIgPSBmaWxlLnBlZWtCeXRlcyg0KTsKICAgIHJldHVybiAoMCwgX2NvcmVfdXRpbHMucmVhZFVpbnQzMikoaGVhZGVyLCAwKSA9PT0gMHgwMDAxMDAwMCB8fCAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoaGVhZGVyKSA9PT0gInRydWUiOwogIH0KCiAgZnVuY3Rpb24gaXNUcnVlVHlwZUNvbGxlY3Rpb25GaWxlKGZpbGUpIHsKICAgIHZhciBoZWFkZXIgPSBmaWxlLnBlZWtCeXRlcyg0KTsKICAgIHJldHVybiAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoaGVhZGVyKSA9PT0gInR0Y2YiOwogIH0KCiAgZnVuY3Rpb24gaXNPcGVuVHlwZUZpbGUoZmlsZSkgewogICAgdmFyIGhlYWRlciA9IGZpbGUucGVla0J5dGVzKDQpOwogICAgcmV0dXJuICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShoZWFkZXIpID09PSAiT1RUTyI7CiAgfQoKICBmdW5jdGlvbiBpc1R5cGUxRmlsZShmaWxlKSB7CiAgICB2YXIgaGVhZGVyID0gZmlsZS5wZWVrQnl0ZXMoMik7CgogICAgaWYgKGhlYWRlclswXSA9PT0gMHgyNSAmJiBoZWFkZXJbMV0gPT09IDB4MjEpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgaWYgKGhlYWRlclswXSA9PT0gMHg4MCAmJiBoZWFkZXJbMV0gPT09IDB4MDEpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gaXNDRkZGaWxlKGZpbGUpIHsKICAgIHZhciBoZWFkZXIgPSBmaWxlLnBlZWtCeXRlcyg0KTsKCiAgICBpZiAoaGVhZGVyWzBdID49IDEgJiYgaGVhZGVyWzNdID49IDEgJiYgaGVhZGVyWzNdIDw9IDQpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gZ2V0Rm9udEZpbGVUeXBlKGZpbGUsIF9yZWYpIHsKICAgIHZhciB0eXBlID0gX3JlZi50eXBlLAogICAgICAgIHN1YnR5cGUgPSBfcmVmLnN1YnR5cGUsCiAgICAgICAgY29tcG9zaXRlID0gX3JlZi5jb21wb3NpdGU7CiAgICB2YXIgZmlsZVR5cGUsIGZpbGVTdWJ0eXBlOwoKICAgIGlmIChpc1RydWVUeXBlRmlsZShmaWxlKSB8fCBpc1RydWVUeXBlQ29sbGVjdGlvbkZpbGUoZmlsZSkpIHsKICAgICAgaWYgKGNvbXBvc2l0ZSkgewogICAgICAgIGZpbGVUeXBlID0gIkNJREZvbnRUeXBlMiI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmlsZVR5cGUgPSAiVHJ1ZVR5cGUiOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGlzT3BlblR5cGVGaWxlKGZpbGUpKSB7CiAgICAgIGlmIChjb21wb3NpdGUpIHsKICAgICAgICBmaWxlVHlwZSA9ICJDSURGb250VHlwZTIiOwogICAgICB9IGVsc2UgewogICAgICAgIGZpbGVUeXBlID0gIk9wZW5UeXBlIjsKICAgICAgfQogICAgfSBlbHNlIGlmIChpc1R5cGUxRmlsZShmaWxlKSkgewogICAgICBpZiAoY29tcG9zaXRlKSB7CiAgICAgICAgZmlsZVR5cGUgPSAiQ0lERm9udFR5cGUwIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaWxlVHlwZSA9IHR5cGUgPT09ICJNTVR5cGUxIiA/ICJNTVR5cGUxIiA6ICJUeXBlMSI7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNDRkZGaWxlKGZpbGUpKSB7CiAgICAgIGlmIChjb21wb3NpdGUpIHsKICAgICAgICBmaWxlVHlwZSA9ICJDSURGb250VHlwZTAiOwogICAgICAgIGZpbGVTdWJ0eXBlID0gIkNJREZvbnRUeXBlMEMiOwogICAgICB9IGVsc2UgewogICAgICAgIGZpbGVUeXBlID0gdHlwZSA9PT0gIk1NVHlwZTEiID8gIk1NVHlwZTEiIDogIlR5cGUxIjsKICAgICAgICBmaWxlU3VidHlwZSA9ICJUeXBlMUMiOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAoMCwgX3V0aWwud2FybikoImdldEZvbnRGaWxlVHlwZTogVW5hYmxlIHRvIGRldGVjdCBjb3JyZWN0IGZvbnQgZmlsZSBUeXBlL1N1YnR5cGUuIik7CiAgICAgIGZpbGVUeXBlID0gdHlwZTsKICAgICAgZmlsZVN1YnR5cGUgPSBzdWJ0eXBlOwogICAgfQoKICAgIHJldHVybiBbZmlsZVR5cGUsIGZpbGVTdWJ0eXBlXTsKICB9CgogIGZ1bmN0aW9uIGJ1aWxkVG9Gb250Q2hhcihlbmNvZGluZywgZ2x5cGhzVW5pY29kZU1hcCwgZGlmZmVyZW5jZXMpIHsKICAgIHZhciB0b0ZvbnRDaGFyID0gW10sCiAgICAgICAgdW5pY29kZTsKCiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBlbmNvZGluZy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShlbmNvZGluZ1tpXSwgZ2x5cGhzVW5pY29kZU1hcCk7CgogICAgICBpZiAodW5pY29kZSAhPT0gLTEpIHsKICAgICAgICB0b0ZvbnRDaGFyW2ldID0gdW5pY29kZTsKICAgICAgfQogICAgfQoKICAgIGZvciAodmFyIGNoYXJDb2RlIGluIGRpZmZlcmVuY2VzKSB7CiAgICAgIHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShkaWZmZXJlbmNlc1tjaGFyQ29kZV0sIGdseXBoc1VuaWNvZGVNYXApOwoKICAgICAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICAgICAgdG9Gb250Q2hhclsrY2hhckNvZGVdID0gdW5pY29kZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0b0ZvbnRDaGFyOwogIH0KCiAgZnVuY3Rpb24gYWRqdXN0TWFwcGluZyhjaGFyQ29kZVRvR2x5cGhJZCwgaGFzR2x5cGgsIG5ld0dseXBoWmVyb0lkKSB7CiAgICB2YXIgbmV3TWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHZhciB0b0ZvbnRDaGFyID0gW107CiAgICB2YXIgcHJpdmF0ZVVzZUFyZWFJbmRleCA9IDA7CiAgICB2YXIgbmV4dEF2YWlsYWJsZUZvbnRDaGFyQ29kZSA9IFBSSVZBVEVfVVNFX0FSRUFTW3ByaXZhdGVVc2VBcmVhSW5kZXhdWzBdOwogICAgdmFyIHByaXZhdGVVc2VPZmZldEVuZCA9IFBSSVZBVEVfVVNFX0FSRUFTW3ByaXZhdGVVc2VBcmVhSW5kZXhdWzFdOwoKICAgIGZvciAodmFyIG9yaWdpbmFsQ2hhckNvZGUgaW4gY2hhckNvZGVUb0dseXBoSWQpIHsKICAgICAgb3JpZ2luYWxDaGFyQ29kZSB8PSAwOwogICAgICB2YXIgZ2x5cGhJZCA9IGNoYXJDb2RlVG9HbHlwaElkW29yaWdpbmFsQ2hhckNvZGVdOwoKICAgICAgaWYgKCFoYXNHbHlwaChnbHlwaElkKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZiAobmV4dEF2YWlsYWJsZUZvbnRDaGFyQ29kZSA+IHByaXZhdGVVc2VPZmZldEVuZCkgewogICAgICAgIHByaXZhdGVVc2VBcmVhSW5kZXgrKzsKCiAgICAgICAgaWYgKHByaXZhdGVVc2VBcmVhSW5kZXggPj0gUFJJVkFURV9VU0VfQVJFQVMubGVuZ3RoKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlJhbiBvdXQgb2Ygc3BhY2UgaW4gZm9udCBwcml2YXRlIHVzZSBhcmVhLiIpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBuZXh0QXZhaWxhYmxlRm9udENoYXJDb2RlID0gUFJJVkFURV9VU0VfQVJFQVNbcHJpdmF0ZVVzZUFyZWFJbmRleF1bMF07CiAgICAgICAgcHJpdmF0ZVVzZU9mZmV0RW5kID0gUFJJVkFURV9VU0VfQVJFQVNbcHJpdmF0ZVVzZUFyZWFJbmRleF1bMV07CiAgICAgIH0KCiAgICAgIHZhciBmb250Q2hhckNvZGUgPSBuZXh0QXZhaWxhYmxlRm9udENoYXJDb2RlKys7CgogICAgICBpZiAoZ2x5cGhJZCA9PT0gMCkgewogICAgICAgIGdseXBoSWQgPSBuZXdHbHlwaFplcm9JZDsKICAgICAgfQoKICAgICAgbmV3TWFwW2ZvbnRDaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICB0b0ZvbnRDaGFyW29yaWdpbmFsQ2hhckNvZGVdID0gZm9udENoYXJDb2RlOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHRvRm9udENoYXI6IHRvRm9udENoYXIsCiAgICAgIGNoYXJDb2RlVG9HbHlwaElkOiBuZXdNYXAsCiAgICAgIG5leHRBdmFpbGFibGVGb250Q2hhckNvZGU6IG5leHRBdmFpbGFibGVGb250Q2hhckNvZGUKICAgIH07CiAgfQoKICBmdW5jdGlvbiBnZXRSYW5nZXMoZ2x5cGhzLCBudW1HbHlwaHMpIHsKICAgIHZhciBjb2RlcyA9IFtdOwoKICAgIGZvciAodmFyIGNoYXJDb2RlIGluIGdseXBocykgewogICAgICBpZiAoZ2x5cGhzW2NoYXJDb2RlXSA+PSBudW1HbHlwaHMpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgY29kZXMucHVzaCh7CiAgICAgICAgZm9udENoYXJDb2RlOiBjaGFyQ29kZSB8IDAsCiAgICAgICAgZ2x5cGhJZDogZ2x5cGhzW2NoYXJDb2RlXQogICAgICB9KTsKICAgIH0KCiAgICBpZiAoY29kZXMubGVuZ3RoID09PSAwKSB7CiAgICAgIGNvZGVzLnB1c2goewogICAgICAgIGZvbnRDaGFyQ29kZTogMCwKICAgICAgICBnbHlwaElkOiAwCiAgICAgIH0pOwogICAgfQoKICAgIGNvZGVzLnNvcnQoZnVuY3Rpb24gZm9udEdldFJhbmdlc1NvcnQoYSwgYikgewogICAgICByZXR1cm4gYS5mb250Q2hhckNvZGUgLSBiLmZvbnRDaGFyQ29kZTsKICAgIH0pOwogICAgdmFyIHJhbmdlcyA9IFtdOwogICAgdmFyIGxlbmd0aCA9IGNvZGVzLmxlbmd0aDsKCiAgICBmb3IgKHZhciBuID0gMDsgbiA8IGxlbmd0aDspIHsKICAgICAgdmFyIHN0YXJ0ID0gY29kZXNbbl0uZm9udENoYXJDb2RlOwogICAgICB2YXIgY29kZUluZGljZXMgPSBbY29kZXNbbl0uZ2x5cGhJZF07CiAgICAgICsrbjsKICAgICAgdmFyIGVuZCA9IHN0YXJ0OwoKICAgICAgd2hpbGUgKG4gPCBsZW5ndGggJiYgZW5kICsgMSA9PT0gY29kZXNbbl0uZm9udENoYXJDb2RlKSB7CiAgICAgICAgY29kZUluZGljZXMucHVzaChjb2Rlc1tuXS5nbHlwaElkKTsKICAgICAgICArK2VuZDsKICAgICAgICArK247CgogICAgICAgIGlmIChlbmQgPT09IDB4ZmZmZikgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICByYW5nZXMucHVzaChbc3RhcnQsIGVuZCwgY29kZUluZGljZXNdKTsKICAgIH0KCiAgICByZXR1cm4gcmFuZ2VzOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlQ21hcFRhYmxlKGdseXBocywgbnVtR2x5cGhzKSB7CiAgICB2YXIgcmFuZ2VzID0gZ2V0UmFuZ2VzKGdseXBocywgbnVtR2x5cGhzKTsKICAgIHZhciBudW1UYWJsZXMgPSByYW5nZXNbcmFuZ2VzLmxlbmd0aCAtIDFdWzFdID4gMHhmZmZmID8gMiA6IDE7CiAgICB2YXIgY21hcCA9ICJceDAwXHgwMCIgKyBzdHJpbmcxNihudW1UYWJsZXMpICsgIlx4MDBceDAzIiArICJceDAwXHgwMSIgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKDQgKyBudW1UYWJsZXMgKiA4KTsKICAgIHZhciBpLCBpaSwgaiwgamo7CgogICAgZm9yIChpID0gcmFuZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7CiAgICAgIGlmIChyYW5nZXNbaV1bMF0gPD0gMHhmZmZmKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgYm1wTGVuZ3RoID0gaSArIDE7CgogICAgaWYgKHJhbmdlc1tpXVswXSA8IDB4ZmZmZiAmJiByYW5nZXNbaV1bMV0gPT09IDB4ZmZmZikgewogICAgICByYW5nZXNbaV1bMV0gPSAweGZmZmU7CiAgICB9CgogICAgdmFyIHRyYWlsaW5nUmFuZ2VzQ291bnQgPSByYW5nZXNbaV1bMV0gPCAweGZmZmYgPyAxIDogMDsKICAgIHZhciBzZWdDb3VudCA9IGJtcExlbmd0aCArIHRyYWlsaW5nUmFuZ2VzQ291bnQ7CiAgICB2YXIgc2VhcmNoUGFyYW1zID0gT3BlblR5cGVGaWxlQnVpbGRlci5nZXRTZWFyY2hQYXJhbXMoc2VnQ291bnQsIDIpOwogICAgdmFyIHN0YXJ0Q291bnQgPSAiIjsKICAgIHZhciBlbmRDb3VudCA9ICIiOwogICAgdmFyIGlkRGVsdGFzID0gIiI7CiAgICB2YXIgaWRSYW5nZU9mZnNldHMgPSAiIjsKICAgIHZhciBnbHlwaHNJZHMgPSAiIjsKICAgIHZhciBiaWFzID0gMDsKICAgIHZhciByYW5nZSwgc3RhcnQsIGVuZCwgY29kZXM7CgogICAgZm9yIChpID0gMCwgaWkgPSBibXBMZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHJhbmdlID0gcmFuZ2VzW2ldOwogICAgICBzdGFydCA9IHJhbmdlWzBdOwogICAgICBlbmQgPSByYW5nZVsxXTsKICAgICAgc3RhcnRDb3VudCArPSBzdHJpbmcxNihzdGFydCk7CiAgICAgIGVuZENvdW50ICs9IHN0cmluZzE2KGVuZCk7CiAgICAgIGNvZGVzID0gcmFuZ2VbMl07CiAgICAgIHZhciBjb250aWd1b3VzID0gdHJ1ZTsKCiAgICAgIGZvciAoaiA9IDEsIGpqID0gY29kZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewogICAgICAgIGlmIChjb2Rlc1tqXSAhPT0gY29kZXNbaiAtIDFdICsgMSkgewogICAgICAgICAgY29udGlndW91cyA9IGZhbHNlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWNvbnRpZ3VvdXMpIHsKICAgICAgICB2YXIgb2Zmc2V0ID0gKHNlZ0NvdW50IC0gaSkgKiAyICsgYmlhcyAqIDI7CiAgICAgICAgYmlhcyArPSBlbmQgLSBzdGFydCArIDE7CiAgICAgICAgaWREZWx0YXMgKz0gc3RyaW5nMTYoMCk7CiAgICAgICAgaWRSYW5nZU9mZnNldHMgKz0gc3RyaW5nMTYob2Zmc2V0KTsKCiAgICAgICAgZm9yIChqID0gMCwgamogPSBjb2Rlcy5sZW5ndGg7IGogPCBqajsgKytqKSB7CiAgICAgICAgICBnbHlwaHNJZHMgKz0gc3RyaW5nMTYoY29kZXNbal0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgc3RhcnRDb2RlID0gY29kZXNbMF07CiAgICAgICAgaWREZWx0YXMgKz0gc3RyaW5nMTYoc3RhcnRDb2RlIC0gc3RhcnQgJiAweGZmZmYpOwogICAgICAgIGlkUmFuZ2VPZmZzZXRzICs9IHN0cmluZzE2KDApOwogICAgICB9CiAgICB9CgogICAgaWYgKHRyYWlsaW5nUmFuZ2VzQ291bnQgPiAwKSB7CiAgICAgIGVuZENvdW50ICs9ICJceEZGXHhGRiI7CiAgICAgIHN0YXJ0Q291bnQgKz0gIlx4RkZceEZGIjsKICAgICAgaWREZWx0YXMgKz0gIlx4MDBceDAxIjsKICAgICAgaWRSYW5nZU9mZnNldHMgKz0gIlx4MDBceDAwIjsKICAgIH0KCiAgICB2YXIgZm9ybWF0MzE0ID0gIlx4MDBceDAwIiArIHN0cmluZzE2KDIgKiBzZWdDb3VudCkgKyBzdHJpbmcxNihzZWFyY2hQYXJhbXMucmFuZ2UpICsgc3RyaW5nMTYoc2VhcmNoUGFyYW1zLmVudHJ5KSArIHN0cmluZzE2KHNlYXJjaFBhcmFtcy5yYW5nZVNoaWZ0KSArIGVuZENvdW50ICsgIlx4MDBceDAwIiArIHN0YXJ0Q291bnQgKyBpZERlbHRhcyArIGlkUmFuZ2VPZmZzZXRzICsgZ2x5cGhzSWRzOwogICAgdmFyIGZvcm1hdDMxMDEyID0gIiI7CiAgICB2YXIgaGVhZGVyMzEwMTIgPSAiIjsKCiAgICBpZiAobnVtVGFibGVzID4gMSkgewogICAgICBjbWFwICs9ICJceDAwXHgwMyIgKyAiXHgwMFx4MEEiICsgKDAsIF91dGlsLnN0cmluZzMyKSg0ICsgbnVtVGFibGVzICogOCArIDQgKyBmb3JtYXQzMTQubGVuZ3RoKTsKICAgICAgZm9ybWF0MzEwMTIgPSAiIjsKCiAgICAgIGZvciAoaSA9IDAsIGlpID0gcmFuZ2VzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICByYW5nZSA9IHJhbmdlc1tpXTsKICAgICAgICBzdGFydCA9IHJhbmdlWzBdOwogICAgICAgIGNvZGVzID0gcmFuZ2VbMl07CiAgICAgICAgdmFyIGNvZGUgPSBjb2Rlc1swXTsKCiAgICAgICAgZm9yIChqID0gMSwgamogPSBjb2Rlcy5sZW5ndGg7IGogPCBqajsgKytqKSB7CiAgICAgICAgICBpZiAoY29kZXNbal0gIT09IGNvZGVzW2ogLSAxXSArIDEpIHsKICAgICAgICAgICAgZW5kID0gcmFuZ2VbMF0gKyBqIC0gMTsKICAgICAgICAgICAgZm9ybWF0MzEwMTIgKz0gKDAsIF91dGlsLnN0cmluZzMyKShzdGFydCkgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKGVuZCkgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKGNvZGUpOwogICAgICAgICAgICBzdGFydCA9IGVuZCArIDE7CiAgICAgICAgICAgIGNvZGUgPSBjb2Rlc1tqXTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZvcm1hdDMxMDEyICs9ICgwLCBfdXRpbC5zdHJpbmczMikoc3RhcnQpICsgKDAsIF91dGlsLnN0cmluZzMyKShyYW5nZVsxXSkgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKGNvZGUpOwogICAgICB9CgogICAgICBoZWFkZXIzMTAxMiA9ICJceDAwXHgwQyIgKyAiXHgwMFx4MDAiICsgKDAsIF91dGlsLnN0cmluZzMyKShmb3JtYXQzMTAxMi5sZW5ndGggKyAxNikgKyAiXHgwMFx4MDBceDAwXHgwMCIgKyAoMCwgX3V0aWwuc3RyaW5nMzIpKGZvcm1hdDMxMDEyLmxlbmd0aCAvIDEyKTsKICAgIH0KCiAgICByZXR1cm4gY21hcCArICJceDAwXHgwNCIgKyBzdHJpbmcxNihmb3JtYXQzMTQubGVuZ3RoICsgNCkgKyBmb3JtYXQzMTQgKyBoZWFkZXIzMTAxMiArIGZvcm1hdDMxMDEyOwogIH0KCiAgZnVuY3Rpb24gdmFsaWRhdGVPUzJUYWJsZShvczIsIGZpbGUpIHsKICAgIGZpbGUucG9zID0gKGZpbGUuc3RhcnQgfHwgMCkgKyBvczIub2Zmc2V0OwogICAgdmFyIHZlcnNpb24gPSBmaWxlLmdldFVpbnQxNigpOwogICAgZmlsZS5za2lwKDYwKTsKICAgIHZhciBzZWxlY3Rpb24gPSBmaWxlLmdldFVpbnQxNigpOwoKICAgIGlmICh2ZXJzaW9uIDwgNCAmJiBzZWxlY3Rpb24gJiAweDAzMDApIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHZhciBmaXJzdENoYXIgPSBmaWxlLmdldFVpbnQxNigpOwogICAgdmFyIGxhc3RDaGFyID0gZmlsZS5nZXRVaW50MTYoKTsKCiAgICBpZiAoZmlyc3RDaGFyID4gbGFzdENoYXIpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGZpbGUuc2tpcCg2KTsKICAgIHZhciB1c1dpbkFzY2VudCA9IGZpbGUuZ2V0VWludDE2KCk7CgogICAgaWYgKHVzV2luQXNjZW50ID09PSAwKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBvczIuZGF0YVs4XSA9IG9zMi5kYXRhWzldID0gMDsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlT1MyVGFibGUocHJvcGVydGllcywgY2hhcnN0cmluZ3MsIG92ZXJyaWRlKSB7CiAgICBvdmVycmlkZSA9IG92ZXJyaWRlIHx8IHsKICAgICAgdW5pdHNQZXJFbTogMCwKICAgICAgeU1heDogMCwKICAgICAgeU1pbjogMCwKICAgICAgYXNjZW50OiAwLAogICAgICBkZXNjZW50OiAwCiAgICB9OwogICAgdmFyIHVsVW5pY29kZVJhbmdlMSA9IDA7CiAgICB2YXIgdWxVbmljb2RlUmFuZ2UyID0gMDsKICAgIHZhciB1bFVuaWNvZGVSYW5nZTMgPSAwOwogICAgdmFyIHVsVW5pY29kZVJhbmdlNCA9IDA7CiAgICB2YXIgZmlyc3RDaGFySW5kZXggPSBudWxsOwogICAgdmFyIGxhc3RDaGFySW5kZXggPSAwOwoKICAgIGlmIChjaGFyc3RyaW5ncykgewogICAgICBmb3IgKHZhciBjb2RlIGluIGNoYXJzdHJpbmdzKSB7CiAgICAgICAgY29kZSB8PSAwOwoKICAgICAgICBpZiAoZmlyc3RDaGFySW5kZXggPiBjb2RlIHx8ICFmaXJzdENoYXJJbmRleCkgewogICAgICAgICAgZmlyc3RDaGFySW5kZXggPSBjb2RlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGxhc3RDaGFySW5kZXggPCBjb2RlKSB7CiAgICAgICAgICBsYXN0Q2hhckluZGV4ID0gY29kZTsKICAgICAgICB9CgogICAgICAgIHZhciBwb3NpdGlvbiA9ICgwLCBfdW5pY29kZS5nZXRVbmljb2RlUmFuZ2VGb3IpKGNvZGUpOwoKICAgICAgICBpZiAocG9zaXRpb24gPCAzMikgewogICAgICAgICAgdWxVbmljb2RlUmFuZ2UxIHw9IDEgPDwgcG9zaXRpb247CiAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA8IDY0KSB7CiAgICAgICAgICB1bFVuaWNvZGVSYW5nZTIgfD0gMSA8PCBwb3NpdGlvbiAtIDMyOwogICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPCA5NikgewogICAgICAgICAgdWxVbmljb2RlUmFuZ2UzIHw9IDEgPDwgcG9zaXRpb24gLSA2NDsKICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uIDwgMTIzKSB7CiAgICAgICAgICB1bFVuaWNvZGVSYW5nZTQgfD0gMSA8PCBwb3NpdGlvbiAtIDk2OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVuaWNvZGUgcmFuZ2VzIEJpdHMgPiAxMjMgYXJlIHJlc2VydmVkIGZvciBpbnRlcm5hbCB1c2FnZSIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGxhc3RDaGFySW5kZXggPiAweGZmZmYpIHsKICAgICAgICBsYXN0Q2hhckluZGV4ID0gMHhmZmZmOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBmaXJzdENoYXJJbmRleCA9IDA7CiAgICAgIGxhc3RDaGFySW5kZXggPSAyNTU7CiAgICB9CgogICAgdmFyIGJib3ggPSBwcm9wZXJ0aWVzLmJib3ggfHwgWzAsIDAsIDAsIDBdOwogICAgdmFyIHVuaXRzUGVyRW0gPSBvdmVycmlkZS51bml0c1BlckVtIHx8IDEgLyAocHJvcGVydGllcy5mb250TWF0cml4IHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYKVswXTsKICAgIHZhciBzY2FsZSA9IHByb3BlcnRpZXMuYXNjZW50U2NhbGVkID8gMS4wIDogdW5pdHNQZXJFbSAvIFBERl9HTFlQSF9TUEFDRV9VTklUUzsKICAgIHZhciB0eXBvQXNjZW50ID0gb3ZlcnJpZGUuYXNjZW50IHx8IE1hdGgucm91bmQoc2NhbGUgKiAocHJvcGVydGllcy5hc2NlbnQgfHwgYmJveFszXSkpOwogICAgdmFyIHR5cG9EZXNjZW50ID0gb3ZlcnJpZGUuZGVzY2VudCB8fCBNYXRoLnJvdW5kKHNjYWxlICogKHByb3BlcnRpZXMuZGVzY2VudCB8fCBiYm94WzFdKSk7CgogICAgaWYgKHR5cG9EZXNjZW50ID4gMCAmJiBwcm9wZXJ0aWVzLmRlc2NlbnQgPiAwICYmIGJib3hbMV0gPCAwKSB7CiAgICAgIHR5cG9EZXNjZW50ID0gLXR5cG9EZXNjZW50OwogICAgfQoKICAgIHZhciB3aW5Bc2NlbnQgPSBvdmVycmlkZS55TWF4IHx8IHR5cG9Bc2NlbnQ7CiAgICB2YXIgd2luRGVzY2VudCA9IC1vdmVycmlkZS55TWluIHx8IC10eXBvRGVzY2VudDsKICAgIHJldHVybiAiXHgwMFx4MDMiICsgIlx4MDJceDI0IiArICJceDAxXHhGNCIgKyAiXHgwMFx4MDUiICsgIlx4MDBceDAwIiArICJceDAyXHg4QSIgKyAiXHgwMlx4QkIiICsgIlx4MDBceDAwIiArICJceDAwXHg4QyIgKyAiXHgwMlx4OEEiICsgIlx4MDJceEJCIiArICJceDAwXHgwMCIgKyAiXHgwMVx4REYiICsgIlx4MDBceDMxIiArICJceDAxXHgwMiIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwXHgwNiIgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKHByb3BlcnRpZXMuZml4ZWRQaXRjaCA/IDB4MDkgOiAweDAwKSArICJceDAwXHgwMFx4MDBceDAwXHgwMFx4MDAiICsgKDAsIF91dGlsLnN0cmluZzMyKSh1bFVuaWNvZGVSYW5nZTEpICsgKDAsIF91dGlsLnN0cmluZzMyKSh1bFVuaWNvZGVSYW5nZTIpICsgKDAsIF91dGlsLnN0cmluZzMyKSh1bFVuaWNvZGVSYW5nZTMpICsgKDAsIF91dGlsLnN0cmluZzMyKSh1bFVuaWNvZGVSYW5nZTQpICsgIlx4MkFceDMyXHgzMVx4MkEiICsgc3RyaW5nMTYocHJvcGVydGllcy5pdGFsaWNBbmdsZSA/IDEgOiAwKSArIHN0cmluZzE2KGZpcnN0Q2hhckluZGV4IHx8IHByb3BlcnRpZXMuZmlyc3RDaGFyKSArIHN0cmluZzE2KGxhc3RDaGFySW5kZXggfHwgcHJvcGVydGllcy5sYXN0Q2hhcikgKyBzdHJpbmcxNih0eXBvQXNjZW50KSArIHN0cmluZzE2KHR5cG9EZXNjZW50KSArICJceDAwXHg2NCIgKyBzdHJpbmcxNih3aW5Bc2NlbnQpICsgc3RyaW5nMTYod2luRGVzY2VudCkgKyAiXHgwMFx4MDBceDAwXHgwMCIgKyAiXHgwMFx4MDBceDAwXHgwMCIgKyBzdHJpbmcxNihwcm9wZXJ0aWVzLnhIZWlnaHQpICsgc3RyaW5nMTYocHJvcGVydGllcy5jYXBIZWlnaHQpICsgc3RyaW5nMTYoMCkgKyBzdHJpbmcxNihmaXJzdENoYXJJbmRleCB8fCBwcm9wZXJ0aWVzLmZpcnN0Q2hhcikgKyAiXHgwMFx4MDMiOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlUG9zdFRhYmxlKHByb3BlcnRpZXMpIHsKICAgIHZhciBhbmdsZSA9IE1hdGguZmxvb3IocHJvcGVydGllcy5pdGFsaWNBbmdsZSAqIE1hdGgucG93KDIsIDE2KSk7CiAgICByZXR1cm4gIlx4MDBceDAzXHgwMFx4MDAiICsgKDAsIF91dGlsLnN0cmluZzMyKShhbmdsZSkgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICgwLCBfdXRpbC5zdHJpbmczMikocHJvcGVydGllcy5maXhlZFBpdGNoKSArICJceDAwXHgwMFx4MDBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIjsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZU5hbWVUYWJsZShuYW1lLCBwcm90bykgewogICAgaWYgKCFwcm90bykgewogICAgICBwcm90byA9IFtbXSwgW11dOwogICAgfQoKICAgIHZhciBzdHJpbmdzID0gW3Byb3RvWzBdWzBdIHx8ICJPcmlnaW5hbCBsaWNlbmNlIiwgcHJvdG9bMF1bMV0gfHwgbmFtZSwgcHJvdG9bMF1bMl0gfHwgIlVua25vd24iLCBwcm90b1swXVszXSB8fCAidW5pcXVlSUQiLCBwcm90b1swXVs0XSB8fCBuYW1lLCBwcm90b1swXVs1XSB8fCAiVmVyc2lvbiAwLjExIiwgcHJvdG9bMF1bNl0gfHwgIiIsIHByb3RvWzBdWzddIHx8ICJVbmtub3duIiwgcHJvdG9bMF1bOF0gfHwgIlVua25vd24iLCBwcm90b1swXVs5XSB8fCAiVW5rbm93biJdOwogICAgdmFyIHN0cmluZ3NVbmljb2RlID0gW107CiAgICB2YXIgaSwgaWksIGosIGpqLCBzdHI7CgogICAgZm9yIChpID0gMCwgaWkgPSBzdHJpbmdzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgc3RyID0gcHJvdG9bMV1baV0gfHwgc3RyaW5nc1tpXTsKICAgICAgdmFyIHN0ckJ1ZlVuaWNvZGUgPSBbXTsKCiAgICAgIGZvciAoaiA9IDAsIGpqID0gc3RyLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICBzdHJCdWZVbmljb2RlLnB1c2goc3RyaW5nMTYoc3RyLmNoYXJDb2RlQXQoaikpKTsKICAgICAgfQoKICAgICAgc3RyaW5nc1VuaWNvZGUucHVzaChzdHJCdWZVbmljb2RlLmpvaW4oIiIpKTsKICAgIH0KCiAgICB2YXIgbmFtZXMgPSBbc3RyaW5ncywgc3RyaW5nc1VuaWNvZGVdOwogICAgdmFyIHBsYXRmb3JtcyA9IFsiXHgwMFx4MDEiLCAiXHgwMFx4MDMiXTsKICAgIHZhciBlbmNvZGluZ3MgPSBbIlx4MDBceDAwIiwgIlx4MDBceDAxIl07CiAgICB2YXIgbGFuZ3VhZ2VzID0gWyJceDAwXHgwMCIsICJceDA0XHgwOSJdOwogICAgdmFyIG5hbWVzUmVjb3JkQ291bnQgPSBzdHJpbmdzLmxlbmd0aCAqIHBsYXRmb3Jtcy5sZW5ndGg7CiAgICB2YXIgbmFtZVRhYmxlID0gIlx4MDBceDAwIiArIHN0cmluZzE2KG5hbWVzUmVjb3JkQ291bnQpICsgc3RyaW5nMTYobmFtZXNSZWNvcmRDb3VudCAqIDEyICsgNik7CiAgICB2YXIgc3RyT2Zmc2V0ID0gMDsKCiAgICBmb3IgKGkgPSAwLCBpaSA9IHBsYXRmb3Jtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHZhciBzdHJzID0gbmFtZXNbaV07CgogICAgICBmb3IgKGogPSAwLCBqaiA9IHN0cnMubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgIHN0ciA9IHN0cnNbal07CiAgICAgICAgdmFyIG5hbWVSZWNvcmQgPSBwbGF0Zm9ybXNbaV0gKyBlbmNvZGluZ3NbaV0gKyBsYW5ndWFnZXNbaV0gKyBzdHJpbmcxNihqKSArIHN0cmluZzE2KHN0ci5sZW5ndGgpICsgc3RyaW5nMTYoc3RyT2Zmc2V0KTsKICAgICAgICBuYW1lVGFibGUgKz0gbmFtZVJlY29yZDsKICAgICAgICBzdHJPZmZzZXQgKz0gc3RyLmxlbmd0aDsKICAgICAgfQogICAgfQoKICAgIG5hbWVUYWJsZSArPSBzdHJpbmdzLmpvaW4oIiIpICsgc3RyaW5nc1VuaWNvZGUuam9pbigiIik7CiAgICByZXR1cm4gbmFtZVRhYmxlOwogIH0KCiAgRm9udC5wcm90b3R5cGUgPSB7CiAgICBuYW1lOiBudWxsLAogICAgZm9udDogbnVsbCwKICAgIG1pbWV0eXBlOiBudWxsLAogICAgZGlzYWJsZUZvbnRGYWNlOiBmYWxzZSwKCiAgICBnZXQgcmVuZGVyZXIoKSB7CiAgICAgIHZhciByZW5kZXJlciA9IF9mb250X3JlbmRlcmVyLkZvbnRSZW5kZXJlckZhY3RvcnkuY3JlYXRlKHRoaXMsIFNFQUNfQU5BTFlTSVNfRU5BQkxFRCk7CgogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInJlbmRlcmVyIiwgcmVuZGVyZXIpOwogICAgfSwKCiAgICBleHBvcnREYXRhOiBmdW5jdGlvbiBleHBvcnREYXRhKCkgewogICAgICB2YXIgZXh0cmFQcm9wZXJ0aWVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgICAgdmFyIGV4cG9ydERhdGFQcm9wZXJ0aWVzID0gZXh0cmFQcm9wZXJ0aWVzID8gW10uY29uY2F0KEVYUE9SVF9EQVRBX1BST1BFUlRJRVMsIEVYUE9SVF9EQVRBX0VYVFJBX1BST1BFUlRJRVMpIDogRVhQT1JUX0RBVEFfUFJPUEVSVElFUzsKICAgICAgdmFyIGRhdGEgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB2YXIgcHJvcGVydHksIHZhbHVlOwoKICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGV4cG9ydERhdGFQcm9wZXJ0aWVzKSwKICAgICAgICAgIF9zdGVwOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgcHJvcGVydHkgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgIHZhbHVlID0gdGhpc1twcm9wZXJ0eV07CgogICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgZGF0YVtwcm9wZXJ0eV0gPSB2YWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGRhdGE7CiAgICB9LAogICAgZmFsbGJhY2tUb1N5c3RlbUZvbnQ6IGZ1bmN0aW9uIEZvbnRfZmFsbGJhY2tUb1N5c3RlbUZvbnQoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLm1pc3NpbmdGaWxlID0gdHJ1ZTsKICAgICAgdmFyIG5hbWUgPSB0aGlzLm5hbWU7CiAgICAgIHZhciB0eXBlID0gdGhpcy50eXBlOwogICAgICB2YXIgc3VidHlwZSA9IHRoaXMuc3VidHlwZTsKICAgICAgdmFyIGZvbnROYW1lID0gbmFtZS5yZXBsYWNlKC9bLF9dL2csICItIikucmVwbGFjZSgvXHMvZywgIiIpOwogICAgICB2YXIgc3RkRm9udE1hcCA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0U3RkRm9udE1hcCkoKSwKICAgICAgICAgIG5vblN0ZEZvbnRNYXAgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldE5vblN0ZEZvbnRNYXApKCk7CiAgICAgIHZhciBpc1N0YW5kYXJkRm9udCA9ICEhc3RkRm9udE1hcFtmb250TmFtZV0gfHwgISEobm9uU3RkRm9udE1hcFtmb250TmFtZV0gJiYgc3RkRm9udE1hcFtub25TdGRGb250TWFwW2ZvbnROYW1lXV0pOwogICAgICBmb250TmFtZSA9IHN0ZEZvbnRNYXBbZm9udE5hbWVdIHx8IG5vblN0ZEZvbnRNYXBbZm9udE5hbWVdIHx8IGZvbnROYW1lOwogICAgICB0aGlzLmJvbGQgPSBmb250TmFtZS5zZWFyY2goL2JvbGQvZ2kpICE9PSAtMTsKICAgICAgdGhpcy5pdGFsaWMgPSBmb250TmFtZS5zZWFyY2goL29ibGlxdWUvZ2kpICE9PSAtMSB8fCBmb250TmFtZS5zZWFyY2goL2l0YWxpYy9naSkgIT09IC0xOwogICAgICB0aGlzLmJsYWNrID0gbmFtZS5zZWFyY2goL0JsYWNrL2cpICE9PSAtMTsKICAgICAgdGhpcy5yZW1lYXN1cmUgPSBPYmplY3Qua2V5cyh0aGlzLndpZHRocykubGVuZ3RoID4gMDsKCiAgICAgIGlmIChpc1N0YW5kYXJkRm9udCAmJiB0eXBlID09PSAiQ0lERm9udFR5cGUyIiAmJiB0aGlzLmNpZEVuY29kaW5nLnN0YXJ0c1dpdGgoIklkZW50aXR5LSIpKSB7CiAgICAgICAgdmFyIEdseXBoTWFwRm9yU3RhbmRhcmRGb250cyA9ICgwLCBfc3RhbmRhcmRfZm9udHMuZ2V0R2x5cGhNYXBGb3JTdGFuZGFyZEZvbnRzKSgpOwogICAgICAgIHZhciBtYXAgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgY2hhckNvZGUgaW4gR2x5cGhNYXBGb3JTdGFuZGFyZEZvbnRzKSB7CiAgICAgICAgICBtYXBbK2NoYXJDb2RlXSA9IEdseXBoTWFwRm9yU3RhbmRhcmRGb250c1tjaGFyQ29kZV07CiAgICAgICAgfQoKICAgICAgICBpZiAoL0FyaWFsLT9CbGFjay9pLnRlc3QobmFtZSkpIHsKICAgICAgICAgIHZhciBTdXBwbGVtZW50YWxHbHlwaE1hcEZvckFyaWFsQmxhY2sgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQXJpYWxCbGFjaykoKTsKCiAgICAgICAgICBmb3IgKHZhciBfY2hhckNvZGUgaW4gU3VwcGxlbWVudGFsR2x5cGhNYXBGb3JBcmlhbEJsYWNrKSB7CiAgICAgICAgICAgIG1hcFsrX2NoYXJDb2RlXSA9IFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQXJpYWxCbGFja1tfY2hhckNvZGVdOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoL0NhbGlicmkvaS50ZXN0KG5hbWUpKSB7CiAgICAgICAgICB2YXIgU3VwcGxlbWVudGFsR2x5cGhNYXBGb3JDYWxpYnJpID0gKDAsIF9zdGFuZGFyZF9mb250cy5nZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckNhbGlicmkpKCk7CgogICAgICAgICAgZm9yICh2YXIgX2NoYXJDb2RlMiBpbiBTdXBwbGVtZW50YWxHbHlwaE1hcEZvckNhbGlicmkpIHsKICAgICAgICAgICAgbWFwWytfY2hhckNvZGUyXSA9IFN1cHBsZW1lbnRhbEdseXBoTWFwRm9yQ2FsaWJyaVtfY2hhckNvZGUyXTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciBpc0lkZW50aXR5VW5pY29kZSA9IHRoaXMudG9Vbmljb2RlIGluc3RhbmNlb2YgSWRlbnRpdHlUb1VuaWNvZGVNYXA7CgogICAgICAgIGlmICghaXNJZGVudGl0eVVuaWNvZGUpIHsKICAgICAgICAgIHRoaXMudG9Vbmljb2RlLmZvckVhY2goZnVuY3Rpb24gKGNoYXJDb2RlLCB1bmljb2RlQ2hhckNvZGUpIHsKICAgICAgICAgICAgbWFwWytjaGFyQ29kZV0gPSB1bmljb2RlQ2hhckNvZGU7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHRoaXMudG9Gb250Q2hhciA9IG1hcDsKICAgICAgICB0aGlzLnRvVW5pY29kZSA9IG5ldyBUb1VuaWNvZGVNYXAobWFwKTsKICAgICAgfSBlbHNlIGlmICgvU3ltYm9sL2kudGVzdChmb250TmFtZSkpIHsKICAgICAgICB0aGlzLnRvRm9udENoYXIgPSBidWlsZFRvRm9udENoYXIoX2VuY29kaW5ncy5TeW1ib2xTZXRFbmNvZGluZywgKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKSwgdGhpcy5kaWZmZXJlbmNlcyk7CiAgICAgIH0gZWxzZSBpZiAoL0RpbmdiYXRzL2kudGVzdChmb250TmFtZSkpIHsKICAgICAgICBpZiAoL1dpbmdkaW5ncy9pLnRlc3QobmFtZSkpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiTm9uLWVtYmVkZGVkIFdpbmdkaW5ncyBmb250LCBmYWxsaW5nIGJhY2sgdG8gWmFwZkRpbmdiYXRzLiIpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50b0ZvbnRDaGFyID0gYnVpbGRUb0ZvbnRDaGFyKF9lbmNvZGluZ3MuWmFwZkRpbmdiYXRzRW5jb2RpbmcsICgwLCBfZ2x5cGhsaXN0LmdldERpbmdiYXRzR2x5cGhzVW5pY29kZSkoKSwgdGhpcy5kaWZmZXJlbmNlcyk7CiAgICAgIH0gZWxzZSBpZiAoaXNTdGFuZGFyZEZvbnQpIHsKICAgICAgICB0aGlzLnRvRm9udENoYXIgPSBidWlsZFRvRm9udENoYXIodGhpcy5kZWZhdWx0RW5jb2RpbmcsICgwLCBfZ2x5cGhsaXN0LmdldEdseXBoc1VuaWNvZGUpKCksIHRoaXMuZGlmZmVyZW5jZXMpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBnbHlwaHNVbmljb2RlTWFwID0gKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKICAgICAgICB2YXIgX21hcCA9IFtdOwogICAgICAgIHRoaXMudG9Vbmljb2RlLmZvckVhY2goZnVuY3Rpb24gKGNoYXJDb2RlLCB1bmljb2RlQ2hhckNvZGUpIHsKICAgICAgICAgIGlmICghX3RoaXMuY29tcG9zaXRlKSB7CiAgICAgICAgICAgIHZhciBnbHlwaE5hbWUgPSBfdGhpcy5kaWZmZXJlbmNlc1tjaGFyQ29kZV0gfHwgX3RoaXMuZGVmYXVsdEVuY29kaW5nW2NoYXJDb2RlXTsKICAgICAgICAgICAgdmFyIHVuaWNvZGUgPSAoMCwgX3VuaWNvZGUuZ2V0VW5pY29kZUZvckdseXBoKShnbHlwaE5hbWUsIGdseXBoc1VuaWNvZGVNYXApOwoKICAgICAgICAgICAgaWYgKHVuaWNvZGUgIT09IC0xKSB7CiAgICAgICAgICAgICAgdW5pY29kZUNoYXJDb2RlID0gdW5pY29kZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIF9tYXBbK2NoYXJDb2RlXSA9IHVuaWNvZGVDaGFyQ29kZTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKHRoaXMuY29tcG9zaXRlICYmIHRoaXMudG9Vbmljb2RlIGluc3RhbmNlb2YgSWRlbnRpdHlUb1VuaWNvZGVNYXApIHsKICAgICAgICAgIGlmICgvVmVyZGFuYS9pLnRlc3QobmFtZSkpIHsKICAgICAgICAgICAgdmFyIF9HbHlwaE1hcEZvclN0YW5kYXJkRm9udHMgPSAoMCwgX3N0YW5kYXJkX2ZvbnRzLmdldEdseXBoTWFwRm9yU3RhbmRhcmRGb250cykoKTsKCiAgICAgICAgICAgIGZvciAodmFyIF9jaGFyQ29kZTMgaW4gX0dseXBoTWFwRm9yU3RhbmRhcmRGb250cykgewogICAgICAgICAgICAgIF9tYXBbK19jaGFyQ29kZTNdID0gX0dseXBoTWFwRm9yU3RhbmRhcmRGb250c1tfY2hhckNvZGUzXTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy50b0ZvbnRDaGFyID0gX21hcDsKICAgICAgfQoKICAgICAgdGhpcy5sb2FkZWROYW1lID0gZm9udE5hbWUuc3BsaXQoIi0iKVswXTsKICAgICAgdGhpcy5mb250VHlwZSA9IGdldEZvbnRUeXBlKHR5cGUsIHN1YnR5cGUpOwogICAgfSwKICAgIGNoZWNrQW5kUmVwYWlyOiBmdW5jdGlvbiBGb250X2NoZWNrQW5kUmVwYWlyKG5hbWUsIGZvbnQsIHByb3BlcnRpZXMpIHsKICAgICAgdmFyIFZBTElEX1RBQkxFUyA9IFsiT1MvMiIsICJjbWFwIiwgImhlYWQiLCAiaGhlYSIsICJobXR4IiwgIm1heHAiLCAibmFtZSIsICJwb3N0IiwgImxvY2EiLCAiZ2x5ZiIsICJmcGdtIiwgInByZXAiLCAiY3Z0ICIsICJDRkYgIl07CgogICAgICBmdW5jdGlvbiByZWFkVGFibGVzKGZpbGUsIG51bVRhYmxlcykgewogICAgICAgIHZhciB0YWJsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgIHRhYmxlc1siT1MvMiJdID0gbnVsbDsKICAgICAgICB0YWJsZXMuY21hcCA9IG51bGw7CiAgICAgICAgdGFibGVzLmhlYWQgPSBudWxsOwogICAgICAgIHRhYmxlcy5oaGVhID0gbnVsbDsKICAgICAgICB0YWJsZXMuaG10eCA9IG51bGw7CiAgICAgICAgdGFibGVzLm1heHAgPSBudWxsOwogICAgICAgIHRhYmxlcy5uYW1lID0gbnVsbDsKICAgICAgICB0YWJsZXMucG9zdCA9IG51bGw7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtVGFibGVzOyBpKyspIHsKICAgICAgICAgIHZhciB0YWJsZSA9IHJlYWRUYWJsZUVudHJ5KGZpbGUpOwoKICAgICAgICAgIGlmICghVkFMSURfVEFCTEVTLmluY2x1ZGVzKHRhYmxlLnRhZykpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRhYmxlLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0YWJsZXNbdGFibGUudGFnXSA9IHRhYmxlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRhYmxlczsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gcmVhZFRhYmxlRW50cnkoZmlsZSkgewogICAgICAgIHZhciB0YWcgPSAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoZmlsZS5nZXRCeXRlcyg0KSk7CiAgICAgICAgdmFyIGNoZWNrc3VtID0gZmlsZS5nZXRJbnQzMigpID4+PiAwOwogICAgICAgIHZhciBvZmZzZXQgPSBmaWxlLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgdmFyIGxlbmd0aCA9IGZpbGUuZ2V0SW50MzIoKSA+Pj4gMDsKICAgICAgICB2YXIgcHJldmlvdXNQb3NpdGlvbiA9IGZpbGUucG9zOwogICAgICAgIGZpbGUucG9zID0gZmlsZS5zdGFydCA/IGZpbGUuc3RhcnQgOiAwOwogICAgICAgIGZpbGUuc2tpcChvZmZzZXQpOwogICAgICAgIHZhciBkYXRhID0gZmlsZS5nZXRCeXRlcyhsZW5ndGgpOwogICAgICAgIGZpbGUucG9zID0gcHJldmlvdXNQb3NpdGlvbjsKCiAgICAgICAgaWYgKHRhZyA9PT0gImhlYWQiKSB7CiAgICAgICAgICBkYXRhWzhdID0gZGF0YVs5XSA9IGRhdGFbMTBdID0gZGF0YVsxMV0gPSAwOwogICAgICAgICAgZGF0YVsxN10gfD0gMHgyMDsKICAgICAgICB9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0YWc6IHRhZywKICAgICAgICAgIGNoZWNrc3VtOiBjaGVja3N1bSwKICAgICAgICAgIGxlbmd0aDogbGVuZ3RoLAogICAgICAgICAgb2Zmc2V0OiBvZmZzZXQsCiAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gcmVhZE9wZW5UeXBlSGVhZGVyKHR0ZikgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB2ZXJzaW9uOiAoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykodHRmLmdldEJ5dGVzKDQpKSwKICAgICAgICAgIG51bVRhYmxlczogdHRmLmdldFVpbnQxNigpLAogICAgICAgICAgc2VhcmNoUmFuZ2U6IHR0Zi5nZXRVaW50MTYoKSwKICAgICAgICAgIGVudHJ5U2VsZWN0b3I6IHR0Zi5nZXRVaW50MTYoKSwKICAgICAgICAgIHJhbmdlU2hpZnQ6IHR0Zi5nZXRVaW50MTYoKQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHJlYWRUcnVlVHlwZUNvbGxlY3Rpb25IZWFkZXIodHRjKSB7CiAgICAgICAgdmFyIHR0Y1RhZyA9ICgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKSh0dGMuZ2V0Qnl0ZXMoNCkpOwogICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHR0Y1RhZyA9PT0gInR0Y2YiLCAiTXVzdCBiZSBhIFRydWVUeXBlIENvbGxlY3Rpb24gZm9udC4iKTsKICAgICAgICB2YXIgbWFqb3JWZXJzaW9uID0gdHRjLmdldFVpbnQxNigpOwogICAgICAgIHZhciBtaW5vclZlcnNpb24gPSB0dGMuZ2V0VWludDE2KCk7CiAgICAgICAgdmFyIG51bUZvbnRzID0gdHRjLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgdmFyIG9mZnNldFRhYmxlID0gW107CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRm9udHM7IGkrKykgewogICAgICAgICAgb2Zmc2V0VGFibGUucHVzaCh0dGMuZ2V0SW50MzIoKSA+Pj4gMCk7CiAgICAgICAgfQoKICAgICAgICB2YXIgaGVhZGVyID0gewogICAgICAgICAgdHRjVGFnOiB0dGNUYWcsCiAgICAgICAgICBtYWpvclZlcnNpb246IG1ham9yVmVyc2lvbiwKICAgICAgICAgIG1pbm9yVmVyc2lvbjogbWlub3JWZXJzaW9uLAogICAgICAgICAgbnVtRm9udHM6IG51bUZvbnRzLAogICAgICAgICAgb2Zmc2V0VGFibGU6IG9mZnNldFRhYmxlCiAgICAgICAgfTsKCiAgICAgICAgc3dpdGNoIChtYWpvclZlcnNpb24pIHsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgcmV0dXJuIGhlYWRlcjsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGhlYWRlci5kc2lnVGFnID0gdHRjLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgICAgIGhlYWRlci5kc2lnTGVuZ3RoID0gdHRjLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgICAgIGhlYWRlci5kc2lnT2Zmc2V0ID0gdHRjLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgICAgIHJldHVybiBoZWFkZXI7CiAgICAgICAgfQoKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgVHJ1ZVR5cGUgQ29sbGVjdGlvbiBtYWpvclZlcnNpb246ICIuY29uY2F0KG1ham9yVmVyc2lvbiwgIi4iKSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHJlYWRUcnVlVHlwZUNvbGxlY3Rpb25EYXRhKHR0YywgZm9udE5hbWUpIHsKICAgICAgICB2YXIgX3JlYWRUcnVlVHlwZUNvbGxlY3RpID0gcmVhZFRydWVUeXBlQ29sbGVjdGlvbkhlYWRlcih0dGMpLAogICAgICAgICAgICBudW1Gb250cyA9IF9yZWFkVHJ1ZVR5cGVDb2xsZWN0aS5udW1Gb250cywKICAgICAgICAgICAgb2Zmc2V0VGFibGUgPSBfcmVhZFRydWVUeXBlQ29sbGVjdGkub2Zmc2V0VGFibGU7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRm9udHM7IGkrKykgewogICAgICAgICAgdHRjLnBvcyA9ICh0dGMuc3RhcnQgfHwgMCkgKyBvZmZzZXRUYWJsZVtpXTsKICAgICAgICAgIHZhciBwb3RlbnRpYWxIZWFkZXIgPSByZWFkT3BlblR5cGVIZWFkZXIodHRjKTsKICAgICAgICAgIHZhciBwb3RlbnRpYWxUYWJsZXMgPSByZWFkVGFibGVzKHR0YywgcG90ZW50aWFsSGVhZGVyLm51bVRhYmxlcyk7CgogICAgICAgICAgaWYgKCFwb3RlbnRpYWxUYWJsZXMubmFtZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoJ1RydWVUeXBlIENvbGxlY3Rpb24gZm9udCBtdXN0IGNvbnRhaW4gYSAibmFtZSIgdGFibGUuJyk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG5hbWVUYWJsZSA9IHJlYWROYW1lVGFibGUocG90ZW50aWFsVGFibGVzLm5hbWUpOwoKICAgICAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IG5hbWVUYWJsZS5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwLCBrayA9IG5hbWVUYWJsZVtqXS5sZW5ndGg7IGsgPCBrazsgaysrKSB7CiAgICAgICAgICAgICAgdmFyIG5hbWVFbnRyeSA9IG5hbWVUYWJsZVtqXVtrXTsKCiAgICAgICAgICAgICAgaWYgKG5hbWVFbnRyeSAmJiBuYW1lRW50cnkucmVwbGFjZSgvXHMvZywgIiIpID09PSBmb250TmFtZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyOiBwb3RlbnRpYWxIZWFkZXIsCiAgICAgICAgICAgICAgICAgIHRhYmxlczogcG90ZW50aWFsVGFibGVzCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJUcnVlVHlwZSBDb2xsZWN0aW9uIGRvZXMgbm90IGNvbnRhaW4gXCIiLmNvbmNhdChmb250TmFtZSwgIlwiIGZvbnQuIikpOwogICAgICB9CgogICAgICBmdW5jdGlvbiByZWFkQ21hcFRhYmxlKGNtYXAsIGZpbGUsIGlzU3ltYm9saWNGb250LCBoYXNFbmNvZGluZykgewogICAgICAgIGlmICghY21hcCkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJObyBjbWFwIHRhYmxlIGF2YWlsYWJsZS4iKTsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHBsYXRmb3JtSWQ6IC0xLAogICAgICAgICAgICBlbmNvZGluZ0lkOiAtMSwKICAgICAgICAgICAgbWFwcGluZ3M6IFtdLAogICAgICAgICAgICBoYXNTaG9ydENtYXA6IGZhbHNlCiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgdmFyIHNlZ21lbnQ7CiAgICAgICAgdmFyIHN0YXJ0ID0gKGZpbGUuc3RhcnQgPyBmaWxlLnN0YXJ0IDogMCkgKyBjbWFwLm9mZnNldDsKICAgICAgICBmaWxlLnBvcyA9IHN0YXJ0OwogICAgICAgIGZpbGUuc2tpcCgyKTsKICAgICAgICB2YXIgbnVtVGFibGVzID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICB2YXIgcG90ZW50aWFsVGFibGU7CiAgICAgICAgdmFyIGNhbkJyZWFrID0gZmFsc2U7CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtVGFibGVzOyBpKyspIHsKICAgICAgICAgIHZhciBwbGF0Zm9ybUlkID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICAgIHZhciBlbmNvZGluZ0lkID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICAgIHZhciBvZmZzZXQgPSBmaWxlLmdldEludDMyKCkgPj4+IDA7CiAgICAgICAgICB2YXIgdXNlVGFibGUgPSBmYWxzZTsKCiAgICAgICAgICBpZiAocG90ZW50aWFsVGFibGUgJiYgcG90ZW50aWFsVGFibGUucGxhdGZvcm1JZCA9PT0gcGxhdGZvcm1JZCAmJiBwb3RlbnRpYWxUYWJsZS5lbmNvZGluZ0lkID09PSBlbmNvZGluZ0lkKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChwbGF0Zm9ybUlkID09PSAwICYmIGVuY29kaW5nSWQgPT09IDApIHsKICAgICAgICAgICAgdXNlVGFibGUgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIGlmIChwbGF0Zm9ybUlkID09PSAxICYmIGVuY29kaW5nSWQgPT09IDApIHsKICAgICAgICAgICAgdXNlVGFibGUgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIGlmIChwbGF0Zm9ybUlkID09PSAzICYmIGVuY29kaW5nSWQgPT09IDEgJiYgKGhhc0VuY29kaW5nIHx8ICFwb3RlbnRpYWxUYWJsZSkpIHsKICAgICAgICAgICAgdXNlVGFibGUgPSB0cnVlOwoKICAgICAgICAgICAgaWYgKCFpc1N5bWJvbGljRm9udCkgewogICAgICAgICAgICAgIGNhbkJyZWFrID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChpc1N5bWJvbGljRm9udCAmJiBwbGF0Zm9ybUlkID09PSAzICYmIGVuY29kaW5nSWQgPT09IDApIHsKICAgICAgICAgICAgdXNlVGFibGUgPSB0cnVlOwogICAgICAgICAgICBjYW5CcmVhayA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHVzZVRhYmxlKSB7CiAgICAgICAgICAgIHBvdGVudGlhbFRhYmxlID0gewogICAgICAgICAgICAgIHBsYXRmb3JtSWQ6IHBsYXRmb3JtSWQsCiAgICAgICAgICAgICAgZW5jb2RpbmdJZDogZW5jb2RpbmdJZCwKICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldAogICAgICAgICAgICB9OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjYW5CcmVhaykgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChwb3RlbnRpYWxUYWJsZSkgewogICAgICAgICAgZmlsZS5wb3MgPSBzdGFydCArIHBvdGVudGlhbFRhYmxlLm9mZnNldDsKICAgICAgICB9CgogICAgICAgIGlmICghcG90ZW50aWFsVGFibGUgfHwgZmlsZS5wZWVrQnl0ZSgpID09PSAtMSkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJDb3VsZCBub3QgZmluZCBhIHByZWZlcnJlZCBjbWFwIHRhYmxlLiIpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcGxhdGZvcm1JZDogLTEsCiAgICAgICAgICAgIGVuY29kaW5nSWQ6IC0xLAogICAgICAgICAgICBtYXBwaW5nczogW10sCiAgICAgICAgICAgIGhhc1Nob3J0Q21hcDogZmFsc2UKICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICB2YXIgZm9ybWF0ID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICBmaWxlLnNraXAoMiArIDIpOwogICAgICAgIHZhciBoYXNTaG9ydENtYXAgPSBmYWxzZTsKICAgICAgICB2YXIgbWFwcGluZ3MgPSBbXTsKICAgICAgICB2YXIgaiwgZ2x5cGhJZDsKCiAgICAgICAgaWYgKGZvcm1hdCA9PT0gMCkgewogICAgICAgICAgZm9yIChqID0gMDsgaiA8IDI1NjsgaisrKSB7CiAgICAgICAgICAgIHZhciBpbmRleCA9IGZpbGUuZ2V0Qnl0ZSgpOwoKICAgICAgICAgICAgaWYgKCFpbmRleCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBtYXBwaW5ncy5wdXNoKHsKICAgICAgICAgICAgICBjaGFyQ29kZTogaiwKICAgICAgICAgICAgICBnbHlwaElkOiBpbmRleAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBoYXNTaG9ydENtYXAgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSA0KSB7CiAgICAgICAgICB2YXIgc2VnQ291bnQgPSBmaWxlLmdldFVpbnQxNigpID4+IDE7CiAgICAgICAgICBmaWxlLnNraXAoNik7CiAgICAgICAgICB2YXIgc2VnSW5kZXgsCiAgICAgICAgICAgICAgc2VnbWVudHMgPSBbXTsKCiAgICAgICAgICBmb3IgKHNlZ0luZGV4ID0gMDsgc2VnSW5kZXggPCBzZWdDb3VudDsgc2VnSW5kZXgrKykgewogICAgICAgICAgICBzZWdtZW50cy5wdXNoKHsKICAgICAgICAgICAgICBlbmQ6IGZpbGUuZ2V0VWludDE2KCkKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgZmlsZS5za2lwKDIpOwoKICAgICAgICAgIGZvciAoc2VnSW5kZXggPSAwOyBzZWdJbmRleCA8IHNlZ0NvdW50OyBzZWdJbmRleCsrKSB7CiAgICAgICAgICAgIHNlZ21lbnRzW3NlZ0luZGV4XS5zdGFydCA9IGZpbGUuZ2V0VWludDE2KCk7CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChzZWdJbmRleCA9IDA7IHNlZ0luZGV4IDwgc2VnQ291bnQ7IHNlZ0luZGV4KyspIHsKICAgICAgICAgICAgc2VnbWVudHNbc2VnSW5kZXhdLmRlbHRhID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgb2Zmc2V0c0NvdW50ID0gMDsKCiAgICAgICAgICBmb3IgKHNlZ0luZGV4ID0gMDsgc2VnSW5kZXggPCBzZWdDb3VudDsgc2VnSW5kZXgrKykgewogICAgICAgICAgICBzZWdtZW50ID0gc2VnbWVudHNbc2VnSW5kZXhdOwogICAgICAgICAgICB2YXIgcmFuZ2VPZmZzZXQgPSBmaWxlLmdldFVpbnQxNigpOwoKICAgICAgICAgICAgaWYgKCFyYW5nZU9mZnNldCkgewogICAgICAgICAgICAgIHNlZ21lbnQub2Zmc2V0SW5kZXggPSAtMTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIG9mZnNldEluZGV4ID0gKHJhbmdlT2Zmc2V0ID4+IDEpIC0gKHNlZ0NvdW50IC0gc2VnSW5kZXgpOwogICAgICAgICAgICBzZWdtZW50Lm9mZnNldEluZGV4ID0gb2Zmc2V0SW5kZXg7CiAgICAgICAgICAgIG9mZnNldHNDb3VudCA9IE1hdGgubWF4KG9mZnNldHNDb3VudCwgb2Zmc2V0SW5kZXggKyBzZWdtZW50LmVuZCAtIHNlZ21lbnQuc3RhcnQgKyAxKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgb2Zmc2V0cyA9IFtdOwoKICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBvZmZzZXRzQ291bnQ7IGorKykgewogICAgICAgICAgICBvZmZzZXRzLnB1c2goZmlsZS5nZXRVaW50MTYoKSk7CiAgICAgICAgICB9CgogICAgICAgICAgZm9yIChzZWdJbmRleCA9IDA7IHNlZ0luZGV4IDwgc2VnQ291bnQ7IHNlZ0luZGV4KyspIHsKICAgICAgICAgICAgc2VnbWVudCA9IHNlZ21lbnRzW3NlZ0luZGV4XTsKICAgICAgICAgICAgc3RhcnQgPSBzZWdtZW50LnN0YXJ0OwogICAgICAgICAgICB2YXIgZW5kID0gc2VnbWVudC5lbmQ7CiAgICAgICAgICAgIHZhciBkZWx0YSA9IHNlZ21lbnQuZGVsdGE7CiAgICAgICAgICAgIG9mZnNldEluZGV4ID0gc2VnbWVudC5vZmZzZXRJbmRleDsKCiAgICAgICAgICAgIGZvciAoaiA9IHN0YXJ0OyBqIDw9IGVuZDsgaisrKSB7CiAgICAgICAgICAgICAgaWYgKGogPT09IDB4ZmZmZikgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBnbHlwaElkID0gb2Zmc2V0SW5kZXggPCAwID8gaiA6IG9mZnNldHNbb2Zmc2V0SW5kZXggKyBqIC0gc3RhcnRdOwogICAgICAgICAgICAgIGdseXBoSWQgPSBnbHlwaElkICsgZGVsdGEgJiAweGZmZmY7CiAgICAgICAgICAgICAgbWFwcGluZ3MucHVzaCh7CiAgICAgICAgICAgICAgICBjaGFyQ29kZTogaiwKICAgICAgICAgICAgICAgIGdseXBoSWQ6IGdseXBoSWQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSA2KSB7CiAgICAgICAgICB2YXIgZmlyc3RDb2RlID0gZmlsZS5nZXRVaW50MTYoKTsKICAgICAgICAgIHZhciBlbnRyeUNvdW50ID0gZmlsZS5nZXRVaW50MTYoKTsKCiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgZW50cnlDb3VudDsgaisrKSB7CiAgICAgICAgICAgIGdseXBoSWQgPSBmaWxlLmdldFVpbnQxNigpOwogICAgICAgICAgICB2YXIgY2hhckNvZGUgPSBmaXJzdENvZGUgKyBqOwogICAgICAgICAgICBtYXBwaW5ncy5wdXNoKHsKICAgICAgICAgICAgICBjaGFyQ29kZTogY2hhckNvZGUsCiAgICAgICAgICAgICAgZ2x5cGhJZDogZ2x5cGhJZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJjbWFwIHRhYmxlIGhhcyB1bnN1cHBvcnRlZCBmb3JtYXQ6ICIgKyBmb3JtYXQpOwogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcGxhdGZvcm1JZDogLTEsCiAgICAgICAgICAgIGVuY29kaW5nSWQ6IC0xLAogICAgICAgICAgICBtYXBwaW5nczogW10sCiAgICAgICAgICAgIGhhc1Nob3J0Q21hcDogZmFsc2UKICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICBtYXBwaW5ncy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICByZXR1cm4gYS5jaGFyQ29kZSAtIGIuY2hhckNvZGU7CiAgICAgICAgfSk7CgogICAgICAgIGZvciAoaSA9IDE7IGkgPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKG1hcHBpbmdzW2kgLSAxXS5jaGFyQ29kZSA9PT0gbWFwcGluZ3NbaV0uY2hhckNvZGUpIHsKICAgICAgICAgICAgbWFwcGluZ3Muc3BsaWNlKGksIDEpOwogICAgICAgICAgICBpLS07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gewogICAgICAgICAgcGxhdGZvcm1JZDogcG90ZW50aWFsVGFibGUucGxhdGZvcm1JZCwKICAgICAgICAgIGVuY29kaW5nSWQ6IHBvdGVudGlhbFRhYmxlLmVuY29kaW5nSWQsCiAgICAgICAgICBtYXBwaW5nczogbWFwcGluZ3MsCiAgICAgICAgICBoYXNTaG9ydENtYXA6IGhhc1Nob3J0Q21hcAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNhbml0aXplTWV0cmljcyhmaWxlLCBoZWFkZXIsIG1ldHJpY3MsIG51bUdseXBocywgZHVwRmlyc3RFbnRyeSkgewogICAgICAgIGlmICghaGVhZGVyKSB7CiAgICAgICAgICBpZiAobWV0cmljcykgewogICAgICAgICAgICBtZXRyaWNzLmRhdGEgPSBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGZpbGUucG9zID0gKGZpbGUuc3RhcnQgPyBmaWxlLnN0YXJ0IDogMCkgKyBoZWFkZXIub2Zmc2V0OwogICAgICAgIGZpbGUucG9zICs9IDQ7CiAgICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgICBmaWxlLnBvcyArPSAyOwogICAgICAgIGZpbGUucG9zICs9IDI7CiAgICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgICBmaWxlLnBvcyArPSAyOwogICAgICAgIGZpbGUucG9zICs9IDI7CiAgICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgICBmaWxlLnBvcyArPSAyOwogICAgICAgIGZpbGUucG9zICs9IDI7CiAgICAgICAgZmlsZS5wb3MgKz0gMjsKICAgICAgICBmaWxlLnBvcyArPSA4OwogICAgICAgIGZpbGUucG9zICs9IDI7CiAgICAgICAgdmFyIG51bU9mTWV0cmljcyA9IGZpbGUuZ2V0VWludDE2KCk7CgogICAgICAgIGlmIChudW1PZk1ldHJpY3MgPiBudW1HbHlwaHMpIHsKICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiVGhlIG51bU9mTWV0cmljcyAoIiArIG51bU9mTWV0cmljcyArICIpIHNob3VsZCBub3QgYmUgIiArICJncmVhdGVyIHRoYW4gdGhlIG51bUdseXBocyAoIiArIG51bUdseXBocyArICIpIik7CiAgICAgICAgICBudW1PZk1ldHJpY3MgPSBudW1HbHlwaHM7CiAgICAgICAgICBoZWFkZXIuZGF0YVszNF0gPSAobnVtT2ZNZXRyaWNzICYgMHhmZjAwKSA+PiA4OwogICAgICAgICAgaGVhZGVyLmRhdGFbMzVdID0gbnVtT2ZNZXRyaWNzICYgMHgwMGZmOwogICAgICAgIH0KCiAgICAgICAgdmFyIG51bU9mU2lkZWJlYXJpbmdzID0gbnVtR2x5cGhzIC0gbnVtT2ZNZXRyaWNzOwogICAgICAgIHZhciBudW1NaXNzaW5nID0gbnVtT2ZTaWRlYmVhcmluZ3MgLSAobWV0cmljcy5sZW5ndGggLSBudW1PZk1ldHJpY3MgKiA0ID4+IDEpOwoKICAgICAgICBpZiAobnVtTWlzc2luZyA+IDApIHsKICAgICAgICAgIHZhciBlbnRyaWVzID0gbmV3IFVpbnQ4QXJyYXkobWV0cmljcy5sZW5ndGggKyBudW1NaXNzaW5nICogMik7CiAgICAgICAgICBlbnRyaWVzLnNldChtZXRyaWNzLmRhdGEpOwoKICAgICAgICAgIGlmIChkdXBGaXJzdEVudHJ5KSB7CiAgICAgICAgICAgIGVudHJpZXNbbWV0cmljcy5sZW5ndGhdID0gbWV0cmljcy5kYXRhWzJdOwogICAgICAgICAgICBlbnRyaWVzW21ldHJpY3MubGVuZ3RoICsgMV0gPSBtZXRyaWNzLmRhdGFbM107CiAgICAgICAgICB9CgogICAgICAgICAgbWV0cmljcy5kYXRhID0gZW50cmllczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNhbml0aXplR2x5cGgoc291cmNlLCBzb3VyY2VTdGFydCwgc291cmNlRW5kLCBkZXN0LCBkZXN0U3RhcnQsIGhpbnRzVmFsaWQpIHsKICAgICAgICB2YXIgZ2x5cGhQcm9maWxlID0gewogICAgICAgICAgbGVuZ3RoOiAwLAogICAgICAgICAgc2l6ZU9mSW5zdHJ1Y3Rpb25zOiAwCiAgICAgICAgfTsKCiAgICAgICAgaWYgKHNvdXJjZUVuZCAtIHNvdXJjZVN0YXJ0IDw9IDEyKSB7CiAgICAgICAgICByZXR1cm4gZ2x5cGhQcm9maWxlOwogICAgICAgIH0KCiAgICAgICAgdmFyIGdseWYgPSBzb3VyY2Uuc3ViYXJyYXkoc291cmNlU3RhcnQsIHNvdXJjZUVuZCk7CiAgICAgICAgdmFyIGNvbnRvdXJzQ291bnQgPSBzaWduZWRJbnQxNihnbHlmWzBdLCBnbHlmWzFdKTsKCiAgICAgICAgaWYgKGNvbnRvdXJzQ291bnQgPCAwKSB7CiAgICAgICAgICBjb250b3Vyc0NvdW50ID0gLTE7CiAgICAgICAgICB3cml0ZVNpZ25lZEludDE2KGdseWYsIDAsIGNvbnRvdXJzQ291bnQpOwogICAgICAgICAgZGVzdC5zZXQoZ2x5ZiwgZGVzdFN0YXJ0KTsKICAgICAgICAgIGdseXBoUHJvZmlsZS5sZW5ndGggPSBnbHlmLmxlbmd0aDsKICAgICAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICAgICAgfQoKICAgICAgICB2YXIgaSwKICAgICAgICAgICAgaiA9IDEwLAogICAgICAgICAgICBmbGFnc0NvdW50ID0gMDsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvbnRvdXJzQ291bnQ7IGkrKykgewogICAgICAgICAgdmFyIGVuZFBvaW50ID0gZ2x5ZltqXSA8PCA4IHwgZ2x5ZltqICsgMV07CiAgICAgICAgICBmbGFnc0NvdW50ID0gZW5kUG9pbnQgKyAxOwogICAgICAgICAgaiArPSAyOwogICAgICAgIH0KCiAgICAgICAgdmFyIGluc3RydWN0aW9uc1N0YXJ0ID0gajsKICAgICAgICB2YXIgaW5zdHJ1Y3Rpb25zTGVuZ3RoID0gZ2x5ZltqXSA8PCA4IHwgZ2x5ZltqICsgMV07CiAgICAgICAgZ2x5cGhQcm9maWxlLnNpemVPZkluc3RydWN0aW9ucyA9IGluc3RydWN0aW9uc0xlbmd0aDsKICAgICAgICBqICs9IDIgKyBpbnN0cnVjdGlvbnNMZW5ndGg7CiAgICAgICAgdmFyIGluc3RydWN0aW9uc0VuZCA9IGo7CiAgICAgICAgdmFyIGNvb3JkaW5hdGVzTGVuZ3RoID0gMDsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGZsYWdzQ291bnQ7IGkrKykgewogICAgICAgICAgdmFyIGZsYWcgPSBnbHlmW2orK107CgogICAgICAgICAgaWYgKGZsYWcgJiAweGMwKSB7CiAgICAgICAgICAgIGdseWZbaiAtIDFdID0gZmxhZyAmIDB4M2Y7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHhMZW5ndGggPSAyOwoKICAgICAgICAgIGlmIChmbGFnICYgMikgewogICAgICAgICAgICB4TGVuZ3RoID0gMTsKICAgICAgICAgIH0gZWxzZSBpZiAoZmxhZyAmIDE2KSB7CiAgICAgICAgICAgIHhMZW5ndGggPSAwOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciB5TGVuZ3RoID0gMjsKCiAgICAgICAgICBpZiAoZmxhZyAmIDQpIHsKICAgICAgICAgICAgeUxlbmd0aCA9IDE7CiAgICAgICAgICB9IGVsc2UgaWYgKGZsYWcgJiAzMikgewogICAgICAgICAgICB5TGVuZ3RoID0gMDsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgeHlMZW5ndGggPSB4TGVuZ3RoICsgeUxlbmd0aDsKICAgICAgICAgIGNvb3JkaW5hdGVzTGVuZ3RoICs9IHh5TGVuZ3RoOwoKICAgICAgICAgIGlmIChmbGFnICYgOCkgewogICAgICAgICAgICB2YXIgcmVwZWF0ID0gZ2x5ZltqKytdOwogICAgICAgICAgICBpICs9IHJlcGVhdDsKICAgICAgICAgICAgY29vcmRpbmF0ZXNMZW5ndGggKz0gcmVwZWF0ICogeHlMZW5ndGg7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoY29vcmRpbmF0ZXNMZW5ndGggPT09IDApIHsKICAgICAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICAgICAgfQoKICAgICAgICB2YXIgZ2x5cGhEYXRhTGVuZ3RoID0gaiArIGNvb3JkaW5hdGVzTGVuZ3RoOwoKICAgICAgICBpZiAoZ2x5cGhEYXRhTGVuZ3RoID4gZ2x5Zi5sZW5ndGgpIHsKICAgICAgICAgIHJldHVybiBnbHlwaFByb2ZpbGU7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWhpbnRzVmFsaWQgJiYgaW5zdHJ1Y3Rpb25zTGVuZ3RoID4gMCkgewogICAgICAgICAgZGVzdC5zZXQoZ2x5Zi5zdWJhcnJheSgwLCBpbnN0cnVjdGlvbnNTdGFydCksIGRlc3RTdGFydCk7CiAgICAgICAgICBkZXN0LnNldChbMCwgMF0sIGRlc3RTdGFydCArIGluc3RydWN0aW9uc1N0YXJ0KTsKICAgICAgICAgIGRlc3Quc2V0KGdseWYuc3ViYXJyYXkoaW5zdHJ1Y3Rpb25zRW5kLCBnbHlwaERhdGFMZW5ndGgpLCBkZXN0U3RhcnQgKyBpbnN0cnVjdGlvbnNTdGFydCArIDIpOwogICAgICAgICAgZ2x5cGhEYXRhTGVuZ3RoIC09IGluc3RydWN0aW9uc0xlbmd0aDsKCiAgICAgICAgICBpZiAoZ2x5Zi5sZW5ndGggLSBnbHlwaERhdGFMZW5ndGggPiAzKSB7CiAgICAgICAgICAgIGdseXBoRGF0YUxlbmd0aCA9IGdseXBoRGF0YUxlbmd0aCArIDMgJiB+MzsKICAgICAgICAgIH0KCiAgICAgICAgICBnbHlwaFByb2ZpbGUubGVuZ3RoID0gZ2x5cGhEYXRhTGVuZ3RoOwogICAgICAgICAgcmV0dXJuIGdseXBoUHJvZmlsZTsKICAgICAgICB9CgogICAgICAgIGlmIChnbHlmLmxlbmd0aCAtIGdseXBoRGF0YUxlbmd0aCA+IDMpIHsKICAgICAgICAgIGdseXBoRGF0YUxlbmd0aCA9IGdseXBoRGF0YUxlbmd0aCArIDMgJiB+MzsKICAgICAgICAgIGRlc3Quc2V0KGdseWYuc3ViYXJyYXkoMCwgZ2x5cGhEYXRhTGVuZ3RoKSwgZGVzdFN0YXJ0KTsKICAgICAgICAgIGdseXBoUHJvZmlsZS5sZW5ndGggPSBnbHlwaERhdGFMZW5ndGg7CiAgICAgICAgICByZXR1cm4gZ2x5cGhQcm9maWxlOwogICAgICAgIH0KCiAgICAgICAgZGVzdC5zZXQoZ2x5ZiwgZGVzdFN0YXJ0KTsKICAgICAgICBnbHlwaFByb2ZpbGUubGVuZ3RoID0gZ2x5Zi5sZW5ndGg7CiAgICAgICAgcmV0dXJuIGdseXBoUHJvZmlsZTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gc2FuaXRpemVIZWFkKGhlYWQsIG51bUdseXBocywgbG9jYUxlbmd0aCkgewogICAgICAgIHZhciBkYXRhID0gaGVhZC5kYXRhOwogICAgICAgIHZhciB2ZXJzaW9uID0gaW50MzIoZGF0YVswXSwgZGF0YVsxXSwgZGF0YVsyXSwgZGF0YVszXSk7CgogICAgICAgIGlmICh2ZXJzaW9uID4+IDE2ICE9PSAxKSB7CiAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkF0dGVtcHRpbmcgdG8gZml4IGludmFsaWQgdmVyc2lvbiBpbiBoZWFkIHRhYmxlOiAiICsgdmVyc2lvbik7CiAgICAgICAgICBkYXRhWzBdID0gMDsKICAgICAgICAgIGRhdGFbMV0gPSAxOwogICAgICAgICAgZGF0YVsyXSA9IDA7CiAgICAgICAgICBkYXRhWzNdID0gMDsKICAgICAgICB9CgogICAgICAgIHZhciBpbmRleFRvTG9jRm9ybWF0ID0gaW50MTYoZGF0YVs1MF0sIGRhdGFbNTFdKTsKCiAgICAgICAgaWYgKGluZGV4VG9Mb2NGb3JtYXQgPCAwIHx8IGluZGV4VG9Mb2NGb3JtYXQgPiAxKSB7CiAgICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkF0dGVtcHRpbmcgdG8gZml4IGludmFsaWQgaW5kZXhUb0xvY0Zvcm1hdCBpbiBoZWFkIHRhYmxlOiAiICsgaW5kZXhUb0xvY0Zvcm1hdCk7CiAgICAgICAgICB2YXIgbnVtR2x5cGhzUGx1c09uZSA9IG51bUdseXBocyArIDE7CgogICAgICAgICAgaWYgKGxvY2FMZW5ndGggPT09IG51bUdseXBoc1BsdXNPbmUgPDwgMSkgewogICAgICAgICAgICBkYXRhWzUwXSA9IDA7CiAgICAgICAgICAgIGRhdGFbNTFdID0gMDsKICAgICAgICAgIH0gZWxzZSBpZiAobG9jYUxlbmd0aCA9PT0gbnVtR2x5cGhzUGx1c09uZSA8PCAyKSB7CiAgICAgICAgICAgIGRhdGFbNTBdID0gMDsKICAgICAgICAgICAgZGF0YVs1MV0gPSAxOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJDb3VsZCBub3QgZml4IGluZGV4VG9Mb2NGb3JtYXQ6ICIgKyBpbmRleFRvTG9jRm9ybWF0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNhbml0aXplR2x5cGhMb2NhdGlvbnMobG9jYSwgZ2x5ZiwgbnVtR2x5cGhzLCBpc0dseXBoTG9jYXRpb25zTG9uZywgaGludHNWYWxpZCwgZHVwRmlyc3RFbnRyeSwgbWF4U2l6ZU9mSW5zdHJ1Y3Rpb25zKSB7CiAgICAgICAgdmFyIGl0ZW1TaXplLCBpdGVtRGVjb2RlLCBpdGVtRW5jb2RlOwoKICAgICAgICBpZiAoaXNHbHlwaExvY2F0aW9uc0xvbmcpIHsKICAgICAgICAgIGl0ZW1TaXplID0gNDsKCiAgICAgICAgICBpdGVtRGVjb2RlID0gZnVuY3Rpb24gZm9udEl0ZW1EZWNvZGVMb25nKGRhdGEsIG9mZnNldCkgewogICAgICAgICAgICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDI0IHwgZGF0YVtvZmZzZXQgKyAxXSA8PCAxNiB8IGRhdGFbb2Zmc2V0ICsgMl0gPDwgOCB8IGRhdGFbb2Zmc2V0ICsgM107CiAgICAgICAgICB9OwoKICAgICAgICAgIGl0ZW1FbmNvZGUgPSBmdW5jdGlvbiBmb250SXRlbUVuY29kZUxvbmcoZGF0YSwgb2Zmc2V0LCB2YWx1ZSkgewogICAgICAgICAgICBkYXRhW29mZnNldF0gPSB2YWx1ZSA+Pj4gMjQgJiAweGZmOwogICAgICAgICAgICBkYXRhW29mZnNldCArIDFdID0gdmFsdWUgPj4gMTYgJiAweGZmOwogICAgICAgICAgICBkYXRhW29mZnNldCArIDJdID0gdmFsdWUgPj4gOCAmIDB4ZmY7CiAgICAgICAgICAgIGRhdGFbb2Zmc2V0ICsgM10gPSB2YWx1ZSAmIDB4ZmY7CiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpdGVtU2l6ZSA9IDI7CgogICAgICAgICAgaXRlbURlY29kZSA9IGZ1bmN0aW9uIGZvbnRJdGVtRGVjb2RlKGRhdGEsIG9mZnNldCkgewogICAgICAgICAgICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDkgfCBkYXRhW29mZnNldCArIDFdIDw8IDE7CiAgICAgICAgICB9OwoKICAgICAgICAgIGl0ZW1FbmNvZGUgPSBmdW5jdGlvbiBmb250SXRlbUVuY29kZShkYXRhLCBvZmZzZXQsIHZhbHVlKSB7CiAgICAgICAgICAgIGRhdGFbb2Zmc2V0XSA9IHZhbHVlID4+IDkgJiAweGZmOwogICAgICAgICAgICBkYXRhW29mZnNldCArIDFdID0gdmFsdWUgPj4gMSAmIDB4ZmY7CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgdmFyIG51bUdseXBoc091dCA9IGR1cEZpcnN0RW50cnkgPyBudW1HbHlwaHMgKyAxIDogbnVtR2x5cGhzOwogICAgICAgIHZhciBsb2NhRGF0YVNpemUgPSBpdGVtU2l6ZSAqICgxICsgbnVtR2x5cGhzT3V0KTsKICAgICAgICB2YXIgbG9jYURhdGEgPSBuZXcgVWludDhBcnJheShsb2NhRGF0YVNpemUpOwogICAgICAgIGxvY2FEYXRhLnNldChsb2NhLmRhdGEuc3ViYXJyYXkoMCwgbG9jYURhdGFTaXplKSk7CiAgICAgICAgbG9jYS5kYXRhID0gbG9jYURhdGE7CiAgICAgICAgdmFyIG9sZEdseWZEYXRhID0gZ2x5Zi5kYXRhOwogICAgICAgIHZhciBvbGRHbHlmRGF0YUxlbmd0aCA9IG9sZEdseWZEYXRhLmxlbmd0aDsKICAgICAgICB2YXIgbmV3R2x5ZkRhdGEgPSBuZXcgVWludDhBcnJheShvbGRHbHlmRGF0YUxlbmd0aCk7CiAgICAgICAgdmFyIHN0YXJ0T2Zmc2V0ID0gaXRlbURlY29kZShsb2NhRGF0YSwgMCk7CiAgICAgICAgdmFyIHdyaXRlT2Zmc2V0ID0gMDsKICAgICAgICB2YXIgbWlzc2luZ0dseXBocyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgICAgaXRlbUVuY29kZShsb2NhRGF0YSwgMCwgd3JpdGVPZmZzZXQpOwogICAgICAgIHZhciBpLCBqOwoKICAgICAgICBmb3IgKGkgPSAwLCBqID0gaXRlbVNpemU7IGkgPCBudW1HbHlwaHM7IGkrKywgaiArPSBpdGVtU2l6ZSkgewogICAgICAgICAgdmFyIGVuZE9mZnNldCA9IGl0ZW1EZWNvZGUobG9jYURhdGEsIGopOwoKICAgICAgICAgIGlmIChlbmRPZmZzZXQgPT09IDApIHsKICAgICAgICAgICAgZW5kT2Zmc2V0ID0gc3RhcnRPZmZzZXQ7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGVuZE9mZnNldCA+IG9sZEdseWZEYXRhTGVuZ3RoICYmIChvbGRHbHlmRGF0YUxlbmd0aCArIDMgJiB+MykgPT09IGVuZE9mZnNldCkgewogICAgICAgICAgICBlbmRPZmZzZXQgPSBvbGRHbHlmRGF0YUxlbmd0aDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZW5kT2Zmc2V0ID4gb2xkR2x5ZkRhdGFMZW5ndGgpIHsKICAgICAgICAgICAgc3RhcnRPZmZzZXQgPSBlbmRPZmZzZXQ7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGdseXBoUHJvZmlsZSA9IHNhbml0aXplR2x5cGgob2xkR2x5ZkRhdGEsIHN0YXJ0T2Zmc2V0LCBlbmRPZmZzZXQsIG5ld0dseWZEYXRhLCB3cml0ZU9mZnNldCwgaGludHNWYWxpZCk7CiAgICAgICAgICB2YXIgbmV3TGVuZ3RoID0gZ2x5cGhQcm9maWxlLmxlbmd0aDsKCiAgICAgICAgICBpZiAobmV3TGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIG1pc3NpbmdHbHlwaHNbaV0gPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChnbHlwaFByb2ZpbGUuc2l6ZU9mSW5zdHJ1Y3Rpb25zID4gbWF4U2l6ZU9mSW5zdHJ1Y3Rpb25zKSB7CiAgICAgICAgICAgIG1heFNpemVPZkluc3RydWN0aW9ucyA9IGdseXBoUHJvZmlsZS5zaXplT2ZJbnN0cnVjdGlvbnM7CiAgICAgICAgICB9CgogICAgICAgICAgd3JpdGVPZmZzZXQgKz0gbmV3TGVuZ3RoOwogICAgICAgICAgaXRlbUVuY29kZShsb2NhRGF0YSwgaiwgd3JpdGVPZmZzZXQpOwogICAgICAgICAgc3RhcnRPZmZzZXQgPSBlbmRPZmZzZXQ7CiAgICAgICAgfQoKICAgICAgICBpZiAod3JpdGVPZmZzZXQgPT09IDApIHsKICAgICAgICAgIHZhciBzaW1wbGVHbHlwaCA9IG5ldyBVaW50OEFycmF5KFswLCAxLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCA0OSwgMF0pOwoKICAgICAgICAgIGZvciAoaSA9IDAsIGogPSBpdGVtU2l6ZTsgaSA8IG51bUdseXBoc091dDsgaSsrLCBqICs9IGl0ZW1TaXplKSB7CiAgICAgICAgICAgIGl0ZW1FbmNvZGUobG9jYURhdGEsIGosIHNpbXBsZUdseXBoLmxlbmd0aCk7CiAgICAgICAgICB9CgogICAgICAgICAgZ2x5Zi5kYXRhID0gc2ltcGxlR2x5cGg7CiAgICAgICAgfSBlbHNlIGlmIChkdXBGaXJzdEVudHJ5KSB7CiAgICAgICAgICB2YXIgZmlyc3RFbnRyeUxlbmd0aCA9IGl0ZW1EZWNvZGUobG9jYURhdGEsIGl0ZW1TaXplKTsKCiAgICAgICAgICBpZiAobmV3R2x5ZkRhdGEubGVuZ3RoID4gZmlyc3RFbnRyeUxlbmd0aCArIHdyaXRlT2Zmc2V0KSB7CiAgICAgICAgICAgIGdseWYuZGF0YSA9IG5ld0dseWZEYXRhLnN1YmFycmF5KDAsIGZpcnN0RW50cnlMZW5ndGggKyB3cml0ZU9mZnNldCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBnbHlmLmRhdGEgPSBuZXcgVWludDhBcnJheShmaXJzdEVudHJ5TGVuZ3RoICsgd3JpdGVPZmZzZXQpOwogICAgICAgICAgICBnbHlmLmRhdGEuc2V0KG5ld0dseWZEYXRhLnN1YmFycmF5KDAsIHdyaXRlT2Zmc2V0KSk7CiAgICAgICAgICB9CgogICAgICAgICAgZ2x5Zi5kYXRhLnNldChuZXdHbHlmRGF0YS5zdWJhcnJheSgwLCBmaXJzdEVudHJ5TGVuZ3RoKSwgd3JpdGVPZmZzZXQpOwogICAgICAgICAgaXRlbUVuY29kZShsb2NhLmRhdGEsIGxvY2FEYXRhLmxlbmd0aCAtIGl0ZW1TaXplLCB3cml0ZU9mZnNldCArIGZpcnN0RW50cnlMZW5ndGgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBnbHlmLmRhdGEgPSBuZXdHbHlmRGF0YS5zdWJhcnJheSgwLCB3cml0ZU9mZnNldCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gewogICAgICAgICAgbWlzc2luZ0dseXBoczogbWlzc2luZ0dseXBocywKICAgICAgICAgIG1heFNpemVPZkluc3RydWN0aW9uczogbWF4U2l6ZU9mSW5zdHJ1Y3Rpb25zCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gcmVhZFBvc3RTY3JpcHRUYWJsZShwb3N0LCBwcm9wZXJ0aWVzT2JqLCBtYXhwTnVtR2x5cGhzKSB7CiAgICAgICAgdmFyIHN0YXJ0ID0gKGZvbnQuc3RhcnQgPyBmb250LnN0YXJ0IDogMCkgKyBwb3N0Lm9mZnNldDsKICAgICAgICBmb250LnBvcyA9IHN0YXJ0OwogICAgICAgIHZhciBsZW5ndGggPSBwb3N0Lmxlbmd0aCwKICAgICAgICAgICAgZW5kID0gc3RhcnQgKyBsZW5ndGg7CiAgICAgICAgdmFyIHZlcnNpb24gPSBmb250LmdldEludDMyKCk7CiAgICAgICAgZm9udC5za2lwKDI4KTsKICAgICAgICB2YXIgZ2x5cGhOYW1lczsKICAgICAgICB2YXIgdmFsaWQgPSB0cnVlOwogICAgICAgIHZhciBpOwoKICAgICAgICBzd2l0Y2ggKHZlcnNpb24pIHsKICAgICAgICAgIGNhc2UgMHgwMDAxMDAwMDoKICAgICAgICAgICAgZ2x5cGhOYW1lcyA9IE1hY1N0YW5kYXJkR2x5cGhPcmRlcmluZzsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAweDAwMDIwMDAwOgogICAgICAgICAgICB2YXIgbnVtR2x5cGhzID0gZm9udC5nZXRVaW50MTYoKTsKCiAgICAgICAgICAgIGlmIChudW1HbHlwaHMgIT09IG1heHBOdW1HbHlwaHMpIHsKICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgZ2x5cGhOYW1lSW5kZXhlcyA9IFtdOwoKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG51bUdseXBoczsgKytpKSB7CiAgICAgICAgICAgICAgdmFyIGluZGV4ID0gZm9udC5nZXRVaW50MTYoKTsKCiAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDMyNzY4KSB7CiAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBnbHlwaE5hbWVJbmRleGVzLnB1c2goaW5kZXgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIXZhbGlkKSB7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBjdXN0b21OYW1lcyA9IFtdOwogICAgICAgICAgICB2YXIgc3RyQnVmID0gW107CgogICAgICAgICAgICB3aGlsZSAoZm9udC5wb3MgPCBlbmQpIHsKICAgICAgICAgICAgICB2YXIgc3RyaW5nTGVuZ3RoID0gZm9udC5nZXRCeXRlKCk7CiAgICAgICAgICAgICAgc3RyQnVmLmxlbmd0aCA9IHN0cmluZ0xlbmd0aDsKCiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHN0cmluZ0xlbmd0aDsgKytpKSB7CiAgICAgICAgICAgICAgICBzdHJCdWZbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGZvbnQuZ2V0Qnl0ZSgpKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGN1c3RvbU5hbWVzLnB1c2goc3RyQnVmLmpvaW4oIiIpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZ2x5cGhOYW1lcyA9IFtdOwoKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG51bUdseXBoczsgKytpKSB7CiAgICAgICAgICAgICAgdmFyIGogPSBnbHlwaE5hbWVJbmRleGVzW2ldOwoKICAgICAgICAgICAgICBpZiAoaiA8IDI1OCkgewogICAgICAgICAgICAgICAgZ2x5cGhOYW1lcy5wdXNoKE1hY1N0YW5kYXJkR2x5cGhPcmRlcmluZ1tqXSk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGdseXBoTmFtZXMucHVzaChjdXN0b21OYW1lc1tqIC0gMjU4XSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMHgwMDAzMDAwMDoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbmtub3duL3Vuc3VwcG9ydGVkIHBvc3QgdGFibGUgdmVyc2lvbiAiICsgdmVyc2lvbik7CiAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7CgogICAgICAgICAgICBpZiAocHJvcGVydGllc09iai5kZWZhdWx0RW5jb2RpbmcpIHsKICAgICAgICAgICAgICBnbHlwaE5hbWVzID0gcHJvcGVydGllc09iai5kZWZhdWx0RW5jb2Rpbmc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgcHJvcGVydGllc09iai5nbHlwaE5hbWVzID0gZ2x5cGhOYW1lczsKICAgICAgICByZXR1cm4gdmFsaWQ7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHJlYWROYW1lVGFibGUobmFtZVRhYmxlKSB7CiAgICAgICAgdmFyIHN0YXJ0ID0gKGZvbnQuc3RhcnQgPyBmb250LnN0YXJ0IDogMCkgKyBuYW1lVGFibGUub2Zmc2V0OwogICAgICAgIGZvbnQucG9zID0gc3RhcnQ7CiAgICAgICAgdmFyIG5hbWVzID0gW1tdLCBbXV07CiAgICAgICAgdmFyIGxlbmd0aCA9IG5hbWVUYWJsZS5sZW5ndGgsCiAgICAgICAgICAgIGVuZCA9IHN0YXJ0ICsgbGVuZ3RoOwogICAgICAgIHZhciBmb3JtYXQgPSBmb250LmdldFVpbnQxNigpOwogICAgICAgIHZhciBGT1JNQVRfMF9IRUFERVJfTEVOR1RIID0gNjsKCiAgICAgICAgaWYgKGZvcm1hdCAhPT0gMCB8fCBsZW5ndGggPCBGT1JNQVRfMF9IRUFERVJfTEVOR1RIKSB7CiAgICAgICAgICByZXR1cm4gbmFtZXM7CiAgICAgICAgfQoKICAgICAgICB2YXIgbnVtUmVjb3JkcyA9IGZvbnQuZ2V0VWludDE2KCk7CiAgICAgICAgdmFyIHN0cmluZ3NTdGFydCA9IGZvbnQuZ2V0VWludDE2KCk7CiAgICAgICAgdmFyIHJlY29yZHMgPSBbXTsKICAgICAgICB2YXIgTkFNRV9SRUNPUkRfTEVOR1RIID0gMTI7CiAgICAgICAgdmFyIGksIGlpOwoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtUmVjb3JkcyAmJiBmb250LnBvcyArIE5BTUVfUkVDT1JEX0xFTkdUSCA8PSBlbmQ7IGkrKykgewogICAgICAgICAgdmFyIHIgPSB7CiAgICAgICAgICAgIHBsYXRmb3JtOiBmb250LmdldFVpbnQxNigpLAogICAgICAgICAgICBlbmNvZGluZzogZm9udC5nZXRVaW50MTYoKSwKICAgICAgICAgICAgbGFuZ3VhZ2U6IGZvbnQuZ2V0VWludDE2KCksCiAgICAgICAgICAgIG5hbWU6IGZvbnQuZ2V0VWludDE2KCksCiAgICAgICAgICAgIGxlbmd0aDogZm9udC5nZXRVaW50MTYoKSwKICAgICAgICAgICAgb2Zmc2V0OiBmb250LmdldFVpbnQxNigpCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChyLnBsYXRmb3JtID09PSAxICYmIHIuZW5jb2RpbmcgPT09IDAgJiYgci5sYW5ndWFnZSA9PT0gMCB8fCByLnBsYXRmb3JtID09PSAzICYmIHIuZW5jb2RpbmcgPT09IDEgJiYgci5sYW5ndWFnZSA9PT0gMHg0MDkpIHsKICAgICAgICAgICAgcmVjb3Jkcy5wdXNoKHIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yIChpID0gMCwgaWkgPSByZWNvcmRzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIHZhciByZWNvcmQgPSByZWNvcmRzW2ldOwoKICAgICAgICAgIGlmIChyZWNvcmQubGVuZ3RoIDw9IDApIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHBvcyA9IHN0YXJ0ICsgc3RyaW5nc1N0YXJ0ICsgcmVjb3JkLm9mZnNldDsKCiAgICAgICAgICBpZiAocG9zICsgcmVjb3JkLmxlbmd0aCA+IGVuZCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb250LnBvcyA9IHBvczsKICAgICAgICAgIHZhciBuYW1lSW5kZXggPSByZWNvcmQubmFtZTsKCiAgICAgICAgICBpZiAocmVjb3JkLmVuY29kaW5nKSB7CiAgICAgICAgICAgIHZhciBzdHIgPSAiIjsKCiAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IHJlY29yZC5sZW5ndGg7IGogPCBqajsgaiArPSAyKSB7CiAgICAgICAgICAgICAgc3RyICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoZm9udC5nZXRVaW50MTYoKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5hbWVzWzFdW25hbWVJbmRleF0gPSBzdHI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuYW1lc1swXVtuYW1lSW5kZXhdID0gKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKGZvbnQuZ2V0Qnl0ZXMocmVjb3JkLmxlbmd0aCkpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5hbWVzOwogICAgICB9CgogICAgICB2YXIgVFRPcHNTdGFja0RlbHRhcyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAtMiwgLTIsIC0yLCAtMiwgMCwgMCwgLTIsIC01LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDAsIDAsIC0xLCAwLCAtMSwgLTEsIC0xLCAtMSwgMSwgLTEsIC05OTksIDAsIDEsIDAsIC0xLCAtMiwgMCwgLTEsIC0yLCAtMSwgLTEsIDAsIC0xLCAtMSwgMCwgMCwgLTk5OSwgLTk5OSwgLTEsIC0xLCAtMSwgLTEsIC0yLCAtOTk5LCAtMiwgLTIsIC05OTksIDAsIC0yLCAtMiwgMCwgMCwgLTIsIDAsIC0yLCAwLCAwLCAwLCAtMiwgLTEsIC0xLCAxLCAxLCAwLCAwLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgMCwgMCwgLTEsIDAsIC0xLCAtMSwgMCwgLTk5OSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgLTIsIC05OTksIC05OTksIC05OTksIC05OTksIC05OTksIC0xLCAtMSwgLTIsIC0yLCAwLCAwLCAwLCAwLCAtMSwgLTEsIC05OTksIC0yLCAtMiwgMCwgMCwgLTEsIC0yLCAtMiwgMCwgMCwgMCwgLTEsIC0xLCAtMSwgLTJdOwoKICAgICAgZnVuY3Rpb24gc2FuaXRpemVUVFByb2dyYW0odGFibGUsIHR0Q29udGV4dCkgewogICAgICAgIHZhciBkYXRhID0gdGFibGUuZGF0YTsKICAgICAgICB2YXIgaSA9IDAsCiAgICAgICAgICAgIGosCiAgICAgICAgICAgIG4sCiAgICAgICAgICAgIGIsCiAgICAgICAgICAgIGZ1bmNJZCwKICAgICAgICAgICAgcGMsCiAgICAgICAgICAgIGxhc3RFbmRmID0gMCwKICAgICAgICAgICAgbGFzdERlZmYgPSAwOwogICAgICAgIHZhciBzdGFjayA9IFtdOwogICAgICAgIHZhciBjYWxsc3RhY2sgPSBbXTsKICAgICAgICB2YXIgZnVuY3Rpb25zQ2FsbGVkID0gW107CiAgICAgICAgdmFyIHRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucyA9IHR0Q29udGV4dC50b29Db21wbGV4VG9Gb2xsb3dGdW5jdGlvbnM7CiAgICAgICAgdmFyIGluRkRFRiA9IGZhbHNlLAogICAgICAgICAgICBpZkxldmVsID0gMCwKICAgICAgICAgICAgaW5FTFNFID0gMDsKCiAgICAgICAgZm9yICh2YXIgaWkgPSBkYXRhLmxlbmd0aDsgaSA8IGlpOykgewogICAgICAgICAgdmFyIG9wID0gZGF0YVtpKytdOwoKICAgICAgICAgIGlmIChvcCA9PT0gMHg0MCkgewogICAgICAgICAgICBuID0gZGF0YVtpKytdOwoKICAgICAgICAgICAgaWYgKGluRkRFRiB8fCBpbkVMU0UpIHsKICAgICAgICAgICAgICBpICs9IG47CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG47IGorKykgewogICAgICAgICAgICAgICAgc3RhY2sucHVzaChkYXRhW2krK10pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHg0MSkgewogICAgICAgICAgICBuID0gZGF0YVtpKytdOwoKICAgICAgICAgICAgaWYgKGluRkRFRiB8fCBpbkVMU0UpIHsKICAgICAgICAgICAgICBpICs9IG4gKiAyOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBuOyBqKyspIHsKICAgICAgICAgICAgICAgIGIgPSBkYXRhW2krK107CiAgICAgICAgICAgICAgICBzdGFjay5wdXNoKGIgPDwgOCB8IGRhdGFbaSsrXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKChvcCAmIDB4ZjgpID09PSAweGIwKSB7CiAgICAgICAgICAgIG4gPSBvcCAtIDB4YjAgKyAxOwoKICAgICAgICAgICAgaWYgKGluRkRFRiB8fCBpbkVMU0UpIHsKICAgICAgICAgICAgICBpICs9IG47CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG47IGorKykgewogICAgICAgICAgICAgICAgc3RhY2sucHVzaChkYXRhW2krK10pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmICgob3AgJiAweGY4KSA9PT0gMHhiOCkgewogICAgICAgICAgICBuID0gb3AgLSAweGI4ICsgMTsKCiAgICAgICAgICAgIGlmIChpbkZERUYgfHwgaW5FTFNFKSB7CiAgICAgICAgICAgICAgaSArPSBuICogMjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbjsgaisrKSB7CiAgICAgICAgICAgICAgICBiID0gZGF0YVtpKytdOwogICAgICAgICAgICAgICAgc3RhY2sucHVzaChiIDw8IDggfCBkYXRhW2krK10pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHgyYiAmJiAhdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zKSB7CiAgICAgICAgICAgIGlmICghaW5GREVGICYmICFpbkVMU0UpIHsKICAgICAgICAgICAgICBmdW5jSWQgPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTsKCiAgICAgICAgICAgICAgaWYgKGlzTmFOKGZ1bmNJZCkpIHsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC5pbmZvKSgiVFQ6IENBTEwgZW1wdHkgc3RhY2sgKG9yIGludmFsaWQgZW50cnkpLiIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0dENvbnRleHQuZnVuY3Rpb25zVXNlZFtmdW5jSWRdID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoZnVuY0lkIGluIHR0Q29udGV4dC5mdW5jdGlvbnNTdGFja0RlbHRhcykgewogICAgICAgICAgICAgICAgICB2YXIgbmV3U3RhY2tMZW5ndGggPSBzdGFjay5sZW5ndGggKyB0dENvbnRleHQuZnVuY3Rpb25zU3RhY2tEZWx0YXNbZnVuY0lkXTsKCiAgICAgICAgICAgICAgICAgIGlmIChuZXdTdGFja0xlbmd0aCA8IDApIHsKICAgICAgICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIlRUOiBDQUxMIGludmFsaWQgZnVuY3Rpb25zIHN0YWNrIGRlbHRhLiIpOwogICAgICAgICAgICAgICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBzdGFjay5sZW5ndGggPSBuZXdTdGFja0xlbmd0aDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZnVuY0lkIGluIHR0Q29udGV4dC5mdW5jdGlvbnNEZWZpbmVkICYmICFmdW5jdGlvbnNDYWxsZWQuaW5jbHVkZXMoZnVuY0lkKSkgewogICAgICAgICAgICAgICAgICBjYWxsc3RhY2sucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgICAgICAgICAgICBpOiBpLAogICAgICAgICAgICAgICAgICAgIHN0YWNrVG9wOiBzdGFjay5sZW5ndGggLSAxCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBmdW5jdGlvbnNDYWxsZWQucHVzaChmdW5jSWQpOwogICAgICAgICAgICAgICAgICBwYyA9IHR0Q29udGV4dC5mdW5jdGlvbnNEZWZpbmVkW2Z1bmNJZF07CgogICAgICAgICAgICAgICAgICBpZiAoIXBjKSB7CiAgICAgICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogQ0FMTCBub24tZXhpc3RlbnQgZnVuY3Rpb24iKTsKICAgICAgICAgICAgICAgICAgICB0dENvbnRleHQuaGludHNWYWxpZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgZGF0YSA9IHBjLmRhdGE7CiAgICAgICAgICAgICAgICAgIGkgPSBwYy5pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHgyYyAmJiAhdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zKSB7CiAgICAgICAgICAgIGlmIChpbkZERUYgfHwgaW5FTFNFKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogbmVzdGVkIEZERUZzIG5vdCBhbGxvd2VkIik7CiAgICAgICAgICAgICAgdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaW5GREVGID0gdHJ1ZTsKICAgICAgICAgICAgbGFzdERlZmYgPSBpOwogICAgICAgICAgICBmdW5jSWQgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgdHRDb250ZXh0LmZ1bmN0aW9uc0RlZmluZWRbZnVuY0lkXSA9IHsKICAgICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICAgIGk6IGkKICAgICAgICAgICAgfTsKICAgICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4MmQpIHsKICAgICAgICAgICAgaWYgKGluRkRFRikgewogICAgICAgICAgICAgIGluRkRFRiA9IGZhbHNlOwogICAgICAgICAgICAgIGxhc3RFbmRmID0gaTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBwYyA9IGNhbGxzdGFjay5wb3AoKTsKCiAgICAgICAgICAgICAgaWYgKCFwYykgewogICAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogRU5ERiBiYWQgc3RhY2siKTsKICAgICAgICAgICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmdW5jSWQgPSBmdW5jdGlvbnNDYWxsZWQucG9wKCk7CiAgICAgICAgICAgICAgZGF0YSA9IHBjLmRhdGE7CiAgICAgICAgICAgICAgaSA9IHBjLmk7CiAgICAgICAgICAgICAgdHRDb250ZXh0LmZ1bmN0aW9uc1N0YWNrRGVsdGFzW2Z1bmNJZF0gPSBzdGFjay5sZW5ndGggLSBwYy5zdGFja1RvcDsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHg4OSkgewogICAgICAgICAgICBpZiAoaW5GREVGIHx8IGluRUxTRSkgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IG5lc3RlZCBJREVGcyBub3QgYWxsb3dlZCIpOwogICAgICAgICAgICAgIHRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucyA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGluRkRFRiA9IHRydWU7CiAgICAgICAgICAgIGxhc3REZWZmID0gaTsKICAgICAgICAgIH0gZWxzZSBpZiAob3AgPT09IDB4NTgpIHsKICAgICAgICAgICAgKytpZkxldmVsOwogICAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHgxYikgewogICAgICAgICAgICBpbkVMU0UgPSBpZkxldmVsOwogICAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHg1OSkgewogICAgICAgICAgICBpZiAoaW5FTFNFID09PSBpZkxldmVsKSB7CiAgICAgICAgICAgICAgaW5FTFNFID0gMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLS1pZkxldmVsOwogICAgICAgICAgfSBlbHNlIGlmIChvcCA9PT0gMHgxYykgewogICAgICAgICAgICBpZiAoIWluRkRFRiAmJiAhaW5FTFNFKSB7CiAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdOwoKICAgICAgICAgICAgICBpZiAob2Zmc2V0ID4gMCkgewogICAgICAgICAgICAgICAgaSArPSBvZmZzZXQgLSAxOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmICghaW5GREVGICYmICFpbkVMU0UpIHsKICAgICAgICAgICAgdmFyIHN0YWNrRGVsdGEgPSAwOwoKICAgICAgICAgICAgaWYgKG9wIDw9IDB4OGUpIHsKICAgICAgICAgICAgICBzdGFja0RlbHRhID0gVFRPcHNTdGFja0RlbHRhc1tvcF07CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3AgPj0gMHhjMCAmJiBvcCA8PSAweGRmKSB7CiAgICAgICAgICAgICAgc3RhY2tEZWx0YSA9IC0xOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wID49IDB4ZTApIHsKICAgICAgICAgICAgICBzdGFja0RlbHRhID0gLTI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChvcCA+PSAweDcxICYmIG9wIDw9IDB4NzUpIHsKICAgICAgICAgICAgICBuID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgICAgIGlmICghaXNOYU4obikpIHsKICAgICAgICAgICAgICAgIHN0YWNrRGVsdGEgPSAtbiAqIDI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB3aGlsZSAoc3RhY2tEZWx0YSA8IDAgJiYgc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIHN0YWNrRGVsdGErKzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2hpbGUgKHN0YWNrRGVsdGEgPiAwKSB7CiAgICAgICAgICAgICAgc3RhY2sucHVzaChOYU4pOwogICAgICAgICAgICAgIHN0YWNrRGVsdGEtLTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdHRDb250ZXh0LnRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9ucyA9IHRvb0NvbXBsZXhUb0ZvbGxvd0Z1bmN0aW9uczsKICAgICAgICB2YXIgY29udGVudCA9IFtkYXRhXTsKCiAgICAgICAgaWYgKGkgPiBkYXRhLmxlbmd0aCkgewogICAgICAgICAgY29udGVudC5wdXNoKG5ldyBVaW50OEFycmF5KGkgLSBkYXRhLmxlbmd0aCkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGxhc3REZWZmID4gbGFzdEVuZGYpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IGNvbXBsZW1lbnRpbmcgYSBtaXNzaW5nIGZ1bmN0aW9uIHRhaWwiKTsKICAgICAgICAgIGNvbnRlbnQucHVzaChuZXcgVWludDhBcnJheShbMHgyMiwgMHgyZF0pKTsKICAgICAgICB9CgogICAgICAgIGZvbGRUVFRhYmxlKHRhYmxlLCBjb250ZW50KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gY2hlY2tJbnZhbGlkRnVuY3Rpb25zKHR0Q29udGV4dCwgbWF4RnVuY3Rpb25EZWZzKSB7CiAgICAgICAgaWYgKHR0Q29udGV4dC50b29Db21wbGV4VG9Gb2xsb3dGdW5jdGlvbnMpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0dENvbnRleHQuZnVuY3Rpb25zRGVmaW5lZC5sZW5ndGggPiBtYXhGdW5jdGlvbkRlZnMpIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IG1vcmUgZnVuY3Rpb25zIGRlZmluZWQgdGhhbiBleHBlY3RlZCIpOwogICAgICAgICAgdHRDb250ZXh0LmhpbnRzVmFsaWQgPSBmYWxzZTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IHR0Q29udGV4dC5mdW5jdGlvbnNVc2VkLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICAgIGlmIChqID4gbWF4RnVuY3Rpb25EZWZzKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiVFQ6IGludmFsaWQgZnVuY3Rpb24gaWQ6ICIgKyBqKTsKICAgICAgICAgICAgdHRDb250ZXh0LmhpbnRzVmFsaWQgPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0dENvbnRleHQuZnVuY3Rpb25zVXNlZFtqXSAmJiAhdHRDb250ZXh0LmZ1bmN0aW9uc0RlZmluZWRbal0pIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJUVDogdW5kZWZpbmVkIGZ1bmN0aW9uOiAiICsgaik7CiAgICAgICAgICAgIHR0Q29udGV4dC5oaW50c1ZhbGlkID0gZmFsc2U7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGZvbGRUVFRhYmxlKHRhYmxlLCBjb250ZW50KSB7CiAgICAgICAgaWYgKGNvbnRlbnQubGVuZ3RoID4gMSkgewogICAgICAgICAgdmFyIG5ld0xlbmd0aCA9IDA7CiAgICAgICAgICB2YXIgaiwgamo7CgogICAgICAgICAgZm9yIChqID0gMCwgamogPSBjb250ZW50Lmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICAgICAgbmV3TGVuZ3RoICs9IGNvbnRlbnRbal0ubGVuZ3RoOwogICAgICAgICAgfQoKICAgICAgICAgIG5ld0xlbmd0aCA9IG5ld0xlbmd0aCArIDMgJiB+MzsKICAgICAgICAgIHZhciByZXN1bHQgPSBuZXcgVWludDhBcnJheShuZXdMZW5ndGgpOwogICAgICAgICAgdmFyIHBvcyA9IDA7CgogICAgICAgICAgZm9yIChqID0gMCwgamogPSBjb250ZW50Lmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICAgICAgcmVzdWx0LnNldChjb250ZW50W2pdLCBwb3MpOwogICAgICAgICAgICBwb3MgKz0gY29udGVudFtqXS5sZW5ndGg7CiAgICAgICAgICB9CgogICAgICAgICAgdGFibGUuZGF0YSA9IHJlc3VsdDsKICAgICAgICAgIHRhYmxlLmxlbmd0aCA9IG5ld0xlbmd0aDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNhbml0aXplVFRQcm9ncmFtcyhmcGdtLCBwcmVwLCBjdnQsIG1heEZ1bmN0aW9uRGVmcykgewogICAgICAgIHZhciB0dENvbnRleHQgPSB7CiAgICAgICAgICBmdW5jdGlvbnNEZWZpbmVkOiBbXSwKICAgICAgICAgIGZ1bmN0aW9uc1VzZWQ6IFtdLAogICAgICAgICAgZnVuY3Rpb25zU3RhY2tEZWx0YXM6IFtdLAogICAgICAgICAgdG9vQ29tcGxleFRvRm9sbG93RnVuY3Rpb25zOiBmYWxzZSwKICAgICAgICAgIGhpbnRzVmFsaWQ6IHRydWUKICAgICAgICB9OwoKICAgICAgICBpZiAoZnBnbSkgewogICAgICAgICAgc2FuaXRpemVUVFByb2dyYW0oZnBnbSwgdHRDb250ZXh0KTsKICAgICAgICB9CgogICAgICAgIGlmIChwcmVwKSB7CiAgICAgICAgICBzYW5pdGl6ZVRUUHJvZ3JhbShwcmVwLCB0dENvbnRleHQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGZwZ20pIHsKICAgICAgICAgIGNoZWNrSW52YWxpZEZ1bmN0aW9ucyh0dENvbnRleHQsIG1heEZ1bmN0aW9uRGVmcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3Z0ICYmIGN2dC5sZW5ndGggJiAxKSB7CiAgICAgICAgICB2YXIgY3Z0RGF0YSA9IG5ldyBVaW50OEFycmF5KGN2dC5sZW5ndGggKyAxKTsKICAgICAgICAgIGN2dERhdGEuc2V0KGN2dC5kYXRhKTsKICAgICAgICAgIGN2dC5kYXRhID0gY3Z0RGF0YTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0dENvbnRleHQuaGludHNWYWxpZDsKICAgICAgfQoKICAgICAgZm9udCA9IG5ldyBfc3RyZWFtLlN0cmVhbShuZXcgVWludDhBcnJheShmb250LmdldEJ5dGVzKCkpKTsKICAgICAgdmFyIGhlYWRlciwgdGFibGVzOwoKICAgICAgaWYgKGlzVHJ1ZVR5cGVDb2xsZWN0aW9uRmlsZShmb250KSkgewogICAgICAgIHZhciB0dGNEYXRhID0gcmVhZFRydWVUeXBlQ29sbGVjdGlvbkRhdGEoZm9udCwgdGhpcy5uYW1lKTsKICAgICAgICBoZWFkZXIgPSB0dGNEYXRhLmhlYWRlcjsKICAgICAgICB0YWJsZXMgPSB0dGNEYXRhLnRhYmxlczsKICAgICAgfSBlbHNlIHsKICAgICAgICBoZWFkZXIgPSByZWFkT3BlblR5cGVIZWFkZXIoZm9udCk7CiAgICAgICAgdGFibGVzID0gcmVhZFRhYmxlcyhmb250LCBoZWFkZXIubnVtVGFibGVzKTsKICAgICAgfQoKICAgICAgdmFyIGNmZiwgY2ZmRmlsZTsKICAgICAgdmFyIGlzVHJ1ZVR5cGUgPSAhdGFibGVzWyJDRkYgIl07CgogICAgICBpZiAoIWlzVHJ1ZVR5cGUpIHsKICAgICAgICB2YXIgaXNDb21wb3NpdGUgPSBwcm9wZXJ0aWVzLmNvbXBvc2l0ZSAmJiAoKHByb3BlcnRpZXMuY2lkVG9HaWRNYXAgfHwgW10pLmxlbmd0aCA+IDAgfHwgIShwcm9wZXJ0aWVzLmNNYXAgaW5zdGFuY2VvZiBfY21hcC5JZGVudGl0eUNNYXApKTsKCiAgICAgICAgaWYgKGhlYWRlci52ZXJzaW9uID09PSAiT1RUTyIgJiYgIWlzQ29tcG9zaXRlIHx8ICF0YWJsZXMuaGVhZCB8fCAhdGFibGVzLmhoZWEgfHwgIXRhYmxlcy5tYXhwIHx8ICF0YWJsZXMucG9zdCkgewogICAgICAgICAgY2ZmRmlsZSA9IG5ldyBfc3RyZWFtLlN0cmVhbSh0YWJsZXNbIkNGRiAiXS5kYXRhKTsKICAgICAgICAgIGNmZiA9IG5ldyBDRkZGb250KGNmZkZpbGUsIHByb3BlcnRpZXMpOwogICAgICAgICAgYWRqdXN0V2lkdGhzKHByb3BlcnRpZXMpOwogICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydChuYW1lLCBjZmYsIHByb3BlcnRpZXMpOwogICAgICAgIH0KCiAgICAgICAgZGVsZXRlIHRhYmxlcy5nbHlmOwogICAgICAgIGRlbGV0ZSB0YWJsZXMubG9jYTsKICAgICAgICBkZWxldGUgdGFibGVzLmZwZ207CiAgICAgICAgZGVsZXRlIHRhYmxlcy5wcmVwOwogICAgICAgIGRlbGV0ZSB0YWJsZXNbImN2dCAiXTsKICAgICAgICB0aGlzLmlzT3BlblR5cGUgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICghdGFibGVzLmxvY2EpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcignUmVxdWlyZWQgImxvY2EiIHRhYmxlIGlzIG5vdCBmb3VuZCcpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF0YWJsZXMuZ2x5ZikgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCdSZXF1aXJlZCAiZ2x5ZiIgdGFibGUgaXMgbm90IGZvdW5kIC0tIHRyeWluZyB0byByZWNvdmVyLicpOwogICAgICAgICAgdGFibGVzLmdseWYgPSB7CiAgICAgICAgICAgIHRhZzogImdseWYiLAogICAgICAgICAgICBkYXRhOiBuZXcgVWludDhBcnJheSgwKQogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHRoaXMuaXNPcGVuVHlwZSA9IGZhbHNlOwogICAgICB9CgogICAgICBpZiAoIXRhYmxlcy5tYXhwKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCdSZXF1aXJlZCAibWF4cCIgdGFibGUgaXMgbm90IGZvdW5kJyk7CiAgICAgIH0KCiAgICAgIGZvbnQucG9zID0gKGZvbnQuc3RhcnQgfHwgMCkgKyB0YWJsZXMubWF4cC5vZmZzZXQ7CiAgICAgIHZhciB2ZXJzaW9uID0gZm9udC5nZXRJbnQzMigpOwogICAgICB2YXIgbnVtR2x5cGhzID0gZm9udC5nZXRVaW50MTYoKTsKICAgICAgdmFyIG51bUdseXBoc091dCA9IG51bUdseXBocyArIDE7CiAgICAgIHZhciBkdXBGaXJzdEVudHJ5ID0gdHJ1ZTsKCiAgICAgIGlmIChudW1HbHlwaHNPdXQgPiAweGZmZmYpIHsKICAgICAgICBkdXBGaXJzdEVudHJ5ID0gZmFsc2U7CiAgICAgICAgbnVtR2x5cGhzT3V0ID0gbnVtR2x5cGhzOwogICAgICAgICgwLCBfdXRpbC53YXJuKSgiTm90IGVub3VnaCBzcGFjZSBpbiBnbHlmcyB0byBkdXBsaWNhdGUgZmlyc3QgZ2x5cGguIik7CiAgICAgIH0KCiAgICAgIHZhciBtYXhGdW5jdGlvbkRlZnMgPSAwOwogICAgICB2YXIgbWF4U2l6ZU9mSW5zdHJ1Y3Rpb25zID0gMDsKCiAgICAgIGlmICh2ZXJzaW9uID49IDB4MDAwMTAwMDAgJiYgdGFibGVzLm1heHAubGVuZ3RoID49IDIyKSB7CiAgICAgICAgZm9udC5wb3MgKz0gODsKICAgICAgICB2YXIgbWF4Wm9uZXMgPSBmb250LmdldFVpbnQxNigpOwoKICAgICAgICBpZiAobWF4Wm9uZXMgPiAyKSB7CiAgICAgICAgICB0YWJsZXMubWF4cC5kYXRhWzE0XSA9IDA7CiAgICAgICAgICB0YWJsZXMubWF4cC5kYXRhWzE1XSA9IDI7CiAgICAgICAgfQoKICAgICAgICBmb250LnBvcyArPSA0OwogICAgICAgIG1heEZ1bmN0aW9uRGVmcyA9IGZvbnQuZ2V0VWludDE2KCk7CiAgICAgICAgZm9udC5wb3MgKz0gNDsKICAgICAgICBtYXhTaXplT2ZJbnN0cnVjdGlvbnMgPSBmb250LmdldFVpbnQxNigpOwogICAgICB9CgogICAgICB0YWJsZXMubWF4cC5kYXRhWzRdID0gbnVtR2x5cGhzT3V0ID4+IDg7CiAgICAgIHRhYmxlcy5tYXhwLmRhdGFbNV0gPSBudW1HbHlwaHNPdXQgJiAyNTU7CiAgICAgIHZhciBoaW50c1ZhbGlkID0gc2FuaXRpemVUVFByb2dyYW1zKHRhYmxlcy5mcGdtLCB0YWJsZXMucHJlcCwgdGFibGVzWyJjdnQgIl0sIG1heEZ1bmN0aW9uRGVmcyk7CgogICAgICBpZiAoIWhpbnRzVmFsaWQpIHsKICAgICAgICBkZWxldGUgdGFibGVzLmZwZ207CiAgICAgICAgZGVsZXRlIHRhYmxlcy5wcmVwOwogICAgICAgIGRlbGV0ZSB0YWJsZXNbImN2dCAiXTsKICAgICAgfQoKICAgICAgc2FuaXRpemVNZXRyaWNzKGZvbnQsIHRhYmxlcy5oaGVhLCB0YWJsZXMuaG10eCwgbnVtR2x5cGhzT3V0LCBkdXBGaXJzdEVudHJ5KTsKCiAgICAgIGlmICghdGFibGVzLmhlYWQpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoJ1JlcXVpcmVkICJoZWFkIiB0YWJsZSBpcyBub3QgZm91bmQnKTsKICAgICAgfQoKICAgICAgc2FuaXRpemVIZWFkKHRhYmxlcy5oZWFkLCBudW1HbHlwaHMsIGlzVHJ1ZVR5cGUgPyB0YWJsZXMubG9jYS5sZW5ndGggOiAwKTsKICAgICAgdmFyIG1pc3NpbmdHbHlwaHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgICAgaWYgKGlzVHJ1ZVR5cGUpIHsKICAgICAgICB2YXIgaXNHbHlwaExvY2F0aW9uc0xvbmcgPSBpbnQxNih0YWJsZXMuaGVhZC5kYXRhWzUwXSwgdGFibGVzLmhlYWQuZGF0YVs1MV0pOwogICAgICAgIHZhciBnbHlwaHNJbmZvID0gc2FuaXRpemVHbHlwaExvY2F0aW9ucyh0YWJsZXMubG9jYSwgdGFibGVzLmdseWYsIG51bUdseXBocywgaXNHbHlwaExvY2F0aW9uc0xvbmcsIGhpbnRzVmFsaWQsIGR1cEZpcnN0RW50cnksIG1heFNpemVPZkluc3RydWN0aW9ucyk7CiAgICAgICAgbWlzc2luZ0dseXBocyA9IGdseXBoc0luZm8ubWlzc2luZ0dseXBoczsKCiAgICAgICAgaWYgKHZlcnNpb24gPj0gMHgwMDAxMDAwMCAmJiB0YWJsZXMubWF4cC5sZW5ndGggPj0gMjIpIHsKICAgICAgICAgIHRhYmxlcy5tYXhwLmRhdGFbMjZdID0gZ2x5cGhzSW5mby5tYXhTaXplT2ZJbnN0cnVjdGlvbnMgPj4gODsKICAgICAgICAgIHRhYmxlcy5tYXhwLmRhdGFbMjddID0gZ2x5cGhzSW5mby5tYXhTaXplT2ZJbnN0cnVjdGlvbnMgJiAyNTU7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRhYmxlcy5oaGVhKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCdSZXF1aXJlZCAiaGhlYSIgdGFibGUgaXMgbm90IGZvdW5kJyk7CiAgICAgIH0KCiAgICAgIGlmICh0YWJsZXMuaGhlYS5kYXRhWzEwXSA9PT0gMCAmJiB0YWJsZXMuaGhlYS5kYXRhWzExXSA9PT0gMCkgewogICAgICAgIHRhYmxlcy5oaGVhLmRhdGFbMTBdID0gMHhmZjsKICAgICAgICB0YWJsZXMuaGhlYS5kYXRhWzExXSA9IDB4ZmY7CiAgICAgIH0KCiAgICAgIHZhciBtZXRyaWNzT3ZlcnJpZGUgPSB7CiAgICAgICAgdW5pdHNQZXJFbTogaW50MTYodGFibGVzLmhlYWQuZGF0YVsxOF0sIHRhYmxlcy5oZWFkLmRhdGFbMTldKSwKICAgICAgICB5TWF4OiBpbnQxNih0YWJsZXMuaGVhZC5kYXRhWzQyXSwgdGFibGVzLmhlYWQuZGF0YVs0M10pLAogICAgICAgIHlNaW46IHNpZ25lZEludDE2KHRhYmxlcy5oZWFkLmRhdGFbMzhdLCB0YWJsZXMuaGVhZC5kYXRhWzM5XSksCiAgICAgICAgYXNjZW50OiBpbnQxNih0YWJsZXMuaGhlYS5kYXRhWzRdLCB0YWJsZXMuaGhlYS5kYXRhWzVdKSwKICAgICAgICBkZXNjZW50OiBzaWduZWRJbnQxNih0YWJsZXMuaGhlYS5kYXRhWzZdLCB0YWJsZXMuaGhlYS5kYXRhWzddKQogICAgICB9OwogICAgICB0aGlzLmFzY2VudCA9IG1ldHJpY3NPdmVycmlkZS5hc2NlbnQgLyBtZXRyaWNzT3ZlcnJpZGUudW5pdHNQZXJFbTsKICAgICAgdGhpcy5kZXNjZW50ID0gbWV0cmljc092ZXJyaWRlLmRlc2NlbnQgLyBtZXRyaWNzT3ZlcnJpZGUudW5pdHNQZXJFbTsKCiAgICAgIGlmICh0YWJsZXMucG9zdCkgewogICAgICAgIHJlYWRQb3N0U2NyaXB0VGFibGUodGFibGVzLnBvc3QsIHByb3BlcnRpZXMsIG51bUdseXBocyk7CiAgICAgIH0KCiAgICAgIHRhYmxlcy5wb3N0ID0gewogICAgICAgIHRhZzogInBvc3QiLAogICAgICAgIGRhdGE6IGNyZWF0ZVBvc3RUYWJsZShwcm9wZXJ0aWVzKQogICAgICB9OwogICAgICB2YXIgY2hhckNvZGVUb0dseXBoSWQgPSBbXTsKCiAgICAgIGZ1bmN0aW9uIGhhc0dseXBoKGdseXBoSWQpIHsKICAgICAgICByZXR1cm4gIW1pc3NpbmdHbHlwaHNbZ2x5cGhJZF07CiAgICAgIH0KCiAgICAgIGlmIChwcm9wZXJ0aWVzLmNvbXBvc2l0ZSkgewogICAgICAgIHZhciBjaWRUb0dpZE1hcCA9IHByb3BlcnRpZXMuY2lkVG9HaWRNYXAgfHwgW107CiAgICAgICAgdmFyIGlzQ2lkVG9HaWRNYXBFbXB0eSA9IGNpZFRvR2lkTWFwLmxlbmd0aCA9PT0gMDsKICAgICAgICBwcm9wZXJ0aWVzLmNNYXAuZm9yRWFjaChmdW5jdGlvbiAoY2hhckNvZGUsIGNpZCkgewogICAgICAgICAgaWYgKGNpZCA+IDB4ZmZmZikgewogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk1heCBzaXplIG9mIENJRCBpcyA2NSw1MzUiKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZ2x5cGhJZCA9IC0xOwoKICAgICAgICAgIGlmIChpc0NpZFRvR2lkTWFwRW1wdHkpIHsKICAgICAgICAgICAgZ2x5cGhJZCA9IGNpZDsKICAgICAgICAgIH0gZWxzZSBpZiAoY2lkVG9HaWRNYXBbY2lkXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGdseXBoSWQgPSBjaWRUb0dpZE1hcFtjaWRdOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChnbHlwaElkID49IDAgJiYgZ2x5cGhJZCA8IG51bUdseXBocyAmJiBoYXNHbHlwaChnbHlwaElkKSkgewogICAgICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBjbWFwVGFibGUgPSByZWFkQ21hcFRhYmxlKHRhYmxlcy5jbWFwLCBmb250LCB0aGlzLmlzU3ltYm9saWNGb250LCBwcm9wZXJ0aWVzLmhhc0VuY29kaW5nKTsKICAgICAgICB2YXIgY21hcFBsYXRmb3JtSWQgPSBjbWFwVGFibGUucGxhdGZvcm1JZDsKICAgICAgICB2YXIgY21hcEVuY29kaW5nSWQgPSBjbWFwVGFibGUuZW5jb2RpbmdJZDsKICAgICAgICB2YXIgY21hcE1hcHBpbmdzID0gY21hcFRhYmxlLm1hcHBpbmdzOwogICAgICAgIHZhciBjbWFwTWFwcGluZ3NMZW5ndGggPSBjbWFwTWFwcGluZ3MubGVuZ3RoOwoKICAgICAgICBpZiAocHJvcGVydGllcy5oYXNFbmNvZGluZyAmJiAoY21hcFBsYXRmb3JtSWQgPT09IDMgJiYgY21hcEVuY29kaW5nSWQgPT09IDEgfHwgY21hcFBsYXRmb3JtSWQgPT09IDEgJiYgY21hcEVuY29kaW5nSWQgPT09IDApIHx8IGNtYXBQbGF0Zm9ybUlkID09PSAtMSAmJiBjbWFwRW5jb2RpbmdJZCA9PT0gLTEgJiYgISEoMCwgX2VuY29kaW5ncy5nZXRFbmNvZGluZykocHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lKSkgewogICAgICAgICAgdmFyIGJhc2VFbmNvZGluZyA9IFtdOwoKICAgICAgICAgIGlmIChwcm9wZXJ0aWVzLmJhc2VFbmNvZGluZ05hbWUgPT09ICJNYWNSb21hbkVuY29kaW5nIiB8fCBwcm9wZXJ0aWVzLmJhc2VFbmNvZGluZ05hbWUgPT09ICJXaW5BbnNpRW5jb2RpbmciKSB7CiAgICAgICAgICAgIGJhc2VFbmNvZGluZyA9ICgwLCBfZW5jb2RpbmdzLmdldEVuY29kaW5nKShwcm9wZXJ0aWVzLmJhc2VFbmNvZGluZ05hbWUpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBnbHlwaHNVbmljb2RlTWFwID0gKDAsIF9nbHlwaGxpc3QuZ2V0R2x5cGhzVW5pY29kZSkoKTsKCiAgICAgICAgICBmb3IgKHZhciBjaGFyQ29kZSA9IDA7IGNoYXJDb2RlIDwgMjU2OyBjaGFyQ29kZSsrKSB7CiAgICAgICAgICAgIHZhciBnbHlwaE5hbWUsIHN0YW5kYXJkR2x5cGhOYW1lOwoKICAgICAgICAgICAgaWYgKHRoaXMuZGlmZmVyZW5jZXMgJiYgY2hhckNvZGUgaW4gdGhpcy5kaWZmZXJlbmNlcykgewogICAgICAgICAgICAgIGdseXBoTmFtZSA9IHRoaXMuZGlmZmVyZW5jZXNbY2hhckNvZGVdOwogICAgICAgICAgICB9IGVsc2UgaWYgKGNoYXJDb2RlIGluIGJhc2VFbmNvZGluZyAmJiBiYXNlRW5jb2RpbmdbY2hhckNvZGVdICE9PSAiIikgewogICAgICAgICAgICAgIGdseXBoTmFtZSA9IGJhc2VFbmNvZGluZ1tjaGFyQ29kZV07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZ2x5cGhOYW1lID0gX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nW2NoYXJDb2RlXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCFnbHlwaE5hbWUpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3RhbmRhcmRHbHlwaE5hbWUgPSByZWNvdmVyR2x5cGhOYW1lKGdseXBoTmFtZSwgZ2x5cGhzVW5pY29kZU1hcCk7CiAgICAgICAgICAgIHZhciB1bmljb2RlT3JDaGFyQ29kZTsKCiAgICAgICAgICAgIGlmIChjbWFwUGxhdGZvcm1JZCA9PT0gMyAmJiBjbWFwRW5jb2RpbmdJZCA9PT0gMSkgewogICAgICAgICAgICAgIHVuaWNvZGVPckNoYXJDb2RlID0gZ2x5cGhzVW5pY29kZU1hcFtzdGFuZGFyZEdseXBoTmFtZV07CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY21hcFBsYXRmb3JtSWQgPT09IDEgJiYgY21hcEVuY29kaW5nSWQgPT09IDApIHsKICAgICAgICAgICAgICB1bmljb2RlT3JDaGFyQ29kZSA9IF9lbmNvZGluZ3MuTWFjUm9tYW5FbmNvZGluZy5pbmRleE9mKHN0YW5kYXJkR2x5cGhOYW1lKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7CgogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNtYXBNYXBwaW5nc0xlbmd0aDsgKytpKSB7CiAgICAgICAgICAgICAgaWYgKGNtYXBNYXBwaW5nc1tpXS5jaGFyQ29kZSAhPT0gdW5pY29kZU9yQ2hhckNvZGUpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gY21hcE1hcHBpbmdzW2ldLmdseXBoSWQ7CiAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIWZvdW5kICYmIHByb3BlcnRpZXMuZ2x5cGhOYW1lcykgewogICAgICAgICAgICAgIHZhciBnbHlwaElkID0gcHJvcGVydGllcy5nbHlwaE5hbWVzLmluZGV4T2YoZ2x5cGhOYW1lKTsKCiAgICAgICAgICAgICAgaWYgKGdseXBoSWQgPT09IC0xICYmIHN0YW5kYXJkR2x5cGhOYW1lICE9PSBnbHlwaE5hbWUpIHsKICAgICAgICAgICAgICAgIGdseXBoSWQgPSBwcm9wZXJ0aWVzLmdseXBoTmFtZXMuaW5kZXhPZihzdGFuZGFyZEdseXBoTmFtZSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoZ2x5cGhJZCA+IDAgJiYgaGFzR2x5cGgoZ2x5cGhJZCkpIHsKICAgICAgICAgICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChjbWFwUGxhdGZvcm1JZCA9PT0gMCAmJiBjbWFwRW5jb2RpbmdJZCA9PT0gMCkgewogICAgICAgICAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgY21hcE1hcHBpbmdzTGVuZ3RoOyArK19pMikgewogICAgICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjbWFwTWFwcGluZ3NbX2kyXS5jaGFyQ29kZV0gPSBjbWFwTWFwcGluZ3NbX2kyXS5nbHlwaElkOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmb3IgKHZhciBfaTMgPSAwOyBfaTMgPCBjbWFwTWFwcGluZ3NMZW5ndGg7ICsrX2kzKSB7CiAgICAgICAgICAgIHZhciBfY2hhckNvZGU0ID0gY21hcE1hcHBpbmdzW19pM10uY2hhckNvZGU7CgogICAgICAgICAgICBpZiAoY21hcFBsYXRmb3JtSWQgPT09IDMgJiYgX2NoYXJDb2RlNCA+PSAweGYwMDAgJiYgX2NoYXJDb2RlNCA8PSAweGYwZmYpIHsKICAgICAgICAgICAgICBfY2hhckNvZGU0ICY9IDB4ZmY7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW19jaGFyQ29kZTRdID0gY21hcE1hcHBpbmdzW19pM10uZ2x5cGhJZDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChjaGFyQ29kZVRvR2x5cGhJZC5sZW5ndGggPT09IDApIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFswXSA9IDA7CiAgICAgIH0KCiAgICAgIHZhciBnbHlwaFplcm9JZCA9IG51bUdseXBoc091dCAtIDE7CgogICAgICBpZiAoIWR1cEZpcnN0RW50cnkpIHsKICAgICAgICBnbHlwaFplcm9JZCA9IDA7CiAgICAgIH0KCiAgICAgIHZhciBuZXdNYXBwaW5nID0gYWRqdXN0TWFwcGluZyhjaGFyQ29kZVRvR2x5cGhJZCwgaGFzR2x5cGgsIGdseXBoWmVyb0lkKTsKICAgICAgdGhpcy50b0ZvbnRDaGFyID0gbmV3TWFwcGluZy50b0ZvbnRDaGFyOwogICAgICB0YWJsZXMuY21hcCA9IHsKICAgICAgICB0YWc6ICJjbWFwIiwKICAgICAgICBkYXRhOiBjcmVhdGVDbWFwVGFibGUobmV3TWFwcGluZy5jaGFyQ29kZVRvR2x5cGhJZCwgbnVtR2x5cGhzT3V0KQogICAgICB9OwoKICAgICAgaWYgKCF0YWJsZXNbIk9TLzIiXSB8fCAhdmFsaWRhdGVPUzJUYWJsZSh0YWJsZXNbIk9TLzIiXSwgZm9udCkpIHsKICAgICAgICB0YWJsZXNbIk9TLzIiXSA9IHsKICAgICAgICAgIHRhZzogIk9TLzIiLAogICAgICAgICAgZGF0YTogY3JlYXRlT1MyVGFibGUocHJvcGVydGllcywgbmV3TWFwcGluZy5jaGFyQ29kZVRvR2x5cGhJZCwgbWV0cmljc092ZXJyaWRlKQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGlmICghaXNUcnVlVHlwZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjZmZGaWxlID0gbmV3IF9zdHJlYW0uU3RyZWFtKHRhYmxlc1siQ0ZGICJdLmRhdGEpOwogICAgICAgICAgdmFyIHBhcnNlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZQYXJzZXIoY2ZmRmlsZSwgcHJvcGVydGllcywgU0VBQ19BTkFMWVNJU19FTkFCTEVEKTsKICAgICAgICAgIGNmZiA9IHBhcnNlci5wYXJzZSgpOwogICAgICAgICAgY2ZmLmR1cGxpY2F0ZUZpcnN0R2x5cGgoKTsKICAgICAgICAgIHZhciBjb21waWxlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZDb21waWxlcihjZmYpOwogICAgICAgICAgdGFibGVzWyJDRkYgIl0uZGF0YSA9IGNvbXBpbGVyLmNvbXBpbGUoKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkZhaWxlZCB0byBjb21waWxlIGZvbnQgIiArIHByb3BlcnRpZXMubG9hZGVkTmFtZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIXRhYmxlcy5uYW1lKSB7CiAgICAgICAgdGFibGVzLm5hbWUgPSB7CiAgICAgICAgICB0YWc6ICJuYW1lIiwKICAgICAgICAgIGRhdGE6IGNyZWF0ZU5hbWVUYWJsZSh0aGlzLm5hbWUpCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgbmFtZVByb3RvdHlwZSA9IHJlYWROYW1lVGFibGUodGFibGVzLm5hbWUpOwogICAgICAgIHRhYmxlcy5uYW1lLmRhdGEgPSBjcmVhdGVOYW1lVGFibGUobmFtZSwgbmFtZVByb3RvdHlwZSk7CiAgICAgIH0KCiAgICAgIHZhciBidWlsZGVyID0gbmV3IE9wZW5UeXBlRmlsZUJ1aWxkZXIoaGVhZGVyLnZlcnNpb24pOwoKICAgICAgZm9yICh2YXIgdGFibGVUYWcgaW4gdGFibGVzKSB7CiAgICAgICAgYnVpbGRlci5hZGRUYWJsZSh0YWJsZVRhZywgdGFibGVzW3RhYmxlVGFnXS5kYXRhKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGJ1aWxkZXIudG9BcnJheSgpOwogICAgfSwKICAgIGNvbnZlcnQ6IGZ1bmN0aW9uIEZvbnRfY29udmVydChmb250TmFtZSwgZm9udCwgcHJvcGVydGllcykgewogICAgICBwcm9wZXJ0aWVzLmZpeGVkUGl0Y2ggPSBmYWxzZTsKCiAgICAgIGlmIChwcm9wZXJ0aWVzLmJ1aWx0SW5FbmNvZGluZykgewogICAgICAgIGFkanVzdFRvVW5pY29kZShwcm9wZXJ0aWVzLCBwcm9wZXJ0aWVzLmJ1aWx0SW5FbmNvZGluZyk7CiAgICAgIH0KCiAgICAgIHZhciBnbHlwaFplcm9JZCA9IDE7CgogICAgICBpZiAoZm9udCBpbnN0YW5jZW9mIENGRkZvbnQpIHsKICAgICAgICBnbHlwaFplcm9JZCA9IGZvbnQubnVtR2x5cGhzIC0gMTsKICAgICAgfQoKICAgICAgdmFyIG1hcHBpbmcgPSBmb250LmdldEdseXBoTWFwcGluZyhwcm9wZXJ0aWVzKTsKICAgICAgdmFyIG5ld01hcHBpbmcgPSBhZGp1c3RNYXBwaW5nKG1hcHBpbmcsIGZvbnQuaGFzR2x5cGhJZC5iaW5kKGZvbnQpLCBnbHlwaFplcm9JZCk7CiAgICAgIHRoaXMudG9Gb250Q2hhciA9IG5ld01hcHBpbmcudG9Gb250Q2hhcjsKICAgICAgdmFyIG51bUdseXBocyA9IGZvbnQubnVtR2x5cGhzOwoKICAgICAgZnVuY3Rpb24gZ2V0Q2hhckNvZGVzKGNoYXJDb2RlVG9HbHlwaElkLCBnbHlwaElkKSB7CiAgICAgICAgdmFyIGNoYXJDb2RlcyA9IG51bGw7CgogICAgICAgIGZvciAodmFyIGNoYXJDb2RlIGluIGNoYXJDb2RlVG9HbHlwaElkKSB7CiAgICAgICAgICBpZiAoZ2x5cGhJZCA9PT0gY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdKSB7CiAgICAgICAgICAgIGlmICghY2hhckNvZGVzKSB7CiAgICAgICAgICAgICAgY2hhckNvZGVzID0gW107CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNoYXJDb2Rlcy5wdXNoKGNoYXJDb2RlIHwgMCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY2hhckNvZGVzOwogICAgICB9CgogICAgICBmdW5jdGlvbiBjcmVhdGVDaGFyQ29kZShjaGFyQ29kZVRvR2x5cGhJZCwgZ2x5cGhJZCkgewogICAgICAgIGZvciAodmFyIGNoYXJDb2RlIGluIGNoYXJDb2RlVG9HbHlwaElkKSB7CiAgICAgICAgICBpZiAoZ2x5cGhJZCA9PT0gY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdKSB7CiAgICAgICAgICAgIHJldHVybiBjaGFyQ29kZSB8IDA7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBuZXdNYXBwaW5nLmNoYXJDb2RlVG9HbHlwaElkW25ld01hcHBpbmcubmV4dEF2YWlsYWJsZUZvbnRDaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICAgIHJldHVybiBuZXdNYXBwaW5nLm5leHRBdmFpbGFibGVGb250Q2hhckNvZGUrKzsKICAgICAgfQoKICAgICAgdmFyIHNlYWNzID0gZm9udC5zZWFjczsKCiAgICAgIGlmIChTRUFDX0FOQUxZU0lTX0VOQUJMRUQgJiYgc2VhY3MgJiYgc2VhY3MubGVuZ3RoKSB7CiAgICAgICAgdmFyIG1hdHJpeCA9IHByb3BlcnRpZXMuZm9udE1hdHJpeCB8fCBfdXRpbC5GT05UX0lERU5USVRZX01BVFJJWDsKICAgICAgICB2YXIgY2hhcnNldCA9IGZvbnQuZ2V0Q2hhcnNldCgpOwogICAgICAgIHZhciBzZWFjTWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICAgICAgZm9yICh2YXIgZ2x5cGhJZCBpbiBzZWFjcykgewogICAgICAgICAgZ2x5cGhJZCB8PSAwOwogICAgICAgICAgdmFyIHNlYWMgPSBzZWFjc1tnbHlwaElkXTsKICAgICAgICAgIHZhciBiYXNlR2x5cGhOYW1lID0gX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nW3NlYWNbMl1dOwogICAgICAgICAgdmFyIGFjY2VudEdseXBoTmFtZSA9IF9lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZ1tzZWFjWzNdXTsKICAgICAgICAgIHZhciBiYXNlR2x5cGhJZCA9IGNoYXJzZXQuaW5kZXhPZihiYXNlR2x5cGhOYW1lKTsKICAgICAgICAgIHZhciBhY2NlbnRHbHlwaElkID0gY2hhcnNldC5pbmRleE9mKGFjY2VudEdseXBoTmFtZSk7CgogICAgICAgICAgaWYgKGJhc2VHbHlwaElkIDwgMCB8fCBhY2NlbnRHbHlwaElkIDwgMCkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgYWNjZW50T2Zmc2V0ID0gewogICAgICAgICAgICB4OiBzZWFjWzBdICogbWF0cml4WzBdICsgc2VhY1sxXSAqIG1hdHJpeFsyXSArIG1hdHJpeFs0XSwKICAgICAgICAgICAgeTogc2VhY1swXSAqIG1hdHJpeFsxXSArIHNlYWNbMV0gKiBtYXRyaXhbM10gKyBtYXRyaXhbNV0KICAgICAgICAgIH07CiAgICAgICAgICB2YXIgY2hhckNvZGVzID0gZ2V0Q2hhckNvZGVzKG1hcHBpbmcsIGdseXBoSWQpOwoKICAgICAgICAgIGlmICghY2hhckNvZGVzKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGNoYXJDb2Rlcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgIHZhciBjaGFyQ29kZSA9IGNoYXJDb2Rlc1tpXTsKICAgICAgICAgICAgdmFyIGNoYXJDb2RlVG9HbHlwaElkID0gbmV3TWFwcGluZy5jaGFyQ29kZVRvR2x5cGhJZDsKICAgICAgICAgICAgdmFyIGJhc2VGb250Q2hhckNvZGUgPSBjcmVhdGVDaGFyQ29kZShjaGFyQ29kZVRvR2x5cGhJZCwgYmFzZUdseXBoSWQpOwogICAgICAgICAgICB2YXIgYWNjZW50Rm9udENoYXJDb2RlID0gY3JlYXRlQ2hhckNvZGUoY2hhckNvZGVUb0dseXBoSWQsIGFjY2VudEdseXBoSWQpOwogICAgICAgICAgICBzZWFjTWFwW2NoYXJDb2RlXSA9IHsKICAgICAgICAgICAgICBiYXNlRm9udENoYXJDb2RlOiBiYXNlRm9udENoYXJDb2RlLAogICAgICAgICAgICAgIGFjY2VudEZvbnRDaGFyQ29kZTogYWNjZW50Rm9udENoYXJDb2RlLAogICAgICAgICAgICAgIGFjY2VudE9mZnNldDogYWNjZW50T2Zmc2V0CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcm9wZXJ0aWVzLnNlYWNNYXAgPSBzZWFjTWFwOwogICAgICB9CgogICAgICB2YXIgdW5pdHNQZXJFbSA9IDEgLyAocHJvcGVydGllcy5mb250TWF0cml4IHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYKVswXTsKICAgICAgdmFyIGJ1aWxkZXIgPSBuZXcgT3BlblR5cGVGaWxlQnVpbGRlcigiXHg0Rlx4NTRceDU0XHg0RiIpOwogICAgICBidWlsZGVyLmFkZFRhYmxlKCJDRkYgIiwgZm9udC5kYXRhKTsKICAgICAgYnVpbGRlci5hZGRUYWJsZSgiT1MvMiIsIGNyZWF0ZU9TMlRhYmxlKHByb3BlcnRpZXMsIG5ld01hcHBpbmcuY2hhckNvZGVUb0dseXBoSWQpKTsKICAgICAgYnVpbGRlci5hZGRUYWJsZSgiY21hcCIsIGNyZWF0ZUNtYXBUYWJsZShuZXdNYXBwaW5nLmNoYXJDb2RlVG9HbHlwaElkLCBudW1HbHlwaHMpKTsKICAgICAgYnVpbGRlci5hZGRUYWJsZSgiaGVhZCIsICJceDAwXHgwMVx4MDBceDAwIiArICJceDAwXHgwMFx4MTBceDAwIiArICJceDAwXHgwMFx4MDBceDAwIiArICJceDVGXHgwRlx4M0NceEY1IiArICJceDAwXHgwMCIgKyBzYWZlU3RyaW5nMTYodW5pdHNQZXJFbSkgKyAiXHgwMFx4MDBceDAwXHgwMFx4OWVceDBiXHg3ZVx4MjciICsgIlx4MDBceDAwXHgwMFx4MDBceDllXHgwYlx4N2VceDI3IiArICJceDAwXHgwMCIgKyBzYWZlU3RyaW5nMTYocHJvcGVydGllcy5kZXNjZW50KSArICJceDBGXHhGRiIgKyBzYWZlU3RyaW5nMTYocHJvcGVydGllcy5hc2NlbnQpICsgc3RyaW5nMTYocHJvcGVydGllcy5pdGFsaWNBbmdsZSA/IDIgOiAwKSArICJceDAwXHgxMSIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIpOwogICAgICBidWlsZGVyLmFkZFRhYmxlKCJoaGVhIiwgIlx4MDBceDAxXHgwMFx4MDAiICsgc2FmZVN0cmluZzE2KHByb3BlcnRpZXMuYXNjZW50KSArIHNhZmVTdHJpbmcxNihwcm9wZXJ0aWVzLmRlc2NlbnQpICsgIlx4MDBceDAwIiArICJceEZGXHhGRiIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyBzYWZlU3RyaW5nMTYocHJvcGVydGllcy5jYXBIZWlnaHQpICsgc2FmZVN0cmluZzE2KE1hdGgudGFuKHByb3BlcnRpZXMuaXRhbGljQW5nbGUpICogcHJvcGVydGllcy54SGVpZ2h0KSArICJceDAwXHgwMCIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArICJceDAwXHgwMCIgKyAiXHgwMFx4MDAiICsgIlx4MDBceDAwIiArIHN0cmluZzE2KG51bUdseXBocykpOwogICAgICBidWlsZGVyLmFkZFRhYmxlKCJobXR4IiwgZnVuY3Rpb24gZm9udEZpZWxkc0htdHgoKSB7CiAgICAgICAgdmFyIGNoYXJzdHJpbmdzID0gZm9udC5jaGFyc3RyaW5nczsKICAgICAgICB2YXIgY2ZmV2lkdGhzID0gZm9udC5jZmYgPyBmb250LmNmZi53aWR0aHMgOiBudWxsOwogICAgICAgIHZhciBobXR4ID0gIlx4MDBceDAwXHgwMFx4MDAiOwoKICAgICAgICBmb3IgKHZhciBfaTQgPSAxLCBfaWkgPSBudW1HbHlwaHM7IF9pNCA8IF9paTsgX2k0KyspIHsKICAgICAgICAgIHZhciB3aWR0aCA9IDA7CgogICAgICAgICAgaWYgKGNoYXJzdHJpbmdzKSB7CiAgICAgICAgICAgIHZhciBjaGFyc3RyaW5nID0gY2hhcnN0cmluZ3NbX2k0IC0gMV07CiAgICAgICAgICAgIHdpZHRoID0gIndpZHRoIiBpbiBjaGFyc3RyaW5nID8gY2hhcnN0cmluZy53aWR0aCA6IDA7CiAgICAgICAgICB9IGVsc2UgaWYgKGNmZldpZHRocykgewogICAgICAgICAgICB3aWR0aCA9IE1hdGguY2VpbChjZmZXaWR0aHNbX2k0XSB8fCAwKTsKICAgICAgICAgIH0KCiAgICAgICAgICBobXR4ICs9IHN0cmluZzE2KHdpZHRoKSArIHN0cmluZzE2KDApOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGhtdHg7CiAgICAgIH0oKSk7CiAgICAgIGJ1aWxkZXIuYWRkVGFibGUoIm1heHAiLCAiXHgwMFx4MDBceDUwXHgwMCIgKyBzdHJpbmcxNihudW1HbHlwaHMpKTsKICAgICAgYnVpbGRlci5hZGRUYWJsZSgibmFtZSIsIGNyZWF0ZU5hbWVUYWJsZShmb250TmFtZSkpOwogICAgICBidWlsZGVyLmFkZFRhYmxlKCJwb3N0IiwgY3JlYXRlUG9zdFRhYmxlKHByb3BlcnRpZXMpKTsKICAgICAgcmV0dXJuIGJ1aWxkZXIudG9BcnJheSgpOwogICAgfSwKCiAgICBnZXQgc3BhY2VXaWR0aCgpIHsKICAgICAgdmFyIHBvc3NpYmxlU3BhY2VSZXBsYWNlbWVudHMgPSBbInNwYWNlIiwgIm1pbnVzIiwgIm9uZSIsICJpIiwgIkkiXTsKICAgICAgdmFyIHdpZHRoOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gcG9zc2libGVTcGFjZVJlcGxhY2VtZW50cy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgdmFyIGdseXBoTmFtZSA9IHBvc3NpYmxlU3BhY2VSZXBsYWNlbWVudHNbaV07CgogICAgICAgIGlmIChnbHlwaE5hbWUgaW4gdGhpcy53aWR0aHMpIHsKICAgICAgICAgIHdpZHRoID0gdGhpcy53aWR0aHNbZ2x5cGhOYW1lXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgdmFyIGdseXBoc1VuaWNvZGVNYXAgPSAoMCwgX2dseXBobGlzdC5nZXRHbHlwaHNVbmljb2RlKSgpOwogICAgICAgIHZhciBnbHlwaFVuaWNvZGUgPSBnbHlwaHNVbmljb2RlTWFwW2dseXBoTmFtZV07CiAgICAgICAgdmFyIGNoYXJjb2RlID0gMDsKCiAgICAgICAgaWYgKHRoaXMuY29tcG9zaXRlICYmIHRoaXMuY01hcC5jb250YWlucyhnbHlwaFVuaWNvZGUpKSB7CiAgICAgICAgICBjaGFyY29kZSA9IHRoaXMuY01hcC5sb29rdXAoZ2x5cGhVbmljb2RlKTsKICAgICAgICB9CgogICAgICAgIGlmICghY2hhcmNvZGUgJiYgdGhpcy50b1VuaWNvZGUpIHsKICAgICAgICAgIGNoYXJjb2RlID0gdGhpcy50b1VuaWNvZGUuY2hhckNvZGVPZihnbHlwaFVuaWNvZGUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNoYXJjb2RlIDw9IDApIHsKICAgICAgICAgIGNoYXJjb2RlID0gZ2x5cGhVbmljb2RlOwogICAgICAgIH0KCiAgICAgICAgd2lkdGggPSB0aGlzLndpZHRoc1tjaGFyY29kZV07CgogICAgICAgIGlmICh3aWR0aCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICB3aWR0aCA9IHdpZHRoIHx8IHRoaXMuZGVmYXVsdFdpZHRoOwogICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgInNwYWNlV2lkdGgiLCB3aWR0aCk7CiAgICB9LAoKICAgIGNoYXJUb0dseXBoOiBmdW5jdGlvbiBGb250X2NoYXJUb0dseXBoKGNoYXJjb2RlLCBpc1NwYWNlKSB7CiAgICAgIHZhciBmb250Q2hhckNvZGUsIHdpZHRoLCBvcGVyYXRvckxpc3RJZDsKICAgICAgdmFyIHdpZHRoQ29kZSA9IGNoYXJjb2RlOwoKICAgICAgaWYgKHRoaXMuY01hcCAmJiB0aGlzLmNNYXAuY29udGFpbnMoY2hhcmNvZGUpKSB7CiAgICAgICAgd2lkdGhDb2RlID0gdGhpcy5jTWFwLmxvb2t1cChjaGFyY29kZSk7CiAgICAgIH0KCiAgICAgIHdpZHRoID0gdGhpcy53aWR0aHNbd2lkdGhDb2RlXTsKICAgICAgd2lkdGggPSAoMCwgX3V0aWwuaXNOdW0pKHdpZHRoKSA/IHdpZHRoIDogdGhpcy5kZWZhdWx0V2lkdGg7CiAgICAgIHZhciB2bWV0cmljID0gdGhpcy52bWV0cmljcyAmJiB0aGlzLnZtZXRyaWNzW3dpZHRoQ29kZV07CiAgICAgIHZhciB1bmljb2RlID0gdGhpcy50b1VuaWNvZGUuZ2V0KGNoYXJjb2RlKSB8fCB0aGlzLmZhbGxiYWNrVG9Vbmljb2RlLmdldChjaGFyY29kZSkgfHwgY2hhcmNvZGU7CgogICAgICBpZiAodHlwZW9mIHVuaWNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgICAgdW5pY29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUodW5pY29kZSk7CiAgICAgIH0KCiAgICAgIHZhciBpc0luRm9udCA9IChjaGFyY29kZSBpbiB0aGlzLnRvRm9udENoYXIpOwogICAgICBmb250Q2hhckNvZGUgPSB0aGlzLnRvRm9udENoYXJbY2hhcmNvZGVdIHx8IGNoYXJjb2RlOwoKICAgICAgaWYgKHRoaXMubWlzc2luZ0ZpbGUpIHsKICAgICAgICB2YXIgZ2x5cGhOYW1lID0gdGhpcy5kaWZmZXJlbmNlc1tjaGFyY29kZV0gfHwgdGhpcy5kZWZhdWx0RW5jb2RpbmdbY2hhcmNvZGVdOwoKICAgICAgICBpZiAoKGdseXBoTmFtZSA9PT0gIi5ub3RkZWYiIHx8IGdseXBoTmFtZSA9PT0gIiIpICYmIHRoaXMudHlwZSA9PT0gIlR5cGUxIikgewogICAgICAgICAgZm9udENoYXJDb2RlID0gMHgyMDsKICAgICAgICB9CgogICAgICAgIGZvbnRDaGFyQ29kZSA9ICgwLCBfdW5pY29kZS5tYXBTcGVjaWFsVW5pY29kZVZhbHVlcykoZm9udENoYXJDb2RlKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNUeXBlM0ZvbnQpIHsKICAgICAgICBvcGVyYXRvckxpc3RJZCA9IGZvbnRDaGFyQ29kZTsKICAgICAgfQoKICAgICAgdmFyIGFjY2VudCA9IG51bGw7CgogICAgICBpZiAodGhpcy5zZWFjTWFwICYmIHRoaXMuc2VhY01hcFtjaGFyY29kZV0pIHsKICAgICAgICBpc0luRm9udCA9IHRydWU7CiAgICAgICAgdmFyIHNlYWMgPSB0aGlzLnNlYWNNYXBbY2hhcmNvZGVdOwogICAgICAgIGZvbnRDaGFyQ29kZSA9IHNlYWMuYmFzZUZvbnRDaGFyQ29kZTsKICAgICAgICBhY2NlbnQgPSB7CiAgICAgICAgICBmb250Q2hhcjogU3RyaW5nLmZyb21Db2RlUG9pbnQoc2VhYy5hY2NlbnRGb250Q2hhckNvZGUpLAogICAgICAgICAgb2Zmc2V0OiBzZWFjLmFjY2VudE9mZnNldAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHZhciBmb250Q2hhciA9ICIiOwoKICAgICAgaWYgKHR5cGVvZiBmb250Q2hhckNvZGUgPT09ICJudW1iZXIiKSB7CiAgICAgICAgaWYgKGZvbnRDaGFyQ29kZSA8PSAweDEwZmZmZikgewogICAgICAgICAgZm9udENoYXIgPSBTdHJpbmcuZnJvbUNvZGVQb2ludChmb250Q2hhckNvZGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAoMCwgX3V0aWwud2FybikoImNoYXJUb0dseXBoIC0gaW52YWxpZCBmb250Q2hhckNvZGU6ICIuY29uY2F0KGZvbnRDaGFyQ29kZSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGdseXBoID0gdGhpcy5nbHlwaENhY2hlW2NoYXJjb2RlXTsKCiAgICAgIGlmICghZ2x5cGggfHwgIWdseXBoLm1hdGNoZXNGb3JDYWNoZShmb250Q2hhciwgdW5pY29kZSwgYWNjZW50LCB3aWR0aCwgdm1ldHJpYywgb3BlcmF0b3JMaXN0SWQsIGlzU3BhY2UsIGlzSW5Gb250KSkgewogICAgICAgIGdseXBoID0gbmV3IEdseXBoKGZvbnRDaGFyLCB1bmljb2RlLCBhY2NlbnQsIHdpZHRoLCB2bWV0cmljLCBvcGVyYXRvckxpc3RJZCwgaXNTcGFjZSwgaXNJbkZvbnQpOwogICAgICAgIHRoaXMuZ2x5cGhDYWNoZVtjaGFyY29kZV0gPSBnbHlwaDsKICAgICAgfQoKICAgICAgcmV0dXJuIGdseXBoOwogICAgfSwKICAgIGNoYXJzVG9HbHlwaHM6IGZ1bmN0aW9uIEZvbnRfY2hhcnNUb0dseXBocyhjaGFycykgewogICAgICB2YXIgY2hhcnNDYWNoZSA9IHRoaXMuY2hhcnNDYWNoZTsKICAgICAgdmFyIGdseXBocywgZ2x5cGgsIGNoYXJjb2RlOwoKICAgICAgaWYgKGNoYXJzQ2FjaGUpIHsKICAgICAgICBnbHlwaHMgPSBjaGFyc0NhY2hlW2NoYXJzXTsKCiAgICAgICAgaWYgKGdseXBocykgewogICAgICAgICAgcmV0dXJuIGdseXBoczsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICghY2hhcnNDYWNoZSkgewogICAgICAgIGNoYXJzQ2FjaGUgPSB0aGlzLmNoYXJzQ2FjaGUgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICB9CgogICAgICBnbHlwaHMgPSBbXTsKICAgICAgdmFyIGNoYXJzQ2FjaGVLZXkgPSBjaGFyczsKICAgICAgdmFyIGkgPSAwLAogICAgICAgICAgaWk7CgogICAgICBpZiAodGhpcy5jTWFwKSB7CiAgICAgICAgdmFyIGMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgICAgICB3aGlsZSAoaSA8IGNoYXJzLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5jTWFwLnJlYWRDaGFyQ29kZShjaGFycywgaSwgYyk7CiAgICAgICAgICBjaGFyY29kZSA9IGMuY2hhcmNvZGU7CiAgICAgICAgICB2YXIgbGVuZ3RoID0gYy5sZW5ndGg7CiAgICAgICAgICBpICs9IGxlbmd0aDsKICAgICAgICAgIHZhciBpc1NwYWNlID0gbGVuZ3RoID09PSAxICYmIGNoYXJzLmNoYXJDb2RlQXQoaSAtIDEpID09PSAweDIwOwogICAgICAgICAgZ2x5cGggPSB0aGlzLmNoYXJUb0dseXBoKGNoYXJjb2RlLCBpc1NwYWNlKTsKICAgICAgICAgIGdseXBocy5wdXNoKGdseXBoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChpID0gMCwgaWkgPSBjaGFycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgICBjaGFyY29kZSA9IGNoYXJzLmNoYXJDb2RlQXQoaSk7CiAgICAgICAgICBnbHlwaCA9IHRoaXMuY2hhclRvR2x5cGgoY2hhcmNvZGUsIGNoYXJjb2RlID09PSAweDIwKTsKICAgICAgICAgIGdseXBocy5wdXNoKGdseXBoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBjaGFyc0NhY2hlW2NoYXJzQ2FjaGVLZXldID0gZ2x5cGhzOwogICAgfSwKCiAgICBnZXQgZ2x5cGhDYWNoZVZhbHVlcygpIHsKICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy5nbHlwaENhY2hlKTsKICAgIH0KCiAgfTsKICByZXR1cm4gRm9udDsKfSgpOwoKZXhwb3J0cy5Gb250ID0gRm9udDsKCnZhciBFcnJvckZvbnQgPSBmdW5jdGlvbiBFcnJvckZvbnRDbG9zdXJlKCkgewogIGZ1bmN0aW9uIEVycm9yRm9udChlcnJvcikgewogICAgdGhpcy5lcnJvciA9IGVycm9yOwogICAgdGhpcy5sb2FkZWROYW1lID0gImdfZm9udF9lcnJvciI7CiAgICB0aGlzLm1pc3NpbmdGaWxlID0gdHJ1ZTsKICB9CgogIEVycm9yRm9udC5wcm90b3R5cGUgPSB7CiAgICBjaGFyc1RvR2x5cGhzOiBmdW5jdGlvbiBFcnJvckZvbnRfY2hhcnNUb0dseXBocygpIHsKICAgICAgcmV0dXJuIFtdOwogICAgfSwKICAgIGV4cG9ydERhdGE6IGZ1bmN0aW9uIGV4cG9ydERhdGEoKSB7CiAgICAgIHZhciBleHRyYVByb3BlcnRpZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlOwogICAgICByZXR1cm4gewogICAgICAgIGVycm9yOiB0aGlzLmVycm9yCiAgICAgIH07CiAgICB9CiAgfTsKICByZXR1cm4gRXJyb3JGb250Owp9KCk7CgpleHBvcnRzLkVycm9yRm9udCA9IEVycm9yRm9udDsKCmZ1bmN0aW9uIHR5cGUxRm9udEdseXBoTWFwcGluZyhwcm9wZXJ0aWVzLCBidWlsdEluRW5jb2RpbmcsIGdseXBoTmFtZXMpIHsKICB2YXIgY2hhckNvZGVUb0dseXBoSWQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIHZhciBnbHlwaElkLCBjaGFyQ29kZSwgYmFzZUVuY29kaW5nOwogIHZhciBpc1N5bWJvbGljRm9udCA9ICEhKHByb3BlcnRpZXMuZmxhZ3MgJiBGb250RmxhZ3MuU3ltYm9saWMpOwoKICBpZiAocHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lKSB7CiAgICBiYXNlRW5jb2RpbmcgPSAoMCwgX2VuY29kaW5ncy5nZXRFbmNvZGluZykocHJvcGVydGllcy5iYXNlRW5jb2RpbmdOYW1lKTsKCiAgICBmb3IgKGNoYXJDb2RlID0gMDsgY2hhckNvZGUgPCBiYXNlRW5jb2RpbmcubGVuZ3RoOyBjaGFyQ29kZSsrKSB7CiAgICAgIGdseXBoSWQgPSBnbHlwaE5hbWVzLmluZGV4T2YoYmFzZUVuY29kaW5nW2NoYXJDb2RlXSk7CgogICAgICBpZiAoZ2x5cGhJZCA+PSAwKSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSAwOwogICAgICB9CiAgICB9CiAgfSBlbHNlIGlmIChpc1N5bWJvbGljRm9udCkgewogICAgZm9yIChjaGFyQ29kZSBpbiBidWlsdEluRW5jb2RpbmcpIHsKICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gYnVpbHRJbkVuY29kaW5nW2NoYXJDb2RlXTsKICAgIH0KICB9IGVsc2UgewogICAgYmFzZUVuY29kaW5nID0gX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nOwoKICAgIGZvciAoY2hhckNvZGUgPSAwOyBjaGFyQ29kZSA8IGJhc2VFbmNvZGluZy5sZW5ndGg7IGNoYXJDb2RlKyspIHsKICAgICAgZ2x5cGhJZCA9IGdseXBoTmFtZXMuaW5kZXhPZihiYXNlRW5jb2RpbmdbY2hhckNvZGVdKTsKCiAgICAgIGlmIChnbHlwaElkID49IDApIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSBnbHlwaElkOwogICAgICB9IGVsc2UgewogICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IDA7CiAgICAgIH0KICAgIH0KICB9CgogIHZhciBkaWZmZXJlbmNlcyA9IHByb3BlcnRpZXMuZGlmZmVyZW5jZXMsCiAgICAgIGdseXBoc1VuaWNvZGVNYXA7CgogIGlmIChkaWZmZXJlbmNlcykgewogICAgZm9yIChjaGFyQ29kZSBpbiBkaWZmZXJlbmNlcykgewogICAgICB2YXIgZ2x5cGhOYW1lID0gZGlmZmVyZW5jZXNbY2hhckNvZGVdOwogICAgICBnbHlwaElkID0gZ2x5cGhOYW1lcy5pbmRleE9mKGdseXBoTmFtZSk7CgogICAgICBpZiAoZ2x5cGhJZCA9PT0gLTEpIHsKICAgICAgICBpZiAoIWdseXBoc1VuaWNvZGVNYXApIHsKICAgICAgICAgIGdseXBoc1VuaWNvZGVNYXAgPSAoMCwgX2dseXBobGlzdC5nZXRHbHlwaHNVbmljb2RlKSgpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0YW5kYXJkR2x5cGhOYW1lID0gcmVjb3ZlckdseXBoTmFtZShnbHlwaE5hbWUsIGdseXBoc1VuaWNvZGVNYXApOwoKICAgICAgICBpZiAoc3RhbmRhcmRHbHlwaE5hbWUgIT09IGdseXBoTmFtZSkgewogICAgICAgICAgZ2x5cGhJZCA9IGdseXBoTmFtZXMuaW5kZXhPZihzdGFuZGFyZEdseXBoTmFtZSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZ2x5cGhJZCA+PSAwKSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFyQ29kZVRvR2x5cGhJZFtjaGFyQ29kZV0gPSAwOwogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4gY2hhckNvZGVUb0dseXBoSWQ7Cn0KCnZhciBUeXBlMUZvbnQgPSBmdW5jdGlvbiBUeXBlMUZvbnRDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGZpbmRCbG9jayhzdHJlYW1CeXRlcywgc2lnbmF0dXJlLCBzdGFydEluZGV4KSB7CiAgICB2YXIgc3RyZWFtQnl0ZXNMZW5ndGggPSBzdHJlYW1CeXRlcy5sZW5ndGg7CiAgICB2YXIgc2lnbmF0dXJlTGVuZ3RoID0gc2lnbmF0dXJlLmxlbmd0aDsKICAgIHZhciBzY2FuTGVuZ3RoID0gc3RyZWFtQnl0ZXNMZW5ndGggLSBzaWduYXR1cmVMZW5ndGg7CiAgICB2YXIgaSA9IHN0YXJ0SW5kZXgsCiAgICAgICAgaiwKICAgICAgICBmb3VuZCA9IGZhbHNlOwoKICAgIHdoaWxlIChpIDwgc2Nhbkxlbmd0aCkgewogICAgICBqID0gMDsKCiAgICAgIHdoaWxlIChqIDwgc2lnbmF0dXJlTGVuZ3RoICYmIHN0cmVhbUJ5dGVzW2kgKyBqXSA9PT0gc2lnbmF0dXJlW2pdKSB7CiAgICAgICAgaisrOwogICAgICB9CgogICAgICBpZiAoaiA+PSBzaWduYXR1cmVMZW5ndGgpIHsKICAgICAgICBpICs9IGo7CgogICAgICAgIHdoaWxlIChpIDwgc3RyZWFtQnl0ZXNMZW5ndGggJiYgKDAsIF9jb3JlX3V0aWxzLmlzV2hpdGVTcGFjZSkoc3RyZWFtQnl0ZXNbaV0pKSB7CiAgICAgICAgICBpKys7CiAgICAgICAgfQoKICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGkrKzsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBmb3VuZDogZm91bmQsCiAgICAgIGxlbmd0aDogaQogICAgfTsKICB9CgogIGZ1bmN0aW9uIGdldEhlYWRlckJsb2NrKHN0cmVhbSwgc3VnZ2VzdGVkTGVuZ3RoKSB7CiAgICB2YXIgRUVYRUNfU0lHTkFUVVJFID0gWzB4NjUsIDB4NjUsIDB4NzgsIDB4NjUsIDB4NjNdOwogICAgdmFyIHN0cmVhbVN0YXJ0UG9zID0gc3RyZWFtLnBvczsKICAgIHZhciBoZWFkZXJCeXRlcywgaGVhZGVyQnl0ZXNMZW5ndGgsIGJsb2NrOwoKICAgIHRyeSB7CiAgICAgIGhlYWRlckJ5dGVzID0gc3RyZWFtLmdldEJ5dGVzKHN1Z2dlc3RlZExlbmd0aCk7CiAgICAgIGhlYWRlckJ5dGVzTGVuZ3RoID0gaGVhZGVyQnl0ZXMubGVuZ3RoOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGV4IGluc3RhbmNlb2YgX2NvcmVfdXRpbHMuTWlzc2luZ0RhdGFFeGNlcHRpb24pIHsKICAgICAgICB0aHJvdyBleDsKICAgICAgfQogICAgfQoKICAgIGlmIChoZWFkZXJCeXRlc0xlbmd0aCA9PT0gc3VnZ2VzdGVkTGVuZ3RoKSB7CiAgICAgIGJsb2NrID0gZmluZEJsb2NrKGhlYWRlckJ5dGVzLCBFRVhFQ19TSUdOQVRVUkUsIHN1Z2dlc3RlZExlbmd0aCAtIDIgKiBFRVhFQ19TSUdOQVRVUkUubGVuZ3RoKTsKCiAgICAgIGlmIChibG9jay5mb3VuZCAmJiBibG9jay5sZW5ndGggPT09IHN1Z2dlc3RlZExlbmd0aCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBzdHJlYW06IG5ldyBfc3RyZWFtLlN0cmVhbShoZWFkZXJCeXRlcyksCiAgICAgICAgICBsZW5ndGg6IHN1Z2dlc3RlZExlbmd0aAogICAgICAgIH07CiAgICAgIH0KICAgIH0KCiAgICAoMCwgX3V0aWwud2FybikoJ0ludmFsaWQgIkxlbmd0aDEiIHByb3BlcnR5IGluIFR5cGUxIGZvbnQgLS0gdHJ5aW5nIHRvIHJlY292ZXIuJyk7CiAgICBzdHJlYW0ucG9zID0gc3RyZWFtU3RhcnRQb3M7CiAgICB2YXIgU0NBTl9CTE9DS19MRU5HVEggPSAyMDQ4OwogICAgdmFyIGFjdHVhbExlbmd0aDsKCiAgICB3aGlsZSAodHJ1ZSkgewogICAgICB2YXIgc2NhbkJ5dGVzID0gc3RyZWFtLnBlZWtCeXRlcyhTQ0FOX0JMT0NLX0xFTkdUSCk7CiAgICAgIGJsb2NrID0gZmluZEJsb2NrKHNjYW5CeXRlcywgRUVYRUNfU0lHTkFUVVJFLCAwKTsKCiAgICAgIGlmIChibG9jay5sZW5ndGggPT09IDApIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgc3RyZWFtLnBvcyArPSBibG9jay5sZW5ndGg7CgogICAgICBpZiAoYmxvY2suZm91bmQpIHsKICAgICAgICBhY3R1YWxMZW5ndGggPSBzdHJlYW0ucG9zIC0gc3RyZWFtU3RhcnRQb3M7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBzdHJlYW0ucG9zID0gc3RyZWFtU3RhcnRQb3M7CgogICAgaWYgKGFjdHVhbExlbmd0aCkgewogICAgICByZXR1cm4gewogICAgICAgIHN0cmVhbTogbmV3IF9zdHJlYW0uU3RyZWFtKHN0cmVhbS5nZXRCeXRlcyhhY3R1YWxMZW5ndGgpKSwKICAgICAgICBsZW5ndGg6IGFjdHVhbExlbmd0aAogICAgICB9OwogICAgfQoKICAgICgwLCBfdXRpbC53YXJuKSgnVW5hYmxlIHRvIHJlY292ZXIgIkxlbmd0aDEiIHByb3BlcnR5IGluIFR5cGUxIGZvbnQgLS0gdXNpbmcgYXMgaXMuJyk7CiAgICByZXR1cm4gewogICAgICBzdHJlYW06IG5ldyBfc3RyZWFtLlN0cmVhbShzdHJlYW0uZ2V0Qnl0ZXMoc3VnZ2VzdGVkTGVuZ3RoKSksCiAgICAgIGxlbmd0aDogc3VnZ2VzdGVkTGVuZ3RoCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gZ2V0RWV4ZWNCbG9jayhzdHJlYW0sIHN1Z2dlc3RlZExlbmd0aCkgewogICAgdmFyIGVleGVjQnl0ZXMgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTsKICAgIHJldHVybiB7CiAgICAgIHN0cmVhbTogbmV3IF9zdHJlYW0uU3RyZWFtKGVleGVjQnl0ZXMpLAogICAgICBsZW5ndGg6IGVleGVjQnl0ZXMubGVuZ3RoCiAgICB9OwogIH0KCiAgZnVuY3Rpb24gVHlwZTFGb250KG5hbWUsIGZpbGUsIHByb3BlcnRpZXMpIHsKICAgIHZhciBQRkJfSEVBREVSX1NJWkUgPSA2OwogICAgdmFyIGhlYWRlckJsb2NrTGVuZ3RoID0gcHJvcGVydGllcy5sZW5ndGgxOwogICAgdmFyIGVleGVjQmxvY2tMZW5ndGggPSBwcm9wZXJ0aWVzLmxlbmd0aDI7CiAgICB2YXIgcGZiSGVhZGVyID0gZmlsZS5wZWVrQnl0ZXMoUEZCX0hFQURFUl9TSVpFKTsKICAgIHZhciBwZmJIZWFkZXJQcmVzZW50ID0gcGZiSGVhZGVyWzBdID09PSAweDgwICYmIHBmYkhlYWRlclsxXSA9PT0gMHgwMTsKCiAgICBpZiAocGZiSGVhZGVyUHJlc2VudCkgewogICAgICBmaWxlLnNraXAoUEZCX0hFQURFUl9TSVpFKTsKICAgICAgaGVhZGVyQmxvY2tMZW5ndGggPSBwZmJIZWFkZXJbNV0gPDwgMjQgfCBwZmJIZWFkZXJbNF0gPDwgMTYgfCBwZmJIZWFkZXJbM10gPDwgOCB8IHBmYkhlYWRlclsyXTsKICAgIH0KCiAgICB2YXIgaGVhZGVyQmxvY2sgPSBnZXRIZWFkZXJCbG9jayhmaWxlLCBoZWFkZXJCbG9ja0xlbmd0aCk7CiAgICB2YXIgaGVhZGVyQmxvY2tQYXJzZXIgPSBuZXcgX3R5cGUxX3BhcnNlci5UeXBlMVBhcnNlcihoZWFkZXJCbG9jay5zdHJlYW0sIGZhbHNlLCBTRUFDX0FOQUxZU0lTX0VOQUJMRUQpOwogICAgaGVhZGVyQmxvY2tQYXJzZXIuZXh0cmFjdEZvbnRIZWFkZXIocHJvcGVydGllcyk7CgogICAgaWYgKHBmYkhlYWRlclByZXNlbnQpIHsKICAgICAgcGZiSGVhZGVyID0gZmlsZS5nZXRCeXRlcyhQRkJfSEVBREVSX1NJWkUpOwogICAgICBlZXhlY0Jsb2NrTGVuZ3RoID0gcGZiSGVhZGVyWzVdIDw8IDI0IHwgcGZiSGVhZGVyWzRdIDw8IDE2IHwgcGZiSGVhZGVyWzNdIDw8IDggfCBwZmJIZWFkZXJbMl07CiAgICB9CgogICAgdmFyIGVleGVjQmxvY2sgPSBnZXRFZXhlY0Jsb2NrKGZpbGUsIGVleGVjQmxvY2tMZW5ndGgpOwogICAgdmFyIGVleGVjQmxvY2tQYXJzZXIgPSBuZXcgX3R5cGUxX3BhcnNlci5UeXBlMVBhcnNlcihlZXhlY0Jsb2NrLnN0cmVhbSwgdHJ1ZSwgU0VBQ19BTkFMWVNJU19FTkFCTEVEKTsKICAgIHZhciBkYXRhID0gZWV4ZWNCbG9ja1BhcnNlci5leHRyYWN0Rm9udFByb2dyYW0ocHJvcGVydGllcyk7CgogICAgZm9yICh2YXIga2V5IGluIGRhdGEucHJvcGVydGllcykgewogICAgICBwcm9wZXJ0aWVzW2tleV0gPSBkYXRhLnByb3BlcnRpZXNba2V5XTsKICAgIH0KCiAgICB2YXIgY2hhcnN0cmluZ3MgPSBkYXRhLmNoYXJzdHJpbmdzOwogICAgdmFyIHR5cGUyQ2hhcnN0cmluZ3MgPSB0aGlzLmdldFR5cGUyQ2hhcnN0cmluZ3MoY2hhcnN0cmluZ3MpOwogICAgdmFyIHN1YnJzID0gdGhpcy5nZXRUeXBlMlN1YnJzKGRhdGEuc3VicnMpOwogICAgdGhpcy5jaGFyc3RyaW5ncyA9IGNoYXJzdHJpbmdzOwogICAgdGhpcy5kYXRhID0gdGhpcy53cmFwKG5hbWUsIHR5cGUyQ2hhcnN0cmluZ3MsIHRoaXMuY2hhcnN0cmluZ3MsIHN1YnJzLCBwcm9wZXJ0aWVzKTsKICAgIHRoaXMuc2VhY3MgPSB0aGlzLmdldFNlYWNzKGRhdGEuY2hhcnN0cmluZ3MpOwogIH0KCiAgVHlwZTFGb250LnByb3RvdHlwZSA9IHsKICAgIGdldCBudW1HbHlwaHMoKSB7CiAgICAgIHJldHVybiB0aGlzLmNoYXJzdHJpbmdzLmxlbmd0aCArIDE7CiAgICB9LAoKICAgIGdldENoYXJzZXQ6IGZ1bmN0aW9uIFR5cGUxRm9udF9nZXRDaGFyc2V0KCkgewogICAgICB2YXIgY2hhcnNldCA9IFsiLm5vdGRlZiJdOwogICAgICB2YXIgY2hhcnN0cmluZ3MgPSB0aGlzLmNoYXJzdHJpbmdzOwoKICAgICAgZm9yICh2YXIgZ2x5cGhJZCA9IDA7IGdseXBoSWQgPCBjaGFyc3RyaW5ncy5sZW5ndGg7IGdseXBoSWQrKykgewogICAgICAgIGNoYXJzZXQucHVzaChjaGFyc3RyaW5nc1tnbHlwaElkXS5nbHlwaE5hbWUpOwogICAgICB9CgogICAgICByZXR1cm4gY2hhcnNldDsKICAgIH0sCiAgICBnZXRHbHlwaE1hcHBpbmc6IGZ1bmN0aW9uIFR5cGUxRm9udF9nZXRHbHlwaE1hcHBpbmcocHJvcGVydGllcykgewogICAgICB2YXIgY2hhcnN0cmluZ3MgPSB0aGlzLmNoYXJzdHJpbmdzOwoKICAgICAgaWYgKHByb3BlcnRpZXMuY29tcG9zaXRlKSB7CiAgICAgICAgdmFyIGNoYXJDb2RlVG9HbHlwaElkID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKCiAgICAgICAgZm9yICh2YXIgX2dseXBoSWQgPSAwLCBjaGFyc3RyaW5nc0xlbiA9IGNoYXJzdHJpbmdzLmxlbmd0aDsgX2dseXBoSWQgPCBjaGFyc3RyaW5nc0xlbjsgX2dseXBoSWQrKykgewogICAgICAgICAgdmFyIF9jaGFyQ29kZTUgPSBwcm9wZXJ0aWVzLmNNYXAuY2hhckNvZGVPZihfZ2x5cGhJZCk7CgogICAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbX2NoYXJDb2RlNV0gPSBfZ2x5cGhJZCArIDE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY2hhckNvZGVUb0dseXBoSWQ7CiAgICAgIH0KCiAgICAgIHZhciBnbHlwaE5hbWVzID0gWyIubm90ZGVmIl0sCiAgICAgICAgICBnbHlwaElkOwoKICAgICAgZm9yIChnbHlwaElkID0gMDsgZ2x5cGhJZCA8IGNoYXJzdHJpbmdzLmxlbmd0aDsgZ2x5cGhJZCsrKSB7CiAgICAgICAgZ2x5cGhOYW1lcy5wdXNoKGNoYXJzdHJpbmdzW2dseXBoSWRdLmdseXBoTmFtZSk7CiAgICAgIH0KCiAgICAgIHZhciBlbmNvZGluZyA9IHByb3BlcnRpZXMuYnVpbHRJbkVuY29kaW5nOwoKICAgICAgaWYgKGVuY29kaW5nKSB7CiAgICAgICAgdmFyIGJ1aWx0SW5FbmNvZGluZyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogICAgICAgIGZvciAodmFyIGNoYXJDb2RlIGluIGVuY29kaW5nKSB7CiAgICAgICAgICBnbHlwaElkID0gZ2x5cGhOYW1lcy5pbmRleE9mKGVuY29kaW5nW2NoYXJDb2RlXSk7CgogICAgICAgICAgaWYgKGdseXBoSWQgPj0gMCkgewogICAgICAgICAgICBidWlsdEluRW5jb2RpbmdbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0eXBlMUZvbnRHbHlwaE1hcHBpbmcocHJvcGVydGllcywgYnVpbHRJbkVuY29kaW5nLCBnbHlwaE5hbWVzKTsKICAgIH0sCiAgICBoYXNHbHlwaElkOiBmdW5jdGlvbiBUeXBlMUZvbnRfaGFzR2x5cGhJRChpZCkgewogICAgICBpZiAoaWQgPCAwIHx8IGlkID49IHRoaXMubnVtR2x5cGhzKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoaWQgPT09IDApIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgdmFyIGdseXBoID0gdGhpcy5jaGFyc3RyaW5nc1tpZCAtIDFdOwogICAgICByZXR1cm4gZ2x5cGguY2hhcnN0cmluZy5sZW5ndGggPiAwOwogICAgfSwKICAgIGdldFNlYWNzOiBmdW5jdGlvbiBUeXBlMUZvbnRfZ2V0U2VhY3MoY2hhcnN0cmluZ3MpIHsKICAgICAgdmFyIGksIGlpOwogICAgICB2YXIgc2VhY01hcCA9IFtdOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSBjaGFyc3RyaW5ncy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgdmFyIGNoYXJzdHJpbmcgPSBjaGFyc3RyaW5nc1tpXTsKCiAgICAgICAgaWYgKGNoYXJzdHJpbmcuc2VhYykgewogICAgICAgICAgc2VhY01hcFtpICsgMV0gPSBjaGFyc3RyaW5nLnNlYWM7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gc2VhY01hcDsKICAgIH0sCiAgICBnZXRUeXBlMkNoYXJzdHJpbmdzOiBmdW5jdGlvbiBUeXBlMUZvbnRfZ2V0VHlwZTJDaGFyc3RyaW5ncyh0eXBlMUNoYXJzdHJpbmdzKSB7CiAgICAgIHZhciB0eXBlMkNoYXJzdHJpbmdzID0gW107CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB0eXBlMUNoYXJzdHJpbmdzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICB0eXBlMkNoYXJzdHJpbmdzLnB1c2godHlwZTFDaGFyc3RyaW5nc1tpXS5jaGFyc3RyaW5nKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHR5cGUyQ2hhcnN0cmluZ3M7CiAgICB9LAogICAgZ2V0VHlwZTJTdWJyczogZnVuY3Rpb24gVHlwZTFGb250X2dldFR5cGUyU3VicnModHlwZTFTdWJycykgewogICAgICB2YXIgYmlhcyA9IDA7CiAgICAgIHZhciBjb3VudCA9IHR5cGUxU3VicnMubGVuZ3RoOwoKICAgICAgaWYgKGNvdW50IDwgMTEzMykgewogICAgICAgIGJpYXMgPSAxMDc7CiAgICAgIH0gZWxzZSBpZiAoY291bnQgPCAzMzc2OSkgewogICAgICAgIGJpYXMgPSAxMTMxOwogICAgICB9IGVsc2UgewogICAgICAgIGJpYXMgPSAzMjc2ODsKICAgICAgfQoKICAgICAgdmFyIHR5cGUyU3VicnMgPSBbXTsKICAgICAgdmFyIGk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgYmlhczsgaSsrKSB7CiAgICAgICAgdHlwZTJTdWJycy5wdXNoKFsweDBiXSk7CiAgICAgIH0KCiAgICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgdHlwZTJTdWJycy5wdXNoKHR5cGUxU3VicnNbaV0pOwogICAgICB9CgogICAgICByZXR1cm4gdHlwZTJTdWJyczsKICAgIH0sCiAgICB3cmFwOiBmdW5jdGlvbiBUeXBlMUZvbnRfd3JhcChuYW1lLCBnbHlwaHMsIGNoYXJzdHJpbmdzLCBzdWJycywgcHJvcGVydGllcykgewogICAgICB2YXIgY2ZmID0gbmV3IF9jZmZfcGFyc2VyLkNGRigpOwogICAgICBjZmYuaGVhZGVyID0gbmV3IF9jZmZfcGFyc2VyLkNGRkhlYWRlcigxLCAwLCA0LCA0KTsKICAgICAgY2ZmLm5hbWVzID0gW25hbWVdOwogICAgICB2YXIgdG9wRGljdCA9IG5ldyBfY2ZmX3BhcnNlci5DRkZUb3BEaWN0KCk7CiAgICAgIHRvcERpY3Quc2V0QnlOYW1lKCJ2ZXJzaW9uIiwgMzkxKTsKICAgICAgdG9wRGljdC5zZXRCeU5hbWUoIk5vdGljZSIsIDM5Mik7CiAgICAgIHRvcERpY3Quc2V0QnlOYW1lKCJGdWxsTmFtZSIsIDM5Myk7CiAgICAgIHRvcERpY3Quc2V0QnlOYW1lKCJGYW1pbHlOYW1lIiwgMzk0KTsKICAgICAgdG9wRGljdC5zZXRCeU5hbWUoIldlaWdodCIsIDM5NSk7CiAgICAgIHRvcERpY3Quc2V0QnlOYW1lKCJFbmNvZGluZyIsIG51bGwpOwogICAgICB0b3BEaWN0LnNldEJ5TmFtZSgiRm9udE1hdHJpeCIsIHByb3BlcnRpZXMuZm9udE1hdHJpeCk7CiAgICAgIHRvcERpY3Quc2V0QnlOYW1lKCJGb250QkJveCIsIHByb3BlcnRpZXMuYmJveCk7CiAgICAgIHRvcERpY3Quc2V0QnlOYW1lKCJjaGFyc2V0IiwgbnVsbCk7CiAgICAgIHRvcERpY3Quc2V0QnlOYW1lKCJDaGFyU3RyaW5ncyIsIG51bGwpOwogICAgICB0b3BEaWN0LnNldEJ5TmFtZSgiUHJpdmF0ZSIsIG51bGwpOwogICAgICBjZmYudG9wRGljdCA9IHRvcERpY3Q7CiAgICAgIHZhciBzdHJpbmdzID0gbmV3IF9jZmZfcGFyc2VyLkNGRlN0cmluZ3MoKTsKICAgICAgc3RyaW5ncy5hZGQoIlZlcnNpb24gMC4xMSIpOwogICAgICBzdHJpbmdzLmFkZCgiU2VlIG9yaWdpbmFsIG5vdGljZSIpOwogICAgICBzdHJpbmdzLmFkZChuYW1lKTsKICAgICAgc3RyaW5ncy5hZGQobmFtZSk7CiAgICAgIHN0cmluZ3MuYWRkKCJNZWRpdW0iKTsKICAgICAgY2ZmLnN0cmluZ3MgPSBzdHJpbmdzOwogICAgICBjZmYuZ2xvYmFsU3VickluZGV4ID0gbmV3IF9jZmZfcGFyc2VyLkNGRkluZGV4KCk7CiAgICAgIHZhciBjb3VudCA9IGdseXBocy5sZW5ndGg7CiAgICAgIHZhciBjaGFyc2V0QXJyYXkgPSBbIi5ub3RkZWYiXTsKICAgICAgdmFyIGksIGlpOwoKICAgICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICB2YXIgZ2x5cGhOYW1lID0gY2hhcnN0cmluZ3NbaV0uZ2x5cGhOYW1lOwoKICAgICAgICB2YXIgaW5kZXggPSBfY2ZmX3BhcnNlci5DRkZTdGFuZGFyZFN0cmluZ3MuaW5kZXhPZihnbHlwaE5hbWUpOwoKICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7CiAgICAgICAgICBzdHJpbmdzLmFkZChnbHlwaE5hbWUpOwogICAgICAgIH0KCiAgICAgICAgY2hhcnNldEFycmF5LnB1c2goZ2x5cGhOYW1lKTsKICAgICAgfQoKICAgICAgY2ZmLmNoYXJzZXQgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGQ2hhcnNldChmYWxzZSwgMCwgY2hhcnNldEFycmF5KTsKICAgICAgdmFyIGNoYXJTdHJpbmdzSW5kZXggPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGSW5kZXgoKTsKICAgICAgY2hhclN0cmluZ3NJbmRleC5hZGQoWzB4OGIsIDB4MGVdKTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgY2hhclN0cmluZ3NJbmRleC5hZGQoZ2x5cGhzW2ldKTsKICAgICAgfQoKICAgICAgY2ZmLmNoYXJTdHJpbmdzID0gY2hhclN0cmluZ3NJbmRleDsKICAgICAgdmFyIHByaXZhdGVEaWN0ID0gbmV3IF9jZmZfcGFyc2VyLkNGRlByaXZhdGVEaWN0KCk7CiAgICAgIHByaXZhdGVEaWN0LnNldEJ5TmFtZSgiU3VicnMiLCBudWxsKTsKICAgICAgdmFyIGZpZWxkcyA9IFsiQmx1ZVZhbHVlcyIsICJPdGhlckJsdWVzIiwgIkZhbWlseUJsdWVzIiwgIkZhbWlseU90aGVyQmx1ZXMiLCAiU3RlbVNuYXBIIiwgIlN0ZW1TbmFwViIsICJCbHVlU2hpZnQiLCAiQmx1ZUZ1enoiLCAiQmx1ZVNjYWxlIiwgIkxhbmd1YWdlR3JvdXAiLCAiRXhwYW5zaW9uRmFjdG9yIiwgIkZvcmNlQm9sZCIsICJTdGRIVyIsICJTdGRWVyJdOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSBmaWVsZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIHZhciBmaWVsZCA9IGZpZWxkc1tpXTsKCiAgICAgICAgaWYgKCEoZmllbGQgaW4gcHJvcGVydGllcy5wcml2YXRlRGF0YSkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHZhbHVlID0gcHJvcGVydGllcy5wcml2YXRlRGF0YVtmaWVsZF07CgogICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgICAgICAgZm9yICh2YXIgaiA9IHZhbHVlLmxlbmd0aCAtIDE7IGogPiAwOyBqLS0pIHsKICAgICAgICAgICAgdmFsdWVbal0gLT0gdmFsdWVbaiAtIDFdOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZURpY3Quc2V0QnlOYW1lKGZpZWxkLCB2YWx1ZSk7CiAgICAgIH0KCiAgICAgIGNmZi50b3BEaWN0LnByaXZhdGVEaWN0ID0gcHJpdmF0ZURpY3Q7CiAgICAgIHZhciBzdWJySW5kZXggPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGSW5kZXgoKTsKCiAgICAgIGZvciAoaSA9IDAsIGlpID0gc3VicnMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgIHN1YnJJbmRleC5hZGQoc3VicnNbaV0pOwogICAgICB9CgogICAgICBwcml2YXRlRGljdC5zdWJyc0luZGV4ID0gc3VickluZGV4OwogICAgICB2YXIgY29tcGlsZXIgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGQ29tcGlsZXIoY2ZmKTsKICAgICAgcmV0dXJuIGNvbXBpbGVyLmNvbXBpbGUoKTsKICAgIH0KICB9OwogIHJldHVybiBUeXBlMUZvbnQ7Cn0oKTsKCnZhciBDRkZGb250ID0gZnVuY3Rpb24gQ0ZGRm9udENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQ0ZGRm9udChmaWxlLCBwcm9wZXJ0aWVzKSB7CiAgICB0aGlzLnByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzOwogICAgdmFyIHBhcnNlciA9IG5ldyBfY2ZmX3BhcnNlci5DRkZQYXJzZXIoZmlsZSwgcHJvcGVydGllcywgU0VBQ19BTkFMWVNJU19FTkFCTEVEKTsKICAgIHRoaXMuY2ZmID0gcGFyc2VyLnBhcnNlKCk7CiAgICB0aGlzLmNmZi5kdXBsaWNhdGVGaXJzdEdseXBoKCk7CiAgICB2YXIgY29tcGlsZXIgPSBuZXcgX2NmZl9wYXJzZXIuQ0ZGQ29tcGlsZXIodGhpcy5jZmYpOwogICAgdGhpcy5zZWFjcyA9IHRoaXMuY2ZmLnNlYWNzOwoKICAgIHRyeSB7CiAgICAgIHRoaXMuZGF0YSA9IGNvbXBpbGVyLmNvbXBpbGUoKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgKDAsIF91dGlsLndhcm4pKCJGYWlsZWQgdG8gY29tcGlsZSBmb250ICIgKyBwcm9wZXJ0aWVzLmxvYWRlZE5hbWUpOwogICAgICB0aGlzLmRhdGEgPSBmaWxlOwogICAgfQogIH0KCiAgQ0ZGRm9udC5wcm90b3R5cGUgPSB7CiAgICBnZXQgbnVtR2x5cGhzKCkgewogICAgICByZXR1cm4gdGhpcy5jZmYuY2hhclN0cmluZ3MuY291bnQ7CiAgICB9LAoKICAgIGdldENoYXJzZXQ6IGZ1bmN0aW9uIENGRkZvbnRfZ2V0Q2hhcnNldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuY2ZmLmNoYXJzZXQuY2hhcnNldDsKICAgIH0sCiAgICBnZXRHbHlwaE1hcHBpbmc6IGZ1bmN0aW9uIENGRkZvbnRfZ2V0R2x5cGhNYXBwaW5nKCkgewogICAgICB2YXIgY2ZmID0gdGhpcy5jZmY7CiAgICAgIHZhciBwcm9wZXJ0aWVzID0gdGhpcy5wcm9wZXJ0aWVzOwogICAgICB2YXIgY2hhcnNldHMgPSBjZmYuY2hhcnNldC5jaGFyc2V0OwogICAgICB2YXIgY2hhckNvZGVUb0dseXBoSWQ7CiAgICAgIHZhciBnbHlwaElkOwoKICAgICAgaWYgKHByb3BlcnRpZXMuY29tcG9zaXRlKSB7CiAgICAgICAgY2hhckNvZGVUb0dseXBoSWQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICAgIHZhciBjaGFyQ29kZTsKCiAgICAgICAgaWYgKGNmZi5pc0NJREZvbnQpIHsKICAgICAgICAgIGZvciAoZ2x5cGhJZCA9IDA7IGdseXBoSWQgPCBjaGFyc2V0cy5sZW5ndGg7IGdseXBoSWQrKykgewogICAgICAgICAgICB2YXIgY2lkID0gY2hhcnNldHNbZ2x5cGhJZF07CiAgICAgICAgICAgIGNoYXJDb2RlID0gcHJvcGVydGllcy5jTWFwLmNoYXJDb2RlT2YoY2lkKTsKICAgICAgICAgICAgY2hhckNvZGVUb0dseXBoSWRbY2hhckNvZGVdID0gZ2x5cGhJZDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZm9yIChnbHlwaElkID0gMDsgZ2x5cGhJZCA8IGNmZi5jaGFyU3RyaW5ncy5jb3VudDsgZ2x5cGhJZCsrKSB7CiAgICAgICAgICAgIGNoYXJDb2RlID0gcHJvcGVydGllcy5jTWFwLmNoYXJDb2RlT2YoZ2x5cGhJZCk7CiAgICAgICAgICAgIGNoYXJDb2RlVG9HbHlwaElkW2NoYXJDb2RlXSA9IGdseXBoSWQ7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY2hhckNvZGVUb0dseXBoSWQ7CiAgICAgIH0KCiAgICAgIHZhciBlbmNvZGluZyA9IGNmZi5lbmNvZGluZyA/IGNmZi5lbmNvZGluZy5lbmNvZGluZyA6IG51bGw7CiAgICAgIGNoYXJDb2RlVG9HbHlwaElkID0gdHlwZTFGb250R2x5cGhNYXBwaW5nKHByb3BlcnRpZXMsIGVuY29kaW5nLCBjaGFyc2V0cyk7CiAgICAgIHJldHVybiBjaGFyQ29kZVRvR2x5cGhJZDsKICAgIH0sCiAgICBoYXNHbHlwaElkOiBmdW5jdGlvbiBDRkZGb250X2hhc0dseXBoSUQoaWQpIHsKICAgICAgcmV0dXJuIHRoaXMuY2ZmLmhhc0dseXBoSWQoaWQpOwogICAgfQogIH07CiAgcmV0dXJuIENGRkZvbnQ7Cn0oKTsKCi8qKiovIH0pLAovKiAyMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5DRkZGRFNlbGVjdCA9IGV4cG9ydHMuQ0ZGQ29tcGlsZXIgPSBleHBvcnRzLkNGRlByaXZhdGVEaWN0ID0gZXhwb3J0cy5DRkZUb3BEaWN0ID0gZXhwb3J0cy5DRkZDaGFyc2V0ID0gZXhwb3J0cy5DRkZJbmRleCA9IGV4cG9ydHMuQ0ZGU3RyaW5ncyA9IGV4cG9ydHMuQ0ZGSGVhZGVyID0gZXhwb3J0cy5DRkYgPSBleHBvcnRzLkNGRlBhcnNlciA9IGV4cG9ydHMuQ0ZGU3RhbmRhcmRTdHJpbmdzID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfY2hhcnNldHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyNCk7Cgp2YXIgX2VuY29kaW5ncyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI1KTsKCnZhciBNQVhfU1VCUl9ORVNUSU5HID0gMTA7CnZhciBDRkZTdGFuZGFyZFN0cmluZ3MgPSBbIi5ub3RkZWYiLCAic3BhY2UiLCAiZXhjbGFtIiwgInF1b3RlZGJsIiwgIm51bWJlcnNpZ24iLCAiZG9sbGFyIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInF1b3RlcmlnaHQiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2siLCAicGx1cyIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJhdCIsICJBIiwgIkIiLCAiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkgiLCAiSSIsICJKIiwgIksiLCAiTCIsICJNIiwgIk4iLCAiTyIsICJQIiwgIlEiLCAiUiIsICJTIiwgIlQiLCAiVSIsICJWIiwgIlciLCAiWCIsICJZIiwgIloiLCAiYnJhY2tldGxlZnQiLCAiYmFja3NsYXNoIiwgImJyYWNrZXRyaWdodCIsICJhc2NpaWNpcmN1bSIsICJ1bmRlcnNjb3JlIiwgInF1b3RlbGVmdCIsICJhIiwgImIiLCAiYyIsICJkIiwgImUiLCAiZiIsICJnIiwgImgiLCAiaSIsICJqIiwgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsICJ2IiwgInciLCAieCIsICJ5IiwgInoiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgImFzY2lpdGlsZGUiLCAiZXhjbGFtZG93biIsICJjZW50IiwgInN0ZXJsaW5nIiwgImZyYWN0aW9uIiwgInllbiIsICJmbG9yaW4iLCAic2VjdGlvbiIsICJjdXJyZW5jeSIsICJxdW90ZXNpbmdsZSIsICJxdW90ZWRibGxlZnQiLCAiZ3VpbGxlbW90bGVmdCIsICJndWlsc2luZ2xsZWZ0IiwgImd1aWxzaW5nbHJpZ2h0IiwgImZpIiwgImZsIiwgImVuZGFzaCIsICJkYWdnZXIiLCAiZGFnZ2VyZGJsIiwgInBlcmlvZGNlbnRlcmVkIiwgInBhcmFncmFwaCIsICJidWxsZXQiLCAicXVvdGVzaW5nbGJhc2UiLCAicXVvdGVkYmxiYXNlIiwgInF1b3RlZGJscmlnaHQiLCAiZ3VpbGxlbW90cmlnaHQiLCAiZWxsaXBzaXMiLCAicGVydGhvdXNhbmQiLCAicXVlc3Rpb25kb3duIiwgImdyYXZlIiwgImFjdXRlIiwgImNpcmN1bWZsZXgiLCAidGlsZGUiLCAibWFjcm9uIiwgImJyZXZlIiwgImRvdGFjY2VudCIsICJkaWVyZXNpcyIsICJyaW5nIiwgImNlZGlsbGEiLCAiaHVuZ2FydW1sYXV0IiwgIm9nb25layIsICJjYXJvbiIsICJlbWRhc2giLCAiQUUiLCAib3JkZmVtaW5pbmUiLCAiTHNsYXNoIiwgIk9zbGFzaCIsICJPRSIsICJvcmRtYXNjdWxpbmUiLCAiYWUiLCAiZG90bGVzc2kiLCAibHNsYXNoIiwgIm9zbGFzaCIsICJvZSIsICJnZXJtYW5kYmxzIiwgIm9uZXN1cGVyaW9yIiwgImxvZ2ljYWxub3QiLCAibXUiLCAidHJhZGVtYXJrIiwgIkV0aCIsICJvbmVoYWxmIiwgInBsdXNtaW51cyIsICJUaG9ybiIsICJvbmVxdWFydGVyIiwgImRpdmlkZSIsICJicm9rZW5iYXIiLCAiZGVncmVlIiwgInRob3JuIiwgInRocmVlcXVhcnRlcnMiLCAidHdvc3VwZXJpb3IiLCAicmVnaXN0ZXJlZCIsICJtaW51cyIsICJldGgiLCAibXVsdGlwbHkiLCAidGhyZWVzdXBlcmlvciIsICJjb3B5cmlnaHQiLCAiQWFjdXRlIiwgIkFjaXJjdW1mbGV4IiwgIkFkaWVyZXNpcyIsICJBZ3JhdmUiLCAiQXJpbmciLCAiQXRpbGRlIiwgIkNjZWRpbGxhIiwgIkVhY3V0ZSIsICJFY2lyY3VtZmxleCIsICJFZGllcmVzaXMiLCAiRWdyYXZlIiwgIklhY3V0ZSIsICJJY2lyY3VtZmxleCIsICJJZGllcmVzaXMiLCAiSWdyYXZlIiwgIk50aWxkZSIsICJPYWN1dGUiLCAiT2NpcmN1bWZsZXgiLCAiT2RpZXJlc2lzIiwgIk9ncmF2ZSIsICJPdGlsZGUiLCAiU2Nhcm9uIiwgIlVhY3V0ZSIsICJVY2lyY3VtZmxleCIsICJVZGllcmVzaXMiLCAiVWdyYXZlIiwgIllhY3V0ZSIsICJZZGllcmVzaXMiLCAiWmNhcm9uIiwgImFhY3V0ZSIsICJhY2lyY3VtZmxleCIsICJhZGllcmVzaXMiLCAiYWdyYXZlIiwgImFyaW5nIiwgImF0aWxkZSIsICJjY2VkaWxsYSIsICJlYWN1dGUiLCAiZWNpcmN1bWZsZXgiLCAiZWRpZXJlc2lzIiwgImVncmF2ZSIsICJpYWN1dGUiLCAiaWNpcmN1bWZsZXgiLCAiaWRpZXJlc2lzIiwgImlncmF2ZSIsICJudGlsZGUiLCAib2FjdXRlIiwgIm9jaXJjdW1mbGV4IiwgIm9kaWVyZXNpcyIsICJvZ3JhdmUiLCAib3RpbGRlIiwgInNjYXJvbiIsICJ1YWN1dGUiLCAidWNpcmN1bWZsZXgiLCAidWRpZXJlc2lzIiwgInVncmF2ZSIsICJ5YWN1dGUiLCAieWRpZXJlc2lzIiwgInpjYXJvbiIsICJleGNsYW1zbWFsbCIsICJIdW5nYXJ1bWxhdXRzbWFsbCIsICJkb2xsYXJvbGRzdHlsZSIsICJkb2xsYXJzdXBlcmlvciIsICJhbXBlcnNhbmRzbWFsbCIsICJBY3V0ZXNtYWxsIiwgInBhcmVubGVmdHN1cGVyaW9yIiwgInBhcmVucmlnaHRzdXBlcmlvciIsICJ0d29kb3RlbmxlYWRlciIsICJvbmVkb3RlbmxlYWRlciIsICJ6ZXJvb2xkc3R5bGUiLCAib25lb2xkc3R5bGUiLCAidHdvb2xkc3R5bGUiLCAidGhyZWVvbGRzdHlsZSIsICJmb3Vyb2xkc3R5bGUiLCAiZml2ZW9sZHN0eWxlIiwgInNpeG9sZHN0eWxlIiwgInNldmVub2xkc3R5bGUiLCAiZWlnaHRvbGRzdHlsZSIsICJuaW5lb2xkc3R5bGUiLCAiY29tbWFzdXBlcmlvciIsICJ0aHJlZXF1YXJ0ZXJzZW1kYXNoIiwgInBlcmlvZHN1cGVyaW9yIiwgInF1ZXN0aW9uc21hbGwiLCAiYXN1cGVyaW9yIiwgImJzdXBlcmlvciIsICJjZW50c3VwZXJpb3IiLCAiZHN1cGVyaW9yIiwgImVzdXBlcmlvciIsICJpc3VwZXJpb3IiLCAibHN1cGVyaW9yIiwgIm1zdXBlcmlvciIsICJuc3VwZXJpb3IiLCAib3N1cGVyaW9yIiwgInJzdXBlcmlvciIsICJzc3VwZXJpb3IiLCAidHN1cGVyaW9yIiwgImZmIiwgImZmaSIsICJmZmwiLCAicGFyZW5sZWZ0aW5mZXJpb3IiLCAicGFyZW5yaWdodGluZmVyaW9yIiwgIkNpcmN1bWZsZXhzbWFsbCIsICJoeXBoZW5zdXBlcmlvciIsICJHcmF2ZXNtYWxsIiwgIkFzbWFsbCIsICJCc21hbGwiLCAiQ3NtYWxsIiwgIkRzbWFsbCIsICJFc21hbGwiLCAiRnNtYWxsIiwgIkdzbWFsbCIsICJIc21hbGwiLCAiSXNtYWxsIiwgIkpzbWFsbCIsICJLc21hbGwiLCAiTHNtYWxsIiwgIk1zbWFsbCIsICJOc21hbGwiLCAiT3NtYWxsIiwgIlBzbWFsbCIsICJRc21hbGwiLCAiUnNtYWxsIiwgIlNzbWFsbCIsICJUc21hbGwiLCAiVXNtYWxsIiwgIlZzbWFsbCIsICJXc21hbGwiLCAiWHNtYWxsIiwgIllzbWFsbCIsICJac21hbGwiLCAiY29sb25tb25ldGFyeSIsICJvbmVmaXR0ZWQiLCAicnVwaWFoIiwgIlRpbGRlc21hbGwiLCAiZXhjbGFtZG93bnNtYWxsIiwgImNlbnRvbGRzdHlsZSIsICJMc2xhc2hzbWFsbCIsICJTY2Fyb25zbWFsbCIsICJaY2Fyb25zbWFsbCIsICJEaWVyZXNpc3NtYWxsIiwgIkJyZXZlc21hbGwiLCAiQ2Fyb25zbWFsbCIsICJEb3RhY2NlbnRzbWFsbCIsICJNYWNyb25zbWFsbCIsICJmaWd1cmVkYXNoIiwgImh5cGhlbmluZmVyaW9yIiwgIk9nb25la3NtYWxsIiwgIlJpbmdzbWFsbCIsICJDZWRpbGxhc21hbGwiLCAicXVlc3Rpb25kb3duc21hbGwiLCAib25lZWlnaHRoIiwgInRocmVlZWlnaHRocyIsICJmaXZlZWlnaHRocyIsICJzZXZlbmVpZ2h0aHMiLCAib25ldGhpcmQiLCAidHdvdGhpcmRzIiwgInplcm9zdXBlcmlvciIsICJmb3Vyc3VwZXJpb3IiLCAiZml2ZXN1cGVyaW9yIiwgInNpeHN1cGVyaW9yIiwgInNldmVuc3VwZXJpb3IiLCAiZWlnaHRzdXBlcmlvciIsICJuaW5lc3VwZXJpb3IiLCAiemVyb2luZmVyaW9yIiwgIm9uZWluZmVyaW9yIiwgInR3b2luZmVyaW9yIiwgInRocmVlaW5mZXJpb3IiLCAiZm91cmluZmVyaW9yIiwgImZpdmVpbmZlcmlvciIsICJzaXhpbmZlcmlvciIsICJzZXZlbmluZmVyaW9yIiwgImVpZ2h0aW5mZXJpb3IiLCAibmluZWluZmVyaW9yIiwgImNlbnRpbmZlcmlvciIsICJkb2xsYXJpbmZlcmlvciIsICJwZXJpb2RpbmZlcmlvciIsICJjb21tYWluZmVyaW9yIiwgIkFncmF2ZXNtYWxsIiwgIkFhY3V0ZXNtYWxsIiwgIkFjaXJjdW1mbGV4c21hbGwiLCAiQXRpbGRlc21hbGwiLCAiQWRpZXJlc2lzc21hbGwiLCAiQXJpbmdzbWFsbCIsICJBRXNtYWxsIiwgIkNjZWRpbGxhc21hbGwiLCAiRWdyYXZlc21hbGwiLCAiRWFjdXRlc21hbGwiLCAiRWNpcmN1bWZsZXhzbWFsbCIsICJFZGllcmVzaXNzbWFsbCIsICJJZ3JhdmVzbWFsbCIsICJJYWN1dGVzbWFsbCIsICJJY2lyY3VtZmxleHNtYWxsIiwgIklkaWVyZXNpc3NtYWxsIiwgIkV0aHNtYWxsIiwgIk50aWxkZXNtYWxsIiwgIk9ncmF2ZXNtYWxsIiwgIk9hY3V0ZXNtYWxsIiwgIk9jaXJjdW1mbGV4c21hbGwiLCAiT3RpbGRlc21hbGwiLCAiT2RpZXJlc2lzc21hbGwiLCAiT0VzbWFsbCIsICJPc2xhc2hzbWFsbCIsICJVZ3JhdmVzbWFsbCIsICJVYWN1dGVzbWFsbCIsICJVY2lyY3VtZmxleHNtYWxsIiwgIlVkaWVyZXNpc3NtYWxsIiwgIllhY3V0ZXNtYWxsIiwgIlRob3Juc21hbGwiLCAiWWRpZXJlc2lzc21hbGwiLCAiMDAxLjAwMCIsICIwMDEuMDAxIiwgIjAwMS4wMDIiLCAiMDAxLjAwMyIsICJCbGFjayIsICJCb2xkIiwgIkJvb2siLCAiTGlnaHQiLCAiTWVkaXVtIiwgIlJlZ3VsYXIiLCAiUm9tYW4iLCAiU2VtaWJvbGQiXTsKZXhwb3J0cy5DRkZTdGFuZGFyZFN0cmluZ3MgPSBDRkZTdGFuZGFyZFN0cmluZ3M7CnZhciBOVU1fU1RBTkRBUkRfQ0ZGX1NUUklOR1MgPSAzOTE7Cgp2YXIgQ0ZGUGFyc2VyID0gZnVuY3Rpb24gQ0ZGUGFyc2VyQ2xvc3VyZSgpIHsKICB2YXIgQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhID0gW251bGwsIHsKICAgIGlkOiAiaHN0ZW0iLAogICAgbWluOiAyLAogICAgc3RhY2tDbGVhcmluZzogdHJ1ZSwKICAgIHN0ZW06IHRydWUKICB9LCBudWxsLCB7CiAgICBpZDogInZzdGVtIiwKICAgIG1pbjogMiwKICAgIHN0YWNrQ2xlYXJpbmc6IHRydWUsCiAgICBzdGVtOiB0cnVlCiAgfSwgewogICAgaWQ6ICJ2bW92ZXRvIiwKICAgIG1pbjogMSwKICAgIHN0YWNrQ2xlYXJpbmc6IHRydWUKICB9LCB7CiAgICBpZDogInJsaW5ldG8iLAogICAgbWluOiAyLAogICAgcmVzZXRTdGFjazogdHJ1ZQogIH0sIHsKICAgIGlkOiAiaGxpbmV0byIsCiAgICBtaW46IDEsCiAgICByZXNldFN0YWNrOiB0cnVlCiAgfSwgewogICAgaWQ6ICJ2bGluZXRvIiwKICAgIG1pbjogMSwKICAgIHJlc2V0U3RhY2s6IHRydWUKICB9LCB7CiAgICBpZDogInJyY3VydmV0byIsCiAgICBtaW46IDYsCiAgICByZXNldFN0YWNrOiB0cnVlCiAgfSwgbnVsbCwgewogICAgaWQ6ICJjYWxsc3ViciIsCiAgICBtaW46IDEsCiAgICB1bmRlZlN0YWNrOiB0cnVlCiAgfSwgewogICAgaWQ6ICJyZXR1cm4iLAogICAgbWluOiAwLAogICAgdW5kZWZTdGFjazogdHJ1ZQogIH0sIG51bGwsIG51bGwsIHsKICAgIGlkOiAiZW5kY2hhciIsCiAgICBtaW46IDAsCiAgICBzdGFja0NsZWFyaW5nOiB0cnVlCiAgfSwgbnVsbCwgbnVsbCwgbnVsbCwgewogICAgaWQ6ICJoc3RlbWhtIiwKICAgIG1pbjogMiwKICAgIHN0YWNrQ2xlYXJpbmc6IHRydWUsCiAgICBzdGVtOiB0cnVlCiAgfSwgewogICAgaWQ6ICJoaW50bWFzayIsCiAgICBtaW46IDAsCiAgICBzdGFja0NsZWFyaW5nOiB0cnVlCiAgfSwgewogICAgaWQ6ICJjbnRybWFzayIsCiAgICBtaW46IDAsCiAgICBzdGFja0NsZWFyaW5nOiB0cnVlCiAgfSwgewogICAgaWQ6ICJybW92ZXRvIiwKICAgIG1pbjogMiwKICAgIHN0YWNrQ2xlYXJpbmc6IHRydWUKICB9LCB7CiAgICBpZDogImhtb3ZldG8iLAogICAgbWluOiAxLAogICAgc3RhY2tDbGVhcmluZzogdHJ1ZQogIH0sIHsKICAgIGlkOiAidnN0ZW1obSIsCiAgICBtaW46IDIsCiAgICBzdGFja0NsZWFyaW5nOiB0cnVlLAogICAgc3RlbTogdHJ1ZQogIH0sIHsKICAgIGlkOiAicmN1cnZlbGluZSIsCiAgICBtaW46IDgsCiAgICByZXNldFN0YWNrOiB0cnVlCiAgfSwgewogICAgaWQ6ICJybGluZWN1cnZlIiwKICAgIG1pbjogOCwKICAgIHJlc2V0U3RhY2s6IHRydWUKICB9LCB7CiAgICBpZDogInZ2Y3VydmV0byIsCiAgICBtaW46IDQsCiAgICByZXNldFN0YWNrOiB0cnVlCiAgfSwgewogICAgaWQ6ICJoaGN1cnZldG8iLAogICAgbWluOiA0LAogICAgcmVzZXRTdGFjazogdHJ1ZQogIH0sIG51bGwsIHsKICAgIGlkOiAiY2FsbGdzdWJyIiwKICAgIG1pbjogMSwKICAgIHVuZGVmU3RhY2s6IHRydWUKICB9LCB7CiAgICBpZDogInZoY3VydmV0byIsCiAgICBtaW46IDQsCiAgICByZXNldFN0YWNrOiB0cnVlCiAgfSwgewogICAgaWQ6ICJodmN1cnZldG8iLAogICAgbWluOiA0LAogICAgcmVzZXRTdGFjazogdHJ1ZQogIH1dOwogIHZhciBDaGFyc3RyaW5nVmFsaWRhdGlvbkRhdGExMiA9IFtudWxsLCBudWxsLCBudWxsLCB7CiAgICBpZDogImFuZCIsCiAgICBtaW46IDIsCiAgICBzdGFja0RlbHRhOiAtMQogIH0sIHsKICAgIGlkOiAib3IiLAogICAgbWluOiAyLAogICAgc3RhY2tEZWx0YTogLTEKICB9LCB7CiAgICBpZDogIm5vdCIsCiAgICBtaW46IDEsCiAgICBzdGFja0RlbHRhOiAwCiAgfSwgbnVsbCwgbnVsbCwgbnVsbCwgewogICAgaWQ6ICJhYnMiLAogICAgbWluOiAxLAogICAgc3RhY2tEZWx0YTogMAogIH0sIHsKICAgIGlkOiAiYWRkIiwKICAgIG1pbjogMiwKICAgIHN0YWNrRGVsdGE6IC0xLAogICAgc3RhY2tGbjogZnVuY3Rpb24gc3RhY2tfZGl2KHN0YWNrLCBpbmRleCkgewogICAgICBzdGFja1tpbmRleCAtIDJdID0gc3RhY2tbaW5kZXggLSAyXSArIHN0YWNrW2luZGV4IC0gMV07CiAgICB9CiAgfSwgewogICAgaWQ6ICJzdWIiLAogICAgbWluOiAyLAogICAgc3RhY2tEZWx0YTogLTEsCiAgICBzdGFja0ZuOiBmdW5jdGlvbiBzdGFja19kaXYoc3RhY2ssIGluZGV4KSB7CiAgICAgIHN0YWNrW2luZGV4IC0gMl0gPSBzdGFja1tpbmRleCAtIDJdIC0gc3RhY2tbaW5kZXggLSAxXTsKICAgIH0KICB9LCB7CiAgICBpZDogImRpdiIsCiAgICBtaW46IDIsCiAgICBzdGFja0RlbHRhOiAtMSwKICAgIHN0YWNrRm46IGZ1bmN0aW9uIHN0YWNrX2RpdihzdGFjaywgaW5kZXgpIHsKICAgICAgc3RhY2tbaW5kZXggLSAyXSA9IHN0YWNrW2luZGV4IC0gMl0gLyBzdGFja1tpbmRleCAtIDFdOwogICAgfQogIH0sIG51bGwsIHsKICAgIGlkOiAibmVnIiwKICAgIG1pbjogMSwKICAgIHN0YWNrRGVsdGE6IDAsCiAgICBzdGFja0ZuOiBmdW5jdGlvbiBzdGFja19kaXYoc3RhY2ssIGluZGV4KSB7CiAgICAgIHN0YWNrW2luZGV4IC0gMV0gPSAtc3RhY2tbaW5kZXggLSAxXTsKICAgIH0KICB9LCB7CiAgICBpZDogImVxIiwKICAgIG1pbjogMiwKICAgIHN0YWNrRGVsdGE6IC0xCiAgfSwgbnVsbCwgbnVsbCwgewogICAgaWQ6ICJkcm9wIiwKICAgIG1pbjogMSwKICAgIHN0YWNrRGVsdGE6IC0xCiAgfSwgbnVsbCwgewogICAgaWQ6ICJwdXQiLAogICAgbWluOiAyLAogICAgc3RhY2tEZWx0YTogLTIKICB9LCB7CiAgICBpZDogImdldCIsCiAgICBtaW46IDEsCiAgICBzdGFja0RlbHRhOiAwCiAgfSwgewogICAgaWQ6ICJpZmVsc2UiLAogICAgbWluOiA0LAogICAgc3RhY2tEZWx0YTogLTMKICB9LCB7CiAgICBpZDogInJhbmRvbSIsCiAgICBtaW46IDAsCiAgICBzdGFja0RlbHRhOiAxCiAgfSwgewogICAgaWQ6ICJtdWwiLAogICAgbWluOiAyLAogICAgc3RhY2tEZWx0YTogLTEsCiAgICBzdGFja0ZuOiBmdW5jdGlvbiBzdGFja19kaXYoc3RhY2ssIGluZGV4KSB7CiAgICAgIHN0YWNrW2luZGV4IC0gMl0gPSBzdGFja1tpbmRleCAtIDJdICogc3RhY2tbaW5kZXggLSAxXTsKICAgIH0KICB9LCBudWxsLCB7CiAgICBpZDogInNxcnQiLAogICAgbWluOiAxLAogICAgc3RhY2tEZWx0YTogMAogIH0sIHsKICAgIGlkOiAiZHVwIiwKICAgIG1pbjogMSwKICAgIHN0YWNrRGVsdGE6IDEKICB9LCB7CiAgICBpZDogImV4Y2giLAogICAgbWluOiAyLAogICAgc3RhY2tEZWx0YTogMAogIH0sIHsKICAgIGlkOiAiaW5kZXgiLAogICAgbWluOiAyLAogICAgc3RhY2tEZWx0YTogMAogIH0sIHsKICAgIGlkOiAicm9sbCIsCiAgICBtaW46IDMsCiAgICBzdGFja0RlbHRhOiAtMgogIH0sIG51bGwsIG51bGwsIG51bGwsIHsKICAgIGlkOiAiaGZsZXgiLAogICAgbWluOiA3LAogICAgcmVzZXRTdGFjazogdHJ1ZQogIH0sIHsKICAgIGlkOiAiZmxleCIsCiAgICBtaW46IDEzLAogICAgcmVzZXRTdGFjazogdHJ1ZQogIH0sIHsKICAgIGlkOiAiaGZsZXgxIiwKICAgIG1pbjogOSwKICAgIHJlc2V0U3RhY2s6IHRydWUKICB9LCB7CiAgICBpZDogImZsZXgxIiwKICAgIG1pbjogMTEsCiAgICByZXNldFN0YWNrOiB0cnVlCiAgfV07CgogIGZ1bmN0aW9uIENGRlBhcnNlcihmaWxlLCBwcm9wZXJ0aWVzLCBzZWFjQW5hbHlzaXNFbmFibGVkKSB7CiAgICB0aGlzLmJ5dGVzID0gZmlsZS5nZXRCeXRlcygpOwogICAgdGhpcy5wcm9wZXJ0aWVzID0gcHJvcGVydGllczsKICAgIHRoaXMuc2VhY0FuYWx5c2lzRW5hYmxlZCA9ICEhc2VhY0FuYWx5c2lzRW5hYmxlZDsKICB9CgogIENGRlBhcnNlci5wcm90b3R5cGUgPSB7CiAgICBwYXJzZTogZnVuY3Rpb24gQ0ZGUGFyc2VyX3BhcnNlKCkgewogICAgICB2YXIgcHJvcGVydGllcyA9IHRoaXMucHJvcGVydGllczsKICAgICAgdmFyIGNmZiA9IG5ldyBDRkYoKTsKICAgICAgdGhpcy5jZmYgPSBjZmY7CiAgICAgIHZhciBoZWFkZXIgPSB0aGlzLnBhcnNlSGVhZGVyKCk7CiAgICAgIHZhciBuYW1lSW5kZXggPSB0aGlzLnBhcnNlSW5kZXgoaGVhZGVyLmVuZFBvcyk7CiAgICAgIHZhciB0b3BEaWN0SW5kZXggPSB0aGlzLnBhcnNlSW5kZXgobmFtZUluZGV4LmVuZFBvcyk7CiAgICAgIHZhciBzdHJpbmdJbmRleCA9IHRoaXMucGFyc2VJbmRleCh0b3BEaWN0SW5kZXguZW5kUG9zKTsKICAgICAgdmFyIGdsb2JhbFN1YnJJbmRleCA9IHRoaXMucGFyc2VJbmRleChzdHJpbmdJbmRleC5lbmRQb3MpOwogICAgICB2YXIgdG9wRGljdFBhcnNlZCA9IHRoaXMucGFyc2VEaWN0KHRvcERpY3RJbmRleC5vYmouZ2V0KDApKTsKICAgICAgdmFyIHRvcERpY3QgPSB0aGlzLmNyZWF0ZURpY3QoQ0ZGVG9wRGljdCwgdG9wRGljdFBhcnNlZCwgY2ZmLnN0cmluZ3MpOwogICAgICBjZmYuaGVhZGVyID0gaGVhZGVyLm9iajsKICAgICAgY2ZmLm5hbWVzID0gdGhpcy5wYXJzZU5hbWVJbmRleChuYW1lSW5kZXgub2JqKTsKICAgICAgY2ZmLnN0cmluZ3MgPSB0aGlzLnBhcnNlU3RyaW5nSW5kZXgoc3RyaW5nSW5kZXgub2JqKTsKICAgICAgY2ZmLnRvcERpY3QgPSB0b3BEaWN0OwogICAgICBjZmYuZ2xvYmFsU3VickluZGV4ID0gZ2xvYmFsU3VickluZGV4Lm9iajsKICAgICAgdGhpcy5wYXJzZVByaXZhdGVEaWN0KGNmZi50b3BEaWN0KTsKICAgICAgY2ZmLmlzQ0lERm9udCA9IHRvcERpY3QuaGFzTmFtZSgiUk9TIik7CiAgICAgIHZhciBjaGFyU3RyaW5nT2Zmc2V0ID0gdG9wRGljdC5nZXRCeU5hbWUoIkNoYXJTdHJpbmdzIik7CiAgICAgIHZhciBjaGFyU3RyaW5nSW5kZXggPSB0aGlzLnBhcnNlSW5kZXgoY2hhclN0cmluZ09mZnNldCkub2JqOwogICAgICB2YXIgZm9udE1hdHJpeCA9IHRvcERpY3QuZ2V0QnlOYW1lKCJGb250TWF0cml4Iik7CgogICAgICBpZiAoZm9udE1hdHJpeCkgewogICAgICAgIHByb3BlcnRpZXMuZm9udE1hdHJpeCA9IGZvbnRNYXRyaXg7CiAgICAgIH0KCiAgICAgIHZhciBmb250QkJveCA9IHRvcERpY3QuZ2V0QnlOYW1lKCJGb250QkJveCIpOwoKICAgICAgaWYgKGZvbnRCQm94KSB7CiAgICAgICAgcHJvcGVydGllcy5hc2NlbnQgPSBNYXRoLm1heChmb250QkJveFszXSwgZm9udEJCb3hbMV0pOwogICAgICAgIHByb3BlcnRpZXMuZGVzY2VudCA9IE1hdGgubWluKGZvbnRCQm94WzFdLCBmb250QkJveFszXSk7CiAgICAgICAgcHJvcGVydGllcy5hc2NlbnRTY2FsZWQgPSB0cnVlOwogICAgICB9CgogICAgICB2YXIgY2hhcnNldCwgZW5jb2Rpbmc7CgogICAgICBpZiAoY2ZmLmlzQ0lERm9udCkgewogICAgICAgIHZhciBmZEFycmF5SW5kZXggPSB0aGlzLnBhcnNlSW5kZXgodG9wRGljdC5nZXRCeU5hbWUoIkZEQXJyYXkiKSkub2JqOwoKICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBmZEFycmF5SW5kZXguY291bnQ7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgICB2YXIgZGljdFJhdyA9IGZkQXJyYXlJbmRleC5nZXQoaSk7CiAgICAgICAgICB2YXIgZm9udERpY3QgPSB0aGlzLmNyZWF0ZURpY3QoQ0ZGVG9wRGljdCwgdGhpcy5wYXJzZURpY3QoZGljdFJhdyksIGNmZi5zdHJpbmdzKTsKICAgICAgICAgIHRoaXMucGFyc2VQcml2YXRlRGljdChmb250RGljdCk7CiAgICAgICAgICBjZmYuZmRBcnJheS5wdXNoKGZvbnREaWN0KTsKICAgICAgICB9CgogICAgICAgIGVuY29kaW5nID0gbnVsbDsKICAgICAgICBjaGFyc2V0ID0gdGhpcy5wYXJzZUNoYXJzZXRzKHRvcERpY3QuZ2V0QnlOYW1lKCJjaGFyc2V0IiksIGNoYXJTdHJpbmdJbmRleC5jb3VudCwgY2ZmLnN0cmluZ3MsIHRydWUpOwogICAgICAgIGNmZi5mZFNlbGVjdCA9IHRoaXMucGFyc2VGRFNlbGVjdCh0b3BEaWN0LmdldEJ5TmFtZSgiRkRTZWxlY3QiKSwgY2hhclN0cmluZ0luZGV4LmNvdW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaGFyc2V0ID0gdGhpcy5wYXJzZUNoYXJzZXRzKHRvcERpY3QuZ2V0QnlOYW1lKCJjaGFyc2V0IiksIGNoYXJTdHJpbmdJbmRleC5jb3VudCwgY2ZmLnN0cmluZ3MsIGZhbHNlKTsKICAgICAgICBlbmNvZGluZyA9IHRoaXMucGFyc2VFbmNvZGluZyh0b3BEaWN0LmdldEJ5TmFtZSgiRW5jb2RpbmciKSwgcHJvcGVydGllcywgY2ZmLnN0cmluZ3MsIGNoYXJzZXQuY2hhcnNldCk7CiAgICAgIH0KCiAgICAgIGNmZi5jaGFyc2V0ID0gY2hhcnNldDsKICAgICAgY2ZmLmVuY29kaW5nID0gZW5jb2Rpbmc7CiAgICAgIHZhciBjaGFyU3RyaW5nc0FuZFNlYWNzID0gdGhpcy5wYXJzZUNoYXJTdHJpbmdzKHsKICAgICAgICBjaGFyU3RyaW5nczogY2hhclN0cmluZ0luZGV4LAogICAgICAgIGxvY2FsU3VickluZGV4OiB0b3BEaWN0LnByaXZhdGVEaWN0LnN1YnJzSW5kZXgsCiAgICAgICAgZ2xvYmFsU3VickluZGV4OiBnbG9iYWxTdWJySW5kZXgub2JqLAogICAgICAgIGZkU2VsZWN0OiBjZmYuZmRTZWxlY3QsCiAgICAgICAgZmRBcnJheTogY2ZmLmZkQXJyYXksCiAgICAgICAgcHJpdmF0ZURpY3Q6IHRvcERpY3QucHJpdmF0ZURpY3QKICAgICAgfSk7CiAgICAgIGNmZi5jaGFyU3RyaW5ncyA9IGNoYXJTdHJpbmdzQW5kU2VhY3MuY2hhclN0cmluZ3M7CiAgICAgIGNmZi5zZWFjcyA9IGNoYXJTdHJpbmdzQW5kU2VhY3Muc2VhY3M7CiAgICAgIGNmZi53aWR0aHMgPSBjaGFyU3RyaW5nc0FuZFNlYWNzLndpZHRoczsKICAgICAgcmV0dXJuIGNmZjsKICAgIH0sCiAgICBwYXJzZUhlYWRlcjogZnVuY3Rpb24gQ0ZGUGFyc2VyX3BhcnNlSGVhZGVyKCkgewogICAgICB2YXIgYnl0ZXMgPSB0aGlzLmJ5dGVzOwogICAgICB2YXIgYnl0ZXNMZW5ndGggPSBieXRlcy5sZW5ndGg7CiAgICAgIHZhciBvZmZzZXQgPSAwOwoKICAgICAgd2hpbGUgKG9mZnNldCA8IGJ5dGVzTGVuZ3RoICYmIGJ5dGVzW29mZnNldF0gIT09IDEpIHsKICAgICAgICArK29mZnNldDsKICAgICAgfQoKICAgICAgaWYgKG9mZnNldCA+PSBieXRlc0xlbmd0aCkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBDRkYgaGVhZGVyIik7CiAgICAgIH0KCiAgICAgIGlmIChvZmZzZXQgIT09IDApIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoImNmZiBkYXRhIGlzIHNoaWZ0ZWQiKTsKICAgICAgICBieXRlcyA9IGJ5dGVzLnN1YmFycmF5KG9mZnNldCk7CiAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwogICAgICB9CgogICAgICB2YXIgbWFqb3IgPSBieXRlc1swXTsKICAgICAgdmFyIG1pbm9yID0gYnl0ZXNbMV07CiAgICAgIHZhciBoZHJTaXplID0gYnl0ZXNbMl07CiAgICAgIHZhciBvZmZTaXplID0gYnl0ZXNbM107CiAgICAgIHZhciBoZWFkZXIgPSBuZXcgQ0ZGSGVhZGVyKG1ham9yLCBtaW5vciwgaGRyU2l6ZSwgb2ZmU2l6ZSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgb2JqOiBoZWFkZXIsCiAgICAgICAgZW5kUG9zOiBoZHJTaXplCiAgICAgIH07CiAgICB9LAogICAgcGFyc2VEaWN0OiBmdW5jdGlvbiBDRkZQYXJzZXJfcGFyc2VEaWN0KGRpY3QpIHsKICAgICAgdmFyIHBvcyA9IDA7CgogICAgICBmdW5jdGlvbiBwYXJzZU9wZXJhbmQoKSB7CiAgICAgICAgdmFyIHZhbHVlID0gZGljdFtwb3MrK107CgogICAgICAgIGlmICh2YWx1ZSA9PT0gMzApIHsKICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0T3BlcmFuZCgpOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IDI4KSB7CiAgICAgICAgICB2YWx1ZSA9IGRpY3RbcG9zKytdOwogICAgICAgICAgdmFsdWUgPSAodmFsdWUgPDwgMjQgfCBkaWN0W3BvcysrXSA8PCAxNikgPj4gMTY7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMjkpIHsKICAgICAgICAgIHZhbHVlID0gZGljdFtwb3MrK107CiAgICAgICAgICB2YWx1ZSA9IHZhbHVlIDw8IDggfCBkaWN0W3BvcysrXTsKICAgICAgICAgIHZhbHVlID0gdmFsdWUgPDwgOCB8IGRpY3RbcG9zKytdOwogICAgICAgICAgdmFsdWUgPSB2YWx1ZSA8PCA4IHwgZGljdFtwb3MrK107CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAzMiAmJiB2YWx1ZSA8PSAyNDYpIHsKICAgICAgICAgIHJldHVybiB2YWx1ZSAtIDEzOTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID49IDI0NyAmJiB2YWx1ZSA8PSAyNTApIHsKICAgICAgICAgIHJldHVybiAodmFsdWUgLSAyNDcpICogMjU2ICsgZGljdFtwb3MrK10gKyAxMDg7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAyNTEgJiYgdmFsdWUgPD0gMjU0KSB7CiAgICAgICAgICByZXR1cm4gLSgodmFsdWUgLSAyNTEpICogMjU2KSAtIGRpY3RbcG9zKytdIC0gMTA4OwogICAgICAgIH0KCiAgICAgICAgKDAsIF91dGlsLndhcm4pKCdDRkZQYXJzZXJfcGFyc2VEaWN0OiAiJyArIHZhbHVlICsgJyIgaXMgYSByZXNlcnZlZCBjb21tYW5kLicpOwogICAgICAgIHJldHVybiBOYU47CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHBhcnNlRmxvYXRPcGVyYW5kKCkgewogICAgICAgIHZhciBzdHIgPSAiIjsKICAgICAgICB2YXIgZW9mID0gMTU7CiAgICAgICAgdmFyIGxvb2t1cCA9IFsiMCIsICIxIiwgIjIiLCAiMyIsICI0IiwgIjUiLCAiNiIsICI3IiwgIjgiLCAiOSIsICIuIiwgIkUiLCAiRS0iLCBudWxsLCAiLSJdOwogICAgICAgIHZhciBsZW5ndGggPSBkaWN0Lmxlbmd0aDsKCiAgICAgICAgd2hpbGUgKHBvcyA8IGxlbmd0aCkgewogICAgICAgICAgdmFyIGIgPSBkaWN0W3BvcysrXTsKICAgICAgICAgIHZhciBiMSA9IGIgPj4gNDsKICAgICAgICAgIHZhciBiMiA9IGIgJiAxNTsKCiAgICAgICAgICBpZiAoYjEgPT09IGVvZikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHIgKz0gbG9va3VwW2IxXTsKCiAgICAgICAgICBpZiAoYjIgPT09IGVvZikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBzdHIgKz0gbG9va3VwW2IyXTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHN0cik7CiAgICAgIH0KCiAgICAgIHZhciBvcGVyYW5kcyA9IFtdOwogICAgICB2YXIgZW50cmllcyA9IFtdOwogICAgICBwb3MgPSAwOwogICAgICB2YXIgZW5kID0gZGljdC5sZW5ndGg7CgogICAgICB3aGlsZSAocG9zIDwgZW5kKSB7CiAgICAgICAgdmFyIGIgPSBkaWN0W3Bvc107CgogICAgICAgIGlmIChiIDw9IDIxKSB7CiAgICAgICAgICBpZiAoYiA9PT0gMTIpIHsKICAgICAgICAgICAgYiA9IGIgPDwgOCB8IGRpY3RbKytwb3NdOwogICAgICAgICAgfQoKICAgICAgICAgIGVudHJpZXMucHVzaChbYiwgb3BlcmFuZHNdKTsKICAgICAgICAgIG9wZXJhbmRzID0gW107CiAgICAgICAgICArK3BvczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgb3BlcmFuZHMucHVzaChwYXJzZU9wZXJhbmQoKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gZW50cmllczsKICAgIH0sCiAgICBwYXJzZUluZGV4OiBmdW5jdGlvbiBDRkZQYXJzZXJfcGFyc2VJbmRleChwb3MpIHsKICAgICAgdmFyIGNmZkluZGV4ID0gbmV3IENGRkluZGV4KCk7CiAgICAgIHZhciBieXRlcyA9IHRoaXMuYnl0ZXM7CiAgICAgIHZhciBjb3VudCA9IGJ5dGVzW3BvcysrXSA8PCA4IHwgYnl0ZXNbcG9zKytdOwogICAgICB2YXIgb2Zmc2V0cyA9IFtdOwogICAgICB2YXIgZW5kID0gcG9zOwogICAgICB2YXIgaSwgaWk7CgogICAgICBpZiAoY291bnQgIT09IDApIHsKICAgICAgICB2YXIgb2Zmc2V0U2l6ZSA9IGJ5dGVzW3BvcysrXTsKICAgICAgICB2YXIgc3RhcnRQb3MgPSBwb3MgKyAoY291bnQgKyAxKSAqIG9mZnNldFNpemUgLSAxOwoKICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IGNvdW50ICsgMTsgaSA8IGlpOyArK2kpIHsKICAgICAgICAgIHZhciBvZmZzZXQgPSAwOwoKICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgb2Zmc2V0U2l6ZTsgKytqKSB7CiAgICAgICAgICAgIG9mZnNldCA8PD0gODsKICAgICAgICAgICAgb2Zmc2V0ICs9IGJ5dGVzW3BvcysrXTsKICAgICAgICAgIH0KCiAgICAgICAgICBvZmZzZXRzLnB1c2goc3RhcnRQb3MgKyBvZmZzZXQpOwogICAgICAgIH0KCiAgICAgICAgZW5kID0gb2Zmc2V0c1tjb3VudF07CiAgICAgIH0KCiAgICAgIGZvciAoaSA9IDAsIGlpID0gb2Zmc2V0cy5sZW5ndGggLSAxOyBpIDwgaWk7ICsraSkgewogICAgICAgIHZhciBvZmZzZXRTdGFydCA9IG9mZnNldHNbaV07CiAgICAgICAgdmFyIG9mZnNldEVuZCA9IG9mZnNldHNbaSArIDFdOwogICAgICAgIGNmZkluZGV4LmFkZChieXRlcy5zdWJhcnJheShvZmZzZXRTdGFydCwgb2Zmc2V0RW5kKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgb2JqOiBjZmZJbmRleCwKICAgICAgICBlbmRQb3M6IGVuZAogICAgICB9OwogICAgfSwKICAgIHBhcnNlTmFtZUluZGV4OiBmdW5jdGlvbiBDRkZQYXJzZXJfcGFyc2VOYW1lSW5kZXgoaW5kZXgpIHsKICAgICAgdmFyIG5hbWVzID0gW107CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBpbmRleC5jb3VudDsgaSA8IGlpOyArK2kpIHsKICAgICAgICB2YXIgbmFtZSA9IGluZGV4LmdldChpKTsKICAgICAgICBuYW1lcy5wdXNoKCgwLCBfdXRpbC5ieXRlc1RvU3RyaW5nKShuYW1lKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBuYW1lczsKICAgIH0sCiAgICBwYXJzZVN0cmluZ0luZGV4OiBmdW5jdGlvbiBDRkZQYXJzZXJfcGFyc2VTdHJpbmdJbmRleChpbmRleCkgewogICAgICB2YXIgc3RyaW5ncyA9IG5ldyBDRkZTdHJpbmdzKCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBpbmRleC5jb3VudDsgaSA8IGlpOyArK2kpIHsKICAgICAgICB2YXIgZGF0YSA9IGluZGV4LmdldChpKTsKICAgICAgICBzdHJpbmdzLmFkZCgoMCwgX3V0aWwuYnl0ZXNUb1N0cmluZykoZGF0YSkpOwogICAgICB9CgogICAgICByZXR1cm4gc3RyaW5nczsKICAgIH0sCiAgICBjcmVhdGVEaWN0OiBmdW5jdGlvbiBDRkZQYXJzZXJfY3JlYXRlRGljdChUeXBlLCBkaWN0LCBzdHJpbmdzKSB7CiAgICAgIHZhciBjZmZEaWN0ID0gbmV3IFR5cGUoc3RyaW5ncyk7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBkaWN0Lmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICB2YXIgcGFpciA9IGRpY3RbaV07CiAgICAgICAgdmFyIGtleSA9IHBhaXJbMF07CiAgICAgICAgdmFyIHZhbHVlID0gcGFpclsxXTsKICAgICAgICBjZmZEaWN0LnNldEJ5S2V5KGtleSwgdmFsdWUpOwogICAgICB9CgogICAgICByZXR1cm4gY2ZmRGljdDsKICAgIH0sCiAgICBwYXJzZUNoYXJTdHJpbmc6IGZ1bmN0aW9uIENGRlBhcnNlcl9wYXJzZUNoYXJTdHJpbmcoc3RhdGUsIGRhdGEsIGxvY2FsU3VickluZGV4LCBnbG9iYWxTdWJySW5kZXgpIHsKICAgICAgaWYgKCFkYXRhIHx8IHN0YXRlLmNhbGxEZXB0aCA+IE1BWF9TVUJSX05FU1RJTkcpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBzdGFja1NpemUgPSBzdGF0ZS5zdGFja1NpemU7CiAgICAgIHZhciBzdGFjayA9IHN0YXRlLnN0YWNrOwogICAgICB2YXIgbGVuZ3RoID0gZGF0YS5sZW5ndGg7CgogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxlbmd0aDspIHsKICAgICAgICB2YXIgdmFsdWUgPSBkYXRhW2orK107CiAgICAgICAgdmFyIHZhbGlkYXRpb25Db21tYW5kID0gbnVsbDsKCiAgICAgICAgaWYgKHZhbHVlID09PSAxMikgewogICAgICAgICAgdmFyIHEgPSBkYXRhW2orK107CgogICAgICAgICAgaWYgKHEgPT09IDApIHsKICAgICAgICAgICAgZGF0YVtqIC0gMl0gPSAxMzk7CiAgICAgICAgICAgIGRhdGFbaiAtIDFdID0gMjI7CiAgICAgICAgICAgIHN0YWNrU2l6ZSA9IDA7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YWxpZGF0aW9uQ29tbWFuZCA9IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YTEyW3FdOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IDI4KSB7CiAgICAgICAgICBzdGFja1tzdGFja1NpemVdID0gKGRhdGFbal0gPDwgMjQgfCBkYXRhW2ogKyAxXSA8PCAxNikgPj4gMTY7CiAgICAgICAgICBqICs9IDI7CiAgICAgICAgICBzdGFja1NpemUrKzsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAxNCkgewogICAgICAgICAgaWYgKHN0YWNrU2l6ZSA+PSA0KSB7CiAgICAgICAgICAgIHN0YWNrU2l6ZSAtPSA0OwoKICAgICAgICAgICAgaWYgKHRoaXMuc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgICAgICAgICAgIHN0YXRlLnNlYWMgPSBzdGFjay5zbGljZShzdGFja1NpemUsIHN0YWNrU2l6ZSArIDQpOwogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHZhbGlkYXRpb25Db21tYW5kID0gQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhW3ZhbHVlXTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID49IDMyICYmIHZhbHVlIDw9IDI0NikgewogICAgICAgICAgc3RhY2tbc3RhY2tTaXplXSA9IHZhbHVlIC0gMTM5OwogICAgICAgICAgc3RhY2tTaXplKys7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAyNDcgJiYgdmFsdWUgPD0gMjU0KSB7CiAgICAgICAgICBzdGFja1tzdGFja1NpemVdID0gdmFsdWUgPCAyNTEgPyAodmFsdWUgLSAyNDcgPDwgOCkgKyBkYXRhW2pdICsgMTA4IDogLSh2YWx1ZSAtIDI1MSA8PCA4KSAtIGRhdGFbal0gLSAxMDg7CiAgICAgICAgICBqKys7CiAgICAgICAgICBzdGFja1NpemUrKzsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAyNTUpIHsKICAgICAgICAgIHN0YWNrW3N0YWNrU2l6ZV0gPSAoZGF0YVtqXSA8PCAyNCB8IGRhdGFbaiArIDFdIDw8IDE2IHwgZGF0YVtqICsgMl0gPDwgOCB8IGRhdGFbaiArIDNdKSAvIDY1NTM2OwogICAgICAgICAgaiArPSA0OwogICAgICAgICAgc3RhY2tTaXplKys7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMTkgfHwgdmFsdWUgPT09IDIwKSB7CiAgICAgICAgICBzdGF0ZS5oaW50cyArPSBzdGFja1NpemUgPj4gMTsKICAgICAgICAgIGogKz0gc3RhdGUuaGludHMgKyA3ID4+IDM7CiAgICAgICAgICBzdGFja1NpemUgJT0gMjsKICAgICAgICAgIHZhbGlkYXRpb25Db21tYW5kID0gQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhW3ZhbHVlXTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAxMCB8fCB2YWx1ZSA9PT0gMjkpIHsKICAgICAgICAgIHZhciBzdWJyc0luZGV4OwoKICAgICAgICAgIGlmICh2YWx1ZSA9PT0gMTApIHsKICAgICAgICAgICAgc3VicnNJbmRleCA9IGxvY2FsU3VickluZGV4OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3VicnNJbmRleCA9IGdsb2JhbFN1YnJJbmRleDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIXN1YnJzSW5kZXgpIHsKICAgICAgICAgICAgdmFsaWRhdGlvbkNvbW1hbmQgPSBDaGFyc3RyaW5nVmFsaWRhdGlvbkRhdGFbdmFsdWVdOwogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIk1pc3Npbmcgc3VicnNJbmRleCBmb3IgIiArIHZhbGlkYXRpb25Db21tYW5kLmlkKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBiaWFzID0gMzI3Njg7CgogICAgICAgICAgaWYgKHN1YnJzSW5kZXguY291bnQgPCAxMjQwKSB7CiAgICAgICAgICAgIGJpYXMgPSAxMDc7CiAgICAgICAgICB9IGVsc2UgaWYgKHN1YnJzSW5kZXguY291bnQgPCAzMzkwMCkgewogICAgICAgICAgICBiaWFzID0gMTEzMTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgc3Vick51bWJlciA9IHN0YWNrWy0tc3RhY2tTaXplXSArIGJpYXM7CgogICAgICAgICAgaWYgKHN1YnJOdW1iZXIgPCAwIHx8IHN1YnJOdW1iZXIgPj0gc3VicnNJbmRleC5jb3VudCB8fCBpc05hTihzdWJyTnVtYmVyKSkgewogICAgICAgICAgICB2YWxpZGF0aW9uQ29tbWFuZCA9IENoYXJzdHJpbmdWYWxpZGF0aW9uRGF0YVt2YWx1ZV07CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiT3V0IG9mIGJvdW5kcyBzdWJySW5kZXggZm9yICIgKyB2YWxpZGF0aW9uQ29tbWFuZC5pZCk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzdGF0ZS5zdGFja1NpemUgPSBzdGFja1NpemU7CiAgICAgICAgICBzdGF0ZS5jYWxsRGVwdGgrKzsKICAgICAgICAgIHZhciB2YWxpZCA9IHRoaXMucGFyc2VDaGFyU3RyaW5nKHN0YXRlLCBzdWJyc0luZGV4LmdldChzdWJyTnVtYmVyKSwgbG9jYWxTdWJySW5kZXgsIGdsb2JhbFN1YnJJbmRleCk7CgogICAgICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgc3RhdGUuY2FsbERlcHRoLS07CiAgICAgICAgICBzdGFja1NpemUgPSBzdGF0ZS5zdGFja1NpemU7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAxMSkgewogICAgICAgICAgc3RhdGUuc3RhY2tTaXplID0gc3RhY2tTaXplOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhbGlkYXRpb25Db21tYW5kID0gQ2hhcnN0cmluZ1ZhbGlkYXRpb25EYXRhW3ZhbHVlXTsKICAgICAgICB9CgogICAgICAgIGlmICh2YWxpZGF0aW9uQ29tbWFuZCkgewogICAgICAgICAgaWYgKHZhbGlkYXRpb25Db21tYW5kLnN0ZW0pIHsKICAgICAgICAgICAgc3RhdGUuaGludHMgKz0gc3RhY2tTaXplID4+IDE7CgogICAgICAgICAgICBpZiAodmFsdWUgPT09IDMgfHwgdmFsdWUgPT09IDIzKSB7CiAgICAgICAgICAgICAgc3RhdGUuaGFzVlN0ZW1zID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZS5oYXNWU3RlbXMgJiYgKHZhbHVlID09PSAxIHx8IHZhbHVlID09PSAxOCkpIHsKICAgICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkNGRiBzdGVtIGhpbnRzIGFyZSBpbiB3cm9uZyBvcmRlciIpOwogICAgICAgICAgICAgIGRhdGFbaiAtIDFdID0gdmFsdWUgPT09IDEgPyAzIDogMjM7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIm1pbiIgaW4gdmFsaWRhdGlvbkNvbW1hbmQpIHsKICAgICAgICAgICAgaWYgKCFzdGF0ZS51bmRlZlN0YWNrICYmIHN0YWNrU2l6ZSA8IHZhbGlkYXRpb25Db21tYW5kLm1pbikgewogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiTm90IGVub3VnaCBwYXJhbWV0ZXJzIGZvciAiICsgdmFsaWRhdGlvbkNvbW1hbmQuaWQgKyAiOyBhY3R1YWw6ICIgKyBzdGFja1NpemUgKyAiLCBleHBlY3RlZDogIiArIHZhbGlkYXRpb25Db21tYW5kLm1pbik7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHN0YXRlLmZpcnN0U3RhY2tDbGVhcmluZyAmJiB2YWxpZGF0aW9uQ29tbWFuZC5zdGFja0NsZWFyaW5nKSB7CiAgICAgICAgICAgIHN0YXRlLmZpcnN0U3RhY2tDbGVhcmluZyA9IGZhbHNlOwogICAgICAgICAgICBzdGFja1NpemUgLT0gdmFsaWRhdGlvbkNvbW1hbmQubWluOwoKICAgICAgICAgICAgaWYgKHN0YWNrU2l6ZSA+PSAyICYmIHZhbGlkYXRpb25Db21tYW5kLnN0ZW0pIHsKICAgICAgICAgICAgICBzdGFja1NpemUgJT0gMjsKICAgICAgICAgICAgfSBlbHNlIGlmIChzdGFja1NpemUgPiAxKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJGb3VuZCB0b28gbWFueSBwYXJhbWV0ZXJzIGZvciBzdGFjay1jbGVhcmluZyBjb21tYW5kIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzdGFja1NpemUgPiAwICYmIHN0YWNrW3N0YWNrU2l6ZSAtIDFdID49IDApIHsKICAgICAgICAgICAgICBzdGF0ZS53aWR0aCA9IHN0YWNrW3N0YWNrU2l6ZSAtIDFdOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCJzdGFja0RlbHRhIiBpbiB2YWxpZGF0aW9uQ29tbWFuZCkgewogICAgICAgICAgICBpZiAoInN0YWNrRm4iIGluIHZhbGlkYXRpb25Db21tYW5kKSB7CiAgICAgICAgICAgICAgdmFsaWRhdGlvbkNvbW1hbmQuc3RhY2tGbihzdGFjaywgc3RhY2tTaXplKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3RhY2tTaXplICs9IHZhbGlkYXRpb25Db21tYW5kLnN0YWNrRGVsdGE7CiAgICAgICAgICB9IGVsc2UgaWYgKHZhbGlkYXRpb25Db21tYW5kLnN0YWNrQ2xlYXJpbmcpIHsKICAgICAgICAgICAgc3RhY2tTaXplID0gMDsKICAgICAgICAgIH0gZWxzZSBpZiAodmFsaWRhdGlvbkNvbW1hbmQucmVzZXRTdGFjaykgewogICAgICAgICAgICBzdGFja1NpemUgPSAwOwogICAgICAgICAgICBzdGF0ZS51bmRlZlN0YWNrID0gZmFsc2U7CiAgICAgICAgICB9IGVsc2UgaWYgKHZhbGlkYXRpb25Db21tYW5kLnVuZGVmU3RhY2spIHsKICAgICAgICAgICAgc3RhY2tTaXplID0gMDsKICAgICAgICAgICAgc3RhdGUudW5kZWZTdGFjayA9IHRydWU7CiAgICAgICAgICAgIHN0YXRlLmZpcnN0U3RhY2tDbGVhcmluZyA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgc3RhdGUuc3RhY2tTaXplID0gc3RhY2tTaXplOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICBwYXJzZUNoYXJTdHJpbmdzOiBmdW5jdGlvbiBwYXJzZUNoYXJTdHJpbmdzKF9yZWYpIHsKICAgICAgdmFyIGNoYXJTdHJpbmdzID0gX3JlZi5jaGFyU3RyaW5ncywKICAgICAgICAgIGxvY2FsU3VickluZGV4ID0gX3JlZi5sb2NhbFN1YnJJbmRleCwKICAgICAgICAgIGdsb2JhbFN1YnJJbmRleCA9IF9yZWYuZ2xvYmFsU3VickluZGV4LAogICAgICAgICAgZmRTZWxlY3QgPSBfcmVmLmZkU2VsZWN0LAogICAgICAgICAgZmRBcnJheSA9IF9yZWYuZmRBcnJheSwKICAgICAgICAgIHByaXZhdGVEaWN0ID0gX3JlZi5wcml2YXRlRGljdDsKICAgICAgdmFyIHNlYWNzID0gW107CiAgICAgIHZhciB3aWR0aHMgPSBbXTsKICAgICAgdmFyIGNvdW50ID0gY2hhclN0cmluZ3MuY291bnQ7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICB2YXIgY2hhcnN0cmluZyA9IGNoYXJTdHJpbmdzLmdldChpKTsKICAgICAgICB2YXIgc3RhdGUgPSB7CiAgICAgICAgICBjYWxsRGVwdGg6IDAsCiAgICAgICAgICBzdGFja1NpemU6IDAsCiAgICAgICAgICBzdGFjazogW10sCiAgICAgICAgICB1bmRlZlN0YWNrOiB0cnVlLAogICAgICAgICAgaGludHM6IDAsCiAgICAgICAgICBmaXJzdFN0YWNrQ2xlYXJpbmc6IHRydWUsCiAgICAgICAgICBzZWFjOiBudWxsLAogICAgICAgICAgd2lkdGg6IG51bGwsCiAgICAgICAgICBoYXNWU3RlbXM6IGZhbHNlCiAgICAgICAgfTsKICAgICAgICB2YXIgdmFsaWQgPSB0cnVlOwogICAgICAgIHZhciBsb2NhbFN1YnJUb1VzZSA9IG51bGw7CiAgICAgICAgdmFyIHByaXZhdGVEaWN0VG9Vc2UgPSBwcml2YXRlRGljdDsKCiAgICAgICAgaWYgKGZkU2VsZWN0ICYmIGZkQXJyYXkubGVuZ3RoKSB7CiAgICAgICAgICB2YXIgZmRJbmRleCA9IGZkU2VsZWN0LmdldEZESW5kZXgoaSk7CgogICAgICAgICAgaWYgKGZkSW5kZXggPT09IC0xKSB7CiAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiR2x5cGggaW5kZXggaXMgbm90IGluIGZkIHNlbGVjdC4iKTsKICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZmRJbmRleCA+PSBmZEFycmF5Lmxlbmd0aCkgewogICAgICAgICAgICAoMCwgX3V0aWwud2FybikoIkludmFsaWQgZmQgaW5kZXggZm9yIGdseXBoIGluZGV4LiIpOwogICAgICAgICAgICB2YWxpZCA9IGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgICBwcml2YXRlRGljdFRvVXNlID0gZmRBcnJheVtmZEluZGV4XS5wcml2YXRlRGljdDsKICAgICAgICAgICAgbG9jYWxTdWJyVG9Vc2UgPSBwcml2YXRlRGljdFRvVXNlLnN1YnJzSW5kZXg7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChsb2NhbFN1YnJJbmRleCkgewogICAgICAgICAgbG9jYWxTdWJyVG9Vc2UgPSBsb2NhbFN1YnJJbmRleDsKICAgICAgICB9CgogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdmFsaWQgPSB0aGlzLnBhcnNlQ2hhclN0cmluZyhzdGF0ZSwgY2hhcnN0cmluZywgbG9jYWxTdWJyVG9Vc2UsIGdsb2JhbFN1YnJJbmRleCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhdGUud2lkdGggIT09IG51bGwpIHsKICAgICAgICAgIHZhciBub21pbmFsV2lkdGggPSBwcml2YXRlRGljdFRvVXNlLmdldEJ5TmFtZSgibm9taW5hbFdpZHRoWCIpOwogICAgICAgICAgd2lkdGhzW2ldID0gbm9taW5hbFdpZHRoICsgc3RhdGUud2lkdGg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBkZWZhdWx0V2lkdGggPSBwcml2YXRlRGljdFRvVXNlLmdldEJ5TmFtZSgiZGVmYXVsdFdpZHRoWCIpOwogICAgICAgICAgd2lkdGhzW2ldID0gZGVmYXVsdFdpZHRoOwogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YXRlLnNlYWMgIT09IG51bGwpIHsKICAgICAgICAgIHNlYWNzW2ldID0gc3RhdGUuc2VhYzsKICAgICAgICB9CgogICAgICAgIGlmICghdmFsaWQpIHsKICAgICAgICAgIGNoYXJTdHJpbmdzLnNldChpLCBuZXcgVWludDhBcnJheShbMTRdKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIGNoYXJTdHJpbmdzOiBjaGFyU3RyaW5ncywKICAgICAgICBzZWFjczogc2VhY3MsCiAgICAgICAgd2lkdGhzOiB3aWR0aHMKICAgICAgfTsKICAgIH0sCiAgICBlbXB0eVByaXZhdGVEaWN0aW9uYXJ5OiBmdW5jdGlvbiBDRkZQYXJzZXJfZW1wdHlQcml2YXRlRGljdGlvbmFyeShwYXJlbnREaWN0KSB7CiAgICAgIHZhciBwcml2YXRlRGljdCA9IHRoaXMuY3JlYXRlRGljdChDRkZQcml2YXRlRGljdCwgW10sIHBhcmVudERpY3Quc3RyaW5ncyk7CiAgICAgIHBhcmVudERpY3Quc2V0QnlLZXkoMTgsIFswLCAwXSk7CiAgICAgIHBhcmVudERpY3QucHJpdmF0ZURpY3QgPSBwcml2YXRlRGljdDsKICAgIH0sCiAgICBwYXJzZVByaXZhdGVEaWN0OiBmdW5jdGlvbiBDRkZQYXJzZXJfcGFyc2VQcml2YXRlRGljdChwYXJlbnREaWN0KSB7CiAgICAgIGlmICghcGFyZW50RGljdC5oYXNOYW1lKCJQcml2YXRlIikpIHsKICAgICAgICB0aGlzLmVtcHR5UHJpdmF0ZURpY3Rpb25hcnkocGFyZW50RGljdCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgcHJpdmF0ZU9mZnNldCA9IHBhcmVudERpY3QuZ2V0QnlOYW1lKCJQcml2YXRlIik7CgogICAgICBpZiAoIUFycmF5LmlzQXJyYXkocHJpdmF0ZU9mZnNldCkgfHwgcHJpdmF0ZU9mZnNldC5sZW5ndGggIT09IDIpIHsKICAgICAgICBwYXJlbnREaWN0LnJlbW92ZUJ5TmFtZSgiUHJpdmF0ZSIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHNpemUgPSBwcml2YXRlT2Zmc2V0WzBdOwogICAgICB2YXIgb2Zmc2V0ID0gcHJpdmF0ZU9mZnNldFsxXTsKCiAgICAgIGlmIChzaXplID09PSAwIHx8IG9mZnNldCA+PSB0aGlzLmJ5dGVzLmxlbmd0aCkgewogICAgICAgIHRoaXMuZW1wdHlQcml2YXRlRGljdGlvbmFyeShwYXJlbnREaWN0KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBwcml2YXRlRGljdEVuZCA9IG9mZnNldCArIHNpemU7CiAgICAgIHZhciBkaWN0RGF0YSA9IHRoaXMuYnl0ZXMuc3ViYXJyYXkob2Zmc2V0LCBwcml2YXRlRGljdEVuZCk7CiAgICAgIHZhciBkaWN0ID0gdGhpcy5wYXJzZURpY3QoZGljdERhdGEpOwogICAgICB2YXIgcHJpdmF0ZURpY3QgPSB0aGlzLmNyZWF0ZURpY3QoQ0ZGUHJpdmF0ZURpY3QsIGRpY3QsIHBhcmVudERpY3Quc3RyaW5ncyk7CiAgICAgIHBhcmVudERpY3QucHJpdmF0ZURpY3QgPSBwcml2YXRlRGljdDsKCiAgICAgIGlmICghcHJpdmF0ZURpY3QuZ2V0QnlOYW1lKCJTdWJycyIpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgc3VicnNPZmZzZXQgPSBwcml2YXRlRGljdC5nZXRCeU5hbWUoIlN1YnJzIik7CiAgICAgIHZhciByZWxhdGl2ZU9mZnNldCA9IG9mZnNldCArIHN1YnJzT2Zmc2V0OwoKICAgICAgaWYgKHN1YnJzT2Zmc2V0ID09PSAwIHx8IHJlbGF0aXZlT2Zmc2V0ID49IHRoaXMuYnl0ZXMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy5lbXB0eVByaXZhdGVEaWN0aW9uYXJ5KHBhcmVudERpY3QpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHN1YnJzSW5kZXggPSB0aGlzLnBhcnNlSW5kZXgocmVsYXRpdmVPZmZzZXQpOwogICAgICBwcml2YXRlRGljdC5zdWJyc0luZGV4ID0gc3VicnNJbmRleC5vYmo7CiAgICB9LAogICAgcGFyc2VDaGFyc2V0czogZnVuY3Rpb24gQ0ZGUGFyc2VyX3BhcnNlQ2hhcnNldHMocG9zLCBsZW5ndGgsIHN0cmluZ3MsIGNpZCkgewogICAgICBpZiAocG9zID09PSAwKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDRkZDaGFyc2V0KHRydWUsIENGRkNoYXJzZXRQcmVkZWZpbmVkVHlwZXMuSVNPX0FET0JFLCBfY2hhcnNldHMuSVNPQWRvYmVDaGFyc2V0KTsKICAgICAgfSBlbHNlIGlmIChwb3MgPT09IDEpIHsKICAgICAgICByZXR1cm4gbmV3IENGRkNoYXJzZXQodHJ1ZSwgQ0ZGQ2hhcnNldFByZWRlZmluZWRUeXBlcy5FWFBFUlQsIF9jaGFyc2V0cy5FeHBlcnRDaGFyc2V0KTsKICAgICAgfSBlbHNlIGlmIChwb3MgPT09IDIpIHsKICAgICAgICByZXR1cm4gbmV3IENGRkNoYXJzZXQodHJ1ZSwgQ0ZGQ2hhcnNldFByZWRlZmluZWRUeXBlcy5FWFBFUlRfU1VCU0VULCBfY2hhcnNldHMuRXhwZXJ0U3Vic2V0Q2hhcnNldCk7CiAgICAgIH0KCiAgICAgIHZhciBieXRlcyA9IHRoaXMuYnl0ZXM7CiAgICAgIHZhciBzdGFydCA9IHBvczsKICAgICAgdmFyIGZvcm1hdCA9IGJ5dGVzW3BvcysrXTsKICAgICAgdmFyIGNoYXJzZXQgPSBbY2lkID8gMCA6ICIubm90ZGVmIl07CiAgICAgIHZhciBpZCwgY291bnQsIGk7CiAgICAgIGxlbmd0aCAtPSAxOwoKICAgICAgc3dpdGNoIChmb3JtYXQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKICAgICAgICAgICAgY2hhcnNldC5wdXNoKGNpZCA/IGlkIDogc3RyaW5ncy5nZXQoaWQpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgd2hpbGUgKGNoYXJzZXQubGVuZ3RoIDw9IGxlbmd0aCkgewogICAgICAgICAgICBpZCA9IGJ5dGVzW3BvcysrXSA8PCA4IHwgYnl0ZXNbcG9zKytdOwogICAgICAgICAgICBjb3VudCA9IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gY291bnQ7IGkrKykgewogICAgICAgICAgICAgIGNoYXJzZXQucHVzaChjaWQgPyBpZCsrIDogc3RyaW5ncy5nZXQoaWQrKykpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHdoaWxlIChjaGFyc2V0Lmxlbmd0aCA8PSBsZW5ndGgpIHsKICAgICAgICAgICAgaWQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKICAgICAgICAgICAgY291bnQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gY291bnQ7IGkrKykgewogICAgICAgICAgICAgIGNoYXJzZXQucHVzaChjaWQgPyBpZCsrIDogc3RyaW5ncy5nZXQoaWQrKykpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gY2hhcnNldCBmb3JtYXQiKTsKICAgICAgfQoKICAgICAgdmFyIGVuZCA9IHBvczsKICAgICAgdmFyIHJhdyA9IGJ5dGVzLnN1YmFycmF5KHN0YXJ0LCBlbmQpOwogICAgICByZXR1cm4gbmV3IENGRkNoYXJzZXQoZmFsc2UsIGZvcm1hdCwgY2hhcnNldCwgcmF3KTsKICAgIH0sCiAgICBwYXJzZUVuY29kaW5nOiBmdW5jdGlvbiBDRkZQYXJzZXJfcGFyc2VFbmNvZGluZyhwb3MsIHByb3BlcnRpZXMsIHN0cmluZ3MsIGNoYXJzZXQpIHsKICAgICAgdmFyIGVuY29kaW5nID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKICAgICAgdmFyIHByZWRlZmluZWQgPSBmYWxzZTsKICAgICAgdmFyIGZvcm1hdCwgaSwgaWk7CiAgICAgIHZhciByYXcgPSBudWxsOwoKICAgICAgZnVuY3Rpb24gcmVhZFN1cHBsZW1lbnQoKSB7CiAgICAgICAgdmFyIHN1cHBsZW1lbnRzQ291bnQgPSBieXRlc1twb3MrK107CgogICAgICAgIGZvciAoaSA9IDA7IGkgPCBzdXBwbGVtZW50c0NvdW50OyBpKyspIHsKICAgICAgICAgIHZhciBjb2RlID0gYnl0ZXNbcG9zKytdOwogICAgICAgICAgdmFyIHNpZCA9IChieXRlc1twb3MrK10gPDwgOCkgKyAoYnl0ZXNbcG9zKytdICYgMHhmZik7CiAgICAgICAgICBlbmNvZGluZ1tjb2RlXSA9IGNoYXJzZXQuaW5kZXhPZihzdHJpbmdzLmdldChzaWQpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChwb3MgPT09IDAgfHwgcG9zID09PSAxKSB7CiAgICAgICAgcHJlZGVmaW5lZCA9IHRydWU7CiAgICAgICAgZm9ybWF0ID0gcG9zOwogICAgICAgIHZhciBiYXNlRW5jb2RpbmcgPSBwb3MgPyBfZW5jb2RpbmdzLkV4cGVydEVuY29kaW5nIDogX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nOwoKICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IGNoYXJzZXQubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICAgICAgdmFyIGluZGV4ID0gYmFzZUVuY29kaW5nLmluZGV4T2YoY2hhcnNldFtpXSk7CgogICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgICAgICBlbmNvZGluZ1tpbmRleF0gPSBpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgZGF0YVN0YXJ0ID0gcG9zOwogICAgICAgIGZvcm1hdCA9IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgc3dpdGNoIChmb3JtYXQgJiAweDdmKSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHZhciBnbHlwaHNDb3VudCA9IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPD0gZ2x5cGhzQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIGVuY29kaW5nW2J5dGVzW3BvcysrXV0gPSBpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIHZhciByYW5nZXNDb3VudCA9IGJ5dGVzW3BvcysrXTsKICAgICAgICAgICAgdmFyIGdpZCA9IDE7CgogICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcmFuZ2VzQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIHZhciBzdGFydCA9IGJ5dGVzW3BvcysrXTsKICAgICAgICAgICAgICB2YXIgbGVmdCA9IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IHN0YXJ0OyBqIDw9IHN0YXJ0ICsgbGVmdDsgaisrKSB7CiAgICAgICAgICAgICAgICBlbmNvZGluZ1tqXSA9IGdpZCsrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIGVuY29kaW5nIGZvcm1hdDogIi5jb25jYXQoZm9ybWF0LCAiIGluIENGRiIpKTsKICAgICAgICB9CgogICAgICAgIHZhciBkYXRhRW5kID0gcG9zOwoKICAgICAgICBpZiAoZm9ybWF0ICYgMHg4MCkgewogICAgICAgICAgYnl0ZXNbZGF0YVN0YXJ0XSAmPSAweDdmOwogICAgICAgICAgcmVhZFN1cHBsZW1lbnQoKTsKICAgICAgICB9CgogICAgICAgIHJhdyA9IGJ5dGVzLnN1YmFycmF5KGRhdGFTdGFydCwgZGF0YUVuZCk7CiAgICAgIH0KCiAgICAgIGZvcm1hdCA9IGZvcm1hdCAmIDB4N2Y7CiAgICAgIHJldHVybiBuZXcgQ0ZGRW5jb2RpbmcocHJlZGVmaW5lZCwgZm9ybWF0LCBlbmNvZGluZywgcmF3KTsKICAgIH0sCiAgICBwYXJzZUZEU2VsZWN0OiBmdW5jdGlvbiBDRkZQYXJzZXJfcGFyc2VGRFNlbGVjdChwb3MsIGxlbmd0aCkgewogICAgICB2YXIgYnl0ZXMgPSB0aGlzLmJ5dGVzOwogICAgICB2YXIgZm9ybWF0ID0gYnl0ZXNbcG9zKytdOwogICAgICB2YXIgZmRTZWxlY3QgPSBbXTsKICAgICAgdmFyIGk7CgogICAgICBzd2l0Y2ggKGZvcm1hdCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgICAgICB2YXIgaWQgPSBieXRlc1twb3MrK107CiAgICAgICAgICAgIGZkU2VsZWN0LnB1c2goaWQpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICB2YXIgcmFuZ2VzQ291bnQgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcmFuZ2VzQ291bnQ7ICsraSkgewogICAgICAgICAgICB2YXIgZmlyc3QgPSBieXRlc1twb3MrK10gPDwgOCB8IGJ5dGVzW3BvcysrXTsKCiAgICAgICAgICAgIGlmIChpID09PSAwICYmIGZpcnN0ICE9PSAwKSB7CiAgICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJwYXJzZUZEU2VsZWN0OiBUaGUgZmlyc3QgcmFuZ2UgbXVzdCBoYXZlIGEgZmlyc3QgR0lEIG9mIDAiICsgIiAtLSB0cnlpbmcgdG8gcmVjb3Zlci4iKTsKICAgICAgICAgICAgICBmaXJzdCA9IDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBmZEluZGV4ID0gYnl0ZXNbcG9zKytdOwogICAgICAgICAgICB2YXIgbmV4dCA9IGJ5dGVzW3Bvc10gPDwgOCB8IGJ5dGVzW3BvcyArIDFdOwoKICAgICAgICAgICAgZm9yICh2YXIgaiA9IGZpcnN0OyBqIDwgbmV4dDsgKytqKSB7CiAgICAgICAgICAgICAgZmRTZWxlY3QucHVzaChmZEluZGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHBvcyArPSAyOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoInBhcnNlRkRTZWxlY3Q6IFVua25vd24gZm9ybWF0IFwiIi5jb25jYXQoZm9ybWF0LCAiXCIuIikpOwogICAgICB9CgogICAgICBpZiAoZmRTZWxlY3QubGVuZ3RoICE9PSBsZW5ndGgpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoInBhcnNlRkRTZWxlY3Q6IEludmFsaWQgZm9udCBkYXRhLiIpOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IENGRkZEU2VsZWN0KGZvcm1hdCwgZmRTZWxlY3QpOwogICAgfQogIH07CiAgcmV0dXJuIENGRlBhcnNlcjsKfSgpOwoKZXhwb3J0cy5DRkZQYXJzZXIgPSBDRkZQYXJzZXI7Cgp2YXIgQ0ZGID0gZnVuY3Rpb24gQ0ZGQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBDRkYoKSB7CiAgICB0aGlzLmhlYWRlciA9IG51bGw7CiAgICB0aGlzLm5hbWVzID0gW107CiAgICB0aGlzLnRvcERpY3QgPSBudWxsOwogICAgdGhpcy5zdHJpbmdzID0gbmV3IENGRlN0cmluZ3MoKTsKICAgIHRoaXMuZ2xvYmFsU3VickluZGV4ID0gbnVsbDsKICAgIHRoaXMuZW5jb2RpbmcgPSBudWxsOwogICAgdGhpcy5jaGFyc2V0ID0gbnVsbDsKICAgIHRoaXMuY2hhclN0cmluZ3MgPSBudWxsOwogICAgdGhpcy5mZEFycmF5ID0gW107CiAgICB0aGlzLmZkU2VsZWN0ID0gbnVsbDsKICAgIHRoaXMuaXNDSURGb250ID0gZmFsc2U7CiAgfQoKICBDRkYucHJvdG90eXBlID0gewogICAgZHVwbGljYXRlRmlyc3RHbHlwaDogZnVuY3Rpb24gQ0ZGX2R1cGxpY2F0ZUZpcnN0R2x5cGgoKSB7CiAgICAgIGlmICh0aGlzLmNoYXJTdHJpbmdzLmNvdW50ID49IDY1NTM1KSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJOb3QgZW5vdWdoIHNwYWNlIGluIGNoYXJzdHJpbmdzIHRvIGR1cGxpY2F0ZSBmaXJzdCBnbHlwaC4iKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBnbHlwaFplcm8gPSB0aGlzLmNoYXJTdHJpbmdzLmdldCgwKTsKICAgICAgdGhpcy5jaGFyU3RyaW5ncy5hZGQoZ2x5cGhaZXJvKTsKCiAgICAgIGlmICh0aGlzLmlzQ0lERm9udCkgewogICAgICAgIHRoaXMuZmRTZWxlY3QuZmRTZWxlY3QucHVzaCh0aGlzLmZkU2VsZWN0LmZkU2VsZWN0WzBdKTsKICAgICAgfQogICAgfSwKICAgIGhhc0dseXBoSWQ6IGZ1bmN0aW9uIENGRl9oYXNHbHlwaElEKGlkKSB7CiAgICAgIGlmIChpZCA8IDAgfHwgaWQgPj0gdGhpcy5jaGFyU3RyaW5ncy5jb3VudCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdmFyIGdseXBoID0gdGhpcy5jaGFyU3RyaW5ncy5nZXQoaWQpOwogICAgICByZXR1cm4gZ2x5cGgubGVuZ3RoID4gMDsKICAgIH0KICB9OwogIHJldHVybiBDRkY7Cn0oKTsKCmV4cG9ydHMuQ0ZGID0gQ0ZGOwoKdmFyIENGRkhlYWRlciA9IGZ1bmN0aW9uIENGRkhlYWRlckNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQ0ZGSGVhZGVyKG1ham9yLCBtaW5vciwgaGRyU2l6ZSwgb2ZmU2l6ZSkgewogICAgdGhpcy5tYWpvciA9IG1ham9yOwogICAgdGhpcy5taW5vciA9IG1pbm9yOwogICAgdGhpcy5oZHJTaXplID0gaGRyU2l6ZTsKICAgIHRoaXMub2ZmU2l6ZSA9IG9mZlNpemU7CiAgfQoKICByZXR1cm4gQ0ZGSGVhZGVyOwp9KCk7CgpleHBvcnRzLkNGRkhlYWRlciA9IENGRkhlYWRlcjsKCnZhciBDRkZTdHJpbmdzID0gZnVuY3Rpb24gQ0ZGU3RyaW5nc0Nsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQ0ZGU3RyaW5ncygpIHsKICAgIHRoaXMuc3RyaW5ncyA9IFtdOwogIH0KCiAgQ0ZGU3RyaW5ncy5wcm90b3R5cGUgPSB7CiAgICBnZXQ6IGZ1bmN0aW9uIENGRlN0cmluZ3NfZ2V0KGluZGV4KSB7CiAgICAgIGlmIChpbmRleCA+PSAwICYmIGluZGV4IDw9IE5VTV9TVEFOREFSRF9DRkZfU1RSSU5HUyAtIDEpIHsKICAgICAgICByZXR1cm4gQ0ZGU3RhbmRhcmRTdHJpbmdzW2luZGV4XTsKICAgICAgfQoKICAgICAgaWYgKGluZGV4IC0gTlVNX1NUQU5EQVJEX0NGRl9TVFJJTkdTIDw9IHRoaXMuc3RyaW5ncy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdzW2luZGV4IC0gTlVNX1NUQU5EQVJEX0NGRl9TVFJJTkdTXTsKICAgICAgfQoKICAgICAgcmV0dXJuIENGRlN0YW5kYXJkU3RyaW5nc1swXTsKICAgIH0sCiAgICBnZXRTSUQ6IGZ1bmN0aW9uIENGRlN0cmluZ3NfZ2V0U0lEKHN0cikgewogICAgICB2YXIgaW5kZXggPSBDRkZTdGFuZGFyZFN0cmluZ3MuaW5kZXhPZihzdHIpOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIHJldHVybiBpbmRleDsKICAgICAgfQoKICAgICAgaW5kZXggPSB0aGlzLnN0cmluZ3MuaW5kZXhPZihzdHIpOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIHJldHVybiBpbmRleCArIE5VTV9TVEFOREFSRF9DRkZfU1RSSU5HUzsKICAgICAgfQoKICAgICAgcmV0dXJuIC0xOwogICAgfSwKICAgIGFkZDogZnVuY3Rpb24gQ0ZGU3RyaW5nc19hZGQodmFsdWUpIHsKICAgICAgdGhpcy5zdHJpbmdzLnB1c2godmFsdWUpOwogICAgfSwKCiAgICBnZXQgY291bnQoKSB7CiAgICAgIHJldHVybiB0aGlzLnN0cmluZ3MubGVuZ3RoOwogICAgfQoKICB9OwogIHJldHVybiBDRkZTdHJpbmdzOwp9KCk7CgpleHBvcnRzLkNGRlN0cmluZ3MgPSBDRkZTdHJpbmdzOwoKdmFyIENGRkluZGV4ID0gZnVuY3Rpb24gQ0ZGSW5kZXhDbG9zdXJlKCkgewogIGZ1bmN0aW9uIENGRkluZGV4KCkgewogICAgdGhpcy5vYmplY3RzID0gW107CiAgICB0aGlzLmxlbmd0aCA9IDA7CiAgfQoKICBDRkZJbmRleC5wcm90b3R5cGUgPSB7CiAgICBhZGQ6IGZ1bmN0aW9uIENGRkluZGV4X2FkZChkYXRhKSB7CiAgICAgIHRoaXMubGVuZ3RoICs9IGRhdGEubGVuZ3RoOwogICAgICB0aGlzLm9iamVjdHMucHVzaChkYXRhKTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIENGRkluZGV4X3NldChpbmRleCwgZGF0YSkgewogICAgICB0aGlzLmxlbmd0aCArPSBkYXRhLmxlbmd0aCAtIHRoaXMub2JqZWN0c1tpbmRleF0ubGVuZ3RoOwogICAgICB0aGlzLm9iamVjdHNbaW5kZXhdID0gZGF0YTsKICAgIH0sCiAgICBnZXQ6IGZ1bmN0aW9uIENGRkluZGV4X2dldChpbmRleCkgewogICAgICByZXR1cm4gdGhpcy5vYmplY3RzW2luZGV4XTsKICAgIH0sCgogICAgZ2V0IGNvdW50KCkgewogICAgICByZXR1cm4gdGhpcy5vYmplY3RzLmxlbmd0aDsKICAgIH0KCiAgfTsKICByZXR1cm4gQ0ZGSW5kZXg7Cn0oKTsKCmV4cG9ydHMuQ0ZGSW5kZXggPSBDRkZJbmRleDsKCnZhciBDRkZEaWN0ID0gZnVuY3Rpb24gQ0ZGRGljdENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQ0ZGRGljdCh0YWJsZXMsIHN0cmluZ3MpIHsKICAgIHRoaXMua2V5VG9OYW1lTWFwID0gdGFibGVzLmtleVRvTmFtZU1hcDsKICAgIHRoaXMubmFtZVRvS2V5TWFwID0gdGFibGVzLm5hbWVUb0tleU1hcDsKICAgIHRoaXMuZGVmYXVsdHMgPSB0YWJsZXMuZGVmYXVsdHM7CiAgICB0aGlzLnR5cGVzID0gdGFibGVzLnR5cGVzOwogICAgdGhpcy5vcGNvZGVzID0gdGFibGVzLm9wY29kZXM7CiAgICB0aGlzLm9yZGVyID0gdGFibGVzLm9yZGVyOwogICAgdGhpcy5zdHJpbmdzID0gc3RyaW5nczsKICAgIHRoaXMudmFsdWVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICB9CgogIENGRkRpY3QucHJvdG90eXBlID0gewogICAgc2V0QnlLZXk6IGZ1bmN0aW9uIENGRkRpY3Rfc2V0QnlLZXkoa2V5LCB2YWx1ZSkgewogICAgICBpZiAoIShrZXkgaW4gdGhpcy5rZXlUb05hbWVNYXApKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB2YXIgdmFsdWVMZW5ndGggPSB2YWx1ZS5sZW5ndGg7CgogICAgICBpZiAodmFsdWVMZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZUxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGlzTmFOKHZhbHVlW2ldKSkgewogICAgICAgICAgKDAsIF91dGlsLndhcm4pKCdJbnZhbGlkIENGRkRpY3QgdmFsdWU6ICInICsgdmFsdWUgKyAnIiBmb3Iga2V5ICInICsga2V5ICsgJyIuJyk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciB0eXBlID0gdGhpcy50eXBlc1trZXldOwoKICAgICAgaWYgKHR5cGUgPT09ICJudW0iIHx8IHR5cGUgPT09ICJzaWQiIHx8IHR5cGUgPT09ICJvZmZzZXQiKSB7CiAgICAgICAgdmFsdWUgPSB2YWx1ZVswXTsKICAgICAgfQoKICAgICAgdGhpcy52YWx1ZXNba2V5XSA9IHZhbHVlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICBzZXRCeU5hbWU6IGZ1bmN0aW9uIENGRkRpY3Rfc2V0QnlOYW1lKG5hbWUsIHZhbHVlKSB7CiAgICAgIGlmICghKG5hbWUgaW4gdGhpcy5uYW1lVG9LZXlNYXApKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIGRpY3Rpb25hcnkgbmFtZSBcIiIuY29uY2F0KG5hbWUsICJcIiIpKTsKICAgICAgfQoKICAgICAgdGhpcy52YWx1ZXNbdGhpcy5uYW1lVG9LZXlNYXBbbmFtZV1dID0gdmFsdWU7CiAgICB9LAogICAgaGFzTmFtZTogZnVuY3Rpb24gQ0ZGRGljdF9oYXNOYW1lKG5hbWUpIHsKICAgICAgcmV0dXJuIHRoaXMubmFtZVRvS2V5TWFwW25hbWVdIGluIHRoaXMudmFsdWVzOwogICAgfSwKICAgIGdldEJ5TmFtZTogZnVuY3Rpb24gQ0ZGRGljdF9nZXRCeU5hbWUobmFtZSkgewogICAgICBpZiAoIShuYW1lIGluIHRoaXMubmFtZVRvS2V5TWFwKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiSW52YWxpZCBkaWN0aW9uYXJ5IG5hbWUgIi5jb25jYXQobmFtZSwgIlwiIikpOwogICAgICB9CgogICAgICB2YXIga2V5ID0gdGhpcy5uYW1lVG9LZXlNYXBbbmFtZV07CgogICAgICBpZiAoIShrZXkgaW4gdGhpcy52YWx1ZXMpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdHNba2V5XTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMudmFsdWVzW2tleV07CiAgICB9LAogICAgcmVtb3ZlQnlOYW1lOiBmdW5jdGlvbiBDRkZEaWN0X3JlbW92ZUJ5TmFtZShuYW1lKSB7CiAgICAgIGRlbGV0ZSB0aGlzLnZhbHVlc1t0aGlzLm5hbWVUb0tleU1hcFtuYW1lXV07CiAgICB9CiAgfTsKCiAgQ0ZGRGljdC5jcmVhdGVUYWJsZXMgPSBmdW5jdGlvbiBDRkZEaWN0X2NyZWF0ZVRhYmxlcyhsYXlvdXQpIHsKICAgIHZhciB0YWJsZXMgPSB7CiAgICAgIGtleVRvTmFtZU1hcDoge30sCiAgICAgIG5hbWVUb0tleU1hcDoge30sCiAgICAgIGRlZmF1bHRzOiB7fSwKICAgICAgdHlwZXM6IHt9LAogICAgICBvcGNvZGVzOiB7fSwKICAgICAgb3JkZXI6IFtdCiAgICB9OwoKICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGxheW91dC5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIHZhciBlbnRyeSA9IGxheW91dFtpXTsKICAgICAgdmFyIGtleSA9IEFycmF5LmlzQXJyYXkoZW50cnlbMF0pID8gKGVudHJ5WzBdWzBdIDw8IDgpICsgZW50cnlbMF1bMV0gOiBlbnRyeVswXTsKICAgICAgdGFibGVzLmtleVRvTmFtZU1hcFtrZXldID0gZW50cnlbMV07CiAgICAgIHRhYmxlcy5uYW1lVG9LZXlNYXBbZW50cnlbMV1dID0ga2V5OwogICAgICB0YWJsZXMudHlwZXNba2V5XSA9IGVudHJ5WzJdOwogICAgICB0YWJsZXMuZGVmYXVsdHNba2V5XSA9IGVudHJ5WzNdOwogICAgICB0YWJsZXMub3Bjb2Rlc1trZXldID0gQXJyYXkuaXNBcnJheShlbnRyeVswXSkgPyBlbnRyeVswXSA6IFtlbnRyeVswXV07CiAgICAgIHRhYmxlcy5vcmRlci5wdXNoKGtleSk7CiAgICB9CgogICAgcmV0dXJuIHRhYmxlczsKICB9OwoKICByZXR1cm4gQ0ZGRGljdDsKfSgpOwoKdmFyIENGRlRvcERpY3QgPSBmdW5jdGlvbiBDRkZUb3BEaWN0Q2xvc3VyZSgpIHsKICB2YXIgbGF5b3V0ID0gW1tbMTIsIDMwXSwgIlJPUyIsIFsic2lkIiwgInNpZCIsICJudW0iXSwgbnVsbF0sIFtbMTIsIDIwXSwgIlN5bnRoZXRpY0Jhc2UiLCAibnVtIiwgbnVsbF0sIFswLCAidmVyc2lvbiIsICJzaWQiLCBudWxsXSwgWzEsICJOb3RpY2UiLCAic2lkIiwgbnVsbF0sIFtbMTIsIDBdLCAiQ29weXJpZ2h0IiwgInNpZCIsIG51bGxdLCBbMiwgIkZ1bGxOYW1lIiwgInNpZCIsIG51bGxdLCBbMywgIkZhbWlseU5hbWUiLCAic2lkIiwgbnVsbF0sIFs0LCAiV2VpZ2h0IiwgInNpZCIsIG51bGxdLCBbWzEyLCAxXSwgImlzRml4ZWRQaXRjaCIsICJudW0iLCAwXSwgW1sxMiwgMl0sICJJdGFsaWNBbmdsZSIsICJudW0iLCAwXSwgW1sxMiwgM10sICJVbmRlcmxpbmVQb3NpdGlvbiIsICJudW0iLCAtMTAwXSwgW1sxMiwgNF0sICJVbmRlcmxpbmVUaGlja25lc3MiLCAibnVtIiwgNTBdLCBbWzEyLCA1XSwgIlBhaW50VHlwZSIsICJudW0iLCAwXSwgW1sxMiwgNl0sICJDaGFyc3RyaW5nVHlwZSIsICJudW0iLCAyXSwgW1sxMiwgN10sICJGb250TWF0cml4IiwgWyJudW0iLCAibnVtIiwgIm51bSIsICJudW0iLCAibnVtIiwgIm51bSJdLCBbMC4wMDEsIDAsIDAsIDAuMDAxLCAwLCAwXV0sIFsxMywgIlVuaXF1ZUlEIiwgIm51bSIsIG51bGxdLCBbNSwgIkZvbnRCQm94IiwgWyJudW0iLCAibnVtIiwgIm51bSIsICJudW0iXSwgWzAsIDAsIDAsIDBdXSwgW1sxMiwgOF0sICJTdHJva2VXaWR0aCIsICJudW0iLCAwXSwgWzE0LCAiWFVJRCIsICJhcnJheSIsIG51bGxdLCBbMTUsICJjaGFyc2V0IiwgIm9mZnNldCIsIDBdLCBbMTYsICJFbmNvZGluZyIsICJvZmZzZXQiLCAwXSwgWzE3LCAiQ2hhclN0cmluZ3MiLCAib2Zmc2V0IiwgMF0sIFsxOCwgIlByaXZhdGUiLCBbIm9mZnNldCIsICJvZmZzZXQiXSwgbnVsbF0sIFtbMTIsIDIxXSwgIlBvc3RTY3JpcHQiLCAic2lkIiwgbnVsbF0sIFtbMTIsIDIyXSwgIkJhc2VGb250TmFtZSIsICJzaWQiLCBudWxsXSwgW1sxMiwgMjNdLCAiQmFzZUZvbnRCbGVuZCIsICJkZWx0YSIsIG51bGxdLCBbWzEyLCAzMV0sICJDSURGb250VmVyc2lvbiIsICJudW0iLCAwXSwgW1sxMiwgMzJdLCAiQ0lERm9udFJldmlzaW9uIiwgIm51bSIsIDBdLCBbWzEyLCAzM10sICJDSURGb250VHlwZSIsICJudW0iLCAwXSwgW1sxMiwgMzRdLCAiQ0lEQ291bnQiLCAibnVtIiwgODcyMF0sIFtbMTIsIDM1XSwgIlVJREJhc2UiLCAibnVtIiwgbnVsbF0sIFtbMTIsIDM3XSwgIkZEU2VsZWN0IiwgIm9mZnNldCIsIG51bGxdLCBbWzEyLCAzNl0sICJGREFycmF5IiwgIm9mZnNldCIsIG51bGxdLCBbWzEyLCAzOF0sICJGb250TmFtZSIsICJzaWQiLCBudWxsXV07CiAgdmFyIHRhYmxlcyA9IG51bGw7CgogIGZ1bmN0aW9uIENGRlRvcERpY3Qoc3RyaW5ncykgewogICAgaWYgKHRhYmxlcyA9PT0gbnVsbCkgewogICAgICB0YWJsZXMgPSBDRkZEaWN0LmNyZWF0ZVRhYmxlcyhsYXlvdXQpOwogICAgfQoKICAgIENGRkRpY3QuY2FsbCh0aGlzLCB0YWJsZXMsIHN0cmluZ3MpOwogICAgdGhpcy5wcml2YXRlRGljdCA9IG51bGw7CiAgfQoKICBDRkZUb3BEaWN0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQ0ZGRGljdC5wcm90b3R5cGUpOwogIHJldHVybiBDRkZUb3BEaWN0Owp9KCk7CgpleHBvcnRzLkNGRlRvcERpY3QgPSBDRkZUb3BEaWN0OwoKdmFyIENGRlByaXZhdGVEaWN0ID0gZnVuY3Rpb24gQ0ZGUHJpdmF0ZURpY3RDbG9zdXJlKCkgewogIHZhciBsYXlvdXQgPSBbWzYsICJCbHVlVmFsdWVzIiwgImRlbHRhIiwgbnVsbF0sIFs3LCAiT3RoZXJCbHVlcyIsICJkZWx0YSIsIG51bGxdLCBbOCwgIkZhbWlseUJsdWVzIiwgImRlbHRhIiwgbnVsbF0sIFs5LCAiRmFtaWx5T3RoZXJCbHVlcyIsICJkZWx0YSIsIG51bGxdLCBbWzEyLCA5XSwgIkJsdWVTY2FsZSIsICJudW0iLCAwLjAzOTYyNV0sIFtbMTIsIDEwXSwgIkJsdWVTaGlmdCIsICJudW0iLCA3XSwgW1sxMiwgMTFdLCAiQmx1ZUZ1enoiLCAibnVtIiwgMV0sIFsxMCwgIlN0ZEhXIiwgIm51bSIsIG51bGxdLCBbMTEsICJTdGRWVyIsICJudW0iLCBudWxsXSwgW1sxMiwgMTJdLCAiU3RlbVNuYXBIIiwgImRlbHRhIiwgbnVsbF0sIFtbMTIsIDEzXSwgIlN0ZW1TbmFwViIsICJkZWx0YSIsIG51bGxdLCBbWzEyLCAxNF0sICJGb3JjZUJvbGQiLCAibnVtIiwgMF0sIFtbMTIsIDE3XSwgIkxhbmd1YWdlR3JvdXAiLCAibnVtIiwgMF0sIFtbMTIsIDE4XSwgIkV4cGFuc2lvbkZhY3RvciIsICJudW0iLCAwLjA2XSwgW1sxMiwgMTldLCAiaW5pdGlhbFJhbmRvbVNlZWQiLCAibnVtIiwgMF0sIFsyMCwgImRlZmF1bHRXaWR0aFgiLCAibnVtIiwgMF0sIFsyMSwgIm5vbWluYWxXaWR0aFgiLCAibnVtIiwgMF0sIFsxOSwgIlN1YnJzIiwgIm9mZnNldCIsIG51bGxdXTsKICB2YXIgdGFibGVzID0gbnVsbDsKCiAgZnVuY3Rpb24gQ0ZGUHJpdmF0ZURpY3Qoc3RyaW5ncykgewogICAgaWYgKHRhYmxlcyA9PT0gbnVsbCkgewogICAgICB0YWJsZXMgPSBDRkZEaWN0LmNyZWF0ZVRhYmxlcyhsYXlvdXQpOwogICAgfQoKICAgIENGRkRpY3QuY2FsbCh0aGlzLCB0YWJsZXMsIHN0cmluZ3MpOwogICAgdGhpcy5zdWJyc0luZGV4ID0gbnVsbDsKICB9CgogIENGRlByaXZhdGVEaWN0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQ0ZGRGljdC5wcm90b3R5cGUpOwogIHJldHVybiBDRkZQcml2YXRlRGljdDsKfSgpOwoKZXhwb3J0cy5DRkZQcml2YXRlRGljdCA9IENGRlByaXZhdGVEaWN0Owp2YXIgQ0ZGQ2hhcnNldFByZWRlZmluZWRUeXBlcyA9IHsKICBJU09fQURPQkU6IDAsCiAgRVhQRVJUOiAxLAogIEVYUEVSVF9TVUJTRVQ6IDIKfTsKCnZhciBDRkZDaGFyc2V0ID0gZnVuY3Rpb24gQ0ZGQ2hhcnNldENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQ0ZGQ2hhcnNldChwcmVkZWZpbmVkLCBmb3JtYXQsIGNoYXJzZXQsIHJhdykgewogICAgdGhpcy5wcmVkZWZpbmVkID0gcHJlZGVmaW5lZDsKICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwogICAgdGhpcy5jaGFyc2V0ID0gY2hhcnNldDsKICAgIHRoaXMucmF3ID0gcmF3OwogIH0KCiAgcmV0dXJuIENGRkNoYXJzZXQ7Cn0oKTsKCmV4cG9ydHMuQ0ZGQ2hhcnNldCA9IENGRkNoYXJzZXQ7Cgp2YXIgQ0ZGRW5jb2RpbmcgPSBmdW5jdGlvbiBDRkZFbmNvZGluZ0Nsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQ0ZGRW5jb2RpbmcocHJlZGVmaW5lZCwgZm9ybWF0LCBlbmNvZGluZywgcmF3KSB7CiAgICB0aGlzLnByZWRlZmluZWQgPSBwcmVkZWZpbmVkOwogICAgdGhpcy5mb3JtYXQgPSBmb3JtYXQ7CiAgICB0aGlzLmVuY29kaW5nID0gZW5jb2Rpbmc7CiAgICB0aGlzLnJhdyA9IHJhdzsKICB9CgogIHJldHVybiBDRkZFbmNvZGluZzsKfSgpOwoKdmFyIENGRkZEU2VsZWN0ID0gZnVuY3Rpb24gQ0ZGRkRTZWxlY3RDbG9zdXJlKCkgewogIGZ1bmN0aW9uIENGRkZEU2VsZWN0KGZvcm1hdCwgZmRTZWxlY3QpIHsKICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwogICAgdGhpcy5mZFNlbGVjdCA9IGZkU2VsZWN0OwogIH0KCiAgQ0ZGRkRTZWxlY3QucHJvdG90eXBlID0gewogICAgZ2V0RkRJbmRleDogZnVuY3Rpb24gQ0ZGRkRTZWxlY3RfZ2V0KGdseXBoSW5kZXgpIHsKICAgICAgaWYgKGdseXBoSW5kZXggPCAwIHx8IGdseXBoSW5kZXggPj0gdGhpcy5mZFNlbGVjdC5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmZkU2VsZWN0W2dseXBoSW5kZXhdOwogICAgfQogIH07CiAgcmV0dXJuIENGRkZEU2VsZWN0Owp9KCk7CgpleHBvcnRzLkNGRkZEU2VsZWN0ID0gQ0ZGRkRTZWxlY3Q7Cgp2YXIgQ0ZGT2Zmc2V0VHJhY2tlciA9IGZ1bmN0aW9uIENGRk9mZnNldFRyYWNrZXJDbG9zdXJlKCkgewogIGZ1bmN0aW9uIENGRk9mZnNldFRyYWNrZXIoKSB7CiAgICB0aGlzLm9mZnNldHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH0KCiAgQ0ZGT2Zmc2V0VHJhY2tlci5wcm90b3R5cGUgPSB7CiAgICBpc1RyYWNraW5nOiBmdW5jdGlvbiBDRkZPZmZzZXRUcmFja2VyX2lzVHJhY2tpbmcoa2V5KSB7CiAgICAgIHJldHVybiBrZXkgaW4gdGhpcy5vZmZzZXRzOwogICAgfSwKICAgIHRyYWNrOiBmdW5jdGlvbiBDRkZPZmZzZXRUcmFja2VyX3RyYWNrKGtleSwgbG9jYXRpb24pIHsKICAgICAgaWYgKGtleSBpbiB0aGlzLm9mZnNldHMpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkFscmVhZHkgdHJhY2tpbmcgbG9jYXRpb24gb2YgIi5jb25jYXQoa2V5KSk7CiAgICAgIH0KCiAgICAgIHRoaXMub2Zmc2V0c1trZXldID0gbG9jYXRpb247CiAgICB9LAogICAgb2Zmc2V0OiBmdW5jdGlvbiBDRkZPZmZzZXRUcmFja2VyX29mZnNldCh2YWx1ZSkgewogICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5vZmZzZXRzKSB7CiAgICAgICAgdGhpcy5vZmZzZXRzW2tleV0gKz0gdmFsdWU7CiAgICAgIH0KICAgIH0sCiAgICBzZXRFbnRyeUxvY2F0aW9uOiBmdW5jdGlvbiBDRkZPZmZzZXRUcmFja2VyX3NldEVudHJ5TG9jYXRpb24oa2V5LCB2YWx1ZXMsIG91dHB1dCkgewogICAgICBpZiAoIShrZXkgaW4gdGhpcy5vZmZzZXRzKSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTm90IHRyYWNraW5nIGxvY2F0aW9uIG9mICIuY29uY2F0KGtleSkpOwogICAgICB9CgogICAgICB2YXIgZGF0YSA9IG91dHB1dC5kYXRhOwogICAgICB2YXIgZGF0YU9mZnNldCA9IHRoaXMub2Zmc2V0c1trZXldOwogICAgICB2YXIgc2l6ZSA9IDU7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSB2YWx1ZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICAgIHZhciBvZmZzZXQwID0gaSAqIHNpemUgKyBkYXRhT2Zmc2V0OwogICAgICAgIHZhciBvZmZzZXQxID0gb2Zmc2V0MCArIDE7CiAgICAgICAgdmFyIG9mZnNldDIgPSBvZmZzZXQwICsgMjsKICAgICAgICB2YXIgb2Zmc2V0MyA9IG9mZnNldDAgKyAzOwogICAgICAgIHZhciBvZmZzZXQ0ID0gb2Zmc2V0MCArIDQ7CgogICAgICAgIGlmIChkYXRhW29mZnNldDBdICE9PSAweDFkIHx8IGRhdGFbb2Zmc2V0MV0gIT09IDAgfHwgZGF0YVtvZmZzZXQyXSAhPT0gMCB8fCBkYXRhW29mZnNldDNdICE9PSAwIHx8IGRhdGFbb2Zmc2V0NF0gIT09IDApIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigid3JpdGluZyB0byBhbiBvZmZzZXQgdGhhdCBpcyBub3QgZW1wdHkiKTsKICAgICAgICB9CgogICAgICAgIHZhciB2YWx1ZSA9IHZhbHVlc1tpXTsKICAgICAgICBkYXRhW29mZnNldDBdID0gMHgxZDsKICAgICAgICBkYXRhW29mZnNldDFdID0gdmFsdWUgPj4gMjQgJiAweGZmOwogICAgICAgIGRhdGFbb2Zmc2V0Ml0gPSB2YWx1ZSA+PiAxNiAmIDB4ZmY7CiAgICAgICAgZGF0YVtvZmZzZXQzXSA9IHZhbHVlID4+IDggJiAweGZmOwogICAgICAgIGRhdGFbb2Zmc2V0NF0gPSB2YWx1ZSAmIDB4ZmY7CiAgICAgIH0KICAgIH0KICB9OwogIHJldHVybiBDRkZPZmZzZXRUcmFja2VyOwp9KCk7Cgp2YXIgQ0ZGQ29tcGlsZXIgPSBmdW5jdGlvbiBDRkZDb21waWxlckNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQ0ZGQ29tcGlsZXIoY2ZmKSB7CiAgICB0aGlzLmNmZiA9IGNmZjsKICB9CgogIENGRkNvbXBpbGVyLnByb3RvdHlwZSA9IHsKICAgIGNvbXBpbGU6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2NvbXBpbGUoKSB7CiAgICAgIHZhciBjZmYgPSB0aGlzLmNmZjsKICAgICAgdmFyIG91dHB1dCA9IHsKICAgICAgICBkYXRhOiBbXSwKICAgICAgICBsZW5ndGg6IDAsCiAgICAgICAgYWRkOiBmdW5jdGlvbiBDRkZDb21waWxlcl9hZGQoZGF0YSkgewogICAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5kYXRhLmNvbmNhdChkYXRhKTsKICAgICAgICAgIHRoaXMubGVuZ3RoID0gdGhpcy5kYXRhLmxlbmd0aDsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHZhciBoZWFkZXIgPSB0aGlzLmNvbXBpbGVIZWFkZXIoY2ZmLmhlYWRlcik7CiAgICAgIG91dHB1dC5hZGQoaGVhZGVyKTsKICAgICAgdmFyIG5hbWVJbmRleCA9IHRoaXMuY29tcGlsZU5hbWVJbmRleChjZmYubmFtZXMpOwogICAgICBvdXRwdXQuYWRkKG5hbWVJbmRleCk7CgogICAgICBpZiAoY2ZmLmlzQ0lERm9udCkgewogICAgICAgIGlmIChjZmYudG9wRGljdC5oYXNOYW1lKCJGb250TWF0cml4IikpIHsKICAgICAgICAgIHZhciBiYXNlID0gY2ZmLnRvcERpY3QuZ2V0QnlOYW1lKCJGb250TWF0cml4Iik7CiAgICAgICAgICBjZmYudG9wRGljdC5yZW1vdmVCeU5hbWUoIkZvbnRNYXRyaXgiKTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBjZmYuZmRBcnJheS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgIHZhciBzdWJEaWN0ID0gY2ZmLmZkQXJyYXlbaV07CiAgICAgICAgICAgIHZhciBtYXRyaXggPSBiYXNlLnNsaWNlKDApOwoKICAgICAgICAgICAgaWYgKHN1YkRpY3QuaGFzTmFtZSgiRm9udE1hdHJpeCIpKSB7CiAgICAgICAgICAgICAgbWF0cml4ID0gX3V0aWwuVXRpbC50cmFuc2Zvcm0obWF0cml4LCBzdWJEaWN0LmdldEJ5TmFtZSgiRm9udE1hdHJpeCIpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3ViRGljdC5zZXRCeU5hbWUoIkZvbnRNYXRyaXgiLCBtYXRyaXgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgY2ZmLnRvcERpY3Quc2V0QnlOYW1lKCJjaGFyc2V0IiwgMCk7CiAgICAgIHZhciBjb21waWxlZCA9IHRoaXMuY29tcGlsZVRvcERpY3RzKFtjZmYudG9wRGljdF0sIG91dHB1dC5sZW5ndGgsIGNmZi5pc0NJREZvbnQpOwogICAgICBvdXRwdXQuYWRkKGNvbXBpbGVkLm91dHB1dCk7CiAgICAgIHZhciB0b3BEaWN0VHJhY2tlciA9IGNvbXBpbGVkLnRyYWNrZXJzWzBdOwogICAgICB2YXIgc3RyaW5nSW5kZXggPSB0aGlzLmNvbXBpbGVTdHJpbmdJbmRleChjZmYuc3RyaW5ncy5zdHJpbmdzKTsKICAgICAgb3V0cHV0LmFkZChzdHJpbmdJbmRleCk7CiAgICAgIHZhciBnbG9iYWxTdWJySW5kZXggPSB0aGlzLmNvbXBpbGVJbmRleChjZmYuZ2xvYmFsU3VickluZGV4KTsKICAgICAgb3V0cHV0LmFkZChnbG9iYWxTdWJySW5kZXgpOwoKICAgICAgaWYgKGNmZi5lbmNvZGluZyAmJiBjZmYudG9wRGljdC5oYXNOYW1lKCJFbmNvZGluZyIpKSB7CiAgICAgICAgaWYgKGNmZi5lbmNvZGluZy5wcmVkZWZpbmVkKSB7CiAgICAgICAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJFbmNvZGluZyIsIFtjZmYuZW5jb2RpbmcuZm9ybWF0XSwgb3V0cHV0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGVuY29kaW5nID0gdGhpcy5jb21waWxlRW5jb2RpbmcoY2ZmLmVuY29kaW5nKTsKICAgICAgICAgIHRvcERpY3RUcmFja2VyLnNldEVudHJ5TG9jYXRpb24oIkVuY29kaW5nIiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgICAgICAgb3V0cHV0LmFkZChlbmNvZGluZyk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgY2hhcnNldCA9IHRoaXMuY29tcGlsZUNoYXJzZXQoY2ZmLmNoYXJzZXQsIGNmZi5jaGFyU3RyaW5ncy5jb3VudCwgY2ZmLnN0cmluZ3MsIGNmZi5pc0NJREZvbnQpOwogICAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJjaGFyc2V0IiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgICBvdXRwdXQuYWRkKGNoYXJzZXQpOwogICAgICB2YXIgY2hhclN0cmluZ3MgPSB0aGlzLmNvbXBpbGVDaGFyU3RyaW5ncyhjZmYuY2hhclN0cmluZ3MpOwogICAgICB0b3BEaWN0VHJhY2tlci5zZXRFbnRyeUxvY2F0aW9uKCJDaGFyU3RyaW5ncyIsIFtvdXRwdXQubGVuZ3RoXSwgb3V0cHV0KTsKICAgICAgb3V0cHV0LmFkZChjaGFyU3RyaW5ncyk7CgogICAgICBpZiAoY2ZmLmlzQ0lERm9udCkgewogICAgICAgIHRvcERpY3RUcmFja2VyLnNldEVudHJ5TG9jYXRpb24oIkZEU2VsZWN0IiwgW291dHB1dC5sZW5ndGhdLCBvdXRwdXQpOwogICAgICAgIHZhciBmZFNlbGVjdCA9IHRoaXMuY29tcGlsZUZEU2VsZWN0KGNmZi5mZFNlbGVjdCk7CiAgICAgICAgb3V0cHV0LmFkZChmZFNlbGVjdCk7CiAgICAgICAgY29tcGlsZWQgPSB0aGlzLmNvbXBpbGVUb3BEaWN0cyhjZmYuZmRBcnJheSwgb3V0cHV0Lmxlbmd0aCwgdHJ1ZSk7CiAgICAgICAgdG9wRGljdFRyYWNrZXIuc2V0RW50cnlMb2NhdGlvbigiRkRBcnJheSIsIFtvdXRwdXQubGVuZ3RoXSwgb3V0cHV0KTsKICAgICAgICBvdXRwdXQuYWRkKGNvbXBpbGVkLm91dHB1dCk7CiAgICAgICAgdmFyIGZvbnREaWN0VHJhY2tlcnMgPSBjb21waWxlZC50cmFja2VyczsKICAgICAgICB0aGlzLmNvbXBpbGVQcml2YXRlRGljdHMoY2ZmLmZkQXJyYXksIGZvbnREaWN0VHJhY2tlcnMsIG91dHB1dCk7CiAgICAgIH0KCiAgICAgIHRoaXMuY29tcGlsZVByaXZhdGVEaWN0cyhbY2ZmLnRvcERpY3RdLCBbdG9wRGljdFRyYWNrZXJdLCBvdXRwdXQpOwogICAgICBvdXRwdXQuYWRkKFswXSk7CiAgICAgIHJldHVybiBvdXRwdXQuZGF0YTsKICAgIH0sCiAgICBlbmNvZGVOdW1iZXI6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2VuY29kZU51bWJlcih2YWx1ZSkgewogICAgICBpZiAocGFyc2VGbG9hdCh2YWx1ZSkgPT09IHBhcnNlSW50KHZhbHVlLCAxMCkgJiYgIWlzTmFOKHZhbHVlKSkgewogICAgICAgIHJldHVybiB0aGlzLmVuY29kZUludGVnZXIodmFsdWUpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5lbmNvZGVGbG9hdCh2YWx1ZSk7CiAgICB9LAogICAgZW5jb2RlRmxvYXQ6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2VuY29kZUZsb2F0KG51bSkgewogICAgICB2YXIgdmFsdWUgPSBudW0udG9TdHJpbmcoKTsKICAgICAgdmFyIG0gPSAvXC4oXGQqPykoPzo5ezUsMjB9fDB7NSwyMH0pXGR7MCwyfSg/OmUoLispfCQpLy5leGVjKHZhbHVlKTsKCiAgICAgIGlmIChtKSB7CiAgICAgICAgdmFyIGVwc2lsb24gPSBwYXJzZUZsb2F0KCIxZSIgKyAoKG1bMl0gPyArbVsyXSA6IDApICsgbVsxXS5sZW5ndGgpKTsKICAgICAgICB2YWx1ZSA9IChNYXRoLnJvdW5kKG51bSAqIGVwc2lsb24pIC8gZXBzaWxvbikudG9TdHJpbmcoKTsKICAgICAgfQoKICAgICAgdmFyIG5pYmJsZXMgPSAiIjsKICAgICAgdmFyIGksIGlpOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSB2YWx1ZS5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgdmFyIGEgPSB2YWx1ZVtpXTsKCiAgICAgICAgaWYgKGEgPT09ICJlIikgewogICAgICAgICAgbmliYmxlcyArPSB2YWx1ZVsrK2ldID09PSAiLSIgPyAiYyIgOiAiYiI7CiAgICAgICAgfSBlbHNlIGlmIChhID09PSAiLiIpIHsKICAgICAgICAgIG5pYmJsZXMgKz0gImEiOwogICAgICAgIH0gZWxzZSBpZiAoYSA9PT0gIi0iKSB7CiAgICAgICAgICBuaWJibGVzICs9ICJlIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmliYmxlcyArPSBhOwogICAgICAgIH0KICAgICAgfQoKICAgICAgbmliYmxlcyArPSBuaWJibGVzLmxlbmd0aCAmIDEgPyAiZiIgOiAiZmYiOwogICAgICB2YXIgb3V0ID0gWzMwXTsKCiAgICAgIGZvciAoaSA9IDAsIGlpID0gbmliYmxlcy5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7CiAgICAgICAgb3V0LnB1c2gocGFyc2VJbnQobmliYmxlcy5zdWJzdHJpbmcoaSwgaSArIDIpLCAxNikpOwogICAgICB9CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKICAgIGVuY29kZUludGVnZXI6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2VuY29kZUludGVnZXIodmFsdWUpIHsKICAgICAgdmFyIGNvZGU7CgogICAgICBpZiAodmFsdWUgPj0gLTEwNyAmJiB2YWx1ZSA8PSAxMDcpIHsKICAgICAgICBjb2RlID0gW3ZhbHVlICsgMTM5XTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSAxMDggJiYgdmFsdWUgPD0gMTEzMSkgewogICAgICAgIHZhbHVlID0gdmFsdWUgLSAxMDg7CiAgICAgICAgY29kZSA9IFsodmFsdWUgPj4gOCkgKyAyNDcsIHZhbHVlICYgMHhmZl07CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPj0gLTExMzEgJiYgdmFsdWUgPD0gLTEwOCkgewogICAgICAgIHZhbHVlID0gLXZhbHVlIC0gMTA4OwogICAgICAgIGNvZGUgPSBbKHZhbHVlID4+IDgpICsgMjUxLCB2YWx1ZSAmIDB4ZmZdOwogICAgICB9IGVsc2UgaWYgKHZhbHVlID49IC0zMjc2OCAmJiB2YWx1ZSA8PSAzMjc2NykgewogICAgICAgIGNvZGUgPSBbMHgxYywgdmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZl07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29kZSA9IFsweDFkLCB2YWx1ZSA+PiAyNCAmIDB4ZmYsIHZhbHVlID4+IDE2ICYgMHhmZiwgdmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZl07CiAgICAgIH0KCiAgICAgIHJldHVybiBjb2RlOwogICAgfSwKICAgIGNvbXBpbGVIZWFkZXI6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2NvbXBpbGVIZWFkZXIoaGVhZGVyKSB7CiAgICAgIHJldHVybiBbaGVhZGVyLm1ham9yLCBoZWFkZXIubWlub3IsIGhlYWRlci5oZHJTaXplLCBoZWFkZXIub2ZmU2l6ZV07CiAgICB9LAogICAgY29tcGlsZU5hbWVJbmRleDogZnVuY3Rpb24gQ0ZGQ29tcGlsZXJfY29tcGlsZU5hbWVJbmRleChuYW1lcykgewogICAgICB2YXIgbmFtZUluZGV4ID0gbmV3IENGRkluZGV4KCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBuYW1lcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgdmFyIG5hbWUgPSBuYW1lc1tpXTsKICAgICAgICB2YXIgbGVuZ3RoID0gTWF0aC5taW4obmFtZS5sZW5ndGgsIDEyNyk7CiAgICAgICAgdmFyIHNhbml0aXplZE5hbWUgPSBuZXcgQXJyYXkobGVuZ3RoKTsKCiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBsZW5ndGg7IGorKykgewogICAgICAgICAgdmFyIF9jaGFyID0gbmFtZVtqXTsKCiAgICAgICAgICBpZiAoX2NoYXIgPCAiISIgfHwgX2NoYXIgPiAifiIgfHwgX2NoYXIgPT09ICJbIiB8fCBfY2hhciA9PT0gIl0iIHx8IF9jaGFyID09PSAiKCIgfHwgX2NoYXIgPT09ICIpIiB8fCBfY2hhciA9PT0gInsiIHx8IF9jaGFyID09PSAifSIgfHwgX2NoYXIgPT09ICI8IiB8fCBfY2hhciA9PT0gIj4iIHx8IF9jaGFyID09PSAiLyIgfHwgX2NoYXIgPT09ICIlIikgewogICAgICAgICAgICBfY2hhciA9ICJfIjsKICAgICAgICAgIH0KCiAgICAgICAgICBzYW5pdGl6ZWROYW1lW2pdID0gX2NoYXI7CiAgICAgICAgfQoKICAgICAgICBzYW5pdGl6ZWROYW1lID0gc2FuaXRpemVkTmFtZS5qb2luKCIiKTsKCiAgICAgICAgaWYgKHNhbml0aXplZE5hbWUgPT09ICIiKSB7CiAgICAgICAgICBzYW5pdGl6ZWROYW1lID0gIkJhZF9Gb250X05hbWUiOwogICAgICAgIH0KCiAgICAgICAgbmFtZUluZGV4LmFkZCgoMCwgX3V0aWwuc3RyaW5nVG9CeXRlcykoc2FuaXRpemVkTmFtZSkpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5jb21waWxlSW5kZXgobmFtZUluZGV4KTsKICAgIH0sCiAgICBjb21waWxlVG9wRGljdHM6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2NvbXBpbGVUb3BEaWN0cyhkaWN0cywgbGVuZ3RoLCByZW1vdmVDaWRLZXlzKSB7CiAgICAgIHZhciBmb250RGljdFRyYWNrZXJzID0gW107CiAgICAgIHZhciBmZEFycmF5SW5kZXggPSBuZXcgQ0ZGSW5kZXgoKTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGRpY3RzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICB2YXIgZm9udERpY3QgPSBkaWN0c1tpXTsKCiAgICAgICAgaWYgKHJlbW92ZUNpZEtleXMpIHsKICAgICAgICAgIGZvbnREaWN0LnJlbW92ZUJ5TmFtZSgiQ0lERm9udFZlcnNpb24iKTsKICAgICAgICAgIGZvbnREaWN0LnJlbW92ZUJ5TmFtZSgiQ0lERm9udFJldmlzaW9uIik7CiAgICAgICAgICBmb250RGljdC5yZW1vdmVCeU5hbWUoIkNJREZvbnRUeXBlIik7CiAgICAgICAgICBmb250RGljdC5yZW1vdmVCeU5hbWUoIkNJRENvdW50Iik7CiAgICAgICAgICBmb250RGljdC5yZW1vdmVCeU5hbWUoIlVJREJhc2UiKTsKICAgICAgICB9CgogICAgICAgIHZhciBmb250RGljdFRyYWNrZXIgPSBuZXcgQ0ZGT2Zmc2V0VHJhY2tlcigpOwogICAgICAgIHZhciBmb250RGljdERhdGEgPSB0aGlzLmNvbXBpbGVEaWN0KGZvbnREaWN0LCBmb250RGljdFRyYWNrZXIpOwogICAgICAgIGZvbnREaWN0VHJhY2tlcnMucHVzaChmb250RGljdFRyYWNrZXIpOwogICAgICAgIGZkQXJyYXlJbmRleC5hZGQoZm9udERpY3REYXRhKTsKICAgICAgICBmb250RGljdFRyYWNrZXIub2Zmc2V0KGxlbmd0aCk7CiAgICAgIH0KCiAgICAgIGZkQXJyYXlJbmRleCA9IHRoaXMuY29tcGlsZUluZGV4KGZkQXJyYXlJbmRleCwgZm9udERpY3RUcmFja2Vycyk7CiAgICAgIHJldHVybiB7CiAgICAgICAgdHJhY2tlcnM6IGZvbnREaWN0VHJhY2tlcnMsCiAgICAgICAgb3V0cHV0OiBmZEFycmF5SW5kZXgKICAgICAgfTsKICAgIH0sCiAgICBjb21waWxlUHJpdmF0ZURpY3RzOiBmdW5jdGlvbiBDRkZDb21waWxlcl9jb21waWxlUHJpdmF0ZURpY3RzKGRpY3RzLCB0cmFja2Vycywgb3V0cHV0KSB7CiAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGRpY3RzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICB2YXIgZm9udERpY3QgPSBkaWN0c1tpXTsKICAgICAgICB2YXIgcHJpdmF0ZURpY3QgPSBmb250RGljdC5wcml2YXRlRGljdDsKCiAgICAgICAgaWYgKCFwcml2YXRlRGljdCB8fCAhZm9udERpY3QuaGFzTmFtZSgiUHJpdmF0ZSIpKSB7CiAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlRoZXJlIG11c3QgYmUgYSBwcml2YXRlIGRpY3Rpb25hcnkuIik7CiAgICAgICAgfQoKICAgICAgICB2YXIgcHJpdmF0ZURpY3RUcmFja2VyID0gbmV3IENGRk9mZnNldFRyYWNrZXIoKTsKICAgICAgICB2YXIgcHJpdmF0ZURpY3REYXRhID0gdGhpcy5jb21waWxlRGljdChwcml2YXRlRGljdCwgcHJpdmF0ZURpY3RUcmFja2VyKTsKICAgICAgICB2YXIgb3V0cHV0TGVuZ3RoID0gb3V0cHV0Lmxlbmd0aDsKICAgICAgICBwcml2YXRlRGljdFRyYWNrZXIub2Zmc2V0KG91dHB1dExlbmd0aCk7CgogICAgICAgIGlmICghcHJpdmF0ZURpY3REYXRhLmxlbmd0aCkgewogICAgICAgICAgb3V0cHV0TGVuZ3RoID0gMDsKICAgICAgICB9CgogICAgICAgIHRyYWNrZXJzW2ldLnNldEVudHJ5TG9jYXRpb24oIlByaXZhdGUiLCBbcHJpdmF0ZURpY3REYXRhLmxlbmd0aCwgb3V0cHV0TGVuZ3RoXSwgb3V0cHV0KTsKICAgICAgICBvdXRwdXQuYWRkKHByaXZhdGVEaWN0RGF0YSk7CgogICAgICAgIGlmIChwcml2YXRlRGljdC5zdWJyc0luZGV4ICYmIHByaXZhdGVEaWN0Lmhhc05hbWUoIlN1YnJzIikpIHsKICAgICAgICAgIHZhciBzdWJycyA9IHRoaXMuY29tcGlsZUluZGV4KHByaXZhdGVEaWN0LnN1YnJzSW5kZXgpOwogICAgICAgICAgcHJpdmF0ZURpY3RUcmFja2VyLnNldEVudHJ5TG9jYXRpb24oIlN1YnJzIiwgW3ByaXZhdGVEaWN0RGF0YS5sZW5ndGhdLCBvdXRwdXQpOwogICAgICAgICAgb3V0cHV0LmFkZChzdWJycyk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY29tcGlsZURpY3Q6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2NvbXBpbGVEaWN0KGRpY3QsIG9mZnNldFRyYWNrZXIpIHsKICAgICAgdmFyIG91dCA9IFtdOwogICAgICB2YXIgb3JkZXIgPSBkaWN0Lm9yZGVyOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcmRlci5sZW5ndGg7ICsraSkgewogICAgICAgIHZhciBrZXkgPSBvcmRlcltpXTsKCiAgICAgICAgaWYgKCEoa2V5IGluIGRpY3QudmFsdWVzKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgdmFsdWVzID0gZGljdC52YWx1ZXNba2V5XTsKICAgICAgICB2YXIgdHlwZXMgPSBkaWN0LnR5cGVzW2tleV07CgogICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0eXBlcykpIHsKICAgICAgICAgIHR5cGVzID0gW3R5cGVzXTsKICAgICAgICB9CgogICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXMpKSB7CiAgICAgICAgICB2YWx1ZXMgPSBbdmFsdWVzXTsKICAgICAgICB9CgogICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IHR5cGVzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKICAgICAgICAgIHZhciB0eXBlID0gdHlwZXNbal07CiAgICAgICAgICB2YXIgdmFsdWUgPSB2YWx1ZXNbal07CgogICAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICAgIGNhc2UgIm51bSI6CiAgICAgICAgICAgIGNhc2UgInNpZCI6CiAgICAgICAgICAgICAgb3V0ID0gb3V0LmNvbmNhdCh0aGlzLmVuY29kZU51bWJlcih2YWx1ZSkpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAib2Zmc2V0IjoKICAgICAgICAgICAgICB2YXIgbmFtZSA9IGRpY3Qua2V5VG9OYW1lTWFwW2tleV07CgogICAgICAgICAgICAgIGlmICghb2Zmc2V0VHJhY2tlci5pc1RyYWNraW5nKG5hbWUpKSB7CiAgICAgICAgICAgICAgICBvZmZzZXRUcmFja2VyLnRyYWNrKG5hbWUsIG91dC5sZW5ndGgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgb3V0ID0gb3V0LmNvbmNhdChbMHgxZCwgMCwgMCwgMCwgMF0pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAiYXJyYXkiOgogICAgICAgICAgICBjYXNlICJkZWx0YSI6CiAgICAgICAgICAgICAgb3V0ID0gb3V0LmNvbmNhdCh0aGlzLmVuY29kZU51bWJlcih2YWx1ZSkpOwoKICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMSwga2sgPSB2YWx1ZXMubGVuZ3RoOyBrIDwga2s7ICsraykgewogICAgICAgICAgICAgICAgb3V0ID0gb3V0LmNvbmNhdCh0aGlzLmVuY29kZU51bWJlcih2YWx1ZXNba10pKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gZGF0YSB0eXBlIG9mICIuY29uY2F0KHR5cGUpKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG91dCA9IG91dC5jb25jYXQoZGljdC5vcGNvZGVzW2tleV0pOwogICAgICB9CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKICAgIGNvbXBpbGVTdHJpbmdJbmRleDogZnVuY3Rpb24gQ0ZGQ29tcGlsZXJfY29tcGlsZVN0cmluZ0luZGV4KHN0cmluZ3MpIHsKICAgICAgdmFyIHN0cmluZ0luZGV4ID0gbmV3IENGRkluZGV4KCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzdHJpbmdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICBzdHJpbmdJbmRleC5hZGQoKDAsIF91dGlsLnN0cmluZ1RvQnl0ZXMpKHN0cmluZ3NbaV0pKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuY29tcGlsZUluZGV4KHN0cmluZ0luZGV4KTsKICAgIH0sCiAgICBjb21waWxlR2xvYmFsU3VickluZGV4OiBmdW5jdGlvbiBDRkZDb21waWxlcl9jb21waWxlR2xvYmFsU3VickluZGV4KCkgewogICAgICB2YXIgZ2xvYmFsU3VickluZGV4ID0gdGhpcy5jZmYuZ2xvYmFsU3VickluZGV4OwogICAgICB0aGlzLm91dC53cml0ZUJ5dGVBcnJheSh0aGlzLmNvbXBpbGVJbmRleChnbG9iYWxTdWJySW5kZXgpKTsKICAgIH0sCiAgICBjb21waWxlQ2hhclN0cmluZ3M6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2NvbXBpbGVDaGFyU3RyaW5ncyhjaGFyU3RyaW5ncykgewogICAgICB2YXIgY2hhclN0cmluZ3NJbmRleCA9IG5ldyBDRkZJbmRleCgpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFyU3RyaW5ncy5jb3VudDsgaSsrKSB7CiAgICAgICAgdmFyIGdseXBoID0gY2hhclN0cmluZ3MuZ2V0KGkpOwoKICAgICAgICBpZiAoZ2x5cGgubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICBjaGFyU3RyaW5nc0luZGV4LmFkZChuZXcgVWludDhBcnJheShbMHg4YiwgMHgwZV0pKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgY2hhclN0cmluZ3NJbmRleC5hZGQoZ2x5cGgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5jb21waWxlSW5kZXgoY2hhclN0cmluZ3NJbmRleCk7CiAgICB9LAogICAgY29tcGlsZUNoYXJzZXQ6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2NvbXBpbGVDaGFyc2V0KGNoYXJzZXQsIG51bUdseXBocywgc3RyaW5ncywgaXNDSURGb250KSB7CiAgICAgIHZhciBvdXQ7CiAgICAgIHZhciBudW1HbHlwaHNMZXNzTm90RGVmID0gbnVtR2x5cGhzIC0gMTsKCiAgICAgIGlmIChpc0NJREZvbnQpIHsKICAgICAgICBvdXQgPSBuZXcgVWludDhBcnJheShbMiwgMCwgMCwgbnVtR2x5cGhzTGVzc05vdERlZiA+PiA4ICYgMHhmZiwgbnVtR2x5cGhzTGVzc05vdERlZiAmIDB4ZmZdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgbGVuZ3RoID0gMSArIG51bUdseXBoc0xlc3NOb3REZWYgKiAyOwogICAgICAgIG91dCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgICAgICAgb3V0WzBdID0gMDsKICAgICAgICB2YXIgY2hhcnNldEluZGV4ID0gMDsKICAgICAgICB2YXIgbnVtQ2hhcnNldHMgPSBjaGFyc2V0LmNoYXJzZXQubGVuZ3RoOwogICAgICAgIHZhciB3YXJuZWQgPSBmYWxzZTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBvdXQubGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICAgIHZhciBzaWQgPSAwOwoKICAgICAgICAgIGlmIChjaGFyc2V0SW5kZXggPCBudW1DaGFyc2V0cykgewogICAgICAgICAgICB2YXIgbmFtZSA9IGNoYXJzZXQuY2hhcnNldFtjaGFyc2V0SW5kZXgrK107CiAgICAgICAgICAgIHNpZCA9IHN0cmluZ3MuZ2V0U0lEKG5hbWUpOwoKICAgICAgICAgICAgaWYgKHNpZCA9PT0gLTEpIHsKICAgICAgICAgICAgICBzaWQgPSAwOwoKICAgICAgICAgICAgICBpZiAoIXdhcm5lZCkgewogICAgICAgICAgICAgICAgd2FybmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiQ291bGRuJ3QgZmluZCAiLmNvbmNhdChuYW1lLCAiIGluIENGRiBzdHJpbmdzIikpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIG91dFtpXSA9IHNpZCA+PiA4ICYgMHhmZjsKICAgICAgICAgIG91dFtpICsgMV0gPSBzaWQgJiAweGZmOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuY29tcGlsZVR5cGVkQXJyYXkob3V0KTsKICAgIH0sCiAgICBjb21waWxlRW5jb2Rpbmc6IGZ1bmN0aW9uIENGRkNvbXBpbGVyX2NvbXBpbGVFbmNvZGluZyhlbmNvZGluZykgewogICAgICByZXR1cm4gdGhpcy5jb21waWxlVHlwZWRBcnJheShlbmNvZGluZy5yYXcpOwogICAgfSwKICAgIGNvbXBpbGVGRFNlbGVjdDogZnVuY3Rpb24gQ0ZGQ29tcGlsZXJfY29tcGlsZUZEU2VsZWN0KGZkU2VsZWN0KSB7CiAgICAgIHZhciBmb3JtYXQgPSBmZFNlbGVjdC5mb3JtYXQ7CiAgICAgIHZhciBvdXQsIGk7CgogICAgICBzd2l0Y2ggKGZvcm1hdCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIG91dCA9IG5ldyBVaW50OEFycmF5KDEgKyBmZFNlbGVjdC5mZFNlbGVjdC5sZW5ndGgpOwogICAgICAgICAgb3V0WzBdID0gZm9ybWF0OwoKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBmZFNlbGVjdC5mZFNlbGVjdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBvdXRbaSArIDFdID0gZmRTZWxlY3QuZmRTZWxlY3RbaV07CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMzoKICAgICAgICAgIHZhciBzdGFydCA9IDA7CiAgICAgICAgICB2YXIgbGFzdEZEID0gZmRTZWxlY3QuZmRTZWxlY3RbMF07CiAgICAgICAgICB2YXIgcmFuZ2VzID0gW2Zvcm1hdCwgMCwgMCwgc3RhcnQgPj4gOCAmIDB4ZmYsIHN0YXJ0ICYgMHhmZiwgbGFzdEZEXTsKCiAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgZmRTZWxlY3QuZmRTZWxlY3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIGN1cnJlbnRGRCA9IGZkU2VsZWN0LmZkU2VsZWN0W2ldOwoKICAgICAgICAgICAgaWYgKGN1cnJlbnRGRCAhPT0gbGFzdEZEKSB7CiAgICAgICAgICAgICAgcmFuZ2VzLnB1c2goaSA+PiA4ICYgMHhmZiwgaSAmIDB4ZmYsIGN1cnJlbnRGRCk7CiAgICAgICAgICAgICAgbGFzdEZEID0gY3VycmVudEZEOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG51bVJhbmdlcyA9IChyYW5nZXMubGVuZ3RoIC0gMykgLyAzOwogICAgICAgICAgcmFuZ2VzWzFdID0gbnVtUmFuZ2VzID4+IDggJiAweGZmOwogICAgICAgICAgcmFuZ2VzWzJdID0gbnVtUmFuZ2VzICYgMHhmZjsKICAgICAgICAgIHJhbmdlcy5wdXNoKGkgPj4gOCAmIDB4ZmYsIGkgJiAweGZmKTsKICAgICAgICAgIG91dCA9IG5ldyBVaW50OEFycmF5KHJhbmdlcyk7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuY29tcGlsZVR5cGVkQXJyYXkob3V0KTsKICAgIH0sCiAgICBjb21waWxlVHlwZWRBcnJheTogZnVuY3Rpb24gQ0ZGQ29tcGlsZXJfY29tcGlsZVR5cGVkQXJyYXkoZGF0YSkgewogICAgICB2YXIgb3V0ID0gW107CgogICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBkYXRhLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICBvdXRbaV0gPSBkYXRhW2ldOwogICAgICB9CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKICAgIGNvbXBpbGVJbmRleDogZnVuY3Rpb24gQ0ZGQ29tcGlsZXJfY29tcGlsZUluZGV4KGluZGV4LCB0cmFja2VycykgewogICAgICB0cmFja2VycyA9IHRyYWNrZXJzIHx8IFtdOwogICAgICB2YXIgb2JqZWN0cyA9IGluZGV4Lm9iamVjdHM7CiAgICAgIHZhciBjb3VudCA9IG9iamVjdHMubGVuZ3RoOwoKICAgICAgaWYgKGNvdW50ID09PSAwKSB7CiAgICAgICAgcmV0dXJuIFswLCAwLCAwXTsKICAgICAgfQoKICAgICAgdmFyIGRhdGEgPSBbY291bnQgPj4gOCAmIDB4ZmYsIGNvdW50ICYgMHhmZl07CiAgICAgIHZhciBsYXN0T2Zmc2V0ID0gMSwKICAgICAgICAgIGk7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewogICAgICAgIGxhc3RPZmZzZXQgKz0gb2JqZWN0c1tpXS5sZW5ndGg7CiAgICAgIH0KCiAgICAgIHZhciBvZmZzZXRTaXplOwoKICAgICAgaWYgKGxhc3RPZmZzZXQgPCAweDEwMCkgewogICAgICAgIG9mZnNldFNpemUgPSAxOwogICAgICB9IGVsc2UgaWYgKGxhc3RPZmZzZXQgPCAweDEwMDAwKSB7CiAgICAgICAgb2Zmc2V0U2l6ZSA9IDI7CiAgICAgIH0gZWxzZSBpZiAobGFzdE9mZnNldCA8IDB4MTAwMDAwMCkgewogICAgICAgIG9mZnNldFNpemUgPSAzOwogICAgICB9IGVsc2UgewogICAgICAgIG9mZnNldFNpemUgPSA0OwogICAgICB9CgogICAgICBkYXRhLnB1c2gob2Zmc2V0U2l6ZSk7CiAgICAgIHZhciByZWxhdGl2ZU9mZnNldCA9IDE7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQgKyAxOyBpKyspIHsKICAgICAgICBpZiAob2Zmc2V0U2l6ZSA9PT0gMSkgewogICAgICAgICAgZGF0YS5wdXNoKHJlbGF0aXZlT2Zmc2V0ICYgMHhmZik7CiAgICAgICAgfSBlbHNlIGlmIChvZmZzZXRTaXplID09PSAyKSB7CiAgICAgICAgICBkYXRhLnB1c2gocmVsYXRpdmVPZmZzZXQgPj4gOCAmIDB4ZmYsIHJlbGF0aXZlT2Zmc2V0ICYgMHhmZik7CiAgICAgICAgfSBlbHNlIGlmIChvZmZzZXRTaXplID09PSAzKSB7CiAgICAgICAgICBkYXRhLnB1c2gocmVsYXRpdmVPZmZzZXQgPj4gMTYgJiAweGZmLCByZWxhdGl2ZU9mZnNldCA+PiA4ICYgMHhmZiwgcmVsYXRpdmVPZmZzZXQgJiAweGZmKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGF0YS5wdXNoKHJlbGF0aXZlT2Zmc2V0ID4+PiAyNCAmIDB4ZmYsIHJlbGF0aXZlT2Zmc2V0ID4+IDE2ICYgMHhmZiwgcmVsYXRpdmVPZmZzZXQgPj4gOCAmIDB4ZmYsIHJlbGF0aXZlT2Zmc2V0ICYgMHhmZik7CiAgICAgICAgfQoKICAgICAgICBpZiAob2JqZWN0c1tpXSkgewogICAgICAgICAgcmVsYXRpdmVPZmZzZXQgKz0gb2JqZWN0c1tpXS5sZW5ndGg7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIGlmICh0cmFja2Vyc1tpXSkgewogICAgICAgICAgdHJhY2tlcnNbaV0ub2Zmc2V0KGRhdGEubGVuZ3RoKTsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IG9iamVjdHNbaV0ubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgICAgZGF0YS5wdXNoKG9iamVjdHNbaV1bal0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGRhdGE7CiAgICB9CiAgfTsKICByZXR1cm4gQ0ZGQ29tcGlsZXI7Cn0oKTsKCmV4cG9ydHMuQ0ZGQ29tcGlsZXIgPSBDRkZDb21waWxlcjsKCi8qKiovIH0pLAovKiAyMjQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5FeHBlcnRTdWJzZXRDaGFyc2V0ID0gZXhwb3J0cy5FeHBlcnRDaGFyc2V0ID0gZXhwb3J0cy5JU09BZG9iZUNoYXJzZXQgPSB2b2lkIDA7CnZhciBJU09BZG9iZUNoYXJzZXQgPSBbIi5ub3RkZWYiLCAic3BhY2UiLCAiZXhjbGFtIiwgInF1b3RlZGJsIiwgIm51bWJlcnNpZ24iLCAiZG9sbGFyIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInF1b3RlcmlnaHQiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2siLCAicGx1cyIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJhdCIsICJBIiwgIkIiLCAiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkgiLCAiSSIsICJKIiwgIksiLCAiTCIsICJNIiwgIk4iLCAiTyIsICJQIiwgIlEiLCAiUiIsICJTIiwgIlQiLCAiVSIsICJWIiwgIlciLCAiWCIsICJZIiwgIloiLCAiYnJhY2tldGxlZnQiLCAiYmFja3NsYXNoIiwgImJyYWNrZXRyaWdodCIsICJhc2NpaWNpcmN1bSIsICJ1bmRlcnNjb3JlIiwgInF1b3RlbGVmdCIsICJhIiwgImIiLCAiYyIsICJkIiwgImUiLCAiZiIsICJnIiwgImgiLCAiaSIsICJqIiwgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsICJ2IiwgInciLCAieCIsICJ5IiwgInoiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgImFzY2lpdGlsZGUiLCAiZXhjbGFtZG93biIsICJjZW50IiwgInN0ZXJsaW5nIiwgImZyYWN0aW9uIiwgInllbiIsICJmbG9yaW4iLCAic2VjdGlvbiIsICJjdXJyZW5jeSIsICJxdW90ZXNpbmdsZSIsICJxdW90ZWRibGxlZnQiLCAiZ3VpbGxlbW90bGVmdCIsICJndWlsc2luZ2xsZWZ0IiwgImd1aWxzaW5nbHJpZ2h0IiwgImZpIiwgImZsIiwgImVuZGFzaCIsICJkYWdnZXIiLCAiZGFnZ2VyZGJsIiwgInBlcmlvZGNlbnRlcmVkIiwgInBhcmFncmFwaCIsICJidWxsZXQiLCAicXVvdGVzaW5nbGJhc2UiLCAicXVvdGVkYmxiYXNlIiwgInF1b3RlZGJscmlnaHQiLCAiZ3VpbGxlbW90cmlnaHQiLCAiZWxsaXBzaXMiLCAicGVydGhvdXNhbmQiLCAicXVlc3Rpb25kb3duIiwgImdyYXZlIiwgImFjdXRlIiwgImNpcmN1bWZsZXgiLCAidGlsZGUiLCAibWFjcm9uIiwgImJyZXZlIiwgImRvdGFjY2VudCIsICJkaWVyZXNpcyIsICJyaW5nIiwgImNlZGlsbGEiLCAiaHVuZ2FydW1sYXV0IiwgIm9nb25layIsICJjYXJvbiIsICJlbWRhc2giLCAiQUUiLCAib3JkZmVtaW5pbmUiLCAiTHNsYXNoIiwgIk9zbGFzaCIsICJPRSIsICJvcmRtYXNjdWxpbmUiLCAiYWUiLCAiZG90bGVzc2kiLCAibHNsYXNoIiwgIm9zbGFzaCIsICJvZSIsICJnZXJtYW5kYmxzIiwgIm9uZXN1cGVyaW9yIiwgImxvZ2ljYWxub3QiLCAibXUiLCAidHJhZGVtYXJrIiwgIkV0aCIsICJvbmVoYWxmIiwgInBsdXNtaW51cyIsICJUaG9ybiIsICJvbmVxdWFydGVyIiwgImRpdmlkZSIsICJicm9rZW5iYXIiLCAiZGVncmVlIiwgInRob3JuIiwgInRocmVlcXVhcnRlcnMiLCAidHdvc3VwZXJpb3IiLCAicmVnaXN0ZXJlZCIsICJtaW51cyIsICJldGgiLCAibXVsdGlwbHkiLCAidGhyZWVzdXBlcmlvciIsICJjb3B5cmlnaHQiLCAiQWFjdXRlIiwgIkFjaXJjdW1mbGV4IiwgIkFkaWVyZXNpcyIsICJBZ3JhdmUiLCAiQXJpbmciLCAiQXRpbGRlIiwgIkNjZWRpbGxhIiwgIkVhY3V0ZSIsICJFY2lyY3VtZmxleCIsICJFZGllcmVzaXMiLCAiRWdyYXZlIiwgIklhY3V0ZSIsICJJY2lyY3VtZmxleCIsICJJZGllcmVzaXMiLCAiSWdyYXZlIiwgIk50aWxkZSIsICJPYWN1dGUiLCAiT2NpcmN1bWZsZXgiLCAiT2RpZXJlc2lzIiwgIk9ncmF2ZSIsICJPdGlsZGUiLCAiU2Nhcm9uIiwgIlVhY3V0ZSIsICJVY2lyY3VtZmxleCIsICJVZGllcmVzaXMiLCAiVWdyYXZlIiwgIllhY3V0ZSIsICJZZGllcmVzaXMiLCAiWmNhcm9uIiwgImFhY3V0ZSIsICJhY2lyY3VtZmxleCIsICJhZGllcmVzaXMiLCAiYWdyYXZlIiwgImFyaW5nIiwgImF0aWxkZSIsICJjY2VkaWxsYSIsICJlYWN1dGUiLCAiZWNpcmN1bWZsZXgiLCAiZWRpZXJlc2lzIiwgImVncmF2ZSIsICJpYWN1dGUiLCAiaWNpcmN1bWZsZXgiLCAiaWRpZXJlc2lzIiwgImlncmF2ZSIsICJudGlsZGUiLCAib2FjdXRlIiwgIm9jaXJjdW1mbGV4IiwgIm9kaWVyZXNpcyIsICJvZ3JhdmUiLCAib3RpbGRlIiwgInNjYXJvbiIsICJ1YWN1dGUiLCAidWNpcmN1bWZsZXgiLCAidWRpZXJlc2lzIiwgInVncmF2ZSIsICJ5YWN1dGUiLCAieWRpZXJlc2lzIiwgInpjYXJvbiJdOwpleHBvcnRzLklTT0Fkb2JlQ2hhcnNldCA9IElTT0Fkb2JlQ2hhcnNldDsKdmFyIEV4cGVydENoYXJzZXQgPSBbIi5ub3RkZWYiLCAic3BhY2UiLCAiZXhjbGFtc21hbGwiLCAiSHVuZ2FydW1sYXV0c21hbGwiLCAiZG9sbGFyb2xkc3R5bGUiLCAiZG9sbGFyc3VwZXJpb3IiLCAiYW1wZXJzYW5kc21hbGwiLCAiQWN1dGVzbWFsbCIsICJwYXJlbmxlZnRzdXBlcmlvciIsICJwYXJlbnJpZ2h0c3VwZXJpb3IiLCAidHdvZG90ZW5sZWFkZXIiLCAib25lZG90ZW5sZWFkZXIiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJmcmFjdGlvbiIsICJ6ZXJvb2xkc3R5bGUiLCAib25lb2xkc3R5bGUiLCAidHdvb2xkc3R5bGUiLCAidGhyZWVvbGRzdHlsZSIsICJmb3Vyb2xkc3R5bGUiLCAiZml2ZW9sZHN0eWxlIiwgInNpeG9sZHN0eWxlIiwgInNldmVub2xkc3R5bGUiLCAiZWlnaHRvbGRzdHlsZSIsICJuaW5lb2xkc3R5bGUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImNvbW1hc3VwZXJpb3IiLCAidGhyZWVxdWFydGVyc2VtZGFzaCIsICJwZXJpb2RzdXBlcmlvciIsICJxdWVzdGlvbnNtYWxsIiwgImFzdXBlcmlvciIsICJic3VwZXJpb3IiLCAiY2VudHN1cGVyaW9yIiwgImRzdXBlcmlvciIsICJlc3VwZXJpb3IiLCAiaXN1cGVyaW9yIiwgImxzdXBlcmlvciIsICJtc3VwZXJpb3IiLCAibnN1cGVyaW9yIiwgIm9zdXBlcmlvciIsICJyc3VwZXJpb3IiLCAic3N1cGVyaW9yIiwgInRzdXBlcmlvciIsICJmZiIsICJmaSIsICJmbCIsICJmZmkiLCAiZmZsIiwgInBhcmVubGVmdGluZmVyaW9yIiwgInBhcmVucmlnaHRpbmZlcmlvciIsICJDaXJjdW1mbGV4c21hbGwiLCAiaHlwaGVuc3VwZXJpb3IiLCAiR3JhdmVzbWFsbCIsICJBc21hbGwiLCAiQnNtYWxsIiwgIkNzbWFsbCIsICJEc21hbGwiLCAiRXNtYWxsIiwgIkZzbWFsbCIsICJHc21hbGwiLCAiSHNtYWxsIiwgIklzbWFsbCIsICJKc21hbGwiLCAiS3NtYWxsIiwgIkxzbWFsbCIsICJNc21hbGwiLCAiTnNtYWxsIiwgIk9zbWFsbCIsICJQc21hbGwiLCAiUXNtYWxsIiwgIlJzbWFsbCIsICJTc21hbGwiLCAiVHNtYWxsIiwgIlVzbWFsbCIsICJWc21hbGwiLCAiV3NtYWxsIiwgIlhzbWFsbCIsICJZc21hbGwiLCAiWnNtYWxsIiwgImNvbG9ubW9uZXRhcnkiLCAib25lZml0dGVkIiwgInJ1cGlhaCIsICJUaWxkZXNtYWxsIiwgImV4Y2xhbWRvd25zbWFsbCIsICJjZW50b2xkc3R5bGUiLCAiTHNsYXNoc21hbGwiLCAiU2Nhcm9uc21hbGwiLCAiWmNhcm9uc21hbGwiLCAiRGllcmVzaXNzbWFsbCIsICJCcmV2ZXNtYWxsIiwgIkNhcm9uc21hbGwiLCAiRG90YWNjZW50c21hbGwiLCAiTWFjcm9uc21hbGwiLCAiZmlndXJlZGFzaCIsICJoeXBoZW5pbmZlcmlvciIsICJPZ29uZWtzbWFsbCIsICJSaW5nc21hbGwiLCAiQ2VkaWxsYXNtYWxsIiwgIm9uZXF1YXJ0ZXIiLCAib25laGFsZiIsICJ0aHJlZXF1YXJ0ZXJzIiwgInF1ZXN0aW9uZG93bnNtYWxsIiwgIm9uZWVpZ2h0aCIsICJ0aHJlZWVpZ2h0aHMiLCAiZml2ZWVpZ2h0aHMiLCAic2V2ZW5laWdodGhzIiwgIm9uZXRoaXJkIiwgInR3b3RoaXJkcyIsICJ6ZXJvc3VwZXJpb3IiLCAib25lc3VwZXJpb3IiLCAidHdvc3VwZXJpb3IiLCAidGhyZWVzdXBlcmlvciIsICJmb3Vyc3VwZXJpb3IiLCAiZml2ZXN1cGVyaW9yIiwgInNpeHN1cGVyaW9yIiwgInNldmVuc3VwZXJpb3IiLCAiZWlnaHRzdXBlcmlvciIsICJuaW5lc3VwZXJpb3IiLCAiemVyb2luZmVyaW9yIiwgIm9uZWluZmVyaW9yIiwgInR3b2luZmVyaW9yIiwgInRocmVlaW5mZXJpb3IiLCAiZm91cmluZmVyaW9yIiwgImZpdmVpbmZlcmlvciIsICJzaXhpbmZlcmlvciIsICJzZXZlbmluZmVyaW9yIiwgImVpZ2h0aW5mZXJpb3IiLCAibmluZWluZmVyaW9yIiwgImNlbnRpbmZlcmlvciIsICJkb2xsYXJpbmZlcmlvciIsICJwZXJpb2RpbmZlcmlvciIsICJjb21tYWluZmVyaW9yIiwgIkFncmF2ZXNtYWxsIiwgIkFhY3V0ZXNtYWxsIiwgIkFjaXJjdW1mbGV4c21hbGwiLCAiQXRpbGRlc21hbGwiLCAiQWRpZXJlc2lzc21hbGwiLCAiQXJpbmdzbWFsbCIsICJBRXNtYWxsIiwgIkNjZWRpbGxhc21hbGwiLCAiRWdyYXZlc21hbGwiLCAiRWFjdXRlc21hbGwiLCAiRWNpcmN1bWZsZXhzbWFsbCIsICJFZGllcmVzaXNzbWFsbCIsICJJZ3JhdmVzbWFsbCIsICJJYWN1dGVzbWFsbCIsICJJY2lyY3VtZmxleHNtYWxsIiwgIklkaWVyZXNpc3NtYWxsIiwgIkV0aHNtYWxsIiwgIk50aWxkZXNtYWxsIiwgIk9ncmF2ZXNtYWxsIiwgIk9hY3V0ZXNtYWxsIiwgIk9jaXJjdW1mbGV4c21hbGwiLCAiT3RpbGRlc21hbGwiLCAiT2RpZXJlc2lzc21hbGwiLCAiT0VzbWFsbCIsICJPc2xhc2hzbWFsbCIsICJVZ3JhdmVzbWFsbCIsICJVYWN1dGVzbWFsbCIsICJVY2lyY3VtZmxleHNtYWxsIiwgIlVkaWVyZXNpc3NtYWxsIiwgIllhY3V0ZXNtYWxsIiwgIlRob3Juc21hbGwiLCAiWWRpZXJlc2lzc21hbGwiXTsKZXhwb3J0cy5FeHBlcnRDaGFyc2V0ID0gRXhwZXJ0Q2hhcnNldDsKdmFyIEV4cGVydFN1YnNldENoYXJzZXQgPSBbIi5ub3RkZWYiLCAic3BhY2UiLCAiZG9sbGFyb2xkc3R5bGUiLCAiZG9sbGFyc3VwZXJpb3IiLCAicGFyZW5sZWZ0c3VwZXJpb3IiLCAicGFyZW5yaWdodHN1cGVyaW9yIiwgInR3b2RvdGVubGVhZGVyIiwgIm9uZWRvdGVubGVhZGVyIiwgImNvbW1hIiwgImh5cGhlbiIsICJwZXJpb2QiLCAiZnJhY3Rpb24iLCAiemVyb29sZHN0eWxlIiwgIm9uZW9sZHN0eWxlIiwgInR3b29sZHN0eWxlIiwgInRocmVlb2xkc3R5bGUiLCAiZm91cm9sZHN0eWxlIiwgImZpdmVvbGRzdHlsZSIsICJzaXhvbGRzdHlsZSIsICJzZXZlbm9sZHN0eWxlIiwgImVpZ2h0b2xkc3R5bGUiLCAibmluZW9sZHN0eWxlIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJjb21tYXN1cGVyaW9yIiwgInRocmVlcXVhcnRlcnNlbWRhc2giLCAicGVyaW9kc3VwZXJpb3IiLCAiYXN1cGVyaW9yIiwgImJzdXBlcmlvciIsICJjZW50c3VwZXJpb3IiLCAiZHN1cGVyaW9yIiwgImVzdXBlcmlvciIsICJpc3VwZXJpb3IiLCAibHN1cGVyaW9yIiwgIm1zdXBlcmlvciIsICJuc3VwZXJpb3IiLCAib3N1cGVyaW9yIiwgInJzdXBlcmlvciIsICJzc3VwZXJpb3IiLCAidHN1cGVyaW9yIiwgImZmIiwgImZpIiwgImZsIiwgImZmaSIsICJmZmwiLCAicGFyZW5sZWZ0aW5mZXJpb3IiLCAicGFyZW5yaWdodGluZmVyaW9yIiwgImh5cGhlbnN1cGVyaW9yIiwgImNvbG9ubW9uZXRhcnkiLCAib25lZml0dGVkIiwgInJ1cGlhaCIsICJjZW50b2xkc3R5bGUiLCAiZmlndXJlZGFzaCIsICJoeXBoZW5pbmZlcmlvciIsICJvbmVxdWFydGVyIiwgIm9uZWhhbGYiLCAidGhyZWVxdWFydGVycyIsICJvbmVlaWdodGgiLCAidGhyZWVlaWdodGhzIiwgImZpdmVlaWdodGhzIiwgInNldmVuZWlnaHRocyIsICJvbmV0aGlyZCIsICJ0d290aGlyZHMiLCAiemVyb3N1cGVyaW9yIiwgIm9uZXN1cGVyaW9yIiwgInR3b3N1cGVyaW9yIiwgInRocmVlc3VwZXJpb3IiLCAiZm91cnN1cGVyaW9yIiwgImZpdmVzdXBlcmlvciIsICJzaXhzdXBlcmlvciIsICJzZXZlbnN1cGVyaW9yIiwgImVpZ2h0c3VwZXJpb3IiLCAibmluZXN1cGVyaW9yIiwgInplcm9pbmZlcmlvciIsICJvbmVpbmZlcmlvciIsICJ0d29pbmZlcmlvciIsICJ0aHJlZWluZmVyaW9yIiwgImZvdXJpbmZlcmlvciIsICJmaXZlaW5mZXJpb3IiLCAic2l4aW5mZXJpb3IiLCAic2V2ZW5pbmZlcmlvciIsICJlaWdodGluZmVyaW9yIiwgIm5pbmVpbmZlcmlvciIsICJjZW50aW5mZXJpb3IiLCAiZG9sbGFyaW5mZXJpb3IiLCAicGVyaW9kaW5mZXJpb3IiLCAiY29tbWFpbmZlcmlvciJdOwpleHBvcnRzLkV4cGVydFN1YnNldENoYXJzZXQgPSBFeHBlcnRTdWJzZXRDaGFyc2V0OwoKLyoqKi8gfSksCi8qIDIyNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmdldEVuY29kaW5nID0gZ2V0RW5jb2Rpbmc7CmV4cG9ydHMuRXhwZXJ0RW5jb2RpbmcgPSBleHBvcnRzLlphcGZEaW5nYmF0c0VuY29kaW5nID0gZXhwb3J0cy5TeW1ib2xTZXRFbmNvZGluZyA9IGV4cG9ydHMuTWFjUm9tYW5FbmNvZGluZyA9IGV4cG9ydHMuU3RhbmRhcmRFbmNvZGluZyA9IGV4cG9ydHMuV2luQW5zaUVuY29kaW5nID0gdm9pZCAwOwp2YXIgRXhwZXJ0RW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiZXhjbGFtc21hbGwiLCAiSHVuZ2FydW1sYXV0c21hbGwiLCAiIiwgImRvbGxhcm9sZHN0eWxlIiwgImRvbGxhcnN1cGVyaW9yIiwgImFtcGVyc2FuZHNtYWxsIiwgIkFjdXRlc21hbGwiLCAicGFyZW5sZWZ0c3VwZXJpb3IiLCAicGFyZW5yaWdodHN1cGVyaW9yIiwgInR3b2RvdGVubGVhZGVyIiwgIm9uZWRvdGVubGVhZGVyIiwgImNvbW1hIiwgImh5cGhlbiIsICJwZXJpb2QiLCAiZnJhY3Rpb24iLCAiemVyb29sZHN0eWxlIiwgIm9uZW9sZHN0eWxlIiwgInR3b29sZHN0eWxlIiwgInRocmVlb2xkc3R5bGUiLCAiZm91cm9sZHN0eWxlIiwgImZpdmVvbGRzdHlsZSIsICJzaXhvbGRzdHlsZSIsICJzZXZlbm9sZHN0eWxlIiwgImVpZ2h0b2xkc3R5bGUiLCAibmluZW9sZHN0eWxlIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJjb21tYXN1cGVyaW9yIiwgInRocmVlcXVhcnRlcnNlbWRhc2giLCAicGVyaW9kc3VwZXJpb3IiLCAicXVlc3Rpb25zbWFsbCIsICIiLCAiYXN1cGVyaW9yIiwgImJzdXBlcmlvciIsICJjZW50c3VwZXJpb3IiLCAiZHN1cGVyaW9yIiwgImVzdXBlcmlvciIsICIiLCAiIiwgIiIsICJpc3VwZXJpb3IiLCAiIiwgIiIsICJsc3VwZXJpb3IiLCAibXN1cGVyaW9yIiwgIm5zdXBlcmlvciIsICJvc3VwZXJpb3IiLCAiIiwgIiIsICJyc3VwZXJpb3IiLCAic3N1cGVyaW9yIiwgInRzdXBlcmlvciIsICIiLCAiZmYiLCAiZmkiLCAiZmwiLCAiZmZpIiwgImZmbCIsICJwYXJlbmxlZnRpbmZlcmlvciIsICIiLCAicGFyZW5yaWdodGluZmVyaW9yIiwgIkNpcmN1bWZsZXhzbWFsbCIsICJoeXBoZW5zdXBlcmlvciIsICJHcmF2ZXNtYWxsIiwgIkFzbWFsbCIsICJCc21hbGwiLCAiQ3NtYWxsIiwgIkRzbWFsbCIsICJFc21hbGwiLCAiRnNtYWxsIiwgIkdzbWFsbCIsICJIc21hbGwiLCAiSXNtYWxsIiwgIkpzbWFsbCIsICJLc21hbGwiLCAiTHNtYWxsIiwgIk1zbWFsbCIsICJOc21hbGwiLCAiT3NtYWxsIiwgIlBzbWFsbCIsICJRc21hbGwiLCAiUnNtYWxsIiwgIlNzbWFsbCIsICJUc21hbGwiLCAiVXNtYWxsIiwgIlZzbWFsbCIsICJXc21hbGwiLCAiWHNtYWxsIiwgIllzbWFsbCIsICJac21hbGwiLCAiY29sb25tb25ldGFyeSIsICJvbmVmaXR0ZWQiLCAicnVwaWFoIiwgIlRpbGRlc21hbGwiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgImV4Y2xhbWRvd25zbWFsbCIsICJjZW50b2xkc3R5bGUiLCAiTHNsYXNoc21hbGwiLCAiIiwgIiIsICJTY2Fyb25zbWFsbCIsICJaY2Fyb25zbWFsbCIsICJEaWVyZXNpc3NtYWxsIiwgIkJyZXZlc21hbGwiLCAiQ2Fyb25zbWFsbCIsICIiLCAiRG90YWNjZW50c21hbGwiLCAiIiwgIiIsICJNYWNyb25zbWFsbCIsICIiLCAiIiwgImZpZ3VyZWRhc2giLCAiaHlwaGVuaW5mZXJpb3IiLCAiIiwgIiIsICJPZ29uZWtzbWFsbCIsICJSaW5nc21hbGwiLCAiQ2VkaWxsYXNtYWxsIiwgIiIsICIiLCAiIiwgIm9uZXF1YXJ0ZXIiLCAib25laGFsZiIsICJ0aHJlZXF1YXJ0ZXJzIiwgInF1ZXN0aW9uZG93bnNtYWxsIiwgIm9uZWVpZ2h0aCIsICJ0aHJlZWVpZ2h0aHMiLCAiZml2ZWVpZ2h0aHMiLCAic2V2ZW5laWdodGhzIiwgIm9uZXRoaXJkIiwgInR3b3RoaXJkcyIsICIiLCAiIiwgInplcm9zdXBlcmlvciIsICJvbmVzdXBlcmlvciIsICJ0d29zdXBlcmlvciIsICJ0aHJlZXN1cGVyaW9yIiwgImZvdXJzdXBlcmlvciIsICJmaXZlc3VwZXJpb3IiLCAic2l4c3VwZXJpb3IiLCAic2V2ZW5zdXBlcmlvciIsICJlaWdodHN1cGVyaW9yIiwgIm5pbmVzdXBlcmlvciIsICJ6ZXJvaW5mZXJpb3IiLCAib25laW5mZXJpb3IiLCAidHdvaW5mZXJpb3IiLCAidGhyZWVpbmZlcmlvciIsICJmb3VyaW5mZXJpb3IiLCAiZml2ZWluZmVyaW9yIiwgInNpeGluZmVyaW9yIiwgInNldmVuaW5mZXJpb3IiLCAiZWlnaHRpbmZlcmlvciIsICJuaW5laW5mZXJpb3IiLCAiY2VudGluZmVyaW9yIiwgImRvbGxhcmluZmVyaW9yIiwgInBlcmlvZGluZmVyaW9yIiwgImNvbW1haW5mZXJpb3IiLCAiQWdyYXZlc21hbGwiLCAiQWFjdXRlc21hbGwiLCAiQWNpcmN1bWZsZXhzbWFsbCIsICJBdGlsZGVzbWFsbCIsICJBZGllcmVzaXNzbWFsbCIsICJBcmluZ3NtYWxsIiwgIkFFc21hbGwiLCAiQ2NlZGlsbGFzbWFsbCIsICJFZ3JhdmVzbWFsbCIsICJFYWN1dGVzbWFsbCIsICJFY2lyY3VtZmxleHNtYWxsIiwgIkVkaWVyZXNpc3NtYWxsIiwgIklncmF2ZXNtYWxsIiwgIklhY3V0ZXNtYWxsIiwgIkljaXJjdW1mbGV4c21hbGwiLCAiSWRpZXJlc2lzc21hbGwiLCAiRXRoc21hbGwiLCAiTnRpbGRlc21hbGwiLCAiT2dyYXZlc21hbGwiLCAiT2FjdXRlc21hbGwiLCAiT2NpcmN1bWZsZXhzbWFsbCIsICJPdGlsZGVzbWFsbCIsICJPZGllcmVzaXNzbWFsbCIsICJPRXNtYWxsIiwgIk9zbGFzaHNtYWxsIiwgIlVncmF2ZXNtYWxsIiwgIlVhY3V0ZXNtYWxsIiwgIlVjaXJjdW1mbGV4c21hbGwiLCAiVWRpZXJlc2lzc21hbGwiLCAiWWFjdXRlc21hbGwiLCAiVGhvcm5zbWFsbCIsICJZZGllcmVzaXNzbWFsbCJdOwpleHBvcnRzLkV4cGVydEVuY29kaW5nID0gRXhwZXJ0RW5jb2Rpbmc7CnZhciBNYWNFeHBlcnRFbmNvZGluZyA9IFsiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJzcGFjZSIsICJleGNsYW1zbWFsbCIsICJIdW5nYXJ1bWxhdXRzbWFsbCIsICJjZW50b2xkc3R5bGUiLCAiZG9sbGFyb2xkc3R5bGUiLCAiZG9sbGFyc3VwZXJpb3IiLCAiYW1wZXJzYW5kc21hbGwiLCAiQWN1dGVzbWFsbCIsICJwYXJlbmxlZnRzdXBlcmlvciIsICJwYXJlbnJpZ2h0c3VwZXJpb3IiLCAidHdvZG90ZW5sZWFkZXIiLCAib25lZG90ZW5sZWFkZXIiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJmcmFjdGlvbiIsICJ6ZXJvb2xkc3R5bGUiLCAib25lb2xkc3R5bGUiLCAidHdvb2xkc3R5bGUiLCAidGhyZWVvbGRzdHlsZSIsICJmb3Vyb2xkc3R5bGUiLCAiZml2ZW9sZHN0eWxlIiwgInNpeG9sZHN0eWxlIiwgInNldmVub2xkc3R5bGUiLCAiZWlnaHRvbGRzdHlsZSIsICJuaW5lb2xkc3R5bGUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgIiIsICJ0aHJlZXF1YXJ0ZXJzZW1kYXNoIiwgIiIsICJxdWVzdGlvbnNtYWxsIiwgIiIsICIiLCAiIiwgIiIsICJFdGhzbWFsbCIsICIiLCAiIiwgIm9uZXF1YXJ0ZXIiLCAib25laGFsZiIsICJ0aHJlZXF1YXJ0ZXJzIiwgIm9uZWVpZ2h0aCIsICJ0aHJlZWVpZ2h0aHMiLCAiZml2ZWVpZ2h0aHMiLCAic2V2ZW5laWdodGhzIiwgIm9uZXRoaXJkIiwgInR3b3RoaXJkcyIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJmZiIsICJmaSIsICJmbCIsICJmZmkiLCAiZmZsIiwgInBhcmVubGVmdGluZmVyaW9yIiwgIiIsICJwYXJlbnJpZ2h0aW5mZXJpb3IiLCAiQ2lyY3VtZmxleHNtYWxsIiwgImh5cGhlbmluZmVyaW9yIiwgIkdyYXZlc21hbGwiLCAiQXNtYWxsIiwgIkJzbWFsbCIsICJDc21hbGwiLCAiRHNtYWxsIiwgIkVzbWFsbCIsICJGc21hbGwiLCAiR3NtYWxsIiwgIkhzbWFsbCIsICJJc21hbGwiLCAiSnNtYWxsIiwgIktzbWFsbCIsICJMc21hbGwiLCAiTXNtYWxsIiwgIk5zbWFsbCIsICJPc21hbGwiLCAiUHNtYWxsIiwgIlFzbWFsbCIsICJSc21hbGwiLCAiU3NtYWxsIiwgIlRzbWFsbCIsICJVc21hbGwiLCAiVnNtYWxsIiwgIldzbWFsbCIsICJYc21hbGwiLCAiWXNtYWxsIiwgIlpzbWFsbCIsICJjb2xvbm1vbmV0YXJ5IiwgIm9uZWZpdHRlZCIsICJydXBpYWgiLCAiVGlsZGVzbWFsbCIsICIiLCAiIiwgImFzdXBlcmlvciIsICJjZW50c3VwZXJpb3IiLCAiIiwgIiIsICIiLCAiIiwgIkFhY3V0ZXNtYWxsIiwgIkFncmF2ZXNtYWxsIiwgIkFjaXJjdW1mbGV4c21hbGwiLCAiQWRpZXJlc2lzc21hbGwiLCAiQXRpbGRlc21hbGwiLCAiQXJpbmdzbWFsbCIsICJDY2VkaWxsYXNtYWxsIiwgIkVhY3V0ZXNtYWxsIiwgIkVncmF2ZXNtYWxsIiwgIkVjaXJjdW1mbGV4c21hbGwiLCAiRWRpZXJlc2lzc21hbGwiLCAiSWFjdXRlc21hbGwiLCAiSWdyYXZlc21hbGwiLCAiSWNpcmN1bWZsZXhzbWFsbCIsICJJZGllcmVzaXNzbWFsbCIsICJOdGlsZGVzbWFsbCIsICJPYWN1dGVzbWFsbCIsICJPZ3JhdmVzbWFsbCIsICJPY2lyY3VtZmxleHNtYWxsIiwgIk9kaWVyZXNpc3NtYWxsIiwgIk90aWxkZXNtYWxsIiwgIlVhY3V0ZXNtYWxsIiwgIlVncmF2ZXNtYWxsIiwgIlVjaXJjdW1mbGV4c21hbGwiLCAiVWRpZXJlc2lzc21hbGwiLCAiIiwgImVpZ2h0c3VwZXJpb3IiLCAiZm91cmluZmVyaW9yIiwgInRocmVlaW5mZXJpb3IiLCAic2l4aW5mZXJpb3IiLCAiZWlnaHRpbmZlcmlvciIsICJzZXZlbmluZmVyaW9yIiwgIlNjYXJvbnNtYWxsIiwgIiIsICJjZW50aW5mZXJpb3IiLCAidHdvaW5mZXJpb3IiLCAiIiwgIkRpZXJlc2lzc21hbGwiLCAiIiwgIkNhcm9uc21hbGwiLCAib3N1cGVyaW9yIiwgImZpdmVpbmZlcmlvciIsICIiLCAiY29tbWFpbmZlcmlvciIsICJwZXJpb2RpbmZlcmlvciIsICJZYWN1dGVzbWFsbCIsICIiLCAiZG9sbGFyaW5mZXJpb3IiLCAiIiwgIiIsICJUaG9ybnNtYWxsIiwgIiIsICJuaW5laW5mZXJpb3IiLCAiemVyb2luZmVyaW9yIiwgIlpjYXJvbnNtYWxsIiwgIkFFc21hbGwiLCAiT3NsYXNoc21hbGwiLCAicXVlc3Rpb25kb3duc21hbGwiLCAib25laW5mZXJpb3IiLCAiTHNsYXNoc21hbGwiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiQ2VkaWxsYXNtYWxsIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiT0VzbWFsbCIsICJmaWd1cmVkYXNoIiwgImh5cGhlbnN1cGVyaW9yIiwgIiIsICIiLCAiIiwgIiIsICJleGNsYW1kb3duc21hbGwiLCAiIiwgIllkaWVyZXNpc3NtYWxsIiwgIiIsICJvbmVzdXBlcmlvciIsICJ0d29zdXBlcmlvciIsICJ0aHJlZXN1cGVyaW9yIiwgImZvdXJzdXBlcmlvciIsICJmaXZlc3VwZXJpb3IiLCAic2l4c3VwZXJpb3IiLCAic2V2ZW5zdXBlcmlvciIsICJuaW5lc3VwZXJpb3IiLCAiemVyb3N1cGVyaW9yIiwgIiIsICJlc3VwZXJpb3IiLCAicnN1cGVyaW9yIiwgInRzdXBlcmlvciIsICIiLCAiIiwgImlzdXBlcmlvciIsICJzc3VwZXJpb3IiLCAiZHN1cGVyaW9yIiwgIiIsICIiLCAiIiwgIiIsICIiLCAibHN1cGVyaW9yIiwgIk9nb25la3NtYWxsIiwgIkJyZXZlc21hbGwiLCAiTWFjcm9uc21hbGwiLCAiYnN1cGVyaW9yIiwgIm5zdXBlcmlvciIsICJtc3VwZXJpb3IiLCAiY29tbWFzdXBlcmlvciIsICJwZXJpb2RzdXBlcmlvciIsICJEb3RhY2NlbnRzbWFsbCIsICJSaW5nc21hbGwiLCAiIiwgIiIsICIiLCAiIl07CnZhciBNYWNSb21hbkVuY29kaW5nID0gWyIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgInNwYWNlIiwgImV4Y2xhbSIsICJxdW90ZWRibCIsICJudW1iZXJzaWduIiwgImRvbGxhciIsICJwZXJjZW50IiwgImFtcGVyc2FuZCIsICJxdW90ZXNpbmdsZSIsICJwYXJlbmxlZnQiLCAicGFyZW5yaWdodCIsICJhc3RlcmlzayIsICJwbHVzIiwgImNvbW1hIiwgImh5cGhlbiIsICJwZXJpb2QiLCAic2xhc2giLCAiemVybyIsICJvbmUiLCAidHdvIiwgInRocmVlIiwgImZvdXIiLCAiZml2ZSIsICJzaXgiLCAic2V2ZW4iLCAiZWlnaHQiLCAibmluZSIsICJjb2xvbiIsICJzZW1pY29sb24iLCAibGVzcyIsICJlcXVhbCIsICJncmVhdGVyIiwgInF1ZXN0aW9uIiwgImF0IiwgIkEiLCAiQiIsICJDIiwgIkQiLCAiRSIsICJGIiwgIkciLCAiSCIsICJJIiwgIkoiLCAiSyIsICJMIiwgIk0iLCAiTiIsICJPIiwgIlAiLCAiUSIsICJSIiwgIlMiLCAiVCIsICJVIiwgIlYiLCAiVyIsICJYIiwgIlkiLCAiWiIsICJicmFja2V0bGVmdCIsICJiYWNrc2xhc2giLCAiYnJhY2tldHJpZ2h0IiwgImFzY2lpY2lyY3VtIiwgInVuZGVyc2NvcmUiLCAiZ3JhdmUiLCAiYSIsICJiIiwgImMiLCAiZCIsICJlIiwgImYiLCAiZyIsICJoIiwgImkiLCAiaiIsICJrIiwgImwiLCAibSIsICJuIiwgIm8iLCAicCIsICJxIiwgInIiLCAicyIsICJ0IiwgInUiLCAidiIsICJ3IiwgIngiLCAieSIsICJ6IiwgImJyYWNlbGVmdCIsICJiYXIiLCAiYnJhY2VyaWdodCIsICJhc2NpaXRpbGRlIiwgIiIsICJBZGllcmVzaXMiLCAiQXJpbmciLCAiQ2NlZGlsbGEiLCAiRWFjdXRlIiwgIk50aWxkZSIsICJPZGllcmVzaXMiLCAiVWRpZXJlc2lzIiwgImFhY3V0ZSIsICJhZ3JhdmUiLCAiYWNpcmN1bWZsZXgiLCAiYWRpZXJlc2lzIiwgImF0aWxkZSIsICJhcmluZyIsICJjY2VkaWxsYSIsICJlYWN1dGUiLCAiZWdyYXZlIiwgImVjaXJjdW1mbGV4IiwgImVkaWVyZXNpcyIsICJpYWN1dGUiLCAiaWdyYXZlIiwgImljaXJjdW1mbGV4IiwgImlkaWVyZXNpcyIsICJudGlsZGUiLCAib2FjdXRlIiwgIm9ncmF2ZSIsICJvY2lyY3VtZmxleCIsICJvZGllcmVzaXMiLCAib3RpbGRlIiwgInVhY3V0ZSIsICJ1Z3JhdmUiLCAidWNpcmN1bWZsZXgiLCAidWRpZXJlc2lzIiwgImRhZ2dlciIsICJkZWdyZWUiLCAiY2VudCIsICJzdGVybGluZyIsICJzZWN0aW9uIiwgImJ1bGxldCIsICJwYXJhZ3JhcGgiLCAiZ2VybWFuZGJscyIsICJyZWdpc3RlcmVkIiwgImNvcHlyaWdodCIsICJ0cmFkZW1hcmsiLCAiYWN1dGUiLCAiZGllcmVzaXMiLCAibm90ZXF1YWwiLCAiQUUiLCAiT3NsYXNoIiwgImluZmluaXR5IiwgInBsdXNtaW51cyIsICJsZXNzZXF1YWwiLCAiZ3JlYXRlcmVxdWFsIiwgInllbiIsICJtdSIsICJwYXJ0aWFsZGlmZiIsICJzdW1tYXRpb24iLCAicHJvZHVjdCIsICJwaSIsICJpbnRlZ3JhbCIsICJvcmRmZW1pbmluZSIsICJvcmRtYXNjdWxpbmUiLCAiT21lZ2EiLCAiYWUiLCAib3NsYXNoIiwgInF1ZXN0aW9uZG93biIsICJleGNsYW1kb3duIiwgImxvZ2ljYWxub3QiLCAicmFkaWNhbCIsICJmbG9yaW4iLCAiYXBwcm94ZXF1YWwiLCAiRGVsdGEiLCAiZ3VpbGxlbW90bGVmdCIsICJndWlsbGVtb3RyaWdodCIsICJlbGxpcHNpcyIsICJzcGFjZSIsICJBZ3JhdmUiLCAiQXRpbGRlIiwgIk90aWxkZSIsICJPRSIsICJvZSIsICJlbmRhc2giLCAiZW1kYXNoIiwgInF1b3RlZGJsbGVmdCIsICJxdW90ZWRibHJpZ2h0IiwgInF1b3RlbGVmdCIsICJxdW90ZXJpZ2h0IiwgImRpdmlkZSIsICJsb3plbmdlIiwgInlkaWVyZXNpcyIsICJZZGllcmVzaXMiLCAiZnJhY3Rpb24iLCAiY3VycmVuY3kiLCAiZ3VpbHNpbmdsbGVmdCIsICJndWlsc2luZ2xyaWdodCIsICJmaSIsICJmbCIsICJkYWdnZXJkYmwiLCAicGVyaW9kY2VudGVyZWQiLCAicXVvdGVzaW5nbGJhc2UiLCAicXVvdGVkYmxiYXNlIiwgInBlcnRob3VzYW5kIiwgIkFjaXJjdW1mbGV4IiwgIkVjaXJjdW1mbGV4IiwgIkFhY3V0ZSIsICJFZGllcmVzaXMiLCAiRWdyYXZlIiwgIklhY3V0ZSIsICJJY2lyY3VtZmxleCIsICJJZGllcmVzaXMiLCAiSWdyYXZlIiwgIk9hY3V0ZSIsICJPY2lyY3VtZmxleCIsICJhcHBsZSIsICJPZ3JhdmUiLCAiVWFjdXRlIiwgIlVjaXJjdW1mbGV4IiwgIlVncmF2ZSIsICJkb3RsZXNzaSIsICJjaXJjdW1mbGV4IiwgInRpbGRlIiwgIm1hY3JvbiIsICJicmV2ZSIsICJkb3RhY2NlbnQiLCAicmluZyIsICJjZWRpbGxhIiwgImh1bmdhcnVtbGF1dCIsICJvZ29uZWsiLCAiY2Fyb24iXTsKZXhwb3J0cy5NYWNSb21hbkVuY29kaW5nID0gTWFjUm9tYW5FbmNvZGluZzsKdmFyIFN0YW5kYXJkRW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiZXhjbGFtIiwgInF1b3RlZGJsIiwgIm51bWJlcnNpZ24iLCAiZG9sbGFyIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInF1b3RlcmlnaHQiLCAicGFyZW5sZWZ0IiwgInBhcmVucmlnaHQiLCAiYXN0ZXJpc2siLCAicGx1cyIsICJjb21tYSIsICJoeXBoZW4iLCAicGVyaW9kIiwgInNsYXNoIiwgInplcm8iLCAib25lIiwgInR3byIsICJ0aHJlZSIsICJmb3VyIiwgImZpdmUiLCAic2l4IiwgInNldmVuIiwgImVpZ2h0IiwgIm5pbmUiLCAiY29sb24iLCAic2VtaWNvbG9uIiwgImxlc3MiLCAiZXF1YWwiLCAiZ3JlYXRlciIsICJxdWVzdGlvbiIsICJhdCIsICJBIiwgIkIiLCAiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkgiLCAiSSIsICJKIiwgIksiLCAiTCIsICJNIiwgIk4iLCAiTyIsICJQIiwgIlEiLCAiUiIsICJTIiwgIlQiLCAiVSIsICJWIiwgIlciLCAiWCIsICJZIiwgIloiLCAiYnJhY2tldGxlZnQiLCAiYmFja3NsYXNoIiwgImJyYWNrZXRyaWdodCIsICJhc2NpaWNpcmN1bSIsICJ1bmRlcnNjb3JlIiwgInF1b3RlbGVmdCIsICJhIiwgImIiLCAiYyIsICJkIiwgImUiLCAiZiIsICJnIiwgImgiLCAiaSIsICJqIiwgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsICJ2IiwgInciLCAieCIsICJ5IiwgInoiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgImFzY2lpdGlsZGUiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgImV4Y2xhbWRvd24iLCAiY2VudCIsICJzdGVybGluZyIsICJmcmFjdGlvbiIsICJ5ZW4iLCAiZmxvcmluIiwgInNlY3Rpb24iLCAiY3VycmVuY3kiLCAicXVvdGVzaW5nbGUiLCAicXVvdGVkYmxsZWZ0IiwgImd1aWxsZW1vdGxlZnQiLCAiZ3VpbHNpbmdsbGVmdCIsICJndWlsc2luZ2xyaWdodCIsICJmaSIsICJmbCIsICIiLCAiZW5kYXNoIiwgImRhZ2dlciIsICJkYWdnZXJkYmwiLCAicGVyaW9kY2VudGVyZWQiLCAiIiwgInBhcmFncmFwaCIsICJidWxsZXQiLCAicXVvdGVzaW5nbGJhc2UiLCAicXVvdGVkYmxiYXNlIiwgInF1b3RlZGJscmlnaHQiLCAiZ3VpbGxlbW90cmlnaHQiLCAiZWxsaXBzaXMiLCAicGVydGhvdXNhbmQiLCAiIiwgInF1ZXN0aW9uZG93biIsICIiLCAiZ3JhdmUiLCAiYWN1dGUiLCAiY2lyY3VtZmxleCIsICJ0aWxkZSIsICJtYWNyb24iLCAiYnJldmUiLCAiZG90YWNjZW50IiwgImRpZXJlc2lzIiwgIiIsICJyaW5nIiwgImNlZGlsbGEiLCAiIiwgImh1bmdhcnVtbGF1dCIsICJvZ29uZWsiLCAiY2Fyb24iLCAiZW1kYXNoIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJBRSIsICIiLCAib3JkZmVtaW5pbmUiLCAiIiwgIiIsICIiLCAiIiwgIkxzbGFzaCIsICJPc2xhc2giLCAiT0UiLCAib3JkbWFzY3VsaW5lIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiYWUiLCAiIiwgIiIsICIiLCAiZG90bGVzc2kiLCAiIiwgIiIsICJsc2xhc2giLCAib3NsYXNoIiwgIm9lIiwgImdlcm1hbmRibHMiLCAiIiwgIiIsICIiLCAiIl07CmV4cG9ydHMuU3RhbmRhcmRFbmNvZGluZyA9IFN0YW5kYXJkRW5jb2Rpbmc7CnZhciBXaW5BbnNpRW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiZXhjbGFtIiwgInF1b3RlZGJsIiwgIm51bWJlcnNpZ24iLCAiZG9sbGFyIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInF1b3Rlc2luZ2xlIiwgInBhcmVubGVmdCIsICJwYXJlbnJpZ2h0IiwgImFzdGVyaXNrIiwgInBsdXMiLCAiY29tbWEiLCAiaHlwaGVuIiwgInBlcmlvZCIsICJzbGFzaCIsICJ6ZXJvIiwgIm9uZSIsICJ0d28iLCAidGhyZWUiLCAiZm91ciIsICJmaXZlIiwgInNpeCIsICJzZXZlbiIsICJlaWdodCIsICJuaW5lIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJsZXNzIiwgImVxdWFsIiwgImdyZWF0ZXIiLCAicXVlc3Rpb24iLCAiYXQiLCAiQSIsICJCIiwgIkMiLCAiRCIsICJFIiwgIkYiLCAiRyIsICJIIiwgIkkiLCAiSiIsICJLIiwgIkwiLCAiTSIsICJOIiwgIk8iLCAiUCIsICJRIiwgIlIiLCAiUyIsICJUIiwgIlUiLCAiViIsICJXIiwgIlgiLCAiWSIsICJaIiwgImJyYWNrZXRsZWZ0IiwgImJhY2tzbGFzaCIsICJicmFja2V0cmlnaHQiLCAiYXNjaWljaXJjdW0iLCAidW5kZXJzY29yZSIsICJncmF2ZSIsICJhIiwgImIiLCAiYyIsICJkIiwgImUiLCAiZiIsICJnIiwgImgiLCAiaSIsICJqIiwgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsICJ2IiwgInciLCAieCIsICJ5IiwgInoiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgImFzY2lpdGlsZGUiLCAiYnVsbGV0IiwgIkV1cm8iLCAiYnVsbGV0IiwgInF1b3Rlc2luZ2xiYXNlIiwgImZsb3JpbiIsICJxdW90ZWRibGJhc2UiLCAiZWxsaXBzaXMiLCAiZGFnZ2VyIiwgImRhZ2dlcmRibCIsICJjaXJjdW1mbGV4IiwgInBlcnRob3VzYW5kIiwgIlNjYXJvbiIsICJndWlsc2luZ2xsZWZ0IiwgIk9FIiwgImJ1bGxldCIsICJaY2Fyb24iLCAiYnVsbGV0IiwgImJ1bGxldCIsICJxdW90ZWxlZnQiLCAicXVvdGVyaWdodCIsICJxdW90ZWRibGxlZnQiLCAicXVvdGVkYmxyaWdodCIsICJidWxsZXQiLCAiZW5kYXNoIiwgImVtZGFzaCIsICJ0aWxkZSIsICJ0cmFkZW1hcmsiLCAic2Nhcm9uIiwgImd1aWxzaW5nbHJpZ2h0IiwgIm9lIiwgImJ1bGxldCIsICJ6Y2Fyb24iLCAiWWRpZXJlc2lzIiwgInNwYWNlIiwgImV4Y2xhbWRvd24iLCAiY2VudCIsICJzdGVybGluZyIsICJjdXJyZW5jeSIsICJ5ZW4iLCAiYnJva2VuYmFyIiwgInNlY3Rpb24iLCAiZGllcmVzaXMiLCAiY29weXJpZ2h0IiwgIm9yZGZlbWluaW5lIiwgImd1aWxsZW1vdGxlZnQiLCAibG9naWNhbG5vdCIsICJoeXBoZW4iLCAicmVnaXN0ZXJlZCIsICJtYWNyb24iLCAiZGVncmVlIiwgInBsdXNtaW51cyIsICJ0d29zdXBlcmlvciIsICJ0aHJlZXN1cGVyaW9yIiwgImFjdXRlIiwgIm11IiwgInBhcmFncmFwaCIsICJwZXJpb2RjZW50ZXJlZCIsICJjZWRpbGxhIiwgIm9uZXN1cGVyaW9yIiwgIm9yZG1hc2N1bGluZSIsICJndWlsbGVtb3RyaWdodCIsICJvbmVxdWFydGVyIiwgIm9uZWhhbGYiLCAidGhyZWVxdWFydGVycyIsICJxdWVzdGlvbmRvd24iLCAiQWdyYXZlIiwgIkFhY3V0ZSIsICJBY2lyY3VtZmxleCIsICJBdGlsZGUiLCAiQWRpZXJlc2lzIiwgIkFyaW5nIiwgIkFFIiwgIkNjZWRpbGxhIiwgIkVncmF2ZSIsICJFYWN1dGUiLCAiRWNpcmN1bWZsZXgiLCAiRWRpZXJlc2lzIiwgIklncmF2ZSIsICJJYWN1dGUiLCAiSWNpcmN1bWZsZXgiLCAiSWRpZXJlc2lzIiwgIkV0aCIsICJOdGlsZGUiLCAiT2dyYXZlIiwgIk9hY3V0ZSIsICJPY2lyY3VtZmxleCIsICJPdGlsZGUiLCAiT2RpZXJlc2lzIiwgIm11bHRpcGx5IiwgIk9zbGFzaCIsICJVZ3JhdmUiLCAiVWFjdXRlIiwgIlVjaXJjdW1mbGV4IiwgIlVkaWVyZXNpcyIsICJZYWN1dGUiLCAiVGhvcm4iLCAiZ2VybWFuZGJscyIsICJhZ3JhdmUiLCAiYWFjdXRlIiwgImFjaXJjdW1mbGV4IiwgImF0aWxkZSIsICJhZGllcmVzaXMiLCAiYXJpbmciLCAiYWUiLCAiY2NlZGlsbGEiLCAiZWdyYXZlIiwgImVhY3V0ZSIsICJlY2lyY3VtZmxleCIsICJlZGllcmVzaXMiLCAiaWdyYXZlIiwgImlhY3V0ZSIsICJpY2lyY3VtZmxleCIsICJpZGllcmVzaXMiLCAiZXRoIiwgIm50aWxkZSIsICJvZ3JhdmUiLCAib2FjdXRlIiwgIm9jaXJjdW1mbGV4IiwgIm90aWxkZSIsICJvZGllcmVzaXMiLCAiZGl2aWRlIiwgIm9zbGFzaCIsICJ1Z3JhdmUiLCAidWFjdXRlIiwgInVjaXJjdW1mbGV4IiwgInVkaWVyZXNpcyIsICJ5YWN1dGUiLCAidGhvcm4iLCAieWRpZXJlc2lzIl07CmV4cG9ydHMuV2luQW5zaUVuY29kaW5nID0gV2luQW5zaUVuY29kaW5nOwp2YXIgU3ltYm9sU2V0RW5jb2RpbmcgPSBbIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAic3BhY2UiLCAiZXhjbGFtIiwgInVuaXZlcnNhbCIsICJudW1iZXJzaWduIiwgImV4aXN0ZW50aWFsIiwgInBlcmNlbnQiLCAiYW1wZXJzYW5kIiwgInN1Y2h0aGF0IiwgInBhcmVubGVmdCIsICJwYXJlbnJpZ2h0IiwgImFzdGVyaXNrbWF0aCIsICJwbHVzIiwgImNvbW1hIiwgIm1pbnVzIiwgInBlcmlvZCIsICJzbGFzaCIsICJ6ZXJvIiwgIm9uZSIsICJ0d28iLCAidGhyZWUiLCAiZm91ciIsICJmaXZlIiwgInNpeCIsICJzZXZlbiIsICJlaWdodCIsICJuaW5lIiwgImNvbG9uIiwgInNlbWljb2xvbiIsICJsZXNzIiwgImVxdWFsIiwgImdyZWF0ZXIiLCAicXVlc3Rpb24iLCAiY29uZ3J1ZW50IiwgIkFscGhhIiwgIkJldGEiLCAiQ2hpIiwgIkRlbHRhIiwgIkVwc2lsb24iLCAiUGhpIiwgIkdhbW1hIiwgIkV0YSIsICJJb3RhIiwgInRoZXRhMSIsICJLYXBwYSIsICJMYW1iZGEiLCAiTXUiLCAiTnUiLCAiT21pY3JvbiIsICJQaSIsICJUaGV0YSIsICJSaG8iLCAiU2lnbWEiLCAiVGF1IiwgIlVwc2lsb24iLCAic2lnbWExIiwgIk9tZWdhIiwgIlhpIiwgIlBzaSIsICJaZXRhIiwgImJyYWNrZXRsZWZ0IiwgInRoZXJlZm9yZSIsICJicmFja2V0cmlnaHQiLCAicGVycGVuZGljdWxhciIsICJ1bmRlcnNjb3JlIiwgInJhZGljYWxleCIsICJhbHBoYSIsICJiZXRhIiwgImNoaSIsICJkZWx0YSIsICJlcHNpbG9uIiwgInBoaSIsICJnYW1tYSIsICJldGEiLCAiaW90YSIsICJwaGkxIiwgImthcHBhIiwgImxhbWJkYSIsICJtdSIsICJudSIsICJvbWljcm9uIiwgInBpIiwgInRoZXRhIiwgInJobyIsICJzaWdtYSIsICJ0YXUiLCAidXBzaWxvbiIsICJvbWVnYTEiLCAib21lZ2EiLCAieGkiLCAicHNpIiwgInpldGEiLCAiYnJhY2VsZWZ0IiwgImJhciIsICJicmFjZXJpZ2h0IiwgInNpbWlsYXIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiRXVybyIsICJVcHNpbG9uMSIsICJtaW51dGUiLCAibGVzc2VxdWFsIiwgImZyYWN0aW9uIiwgImluZmluaXR5IiwgImZsb3JpbiIsICJjbHViIiwgImRpYW1vbmQiLCAiaGVhcnQiLCAic3BhZGUiLCAiYXJyb3dib3RoIiwgImFycm93bGVmdCIsICJhcnJvd3VwIiwgImFycm93cmlnaHQiLCAiYXJyb3dkb3duIiwgImRlZ3JlZSIsICJwbHVzbWludXMiLCAic2Vjb25kIiwgImdyZWF0ZXJlcXVhbCIsICJtdWx0aXBseSIsICJwcm9wb3J0aW9uYWwiLCAicGFydGlhbGRpZmYiLCAiYnVsbGV0IiwgImRpdmlkZSIsICJub3RlcXVhbCIsICJlcXVpdmFsZW5jZSIsICJhcHByb3hlcXVhbCIsICJlbGxpcHNpcyIsICJhcnJvd3ZlcnRleCIsICJhcnJvd2hvcml6ZXgiLCAiY2FycmlhZ2VyZXR1cm4iLCAiYWxlcGgiLCAiSWZyYWt0dXIiLCAiUmZyYWt0dXIiLCAid2VpZXJzdHJhc3MiLCAiY2lyY2xlbXVsdGlwbHkiLCAiY2lyY2xlcGx1cyIsICJlbXB0eXNldCIsICJpbnRlcnNlY3Rpb24iLCAidW5pb24iLCAicHJvcGVyc3VwZXJzZXQiLCAicmVmbGV4c3VwZXJzZXQiLCAibm90c3Vic2V0IiwgInByb3BlcnN1YnNldCIsICJyZWZsZXhzdWJzZXQiLCAiZWxlbWVudCIsICJub3RlbGVtZW50IiwgImFuZ2xlIiwgImdyYWRpZW50IiwgInJlZ2lzdGVyc2VyaWYiLCAiY29weXJpZ2h0c2VyaWYiLCAidHJhZGVtYXJrc2VyaWYiLCAicHJvZHVjdCIsICJyYWRpY2FsIiwgImRvdG1hdGgiLCAibG9naWNhbG5vdCIsICJsb2dpY2FsYW5kIiwgImxvZ2ljYWxvciIsICJhcnJvd2RibGJvdGgiLCAiYXJyb3dkYmxsZWZ0IiwgImFycm93ZGJsdXAiLCAiYXJyb3dkYmxyaWdodCIsICJhcnJvd2RibGRvd24iLCAibG96ZW5nZSIsICJhbmdsZWxlZnQiLCAicmVnaXN0ZXJzYW5zIiwgImNvcHlyaWdodHNhbnMiLCAidHJhZGVtYXJrc2FucyIsICJzdW1tYXRpb24iLCAicGFyZW5sZWZ0dHAiLCAicGFyZW5sZWZ0ZXgiLCAicGFyZW5sZWZ0YnQiLCAiYnJhY2tldGxlZnR0cCIsICJicmFja2V0bGVmdGV4IiwgImJyYWNrZXRsZWZ0YnQiLCAiYnJhY2VsZWZ0dHAiLCAiYnJhY2VsZWZ0bWlkIiwgImJyYWNlbGVmdGJ0IiwgImJyYWNlZXgiLCAiIiwgImFuZ2xlcmlnaHQiLCAiaW50ZWdyYWwiLCAiaW50ZWdyYWx0cCIsICJpbnRlZ3JhbGV4IiwgImludGVncmFsYnQiLCAicGFyZW5yaWdodHRwIiwgInBhcmVucmlnaHRleCIsICJwYXJlbnJpZ2h0YnQiLCAiYnJhY2tldHJpZ2h0dHAiLCAiYnJhY2tldHJpZ2h0ZXgiLCAiYnJhY2tldHJpZ2h0YnQiLCAiYnJhY2VyaWdodHRwIiwgImJyYWNlcmlnaHRtaWQiLCAiYnJhY2VyaWdodGJ0IiwgIiJdOwpleHBvcnRzLlN5bWJvbFNldEVuY29kaW5nID0gU3ltYm9sU2V0RW5jb2Rpbmc7CnZhciBaYXBmRGluZ2JhdHNFbmNvZGluZyA9IFsiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJzcGFjZSIsICJhMSIsICJhMiIsICJhMjAyIiwgImEzIiwgImE0IiwgImE1IiwgImExMTkiLCAiYTExOCIsICJhMTE3IiwgImExMSIsICJhMTIiLCAiYTEzIiwgImExNCIsICJhMTUiLCAiYTE2IiwgImExMDUiLCAiYTE3IiwgImExOCIsICJhMTkiLCAiYTIwIiwgImEyMSIsICJhMjIiLCAiYTIzIiwgImEyNCIsICJhMjUiLCAiYTI2IiwgImEyNyIsICJhMjgiLCAiYTYiLCAiYTciLCAiYTgiLCAiYTkiLCAiYTEwIiwgImEyOSIsICJhMzAiLCAiYTMxIiwgImEzMiIsICJhMzMiLCAiYTM0IiwgImEzNSIsICJhMzYiLCAiYTM3IiwgImEzOCIsICJhMzkiLCAiYTQwIiwgImE0MSIsICJhNDIiLCAiYTQzIiwgImE0NCIsICJhNDUiLCAiYTQ2IiwgImE0NyIsICJhNDgiLCAiYTQ5IiwgImE1MCIsICJhNTEiLCAiYTUyIiwgImE1MyIsICJhNTQiLCAiYTU1IiwgImE1NiIsICJhNTciLCAiYTU4IiwgImE1OSIsICJhNjAiLCAiYTYxIiwgImE2MiIsICJhNjMiLCAiYTY0IiwgImE2NSIsICJhNjYiLCAiYTY3IiwgImE2OCIsICJhNjkiLCAiYTcwIiwgImE3MSIsICJhNzIiLCAiYTczIiwgImE3NCIsICJhMjAzIiwgImE3NSIsICJhMjA0IiwgImE3NiIsICJhNzciLCAiYTc4IiwgImE3OSIsICJhODEiLCAiYTgyIiwgImE4MyIsICJhODQiLCAiYTk3IiwgImE5OCIsICJhOTkiLCAiYTEwMCIsICIiLCAiYTg5IiwgImE5MCIsICJhOTMiLCAiYTk0IiwgImE5MSIsICJhOTIiLCAiYTIwNSIsICJhODUiLCAiYTIwNiIsICJhODYiLCAiYTg3IiwgImE4OCIsICJhOTUiLCAiYTk2IiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICIiLCAiIiwgIiIsICJhMTAxIiwgImExMDIiLCAiYTEwMyIsICJhMTA0IiwgImExMDYiLCAiYTEwNyIsICJhMTA4IiwgImExMTIiLCAiYTExMSIsICJhMTEwIiwgImExMDkiLCAiYTEyMCIsICJhMTIxIiwgImExMjIiLCAiYTEyMyIsICJhMTI0IiwgImExMjUiLCAiYTEyNiIsICJhMTI3IiwgImExMjgiLCAiYTEyOSIsICJhMTMwIiwgImExMzEiLCAiYTEzMiIsICJhMTMzIiwgImExMzQiLCAiYTEzNSIsICJhMTM2IiwgImExMzciLCAiYTEzOCIsICJhMTM5IiwgImExNDAiLCAiYTE0MSIsICJhMTQyIiwgImExNDMiLCAiYTE0NCIsICJhMTQ1IiwgImExNDYiLCAiYTE0NyIsICJhMTQ4IiwgImExNDkiLCAiYTE1MCIsICJhMTUxIiwgImExNTIiLCAiYTE1MyIsICJhMTU0IiwgImExNTUiLCAiYTE1NiIsICJhMTU3IiwgImExNTgiLCAiYTE1OSIsICJhMTYwIiwgImExNjEiLCAiYTE2MyIsICJhMTY0IiwgImExOTYiLCAiYTE2NSIsICJhMTkyIiwgImExNjYiLCAiYTE2NyIsICJhMTY4IiwgImExNjkiLCAiYTE3MCIsICJhMTcxIiwgImExNzIiLCAiYTE3MyIsICJhMTYyIiwgImExNzQiLCAiYTE3NSIsICJhMTc2IiwgImExNzciLCAiYTE3OCIsICJhMTc5IiwgImExOTMiLCAiYTE4MCIsICJhMTk5IiwgImExODEiLCAiYTIwMCIsICJhMTgyIiwgIiIsICJhMjAxIiwgImExODMiLCAiYTE4NCIsICJhMTk3IiwgImExODUiLCAiYTE5NCIsICJhMTk4IiwgImExODYiLCAiYTE5NSIsICJhMTg3IiwgImExODgiLCAiYTE4OSIsICJhMTkwIiwgImExOTEiLCAiIl07CmV4cG9ydHMuWmFwZkRpbmdiYXRzRW5jb2RpbmcgPSBaYXBmRGluZ2JhdHNFbmNvZGluZzsKCmZ1bmN0aW9uIGdldEVuY29kaW5nKGVuY29kaW5nTmFtZSkgewogIHN3aXRjaCAoZW5jb2RpbmdOYW1lKSB7CiAgICBjYXNlICJXaW5BbnNpRW5jb2RpbmciOgogICAgICByZXR1cm4gV2luQW5zaUVuY29kaW5nOwoKICAgIGNhc2UgIlN0YW5kYXJkRW5jb2RpbmciOgogICAgICByZXR1cm4gU3RhbmRhcmRFbmNvZGluZzsKCiAgICBjYXNlICJNYWNSb21hbkVuY29kaW5nIjoKICAgICAgcmV0dXJuIE1hY1JvbWFuRW5jb2Rpbmc7CgogICAgY2FzZSAiU3ltYm9sU2V0RW5jb2RpbmciOgogICAgICByZXR1cm4gU3ltYm9sU2V0RW5jb2Rpbmc7CgogICAgY2FzZSAiWmFwZkRpbmdiYXRzRW5jb2RpbmciOgogICAgICByZXR1cm4gWmFwZkRpbmdiYXRzRW5jb2Rpbmc7CgogICAgY2FzZSAiRXhwZXJ0RW5jb2RpbmciOgogICAgICByZXR1cm4gRXhwZXJ0RW5jb2Rpbmc7CgogICAgY2FzZSAiTWFjRXhwZXJ0RW5jb2RpbmciOgogICAgICByZXR1cm4gTWFjRXhwZXJ0RW5jb2Rpbmc7CgogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIG51bGw7CiAgfQp9CgovKioqLyB9KSwKLyogMjI2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCnZhciBnZXRMb29rdXBUYWJsZUZhY3RvcnkgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMSkuZ2V0TG9va3VwVGFibGVGYWN0b3J5Owp2YXIgZ2V0R2x5cGhzVW5pY29kZSA9IGdldExvb2t1cFRhYmxlRmFjdG9yeShmdW5jdGlvbiAodCkgewogdC5BID0gMHgwMDQxOwogdC5BRSA9IDB4MDBjNjsKIHQuQUVhY3V0ZSA9IDB4MDFmYzsKIHQuQUVtYWNyb24gPSAweDAxZTI7CiB0LkFFc21hbGwgPSAweGY3ZTY7CiB0LkFhY3V0ZSA9IDB4MDBjMTsKIHQuQWFjdXRlc21hbGwgPSAweGY3ZTE7CiB0LkFicmV2ZSA9IDB4MDEwMjsKIHQuQWJyZXZlYWN1dGUgPSAweDFlYWU7CiB0LkFicmV2ZWN5cmlsbGljID0gMHgwNGQwOwogdC5BYnJldmVkb3RiZWxvdyA9IDB4MWViNjsKIHQuQWJyZXZlZ3JhdmUgPSAweDFlYjA7CiB0LkFicmV2ZWhvb2thYm92ZSA9IDB4MWViMjsKIHQuQWJyZXZldGlsZGUgPSAweDFlYjQ7CiB0LkFjYXJvbiA9IDB4MDFjZDsKIHQuQWNpcmNsZSA9IDB4MjRiNjsKIHQuQWNpcmN1bWZsZXggPSAweDAwYzI7CiB0LkFjaXJjdW1mbGV4YWN1dGUgPSAweDFlYTQ7CiB0LkFjaXJjdW1mbGV4ZG90YmVsb3cgPSAweDFlYWM7CiB0LkFjaXJjdW1mbGV4Z3JhdmUgPSAweDFlYTY7CiB0LkFjaXJjdW1mbGV4aG9va2Fib3ZlID0gMHgxZWE4OwogdC5BY2lyY3VtZmxleHNtYWxsID0gMHhmN2UyOwogdC5BY2lyY3VtZmxleHRpbGRlID0gMHgxZWFhOwogdC5BY3V0ZSA9IDB4ZjZjOTsKIHQuQWN1dGVzbWFsbCA9IDB4ZjdiNDsKIHQuQWN5cmlsbGljID0gMHgwNDEwOwogdC5BZGJsZ3JhdmUgPSAweDAyMDA7CiB0LkFkaWVyZXNpcyA9IDB4MDBjNDsKIHQuQWRpZXJlc2lzY3lyaWxsaWMgPSAweDA0ZDI7CiB0LkFkaWVyZXNpc21hY3JvbiA9IDB4MDFkZTsKIHQuQWRpZXJlc2lzc21hbGwgPSAweGY3ZTQ7CiB0LkFkb3RiZWxvdyA9IDB4MWVhMDsKIHQuQWRvdG1hY3JvbiA9IDB4MDFlMDsKIHQuQWdyYXZlID0gMHgwMGMwOwogdC5BZ3JhdmVzbWFsbCA9IDB4ZjdlMDsKIHQuQWhvb2thYm92ZSA9IDB4MWVhMjsKIHQuQWllY3lyaWxsaWMgPSAweDA0ZDQ7CiB0LkFpbnZlcnRlZGJyZXZlID0gMHgwMjAyOwogdC5BbHBoYSA9IDB4MDM5MTsKIHQuQWxwaGF0b25vcyA9IDB4MDM4NjsKIHQuQW1hY3JvbiA9IDB4MDEwMDsKIHQuQW1vbm9zcGFjZSA9IDB4ZmYyMTsKIHQuQW9nb25layA9IDB4MDEwNDsKIHQuQXJpbmcgPSAweDAwYzU7CiB0LkFyaW5nYWN1dGUgPSAweDAxZmE7CiB0LkFyaW5nYmVsb3cgPSAweDFlMDA7CiB0LkFyaW5nc21hbGwgPSAweGY3ZTU7CiB0LkFzbWFsbCA9IDB4Zjc2MTsKIHQuQXRpbGRlID0gMHgwMGMzOwogdC5BdGlsZGVzbWFsbCA9IDB4ZjdlMzsKIHQuQXliYXJtZW5pYW4gPSAweDA1MzE7CiB0LkIgPSAweDAwNDI7CiB0LkJjaXJjbGUgPSAweDI0Yjc7CiB0LkJkb3RhY2NlbnQgPSAweDFlMDI7CiB0LkJkb3RiZWxvdyA9IDB4MWUwNDsKIHQuQmVjeXJpbGxpYyA9IDB4MDQxMTsKIHQuQmVuYXJtZW5pYW4gPSAweDA1MzI7CiB0LkJldGEgPSAweDAzOTI7CiB0LkJob29rID0gMHgwMTgxOwogdC5CbGluZWJlbG93ID0gMHgxZTA2OwogdC5CbW9ub3NwYWNlID0gMHhmZjIyOwogdC5CcmV2ZXNtYWxsID0gMHhmNmY0OwogdC5Cc21hbGwgPSAweGY3NjI7CiB0LkJ0b3BiYXIgPSAweDAxODI7CiB0LkMgPSAweDAwNDM7CiB0LkNhYXJtZW5pYW4gPSAweDA1M2U7CiB0LkNhY3V0ZSA9IDB4MDEwNjsKIHQuQ2Fyb24gPSAweGY2Y2E7CiB0LkNhcm9uc21hbGwgPSAweGY2ZjU7CiB0LkNjYXJvbiA9IDB4MDEwYzsKIHQuQ2NlZGlsbGEgPSAweDAwYzc7CiB0LkNjZWRpbGxhYWN1dGUgPSAweDFlMDg7CiB0LkNjZWRpbGxhc21hbGwgPSAweGY3ZTc7CiB0LkNjaXJjbGUgPSAweDI0Yjg7CiB0LkNjaXJjdW1mbGV4ID0gMHgwMTA4OwogdC5DZG90ID0gMHgwMTBhOwogdC5DZG90YWNjZW50ID0gMHgwMTBhOwogdC5DZWRpbGxhc21hbGwgPSAweGY3Yjg7CiB0LkNoYWFybWVuaWFuID0gMHgwNTQ5OwogdC5DaGVhYmtoYXNpYW5jeXJpbGxpYyA9IDB4MDRiYzsKIHQuQ2hlY3lyaWxsaWMgPSAweDA0Mjc7CiB0LkNoZWRlc2NlbmRlcmFia2hhc2lhbmN5cmlsbGljID0gMHgwNGJlOwogdC5DaGVkZXNjZW5kZXJjeXJpbGxpYyA9IDB4MDRiNjsKIHQuQ2hlZGllcmVzaXNjeXJpbGxpYyA9IDB4MDRmNDsKIHQuQ2hlaGFybWVuaWFuID0gMHgwNTQzOwogdC5DaGVraGFrYXNzaWFuY3lyaWxsaWMgPSAweDA0Y2I7CiB0LkNoZXZlcnRpY2Fsc3Ryb2tlY3lyaWxsaWMgPSAweDA0Yjg7CiB0LkNoaSA9IDB4MDNhNzsKIHQuQ2hvb2sgPSAweDAxODc7CiB0LkNpcmN1bWZsZXhzbWFsbCA9IDB4ZjZmNjsKIHQuQ21vbm9zcGFjZSA9IDB4ZmYyMzsKIHQuQ29hcm1lbmlhbiA9IDB4MDU1MTsKIHQuQ3NtYWxsID0gMHhmNzYzOwogdC5EID0gMHgwMDQ0OwogdC5EWiA9IDB4MDFmMTsKIHQuRFpjYXJvbiA9IDB4MDFjNDsKIHQuRGFhcm1lbmlhbiA9IDB4MDUzNDsKIHQuRGFmcmljYW4gPSAweDAxODk7CiB0LkRjYXJvbiA9IDB4MDEwZTsKIHQuRGNlZGlsbGEgPSAweDFlMTA7CiB0LkRjaXJjbGUgPSAweDI0Yjk7CiB0LkRjaXJjdW1mbGV4YmVsb3cgPSAweDFlMTI7CiB0LkRjcm9hdCA9IDB4MDExMDsKIHQuRGRvdGFjY2VudCA9IDB4MWUwYTsKIHQuRGRvdGJlbG93ID0gMHgxZTBjOwogdC5EZWN5cmlsbGljID0gMHgwNDE0OwogdC5EZWljb3B0aWMgPSAweDAzZWU7CiB0LkRlbHRhID0gMHgyMjA2OwogdC5EZWx0YWdyZWVrID0gMHgwMzk0OwogdC5EaG9vayA9IDB4MDE4YTsKIHQuRGllcmVzaXMgPSAweGY2Y2I7CiB0LkRpZXJlc2lzQWN1dGUgPSAweGY2Y2M7CiB0LkRpZXJlc2lzR3JhdmUgPSAweGY2Y2Q7CiB0LkRpZXJlc2lzc21hbGwgPSAweGY3YTg7CiB0LkRpZ2FtbWFncmVlayA9IDB4MDNkYzsKIHQuRGplY3lyaWxsaWMgPSAweDA0MDI7CiB0LkRsaW5lYmVsb3cgPSAweDFlMGU7CiB0LkRtb25vc3BhY2UgPSAweGZmMjQ7CiB0LkRvdGFjY2VudHNtYWxsID0gMHhmNmY3OwogdC5Ec2xhc2ggPSAweDAxMTA7CiB0LkRzbWFsbCA9IDB4Zjc2NDsKIHQuRHRvcGJhciA9IDB4MDE4YjsKIHQuRHogPSAweDAxZjI7CiB0LkR6Y2Fyb24gPSAweDAxYzU7CiB0LkR6ZWFia2hhc2lhbmN5cmlsbGljID0gMHgwNGUwOwogdC5EemVjeXJpbGxpYyA9IDB4MDQwNTsKIHQuRHpoZWN5cmlsbGljID0gMHgwNDBmOwogdC5FID0gMHgwMDQ1OwogdC5FYWN1dGUgPSAweDAwYzk7CiB0LkVhY3V0ZXNtYWxsID0gMHhmN2U5OwogdC5FYnJldmUgPSAweDAxMTQ7CiB0LkVjYXJvbiA9IDB4MDExYTsKIHQuRWNlZGlsbGFicmV2ZSA9IDB4MWUxYzsKIHQuRWNoYXJtZW5pYW4gPSAweDA1MzU7CiB0LkVjaXJjbGUgPSAweDI0YmE7CiB0LkVjaXJjdW1mbGV4ID0gMHgwMGNhOwogdC5FY2lyY3VtZmxleGFjdXRlID0gMHgxZWJlOwogdC5FY2lyY3VtZmxleGJlbG93ID0gMHgxZTE4OwogdC5FY2lyY3VtZmxleGRvdGJlbG93ID0gMHgxZWM2OwogdC5FY2lyY3VtZmxleGdyYXZlID0gMHgxZWMwOwogdC5FY2lyY3VtZmxleGhvb2thYm92ZSA9IDB4MWVjMjsKIHQuRWNpcmN1bWZsZXhzbWFsbCA9IDB4ZjdlYTsKIHQuRWNpcmN1bWZsZXh0aWxkZSA9IDB4MWVjNDsKIHQuRWN5cmlsbGljID0gMHgwNDA0OwogdC5FZGJsZ3JhdmUgPSAweDAyMDQ7CiB0LkVkaWVyZXNpcyA9IDB4MDBjYjsKIHQuRWRpZXJlc2lzc21hbGwgPSAweGY3ZWI7CiB0LkVkb3QgPSAweDAxMTY7CiB0LkVkb3RhY2NlbnQgPSAweDAxMTY7CiB0LkVkb3RiZWxvdyA9IDB4MWViODsKIHQuRWZjeXJpbGxpYyA9IDB4MDQyNDsKIHQuRWdyYXZlID0gMHgwMGM4OwogdC5FZ3JhdmVzbWFsbCA9IDB4ZjdlODsKIHQuRWhhcm1lbmlhbiA9IDB4MDUzNzsKIHQuRWhvb2thYm92ZSA9IDB4MWViYTsKIHQuRWlnaHRyb21hbiA9IDB4MjE2NzsKIHQuRWludmVydGVkYnJldmUgPSAweDAyMDY7CiB0LkVpb3RpZmllZGN5cmlsbGljID0gMHgwNDY0OwogdC5FbGN5cmlsbGljID0gMHgwNDFiOwogdC5FbGV2ZW5yb21hbiA9IDB4MjE2YTsKIHQuRW1hY3JvbiA9IDB4MDExMjsKIHQuRW1hY3JvbmFjdXRlID0gMHgxZTE2OwogdC5FbWFjcm9uZ3JhdmUgPSAweDFlMTQ7CiB0LkVtY3lyaWxsaWMgPSAweDA0MWM7CiB0LkVtb25vc3BhY2UgPSAweGZmMjU7CiB0LkVuY3lyaWxsaWMgPSAweDA0MWQ7CiB0LkVuZGVzY2VuZGVyY3lyaWxsaWMgPSAweDA0YTI7CiB0LkVuZyA9IDB4MDE0YTsKIHQuRW5naGVjeXJpbGxpYyA9IDB4MDRhNDsKIHQuRW5ob29rY3lyaWxsaWMgPSAweDA0Yzc7CiB0LkVvZ29uZWsgPSAweDAxMTg7CiB0LkVvcGVuID0gMHgwMTkwOwogdC5FcHNpbG9uID0gMHgwMzk1OwogdC5FcHNpbG9udG9ub3MgPSAweDAzODg7CiB0LkVyY3lyaWxsaWMgPSAweDA0MjA7CiB0LkVyZXZlcnNlZCA9IDB4MDE4ZTsKIHQuRXJldmVyc2VkY3lyaWxsaWMgPSAweDA0MmQ7CiB0LkVzY3lyaWxsaWMgPSAweDA0MjE7CiB0LkVzZGVzY2VuZGVyY3lyaWxsaWMgPSAweDA0YWE7CiB0LkVzaCA9IDB4MDFhOTsKIHQuRXNtYWxsID0gMHhmNzY1OwogdC5FdGEgPSAweDAzOTc7CiB0LkV0YXJtZW5pYW4gPSAweDA1Mzg7CiB0LkV0YXRvbm9zID0gMHgwMzg5OwogdC5FdGggPSAweDAwZDA7CiB0LkV0aHNtYWxsID0gMHhmN2YwOwogdC5FdGlsZGUgPSAweDFlYmM7CiB0LkV0aWxkZWJlbG93ID0gMHgxZTFhOwogdC5FdXJvID0gMHgyMGFjOwogdC5FemggPSAweDAxYjc7CiB0LkV6aGNhcm9uID0gMHgwMWVlOwogdC5FemhyZXZlcnNlZCA9IDB4MDFiODsKIHQuRiA9IDB4MDA0NjsKIHQuRmNpcmNsZSA9IDB4MjRiYjsKIHQuRmRvdGFjY2VudCA9IDB4MWUxZTsKIHQuRmVoYXJtZW5pYW4gPSAweDA1NTY7CiB0LkZlaWNvcHRpYyA9IDB4MDNlNDsKIHQuRmhvb2sgPSAweDAxOTE7CiB0LkZpdGFjeXJpbGxpYyA9IDB4MDQ3MjsKIHQuRml2ZXJvbWFuID0gMHgyMTY0OwogdC5GbW9ub3NwYWNlID0gMHhmZjI2OwogdC5Gb3Vycm9tYW4gPSAweDIxNjM7CiB0LkZzbWFsbCA9IDB4Zjc2NjsKIHQuRyA9IDB4MDA0NzsKIHQuR0JzcXVhcmUgPSAweDMzODc7CiB0LkdhY3V0ZSA9IDB4MDFmNDsKIHQuR2FtbWEgPSAweDAzOTM7CiB0LkdhbW1hYWZyaWNhbiA9IDB4MDE5NDsKIHQuR2FuZ2lhY29wdGljID0gMHgwM2VhOwogdC5HYnJldmUgPSAweDAxMWU7CiB0LkdjYXJvbiA9IDB4MDFlNjsKIHQuR2NlZGlsbGEgPSAweDAxMjI7CiB0LkdjaXJjbGUgPSAweDI0YmM7CiB0LkdjaXJjdW1mbGV4ID0gMHgwMTFjOwogdC5HY29tbWFhY2NlbnQgPSAweDAxMjI7CiB0Lkdkb3QgPSAweDAxMjA7CiB0Lkdkb3RhY2NlbnQgPSAweDAxMjA7CiB0LkdlY3lyaWxsaWMgPSAweDA0MTM7CiB0LkdoYWRhcm1lbmlhbiA9IDB4MDU0MjsKIHQuR2hlbWlkZGxlaG9va2N5cmlsbGljID0gMHgwNDk0OwogdC5HaGVzdHJva2VjeXJpbGxpYyA9IDB4MDQ5MjsKIHQuR2hldXB0dXJuY3lyaWxsaWMgPSAweDA0OTA7CiB0Lkdob29rID0gMHgwMTkzOwogdC5HaW1hcm1lbmlhbiA9IDB4MDUzMzsKIHQuR2plY3lyaWxsaWMgPSAweDA0MDM7CiB0LkdtYWNyb24gPSAweDFlMjA7CiB0Lkdtb25vc3BhY2UgPSAweGZmMjc7CiB0LkdyYXZlID0gMHhmNmNlOwogdC5HcmF2ZXNtYWxsID0gMHhmNzYwOwogdC5Hc21hbGwgPSAweGY3Njc7CiB0LkdzbWFsbGhvb2sgPSAweDAyOWI7CiB0LkdzdHJva2UgPSAweDAxZTQ7CiB0LkggPSAweDAwNDg7CiB0LkgxODUzMyA9IDB4MjVjZjsKIHQuSDE4NTQzID0gMHgyNWFhOwogdC5IMTg1NTEgPSAweDI1YWI7CiB0LkgyMjA3MyA9IDB4MjVhMTsKIHQuSFBzcXVhcmUgPSAweDMzY2I7CiB0LkhhYWJraGFzaWFuY3lyaWxsaWMgPSAweDA0YTg7CiB0LkhhZGVzY2VuZGVyY3lyaWxsaWMgPSAweDA0YjI7CiB0LkhhcmRzaWduY3lyaWxsaWMgPSAweDA0MmE7CiB0LkhiYXIgPSAweDAxMjY7CiB0LkhicmV2ZWJlbG93ID0gMHgxZTJhOwogdC5IY2VkaWxsYSA9IDB4MWUyODsKIHQuSGNpcmNsZSA9IDB4MjRiZDsKIHQuSGNpcmN1bWZsZXggPSAweDAxMjQ7CiB0LkhkaWVyZXNpcyA9IDB4MWUyNjsKIHQuSGRvdGFjY2VudCA9IDB4MWUyMjsKIHQuSGRvdGJlbG93ID0gMHgxZTI0OwogdC5IbW9ub3NwYWNlID0gMHhmZjI4OwogdC5Ib2FybWVuaWFuID0gMHgwNTQwOwogdC5Ib3JpY29wdGljID0gMHgwM2U4OwogdC5Ic21hbGwgPSAweGY3Njg7CiB0Lkh1bmdhcnVtbGF1dCA9IDB4ZjZjZjsKIHQuSHVuZ2FydW1sYXV0c21hbGwgPSAweGY2Zjg7CiB0Lkh6c3F1YXJlID0gMHgzMzkwOwogdC5JID0gMHgwMDQ5OwogdC5JQWN5cmlsbGljID0gMHgwNDJmOwogdC5JSiA9IDB4MDEzMjsKIHQuSVVjeXJpbGxpYyA9IDB4MDQyZTsKIHQuSWFjdXRlID0gMHgwMGNkOwogdC5JYWN1dGVzbWFsbCA9IDB4ZjdlZDsKIHQuSWJyZXZlID0gMHgwMTJjOwogdC5JY2Fyb24gPSAweDAxY2Y7CiB0LkljaXJjbGUgPSAweDI0YmU7CiB0LkljaXJjdW1mbGV4ID0gMHgwMGNlOwogdC5JY2lyY3VtZmxleHNtYWxsID0gMHhmN2VlOwogdC5JY3lyaWxsaWMgPSAweDA0MDY7CiB0LklkYmxncmF2ZSA9IDB4MDIwODsKIHQuSWRpZXJlc2lzID0gMHgwMGNmOwogdC5JZGllcmVzaXNhY3V0ZSA9IDB4MWUyZTsKIHQuSWRpZXJlc2lzY3lyaWxsaWMgPSAweDA0ZTQ7CiB0LklkaWVyZXNpc3NtYWxsID0gMHhmN2VmOwogdC5JZG90ID0gMHgwMTMwOwogdC5JZG90YWNjZW50ID0gMHgwMTMwOwogdC5JZG90YmVsb3cgPSAweDFlY2E7CiB0LkllYnJldmVjeXJpbGxpYyA9IDB4MDRkNjsKIHQuSWVjeXJpbGxpYyA9IDB4MDQxNTsKIHQuSWZyYWt0dXIgPSAweDIxMTE7CiB0LklncmF2ZSA9IDB4MDBjYzsKIHQuSWdyYXZlc21hbGwgPSAweGY3ZWM7CiB0Lklob29rYWJvdmUgPSAweDFlYzg7CiB0LklpY3lyaWxsaWMgPSAweDA0MTg7CiB0LklpbnZlcnRlZGJyZXZlID0gMHgwMjBhOwogdC5JaXNob3J0Y3lyaWxsaWMgPSAweDA0MTk7CiB0LkltYWNyb24gPSAweDAxMmE7CiB0LkltYWNyb25jeXJpbGxpYyA9IDB4MDRlMjsKIHQuSW1vbm9zcGFjZSA9IDB4ZmYyOTsKIHQuSW5pYXJtZW5pYW4gPSAweDA1M2I7CiB0LklvY3lyaWxsaWMgPSAweDA0MDE7CiB0LklvZ29uZWsgPSAweDAxMmU7CiB0LklvdGEgPSAweDAzOTk7CiB0LklvdGFhZnJpY2FuID0gMHgwMTk2OwogdC5Jb3RhZGllcmVzaXMgPSAweDAzYWE7CiB0LklvdGF0b25vcyA9IDB4MDM4YTsKIHQuSXNtYWxsID0gMHhmNzY5OwogdC5Jc3Ryb2tlID0gMHgwMTk3OwogdC5JdGlsZGUgPSAweDAxMjg7CiB0Lkl0aWxkZWJlbG93ID0gMHgxZTJjOwogdC5JemhpdHNhY3lyaWxsaWMgPSAweDA0NzQ7CiB0Lkl6aGl0c2FkYmxncmF2ZWN5cmlsbGljID0gMHgwNDc2OwogdC5KID0gMHgwMDRhOwogdC5KYWFybWVuaWFuID0gMHgwNTQxOwogdC5KY2lyY2xlID0gMHgyNGJmOwogdC5KY2lyY3VtZmxleCA9IDB4MDEzNDsKIHQuSmVjeXJpbGxpYyA9IDB4MDQwODsKIHQuSmhlaGFybWVuaWFuID0gMHgwNTRiOwogdC5KbW9ub3NwYWNlID0gMHhmZjJhOwogdC5Kc21hbGwgPSAweGY3NmE7CiB0LksgPSAweDAwNGI7CiB0LktCc3F1YXJlID0gMHgzMzg1OwogdC5LS3NxdWFyZSA9IDB4MzNjZDsKIHQuS2FiYXNoa2lyY3lyaWxsaWMgPSAweDA0YTA7CiB0LkthY3V0ZSA9IDB4MWUzMDsKIHQuS2FjeXJpbGxpYyA9IDB4MDQxYTsKIHQuS2FkZXNjZW5kZXJjeXJpbGxpYyA9IDB4MDQ5YTsKIHQuS2Fob29rY3lyaWxsaWMgPSAweDA0YzM7CiB0LkthcHBhID0gMHgwMzlhOwogdC5LYXN0cm9rZWN5cmlsbGljID0gMHgwNDllOwogdC5LYXZlcnRpY2Fsc3Ryb2tlY3lyaWxsaWMgPSAweDA0OWM7CiB0LktjYXJvbiA9IDB4MDFlODsKIHQuS2NlZGlsbGEgPSAweDAxMzY7CiB0LktjaXJjbGUgPSAweDI0YzA7CiB0Lktjb21tYWFjY2VudCA9IDB4MDEzNjsKIHQuS2RvdGJlbG93ID0gMHgxZTMyOwogdC5LZWhhcm1lbmlhbiA9IDB4MDU1NDsKIHQuS2VuYXJtZW5pYW4gPSAweDA1M2Y7CiB0LktoYWN5cmlsbGljID0gMHgwNDI1OwogdC5LaGVpY29wdGljID0gMHgwM2U2OwogdC5LaG9vayA9IDB4MDE5ODsKIHQuS2plY3lyaWxsaWMgPSAweDA0MGM7CiB0LktsaW5lYmVsb3cgPSAweDFlMzQ7CiB0Lkttb25vc3BhY2UgPSAweGZmMmI7CiB0LktvcHBhY3lyaWxsaWMgPSAweDA0ODA7CiB0LktvcHBhZ3JlZWsgPSAweDAzZGU7CiB0LktzaWN5cmlsbGljID0gMHgwNDZlOwogdC5Lc21hbGwgPSAweGY3NmI7CiB0LkwgPSAweDAwNGM7CiB0LkxKID0gMHgwMWM3OwogdC5MTCA9IDB4ZjZiZjsKIHQuTGFjdXRlID0gMHgwMTM5OwogdC5MYW1iZGEgPSAweDAzOWI7CiB0LkxjYXJvbiA9IDB4MDEzZDsKIHQuTGNlZGlsbGEgPSAweDAxM2I7CiB0LkxjaXJjbGUgPSAweDI0YzE7CiB0LkxjaXJjdW1mbGV4YmVsb3cgPSAweDFlM2M7CiB0Lkxjb21tYWFjY2VudCA9IDB4MDEzYjsKIHQuTGRvdCA9IDB4MDEzZjsKIHQuTGRvdGFjY2VudCA9IDB4MDEzZjsKIHQuTGRvdGJlbG93ID0gMHgxZTM2OwogdC5MZG90YmVsb3dtYWNyb24gPSAweDFlMzg7CiB0Lkxpd25hcm1lbmlhbiA9IDB4MDUzYzsKIHQuTGogPSAweDAxYzg7CiB0LkxqZWN5cmlsbGljID0gMHgwNDA5OwogdC5MbGluZWJlbG93ID0gMHgxZTNhOwogdC5MbW9ub3NwYWNlID0gMHhmZjJjOwogdC5Mc2xhc2ggPSAweDAxNDE7CiB0LkxzbGFzaHNtYWxsID0gMHhmNmY5OwogdC5Mc21hbGwgPSAweGY3NmM7CiB0Lk0gPSAweDAwNGQ7CiB0Lk1Cc3F1YXJlID0gMHgzMzg2OwogdC5NYWNyb24gPSAweGY2ZDA7CiB0Lk1hY3JvbnNtYWxsID0gMHhmN2FmOwogdC5NYWN1dGUgPSAweDFlM2U7CiB0Lk1jaXJjbGUgPSAweDI0YzI7CiB0Lk1kb3RhY2NlbnQgPSAweDFlNDA7CiB0Lk1kb3RiZWxvdyA9IDB4MWU0MjsKIHQuTWVuYXJtZW5pYW4gPSAweDA1NDQ7CiB0Lk1tb25vc3BhY2UgPSAweGZmMmQ7CiB0Lk1zbWFsbCA9IDB4Zjc2ZDsKIHQuTXR1cm5lZCA9IDB4MDE5YzsKIHQuTXUgPSAweDAzOWM7CiB0Lk4gPSAweDAwNGU7CiB0Lk5KID0gMHgwMWNhOwogdC5OYWN1dGUgPSAweDAxNDM7CiB0Lk5jYXJvbiA9IDB4MDE0NzsKIHQuTmNlZGlsbGEgPSAweDAxNDU7CiB0Lk5jaXJjbGUgPSAweDI0YzM7CiB0Lk5jaXJjdW1mbGV4YmVsb3cgPSAweDFlNGE7CiB0Lk5jb21tYWFjY2VudCA9IDB4MDE0NTsKIHQuTmRvdGFjY2VudCA9IDB4MWU0NDsKIHQuTmRvdGJlbG93ID0gMHgxZTQ2OwogdC5OaG9va2xlZnQgPSAweDAxOWQ7CiB0Lk5pbmVyb21hbiA9IDB4MjE2ODsKIHQuTmogPSAweDAxY2I7CiB0Lk5qZWN5cmlsbGljID0gMHgwNDBhOwogdC5ObGluZWJlbG93ID0gMHgxZTQ4OwogdC5ObW9ub3NwYWNlID0gMHhmZjJlOwogdC5Ob3dhcm1lbmlhbiA9IDB4MDU0NjsKIHQuTnNtYWxsID0gMHhmNzZlOwogdC5OdGlsZGUgPSAweDAwZDE7CiB0Lk50aWxkZXNtYWxsID0gMHhmN2YxOwogdC5OdSA9IDB4MDM5ZDsKIHQuTyA9IDB4MDA0ZjsKIHQuT0UgPSAweDAxNTI7CiB0Lk9Fc21hbGwgPSAweGY2ZmE7CiB0Lk9hY3V0ZSA9IDB4MDBkMzsKIHQuT2FjdXRlc21hbGwgPSAweGY3ZjM7CiB0Lk9iYXJyZWRjeXJpbGxpYyA9IDB4MDRlODsKIHQuT2JhcnJlZGRpZXJlc2lzY3lyaWxsaWMgPSAweDA0ZWE7CiB0Lk9icmV2ZSA9IDB4MDE0ZTsKIHQuT2Nhcm9uID0gMHgwMWQxOwogdC5PY2VudGVyZWR0aWxkZSA9IDB4MDE5ZjsKIHQuT2NpcmNsZSA9IDB4MjRjNDsKIHQuT2NpcmN1bWZsZXggPSAweDAwZDQ7CiB0Lk9jaXJjdW1mbGV4YWN1dGUgPSAweDFlZDA7CiB0Lk9jaXJjdW1mbGV4ZG90YmVsb3cgPSAweDFlZDg7CiB0Lk9jaXJjdW1mbGV4Z3JhdmUgPSAweDFlZDI7CiB0Lk9jaXJjdW1mbGV4aG9va2Fib3ZlID0gMHgxZWQ0OwogdC5PY2lyY3VtZmxleHNtYWxsID0gMHhmN2Y0OwogdC5PY2lyY3VtZmxleHRpbGRlID0gMHgxZWQ2OwogdC5PY3lyaWxsaWMgPSAweDA0MWU7CiB0Lk9kYmxhY3V0ZSA9IDB4MDE1MDsKIHQuT2RibGdyYXZlID0gMHgwMjBjOwogdC5PZGllcmVzaXMgPSAweDAwZDY7CiB0Lk9kaWVyZXNpc2N5cmlsbGljID0gMHgwNGU2OwogdC5PZGllcmVzaXNzbWFsbCA9IDB4ZjdmNjsKIHQuT2RvdGJlbG93ID0gMHgxZWNjOwogdC5PZ29uZWtzbWFsbCA9IDB4ZjZmYjsKIHQuT2dyYXZlID0gMHgwMGQyOwogdC5PZ3JhdmVzbWFsbCA9IDB4ZjdmMjsKIHQuT2hhcm1lbmlhbiA9IDB4MDU1NTsKIHQuT2htID0gMHgyMTI2OwogdC5PaG9va2Fib3ZlID0gMHgxZWNlOwogdC5PaG9ybiA9IDB4MDFhMDsKIHQuT2hvcm5hY3V0ZSA9IDB4MWVkYTsKIHQuT2hvcm5kb3RiZWxvdyA9IDB4MWVlMjsKIHQuT2hvcm5ncmF2ZSA9IDB4MWVkYzsKIHQuT2hvcm5ob29rYWJvdmUgPSAweDFlZGU7CiB0Lk9ob3JudGlsZGUgPSAweDFlZTA7CiB0Lk9odW5nYXJ1bWxhdXQgPSAweDAxNTA7CiB0Lk9pID0gMHgwMWEyOwogdC5PaW52ZXJ0ZWRicmV2ZSA9IDB4MDIwZTsKIHQuT21hY3JvbiA9IDB4MDE0YzsKIHQuT21hY3JvbmFjdXRlID0gMHgxZTUyOwogdC5PbWFjcm9uZ3JhdmUgPSAweDFlNTA7CiB0Lk9tZWdhID0gMHgyMTI2OwogdC5PbWVnYWN5cmlsbGljID0gMHgwNDYwOwogdC5PbWVnYWdyZWVrID0gMHgwM2E5OwogdC5PbWVnYXJvdW5kY3lyaWxsaWMgPSAweDA0N2E7CiB0Lk9tZWdhdGl0bG9jeXJpbGxpYyA9IDB4MDQ3YzsKIHQuT21lZ2F0b25vcyA9IDB4MDM4ZjsKIHQuT21pY3JvbiA9IDB4MDM5ZjsKIHQuT21pY3JvbnRvbm9zID0gMHgwMzhjOwogdC5PbW9ub3NwYWNlID0gMHhmZjJmOwogdC5PbmVyb21hbiA9IDB4MjE2MDsKIHQuT29nb25layA9IDB4MDFlYTsKIHQuT29nb25la21hY3JvbiA9IDB4MDFlYzsKIHQuT29wZW4gPSAweDAxODY7CiB0Lk9zbGFzaCA9IDB4MDBkODsKIHQuT3NsYXNoYWN1dGUgPSAweDAxZmU7CiB0Lk9zbGFzaHNtYWxsID0gMHhmN2Y4OwogdC5Pc21hbGwgPSAweGY3NmY7CiB0Lk9zdHJva2VhY3V0ZSA9IDB4MDFmZTsKIHQuT3RjeXJpbGxpYyA9IDB4MDQ3ZTsKIHQuT3RpbGRlID0gMHgwMGQ1OwogdC5PdGlsZGVhY3V0ZSA9IDB4MWU0YzsKIHQuT3RpbGRlZGllcmVzaXMgPSAweDFlNGU7CiB0Lk90aWxkZXNtYWxsID0gMHhmN2Y1OwogdC5QID0gMHgwMDUwOwogdC5QYWN1dGUgPSAweDFlNTQ7CiB0LlBjaXJjbGUgPSAweDI0YzU7CiB0LlBkb3RhY2NlbnQgPSAweDFlNTY7CiB0LlBlY3lyaWxsaWMgPSAweDA0MWY7CiB0LlBlaGFybWVuaWFuID0gMHgwNTRhOwogdC5QZW1pZGRsZWhvb2tjeXJpbGxpYyA9IDB4MDRhNjsKIHQuUGhpID0gMHgwM2E2OwogdC5QaG9vayA9IDB4MDFhNDsKIHQuUGkgPSAweDAzYTA7CiB0LlBpd3Jhcm1lbmlhbiA9IDB4MDU1MzsKIHQuUG1vbm9zcGFjZSA9IDB4ZmYzMDsKIHQuUHNpID0gMHgwM2E4OwogdC5Qc2ljeXJpbGxpYyA9IDB4MDQ3MDsKIHQuUHNtYWxsID0gMHhmNzcwOwogdC5RID0gMHgwMDUxOwogdC5RY2lyY2xlID0gMHgyNGM2OwogdC5RbW9ub3NwYWNlID0gMHhmZjMxOwogdC5Rc21hbGwgPSAweGY3NzE7CiB0LlIgPSAweDAwNTI7CiB0LlJhYXJtZW5pYW4gPSAweDA1NGM7CiB0LlJhY3V0ZSA9IDB4MDE1NDsKIHQuUmNhcm9uID0gMHgwMTU4OwogdC5SY2VkaWxsYSA9IDB4MDE1NjsKIHQuUmNpcmNsZSA9IDB4MjRjNzsKIHQuUmNvbW1hYWNjZW50ID0gMHgwMTU2OwogdC5SZGJsZ3JhdmUgPSAweDAyMTA7CiB0LlJkb3RhY2NlbnQgPSAweDFlNTg7CiB0LlJkb3RiZWxvdyA9IDB4MWU1YTsKIHQuUmRvdGJlbG93bWFjcm9uID0gMHgxZTVjOwogdC5SZWhhcm1lbmlhbiA9IDB4MDU1MDsKIHQuUmZyYWt0dXIgPSAweDIxMWM7CiB0LlJobyA9IDB4MDNhMTsKIHQuUmluZ3NtYWxsID0gMHhmNmZjOwogdC5SaW52ZXJ0ZWRicmV2ZSA9IDB4MDIxMjsKIHQuUmxpbmViZWxvdyA9IDB4MWU1ZTsKIHQuUm1vbm9zcGFjZSA9IDB4ZmYzMjsKIHQuUnNtYWxsID0gMHhmNzcyOwogdC5Sc21hbGxpbnZlcnRlZCA9IDB4MDI4MTsKIHQuUnNtYWxsaW52ZXJ0ZWRzdXBlcmlvciA9IDB4MDJiNjsKIHQuUyA9IDB4MDA1MzsKIHQuU0YwMTAwMDAgPSAweDI1MGM7CiB0LlNGMDIwMDAwID0gMHgyNTE0OwogdC5TRjAzMDAwMCA9IDB4MjUxMDsKIHQuU0YwNDAwMDAgPSAweDI1MTg7CiB0LlNGMDUwMDAwID0gMHgyNTNjOwogdC5TRjA2MDAwMCA9IDB4MjUyYzsKIHQuU0YwNzAwMDAgPSAweDI1MzQ7CiB0LlNGMDgwMDAwID0gMHgyNTFjOwogdC5TRjA5MDAwMCA9IDB4MjUyNDsKIHQuU0YxMDAwMDAgPSAweDI1MDA7CiB0LlNGMTEwMDAwID0gMHgyNTAyOwogdC5TRjE5MDAwMCA9IDB4MjU2MTsKIHQuU0YyMDAwMDAgPSAweDI1NjI7CiB0LlNGMjEwMDAwID0gMHgyNTU2OwogdC5TRjIyMDAwMCA9IDB4MjU1NTsKIHQuU0YyMzAwMDAgPSAweDI1NjM7CiB0LlNGMjQwMDAwID0gMHgyNTUxOwogdC5TRjI1MDAwMCA9IDB4MjU1NzsKIHQuU0YyNjAwMDAgPSAweDI1NWQ7CiB0LlNGMjcwMDAwID0gMHgyNTVjOwogdC5TRjI4MDAwMCA9IDB4MjU1YjsKIHQuU0YzNjAwMDAgPSAweDI1NWU7CiB0LlNGMzcwMDAwID0gMHgyNTVmOwogdC5TRjM4MDAwMCA9IDB4MjU1YTsKIHQuU0YzOTAwMDAgPSAweDI1NTQ7CiB0LlNGNDAwMDAwID0gMHgyNTY5OwogdC5TRjQxMDAwMCA9IDB4MjU2NjsKIHQuU0Y0MjAwMDAgPSAweDI1NjA7CiB0LlNGNDMwMDAwID0gMHgyNTUwOwogdC5TRjQ0MDAwMCA9IDB4MjU2YzsKIHQuU0Y0NTAwMDAgPSAweDI1Njc7CiB0LlNGNDYwMDAwID0gMHgyNTY4OwogdC5TRjQ3MDAwMCA9IDB4MjU2NDsKIHQuU0Y0ODAwMDAgPSAweDI1NjU7CiB0LlNGNDkwMDAwID0gMHgyNTU5OwogdC5TRjUwMDAwMCA9IDB4MjU1ODsKIHQuU0Y1MTAwMDAgPSAweDI1NTI7CiB0LlNGNTIwMDAwID0gMHgyNTUzOwogdC5TRjUzMDAwMCA9IDB4MjU2YjsKIHQuU0Y1NDAwMDAgPSAweDI1NmE7CiB0LlNhY3V0ZSA9IDB4MDE1YTsKIHQuU2FjdXRlZG90YWNjZW50ID0gMHgxZTY0OwogdC5TYW1waWdyZWVrID0gMHgwM2UwOwogdC5TY2Fyb24gPSAweDAxNjA7CiB0LlNjYXJvbmRvdGFjY2VudCA9IDB4MWU2NjsKIHQuU2Nhcm9uc21hbGwgPSAweGY2ZmQ7CiB0LlNjZWRpbGxhID0gMHgwMTVlOwogdC5TY2h3YSA9IDB4MDE4ZjsKIHQuU2Nod2FjeXJpbGxpYyA9IDB4MDRkODsKIHQuU2Nod2FkaWVyZXNpc2N5cmlsbGljID0gMHgwNGRhOwogdC5TY2lyY2xlID0gMHgyNGM4OwogdC5TY2lyY3VtZmxleCA9IDB4MDE1YzsKIHQuU2NvbW1hYWNjZW50ID0gMHgwMjE4OwogdC5TZG90YWNjZW50ID0gMHgxZTYwOwogdC5TZG90YmVsb3cgPSAweDFlNjI7CiB0LlNkb3RiZWxvd2RvdGFjY2VudCA9IDB4MWU2ODsKIHQuU2VoYXJtZW5pYW4gPSAweDA1NGQ7CiB0LlNldmVucm9tYW4gPSAweDIxNjY7CiB0LlNoYWFybWVuaWFuID0gMHgwNTQ3OwogdC5TaGFjeXJpbGxpYyA9IDB4MDQyODsKIHQuU2hjaGFjeXJpbGxpYyA9IDB4MDQyOTsKIHQuU2hlaWNvcHRpYyA9IDB4MDNlMjsKIHQuU2hoYWN5cmlsbGljID0gMHgwNGJhOwogdC5TaGltYWNvcHRpYyA9IDB4MDNlYzsKIHQuU2lnbWEgPSAweDAzYTM7CiB0LlNpeHJvbWFuID0gMHgyMTY1OwogdC5TbW9ub3NwYWNlID0gMHhmZjMzOwogdC5Tb2Z0c2lnbmN5cmlsbGljID0gMHgwNDJjOwogdC5Tc21hbGwgPSAweGY3NzM7CiB0LlN0aWdtYWdyZWVrID0gMHgwM2RhOwogdC5UID0gMHgwMDU0OwogdC5UYXUgPSAweDAzYTQ7CiB0LlRiYXIgPSAweDAxNjY7CiB0LlRjYXJvbiA9IDB4MDE2NDsKIHQuVGNlZGlsbGEgPSAweDAxNjI7CiB0LlRjaXJjbGUgPSAweDI0Yzk7CiB0LlRjaXJjdW1mbGV4YmVsb3cgPSAweDFlNzA7CiB0LlRjb21tYWFjY2VudCA9IDB4MDE2MjsKIHQuVGRvdGFjY2VudCA9IDB4MWU2YTsKIHQuVGRvdGJlbG93ID0gMHgxZTZjOwogdC5UZWN5cmlsbGljID0gMHgwNDIyOwogdC5UZWRlc2NlbmRlcmN5cmlsbGljID0gMHgwNGFjOwogdC5UZW5yb21hbiA9IDB4MjE2OTsKIHQuVGV0c2VjeXJpbGxpYyA9IDB4MDRiNDsKIHQuVGhldGEgPSAweDAzOTg7CiB0LlRob29rID0gMHgwMWFjOwogdC5UaG9ybiA9IDB4MDBkZTsKIHQuVGhvcm5zbWFsbCA9IDB4ZjdmZTsKIHQuVGhyZWVyb21hbiA9IDB4MjE2MjsKIHQuVGlsZGVzbWFsbCA9IDB4ZjZmZTsKIHQuVGl3bmFybWVuaWFuID0gMHgwNTRmOwogdC5UbGluZWJlbG93ID0gMHgxZTZlOwogdC5UbW9ub3NwYWNlID0gMHhmZjM0OwogdC5Ub2FybWVuaWFuID0gMHgwNTM5OwogdC5Ub25lZml2ZSA9IDB4MDFiYzsKIHQuVG9uZXNpeCA9IDB4MDE4NDsKIHQuVG9uZXR3byA9IDB4MDFhNzsKIHQuVHJldHJvZmxleGhvb2sgPSAweDAxYWU7CiB0LlRzZWN5cmlsbGljID0gMHgwNDI2OwogdC5Uc2hlY3lyaWxsaWMgPSAweDA0MGI7CiB0LlRzbWFsbCA9IDB4Zjc3NDsKIHQuVHdlbHZlcm9tYW4gPSAweDIxNmI7CiB0LlR3b3JvbWFuID0gMHgyMTYxOwogdC5VID0gMHgwMDU1OwogdC5VYWN1dGUgPSAweDAwZGE7CiB0LlVhY3V0ZXNtYWxsID0gMHhmN2ZhOwogdC5VYnJldmUgPSAweDAxNmM7CiB0LlVjYXJvbiA9IDB4MDFkMzsKIHQuVWNpcmNsZSA9IDB4MjRjYTsKIHQuVWNpcmN1bWZsZXggPSAweDAwZGI7CiB0LlVjaXJjdW1mbGV4YmVsb3cgPSAweDFlNzY7CiB0LlVjaXJjdW1mbGV4c21hbGwgPSAweGY3ZmI7CiB0LlVjeXJpbGxpYyA9IDB4MDQyMzsKIHQuVWRibGFjdXRlID0gMHgwMTcwOwogdC5VZGJsZ3JhdmUgPSAweDAyMTQ7CiB0LlVkaWVyZXNpcyA9IDB4MDBkYzsKIHQuVWRpZXJlc2lzYWN1dGUgPSAweDAxZDc7CiB0LlVkaWVyZXNpc2JlbG93ID0gMHgxZTcyOwogdC5VZGllcmVzaXNjYXJvbiA9IDB4MDFkOTsKIHQuVWRpZXJlc2lzY3lyaWxsaWMgPSAweDA0ZjA7CiB0LlVkaWVyZXNpc2dyYXZlID0gMHgwMWRiOwogdC5VZGllcmVzaXNtYWNyb24gPSAweDAxZDU7CiB0LlVkaWVyZXNpc3NtYWxsID0gMHhmN2ZjOwogdC5VZG90YmVsb3cgPSAweDFlZTQ7CiB0LlVncmF2ZSA9IDB4MDBkOTsKIHQuVWdyYXZlc21hbGwgPSAweGY3Zjk7CiB0LlVob29rYWJvdmUgPSAweDFlZTY7CiB0LlVob3JuID0gMHgwMWFmOwogdC5VaG9ybmFjdXRlID0gMHgxZWU4OwogdC5VaG9ybmRvdGJlbG93ID0gMHgxZWYwOwogdC5VaG9ybmdyYXZlID0gMHgxZWVhOwogdC5VaG9ybmhvb2thYm92ZSA9IDB4MWVlYzsKIHQuVWhvcm50aWxkZSA9IDB4MWVlZTsKIHQuVWh1bmdhcnVtbGF1dCA9IDB4MDE3MDsKIHQuVWh1bmdhcnVtbGF1dGN5cmlsbGljID0gMHgwNGYyOwogdC5VaW52ZXJ0ZWRicmV2ZSA9IDB4MDIxNjsKIHQuVWtjeXJpbGxpYyA9IDB4MDQ3ODsKIHQuVW1hY3JvbiA9IDB4MDE2YTsKIHQuVW1hY3JvbmN5cmlsbGljID0gMHgwNGVlOwogdC5VbWFjcm9uZGllcmVzaXMgPSAweDFlN2E7CiB0LlVtb25vc3BhY2UgPSAweGZmMzU7CiB0LlVvZ29uZWsgPSAweDAxNzI7CiB0LlVwc2lsb24gPSAweDAzYTU7CiB0LlVwc2lsb24xID0gMHgwM2QyOwogdC5VcHNpbG9uYWN1dGVob29rc3ltYm9sZ3JlZWsgPSAweDAzZDM7CiB0LlVwc2lsb25hZnJpY2FuID0gMHgwMWIxOwogdC5VcHNpbG9uZGllcmVzaXMgPSAweDAzYWI7CiB0LlVwc2lsb25kaWVyZXNpc2hvb2tzeW1ib2xncmVlayA9IDB4MDNkNDsKIHQuVXBzaWxvbmhvb2tzeW1ib2wgPSAweDAzZDI7CiB0LlVwc2lsb250b25vcyA9IDB4MDM4ZTsKIHQuVXJpbmcgPSAweDAxNmU7CiB0LlVzaG9ydGN5cmlsbGljID0gMHgwNDBlOwogdC5Vc21hbGwgPSAweGY3NzU7CiB0LlVzdHJhaWdodGN5cmlsbGljID0gMHgwNGFlOwogdC5Vc3RyYWlnaHRzdHJva2VjeXJpbGxpYyA9IDB4MDRiMDsKIHQuVXRpbGRlID0gMHgwMTY4OwogdC5VdGlsZGVhY3V0ZSA9IDB4MWU3ODsKIHQuVXRpbGRlYmVsb3cgPSAweDFlNzQ7CiB0LlYgPSAweDAwNTY7CiB0LlZjaXJjbGUgPSAweDI0Y2I7CiB0LlZkb3RiZWxvdyA9IDB4MWU3ZTsKIHQuVmVjeXJpbGxpYyA9IDB4MDQxMjsKIHQuVmV3YXJtZW5pYW4gPSAweDA1NGU7CiB0LlZob29rID0gMHgwMWIyOwogdC5WbW9ub3NwYWNlID0gMHhmZjM2OwogdC5Wb2FybWVuaWFuID0gMHgwNTQ4OwogdC5Wc21hbGwgPSAweGY3NzY7CiB0LlZ0aWxkZSA9IDB4MWU3YzsKIHQuVyA9IDB4MDA1NzsKIHQuV2FjdXRlID0gMHgxZTgyOwogdC5XY2lyY2xlID0gMHgyNGNjOwogdC5XY2lyY3VtZmxleCA9IDB4MDE3NDsKIHQuV2RpZXJlc2lzID0gMHgxZTg0OwogdC5XZG90YWNjZW50ID0gMHgxZTg2OwogdC5XZG90YmVsb3cgPSAweDFlODg7CiB0LldncmF2ZSA9IDB4MWU4MDsKIHQuV21vbm9zcGFjZSA9IDB4ZmYzNzsKIHQuV3NtYWxsID0gMHhmNzc3OwogdC5YID0gMHgwMDU4OwogdC5YY2lyY2xlID0gMHgyNGNkOwogdC5YZGllcmVzaXMgPSAweDFlOGM7CiB0Llhkb3RhY2NlbnQgPSAweDFlOGE7CiB0LlhlaGFybWVuaWFuID0gMHgwNTNkOwogdC5YaSA9IDB4MDM5ZTsKIHQuWG1vbm9zcGFjZSA9IDB4ZmYzODsKIHQuWHNtYWxsID0gMHhmNzc4OwogdC5ZID0gMHgwMDU5OwogdC5ZYWN1dGUgPSAweDAwZGQ7CiB0LllhY3V0ZXNtYWxsID0gMHhmN2ZkOwogdC5ZYXRjeXJpbGxpYyA9IDB4MDQ2MjsKIHQuWWNpcmNsZSA9IDB4MjRjZTsKIHQuWWNpcmN1bWZsZXggPSAweDAxNzY7CiB0LllkaWVyZXNpcyA9IDB4MDE3ODsKIHQuWWRpZXJlc2lzc21hbGwgPSAweGY3ZmY7CiB0Lllkb3RhY2NlbnQgPSAweDFlOGU7CiB0Lllkb3RiZWxvdyA9IDB4MWVmNDsKIHQuWWVyaWN5cmlsbGljID0gMHgwNDJiOwogdC5ZZXJ1ZGllcmVzaXNjeXJpbGxpYyA9IDB4MDRmODsKIHQuWWdyYXZlID0gMHgxZWYyOwogdC5ZaG9vayA9IDB4MDFiMzsKIHQuWWhvb2thYm92ZSA9IDB4MWVmNjsKIHQuWWlhcm1lbmlhbiA9IDB4MDU0NTsKIHQuWWljeXJpbGxpYyA9IDB4MDQwNzsKIHQuWWl3bmFybWVuaWFuID0gMHgwNTUyOwogdC5ZbW9ub3NwYWNlID0gMHhmZjM5OwogdC5Zc21hbGwgPSAweGY3Nzk7CiB0Lll0aWxkZSA9IDB4MWVmODsKIHQuWXVzYmlnY3lyaWxsaWMgPSAweDA0NmE7CiB0Lll1c2JpZ2lvdGlmaWVkY3lyaWxsaWMgPSAweDA0NmM7CiB0Lll1c2xpdHRsZWN5cmlsbGljID0gMHgwNDY2OwogdC5ZdXNsaXR0bGVpb3RpZmllZGN5cmlsbGljID0gMHgwNDY4OwogdC5aID0gMHgwMDVhOwogdC5aYWFybWVuaWFuID0gMHgwNTM2OwogdC5aYWN1dGUgPSAweDAxNzk7CiB0LlpjYXJvbiA9IDB4MDE3ZDsKIHQuWmNhcm9uc21hbGwgPSAweGY2ZmY7CiB0LlpjaXJjbGUgPSAweDI0Y2Y7CiB0LlpjaXJjdW1mbGV4ID0gMHgxZTkwOwogdC5aZG90ID0gMHgwMTdiOwogdC5aZG90YWNjZW50ID0gMHgwMTdiOwogdC5aZG90YmVsb3cgPSAweDFlOTI7CiB0LlplY3lyaWxsaWMgPSAweDA0MTc7CiB0LlplZGVzY2VuZGVyY3lyaWxsaWMgPSAweDA0OTg7CiB0LlplZGllcmVzaXNjeXJpbGxpYyA9IDB4MDRkZTsKIHQuWmV0YSA9IDB4MDM5NjsKIHQuWmhlYXJtZW5pYW4gPSAweDA1M2E7CiB0LlpoZWJyZXZlY3lyaWxsaWMgPSAweDA0YzE7CiB0LlpoZWN5cmlsbGljID0gMHgwNDE2OwogdC5aaGVkZXNjZW5kZXJjeXJpbGxpYyA9IDB4MDQ5NjsKIHQuWmhlZGllcmVzaXNjeXJpbGxpYyA9IDB4MDRkYzsKIHQuWmxpbmViZWxvdyA9IDB4MWU5NDsKIHQuWm1vbm9zcGFjZSA9IDB4ZmYzYTsKIHQuWnNtYWxsID0gMHhmNzdhOwogdC5ac3Ryb2tlID0gMHgwMWI1OwogdC5hID0gMHgwMDYxOwogdC5hYWJlbmdhbGkgPSAweDA5ODY7CiB0LmFhY3V0ZSA9IDB4MDBlMTsKIHQuYWFkZXZhID0gMHgwOTA2OwogdC5hYWd1amFyYXRpID0gMHgwYTg2OwogdC5hYWd1cm11a2hpID0gMHgwYTA2OwogdC5hYW1hdHJhZ3VybXVraGkgPSAweDBhM2U7CiB0LmFhcnVzcXVhcmUgPSAweDMzMDM7CiB0LmFhdm93ZWxzaWduYmVuZ2FsaSA9IDB4MDliZTsKIHQuYWF2b3dlbHNpZ25kZXZhID0gMHgwOTNlOwogdC5hYXZvd2Vsc2lnbmd1amFyYXRpID0gMHgwYWJlOwogdC5hYmJyZXZpYXRpb25tYXJrYXJtZW5pYW4gPSAweDA1NWY7CiB0LmFiYnJldmlhdGlvbnNpZ25kZXZhID0gMHgwOTcwOwogdC5hYmVuZ2FsaSA9IDB4MDk4NTsKIHQuYWJvcG9tb2ZvID0gMHgzMTFhOwogdC5hYnJldmUgPSAweDAxMDM7CiB0LmFicmV2ZWFjdXRlID0gMHgxZWFmOwogdC5hYnJldmVjeXJpbGxpYyA9IDB4MDRkMTsKIHQuYWJyZXZlZG90YmVsb3cgPSAweDFlYjc7CiB0LmFicmV2ZWdyYXZlID0gMHgxZWIxOwogdC5hYnJldmVob29rYWJvdmUgPSAweDFlYjM7CiB0LmFicmV2ZXRpbGRlID0gMHgxZWI1OwogdC5hY2Fyb24gPSAweDAxY2U7CiB0LmFjaXJjbGUgPSAweDI0ZDA7CiB0LmFjaXJjdW1mbGV4ID0gMHgwMGUyOwogdC5hY2lyY3VtZmxleGFjdXRlID0gMHgxZWE1OwogdC5hY2lyY3VtZmxleGRvdGJlbG93ID0gMHgxZWFkOwogdC5hY2lyY3VtZmxleGdyYXZlID0gMHgxZWE3OwogdC5hY2lyY3VtZmxleGhvb2thYm92ZSA9IDB4MWVhOTsKIHQuYWNpcmN1bWZsZXh0aWxkZSA9IDB4MWVhYjsKIHQuYWN1dGUgPSAweDAwYjQ7CiB0LmFjdXRlYmVsb3djbWIgPSAweDAzMTc7CiB0LmFjdXRlY21iID0gMHgwMzAxOwogdC5hY3V0ZWNvbWIgPSAweDAzMDE7CiB0LmFjdXRlZGV2YSA9IDB4MDk1NDsKIHQuYWN1dGVsb3dtb2QgPSAweDAyY2Y7CiB0LmFjdXRldG9uZWNtYiA9IDB4MDM0MTsKIHQuYWN5cmlsbGljID0gMHgwNDMwOwogdC5hZGJsZ3JhdmUgPSAweDAyMDE7CiB0LmFkZGFrZ3VybXVraGkgPSAweDBhNzE7CiB0LmFkZXZhID0gMHgwOTA1OwogdC5hZGllcmVzaXMgPSAweDAwZTQ7CiB0LmFkaWVyZXNpc2N5cmlsbGljID0gMHgwNGQzOwogdC5hZGllcmVzaXNtYWNyb24gPSAweDAxZGY7CiB0LmFkb3RiZWxvdyA9IDB4MWVhMTsKIHQuYWRvdG1hY3JvbiA9IDB4MDFlMTsKIHQuYWUgPSAweDAwZTY7CiB0LmFlYWN1dGUgPSAweDAxZmQ7CiB0LmFla29yZWFuID0gMHgzMTUwOwogdC5hZW1hY3JvbiA9IDB4MDFlMzsKIHQuYWZpaTAwMjA4ID0gMHgyMDE1OwogdC5hZmlpMDg5NDEgPSAweDIwYTQ7CiB0LmFmaWkxMDAxNyA9IDB4MDQxMDsKIHQuYWZpaTEwMDE4ID0gMHgwNDExOwogdC5hZmlpMTAwMTkgPSAweDA0MTI7CiB0LmFmaWkxMDAyMCA9IDB4MDQxMzsKIHQuYWZpaTEwMDIxID0gMHgwNDE0OwogdC5hZmlpMTAwMjIgPSAweDA0MTU7CiB0LmFmaWkxMDAyMyA9IDB4MDQwMTsKIHQuYWZpaTEwMDI0ID0gMHgwNDE2OwogdC5hZmlpMTAwMjUgPSAweDA0MTc7CiB0LmFmaWkxMDAyNiA9IDB4MDQxODsKIHQuYWZpaTEwMDI3ID0gMHgwNDE5OwogdC5hZmlpMTAwMjggPSAweDA0MWE7CiB0LmFmaWkxMDAyOSA9IDB4MDQxYjsKIHQuYWZpaTEwMDMwID0gMHgwNDFjOwogdC5hZmlpMTAwMzEgPSAweDA0MWQ7CiB0LmFmaWkxMDAzMiA9IDB4MDQxZTsKIHQuYWZpaTEwMDMzID0gMHgwNDFmOwogdC5hZmlpMTAwMzQgPSAweDA0MjA7CiB0LmFmaWkxMDAzNSA9IDB4MDQyMTsKIHQuYWZpaTEwMDM2ID0gMHgwNDIyOwogdC5hZmlpMTAwMzcgPSAweDA0MjM7CiB0LmFmaWkxMDAzOCA9IDB4MDQyNDsKIHQuYWZpaTEwMDM5ID0gMHgwNDI1OwogdC5hZmlpMTAwNDAgPSAweDA0MjY7CiB0LmFmaWkxMDA0MSA9IDB4MDQyNzsKIHQuYWZpaTEwMDQyID0gMHgwNDI4OwogdC5hZmlpMTAwNDMgPSAweDA0Mjk7CiB0LmFmaWkxMDA0NCA9IDB4MDQyYTsKIHQuYWZpaTEwMDQ1ID0gMHgwNDJiOwogdC5hZmlpMTAwNDYgPSAweDA0MmM7CiB0LmFmaWkxMDA0NyA9IDB4MDQyZDsKIHQuYWZpaTEwMDQ4ID0gMHgwNDJlOwogdC5hZmlpMTAwNDkgPSAweDA0MmY7CiB0LmFmaWkxMDA1MCA9IDB4MDQ5MDsKIHQuYWZpaTEwMDUxID0gMHgwNDAyOwogdC5hZmlpMTAwNTIgPSAweDA0MDM7CiB0LmFmaWkxMDA1MyA9IDB4MDQwNDsKIHQuYWZpaTEwMDU0ID0gMHgwNDA1OwogdC5hZmlpMTAwNTUgPSAweDA0MDY7CiB0LmFmaWkxMDA1NiA9IDB4MDQwNzsKIHQuYWZpaTEwMDU3ID0gMHgwNDA4OwogdC5hZmlpMTAwNTggPSAweDA0MDk7CiB0LmFmaWkxMDA1OSA9IDB4MDQwYTsKIHQuYWZpaTEwMDYwID0gMHgwNDBiOwogdC5hZmlpMTAwNjEgPSAweDA0MGM7CiB0LmFmaWkxMDA2MiA9IDB4MDQwZTsKIHQuYWZpaTEwMDYzID0gMHhmNmM0OwogdC5hZmlpMTAwNjQgPSAweGY2YzU7CiB0LmFmaWkxMDA2NSA9IDB4MDQzMDsKIHQuYWZpaTEwMDY2ID0gMHgwNDMxOwogdC5hZmlpMTAwNjcgPSAweDA0MzI7CiB0LmFmaWkxMDA2OCA9IDB4MDQzMzsKIHQuYWZpaTEwMDY5ID0gMHgwNDM0OwogdC5hZmlpMTAwNzAgPSAweDA0MzU7CiB0LmFmaWkxMDA3MSA9IDB4MDQ1MTsKIHQuYWZpaTEwMDcyID0gMHgwNDM2OwogdC5hZmlpMTAwNzMgPSAweDA0Mzc7CiB0LmFmaWkxMDA3NCA9IDB4MDQzODsKIHQuYWZpaTEwMDc1ID0gMHgwNDM5OwogdC5hZmlpMTAwNzYgPSAweDA0M2E7CiB0LmFmaWkxMDA3NyA9IDB4MDQzYjsKIHQuYWZpaTEwMDc4ID0gMHgwNDNjOwogdC5hZmlpMTAwNzkgPSAweDA0M2Q7CiB0LmFmaWkxMDA4MCA9IDB4MDQzZTsKIHQuYWZpaTEwMDgxID0gMHgwNDNmOwogdC5hZmlpMTAwODIgPSAweDA0NDA7CiB0LmFmaWkxMDA4MyA9IDB4MDQ0MTsKIHQuYWZpaTEwMDg0ID0gMHgwNDQyOwogdC5hZmlpMTAwODUgPSAweDA0NDM7CiB0LmFmaWkxMDA4NiA9IDB4MDQ0NDsKIHQuYWZpaTEwMDg3ID0gMHgwNDQ1OwogdC5hZmlpMTAwODggPSAweDA0NDY7CiB0LmFmaWkxMDA4OSA9IDB4MDQ0NzsKIHQuYWZpaTEwMDkwID0gMHgwNDQ4OwogdC5hZmlpMTAwOTEgPSAweDA0NDk7CiB0LmFmaWkxMDA5MiA9IDB4MDQ0YTsKIHQuYWZpaTEwMDkzID0gMHgwNDRiOwogdC5hZmlpMTAwOTQgPSAweDA0NGM7CiB0LmFmaWkxMDA5NSA9IDB4MDQ0ZDsKIHQuYWZpaTEwMDk2ID0gMHgwNDRlOwogdC5hZmlpMTAwOTcgPSAweDA0NGY7CiB0LmFmaWkxMDA5OCA9IDB4MDQ5MTsKIHQuYWZpaTEwMDk5ID0gMHgwNDUyOwogdC5hZmlpMTAxMDAgPSAweDA0NTM7CiB0LmFmaWkxMDEwMSA9IDB4MDQ1NDsKIHQuYWZpaTEwMTAyID0gMHgwNDU1OwogdC5hZmlpMTAxMDMgPSAweDA0NTY7CiB0LmFmaWkxMDEwNCA9IDB4MDQ1NzsKIHQuYWZpaTEwMTA1ID0gMHgwNDU4OwogdC5hZmlpMTAxMDYgPSAweDA0NTk7CiB0LmFmaWkxMDEwNyA9IDB4MDQ1YTsKIHQuYWZpaTEwMTA4ID0gMHgwNDViOwogdC5hZmlpMTAxMDkgPSAweDA0NWM7CiB0LmFmaWkxMDExMCA9IDB4MDQ1ZTsKIHQuYWZpaTEwMTQ1ID0gMHgwNDBmOwogdC5hZmlpMTAxNDYgPSAweDA0NjI7CiB0LmFmaWkxMDE0NyA9IDB4MDQ3MjsKIHQuYWZpaTEwMTQ4ID0gMHgwNDc0OwogdC5hZmlpMTAxOTIgPSAweGY2YzY7CiB0LmFmaWkxMDE5MyA9IDB4MDQ1ZjsKIHQuYWZpaTEwMTk0ID0gMHgwNDYzOwogdC5hZmlpMTAxOTUgPSAweDA0NzM7CiB0LmFmaWkxMDE5NiA9IDB4MDQ3NTsKIHQuYWZpaTEwODMxID0gMHhmNmM3OwogdC5hZmlpMTA4MzIgPSAweGY2Yzg7CiB0LmFmaWkxMDg0NiA9IDB4MDRkOTsKIHQuYWZpaTI5OSA9IDB4MjAwZTsKIHQuYWZpaTMwMCA9IDB4MjAwZjsKIHQuYWZpaTMwMSA9IDB4MjAwZDsKIHQuYWZpaTU3MzgxID0gMHgwNjZhOwogdC5hZmlpNTczODggPSAweDA2MGM7CiB0LmFmaWk1NzM5MiA9IDB4MDY2MDsKIHQuYWZpaTU3MzkzID0gMHgwNjYxOwogdC5hZmlpNTczOTQgPSAweDA2NjI7CiB0LmFmaWk1NzM5NSA9IDB4MDY2MzsKIHQuYWZpaTU3Mzk2ID0gMHgwNjY0OwogdC5hZmlpNTczOTcgPSAweDA2NjU7CiB0LmFmaWk1NzM5OCA9IDB4MDY2NjsKIHQuYWZpaTU3Mzk5ID0gMHgwNjY3OwogdC5hZmlpNTc0MDAgPSAweDA2Njg7CiB0LmFmaWk1NzQwMSA9IDB4MDY2OTsKIHQuYWZpaTU3NDAzID0gMHgwNjFiOwogdC5hZmlpNTc0MDcgPSAweDA2MWY7CiB0LmFmaWk1NzQwOSA9IDB4MDYyMTsKIHQuYWZpaTU3NDEwID0gMHgwNjIyOwogdC5hZmlpNTc0MTEgPSAweDA2MjM7CiB0LmFmaWk1NzQxMiA9IDB4MDYyNDsKIHQuYWZpaTU3NDEzID0gMHgwNjI1OwogdC5hZmlpNTc0MTQgPSAweDA2MjY7CiB0LmFmaWk1NzQxNSA9IDB4MDYyNzsKIHQuYWZpaTU3NDE2ID0gMHgwNjI4OwogdC5hZmlpNTc0MTcgPSAweDA2Mjk7CiB0LmFmaWk1NzQxOCA9IDB4MDYyYTsKIHQuYWZpaTU3NDE5ID0gMHgwNjJiOwogdC5hZmlpNTc0MjAgPSAweDA2MmM7CiB0LmFmaWk1NzQyMSA9IDB4MDYyZDsKIHQuYWZpaTU3NDIyID0gMHgwNjJlOwogdC5hZmlpNTc0MjMgPSAweDA2MmY7CiB0LmFmaWk1NzQyNCA9IDB4MDYzMDsKIHQuYWZpaTU3NDI1ID0gMHgwNjMxOwogdC5hZmlpNTc0MjYgPSAweDA2MzI7CiB0LmFmaWk1NzQyNyA9IDB4MDYzMzsKIHQuYWZpaTU3NDI4ID0gMHgwNjM0OwogdC5hZmlpNTc0MjkgPSAweDA2MzU7CiB0LmFmaWk1NzQzMCA9IDB4MDYzNjsKIHQuYWZpaTU3NDMxID0gMHgwNjM3OwogdC5hZmlpNTc0MzIgPSAweDA2Mzg7CiB0LmFmaWk1NzQzMyA9IDB4MDYzOTsKIHQuYWZpaTU3NDM0ID0gMHgwNjNhOwogdC5hZmlpNTc0NDAgPSAweDA2NDA7CiB0LmFmaWk1NzQ0MSA9IDB4MDY0MTsKIHQuYWZpaTU3NDQyID0gMHgwNjQyOwogdC5hZmlpNTc0NDMgPSAweDA2NDM7CiB0LmFmaWk1NzQ0NCA9IDB4MDY0NDsKIHQuYWZpaTU3NDQ1ID0gMHgwNjQ1OwogdC5hZmlpNTc0NDYgPSAweDA2NDY7CiB0LmFmaWk1NzQ0OCA9IDB4MDY0ODsKIHQuYWZpaTU3NDQ5ID0gMHgwNjQ5OwogdC5hZmlpNTc0NTAgPSAweDA2NGE7CiB0LmFmaWk1NzQ1MSA9IDB4MDY0YjsKIHQuYWZpaTU3NDUyID0gMHgwNjRjOwogdC5hZmlpNTc0NTMgPSAweDA2NGQ7CiB0LmFmaWk1NzQ1NCA9IDB4MDY0ZTsKIHQuYWZpaTU3NDU1ID0gMHgwNjRmOwogdC5hZmlpNTc0NTYgPSAweDA2NTA7CiB0LmFmaWk1NzQ1NyA9IDB4MDY1MTsKIHQuYWZpaTU3NDU4ID0gMHgwNjUyOwogdC5hZmlpNTc0NzAgPSAweDA2NDc7CiB0LmFmaWk1NzUwNSA9IDB4MDZhNDsKIHQuYWZpaTU3NTA2ID0gMHgwNjdlOwogdC5hZmlpNTc1MDcgPSAweDA2ODY7CiB0LmFmaWk1NzUwOCA9IDB4MDY5ODsKIHQuYWZpaTU3NTA5ID0gMHgwNmFmOwogdC5hZmlpNTc1MTEgPSAweDA2Nzk7CiB0LmFmaWk1NzUxMiA9IDB4MDY4ODsKIHQuYWZpaTU3NTEzID0gMHgwNjkxOwogdC5hZmlpNTc1MTQgPSAweDA2YmE7CiB0LmFmaWk1NzUxOSA9IDB4MDZkMjsKIHQuYWZpaTU3NTM0ID0gMHgwNmQ1OwogdC5hZmlpNTc2MzYgPSAweDIwYWE7CiB0LmFmaWk1NzY0NSA9IDB4MDViZTsKIHQuYWZpaTU3NjU4ID0gMHgwNWMzOwogdC5hZmlpNTc2NjQgPSAweDA1ZDA7CiB0LmFmaWk1NzY2NSA9IDB4MDVkMTsKIHQuYWZpaTU3NjY2ID0gMHgwNWQyOwogdC5hZmlpNTc2NjcgPSAweDA1ZDM7CiB0LmFmaWk1NzY2OCA9IDB4MDVkNDsKIHQuYWZpaTU3NjY5ID0gMHgwNWQ1OwogdC5hZmlpNTc2NzAgPSAweDA1ZDY7CiB0LmFmaWk1NzY3MSA9IDB4MDVkNzsKIHQuYWZpaTU3NjcyID0gMHgwNWQ4OwogdC5hZmlpNTc2NzMgPSAweDA1ZDk7CiB0LmFmaWk1NzY3NCA9IDB4MDVkYTsKIHQuYWZpaTU3Njc1ID0gMHgwNWRiOwogdC5hZmlpNTc2NzYgPSAweDA1ZGM7CiB0LmFmaWk1NzY3NyA9IDB4MDVkZDsKIHQuYWZpaTU3Njc4ID0gMHgwNWRlOwogdC5hZmlpNTc2NzkgPSAweDA1ZGY7CiB0LmFmaWk1NzY4MCA9IDB4MDVlMDsKIHQuYWZpaTU3NjgxID0gMHgwNWUxOwogdC5hZmlpNTc2ODIgPSAweDA1ZTI7CiB0LmFmaWk1NzY4MyA9IDB4MDVlMzsKIHQuYWZpaTU3Njg0ID0gMHgwNWU0OwogdC5hZmlpNTc2ODUgPSAweDA1ZTU7CiB0LmFmaWk1NzY4NiA9IDB4MDVlNjsKIHQuYWZpaTU3Njg3ID0gMHgwNWU3OwogdC5hZmlpNTc2ODggPSAweDA1ZTg7CiB0LmFmaWk1NzY4OSA9IDB4MDVlOTsKIHQuYWZpaTU3NjkwID0gMHgwNWVhOwogdC5hZmlpNTc2OTQgPSAweGZiMmE7CiB0LmFmaWk1NzY5NSA9IDB4ZmIyYjsKIHQuYWZpaTU3NzAwID0gMHhmYjRiOwogdC5hZmlpNTc3MDUgPSAweGZiMWY7CiB0LmFmaWk1NzcxNiA9IDB4MDVmMDsKIHQuYWZpaTU3NzE3ID0gMHgwNWYxOwogdC5hZmlpNTc3MTggPSAweDA1ZjI7CiB0LmFmaWk1NzcyMyA9IDB4ZmIzNTsKIHQuYWZpaTU3NzkzID0gMHgwNWI0OwogdC5hZmlpNTc3OTQgPSAweDA1YjU7CiB0LmFmaWk1Nzc5NSA9IDB4MDViNjsKIHQuYWZpaTU3Nzk2ID0gMHgwNWJiOwogdC5hZmlpNTc3OTcgPSAweDA1Yjg7CiB0LmFmaWk1Nzc5OCA9IDB4MDViNzsKIHQuYWZpaTU3Nzk5ID0gMHgwNWIwOwogdC5hZmlpNTc4MDAgPSAweDA1YjI7CiB0LmFmaWk1NzgwMSA9IDB4MDViMTsKIHQuYWZpaTU3ODAyID0gMHgwNWIzOwogdC5hZmlpNTc4MDMgPSAweDA1YzI7CiB0LmFmaWk1NzgwNCA9IDB4MDVjMTsKIHQuYWZpaTU3ODA2ID0gMHgwNWI5OwogdC5hZmlpNTc4MDcgPSAweDA1YmM7CiB0LmFmaWk1NzgzOSA9IDB4MDViZDsKIHQuYWZpaTU3ODQxID0gMHgwNWJmOwogdC5hZmlpNTc4NDIgPSAweDA1YzA7CiB0LmFmaWk1NzkyOSA9IDB4MDJiYzsKIHQuYWZpaTYxMjQ4ID0gMHgyMTA1OwogdC5hZmlpNjEyODkgPSAweDIxMTM7CiB0LmFmaWk2MTM1MiA9IDB4MjExNjsKIHQuYWZpaTYxNTczID0gMHgyMDJjOwogdC5hZmlpNjE1NzQgPSAweDIwMmQ7CiB0LmFmaWk2MTU3NSA9IDB4MjAyZTsKIHQuYWZpaTYxNjY0ID0gMHgyMDBjOwogdC5hZmlpNjMxNjcgPSAweDA2NmQ7CiB0LmFmaWk2NDkzNyA9IDB4MDJiZDsKIHQuYWdyYXZlID0gMHgwMGUwOwogdC5hZ3VqYXJhdGkgPSAweDBhODU7CiB0LmFndXJtdWtoaSA9IDB4MGEwNTsKIHQuYWhpcmFnYW5hID0gMHgzMDQyOwogdC5haG9va2Fib3ZlID0gMHgxZWEzOwogdC5haWJlbmdhbGkgPSAweDA5OTA7CiB0LmFpYm9wb21vZm8gPSAweDMxMWU7CiB0LmFpZGV2YSA9IDB4MDkxMDsKIHQuYWllY3lyaWxsaWMgPSAweDA0ZDU7CiB0LmFpZ3VqYXJhdGkgPSAweDBhOTA7CiB0LmFpZ3VybXVraGkgPSAweDBhMTA7CiB0LmFpbWF0cmFndXJtdWtoaSA9IDB4MGE0ODsKIHQuYWluYXJhYmljID0gMHgwNjM5OwogdC5haW5maW5hbGFyYWJpYyA9IDB4ZmVjYTsKIHQuYWluaW5pdGlhbGFyYWJpYyA9IDB4ZmVjYjsKIHQuYWlubWVkaWFsYXJhYmljID0gMHhmZWNjOwogdC5haW52ZXJ0ZWRicmV2ZSA9IDB4MDIwMzsKIHQuYWl2b3dlbHNpZ25iZW5nYWxpID0gMHgwOWM4OwogdC5haXZvd2Vsc2lnbmRldmEgPSAweDA5NDg7CiB0LmFpdm93ZWxzaWduZ3VqYXJhdGkgPSAweDBhYzg7CiB0LmFrYXRha2FuYSA9IDB4MzBhMjsKIHQuYWthdGFrYW5haGFsZndpZHRoID0gMHhmZjcxOwogdC5ha29yZWFuID0gMHgzMTRmOwogdC5hbGVmID0gMHgwNWQwOwogdC5hbGVmYXJhYmljID0gMHgwNjI3OwogdC5hbGVmZGFnZXNoaGVicmV3ID0gMHhmYjMwOwogdC5hbGVmZmluYWxhcmFiaWMgPSAweGZlOGU7CiB0LmFsZWZoYW16YWFib3ZlYXJhYmljID0gMHgwNjIzOwogdC5hbGVmaGFtemFhYm92ZWZpbmFsYXJhYmljID0gMHhmZTg0OwogdC5hbGVmaGFtemFiZWxvd2FyYWJpYyA9IDB4MDYyNTsKIHQuYWxlZmhhbXphYmVsb3dmaW5hbGFyYWJpYyA9IDB4ZmU4ODsKIHQuYWxlZmhlYnJldyA9IDB4MDVkMDsKIHQuYWxlZmxhbWVkaGVicmV3ID0gMHhmYjRmOwogdC5hbGVmbWFkZGFhYm92ZWFyYWJpYyA9IDB4MDYyMjsKIHQuYWxlZm1hZGRhYWJvdmVmaW5hbGFyYWJpYyA9IDB4ZmU4MjsKIHQuYWxlZm1ha3N1cmFhcmFiaWMgPSAweDA2NDk7CiB0LmFsZWZtYWtzdXJhZmluYWxhcmFiaWMgPSAweGZlZjA7CiB0LmFsZWZtYWtzdXJhaW5pdGlhbGFyYWJpYyA9IDB4ZmVmMzsKIHQuYWxlZm1ha3N1cmFtZWRpYWxhcmFiaWMgPSAweGZlZjQ7CiB0LmFsZWZwYXRhaGhlYnJldyA9IDB4ZmIyZTsKIHQuYWxlZnFhbWF0c2hlYnJldyA9IDB4ZmIyZjsKIHQuYWxlcGggPSAweDIxMzU7CiB0LmFsbGVxdWFsID0gMHgyMjRjOwogdC5hbHBoYSA9IDB4MDNiMTsKIHQuYWxwaGF0b25vcyA9IDB4MDNhYzsKIHQuYW1hY3JvbiA9IDB4MDEwMTsKIHQuYW1vbm9zcGFjZSA9IDB4ZmY0MTsKIHQuYW1wZXJzYW5kID0gMHgwMDI2OwogdC5hbXBlcnNhbmRtb25vc3BhY2UgPSAweGZmMDY7CiB0LmFtcGVyc2FuZHNtYWxsID0gMHhmNzI2OwogdC5hbXNxdWFyZSA9IDB4MzNjMjsKIHQuYW5ib3BvbW9mbyA9IDB4MzEyMjsKIHQuYW5nYm9wb21vZm8gPSAweDMxMjQ7CiB0LmFuZ2JyYWNrZXRsZWZ0ID0gMHgzMDA4OwogdC5hbmdicmFja2V0cmlnaHQgPSAweDMwMDk7CiB0LmFuZ2toYW5raHV0aGFpID0gMHgwZTVhOwogdC5hbmdsZSA9IDB4MjIyMDsKIHQuYW5nbGVicmFja2V0bGVmdCA9IDB4MzAwODsKIHQuYW5nbGVicmFja2V0bGVmdHZlcnRpY2FsID0gMHhmZTNmOwogdC5hbmdsZWJyYWNrZXRyaWdodCA9IDB4MzAwOTsKIHQuYW5nbGVicmFja2V0cmlnaHR2ZXJ0aWNhbCA9IDB4ZmU0MDsKIHQuYW5nbGVsZWZ0ID0gMHgyMzI5OwogdC5hbmdsZXJpZ2h0ID0gMHgyMzJhOwogdC5hbmdzdHJvbSA9IDB4MjEyYjsKIHQuYW5vdGVsZWlhID0gMHgwMzg3OwogdC5hbnVkYXR0YWRldmEgPSAweDA5NTI7CiB0LmFudXN2YXJhYmVuZ2FsaSA9IDB4MDk4MjsKIHQuYW51c3ZhcmFkZXZhID0gMHgwOTAyOwogdC5hbnVzdmFyYWd1amFyYXRpID0gMHgwYTgyOwogdC5hb2dvbmVrID0gMHgwMTA1OwogdC5hcGFhdG9zcXVhcmUgPSAweDMzMDA7CiB0LmFwYXJlbiA9IDB4MjQ5YzsKIHQuYXBvc3Ryb3BoZWFybWVuaWFuID0gMHgwNTVhOwogdC5hcG9zdHJvcGhlbW9kID0gMHgwMmJjOwogdC5hcHBsZSA9IDB4ZjhmZjsKIHQuYXBwcm9hY2hlcyA9IDB4MjI1MDsKIHQuYXBwcm94ZXF1YWwgPSAweDIyNDg7CiB0LmFwcHJveGVxdWFsb3JpbWFnZSA9IDB4MjI1MjsKIHQuYXBwcm94aW1hdGVseWVxdWFsID0gMHgyMjQ1OwogdC5hcmFlYWVrb3JlYW4gPSAweDMxOGU7CiB0LmFyYWVha29yZWFuID0gMHgzMThkOwogdC5hcmMgPSAweDIzMTI7CiB0LmFyaWdodGhhbGZyaW5nID0gMHgxZTlhOwogdC5hcmluZyA9IDB4MDBlNTsKIHQuYXJpbmdhY3V0ZSA9IDB4MDFmYjsKIHQuYXJpbmdiZWxvdyA9IDB4MWUwMTsKIHQuYXJyb3dib3RoID0gMHgyMTk0OwogdC5hcnJvd2Rhc2hkb3duID0gMHgyMWUzOwogdC5hcnJvd2Rhc2hsZWZ0ID0gMHgyMWUwOwogdC5hcnJvd2Rhc2hyaWdodCA9IDB4MjFlMjsKIHQuYXJyb3dkYXNodXAgPSAweDIxZTE7CiB0LmFycm93ZGJsYm90aCA9IDB4MjFkNDsKIHQuYXJyb3dkYmxkb3duID0gMHgyMWQzOwogdC5hcnJvd2RibGxlZnQgPSAweDIxZDA7CiB0LmFycm93ZGJscmlnaHQgPSAweDIxZDI7CiB0LmFycm93ZGJsdXAgPSAweDIxZDE7CiB0LmFycm93ZG93biA9IDB4MjE5MzsKIHQuYXJyb3dkb3dubGVmdCA9IDB4MjE5OTsKIHQuYXJyb3dkb3ducmlnaHQgPSAweDIxOTg7CiB0LmFycm93ZG93bndoaXRlID0gMHgyMWU5OwogdC5hcnJvd2hlYWRkb3dubW9kID0gMHgwMmM1OwogdC5hcnJvd2hlYWRsZWZ0bW9kID0gMHgwMmMyOwogdC5hcnJvd2hlYWRyaWdodG1vZCA9IDB4MDJjMzsKIHQuYXJyb3doZWFkdXBtb2QgPSAweDAyYzQ7CiB0LmFycm93aG9yaXpleCA9IDB4ZjhlNzsKIHQuYXJyb3dsZWZ0ID0gMHgyMTkwOwogdC5hcnJvd2xlZnRkYmwgPSAweDIxZDA7CiB0LmFycm93bGVmdGRibHN0cm9rZSA9IDB4MjFjZDsKIHQuYXJyb3dsZWZ0b3ZlcnJpZ2h0ID0gMHgyMWM2OwogdC5hcnJvd2xlZnR3aGl0ZSA9IDB4MjFlNjsKIHQuYXJyb3dyaWdodCA9IDB4MjE5MjsKIHQuYXJyb3dyaWdodGRibHN0cm9rZSA9IDB4MjFjZjsKIHQuYXJyb3dyaWdodGhlYXZ5ID0gMHgyNzllOwogdC5hcnJvd3JpZ2h0b3ZlcmxlZnQgPSAweDIxYzQ7CiB0LmFycm93cmlnaHR3aGl0ZSA9IDB4MjFlODsKIHQuYXJyb3d0YWJsZWZ0ID0gMHgyMWU0OwogdC5hcnJvd3RhYnJpZ2h0ID0gMHgyMWU1OwogdC5hcnJvd3VwID0gMHgyMTkxOwogdC5hcnJvd3VwZG4gPSAweDIxOTU7CiB0LmFycm93dXBkbmJzZSA9IDB4MjFhODsKIHQuYXJyb3d1cGRvd25iYXNlID0gMHgyMWE4OwogdC5hcnJvd3VwbGVmdCA9IDB4MjE5NjsKIHQuYXJyb3d1cGxlZnRvZmRvd24gPSAweDIxYzU7CiB0LmFycm93dXByaWdodCA9IDB4MjE5NzsKIHQuYXJyb3d1cHdoaXRlID0gMHgyMWU3OwogdC5hcnJvd3ZlcnRleCA9IDB4ZjhlNjsKIHQuYXNjaWljaXJjdW0gPSAweDAwNWU7CiB0LmFzY2lpY2lyY3VtbW9ub3NwYWNlID0gMHhmZjNlOwogdC5hc2NpaXRpbGRlID0gMHgwMDdlOwogdC5hc2NpaXRpbGRlbW9ub3NwYWNlID0gMHhmZjVlOwogdC5hc2NyaXB0ID0gMHgwMjUxOwogdC5hc2NyaXB0dHVybmVkID0gMHgwMjUyOwogdC5hc21hbGxoaXJhZ2FuYSA9IDB4MzA0MTsKIHQuYXNtYWxsa2F0YWthbmEgPSAweDMwYTE7CiB0LmFzbWFsbGthdGFrYW5haGFsZndpZHRoID0gMHhmZjY3OwogdC5hc3RlcmlzayA9IDB4MDAyYTsKIHQuYXN0ZXJpc2thbHRvbmVhcmFiaWMgPSAweDA2NmQ7CiB0LmFzdGVyaXNrYXJhYmljID0gMHgwNjZkOwogdC5hc3Rlcmlza21hdGggPSAweDIyMTc7CiB0LmFzdGVyaXNrbW9ub3NwYWNlID0gMHhmZjBhOwogdC5hc3Rlcmlza3NtYWxsID0gMHhmZTYxOwogdC5hc3RlcmlzbSA9IDB4MjA0MjsKIHQuYXN1cGVyaW9yID0gMHhmNmU5OwogdC5hc3ltcHRvdGljYWxseWVxdWFsID0gMHgyMjQzOwogdC5hdCA9IDB4MDA0MDsKIHQuYXRpbGRlID0gMHgwMGUzOwogdC5hdG1vbm9zcGFjZSA9IDB4ZmYyMDsKIHQuYXRzbWFsbCA9IDB4ZmU2YjsKIHQuYXR1cm5lZCA9IDB4MDI1MDsKIHQuYXViZW5nYWxpID0gMHgwOTk0OwogdC5hdWJvcG9tb2ZvID0gMHgzMTIwOwogdC5hdWRldmEgPSAweDA5MTQ7CiB0LmF1Z3VqYXJhdGkgPSAweDBhOTQ7CiB0LmF1Z3VybXVraGkgPSAweDBhMTQ7CiB0LmF1bGVuZ3RobWFya2JlbmdhbGkgPSAweDA5ZDc7CiB0LmF1bWF0cmFndXJtdWtoaSA9IDB4MGE0YzsKIHQuYXV2b3dlbHNpZ25iZW5nYWxpID0gMHgwOWNjOwogdC5hdXZvd2Vsc2lnbmRldmEgPSAweDA5NGM7CiB0LmF1dm93ZWxzaWduZ3VqYXJhdGkgPSAweDBhY2M7CiB0LmF2YWdyYWhhZGV2YSA9IDB4MDkzZDsKIHQuYXliYXJtZW5pYW4gPSAweDA1NjE7CiB0LmF5aW4gPSAweDA1ZTI7CiB0LmF5aW5hbHRvbmVoZWJyZXcgPSAweGZiMjA7CiB0LmF5aW5oZWJyZXcgPSAweDA1ZTI7CiB0LmIgPSAweDAwNjI7CiB0LmJhYmVuZ2FsaSA9IDB4MDlhYzsKIHQuYmFja3NsYXNoID0gMHgwMDVjOwogdC5iYWNrc2xhc2htb25vc3BhY2UgPSAweGZmM2M7CiB0LmJhZGV2YSA9IDB4MDkyYzsKIHQuYmFndWphcmF0aSA9IDB4MGFhYzsKIHQuYmFndXJtdWtoaSA9IDB4MGEyYzsKIHQuYmFoaXJhZ2FuYSA9IDB4MzA3MDsKIHQuYmFodHRoYWkgPSAweDBlM2Y7CiB0LmJha2F0YWthbmEgPSAweDMwZDA7CiB0LmJhciA9IDB4MDA3YzsKIHQuYmFybW9ub3NwYWNlID0gMHhmZjVjOwogdC5iYm9wb21vZm8gPSAweDMxMDU7CiB0LmJjaXJjbGUgPSAweDI0ZDE7CiB0LmJkb3RhY2NlbnQgPSAweDFlMDM7CiB0LmJkb3RiZWxvdyA9IDB4MWUwNTsKIHQuYmVhbWVkc2l4dGVlbnRobm90ZXMgPSAweDI2NmM7CiB0LmJlY2F1c2UgPSAweDIyMzU7CiB0LmJlY3lyaWxsaWMgPSAweDA0MzE7CiB0LmJlaGFyYWJpYyA9IDB4MDYyODsKIHQuYmVoZmluYWxhcmFiaWMgPSAweGZlOTA7CiB0LmJlaGluaXRpYWxhcmFiaWMgPSAweGZlOTE7CiB0LmJlaGlyYWdhbmEgPSAweDMwNzk7CiB0LmJlaG1lZGlhbGFyYWJpYyA9IDB4ZmU5MjsKIHQuYmVobWVlbWluaXRpYWxhcmFiaWMgPSAweGZjOWY7CiB0LmJlaG1lZW1pc29sYXRlZGFyYWJpYyA9IDB4ZmMwODsKIHQuYmVobm9vbmZpbmFsYXJhYmljID0gMHhmYzZkOwogdC5iZWthdGFrYW5hID0gMHgzMGQ5OwogdC5iZW5hcm1lbmlhbiA9IDB4MDU2MjsKIHQuYmV0ID0gMHgwNWQxOwogdC5iZXRhID0gMHgwM2IyOwogdC5iZXRhc3ltYm9sZ3JlZWsgPSAweDAzZDA7CiB0LmJldGRhZ2VzaCA9IDB4ZmIzMTsKIHQuYmV0ZGFnZXNoaGVicmV3ID0gMHhmYjMxOwogdC5iZXRoZWJyZXcgPSAweDA1ZDE7CiB0LmJldHJhZmVoZWJyZXcgPSAweGZiNGM7CiB0LmJoYWJlbmdhbGkgPSAweDA5YWQ7CiB0LmJoYWRldmEgPSAweDA5MmQ7CiB0LmJoYWd1amFyYXRpID0gMHgwYWFkOwogdC5iaGFndXJtdWtoaSA9IDB4MGEyZDsKIHQuYmhvb2sgPSAweDAyNTM7CiB0LmJpaGlyYWdhbmEgPSAweDMwNzM7CiB0LmJpa2F0YWthbmEgPSAweDMwZDM7CiB0LmJpbGFiaWFsY2xpY2sgPSAweDAyOTg7CiB0LmJpbmRpZ3VybXVraGkgPSAweDBhMDI7CiB0LmJpcnVzcXVhcmUgPSAweDMzMzE7CiB0LmJsYWNrY2lyY2xlID0gMHgyNWNmOwogdC5ibGFja2RpYW1vbmQgPSAweDI1YzY7CiB0LmJsYWNrZG93bnBvaW50aW5ndHJpYW5nbGUgPSAweDI1YmM7CiB0LmJsYWNrbGVmdHBvaW50aW5ncG9pbnRlciA9IDB4MjVjNDsKIHQuYmxhY2tsZWZ0cG9pbnRpbmd0cmlhbmdsZSA9IDB4MjVjMDsKIHQuYmxhY2tsZW50aWN1bGFyYnJhY2tldGxlZnQgPSAweDMwMTA7CiB0LmJsYWNrbGVudGljdWxhcmJyYWNrZXRsZWZ0dmVydGljYWwgPSAweGZlM2I7CiB0LmJsYWNrbGVudGljdWxhcmJyYWNrZXRyaWdodCA9IDB4MzAxMTsKIHQuYmxhY2tsZW50aWN1bGFyYnJhY2tldHJpZ2h0dmVydGljYWwgPSAweGZlM2M7CiB0LmJsYWNrbG93ZXJsZWZ0dHJpYW5nbGUgPSAweDI1ZTM7CiB0LmJsYWNrbG93ZXJyaWdodHRyaWFuZ2xlID0gMHgyNWUyOwogdC5ibGFja3JlY3RhbmdsZSA9IDB4MjVhYzsKIHQuYmxhY2tyaWdodHBvaW50aW5ncG9pbnRlciA9IDB4MjViYTsKIHQuYmxhY2tyaWdodHBvaW50aW5ndHJpYW5nbGUgPSAweDI1YjY7CiB0LmJsYWNrc21hbGxzcXVhcmUgPSAweDI1YWE7CiB0LmJsYWNrc21pbGluZ2ZhY2UgPSAweDI2M2I7CiB0LmJsYWNrc3F1YXJlID0gMHgyNWEwOwogdC5ibGFja3N0YXIgPSAweDI2MDU7CiB0LmJsYWNrdXBwZXJsZWZ0dHJpYW5nbGUgPSAweDI1ZTQ7CiB0LmJsYWNrdXBwZXJyaWdodHRyaWFuZ2xlID0gMHgyNWU1OwogdC5ibGFja3VwcG9pbnRpbmdzbWFsbHRyaWFuZ2xlID0gMHgyNWI0OwogdC5ibGFja3VwcG9pbnRpbmd0cmlhbmdsZSA9IDB4MjViMjsKIHQuYmxhbmsgPSAweDI0MjM7CiB0LmJsaW5lYmVsb3cgPSAweDFlMDc7CiB0LmJsb2NrID0gMHgyNTg4OwogdC5ibW9ub3NwYWNlID0gMHhmZjQyOwogdC5ib2JhaW1haXRoYWkgPSAweDBlMWE7CiB0LmJvaGlyYWdhbmEgPSAweDMwN2M7CiB0LmJva2F0YWthbmEgPSAweDMwZGM7CiB0LmJwYXJlbiA9IDB4MjQ5ZDsKIHQuYnFzcXVhcmUgPSAweDMzYzM7CiB0LmJyYWNlZXggPSAweGY4ZjQ7CiB0LmJyYWNlbGVmdCA9IDB4MDA3YjsKIHQuYnJhY2VsZWZ0YnQgPSAweGY4ZjM7CiB0LmJyYWNlbGVmdG1pZCA9IDB4ZjhmMjsKIHQuYnJhY2VsZWZ0bW9ub3NwYWNlID0gMHhmZjViOwogdC5icmFjZWxlZnRzbWFsbCA9IDB4ZmU1YjsKIHQuYnJhY2VsZWZ0dHAgPSAweGY4ZjE7CiB0LmJyYWNlbGVmdHZlcnRpY2FsID0gMHhmZTM3OwogdC5icmFjZXJpZ2h0ID0gMHgwMDdkOwogdC5icmFjZXJpZ2h0YnQgPSAweGY4ZmU7CiB0LmJyYWNlcmlnaHRtaWQgPSAweGY4ZmQ7CiB0LmJyYWNlcmlnaHRtb25vc3BhY2UgPSAweGZmNWQ7CiB0LmJyYWNlcmlnaHRzbWFsbCA9IDB4ZmU1YzsKIHQuYnJhY2VyaWdodHRwID0gMHhmOGZjOwogdC5icmFjZXJpZ2h0dmVydGljYWwgPSAweGZlMzg7CiB0LmJyYWNrZXRsZWZ0ID0gMHgwMDViOwogdC5icmFja2V0bGVmdGJ0ID0gMHhmOGYwOwogdC5icmFja2V0bGVmdGV4ID0gMHhmOGVmOwogdC5icmFja2V0bGVmdG1vbm9zcGFjZSA9IDB4ZmYzYjsKIHQuYnJhY2tldGxlZnR0cCA9IDB4ZjhlZTsKIHQuYnJhY2tldHJpZ2h0ID0gMHgwMDVkOwogdC5icmFja2V0cmlnaHRidCA9IDB4ZjhmYjsKIHQuYnJhY2tldHJpZ2h0ZXggPSAweGY4ZmE7CiB0LmJyYWNrZXRyaWdodG1vbm9zcGFjZSA9IDB4ZmYzZDsKIHQuYnJhY2tldHJpZ2h0dHAgPSAweGY4Zjk7CiB0LmJyZXZlID0gMHgwMmQ4OwogdC5icmV2ZWJlbG93Y21iID0gMHgwMzJlOwogdC5icmV2ZWNtYiA9IDB4MDMwNjsKIHQuYnJldmVpbnZlcnRlZGJlbG93Y21iID0gMHgwMzJmOwogdC5icmV2ZWludmVydGVkY21iID0gMHgwMzExOwogdC5icmV2ZWludmVydGVkZG91YmxlY21iID0gMHgwMzYxOwogdC5icmlkZ2ViZWxvd2NtYiA9IDB4MDMyYTsKIHQuYnJpZGdlaW52ZXJ0ZWRiZWxvd2NtYiA9IDB4MDMzYTsKIHQuYnJva2VuYmFyID0gMHgwMGE2OwogdC5ic3Ryb2tlID0gMHgwMTgwOwogdC5ic3VwZXJpb3IgPSAweGY2ZWE7CiB0LmJ0b3BiYXIgPSAweDAxODM7CiB0LmJ1aGlyYWdhbmEgPSAweDMwNzY7CiB0LmJ1a2F0YWthbmEgPSAweDMwZDY7CiB0LmJ1bGxldCA9IDB4MjAyMjsKIHQuYnVsbGV0aW52ZXJzZSA9IDB4MjVkODsKIHQuYnVsbGV0b3BlcmF0b3IgPSAweDIyMTk7CiB0LmJ1bGxzZXllID0gMHgyNWNlOwogdC5jID0gMHgwMDYzOwogdC5jYWFybWVuaWFuID0gMHgwNTZlOwogdC5jYWJlbmdhbGkgPSAweDA5OWE7CiB0LmNhY3V0ZSA9IDB4MDEwNzsKIHQuY2FkZXZhID0gMHgwOTFhOwogdC5jYWd1amFyYXRpID0gMHgwYTlhOwogdC5jYWd1cm11a2hpID0gMHgwYTFhOwogdC5jYWxzcXVhcmUgPSAweDMzODg7CiB0LmNhbmRyYWJpbmR1YmVuZ2FsaSA9IDB4MDk4MTsKIHQuY2FuZHJhYmluZHVjbWIgPSAweDAzMTA7CiB0LmNhbmRyYWJpbmR1ZGV2YSA9IDB4MDkwMTsKIHQuY2FuZHJhYmluZHVndWphcmF0aSA9IDB4MGE4MTsKIHQuY2Fwc2xvY2sgPSAweDIxZWE7CiB0LmNhcmVvZiA9IDB4MjEwNTsKIHQuY2Fyb24gPSAweDAyYzc7CiB0LmNhcm9uYmVsb3djbWIgPSAweDAzMmM7CiB0LmNhcm9uY21iID0gMHgwMzBjOwogdC5jYXJyaWFnZXJldHVybiA9IDB4MjFiNTsKIHQuY2JvcG9tb2ZvID0gMHgzMTE4OwogdC5jY2Fyb24gPSAweDAxMGQ7CiB0LmNjZWRpbGxhID0gMHgwMGU3OwogdC5jY2VkaWxsYWFjdXRlID0gMHgxZTA5OwogdC5jY2lyY2xlID0gMHgyNGQyOwogdC5jY2lyY3VtZmxleCA9IDB4MDEwOTsKIHQuY2N1cmwgPSAweDAyNTU7CiB0LmNkb3QgPSAweDAxMGI7CiB0LmNkb3RhY2NlbnQgPSAweDAxMGI7CiB0LmNkc3F1YXJlID0gMHgzM2M1OwogdC5jZWRpbGxhID0gMHgwMGI4OwogdC5jZWRpbGxhY21iID0gMHgwMzI3OwogdC5jZW50ID0gMHgwMGEyOwogdC5jZW50aWdyYWRlID0gMHgyMTAzOwogdC5jZW50aW5mZXJpb3IgPSAweGY2ZGY7CiB0LmNlbnRtb25vc3BhY2UgPSAweGZmZTA7CiB0LmNlbnRvbGRzdHlsZSA9IDB4ZjdhMjsKIHQuY2VudHN1cGVyaW9yID0gMHhmNmUwOwogdC5jaGFhcm1lbmlhbiA9IDB4MDU3OTsKIHQuY2hhYmVuZ2FsaSA9IDB4MDk5YjsKIHQuY2hhZGV2YSA9IDB4MDkxYjsKIHQuY2hhZ3VqYXJhdGkgPSAweDBhOWI7CiB0LmNoYWd1cm11a2hpID0gMHgwYTFiOwogdC5jaGJvcG9tb2ZvID0gMHgzMTE0OwogdC5jaGVhYmtoYXNpYW5jeXJpbGxpYyA9IDB4MDRiZDsKIHQuY2hlY2ttYXJrID0gMHgyNzEzOwogdC5jaGVjeXJpbGxpYyA9IDB4MDQ0NzsKIHQuY2hlZGVzY2VuZGVyYWJraGFzaWFuY3lyaWxsaWMgPSAweDA0YmY7CiB0LmNoZWRlc2NlbmRlcmN5cmlsbGljID0gMHgwNGI3OwogdC5jaGVkaWVyZXNpc2N5cmlsbGljID0gMHgwNGY1OwogdC5jaGVoYXJtZW5pYW4gPSAweDA1NzM7CiB0LmNoZWtoYWthc3NpYW5jeXJpbGxpYyA9IDB4MDRjYzsKIHQuY2hldmVydGljYWxzdHJva2VjeXJpbGxpYyA9IDB4MDRiOTsKIHQuY2hpID0gMHgwM2M3OwogdC5jaGlldWNoYWNpcmNsZWtvcmVhbiA9IDB4MzI3NzsKIHQuY2hpZXVjaGFwYXJlbmtvcmVhbiA9IDB4MzIxNzsKIHQuY2hpZXVjaGNpcmNsZWtvcmVhbiA9IDB4MzI2OTsKIHQuY2hpZXVjaGtvcmVhbiA9IDB4MzE0YTsKIHQuY2hpZXVjaHBhcmVua29yZWFuID0gMHgzMjA5OwogdC5jaG9jaGFuZ3RoYWkgPSAweDBlMGE7CiB0LmNob2NoYW50aGFpID0gMHgwZTA4OwogdC5jaG9jaGluZ3RoYWkgPSAweDBlMDk7CiB0LmNob2Nob2V0aGFpID0gMHgwZTBjOwogdC5jaG9vayA9IDB4MDE4ODsKIHQuY2lldWNhY2lyY2xla29yZWFuID0gMHgzMjc2OwogdC5jaWV1Y2FwYXJlbmtvcmVhbiA9IDB4MzIxNjsKIHQuY2lldWNjaXJjbGVrb3JlYW4gPSAweDMyNjg7CiB0LmNpZXVja29yZWFuID0gMHgzMTQ4OwogdC5jaWV1Y3BhcmVua29yZWFuID0gMHgzMjA4OwogdC5jaWV1Y3VwYXJlbmtvcmVhbiA9IDB4MzIxYzsKIHQuY2lyY2xlID0gMHgyNWNiOwogdC5jaXJjbGVjb3B5cnQgPSAweDAwYTk7CiB0LmNpcmNsZW11bHRpcGx5ID0gMHgyMjk3OwogdC5jaXJjbGVvdCA9IDB4MjI5OTsKIHQuY2lyY2xlcGx1cyA9IDB4MjI5NTsKIHQuY2lyY2xlcG9zdGFsbWFyayA9IDB4MzAzNjsKIHQuY2lyY2xld2l0aGxlZnRoYWxmYmxhY2sgPSAweDI1ZDA7CiB0LmNpcmNsZXdpdGhyaWdodGhhbGZibGFjayA9IDB4MjVkMTsKIHQuY2lyY3VtZmxleCA9IDB4MDJjNjsKIHQuY2lyY3VtZmxleGJlbG93Y21iID0gMHgwMzJkOwogdC5jaXJjdW1mbGV4Y21iID0gMHgwMzAyOwogdC5jbGVhciA9IDB4MjMyNzsKIHQuY2xpY2thbHZlb2xhciA9IDB4MDFjMjsKIHQuY2xpY2tkZW50YWwgPSAweDAxYzA7CiB0LmNsaWNrbGF0ZXJhbCA9IDB4MDFjMTsKIHQuY2xpY2tyZXRyb2ZsZXggPSAweDAxYzM7CiB0LmNsdWIgPSAweDI2NjM7CiB0LmNsdWJzdWl0YmxhY2sgPSAweDI2NjM7CiB0LmNsdWJzdWl0d2hpdGUgPSAweDI2Njc7CiB0LmNtY3ViZWRzcXVhcmUgPSAweDMzYTQ7CiB0LmNtb25vc3BhY2UgPSAweGZmNDM7CiB0LmNtc3F1YXJlZHNxdWFyZSA9IDB4MzNhMDsKIHQuY29hcm1lbmlhbiA9IDB4MDU4MTsKIHQuY29sb24gPSAweDAwM2E7CiB0LmNvbG9ubW9uZXRhcnkgPSAweDIwYTE7CiB0LmNvbG9ubW9ub3NwYWNlID0gMHhmZjFhOwogdC5jb2xvbnNpZ24gPSAweDIwYTE7CiB0LmNvbG9uc21hbGwgPSAweGZlNTU7CiB0LmNvbG9udHJpYW5ndWxhcmhhbGZtb2QgPSAweDAyZDE7CiB0LmNvbG9udHJpYW5ndWxhcm1vZCA9IDB4MDJkMDsKIHQuY29tbWEgPSAweDAwMmM7CiB0LmNvbW1hYWJvdmVjbWIgPSAweDAzMTM7CiB0LmNvbW1hYWJvdmVyaWdodGNtYiA9IDB4MDMxNTsKIHQuY29tbWFhY2NlbnQgPSAweGY2YzM7CiB0LmNvbW1hYXJhYmljID0gMHgwNjBjOwogdC5jb21tYWFybWVuaWFuID0gMHgwNTVkOwogdC5jb21tYWluZmVyaW9yID0gMHhmNmUxOwogdC5jb21tYW1vbm9zcGFjZSA9IDB4ZmYwYzsKIHQuY29tbWFyZXZlcnNlZGFib3ZlY21iID0gMHgwMzE0OwogdC5jb21tYXJldmVyc2VkbW9kID0gMHgwMmJkOwogdC5jb21tYXNtYWxsID0gMHhmZTUwOwogdC5jb21tYXN1cGVyaW9yID0gMHhmNmUyOwogdC5jb21tYXR1cm5lZGFib3ZlY21iID0gMHgwMzEyOwogdC5jb21tYXR1cm5lZG1vZCA9IDB4MDJiYjsKIHQuY29tcGFzcyA9IDB4MjYzYzsKIHQuY29uZ3J1ZW50ID0gMHgyMjQ1OwogdC5jb250b3VyaW50ZWdyYWwgPSAweDIyMmU7CiB0LmNvbnRyb2wgPSAweDIzMDM7CiB0LmNvbnRyb2xBQ0sgPSAweDAwMDY7CiB0LmNvbnRyb2xCRUwgPSAweDAwMDc7CiB0LmNvbnRyb2xCUyA9IDB4MDAwODsKIHQuY29udHJvbENBTiA9IDB4MDAxODsKIHQuY29udHJvbENSID0gMHgwMDBkOwogdC5jb250cm9sREMxID0gMHgwMDExOwogdC5jb250cm9sREMyID0gMHgwMDEyOwogdC5jb250cm9sREMzID0gMHgwMDEzOwogdC5jb250cm9sREM0ID0gMHgwMDE0OwogdC5jb250cm9sREVMID0gMHgwMDdmOwogdC5jb250cm9sRExFID0gMHgwMDEwOwogdC5jb250cm9sRU0gPSAweDAwMTk7CiB0LmNvbnRyb2xFTlEgPSAweDAwMDU7CiB0LmNvbnRyb2xFT1QgPSAweDAwMDQ7CiB0LmNvbnRyb2xFU0MgPSAweDAwMWI7CiB0LmNvbnRyb2xFVEIgPSAweDAwMTc7CiB0LmNvbnRyb2xFVFggPSAweDAwMDM7CiB0LmNvbnRyb2xGRiA9IDB4MDAwYzsKIHQuY29udHJvbEZTID0gMHgwMDFjOwogdC5jb250cm9sR1MgPSAweDAwMWQ7CiB0LmNvbnRyb2xIVCA9IDB4MDAwOTsKIHQuY29udHJvbExGID0gMHgwMDBhOwogdC5jb250cm9sTkFLID0gMHgwMDE1OwogdC5jb250cm9sTlVMTCA9IDB4MDAwMDsKIHQuY29udHJvbFJTID0gMHgwMDFlOwogdC5jb250cm9sU0kgPSAweDAwMGY7CiB0LmNvbnRyb2xTTyA9IDB4MDAwZTsKIHQuY29udHJvbFNPVCA9IDB4MDAwMjsKIHQuY29udHJvbFNUWCA9IDB4MDAwMTsKIHQuY29udHJvbFNVQiA9IDB4MDAxYTsKIHQuY29udHJvbFNZTiA9IDB4MDAxNjsKIHQuY29udHJvbFVTID0gMHgwMDFmOwogdC5jb250cm9sVlQgPSAweDAwMGI7CiB0LmNvcHlyaWdodCA9IDB4MDBhOTsKIHQuY29weXJpZ2h0c2FucyA9IDB4ZjhlOTsKIHQuY29weXJpZ2h0c2VyaWYgPSAweGY2ZDk7CiB0LmNvcm5lcmJyYWNrZXRsZWZ0ID0gMHgzMDBjOwogdC5jb3JuZXJicmFja2V0bGVmdGhhbGZ3aWR0aCA9IDB4ZmY2MjsKIHQuY29ybmVyYnJhY2tldGxlZnR2ZXJ0aWNhbCA9IDB4ZmU0MTsKIHQuY29ybmVyYnJhY2tldHJpZ2h0ID0gMHgzMDBkOwogdC5jb3JuZXJicmFja2V0cmlnaHRoYWxmd2lkdGggPSAweGZmNjM7CiB0LmNvcm5lcmJyYWNrZXRyaWdodHZlcnRpY2FsID0gMHhmZTQyOwogdC5jb3Jwb3JhdGlvbnNxdWFyZSA9IDB4MzM3ZjsKIHQuY29zcXVhcmUgPSAweDMzYzc7CiB0LmNvdmVya2dzcXVhcmUgPSAweDMzYzY7CiB0LmNwYXJlbiA9IDB4MjQ5ZTsKIHQuY3J1emVpcm8gPSAweDIwYTI7CiB0LmNzdHJldGNoZWQgPSAweDAyOTc7CiB0LmN1cmx5YW5kID0gMHgyMmNmOwogdC5jdXJseW9yID0gMHgyMmNlOwogdC5jdXJyZW5jeSA9IDB4MDBhNDsKIHQuY3lyQnJldmUgPSAweGY2ZDE7CiB0LmN5ckZsZXggPSAweGY2ZDI7CiB0LmN5cmJyZXZlID0gMHhmNmQ0OwogdC5jeXJmbGV4ID0gMHhmNmQ1OwogdC5kID0gMHgwMDY0OwogdC5kYWFybWVuaWFuID0gMHgwNTY0OwogdC5kYWJlbmdhbGkgPSAweDA5YTY7CiB0LmRhZGFyYWJpYyA9IDB4MDYzNjsKIHQuZGFkZXZhID0gMHgwOTI2OwogdC5kYWRmaW5hbGFyYWJpYyA9IDB4ZmViZTsKIHQuZGFkaW5pdGlhbGFyYWJpYyA9IDB4ZmViZjsKIHQuZGFkbWVkaWFsYXJhYmljID0gMHhmZWMwOwogdC5kYWdlc2ggPSAweDA1YmM7CiB0LmRhZ2VzaGhlYnJldyA9IDB4MDViYzsKIHQuZGFnZ2VyID0gMHgyMDIwOwogdC5kYWdnZXJkYmwgPSAweDIwMjE7CiB0LmRhZ3VqYXJhdGkgPSAweDBhYTY7CiB0LmRhZ3VybXVraGkgPSAweDBhMjY7CiB0LmRhaGlyYWdhbmEgPSAweDMwNjA7CiB0LmRha2F0YWthbmEgPSAweDMwYzA7CiB0LmRhbGFyYWJpYyA9IDB4MDYyZjsKIHQuZGFsZXQgPSAweDA1ZDM7CiB0LmRhbGV0ZGFnZXNoID0gMHhmYjMzOwogdC5kYWxldGRhZ2VzaGhlYnJldyA9IDB4ZmIzMzsKIHQuZGFsZXRoZWJyZXcgPSAweDA1ZDM7CiB0LmRhbGZpbmFsYXJhYmljID0gMHhmZWFhOwogdC5kYW1tYWFyYWJpYyA9IDB4MDY0ZjsKIHQuZGFtbWFsb3dhcmFiaWMgPSAweDA2NGY7CiB0LmRhbW1hdGFuYWx0b25lYXJhYmljID0gMHgwNjRjOwogdC5kYW1tYXRhbmFyYWJpYyA9IDB4MDY0YzsKIHQuZGFuZGEgPSAweDA5NjQ7CiB0LmRhcmdhaGVicmV3ID0gMHgwNWE3OwogdC5kYXJnYWxlZnRoZWJyZXcgPSAweDA1YTc7CiB0LmRhc2lhcG5ldW1hdGFjeXJpbGxpY2NtYiA9IDB4MDQ4NTsKIHQuZGJsR3JhdmUgPSAweGY2ZDM7CiB0LmRibGFuZ2xlYnJhY2tldGxlZnQgPSAweDMwMGE7CiB0LmRibGFuZ2xlYnJhY2tldGxlZnR2ZXJ0aWNhbCA9IDB4ZmUzZDsKIHQuZGJsYW5nbGVicmFja2V0cmlnaHQgPSAweDMwMGI7CiB0LmRibGFuZ2xlYnJhY2tldHJpZ2h0dmVydGljYWwgPSAweGZlM2U7CiB0LmRibGFyY2hpbnZlcnRlZGJlbG93Y21iID0gMHgwMzJiOwogdC5kYmxhcnJvd2xlZnQgPSAweDIxZDQ7CiB0LmRibGFycm93cmlnaHQgPSAweDIxZDI7CiB0LmRibGRhbmRhID0gMHgwOTY1OwogdC5kYmxncmF2ZSA9IDB4ZjZkNjsKIHQuZGJsZ3JhdmVjbWIgPSAweDAzMGY7CiB0LmRibGludGVncmFsID0gMHgyMjJjOwogdC5kYmxsb3dsaW5lID0gMHgyMDE3OwogdC5kYmxsb3dsaW5lY21iID0gMHgwMzMzOwogdC5kYmxvdmVybGluZWNtYiA9IDB4MDMzZjsKIHQuZGJscHJpbWVtb2QgPSAweDAyYmE7CiB0LmRibHZlcnRpY2FsYmFyID0gMHgyMDE2OwogdC5kYmx2ZXJ0aWNhbGxpbmVhYm92ZWNtYiA9IDB4MDMwZTsKIHQuZGJvcG9tb2ZvID0gMHgzMTA5OwogdC5kYnNxdWFyZSA9IDB4MzNjODsKIHQuZGNhcm9uID0gMHgwMTBmOwogdC5kY2VkaWxsYSA9IDB4MWUxMTsKIHQuZGNpcmNsZSA9IDB4MjRkMzsKIHQuZGNpcmN1bWZsZXhiZWxvdyA9IDB4MWUxMzsKIHQuZGNyb2F0ID0gMHgwMTExOwogdC5kZGFiZW5nYWxpID0gMHgwOWExOwogdC5kZGFkZXZhID0gMHgwOTIxOwogdC5kZGFndWphcmF0aSA9IDB4MGFhMTsKIHQuZGRhZ3VybXVraGkgPSAweDBhMjE7CiB0LmRkYWxhcmFiaWMgPSAweDA2ODg7CiB0LmRkYWxmaW5hbGFyYWJpYyA9IDB4ZmI4OTsKIHQuZGRkaGFkZXZhID0gMHgwOTVjOwogdC5kZGhhYmVuZ2FsaSA9IDB4MDlhMjsKIHQuZGRoYWRldmEgPSAweDA5MjI7CiB0LmRkaGFndWphcmF0aSA9IDB4MGFhMjsKIHQuZGRoYWd1cm11a2hpID0gMHgwYTIyOwogdC5kZG90YWNjZW50ID0gMHgxZTBiOwogdC5kZG90YmVsb3cgPSAweDFlMGQ7CiB0LmRlY2ltYWxzZXBhcmF0b3JhcmFiaWMgPSAweDA2NmI7CiB0LmRlY2ltYWxzZXBhcmF0b3JwZXJzaWFuID0gMHgwNjZiOwogdC5kZWN5cmlsbGljID0gMHgwNDM0OwogdC5kZWdyZWUgPSAweDAwYjA7CiB0LmRlaGloZWJyZXcgPSAweDA1YWQ7CiB0LmRlaGlyYWdhbmEgPSAweDMwNjc7CiB0LmRlaWNvcHRpYyA9IDB4MDNlZjsKIHQuZGVrYXRha2FuYSA9IDB4MzBjNzsKIHQuZGVsZXRlbGVmdCA9IDB4MjMyYjsKIHQuZGVsZXRlcmlnaHQgPSAweDIzMjY7CiB0LmRlbHRhID0gMHgwM2I0OwogdC5kZWx0YXR1cm5lZCA9IDB4MDE4ZDsKIHQuZGVub21pbmF0b3JtaW51c29uZW51bWVyYXRvcmJlbmdhbGkgPSAweDA5Zjg7CiB0LmRlemggPSAweDAyYTQ7CiB0LmRoYWJlbmdhbGkgPSAweDA5YTc7CiB0LmRoYWRldmEgPSAweDA5Mjc7CiB0LmRoYWd1amFyYXRpID0gMHgwYWE3OwogdC5kaGFndXJtdWtoaSA9IDB4MGEyNzsKIHQuZGhvb2sgPSAweDAyNTc7CiB0LmRpYWx5dGlrYXRvbm9zID0gMHgwMzg1OwogdC5kaWFseXRpa2F0b25vc2NtYiA9IDB4MDM0NDsKIHQuZGlhbW9uZCA9IDB4MjY2NjsKIHQuZGlhbW9uZHN1aXR3aGl0ZSA9IDB4MjY2MjsKIHQuZGllcmVzaXMgPSAweDAwYTg7CiB0LmRpZXJlc2lzYWN1dGUgPSAweGY2ZDc7CiB0LmRpZXJlc2lzYmVsb3djbWIgPSAweDAzMjQ7CiB0LmRpZXJlc2lzY21iID0gMHgwMzA4OwogdC5kaWVyZXNpc2dyYXZlID0gMHhmNmQ4OwogdC5kaWVyZXNpc3Rvbm9zID0gMHgwMzg1OwogdC5kaWhpcmFnYW5hID0gMHgzMDYyOwogdC5kaWthdGFrYW5hID0gMHgzMGMyOwogdC5kaXR0b21hcmsgPSAweDMwMDM7CiB0LmRpdmlkZSA9IDB4MDBmNzsKIHQuZGl2aWRlcyA9IDB4MjIyMzsKIHQuZGl2aXNpb25zbGFzaCA9IDB4MjIxNTsKIHQuZGplY3lyaWxsaWMgPSAweDA0NTI7CiB0LmRrc2hhZGUgPSAweDI1OTM7CiB0LmRsaW5lYmVsb3cgPSAweDFlMGY7CiB0LmRsc3F1YXJlID0gMHgzMzk3OwogdC5kbWFjcm9uID0gMHgwMTExOwogdC5kbW9ub3NwYWNlID0gMHhmZjQ0OwogdC5kbmJsb2NrID0gMHgyNTg0OwogdC5kb2NoYWRhdGhhaSA9IDB4MGUwZTsKIHQuZG9kZWt0aGFpID0gMHgwZTE0OwogdC5kb2hpcmFnYW5hID0gMHgzMDY5OwogdC5kb2thdGFrYW5hID0gMHgzMGM5OwogdC5kb2xsYXIgPSAweDAwMjQ7CiB0LmRvbGxhcmluZmVyaW9yID0gMHhmNmUzOwogdC5kb2xsYXJtb25vc3BhY2UgPSAweGZmMDQ7CiB0LmRvbGxhcm9sZHN0eWxlID0gMHhmNzI0OwogdC5kb2xsYXJzbWFsbCA9IDB4ZmU2OTsKIHQuZG9sbGFyc3VwZXJpb3IgPSAweGY2ZTQ7CiB0LmRvbmcgPSAweDIwYWI7CiB0LmRvcnVzcXVhcmUgPSAweDMzMjY7CiB0LmRvdGFjY2VudCA9IDB4MDJkOTsKIHQuZG90YWNjZW50Y21iID0gMHgwMzA3OwogdC5kb3RiZWxvd2NtYiA9IDB4MDMyMzsKIHQuZG90YmVsb3djb21iID0gMHgwMzIzOwogdC5kb3RrYXRha2FuYSA9IDB4MzBmYjsKIHQuZG90bGVzc2kgPSAweDAxMzE7CiB0LmRvdGxlc3NqID0gMHhmNmJlOwogdC5kb3RsZXNzanN0cm9rZWhvb2sgPSAweDAyODQ7CiB0LmRvdG1hdGggPSAweDIyYzU7CiB0LmRvdHRlZGNpcmNsZSA9IDB4MjVjYzsKIHQuZG91YmxleW9kcGF0YWggPSAweGZiMWY7CiB0LmRvdWJsZXlvZHBhdGFoaGVicmV3ID0gMHhmYjFmOwogdC5kb3dudGFja2JlbG93Y21iID0gMHgwMzFlOwogdC5kb3dudGFja21vZCA9IDB4MDJkNTsKIHQuZHBhcmVuID0gMHgyNDlmOwogdC5kc3VwZXJpb3IgPSAweGY2ZWI7CiB0LmR0YWlsID0gMHgwMjU2OwogdC5kdG9wYmFyID0gMHgwMThjOwogdC5kdWhpcmFnYW5hID0gMHgzMDY1OwogdC5kdWthdGFrYW5hID0gMHgzMGM1OwogdC5keiA9IDB4MDFmMzsKIHQuZHphbHRvbmUgPSAweDAyYTM7CiB0LmR6Y2Fyb24gPSAweDAxYzY7CiB0LmR6Y3VybCA9IDB4MDJhNTsKIHQuZHplYWJraGFzaWFuY3lyaWxsaWMgPSAweDA0ZTE7CiB0LmR6ZWN5cmlsbGljID0gMHgwNDU1OwogdC5kemhlY3lyaWxsaWMgPSAweDA0NWY7CiB0LmUgPSAweDAwNjU7CiB0LmVhY3V0ZSA9IDB4MDBlOTsKIHQuZWFydGggPSAweDI2NDE7CiB0LmViZW5nYWxpID0gMHgwOThmOwogdC5lYm9wb21vZm8gPSAweDMxMWM7CiB0LmVicmV2ZSA9IDB4MDExNTsKIHQuZWNhbmRyYWRldmEgPSAweDA5MGQ7CiB0LmVjYW5kcmFndWphcmF0aSA9IDB4MGE4ZDsKIHQuZWNhbmRyYXZvd2Vsc2lnbmRldmEgPSAweDA5NDU7CiB0LmVjYW5kcmF2b3dlbHNpZ25ndWphcmF0aSA9IDB4MGFjNTsKIHQuZWNhcm9uID0gMHgwMTFiOwogdC5lY2VkaWxsYWJyZXZlID0gMHgxZTFkOwogdC5lY2hhcm1lbmlhbiA9IDB4MDU2NTsKIHQuZWNoeWl3bmFybWVuaWFuID0gMHgwNTg3OwogdC5lY2lyY2xlID0gMHgyNGQ0OwogdC5lY2lyY3VtZmxleCA9IDB4MDBlYTsKIHQuZWNpcmN1bWZsZXhhY3V0ZSA9IDB4MWViZjsKIHQuZWNpcmN1bWZsZXhiZWxvdyA9IDB4MWUxOTsKIHQuZWNpcmN1bWZsZXhkb3RiZWxvdyA9IDB4MWVjNzsKIHQuZWNpcmN1bWZsZXhncmF2ZSA9IDB4MWVjMTsKIHQuZWNpcmN1bWZsZXhob29rYWJvdmUgPSAweDFlYzM7CiB0LmVjaXJjdW1mbGV4dGlsZGUgPSAweDFlYzU7CiB0LmVjeXJpbGxpYyA9IDB4MDQ1NDsKIHQuZWRibGdyYXZlID0gMHgwMjA1OwogdC5lZGV2YSA9IDB4MDkwZjsKIHQuZWRpZXJlc2lzID0gMHgwMGViOwogdC5lZG90ID0gMHgwMTE3OwogdC5lZG90YWNjZW50ID0gMHgwMTE3OwogdC5lZG90YmVsb3cgPSAweDFlYjk7CiB0LmVlZ3VybXVraGkgPSAweDBhMGY7CiB0LmVlbWF0cmFndXJtdWtoaSA9IDB4MGE0NzsKIHQuZWZjeXJpbGxpYyA9IDB4MDQ0NDsKIHQuZWdyYXZlID0gMHgwMGU4OwogdC5lZ3VqYXJhdGkgPSAweDBhOGY7CiB0LmVoYXJtZW5pYW4gPSAweDA1Njc7CiB0LmVoYm9wb21vZm8gPSAweDMxMWQ7CiB0LmVoaXJhZ2FuYSA9IDB4MzA0ODsKIHQuZWhvb2thYm92ZSA9IDB4MWViYjsKIHQuZWlib3BvbW9mbyA9IDB4MzExZjsKIHQuZWlnaHQgPSAweDAwMzg7CiB0LmVpZ2h0YXJhYmljID0gMHgwNjY4OwogdC5laWdodGJlbmdhbGkgPSAweDA5ZWU7CiB0LmVpZ2h0Y2lyY2xlID0gMHgyNDY3OwogdC5laWdodGNpcmNsZWludmVyc2VzYW5zc2VyaWYgPSAweDI3OTE7CiB0LmVpZ2h0ZGV2YSA9IDB4MDk2ZTsKIHQuZWlnaHRlZW5jaXJjbGUgPSAweDI0NzE7CiB0LmVpZ2h0ZWVucGFyZW4gPSAweDI0ODU7CiB0LmVpZ2h0ZWVucGVyaW9kID0gMHgyNDk5OwogdC5laWdodGd1amFyYXRpID0gMHgwYWVlOwogdC5laWdodGd1cm11a2hpID0gMHgwYTZlOwogdC5laWdodGhhY2thcmFiaWMgPSAweDA2Njg7CiB0LmVpZ2h0aGFuZ3pob3UgPSAweDMwMjg7CiB0LmVpZ2h0aG5vdGViZWFtZWQgPSAweDI2NmI7CiB0LmVpZ2h0aWRlb2dyYXBoaWNwYXJlbiA9IDB4MzIyNzsKIHQuZWlnaHRpbmZlcmlvciA9IDB4MjA4ODsKIHQuZWlnaHRtb25vc3BhY2UgPSAweGZmMTg7CiB0LmVpZ2h0b2xkc3R5bGUgPSAweGY3Mzg7CiB0LmVpZ2h0cGFyZW4gPSAweDI0N2I7CiB0LmVpZ2h0cGVyaW9kID0gMHgyNDhmOwogdC5laWdodHBlcnNpYW4gPSAweDA2Zjg7CiB0LmVpZ2h0cm9tYW4gPSAweDIxNzc7CiB0LmVpZ2h0c3VwZXJpb3IgPSAweDIwNzg7CiB0LmVpZ2h0dGhhaSA9IDB4MGU1ODsKIHQuZWludmVydGVkYnJldmUgPSAweDAyMDc7CiB0LmVpb3RpZmllZGN5cmlsbGljID0gMHgwNDY1OwogdC5la2F0YWthbmEgPSAweDMwYTg7CiB0LmVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY3NDsKIHQuZWtvbmthcmd1cm11a2hpID0gMHgwYTc0OwogdC5la29yZWFuID0gMHgzMTU0OwogdC5lbGN5cmlsbGljID0gMHgwNDNiOwogdC5lbGVtZW50ID0gMHgyMjA4OwogdC5lbGV2ZW5jaXJjbGUgPSAweDI0NmE7CiB0LmVsZXZlbnBhcmVuID0gMHgyNDdlOwogdC5lbGV2ZW5wZXJpb2QgPSAweDI0OTI7CiB0LmVsZXZlbnJvbWFuID0gMHgyMTdhOwogdC5lbGxpcHNpcyA9IDB4MjAyNjsKIHQuZWxsaXBzaXN2ZXJ0aWNhbCA9IDB4MjJlZTsKIHQuZW1hY3JvbiA9IDB4MDExMzsKIHQuZW1hY3JvbmFjdXRlID0gMHgxZTE3OwogdC5lbWFjcm9uZ3JhdmUgPSAweDFlMTU7CiB0LmVtY3lyaWxsaWMgPSAweDA0M2M7CiB0LmVtZGFzaCA9IDB4MjAxNDsKIHQuZW1kYXNodmVydGljYWwgPSAweGZlMzE7CiB0LmVtb25vc3BhY2UgPSAweGZmNDU7CiB0LmVtcGhhc2lzbWFya2FybWVuaWFuID0gMHgwNTViOwogdC5lbXB0eXNldCA9IDB4MjIwNTsKIHQuZW5ib3BvbW9mbyA9IDB4MzEyMzsKIHQuZW5jeXJpbGxpYyA9IDB4MDQzZDsKIHQuZW5kYXNoID0gMHgyMDEzOwogdC5lbmRhc2h2ZXJ0aWNhbCA9IDB4ZmUzMjsKIHQuZW5kZXNjZW5kZXJjeXJpbGxpYyA9IDB4MDRhMzsKIHQuZW5nID0gMHgwMTRiOwogdC5lbmdib3BvbW9mbyA9IDB4MzEyNTsKIHQuZW5naGVjeXJpbGxpYyA9IDB4MDRhNTsKIHQuZW5ob29rY3lyaWxsaWMgPSAweDA0Yzg7CiB0LmVuc3BhY2UgPSAweDIwMDI7CiB0LmVvZ29uZWsgPSAweDAxMTk7CiB0LmVva29yZWFuID0gMHgzMTUzOwogdC5lb3BlbiA9IDB4MDI1YjsKIHQuZW9wZW5jbG9zZWQgPSAweDAyOWE7CiB0LmVvcGVucmV2ZXJzZWQgPSAweDAyNWM7CiB0LmVvcGVucmV2ZXJzZWRjbG9zZWQgPSAweDAyNWU7CiB0LmVvcGVucmV2ZXJzZWRob29rID0gMHgwMjVkOwogdC5lcGFyZW4gPSAweDI0YTA7CiB0LmVwc2lsb24gPSAweDAzYjU7CiB0LmVwc2lsb250b25vcyA9IDB4MDNhZDsKIHQuZXF1YWwgPSAweDAwM2Q7CiB0LmVxdWFsbW9ub3NwYWNlID0gMHhmZjFkOwogdC5lcXVhbHNtYWxsID0gMHhmZTY2OwogdC5lcXVhbHN1cGVyaW9yID0gMHgyMDdjOwogdC5lcXVpdmFsZW5jZSA9IDB4MjI2MTsKIHQuZXJib3BvbW9mbyA9IDB4MzEyNjsKIHQuZXJjeXJpbGxpYyA9IDB4MDQ0MDsKIHQuZXJldmVyc2VkID0gMHgwMjU4OwogdC5lcmV2ZXJzZWRjeXJpbGxpYyA9IDB4MDQ0ZDsKIHQuZXNjeXJpbGxpYyA9IDB4MDQ0MTsKIHQuZXNkZXNjZW5kZXJjeXJpbGxpYyA9IDB4MDRhYjsKIHQuZXNoID0gMHgwMjgzOwogdC5lc2hjdXJsID0gMHgwMjg2OwogdC5lc2hvcnRkZXZhID0gMHgwOTBlOwogdC5lc2hvcnR2b3dlbHNpZ25kZXZhID0gMHgwOTQ2OwogdC5lc2hyZXZlcnNlZGxvb3AgPSAweDAxYWE7CiB0LmVzaHNxdWF0cmV2ZXJzZWQgPSAweDAyODU7CiB0LmVzbWFsbGhpcmFnYW5hID0gMHgzMDQ3OwogdC5lc21hbGxrYXRha2FuYSA9IDB4MzBhNzsKIHQuZXNtYWxsa2F0YWthbmFoYWxmd2lkdGggPSAweGZmNmE7CiB0LmVzdGltYXRlZCA9IDB4MjEyZTsKIHQuZXN1cGVyaW9yID0gMHhmNmVjOwogdC5ldGEgPSAweDAzYjc7CiB0LmV0YXJtZW5pYW4gPSAweDA1Njg7CiB0LmV0YXRvbm9zID0gMHgwM2FlOwogdC5ldGggPSAweDAwZjA7CiB0LmV0aWxkZSA9IDB4MWViZDsKIHQuZXRpbGRlYmVsb3cgPSAweDFlMWI7CiB0LmV0bmFodGFmb3VraGhlYnJldyA9IDB4MDU5MTsKIHQuZXRuYWh0YWZvdWtobGVmdGhlYnJldyA9IDB4MDU5MTsKIHQuZXRuYWh0YWhlYnJldyA9IDB4MDU5MTsKIHQuZXRuYWh0YWxlZnRoZWJyZXcgPSAweDA1OTE7CiB0LmV0dXJuZWQgPSAweDAxZGQ7CiB0LmV1a29yZWFuID0gMHgzMTYxOwogdC5ldXJvID0gMHgyMGFjOwogdC5ldm93ZWxzaWduYmVuZ2FsaSA9IDB4MDljNzsKIHQuZXZvd2Vsc2lnbmRldmEgPSAweDA5NDc7CiB0LmV2b3dlbHNpZ25ndWphcmF0aSA9IDB4MGFjNzsKIHQuZXhjbGFtID0gMHgwMDIxOwogdC5leGNsYW1hcm1lbmlhbiA9IDB4MDU1YzsKIHQuZXhjbGFtZGJsID0gMHgyMDNjOwogdC5leGNsYW1kb3duID0gMHgwMGExOwogdC5leGNsYW1kb3duc21hbGwgPSAweGY3YTE7CiB0LmV4Y2xhbW1vbm9zcGFjZSA9IDB4ZmYwMTsKIHQuZXhjbGFtc21hbGwgPSAweGY3MjE7CiB0LmV4aXN0ZW50aWFsID0gMHgyMjAzOwogdC5lemggPSAweDAyOTI7CiB0LmV6aGNhcm9uID0gMHgwMWVmOwogdC5lemhjdXJsID0gMHgwMjkzOwogdC5lemhyZXZlcnNlZCA9IDB4MDFiOTsKIHQuZXpodGFpbCA9IDB4MDFiYTsKIHQuZiA9IDB4MDA2NjsKIHQuZmFkZXZhID0gMHgwOTVlOwogdC5mYWd1cm11a2hpID0gMHgwYTVlOwogdC5mYWhyZW5oZWl0ID0gMHgyMTA5OwogdC5mYXRoYWFyYWJpYyA9IDB4MDY0ZTsKIHQuZmF0aGFsb3dhcmFiaWMgPSAweDA2NGU7CiB0LmZhdGhhdGFuYXJhYmljID0gMHgwNjRiOwogdC5mYm9wb21vZm8gPSAweDMxMDg7CiB0LmZjaXJjbGUgPSAweDI0ZDU7CiB0LmZkb3RhY2NlbnQgPSAweDFlMWY7CiB0LmZlaGFyYWJpYyA9IDB4MDY0MTsKIHQuZmVoYXJtZW5pYW4gPSAweDA1ODY7CiB0LmZlaGZpbmFsYXJhYmljID0gMHhmZWQyOwogdC5mZWhpbml0aWFsYXJhYmljID0gMHhmZWQzOwogdC5mZWhtZWRpYWxhcmFiaWMgPSAweGZlZDQ7CiB0LmZlaWNvcHRpYyA9IDB4MDNlNTsKIHQuZmVtYWxlID0gMHgyNjQwOwogdC5mZiA9IDB4ZmIwMDsKIHQuZl9mID0gMHhmYjAwOwogdC5mZmkgPSAweGZiMDM7CiB0LmZmbCA9IDB4ZmIwNDsKIHQuZmkgPSAweGZiMDE7CiB0LmZpZnRlZW5jaXJjbGUgPSAweDI0NmU7CiB0LmZpZnRlZW5wYXJlbiA9IDB4MjQ4MjsKIHQuZmlmdGVlbnBlcmlvZCA9IDB4MjQ5NjsKIHQuZmlndXJlZGFzaCA9IDB4MjAxMjsKIHQuZmlsbGVkYm94ID0gMHgyNWEwOwogdC5maWxsZWRyZWN0ID0gMHgyNWFjOwogdC5maW5hbGthZiA9IDB4MDVkYTsKIHQuZmluYWxrYWZkYWdlc2ggPSAweGZiM2E7CiB0LmZpbmFsa2FmZGFnZXNoaGVicmV3ID0gMHhmYjNhOwogdC5maW5hbGthZmhlYnJldyA9IDB4MDVkYTsKIHQuZmluYWxtZW0gPSAweDA1ZGQ7CiB0LmZpbmFsbWVtaGVicmV3ID0gMHgwNWRkOwogdC5maW5hbG51biA9IDB4MDVkZjsKIHQuZmluYWxudW5oZWJyZXcgPSAweDA1ZGY7CiB0LmZpbmFscGUgPSAweDA1ZTM7CiB0LmZpbmFscGVoZWJyZXcgPSAweDA1ZTM7CiB0LmZpbmFsdHNhZGkgPSAweDA1ZTU7CiB0LmZpbmFsdHNhZGloZWJyZXcgPSAweDA1ZTU7CiB0LmZpcnN0dG9uZWNoaW5lc2UgPSAweDAyYzk7CiB0LmZpc2hleWUgPSAweDI1Yzk7CiB0LmZpdGFjeXJpbGxpYyA9IDB4MDQ3MzsKIHQuZml2ZSA9IDB4MDAzNTsKIHQuZml2ZWFyYWJpYyA9IDB4MDY2NTsKIHQuZml2ZWJlbmdhbGkgPSAweDA5ZWI7CiB0LmZpdmVjaXJjbGUgPSAweDI0NjQ7CiB0LmZpdmVjaXJjbGVpbnZlcnNlc2Fuc3NlcmlmID0gMHgyNzhlOwogdC5maXZlZGV2YSA9IDB4MDk2YjsKIHQuZml2ZWVpZ2h0aHMgPSAweDIxNWQ7CiB0LmZpdmVndWphcmF0aSA9IDB4MGFlYjsKIHQuZml2ZWd1cm11a2hpID0gMHgwYTZiOwogdC5maXZlaGFja2FyYWJpYyA9IDB4MDY2NTsKIHQuZml2ZWhhbmd6aG91ID0gMHgzMDI1OwogdC5maXZlaWRlb2dyYXBoaWNwYXJlbiA9IDB4MzIyNDsKIHQuZml2ZWluZmVyaW9yID0gMHgyMDg1OwogdC5maXZlbW9ub3NwYWNlID0gMHhmZjE1OwogdC5maXZlb2xkc3R5bGUgPSAweGY3MzU7CiB0LmZpdmVwYXJlbiA9IDB4MjQ3ODsKIHQuZml2ZXBlcmlvZCA9IDB4MjQ4YzsKIHQuZml2ZXBlcnNpYW4gPSAweDA2ZjU7CiB0LmZpdmVyb21hbiA9IDB4MjE3NDsKIHQuZml2ZXN1cGVyaW9yID0gMHgyMDc1OwogdC5maXZldGhhaSA9IDB4MGU1NTsKIHQuZmwgPSAweGZiMDI7CiB0LmZsb3JpbiA9IDB4MDE5MjsKIHQuZm1vbm9zcGFjZSA9IDB4ZmY0NjsKIHQuZm1zcXVhcmUgPSAweDMzOTk7CiB0LmZvZmFudGhhaSA9IDB4MGUxZjsKIHQuZm9mYXRoYWkgPSAweDBlMWQ7CiB0LmZvbmdtYW50aGFpID0gMHgwZTRmOwogdC5mb3JhbGwgPSAweDIyMDA7CiB0LmZvdXIgPSAweDAwMzQ7CiB0LmZvdXJhcmFiaWMgPSAweDA2NjQ7CiB0LmZvdXJiZW5nYWxpID0gMHgwOWVhOwogdC5mb3VyY2lyY2xlID0gMHgyNDYzOwogdC5mb3VyY2lyY2xlaW52ZXJzZXNhbnNzZXJpZiA9IDB4Mjc4ZDsKIHQuZm91cmRldmEgPSAweDA5NmE7CiB0LmZvdXJndWphcmF0aSA9IDB4MGFlYTsKIHQuZm91cmd1cm11a2hpID0gMHgwYTZhOwogdC5mb3VyaGFja2FyYWJpYyA9IDB4MDY2NDsKIHQuZm91cmhhbmd6aG91ID0gMHgzMDI0OwogdC5mb3VyaWRlb2dyYXBoaWNwYXJlbiA9IDB4MzIyMzsKIHQuZm91cmluZmVyaW9yID0gMHgyMDg0OwogdC5mb3VybW9ub3NwYWNlID0gMHhmZjE0OwogdC5mb3VybnVtZXJhdG9yYmVuZ2FsaSA9IDB4MDlmNzsKIHQuZm91cm9sZHN0eWxlID0gMHhmNzM0OwogdC5mb3VycGFyZW4gPSAweDI0Nzc7CiB0LmZvdXJwZXJpb2QgPSAweDI0OGI7CiB0LmZvdXJwZXJzaWFuID0gMHgwNmY0OwogdC5mb3Vycm9tYW4gPSAweDIxNzM7CiB0LmZvdXJzdXBlcmlvciA9IDB4MjA3NDsKIHQuZm91cnRlZW5jaXJjbGUgPSAweDI0NmQ7CiB0LmZvdXJ0ZWVucGFyZW4gPSAweDI0ODE7CiB0LmZvdXJ0ZWVucGVyaW9kID0gMHgyNDk1OwogdC5mb3VydGhhaSA9IDB4MGU1NDsKIHQuZm91cnRodG9uZWNoaW5lc2UgPSAweDAyY2I7CiB0LmZwYXJlbiA9IDB4MjRhMTsKIHQuZnJhY3Rpb24gPSAweDIwNDQ7CiB0LmZyYW5jID0gMHgyMGEzOwogdC5nID0gMHgwMDY3OwogdC5nYWJlbmdhbGkgPSAweDA5OTc7CiB0LmdhY3V0ZSA9IDB4MDFmNTsKIHQuZ2FkZXZhID0gMHgwOTE3OwogdC5nYWZhcmFiaWMgPSAweDA2YWY7CiB0LmdhZmZpbmFsYXJhYmljID0gMHhmYjkzOwogdC5nYWZpbml0aWFsYXJhYmljID0gMHhmYjk0OwogdC5nYWZtZWRpYWxhcmFiaWMgPSAweGZiOTU7CiB0LmdhZ3VqYXJhdGkgPSAweDBhOTc7CiB0LmdhZ3VybXVraGkgPSAweDBhMTc7CiB0LmdhaGlyYWdhbmEgPSAweDMwNGM7CiB0Lmdha2F0YWthbmEgPSAweDMwYWM7CiB0LmdhbW1hID0gMHgwM2IzOwogdC5nYW1tYWxhdGluc21hbGwgPSAweDAyNjM7CiB0LmdhbW1hc3VwZXJpb3IgPSAweDAyZTA7CiB0LmdhbmdpYWNvcHRpYyA9IDB4MDNlYjsKIHQuZ2JvcG9tb2ZvID0gMHgzMTBkOwogdC5nYnJldmUgPSAweDAxMWY7CiB0LmdjYXJvbiA9IDB4MDFlNzsKIHQuZ2NlZGlsbGEgPSAweDAxMjM7CiB0LmdjaXJjbGUgPSAweDI0ZDY7CiB0LmdjaXJjdW1mbGV4ID0gMHgwMTFkOwogdC5nY29tbWFhY2NlbnQgPSAweDAxMjM7CiB0Lmdkb3QgPSAweDAxMjE7CiB0Lmdkb3RhY2NlbnQgPSAweDAxMjE7CiB0LmdlY3lyaWxsaWMgPSAweDA0MzM7CiB0LmdlaGlyYWdhbmEgPSAweDMwNTI7CiB0Lmdla2F0YWthbmEgPSAweDMwYjI7CiB0Lmdlb21ldHJpY2FsbHllcXVhbCA9IDB4MjI1MTsKIHQuZ2VyZXNoYWNjZW50aGVicmV3ID0gMHgwNTljOwogdC5nZXJlc2hoZWJyZXcgPSAweDA1ZjM7CiB0LmdlcmVzaG11cWRhbWhlYnJldyA9IDB4MDU5ZDsKIHQuZ2VybWFuZGJscyA9IDB4MDBkZjsKIHQuZ2Vyc2hheWltYWNjZW50aGVicmV3ID0gMHgwNTllOwogdC5nZXJzaGF5aW1oZWJyZXcgPSAweDA1ZjQ7CiB0LmdldGFtYXJrID0gMHgzMDEzOwogdC5naGFiZW5nYWxpID0gMHgwOTk4OwogdC5naGFkYXJtZW5pYW4gPSAweDA1NzI7CiB0LmdoYWRldmEgPSAweDA5MTg7CiB0LmdoYWd1amFyYXRpID0gMHgwYTk4OwogdC5naGFndXJtdWtoaSA9IDB4MGExODsKIHQuZ2hhaW5hcmFiaWMgPSAweDA2M2E7CiB0LmdoYWluZmluYWxhcmFiaWMgPSAweGZlY2U7CiB0LmdoYWluaW5pdGlhbGFyYWJpYyA9IDB4ZmVjZjsKIHQuZ2hhaW5tZWRpYWxhcmFiaWMgPSAweGZlZDA7CiB0LmdoZW1pZGRsZWhvb2tjeXJpbGxpYyA9IDB4MDQ5NTsKIHQuZ2hlc3Ryb2tlY3lyaWxsaWMgPSAweDA0OTM7CiB0LmdoZXVwdHVybmN5cmlsbGljID0gMHgwNDkxOwogdC5naGhhZGV2YSA9IDB4MDk1YTsKIHQuZ2hoYWd1cm11a2hpID0gMHgwYTVhOwogdC5naG9vayA9IDB4MDI2MDsKIHQuZ2h6c3F1YXJlID0gMHgzMzkzOwogdC5naWhpcmFnYW5hID0gMHgzMDRlOwogdC5naWthdGFrYW5hID0gMHgzMGFlOwogdC5naW1hcm1lbmlhbiA9IDB4MDU2MzsKIHQuZ2ltZWwgPSAweDA1ZDI7CiB0LmdpbWVsZGFnZXNoID0gMHhmYjMyOwogdC5naW1lbGRhZ2VzaGhlYnJldyA9IDB4ZmIzMjsKIHQuZ2ltZWxoZWJyZXcgPSAweDA1ZDI7CiB0LmdqZWN5cmlsbGljID0gMHgwNDUzOwogdC5nbG90dGFsaW52ZXJ0ZWRzdHJva2UgPSAweDAxYmU7CiB0Lmdsb3R0YWxzdG9wID0gMHgwMjk0OwogdC5nbG90dGFsc3RvcGludmVydGVkID0gMHgwMjk2OwogdC5nbG90dGFsc3RvcG1vZCA9IDB4MDJjMDsKIHQuZ2xvdHRhbHN0b3ByZXZlcnNlZCA9IDB4MDI5NTsKIHQuZ2xvdHRhbHN0b3ByZXZlcnNlZG1vZCA9IDB4MDJjMTsKIHQuZ2xvdHRhbHN0b3ByZXZlcnNlZHN1cGVyaW9yID0gMHgwMmU0OwogdC5nbG90dGFsc3RvcHN0cm9rZSA9IDB4MDJhMTsKIHQuZ2xvdHRhbHN0b3BzdHJva2VyZXZlcnNlZCA9IDB4MDJhMjsKIHQuZ21hY3JvbiA9IDB4MWUyMTsKIHQuZ21vbm9zcGFjZSA9IDB4ZmY0NzsKIHQuZ29oaXJhZ2FuYSA9IDB4MzA1NDsKIHQuZ29rYXRha2FuYSA9IDB4MzBiNDsKIHQuZ3BhcmVuID0gMHgyNGEyOwogdC5ncGFzcXVhcmUgPSAweDMzYWM7CiB0LmdyYWRpZW50ID0gMHgyMjA3OwogdC5ncmF2ZSA9IDB4MDA2MDsKIHQuZ3JhdmViZWxvd2NtYiA9IDB4MDMxNjsKIHQuZ3JhdmVjbWIgPSAweDAzMDA7CiB0LmdyYXZlY29tYiA9IDB4MDMwMDsKIHQuZ3JhdmVkZXZhID0gMHgwOTUzOwogdC5ncmF2ZWxvd21vZCA9IDB4MDJjZTsKIHQuZ3JhdmVtb25vc3BhY2UgPSAweGZmNDA7CiB0LmdyYXZldG9uZWNtYiA9IDB4MDM0MDsKIHQuZ3JlYXRlciA9IDB4MDAzZTsKIHQuZ3JlYXRlcmVxdWFsID0gMHgyMjY1OwogdC5ncmVhdGVyZXF1YWxvcmxlc3MgPSAweDIyZGI7CiB0LmdyZWF0ZXJtb25vc3BhY2UgPSAweGZmMWU7CiB0LmdyZWF0ZXJvcmVxdWl2YWxlbnQgPSAweDIyNzM7CiB0LmdyZWF0ZXJvcmxlc3MgPSAweDIyNzc7CiB0LmdyZWF0ZXJvdmVyZXF1YWwgPSAweDIyNjc7CiB0LmdyZWF0ZXJzbWFsbCA9IDB4ZmU2NTsKIHQuZ3NjcmlwdCA9IDB4MDI2MTsKIHQuZ3N0cm9rZSA9IDB4MDFlNTsKIHQuZ3VoaXJhZ2FuYSA9IDB4MzA1MDsKIHQuZ3VpbGxlbW90bGVmdCA9IDB4MDBhYjsKIHQuZ3VpbGxlbW90cmlnaHQgPSAweDAwYmI7CiB0Lmd1aWxzaW5nbGxlZnQgPSAweDIwMzk7CiB0Lmd1aWxzaW5nbHJpZ2h0ID0gMHgyMDNhOwogdC5ndWthdGFrYW5hID0gMHgzMGIwOwogdC5ndXJhbXVzcXVhcmUgPSAweDMzMTg7CiB0Lmd5c3F1YXJlID0gMHgzM2M5OwogdC5oID0gMHgwMDY4OwogdC5oYWFia2hhc2lhbmN5cmlsbGljID0gMHgwNGE5OwogdC5oYWFsdG9uZWFyYWJpYyA9IDB4MDZjMTsKIHQuaGFiZW5nYWxpID0gMHgwOWI5OwogdC5oYWRlc2NlbmRlcmN5cmlsbGljID0gMHgwNGIzOwogdC5oYWRldmEgPSAweDA5Mzk7CiB0LmhhZ3VqYXJhdGkgPSAweDBhYjk7CiB0LmhhZ3VybXVraGkgPSAweDBhMzk7CiB0LmhhaGFyYWJpYyA9IDB4MDYyZDsKIHQuaGFoZmluYWxhcmFiaWMgPSAweGZlYTI7CiB0LmhhaGluaXRpYWxhcmFiaWMgPSAweGZlYTM7CiB0LmhhaGlyYWdhbmEgPSAweDMwNmY7CiB0LmhhaG1lZGlhbGFyYWJpYyA9IDB4ZmVhNDsKIHQuaGFpdHVzcXVhcmUgPSAweDMzMmE7CiB0Lmhha2F0YWthbmEgPSAweDMwY2Y7CiB0Lmhha2F0YWthbmFoYWxmd2lkdGggPSAweGZmOGE7CiB0LmhhbGFudGd1cm11a2hpID0gMHgwYTRkOwogdC5oYW16YWFyYWJpYyA9IDB4MDYyMTsKIHQuaGFtemFsb3dhcmFiaWMgPSAweDA2MjE7CiB0Lmhhbmd1bGZpbGxlciA9IDB4MzE2NDsKIHQuaGFyZHNpZ25jeXJpbGxpYyA9IDB4MDQ0YTsKIHQuaGFycG9vbmxlZnRiYXJidXAgPSAweDIxYmM7CiB0LmhhcnBvb25yaWdodGJhcmJ1cCA9IDB4MjFjMDsKIHQuaGFzcXVhcmUgPSAweDMzY2E7CiB0LmhhdGFmcGF0YWggPSAweDA1YjI7CiB0LmhhdGFmcGF0YWgxNiA9IDB4MDViMjsKIHQuaGF0YWZwYXRhaDIzID0gMHgwNWIyOwogdC5oYXRhZnBhdGFoMmYgPSAweDA1YjI7CiB0LmhhdGFmcGF0YWhoZWJyZXcgPSAweDA1YjI7CiB0LmhhdGFmcGF0YWhuYXJyb3doZWJyZXcgPSAweDA1YjI7CiB0LmhhdGFmcGF0YWhxdWFydGVyaGVicmV3ID0gMHgwNWIyOwogdC5oYXRhZnBhdGFod2lkZWhlYnJldyA9IDB4MDViMjsKIHQuaGF0YWZxYW1hdHMgPSAweDA1YjM7CiB0LmhhdGFmcWFtYXRzMWIgPSAweDA1YjM7CiB0LmhhdGFmcWFtYXRzMjggPSAweDA1YjM7CiB0LmhhdGFmcWFtYXRzMzQgPSAweDA1YjM7CiB0LmhhdGFmcWFtYXRzaGVicmV3ID0gMHgwNWIzOwogdC5oYXRhZnFhbWF0c25hcnJvd2hlYnJldyA9IDB4MDViMzsKIHQuaGF0YWZxYW1hdHNxdWFydGVyaGVicmV3ID0gMHgwNWIzOwogdC5oYXRhZnFhbWF0c3dpZGVoZWJyZXcgPSAweDA1YjM7CiB0LmhhdGFmc2Vnb2wgPSAweDA1YjE7CiB0LmhhdGFmc2Vnb2wxNyA9IDB4MDViMTsKIHQuaGF0YWZzZWdvbDI0ID0gMHgwNWIxOwogdC5oYXRhZnNlZ29sMzAgPSAweDA1YjE7CiB0LmhhdGFmc2Vnb2xoZWJyZXcgPSAweDA1YjE7CiB0LmhhdGFmc2Vnb2xuYXJyb3doZWJyZXcgPSAweDA1YjE7CiB0LmhhdGFmc2Vnb2xxdWFydGVyaGVicmV3ID0gMHgwNWIxOwogdC5oYXRhZnNlZ29sd2lkZWhlYnJldyA9IDB4MDViMTsKIHQuaGJhciA9IDB4MDEyNzsKIHQuaGJvcG9tb2ZvID0gMHgzMTBmOwogdC5oYnJldmViZWxvdyA9IDB4MWUyYjsKIHQuaGNlZGlsbGEgPSAweDFlMjk7CiB0LmhjaXJjbGUgPSAweDI0ZDc7CiB0LmhjaXJjdW1mbGV4ID0gMHgwMTI1OwogdC5oZGllcmVzaXMgPSAweDFlMjc7CiB0Lmhkb3RhY2NlbnQgPSAweDFlMjM7CiB0Lmhkb3RiZWxvdyA9IDB4MWUyNTsKIHQuaGUgPSAweDA1ZDQ7CiB0LmhlYXJ0ID0gMHgyNjY1OwogdC5oZWFydHN1aXRibGFjayA9IDB4MjY2NTsKIHQuaGVhcnRzdWl0d2hpdGUgPSAweDI2NjE7CiB0LmhlZGFnZXNoID0gMHhmYjM0OwogdC5oZWRhZ2VzaGhlYnJldyA9IDB4ZmIzNDsKIHQuaGVoYWx0b25lYXJhYmljID0gMHgwNmMxOwogdC5oZWhhcmFiaWMgPSAweDA2NDc7CiB0LmhlaGVicmV3ID0gMHgwNWQ0OwogdC5oZWhmaW5hbGFsdG9uZWFyYWJpYyA9IDB4ZmJhNzsKIHQuaGVoZmluYWxhbHR0d29hcmFiaWMgPSAweGZlZWE7CiB0LmhlaGZpbmFsYXJhYmljID0gMHhmZWVhOwogdC5oZWhoYW16YWFib3ZlZmluYWxhcmFiaWMgPSAweGZiYTU7CiB0LmhlaGhhbXphYWJvdmVpc29sYXRlZGFyYWJpYyA9IDB4ZmJhNDsKIHQuaGVoaW5pdGlhbGFsdG9uZWFyYWJpYyA9IDB4ZmJhODsKIHQuaGVoaW5pdGlhbGFyYWJpYyA9IDB4ZmVlYjsKIHQuaGVoaXJhZ2FuYSA9IDB4MzA3ODsKIHQuaGVobWVkaWFsYWx0b25lYXJhYmljID0gMHhmYmE5OwogdC5oZWhtZWRpYWxhcmFiaWMgPSAweGZlZWM7CiB0LmhlaXNlaWVyYXNxdWFyZSA9IDB4MzM3YjsKIHQuaGVrYXRha2FuYSA9IDB4MzBkODsKIHQuaGVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY4ZDsKIHQuaGVrdXRhYXJ1c3F1YXJlID0gMHgzMzM2OwogdC5oZW5naG9vayA9IDB4MDI2NzsKIHQuaGVydXR1c3F1YXJlID0gMHgzMzM5OwogdC5oZXQgPSAweDA1ZDc7CiB0LmhldGhlYnJldyA9IDB4MDVkNzsKIHQuaGhvb2sgPSAweDAyNjY7CiB0Lmhob29rc3VwZXJpb3IgPSAweDAyYjE7CiB0LmhpZXVoYWNpcmNsZWtvcmVhbiA9IDB4MzI3YjsKIHQuaGlldWhhcGFyZW5rb3JlYW4gPSAweDMyMWI7CiB0LmhpZXVoY2lyY2xla29yZWFuID0gMHgzMjZkOwogdC5oaWV1aGtvcmVhbiA9IDB4MzE0ZTsKIHQuaGlldWhwYXJlbmtvcmVhbiA9IDB4MzIwZDsKIHQuaGloaXJhZ2FuYSA9IDB4MzA3MjsKIHQuaGlrYXRha2FuYSA9IDB4MzBkMjsKIHQuaGlrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY4YjsKIHQuaGlyaXEgPSAweDA1YjQ7CiB0LmhpcmlxMTQgPSAweDA1YjQ7CiB0LmhpcmlxMjEgPSAweDA1YjQ7CiB0LmhpcmlxMmQgPSAweDA1YjQ7CiB0LmhpcmlxaGVicmV3ID0gMHgwNWI0OwogdC5oaXJpcW5hcnJvd2hlYnJldyA9IDB4MDViNDsKIHQuaGlyaXFxdWFydGVyaGVicmV3ID0gMHgwNWI0OwogdC5oaXJpcXdpZGVoZWJyZXcgPSAweDA1YjQ7CiB0LmhsaW5lYmVsb3cgPSAweDFlOTY7CiB0Lmhtb25vc3BhY2UgPSAweGZmNDg7CiB0LmhvYXJtZW5pYW4gPSAweDA1NzA7CiB0LmhvaGlwdGhhaSA9IDB4MGUyYjsKIHQuaG9oaXJhZ2FuYSA9IDB4MzA3YjsKIHQuaG9rYXRha2FuYSA9IDB4MzBkYjsKIHQuaG9rYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY4ZTsKIHQuaG9sYW0gPSAweDA1Yjk7CiB0LmhvbGFtMTkgPSAweDA1Yjk7CiB0LmhvbGFtMjYgPSAweDA1Yjk7CiB0LmhvbGFtMzIgPSAweDA1Yjk7CiB0LmhvbGFtaGVicmV3ID0gMHgwNWI5OwogdC5ob2xhbW5hcnJvd2hlYnJldyA9IDB4MDViOTsKIHQuaG9sYW1xdWFydGVyaGVicmV3ID0gMHgwNWI5OwogdC5ob2xhbXdpZGVoZWJyZXcgPSAweDA1Yjk7CiB0Lmhvbm9raHVrdGhhaSA9IDB4MGUyZTsKIHQuaG9va2Fib3ZlY29tYiA9IDB4MDMwOTsKIHQuaG9va2NtYiA9IDB4MDMwOTsKIHQuaG9va3BhbGF0YWxpemVkYmVsb3djbWIgPSAweDAzMjE7CiB0Lmhvb2tyZXRyb2ZsZXhiZWxvd2NtYiA9IDB4MDMyMjsKIHQuaG9vbnNxdWFyZSA9IDB4MzM0MjsKIHQuaG9yaWNvcHRpYyA9IDB4MDNlOTsKIHQuaG9yaXpvbnRhbGJhciA9IDB4MjAxNTsKIHQuaG9ybmNtYiA9IDB4MDMxYjsKIHQuaG90c3ByaW5ncyA9IDB4MjY2ODsKIHQuaG91c2UgPSAweDIzMDI7CiB0LmhwYXJlbiA9IDB4MjRhMzsKIHQuaHN1cGVyaW9yID0gMHgwMmIwOwogdC5odHVybmVkID0gMHgwMjY1OwogdC5odWhpcmFnYW5hID0gMHgzMDc1OwogdC5odWlpdG9zcXVhcmUgPSAweDMzMzM7CiB0Lmh1a2F0YWthbmEgPSAweDMwZDU7CiB0Lmh1a2F0YWthbmFoYWxmd2lkdGggPSAweGZmOGM7CiB0Lmh1bmdhcnVtbGF1dCA9IDB4MDJkZDsKIHQuaHVuZ2FydW1sYXV0Y21iID0gMHgwMzBiOwogdC5odiA9IDB4MDE5NTsKIHQuaHlwaGVuID0gMHgwMDJkOwogdC5oeXBoZW5pbmZlcmlvciA9IDB4ZjZlNTsKIHQuaHlwaGVubW9ub3NwYWNlID0gMHhmZjBkOwogdC5oeXBoZW5zbWFsbCA9IDB4ZmU2MzsKIHQuaHlwaGVuc3VwZXJpb3IgPSAweGY2ZTY7CiB0Lmh5cGhlbnR3byA9IDB4MjAxMDsKIHQuaSA9IDB4MDA2OTsKIHQuaWFjdXRlID0gMHgwMGVkOwogdC5pYWN5cmlsbGljID0gMHgwNDRmOwogdC5pYmVuZ2FsaSA9IDB4MDk4NzsKIHQuaWJvcG9tb2ZvID0gMHgzMTI3OwogdC5pYnJldmUgPSAweDAxMmQ7CiB0LmljYXJvbiA9IDB4MDFkMDsKIHQuaWNpcmNsZSA9IDB4MjRkODsKIHQuaWNpcmN1bWZsZXggPSAweDAwZWU7CiB0LmljeXJpbGxpYyA9IDB4MDQ1NjsKIHQuaWRibGdyYXZlID0gMHgwMjA5OwogdC5pZGVvZ3JhcGhlYXJ0aGNpcmNsZSA9IDB4MzI4ZjsKIHQuaWRlb2dyYXBoZmlyZWNpcmNsZSA9IDB4MzI4YjsKIHQuaWRlb2dyYXBoaWNhbGxpYW5jZXBhcmVuID0gMHgzMjNmOwogdC5pZGVvZ3JhcGhpY2NhbGxwYXJlbiA9IDB4MzIzYTsKIHQuaWRlb2dyYXBoaWNjZW50cmVjaXJjbGUgPSAweDMyYTU7CiB0LmlkZW9ncmFwaGljY2xvc2UgPSAweDMwMDY7CiB0LmlkZW9ncmFwaGljY29tbWEgPSAweDMwMDE7CiB0LmlkZW9ncmFwaGljY29tbWFsZWZ0ID0gMHhmZjY0OwogdC5pZGVvZ3JhcGhpY2NvbmdyYXR1bGF0aW9ucGFyZW4gPSAweDMyMzc7CiB0LmlkZW9ncmFwaGljY29ycmVjdGNpcmNsZSA9IDB4MzJhMzsKIHQuaWRlb2dyYXBoaWNlYXJ0aHBhcmVuID0gMHgzMjJmOwogdC5pZGVvZ3JhcGhpY2VudGVycHJpc2VwYXJlbiA9IDB4MzIzZDsKIHQuaWRlb2dyYXBoaWNleGNlbGxlbnRjaXJjbGUgPSAweDMyOWQ7CiB0LmlkZW9ncmFwaGljZmVzdGl2YWxwYXJlbiA9IDB4MzI0MDsKIHQuaWRlb2dyYXBoaWNmaW5hbmNpYWxjaXJjbGUgPSAweDMyOTY7CiB0LmlkZW9ncmFwaGljZmluYW5jaWFscGFyZW4gPSAweDMyMzY7CiB0LmlkZW9ncmFwaGljZmlyZXBhcmVuID0gMHgzMjJiOwogdC5pZGVvZ3JhcGhpY2hhdmVwYXJlbiA9IDB4MzIzMjsKIHQuaWRlb2dyYXBoaWNoaWdoY2lyY2xlID0gMHgzMmE0OwogdC5pZGVvZ3JhcGhpY2l0ZXJhdGlvbm1hcmsgPSAweDMwMDU7CiB0LmlkZW9ncmFwaGljbGFib3JjaXJjbGUgPSAweDMyOTg7CiB0LmlkZW9ncmFwaGljbGFib3JwYXJlbiA9IDB4MzIzODsKIHQuaWRlb2dyYXBoaWNsZWZ0Y2lyY2xlID0gMHgzMmE3OwogdC5pZGVvZ3JhcGhpY2xvd2NpcmNsZSA9IDB4MzJhNjsKIHQuaWRlb2dyYXBoaWNtZWRpY2luZWNpcmNsZSA9IDB4MzJhOTsKIHQuaWRlb2dyYXBoaWNtZXRhbHBhcmVuID0gMHgzMjJlOwogdC5pZGVvZ3JhcGhpY21vb25wYXJlbiA9IDB4MzIyYTsKIHQuaWRlb2dyYXBoaWNuYW1lcGFyZW4gPSAweDMyMzQ7CiB0LmlkZW9ncmFwaGljcGVyaW9kID0gMHgzMDAyOwogdC5pZGVvZ3JhcGhpY3ByaW50Y2lyY2xlID0gMHgzMjllOwogdC5pZGVvZ3JhcGhpY3JlYWNocGFyZW4gPSAweDMyNDM7CiB0LmlkZW9ncmFwaGljcmVwcmVzZW50cGFyZW4gPSAweDMyMzk7CiB0LmlkZW9ncmFwaGljcmVzb3VyY2VwYXJlbiA9IDB4MzIzZTsKIHQuaWRlb2dyYXBoaWNyaWdodGNpcmNsZSA9IDB4MzJhODsKIHQuaWRlb2dyYXBoaWNzZWNyZXRjaXJjbGUgPSAweDMyOTk7CiB0LmlkZW9ncmFwaGljc2VsZnBhcmVuID0gMHgzMjQyOwogdC5pZGVvZ3JhcGhpY3NvY2lldHlwYXJlbiA9IDB4MzIzMzsKIHQuaWRlb2dyYXBoaWNzcGFjZSA9IDB4MzAwMDsKIHQuaWRlb2dyYXBoaWNzcGVjaWFscGFyZW4gPSAweDMyMzU7CiB0LmlkZW9ncmFwaGljc3RvY2twYXJlbiA9IDB4MzIzMTsKIHQuaWRlb2dyYXBoaWNzdHVkeXBhcmVuID0gMHgzMjNiOwogdC5pZGVvZ3JhcGhpY3N1bnBhcmVuID0gMHgzMjMwOwogdC5pZGVvZ3JhcGhpY3N1cGVydmlzZXBhcmVuID0gMHgzMjNjOwogdC5pZGVvZ3JhcGhpY3dhdGVycGFyZW4gPSAweDMyMmM7CiB0LmlkZW9ncmFwaGljd29vZHBhcmVuID0gMHgzMjJkOwogdC5pZGVvZ3JhcGhpY3plcm8gPSAweDMwMDc7CiB0LmlkZW9ncmFwaG1ldGFsY2lyY2xlID0gMHgzMjhlOwogdC5pZGVvZ3JhcGhtb29uY2lyY2xlID0gMHgzMjhhOwogdC5pZGVvZ3JhcGhuYW1lY2lyY2xlID0gMHgzMjk0OwogdC5pZGVvZ3JhcGhzdW5jaXJjbGUgPSAweDMyOTA7CiB0LmlkZW9ncmFwaHdhdGVyY2lyY2xlID0gMHgzMjhjOwogdC5pZGVvZ3JhcGh3b29kY2lyY2xlID0gMHgzMjhkOwogdC5pZGV2YSA9IDB4MDkwNzsKIHQuaWRpZXJlc2lzID0gMHgwMGVmOwogdC5pZGllcmVzaXNhY3V0ZSA9IDB4MWUyZjsKIHQuaWRpZXJlc2lzY3lyaWxsaWMgPSAweDA0ZTU7CiB0Lmlkb3RiZWxvdyA9IDB4MWVjYjsKIHQuaWVicmV2ZWN5cmlsbGljID0gMHgwNGQ3OwogdC5pZWN5cmlsbGljID0gMHgwNDM1OwogdC5pZXVuZ2FjaXJjbGVrb3JlYW4gPSAweDMyNzU7CiB0LmlldW5nYXBhcmVua29yZWFuID0gMHgzMjE1OwogdC5pZXVuZ2NpcmNsZWtvcmVhbiA9IDB4MzI2NzsKIHQuaWV1bmdrb3JlYW4gPSAweDMxNDc7CiB0LmlldW5ncGFyZW5rb3JlYW4gPSAweDMyMDc7CiB0LmlncmF2ZSA9IDB4MDBlYzsKIHQuaWd1amFyYXRpID0gMHgwYTg3OwogdC5pZ3VybXVraGkgPSAweDBhMDc7CiB0LmloaXJhZ2FuYSA9IDB4MzA0NDsKIHQuaWhvb2thYm92ZSA9IDB4MWVjOTsKIHQuaWliZW5nYWxpID0gMHgwOTg4OwogdC5paWN5cmlsbGljID0gMHgwNDM4OwogdC5paWRldmEgPSAweDA5MDg7CiB0LmlpZ3VqYXJhdGkgPSAweDBhODg7CiB0LmlpZ3VybXVraGkgPSAweDBhMDg7CiB0LmlpbWF0cmFndXJtdWtoaSA9IDB4MGE0MDsKIHQuaWludmVydGVkYnJldmUgPSAweDAyMGI7CiB0Lmlpc2hvcnRjeXJpbGxpYyA9IDB4MDQzOTsKIHQuaWl2b3dlbHNpZ25iZW5nYWxpID0gMHgwOWMwOwogdC5paXZvd2Vsc2lnbmRldmEgPSAweDA5NDA7CiB0Lmlpdm93ZWxzaWduZ3VqYXJhdGkgPSAweDBhYzA7CiB0LmlqID0gMHgwMTMzOwogdC5pa2F0YWthbmEgPSAweDMwYTQ7CiB0LmlrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY3MjsKIHQuaWtvcmVhbiA9IDB4MzE2MzsKIHQuaWxkZSA9IDB4MDJkYzsKIHQuaWx1eWhlYnJldyA9IDB4MDVhYzsKIHQuaW1hY3JvbiA9IDB4MDEyYjsKIHQuaW1hY3JvbmN5cmlsbGljID0gMHgwNGUzOwogdC5pbWFnZW9yYXBwcm94aW1hdGVseWVxdWFsID0gMHgyMjUzOwogdC5pbWF0cmFndXJtdWtoaSA9IDB4MGEzZjsKIHQuaW1vbm9zcGFjZSA9IDB4ZmY0OTsKIHQuaW5jcmVtZW50ID0gMHgyMjA2OwogdC5pbmZpbml0eSA9IDB4MjIxZTsKIHQuaW5pYXJtZW5pYW4gPSAweDA1NmI7CiB0LmludGVncmFsID0gMHgyMjJiOwogdC5pbnRlZ3JhbGJvdHRvbSA9IDB4MjMyMTsKIHQuaW50ZWdyYWxidCA9IDB4MjMyMTsKIHQuaW50ZWdyYWxleCA9IDB4ZjhmNTsKIHQuaW50ZWdyYWx0b3AgPSAweDIzMjA7CiB0LmludGVncmFsdHAgPSAweDIzMjA7CiB0LmludGVyc2VjdGlvbiA9IDB4MjIyOTsKIHQuaW50aXNxdWFyZSA9IDB4MzMwNTsKIHQuaW52YnVsbGV0ID0gMHgyNWQ4OwogdC5pbnZjaXJjbGUgPSAweDI1ZDk7CiB0LmludnNtaWxlZmFjZSA9IDB4MjYzYjsKIHQuaW9jeXJpbGxpYyA9IDB4MDQ1MTsKIHQuaW9nb25layA9IDB4MDEyZjsKIHQuaW90YSA9IDB4MDNiOTsKIHQuaW90YWRpZXJlc2lzID0gMHgwM2NhOwogdC5pb3RhZGllcmVzaXN0b25vcyA9IDB4MDM5MDsKIHQuaW90YWxhdGluID0gMHgwMjY5OwogdC5pb3RhdG9ub3MgPSAweDAzYWY7CiB0LmlwYXJlbiA9IDB4MjRhNDsKIHQuaXJpZ3VybXVraGkgPSAweDBhNzI7CiB0LmlzbWFsbGhpcmFnYW5hID0gMHgzMDQzOwogdC5pc21hbGxrYXRha2FuYSA9IDB4MzBhMzsKIHQuaXNtYWxsa2F0YWthbmFoYWxmd2lkdGggPSAweGZmNjg7CiB0Lmlzc2hhcmJlbmdhbGkgPSAweDA5ZmE7CiB0LmlzdHJva2UgPSAweDAyNjg7CiB0LmlzdXBlcmlvciA9IDB4ZjZlZDsKIHQuaXRlcmF0aW9uaGlyYWdhbmEgPSAweDMwOWQ7CiB0Lml0ZXJhdGlvbmthdGFrYW5hID0gMHgzMGZkOwogdC5pdGlsZGUgPSAweDAxMjk7CiB0Lml0aWxkZWJlbG93ID0gMHgxZTJkOwogdC5pdWJvcG9tb2ZvID0gMHgzMTI5OwogdC5pdWN5cmlsbGljID0gMHgwNDRlOwogdC5pdm93ZWxzaWduYmVuZ2FsaSA9IDB4MDliZjsKIHQuaXZvd2Vsc2lnbmRldmEgPSAweDA5M2Y7CiB0Lml2b3dlbHNpZ25ndWphcmF0aSA9IDB4MGFiZjsKIHQuaXpoaXRzYWN5cmlsbGljID0gMHgwNDc1OwogdC5pemhpdHNhZGJsZ3JhdmVjeXJpbGxpYyA9IDB4MDQ3NzsKIHQuaiA9IDB4MDA2YTsKIHQuamFhcm1lbmlhbiA9IDB4MDU3MTsKIHQuamFiZW5nYWxpID0gMHgwOTljOwogdC5qYWRldmEgPSAweDA5MWM7CiB0LmphZ3VqYXJhdGkgPSAweDBhOWM7CiB0LmphZ3VybXVraGkgPSAweDBhMWM7CiB0Lmpib3BvbW9mbyA9IDB4MzExMDsKIHQuamNhcm9uID0gMHgwMWYwOwogdC5qY2lyY2xlID0gMHgyNGQ5OwogdC5qY2lyY3VtZmxleCA9IDB4MDEzNTsKIHQuamNyb3NzZWR0YWlsID0gMHgwMjlkOwogdC5qZG90bGVzc3N0cm9rZSA9IDB4MDI1ZjsKIHQuamVjeXJpbGxpYyA9IDB4MDQ1ODsKIHQuamVlbWFyYWJpYyA9IDB4MDYyYzsKIHQuamVlbWZpbmFsYXJhYmljID0gMHhmZTllOwogdC5qZWVtaW5pdGlhbGFyYWJpYyA9IDB4ZmU5ZjsKIHQuamVlbW1lZGlhbGFyYWJpYyA9IDB4ZmVhMDsKIHQuamVoYXJhYmljID0gMHgwNjk4OwogdC5qZWhmaW5hbGFyYWJpYyA9IDB4ZmI4YjsKIHQuamhhYmVuZ2FsaSA9IDB4MDk5ZDsKIHQuamhhZGV2YSA9IDB4MDkxZDsKIHQuamhhZ3VqYXJhdGkgPSAweDBhOWQ7CiB0LmpoYWd1cm11a2hpID0gMHgwYTFkOwogdC5qaGVoYXJtZW5pYW4gPSAweDA1N2I7CiB0LmppcyA9IDB4MzAwNDsKIHQuam1vbm9zcGFjZSA9IDB4ZmY0YTsKIHQuanBhcmVuID0gMHgyNGE1OwogdC5qc3VwZXJpb3IgPSAweDAyYjI7CiB0LmsgPSAweDAwNmI7CiB0LmthYmFzaGtpcmN5cmlsbGljID0gMHgwNGExOwogdC5rYWJlbmdhbGkgPSAweDA5OTU7CiB0LmthY3V0ZSA9IDB4MWUzMTsKIHQua2FjeXJpbGxpYyA9IDB4MDQzYTsKIHQua2FkZXNjZW5kZXJjeXJpbGxpYyA9IDB4MDQ5YjsKIHQua2FkZXZhID0gMHgwOTE1OwogdC5rYWYgPSAweDA1ZGI7CiB0LmthZmFyYWJpYyA9IDB4MDY0MzsKIHQua2FmZGFnZXNoID0gMHhmYjNiOwogdC5rYWZkYWdlc2hoZWJyZXcgPSAweGZiM2I7CiB0LmthZmZpbmFsYXJhYmljID0gMHhmZWRhOwogdC5rYWZoZWJyZXcgPSAweDA1ZGI7CiB0LmthZmluaXRpYWxhcmFiaWMgPSAweGZlZGI7CiB0LmthZm1lZGlhbGFyYWJpYyA9IDB4ZmVkYzsKIHQua2FmcmFmZWhlYnJldyA9IDB4ZmI0ZDsKIHQua2FndWphcmF0aSA9IDB4MGE5NTsKIHQua2FndXJtdWtoaSA9IDB4MGExNTsKIHQua2FoaXJhZ2FuYSA9IDB4MzA0YjsKIHQua2Fob29rY3lyaWxsaWMgPSAweDA0YzQ7CiB0Lmtha2F0YWthbmEgPSAweDMwYWI7CiB0Lmtha2F0YWthbmFoYWxmd2lkdGggPSAweGZmNzY7CiB0LmthcHBhID0gMHgwM2JhOwogdC5rYXBwYXN5bWJvbGdyZWVrID0gMHgwM2YwOwogdC5rYXB5ZW91bm1pZXVta29yZWFuID0gMHgzMTcxOwogdC5rYXB5ZW91bnBoaWV1cGhrb3JlYW4gPSAweDMxODQ7CiB0LmthcHllb3VucGlldXBrb3JlYW4gPSAweDMxNzg7CiB0LmthcHllb3Vuc3NhbmdwaWV1cGtvcmVhbiA9IDB4MzE3OTsKIHQua2Fyb3JpaXNxdWFyZSA9IDB4MzMwZDsKIHQua2FzaGlkYWF1dG9hcmFiaWMgPSAweDA2NDA7CiB0Lmthc2hpZGFhdXRvbm9zaWRlYmVhcmluZ2FyYWJpYyA9IDB4MDY0MDsKIHQua2FzbWFsbGthdGFrYW5hID0gMHgzMGY1OwogdC5rYXNxdWFyZSA9IDB4MzM4NDsKIHQua2FzcmFhcmFiaWMgPSAweDA2NTA7CiB0Lmthc3JhdGFuYXJhYmljID0gMHgwNjRkOwogdC5rYXN0cm9rZWN5cmlsbGljID0gMHgwNDlmOwogdC5rYXRhaGlyYXByb2xvbmdtYXJraGFsZndpZHRoID0gMHhmZjcwOwogdC5rYXZlcnRpY2Fsc3Ryb2tlY3lyaWxsaWMgPSAweDA0OWQ7CiB0Lmtib3BvbW9mbyA9IDB4MzEwZTsKIHQua2NhbHNxdWFyZSA9IDB4MzM4OTsKIHQua2Nhcm9uID0gMHgwMWU5OwogdC5rY2VkaWxsYSA9IDB4MDEzNzsKIHQua2NpcmNsZSA9IDB4MjRkYTsKIHQua2NvbW1hYWNjZW50ID0gMHgwMTM3OwogdC5rZG90YmVsb3cgPSAweDFlMzM7CiB0LmtlaGFybWVuaWFuID0gMHgwNTg0OwogdC5rZWhpcmFnYW5hID0gMHgzMDUxOwogdC5rZWthdGFrYW5hID0gMHgzMGIxOwogdC5rZWthdGFrYW5haGFsZndpZHRoID0gMHhmZjc5OwogdC5rZW5hcm1lbmlhbiA9IDB4MDU2ZjsKIHQua2VzbWFsbGthdGFrYW5hID0gMHgzMGY2OwogdC5rZ3JlZW5sYW5kaWMgPSAweDAxMzg7CiB0LmtoYWJlbmdhbGkgPSAweDA5OTY7CiB0LmtoYWN5cmlsbGljID0gMHgwNDQ1OwogdC5raGFkZXZhID0gMHgwOTE2OwogdC5raGFndWphcmF0aSA9IDB4MGE5NjsKIHQua2hhZ3VybXVraGkgPSAweDBhMTY7CiB0LmtoYWhhcmFiaWMgPSAweDA2MmU7CiB0LmtoYWhmaW5hbGFyYWJpYyA9IDB4ZmVhNjsKIHQua2hhaGluaXRpYWxhcmFiaWMgPSAweGZlYTc7CiB0LmtoYWhtZWRpYWxhcmFiaWMgPSAweGZlYTg7CiB0LmtoZWljb3B0aWMgPSAweDAzZTc7CiB0LmtoaGFkZXZhID0gMHgwOTU5OwogdC5raGhhZ3VybXVraGkgPSAweDBhNTk7CiB0LmtoaWV1a2hhY2lyY2xla29yZWFuID0gMHgzMjc4OwogdC5raGlldWtoYXBhcmVua29yZWFuID0gMHgzMjE4OwogdC5raGlldWtoY2lyY2xla29yZWFuID0gMHgzMjZhOwogdC5raGlldWtoa29yZWFuID0gMHgzMTRiOwogdC5raGlldWtocGFyZW5rb3JlYW4gPSAweDMyMGE7CiB0Lmtob2toYWl0aGFpID0gMHgwZTAyOwogdC5raG9raG9udGhhaSA9IDB4MGUwNTsKIHQua2hva2h1YXR0aGFpID0gMHgwZTAzOwogdC5raG9raHdhaXRoYWkgPSAweDBlMDQ7CiB0Lmtob211dHRoYWkgPSAweDBlNWI7CiB0Lmtob29rID0gMHgwMTk5OwogdC5raG9yYWtoYW5ndGhhaSA9IDB4MGUwNjsKIHQua2h6c3F1YXJlID0gMHgzMzkxOwogdC5raWhpcmFnYW5hID0gMHgzMDRkOwogdC5raWthdGFrYW5hID0gMHgzMGFkOwogdC5raWthdGFrYW5haGFsZndpZHRoID0gMHhmZjc3OwogdC5raXJvZ3VyYW11c3F1YXJlID0gMHgzMzE1OwogdC5raXJvbWVldG9ydXNxdWFyZSA9IDB4MzMxNjsKIHQua2lyb3NxdWFyZSA9IDB4MzMxNDsKIHQua2l5ZW9rYWNpcmNsZWtvcmVhbiA9IDB4MzI2ZTsKIHQua2l5ZW9rYXBhcmVua29yZWFuID0gMHgzMjBlOwogdC5raXllb2tjaXJjbGVrb3JlYW4gPSAweDMyNjA7CiB0LmtpeWVva2tvcmVhbiA9IDB4MzEzMTsKIHQua2l5ZW9rcGFyZW5rb3JlYW4gPSAweDMyMDA7CiB0LmtpeWVva3Npb3Nrb3JlYW4gPSAweDMxMzM7CiB0LmtqZWN5cmlsbGljID0gMHgwNDVjOwogdC5rbGluZWJlbG93ID0gMHgxZTM1OwogdC5rbHNxdWFyZSA9IDB4MzM5ODsKIHQua21jdWJlZHNxdWFyZSA9IDB4MzNhNjsKIHQua21vbm9zcGFjZSA9IDB4ZmY0YjsKIHQua21zcXVhcmVkc3F1YXJlID0gMHgzM2EyOwogdC5rb2hpcmFnYW5hID0gMHgzMDUzOwogdC5rb2htc3F1YXJlID0gMHgzM2MwOwogdC5rb2thaXRoYWkgPSAweDBlMDE7CiB0Lmtva2F0YWthbmEgPSAweDMwYjM7CiB0Lmtva2F0YWthbmFoYWxmd2lkdGggPSAweGZmN2E7CiB0Lmtvb3Bvc3F1YXJlID0gMHgzMzFlOwogdC5rb3BwYWN5cmlsbGljID0gMHgwNDgxOwogdC5rb3JlYW5zdGFuZGFyZHN5bWJvbCA9IDB4MzI3ZjsKIHQua29yb25pc2NtYiA9IDB4MDM0MzsKIHQua3BhcmVuID0gMHgyNGE2OwogdC5rcGFzcXVhcmUgPSAweDMzYWE7CiB0LmtzaWN5cmlsbGljID0gMHgwNDZmOwogdC5rdHNxdWFyZSA9IDB4MzNjZjsKIHQua3R1cm5lZCA9IDB4MDI5ZTsKIHQua3VoaXJhZ2FuYSA9IDB4MzA0ZjsKIHQua3VrYXRha2FuYSA9IDB4MzBhZjsKIHQua3VrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY3ODsKIHQua3ZzcXVhcmUgPSAweDMzYjg7CiB0Lmt3c3F1YXJlID0gMHgzM2JlOwogdC5sID0gMHgwMDZjOwogdC5sYWJlbmdhbGkgPSAweDA5YjI7CiB0LmxhY3V0ZSA9IDB4MDEzYTsKIHQubGFkZXZhID0gMHgwOTMyOwogdC5sYWd1amFyYXRpID0gMHgwYWIyOwogdC5sYWd1cm11a2hpID0gMHgwYTMyOwogdC5sYWtraGFuZ3lhb3RoYWkgPSAweDBlNDU7CiB0LmxhbWFsZWZmaW5hbGFyYWJpYyA9IDB4ZmVmYzsKIHQubGFtYWxlZmhhbXphYWJvdmVmaW5hbGFyYWJpYyA9IDB4ZmVmODsKIHQubGFtYWxlZmhhbXphYWJvdmVpc29sYXRlZGFyYWJpYyA9IDB4ZmVmNzsKIHQubGFtYWxlZmhhbXphYmVsb3dmaW5hbGFyYWJpYyA9IDB4ZmVmYTsKIHQubGFtYWxlZmhhbXphYmVsb3dpc29sYXRlZGFyYWJpYyA9IDB4ZmVmOTsKIHQubGFtYWxlZmlzb2xhdGVkYXJhYmljID0gMHhmZWZiOwogdC5sYW1hbGVmbWFkZGFhYm92ZWZpbmFsYXJhYmljID0gMHhmZWY2OwogdC5sYW1hbGVmbWFkZGFhYm92ZWlzb2xhdGVkYXJhYmljID0gMHhmZWY1OwogdC5sYW1hcmFiaWMgPSAweDA2NDQ7CiB0LmxhbWJkYSA9IDB4MDNiYjsKIHQubGFtYmRhc3Ryb2tlID0gMHgwMTliOwogdC5sYW1lZCA9IDB4MDVkYzsKIHQubGFtZWRkYWdlc2ggPSAweGZiM2M7CiB0LmxhbWVkZGFnZXNoaGVicmV3ID0gMHhmYjNjOwogdC5sYW1lZGhlYnJldyA9IDB4MDVkYzsKIHQubGFtZmluYWxhcmFiaWMgPSAweGZlZGU7CiB0LmxhbWhhaGluaXRpYWxhcmFiaWMgPSAweGZjY2E7CiB0LmxhbWluaXRpYWxhcmFiaWMgPSAweGZlZGY7CiB0LmxhbWplZW1pbml0aWFsYXJhYmljID0gMHhmY2M5OwogdC5sYW1raGFoaW5pdGlhbGFyYWJpYyA9IDB4ZmNjYjsKIHQubGFtbGFtaGVoaXNvbGF0ZWRhcmFiaWMgPSAweGZkZjI7CiB0LmxhbW1lZGlhbGFyYWJpYyA9IDB4ZmVlMDsKIHQubGFtbWVlbWhhaGluaXRpYWxhcmFiaWMgPSAweGZkODg7CiB0LmxhbW1lZW1pbml0aWFsYXJhYmljID0gMHhmY2NjOwogdC5sYXJnZWNpcmNsZSA9IDB4MjVlZjsKIHQubGJhciA9IDB4MDE5YTsKIHQubGJlbHQgPSAweDAyNmM7CiB0Lmxib3BvbW9mbyA9IDB4MzEwYzsKIHQubGNhcm9uID0gMHgwMTNlOwogdC5sY2VkaWxsYSA9IDB4MDEzYzsKIHQubGNpcmNsZSA9IDB4MjRkYjsKIHQubGNpcmN1bWZsZXhiZWxvdyA9IDB4MWUzZDsKIHQubGNvbW1hYWNjZW50ID0gMHgwMTNjOwogdC5sZG90ID0gMHgwMTQwOwogdC5sZG90YWNjZW50ID0gMHgwMTQwOwogdC5sZG90YmVsb3cgPSAweDFlMzc7CiB0Lmxkb3RiZWxvd21hY3JvbiA9IDB4MWUzOTsKIHQubGVmdGFuZ2xlYWJvdmVjbWIgPSAweDAzMWE7CiB0LmxlZnR0YWNrYmVsb3djbWIgPSAweDAzMTg7CiB0Lmxlc3MgPSAweDAwM2M7CiB0Lmxlc3NlcXVhbCA9IDB4MjI2NDsKIHQubGVzc2VxdWFsb3JncmVhdGVyID0gMHgyMmRhOwogdC5sZXNzbW9ub3NwYWNlID0gMHhmZjFjOwogdC5sZXNzb3JlcXVpdmFsZW50ID0gMHgyMjcyOwogdC5sZXNzb3JncmVhdGVyID0gMHgyMjc2OwogdC5sZXNzb3ZlcmVxdWFsID0gMHgyMjY2OwogdC5sZXNzc21hbGwgPSAweGZlNjQ7CiB0LmxlemggPSAweDAyNmU7CiB0LmxmYmxvY2sgPSAweDI1OGM7CiB0Lmxob29rcmV0cm9mbGV4ID0gMHgwMjZkOwogdC5saXJhID0gMHgyMGE0OwogdC5saXduYXJtZW5pYW4gPSAweDA1NmM7CiB0LmxqID0gMHgwMWM5OwogdC5samVjeXJpbGxpYyA9IDB4MDQ1OTsKIHQubGwgPSAweGY2YzA7CiB0LmxsYWRldmEgPSAweDA5MzM7CiB0LmxsYWd1amFyYXRpID0gMHgwYWIzOwogdC5sbGluZWJlbG93ID0gMHgxZTNiOwogdC5sbGxhZGV2YSA9IDB4MDkzNDsKIHQubGx2b2NhbGljYmVuZ2FsaSA9IDB4MDllMTsKIHQubGx2b2NhbGljZGV2YSA9IDB4MDk2MTsKIHQubGx2b2NhbGljdm93ZWxzaWduYmVuZ2FsaSA9IDB4MDllMzsKIHQubGx2b2NhbGljdm93ZWxzaWduZGV2YSA9IDB4MDk2MzsKIHQubG1pZGRsZXRpbGRlID0gMHgwMjZiOwogdC5sbW9ub3NwYWNlID0gMHhmZjRjOwogdC5sbXNxdWFyZSA9IDB4MzNkMDsKIHQubG9jaHVsYXRoYWkgPSAweDBlMmM7CiB0LmxvZ2ljYWxhbmQgPSAweDIyMjc7CiB0LmxvZ2ljYWxub3QgPSAweDAwYWM7CiB0LmxvZ2ljYWxub3RyZXZlcnNlZCA9IDB4MjMxMDsKIHQubG9naWNhbG9yID0gMHgyMjI4OwogdC5sb2xpbmd0aGFpID0gMHgwZTI1OwogdC5sb25ncyA9IDB4MDE3ZjsKIHQubG93bGluZWNlbnRlcmxpbmUgPSAweGZlNGU7CiB0Lmxvd2xpbmVjbWIgPSAweDAzMzI7CiB0Lmxvd2xpbmVkYXNoZWQgPSAweGZlNGQ7CiB0LmxvemVuZ2UgPSAweDI1Y2E7CiB0LmxwYXJlbiA9IDB4MjRhNzsKIHQubHNsYXNoID0gMHgwMTQyOwogdC5sc3F1YXJlID0gMHgyMTEzOwogdC5sc3VwZXJpb3IgPSAweGY2ZWU7CiB0Lmx0c2hhZGUgPSAweDI1OTE7CiB0Lmx1dGhhaSA9IDB4MGUyNjsKIHQubHZvY2FsaWNiZW5nYWxpID0gMHgwOThjOwogdC5sdm9jYWxpY2RldmEgPSAweDA5MGM7CiB0Lmx2b2NhbGljdm93ZWxzaWduYmVuZ2FsaSA9IDB4MDllMjsKIHQubHZvY2FsaWN2b3dlbHNpZ25kZXZhID0gMHgwOTYyOwogdC5seHNxdWFyZSA9IDB4MzNkMzsKIHQubSA9IDB4MDA2ZDsKIHQubWFiZW5nYWxpID0gMHgwOWFlOwogdC5tYWNyb24gPSAweDAwYWY7CiB0Lm1hY3JvbmJlbG93Y21iID0gMHgwMzMxOwogdC5tYWNyb25jbWIgPSAweDAzMDQ7CiB0Lm1hY3Jvbmxvd21vZCA9IDB4MDJjZDsKIHQubWFjcm9ubW9ub3NwYWNlID0gMHhmZmUzOwogdC5tYWN1dGUgPSAweDFlM2Y7CiB0Lm1hZGV2YSA9IDB4MDkyZTsKIHQubWFndWphcmF0aSA9IDB4MGFhZTsKIHQubWFndXJtdWtoaSA9IDB4MGEyZTsKIHQubWFoYXBha2hoZWJyZXcgPSAweDA1YTQ7CiB0Lm1haGFwYWtobGVmdGhlYnJldyA9IDB4MDVhNDsKIHQubWFoaXJhZ2FuYSA9IDB4MzA3ZTsKIHQubWFpY2hhdHRhd2Fsb3dsZWZ0dGhhaSA9IDB4Zjg5NTsKIHQubWFpY2hhdHRhd2Fsb3dyaWdodHRoYWkgPSAweGY4OTQ7CiB0Lm1haWNoYXR0YXdhdGhhaSA9IDB4MGU0YjsKIHQubWFpY2hhdHRhd2F1cHBlcmxlZnR0aGFpID0gMHhmODkzOwogdC5tYWlla2xvd2xlZnR0aGFpID0gMHhmODhjOwogdC5tYWlla2xvd3JpZ2h0dGhhaSA9IDB4Zjg4YjsKIHQubWFpZWt0aGFpID0gMHgwZTQ4OwogdC5tYWlla3VwcGVybGVmdHRoYWkgPSAweGY4OGE7CiB0Lm1haWhhbmFrYXRsZWZ0dGhhaSA9IDB4Zjg4NDsKIHQubWFpaGFuYWthdHRoYWkgPSAweDBlMzE7CiB0Lm1haXRhaWtodWxlZnR0aGFpID0gMHhmODg5OwogdC5tYWl0YWlraHV0aGFpID0gMHgwZTQ3OwogdC5tYWl0aG9sb3dsZWZ0dGhhaSA9IDB4Zjg4ZjsKIHQubWFpdGhvbG93cmlnaHR0aGFpID0gMHhmODhlOwogdC5tYWl0aG90aGFpID0gMHgwZTQ5OwogdC5tYWl0aG91cHBlcmxlZnR0aGFpID0gMHhmODhkOwogdC5tYWl0cmlsb3dsZWZ0dGhhaSA9IDB4Zjg5MjsKIHQubWFpdHJpbG93cmlnaHR0aGFpID0gMHhmODkxOwogdC5tYWl0cml0aGFpID0gMHgwZTRhOwogdC5tYWl0cml1cHBlcmxlZnR0aGFpID0gMHhmODkwOwogdC5tYWl5YW1va3RoYWkgPSAweDBlNDY7CiB0Lm1ha2F0YWthbmEgPSAweDMwZGU7CiB0Lm1ha2F0YWthbmFoYWxmd2lkdGggPSAweGZmOGY7CiB0Lm1hbGUgPSAweDI2NDI7CiB0Lm1hbnN5b25zcXVhcmUgPSAweDMzNDc7CiB0Lm1hcWFmaGVicmV3ID0gMHgwNWJlOwogdC5tYXJzID0gMHgyNjQyOwogdC5tYXNvcmFjaXJjbGVoZWJyZXcgPSAweDA1YWY7CiB0Lm1hc3F1YXJlID0gMHgzMzgzOwogdC5tYm9wb21vZm8gPSAweDMxMDc7CiB0Lm1ic3F1YXJlID0gMHgzM2Q0OwogdC5tY2lyY2xlID0gMHgyNGRjOwogdC5tY3ViZWRzcXVhcmUgPSAweDMzYTU7CiB0Lm1kb3RhY2NlbnQgPSAweDFlNDE7CiB0Lm1kb3RiZWxvdyA9IDB4MWU0MzsKIHQubWVlbWFyYWJpYyA9IDB4MDY0NTsKIHQubWVlbWZpbmFsYXJhYmljID0gMHhmZWUyOwogdC5tZWVtaW5pdGlhbGFyYWJpYyA9IDB4ZmVlMzsKIHQubWVlbW1lZGlhbGFyYWJpYyA9IDB4ZmVlNDsKIHQubWVlbW1lZW1pbml0aWFsYXJhYmljID0gMHhmY2QxOwogdC5tZWVtbWVlbWlzb2xhdGVkYXJhYmljID0gMHhmYzQ4OwogdC5tZWV0b3J1c3F1YXJlID0gMHgzMzRkOwogdC5tZWhpcmFnYW5hID0gMHgzMDgxOwogdC5tZWl6aWVyYXNxdWFyZSA9IDB4MzM3ZTsKIHQubWVrYXRha2FuYSA9IDB4MzBlMTsKIHQubWVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY5MjsKIHQubWVtID0gMHgwNWRlOwogdC5tZW1kYWdlc2ggPSAweGZiM2U7CiB0Lm1lbWRhZ2VzaGhlYnJldyA9IDB4ZmIzZTsKIHQubWVtaGVicmV3ID0gMHgwNWRlOwogdC5tZW5hcm1lbmlhbiA9IDB4MDU3NDsKIHQubWVya2hhaGVicmV3ID0gMHgwNWE1OwogdC5tZXJraGFrZWZ1bGFoZWJyZXcgPSAweDA1YTY7CiB0Lm1lcmtoYWtlZnVsYWxlZnRoZWJyZXcgPSAweDA1YTY7CiB0Lm1lcmtoYWxlZnRoZWJyZXcgPSAweDA1YTU7CiB0Lm1ob29rID0gMHgwMjcxOwogdC5taHpzcXVhcmUgPSAweDMzOTI7CiB0Lm1pZGRsZWRvdGthdGFrYW5haGFsZndpZHRoID0gMHhmZjY1OwogdC5taWRkb3QgPSAweDAwYjc7CiB0Lm1pZXVtYWNpcmNsZWtvcmVhbiA9IDB4MzI3MjsKIHQubWlldW1hcGFyZW5rb3JlYW4gPSAweDMyMTI7CiB0Lm1pZXVtY2lyY2xla29yZWFuID0gMHgzMjY0OwogdC5taWV1bWtvcmVhbiA9IDB4MzE0MTsKIHQubWlldW1wYW5zaW9za29yZWFuID0gMHgzMTcwOwogdC5taWV1bXBhcmVua29yZWFuID0gMHgzMjA0OwogdC5taWV1bXBpZXVwa29yZWFuID0gMHgzMTZlOwogdC5taWV1bXNpb3Nrb3JlYW4gPSAweDMxNmY7CiB0Lm1paGlyYWdhbmEgPSAweDMwN2Y7CiB0Lm1pa2F0YWthbmEgPSAweDMwZGY7CiB0Lm1pa2F0YWthbmFoYWxmd2lkdGggPSAweGZmOTA7CiB0Lm1pbnVzID0gMHgyMjEyOwogdC5taW51c2JlbG93Y21iID0gMHgwMzIwOwogdC5taW51c2NpcmNsZSA9IDB4MjI5NjsKIHQubWludXNtb2QgPSAweDAyZDc7CiB0Lm1pbnVzcGx1cyA9IDB4MjIxMzsKIHQubWludXRlID0gMHgyMDMyOwogdC5taXJpYmFhcnVzcXVhcmUgPSAweDMzNGE7CiB0Lm1pcmlzcXVhcmUgPSAweDMzNDk7CiB0Lm1sb25nbGVndHVybmVkID0gMHgwMjcwOwogdC5tbHNxdWFyZSA9IDB4MzM5NjsKIHQubW1jdWJlZHNxdWFyZSA9IDB4MzNhMzsKIHQubW1vbm9zcGFjZSA9IDB4ZmY0ZDsKIHQubW1zcXVhcmVkc3F1YXJlID0gMHgzMzlmOwogdC5tb2hpcmFnYW5hID0gMHgzMDgyOwogdC5tb2htc3F1YXJlID0gMHgzM2MxOwogdC5tb2thdGFrYW5hID0gMHgzMGUyOwogdC5tb2thdGFrYW5haGFsZndpZHRoID0gMHhmZjkzOwogdC5tb2xzcXVhcmUgPSAweDMzZDY7CiB0Lm1vbWF0aGFpID0gMHgwZTIxOwogdC5tb3ZlcnNzcXVhcmUgPSAweDMzYTc7CiB0Lm1vdmVyc3NxdWFyZWRzcXVhcmUgPSAweDMzYTg7CiB0Lm1wYXJlbiA9IDB4MjRhODsKIHQubXBhc3F1YXJlID0gMHgzM2FiOwogdC5tc3NxdWFyZSA9IDB4MzNiMzsKIHQubXN1cGVyaW9yID0gMHhmNmVmOwogdC5tdHVybmVkID0gMHgwMjZmOwogdC5tdSA9IDB4MDBiNTsKIHQubXUxID0gMHgwMGI1OwogdC5tdWFzcXVhcmUgPSAweDMzODI7CiB0Lm11Y2hncmVhdGVyID0gMHgyMjZiOwogdC5tdWNobGVzcyA9IDB4MjI2YTsKIHQubXVmc3F1YXJlID0gMHgzMzhjOwogdC5tdWdyZWVrID0gMHgwM2JjOwogdC5tdWdzcXVhcmUgPSAweDMzOGQ7CiB0Lm11aGlyYWdhbmEgPSAweDMwODA7CiB0Lm11a2F0YWthbmEgPSAweDMwZTA7CiB0Lm11a2F0YWthbmFoYWxmd2lkdGggPSAweGZmOTE7CiB0Lm11bHNxdWFyZSA9IDB4MzM5NTsKIHQubXVsdGlwbHkgPSAweDAwZDc7CiB0Lm11bXNxdWFyZSA9IDB4MzM5YjsKIHQubXVuYWhoZWJyZXcgPSAweDA1YTM7CiB0Lm11bmFobGVmdGhlYnJldyA9IDB4MDVhMzsKIHQubXVzaWNhbG5vdGUgPSAweDI2NmE7CiB0Lm11c2ljYWxub3RlZGJsID0gMHgyNjZiOwogdC5tdXNpY2ZsYXRzaWduID0gMHgyNjZkOwogdC5tdXNpY3NoYXJwc2lnbiA9IDB4MjY2ZjsKIHQubXVzc3F1YXJlID0gMHgzM2IyOwogdC5tdXZzcXVhcmUgPSAweDMzYjY7CiB0Lm11d3NxdWFyZSA9IDB4MzNiYzsKIHQubXZtZWdhc3F1YXJlID0gMHgzM2I5OwogdC5tdnNxdWFyZSA9IDB4MzNiNzsKIHQubXdtZWdhc3F1YXJlID0gMHgzM2JmOwogdC5td3NxdWFyZSA9IDB4MzNiZDsKIHQubiA9IDB4MDA2ZTsKIHQubmFiZW5nYWxpID0gMHgwOWE4OwogdC5uYWJsYSA9IDB4MjIwNzsKIHQubmFjdXRlID0gMHgwMTQ0OwogdC5uYWRldmEgPSAweDA5Mjg7CiB0Lm5hZ3VqYXJhdGkgPSAweDBhYTg7CiB0Lm5hZ3VybXVraGkgPSAweDBhMjg7CiB0Lm5haGlyYWdhbmEgPSAweDMwNmE7CiB0Lm5ha2F0YWthbmEgPSAweDMwY2E7CiB0Lm5ha2F0YWthbmFoYWxmd2lkdGggPSAweGZmODU7CiB0Lm5hcG9zdHJvcGhlID0gMHgwMTQ5OwogdC5uYXNxdWFyZSA9IDB4MzM4MTsKIHQubmJvcG9tb2ZvID0gMHgzMTBiOwogdC5uYnNwYWNlID0gMHgwMGEwOwogdC5uY2Fyb24gPSAweDAxNDg7CiB0Lm5jZWRpbGxhID0gMHgwMTQ2OwogdC5uY2lyY2xlID0gMHgyNGRkOwogdC5uY2lyY3VtZmxleGJlbG93ID0gMHgxZTRiOwogdC5uY29tbWFhY2NlbnQgPSAweDAxNDY7CiB0Lm5kb3RhY2NlbnQgPSAweDFlNDU7CiB0Lm5kb3RiZWxvdyA9IDB4MWU0NzsKIHQubmVoaXJhZ2FuYSA9IDB4MzA2ZDsKIHQubmVrYXRha2FuYSA9IDB4MzBjZDsKIHQubmVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY4ODsKIHQubmV3c2hlcWVsc2lnbiA9IDB4MjBhYTsKIHQubmZzcXVhcmUgPSAweDMzOGI7CiB0Lm5nYWJlbmdhbGkgPSAweDA5OTk7CiB0Lm5nYWRldmEgPSAweDA5MTk7CiB0Lm5nYWd1amFyYXRpID0gMHgwYTk5OwogdC5uZ2FndXJtdWtoaSA9IDB4MGExOTsKIHQubmdvbmd1dGhhaSA9IDB4MGUwNzsKIHQubmhpcmFnYW5hID0gMHgzMDkzOwogdC5uaG9va2xlZnQgPSAweDAyNzI7CiB0Lm5ob29rcmV0cm9mbGV4ID0gMHgwMjczOwogdC5uaWV1bmFjaXJjbGVrb3JlYW4gPSAweDMyNmY7CiB0Lm5pZXVuYXBhcmVua29yZWFuID0gMHgzMjBmOwogdC5uaWV1bmNpZXVja29yZWFuID0gMHgzMTM1OwogdC5uaWV1bmNpcmNsZWtvcmVhbiA9IDB4MzI2MTsKIHQubmlldW5oaWV1aGtvcmVhbiA9IDB4MzEzNjsKIHQubmlldW5rb3JlYW4gPSAweDMxMzQ7CiB0Lm5pZXVucGFuc2lvc2tvcmVhbiA9IDB4MzE2ODsKIHQubmlldW5wYXJlbmtvcmVhbiA9IDB4MzIwMTsKIHQubmlldW5zaW9za29yZWFuID0gMHgzMTY3OwogdC5uaWV1bnRpa2V1dGtvcmVhbiA9IDB4MzE2NjsKIHQubmloaXJhZ2FuYSA9IDB4MzA2YjsKIHQubmlrYXRha2FuYSA9IDB4MzBjYjsKIHQubmlrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY4NjsKIHQubmlraGFoaXRsZWZ0dGhhaSA9IDB4Zjg5OTsKIHQubmlraGFoaXR0aGFpID0gMHgwZTRkOwogdC5uaW5lID0gMHgwMDM5OwogdC5uaW5lYXJhYmljID0gMHgwNjY5OwogdC5uaW5lYmVuZ2FsaSA9IDB4MDllZjsKIHQubmluZWNpcmNsZSA9IDB4MjQ2ODsKIHQubmluZWNpcmNsZWludmVyc2VzYW5zc2VyaWYgPSAweDI3OTI7CiB0Lm5pbmVkZXZhID0gMHgwOTZmOwogdC5uaW5lZ3VqYXJhdGkgPSAweDBhZWY7CiB0Lm5pbmVndXJtdWtoaSA9IDB4MGE2ZjsKIHQubmluZWhhY2thcmFiaWMgPSAweDA2Njk7CiB0Lm5pbmVoYW5nemhvdSA9IDB4MzAyOTsKIHQubmluZWlkZW9ncmFwaGljcGFyZW4gPSAweDMyMjg7CiB0Lm5pbmVpbmZlcmlvciA9IDB4MjA4OTsKIHQubmluZW1vbm9zcGFjZSA9IDB4ZmYxOTsKIHQubmluZW9sZHN0eWxlID0gMHhmNzM5OwogdC5uaW5lcGFyZW4gPSAweDI0N2M7CiB0Lm5pbmVwZXJpb2QgPSAweDI0OTA7CiB0Lm5pbmVwZXJzaWFuID0gMHgwNmY5OwogdC5uaW5lcm9tYW4gPSAweDIxNzg7CiB0Lm5pbmVzdXBlcmlvciA9IDB4MjA3OTsKIHQubmluZXRlZW5jaXJjbGUgPSAweDI0NzI7CiB0Lm5pbmV0ZWVucGFyZW4gPSAweDI0ODY7CiB0Lm5pbmV0ZWVucGVyaW9kID0gMHgyNDlhOwogdC5uaW5ldGhhaSA9IDB4MGU1OTsKIHQubmogPSAweDAxY2M7CiB0Lm5qZWN5cmlsbGljID0gMHgwNDVhOwogdC5ua2F0YWthbmEgPSAweDMwZjM7CiB0Lm5rYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY5ZDsKIHQubmxlZ3JpZ2h0bG9uZyA9IDB4MDE5ZTsKIHQubmxpbmViZWxvdyA9IDB4MWU0OTsKIHQubm1vbm9zcGFjZSA9IDB4ZmY0ZTsKIHQubm1zcXVhcmUgPSAweDMzOWE7CiB0Lm5uYWJlbmdhbGkgPSAweDA5YTM7CiB0Lm5uYWRldmEgPSAweDA5MjM7CiB0Lm5uYWd1amFyYXRpID0gMHgwYWEzOwogdC5ubmFndXJtdWtoaSA9IDB4MGEyMzsKIHQubm5uYWRldmEgPSAweDA5Mjk7CiB0Lm5vaGlyYWdhbmEgPSAweDMwNmU7CiB0Lm5va2F0YWthbmEgPSAweDMwY2U7CiB0Lm5va2F0YWthbmFoYWxmd2lkdGggPSAweGZmODk7CiB0Lm5vbmJyZWFraW5nc3BhY2UgPSAweDAwYTA7CiB0Lm5vbmVudGhhaSA9IDB4MGUxMzsKIHQubm9udXRoYWkgPSAweDBlMTk7CiB0Lm5vb25hcmFiaWMgPSAweDA2NDY7CiB0Lm5vb25maW5hbGFyYWJpYyA9IDB4ZmVlNjsKIHQubm9vbmdodW5uYWFyYWJpYyA9IDB4MDZiYTsKIHQubm9vbmdodW5uYWZpbmFsYXJhYmljID0gMHhmYjlmOwogdC5ub29uaW5pdGlhbGFyYWJpYyA9IDB4ZmVlNzsKIHQubm9vbmplZW1pbml0aWFsYXJhYmljID0gMHhmY2QyOwogdC5ub29uamVlbWlzb2xhdGVkYXJhYmljID0gMHhmYzRiOwogdC5ub29ubWVkaWFsYXJhYmljID0gMHhmZWU4OwogdC5ub29ubWVlbWluaXRpYWxhcmFiaWMgPSAweGZjZDU7CiB0Lm5vb25tZWVtaXNvbGF0ZWRhcmFiaWMgPSAweGZjNGU7CiB0Lm5vb25ub29uZmluYWxhcmFiaWMgPSAweGZjOGQ7CiB0Lm5vdGNvbnRhaW5zID0gMHgyMjBjOwogdC5ub3RlbGVtZW50ID0gMHgyMjA5OwogdC5ub3RlbGVtZW50b2YgPSAweDIyMDk7CiB0Lm5vdGVxdWFsID0gMHgyMjYwOwogdC5ub3RncmVhdGVyID0gMHgyMjZmOwogdC5ub3RncmVhdGVybm9yZXF1YWwgPSAweDIyNzE7CiB0Lm5vdGdyZWF0ZXJub3JsZXNzID0gMHgyMjc5OwogdC5ub3RpZGVudGljYWwgPSAweDIyNjI7CiB0Lm5vdGxlc3MgPSAweDIyNmU7CiB0Lm5vdGxlc3Nub3JlcXVhbCA9IDB4MjI3MDsKIHQubm90cGFyYWxsZWwgPSAweDIyMjY7CiB0Lm5vdHByZWNlZGVzID0gMHgyMjgwOwogdC5ub3RzdWJzZXQgPSAweDIyODQ7CiB0Lm5vdHN1Y2NlZWRzID0gMHgyMjgxOwogdC5ub3RzdXBlcnNldCA9IDB4MjI4NTsKIHQubm93YXJtZW5pYW4gPSAweDA1NzY7CiB0Lm5wYXJlbiA9IDB4MjRhOTsKIHQubnNzcXVhcmUgPSAweDMzYjE7CiB0Lm5zdXBlcmlvciA9IDB4MjA3ZjsKIHQubnRpbGRlID0gMHgwMGYxOwogdC5udSA9IDB4MDNiZDsKIHQubnVoaXJhZ2FuYSA9IDB4MzA2YzsKIHQubnVrYXRha2FuYSA9IDB4MzBjYzsKIHQubnVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY4NzsKIHQubnVrdGFiZW5nYWxpID0gMHgwOWJjOwogdC5udWt0YWRldmEgPSAweDA5M2M7CiB0Lm51a3RhZ3VqYXJhdGkgPSAweDBhYmM7CiB0Lm51a3RhZ3VybXVraGkgPSAweDBhM2M7CiB0Lm51bWJlcnNpZ24gPSAweDAwMjM7CiB0Lm51bWJlcnNpZ25tb25vc3BhY2UgPSAweGZmMDM7CiB0Lm51bWJlcnNpZ25zbWFsbCA9IDB4ZmU1ZjsKIHQubnVtZXJhbHNpZ25ncmVlayA9IDB4MDM3NDsKIHQubnVtZXJhbHNpZ25sb3dlcmdyZWVrID0gMHgwMzc1OwogdC5udW1lcm8gPSAweDIxMTY7CiB0Lm51biA9IDB4MDVlMDsKIHQubnVuZGFnZXNoID0gMHhmYjQwOwogdC5udW5kYWdlc2hoZWJyZXcgPSAweGZiNDA7CiB0Lm51bmhlYnJldyA9IDB4MDVlMDsKIHQubnZzcXVhcmUgPSAweDMzYjU7CiB0Lm53c3F1YXJlID0gMHgzM2JiOwogdC5ueWFiZW5nYWxpID0gMHgwOTllOwogdC5ueWFkZXZhID0gMHgwOTFlOwogdC5ueWFndWphcmF0aSA9IDB4MGE5ZTsKIHQubnlhZ3VybXVraGkgPSAweDBhMWU7CiB0Lm8gPSAweDAwNmY7CiB0Lm9hY3V0ZSA9IDB4MDBmMzsKIHQub2FuZ3RoYWkgPSAweDBlMmQ7CiB0Lm9iYXJyZWQgPSAweDAyNzU7CiB0Lm9iYXJyZWRjeXJpbGxpYyA9IDB4MDRlOTsKIHQub2JhcnJlZGRpZXJlc2lzY3lyaWxsaWMgPSAweDA0ZWI7CiB0Lm9iZW5nYWxpID0gMHgwOTkzOwogdC5vYm9wb21vZm8gPSAweDMxMWI7CiB0Lm9icmV2ZSA9IDB4MDE0ZjsKIHQub2NhbmRyYWRldmEgPSAweDA5MTE7CiB0Lm9jYW5kcmFndWphcmF0aSA9IDB4MGE5MTsKIHQub2NhbmRyYXZvd2Vsc2lnbmRldmEgPSAweDA5NDk7CiB0Lm9jYW5kcmF2b3dlbHNpZ25ndWphcmF0aSA9IDB4MGFjOTsKIHQub2Nhcm9uID0gMHgwMWQyOwogdC5vY2lyY2xlID0gMHgyNGRlOwogdC5vY2lyY3VtZmxleCA9IDB4MDBmNDsKIHQub2NpcmN1bWZsZXhhY3V0ZSA9IDB4MWVkMTsKIHQub2NpcmN1bWZsZXhkb3RiZWxvdyA9IDB4MWVkOTsKIHQub2NpcmN1bWZsZXhncmF2ZSA9IDB4MWVkMzsKIHQub2NpcmN1bWZsZXhob29rYWJvdmUgPSAweDFlZDU7CiB0Lm9jaXJjdW1mbGV4dGlsZGUgPSAweDFlZDc7CiB0Lm9jeXJpbGxpYyA9IDB4MDQzZTsKIHQub2RibGFjdXRlID0gMHgwMTUxOwogdC5vZGJsZ3JhdmUgPSAweDAyMGQ7CiB0Lm9kZXZhID0gMHgwOTEzOwogdC5vZGllcmVzaXMgPSAweDAwZjY7CiB0Lm9kaWVyZXNpc2N5cmlsbGljID0gMHgwNGU3OwogdC5vZG90YmVsb3cgPSAweDFlY2Q7CiB0Lm9lID0gMHgwMTUzOwogdC5vZWtvcmVhbiA9IDB4MzE1YTsKIHQub2dvbmVrID0gMHgwMmRiOwogdC5vZ29uZWtjbWIgPSAweDAzMjg7CiB0Lm9ncmF2ZSA9IDB4MDBmMjsKIHQub2d1amFyYXRpID0gMHgwYTkzOwogdC5vaGFybWVuaWFuID0gMHgwNTg1OwogdC5vaGlyYWdhbmEgPSAweDMwNGE7CiB0Lm9ob29rYWJvdmUgPSAweDFlY2Y7CiB0Lm9ob3JuID0gMHgwMWExOwogdC5vaG9ybmFjdXRlID0gMHgxZWRiOwogdC5vaG9ybmRvdGJlbG93ID0gMHgxZWUzOwogdC5vaG9ybmdyYXZlID0gMHgxZWRkOwogdC5vaG9ybmhvb2thYm92ZSA9IDB4MWVkZjsKIHQub2hvcm50aWxkZSA9IDB4MWVlMTsKIHQub2h1bmdhcnVtbGF1dCA9IDB4MDE1MTsKIHQub2kgPSAweDAxYTM7CiB0Lm9pbnZlcnRlZGJyZXZlID0gMHgwMjBmOwogdC5va2F0YWthbmEgPSAweDMwYWE7CiB0Lm9rYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY3NTsKIHQub2tvcmVhbiA9IDB4MzE1NzsKIHQub2xlaGVicmV3ID0gMHgwNWFiOwogdC5vbWFjcm9uID0gMHgwMTRkOwogdC5vbWFjcm9uYWN1dGUgPSAweDFlNTM7CiB0Lm9tYWNyb25ncmF2ZSA9IDB4MWU1MTsKIHQub21kZXZhID0gMHgwOTUwOwogdC5vbWVnYSA9IDB4MDNjOTsKIHQub21lZ2ExID0gMHgwM2Q2OwogdC5vbWVnYWN5cmlsbGljID0gMHgwNDYxOwogdC5vbWVnYWxhdGluY2xvc2VkID0gMHgwMjc3OwogdC5vbWVnYXJvdW5kY3lyaWxsaWMgPSAweDA0N2I7CiB0Lm9tZWdhdGl0bG9jeXJpbGxpYyA9IDB4MDQ3ZDsKIHQub21lZ2F0b25vcyA9IDB4MDNjZTsKIHQub21ndWphcmF0aSA9IDB4MGFkMDsKIHQub21pY3JvbiA9IDB4MDNiZjsKIHQub21pY3JvbnRvbm9zID0gMHgwM2NjOwogdC5vbW9ub3NwYWNlID0gMHhmZjRmOwogdC5vbmUgPSAweDAwMzE7CiB0Lm9uZWFyYWJpYyA9IDB4MDY2MTsKIHQub25lYmVuZ2FsaSA9IDB4MDllNzsKIHQub25lY2lyY2xlID0gMHgyNDYwOwogdC5vbmVjaXJjbGVpbnZlcnNlc2Fuc3NlcmlmID0gMHgyNzhhOwogdC5vbmVkZXZhID0gMHgwOTY3OwogdC5vbmVkb3RlbmxlYWRlciA9IDB4MjAyNDsKIHQub25lZWlnaHRoID0gMHgyMTViOwogdC5vbmVmaXR0ZWQgPSAweGY2ZGM7CiB0Lm9uZWd1amFyYXRpID0gMHgwYWU3OwogdC5vbmVndXJtdWtoaSA9IDB4MGE2NzsKIHQub25laGFja2FyYWJpYyA9IDB4MDY2MTsKIHQub25laGFsZiA9IDB4MDBiZDsKIHQub25laGFuZ3pob3UgPSAweDMwMjE7CiB0Lm9uZWlkZW9ncmFwaGljcGFyZW4gPSAweDMyMjA7CiB0Lm9uZWluZmVyaW9yID0gMHgyMDgxOwogdC5vbmVtb25vc3BhY2UgPSAweGZmMTE7CiB0Lm9uZW51bWVyYXRvcmJlbmdhbGkgPSAweDA5ZjQ7CiB0Lm9uZW9sZHN0eWxlID0gMHhmNzMxOwogdC5vbmVwYXJlbiA9IDB4MjQ3NDsKIHQub25lcGVyaW9kID0gMHgyNDg4OwogdC5vbmVwZXJzaWFuID0gMHgwNmYxOwogdC5vbmVxdWFydGVyID0gMHgwMGJjOwogdC5vbmVyb21hbiA9IDB4MjE3MDsKIHQub25lc3VwZXJpb3IgPSAweDAwYjk7CiB0Lm9uZXRoYWkgPSAweDBlNTE7CiB0Lm9uZXRoaXJkID0gMHgyMTUzOwogdC5vb2dvbmVrID0gMHgwMWViOwogdC5vb2dvbmVrbWFjcm9uID0gMHgwMWVkOwogdC5vb2d1cm11a2hpID0gMHgwYTEzOwogdC5vb21hdHJhZ3VybXVraGkgPSAweDBhNGI7CiB0Lm9vcGVuID0gMHgwMjU0OwogdC5vcGFyZW4gPSAweDI0YWE7CiB0Lm9wZW5idWxsZXQgPSAweDI1ZTY7CiB0Lm9wdGlvbiA9IDB4MjMyNTsKIHQub3JkZmVtaW5pbmUgPSAweDAwYWE7CiB0Lm9yZG1hc2N1bGluZSA9IDB4MDBiYTsKIHQub3J0aG9nb25hbCA9IDB4MjIxZjsKIHQub3Nob3J0ZGV2YSA9IDB4MDkxMjsKIHQub3Nob3J0dm93ZWxzaWduZGV2YSA9IDB4MDk0YTsKIHQub3NsYXNoID0gMHgwMGY4OwogdC5vc2xhc2hhY3V0ZSA9IDB4MDFmZjsKIHQub3NtYWxsaGlyYWdhbmEgPSAweDMwNDk7CiB0Lm9zbWFsbGthdGFrYW5hID0gMHgzMGE5OwogdC5vc21hbGxrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY2YjsKIHQub3N0cm9rZWFjdXRlID0gMHgwMWZmOwogdC5vc3VwZXJpb3IgPSAweGY2ZjA7CiB0Lm90Y3lyaWxsaWMgPSAweDA0N2Y7CiB0Lm90aWxkZSA9IDB4MDBmNTsKIHQub3RpbGRlYWN1dGUgPSAweDFlNGQ7CiB0Lm90aWxkZWRpZXJlc2lzID0gMHgxZTRmOwogdC5vdWJvcG9tb2ZvID0gMHgzMTIxOwogdC5vdmVybGluZSA9IDB4MjAzZTsKIHQub3ZlcmxpbmVjZW50ZXJsaW5lID0gMHhmZTRhOwogdC5vdmVybGluZWNtYiA9IDB4MDMwNTsKIHQub3ZlcmxpbmVkYXNoZWQgPSAweGZlNDk7CiB0Lm92ZXJsaW5lZGJsd2F2eSA9IDB4ZmU0YzsKIHQub3ZlcmxpbmV3YXZ5ID0gMHhmZTRiOwogdC5vdmVyc2NvcmUgPSAweDAwYWY7CiB0Lm92b3dlbHNpZ25iZW5nYWxpID0gMHgwOWNiOwogdC5vdm93ZWxzaWduZGV2YSA9IDB4MDk0YjsKIHQub3Zvd2Vsc2lnbmd1amFyYXRpID0gMHgwYWNiOwogdC5wID0gMHgwMDcwOwogdC5wYWFtcHNzcXVhcmUgPSAweDMzODA7CiB0LnBhYXNlbnRvc3F1YXJlID0gMHgzMzJiOwogdC5wYWJlbmdhbGkgPSAweDA5YWE7CiB0LnBhY3V0ZSA9IDB4MWU1NTsKIHQucGFkZXZhID0gMHgwOTJhOwogdC5wYWdlZG93biA9IDB4MjFkZjsKIHQucGFnZXVwID0gMHgyMWRlOwogdC5wYWd1amFyYXRpID0gMHgwYWFhOwogdC5wYWd1cm11a2hpID0gMHgwYTJhOwogdC5wYWhpcmFnYW5hID0gMHgzMDcxOwogdC5wYWl5YW5ub2l0aGFpID0gMHgwZTJmOwogdC5wYWthdGFrYW5hID0gMHgzMGQxOwogdC5wYWxhdGFsaXphdGlvbmN5cmlsbGljY21iID0gMHgwNDg0OwogdC5wYWxvY2hrYWN5cmlsbGljID0gMHgwNGMwOwogdC5wYW5zaW9za29yZWFuID0gMHgzMTdmOwogdC5wYXJhZ3JhcGggPSAweDAwYjY7CiB0LnBhcmFsbGVsID0gMHgyMjI1OwogdC5wYXJlbmxlZnQgPSAweDAwMjg7CiB0LnBhcmVubGVmdGFsdG9uZWFyYWJpYyA9IDB4ZmQzZTsKIHQucGFyZW5sZWZ0YnQgPSAweGY4ZWQ7CiB0LnBhcmVubGVmdGV4ID0gMHhmOGVjOwogdC5wYXJlbmxlZnRpbmZlcmlvciA9IDB4MjA4ZDsKIHQucGFyZW5sZWZ0bW9ub3NwYWNlID0gMHhmZjA4OwogdC5wYXJlbmxlZnRzbWFsbCA9IDB4ZmU1OTsKIHQucGFyZW5sZWZ0c3VwZXJpb3IgPSAweDIwN2Q7CiB0LnBhcmVubGVmdHRwID0gMHhmOGViOwogdC5wYXJlbmxlZnR2ZXJ0aWNhbCA9IDB4ZmUzNTsKIHQucGFyZW5yaWdodCA9IDB4MDAyOTsKIHQucGFyZW5yaWdodGFsdG9uZWFyYWJpYyA9IDB4ZmQzZjsKIHQucGFyZW5yaWdodGJ0ID0gMHhmOGY4OwogdC5wYXJlbnJpZ2h0ZXggPSAweGY4Zjc7CiB0LnBhcmVucmlnaHRpbmZlcmlvciA9IDB4MjA4ZTsKIHQucGFyZW5yaWdodG1vbm9zcGFjZSA9IDB4ZmYwOTsKIHQucGFyZW5yaWdodHNtYWxsID0gMHhmZTVhOwogdC5wYXJlbnJpZ2h0c3VwZXJpb3IgPSAweDIwN2U7CiB0LnBhcmVucmlnaHR0cCA9IDB4ZjhmNjsKIHQucGFyZW5yaWdodHZlcnRpY2FsID0gMHhmZTM2OwogdC5wYXJ0aWFsZGlmZiA9IDB4MjIwMjsKIHQucGFzZXFoZWJyZXcgPSAweDA1YzA7CiB0LnBhc2h0YWhlYnJldyA9IDB4MDU5OTsKIHQucGFzcXVhcmUgPSAweDMzYTk7CiB0LnBhdGFoID0gMHgwNWI3OwogdC5wYXRhaDExID0gMHgwNWI3OwogdC5wYXRhaDFkID0gMHgwNWI3OwogdC5wYXRhaDJhID0gMHgwNWI3OwogdC5wYXRhaGhlYnJldyA9IDB4MDViNzsKIHQucGF0YWhuYXJyb3doZWJyZXcgPSAweDA1Yjc7CiB0LnBhdGFocXVhcnRlcmhlYnJldyA9IDB4MDViNzsKIHQucGF0YWh3aWRlaGVicmV3ID0gMHgwNWI3OwogdC5wYXplcmhlYnJldyA9IDB4MDVhMTsKIHQucGJvcG9tb2ZvID0gMHgzMTA2OwogdC5wY2lyY2xlID0gMHgyNGRmOwogdC5wZG90YWNjZW50ID0gMHgxZTU3OwogdC5wZSA9IDB4MDVlNDsKIHQucGVjeXJpbGxpYyA9IDB4MDQzZjsKIHQucGVkYWdlc2ggPSAweGZiNDQ7CiB0LnBlZGFnZXNoaGVicmV3ID0gMHhmYjQ0OwogdC5wZWV6aXNxdWFyZSA9IDB4MzMzYjsKIHQucGVmaW5hbGRhZ2VzaGhlYnJldyA9IDB4ZmI0MzsKIHQucGVoYXJhYmljID0gMHgwNjdlOwogdC5wZWhhcm1lbmlhbiA9IDB4MDU3YTsKIHQucGVoZWJyZXcgPSAweDA1ZTQ7CiB0LnBlaGZpbmFsYXJhYmljID0gMHhmYjU3OwogdC5wZWhpbml0aWFsYXJhYmljID0gMHhmYjU4OwogdC5wZWhpcmFnYW5hID0gMHgzMDdhOwogdC5wZWhtZWRpYWxhcmFiaWMgPSAweGZiNTk7CiB0LnBla2F0YWthbmEgPSAweDMwZGE7CiB0LnBlbWlkZGxlaG9va2N5cmlsbGljID0gMHgwNGE3OwogdC5wZXJhZmVoZWJyZXcgPSAweGZiNGU7CiB0LnBlcmNlbnQgPSAweDAwMjU7CiB0LnBlcmNlbnRhcmFiaWMgPSAweDA2NmE7CiB0LnBlcmNlbnRtb25vc3BhY2UgPSAweGZmMDU7CiB0LnBlcmNlbnRzbWFsbCA9IDB4ZmU2YTsKIHQucGVyaW9kID0gMHgwMDJlOwogdC5wZXJpb2Rhcm1lbmlhbiA9IDB4MDU4OTsKIHQucGVyaW9kY2VudGVyZWQgPSAweDAwYjc7CiB0LnBlcmlvZGhhbGZ3aWR0aCA9IDB4ZmY2MTsKIHQucGVyaW9kaW5mZXJpb3IgPSAweGY2ZTc7CiB0LnBlcmlvZG1vbm9zcGFjZSA9IDB4ZmYwZTsKIHQucGVyaW9kc21hbGwgPSAweGZlNTI7CiB0LnBlcmlvZHN1cGVyaW9yID0gMHhmNmU4OwogdC5wZXJpc3BvbWVuaWdyZWVrY21iID0gMHgwMzQyOwogdC5wZXJwZW5kaWN1bGFyID0gMHgyMmE1OwogdC5wZXJ0aG91c2FuZCA9IDB4MjAzMDsKIHQucGVzZXRhID0gMHgyMGE3OwogdC5wZnNxdWFyZSA9IDB4MzM4YTsKIHQucGhhYmVuZ2FsaSA9IDB4MDlhYjsKIHQucGhhZGV2YSA9IDB4MDkyYjsKIHQucGhhZ3VqYXJhdGkgPSAweDBhYWI7CiB0LnBoYWd1cm11a2hpID0gMHgwYTJiOwogdC5waGkgPSAweDAzYzY7CiB0LnBoaTEgPSAweDAzZDU7CiB0LnBoaWV1cGhhY2lyY2xla29yZWFuID0gMHgzMjdhOwogdC5waGlldXBoYXBhcmVua29yZWFuID0gMHgzMjFhOwogdC5waGlldXBoY2lyY2xla29yZWFuID0gMHgzMjZjOwogdC5waGlldXBoa29yZWFuID0gMHgzMTRkOwogdC5waGlldXBocGFyZW5rb3JlYW4gPSAweDMyMGM7CiB0LnBoaWxhdGluID0gMHgwMjc4OwogdC5waGludGh1dGhhaSA9IDB4MGUzYTsKIHQucGhpc3ltYm9sZ3JlZWsgPSAweDAzZDU7CiB0LnBob29rID0gMHgwMWE1OwogdC5waG9waGFudGhhaSA9IDB4MGUxZTsKIHQucGhvcGh1bmd0aGFpID0gMHgwZTFjOwogdC5waG9zYW1waGFvdGhhaSA9IDB4MGUyMDsKIHQucGkgPSAweDAzYzA7CiB0LnBpZXVwYWNpcmNsZWtvcmVhbiA9IDB4MzI3MzsKIHQucGlldXBhcGFyZW5rb3JlYW4gPSAweDMyMTM7CiB0LnBpZXVwY2lldWNrb3JlYW4gPSAweDMxNzY7CiB0LnBpZXVwY2lyY2xla29yZWFuID0gMHgzMjY1OwogdC5waWV1cGtpeWVva2tvcmVhbiA9IDB4MzE3MjsKIHQucGlldXBrb3JlYW4gPSAweDMxNDI7CiB0LnBpZXVwcGFyZW5rb3JlYW4gPSAweDMyMDU7CiB0LnBpZXVwc2lvc2tpeWVva2tvcmVhbiA9IDB4MzE3NDsKIHQucGlldXBzaW9za29yZWFuID0gMHgzMTQ0OwogdC5waWV1cHNpb3N0aWtldXRrb3JlYW4gPSAweDMxNzU7CiB0LnBpZXVwdGhpZXV0aGtvcmVhbiA9IDB4MzE3NzsKIHQucGlldXB0aWtldXRrb3JlYW4gPSAweDMxNzM7CiB0LnBpaGlyYWdhbmEgPSAweDMwNzQ7CiB0LnBpa2F0YWthbmEgPSAweDMwZDQ7CiB0LnBpc3ltYm9sZ3JlZWsgPSAweDAzZDY7CiB0LnBpd3Jhcm1lbmlhbiA9IDB4MDU4MzsKIHQucGx1cyA9IDB4MDAyYjsKIHQucGx1c2JlbG93Y21iID0gMHgwMzFmOwogdC5wbHVzY2lyY2xlID0gMHgyMjk1OwogdC5wbHVzbWludXMgPSAweDAwYjE7CiB0LnBsdXNtb2QgPSAweDAyZDY7CiB0LnBsdXNtb25vc3BhY2UgPSAweGZmMGI7CiB0LnBsdXNzbWFsbCA9IDB4ZmU2MjsKIHQucGx1c3N1cGVyaW9yID0gMHgyMDdhOwogdC5wbW9ub3NwYWNlID0gMHhmZjUwOwogdC5wbXNxdWFyZSA9IDB4MzNkODsKIHQucG9oaXJhZ2FuYSA9IDB4MzA3ZDsKIHQucG9pbnRpbmdpbmRleGRvd253aGl0ZSA9IDB4MjYxZjsKIHQucG9pbnRpbmdpbmRleGxlZnR3aGl0ZSA9IDB4MjYxYzsKIHQucG9pbnRpbmdpbmRleHJpZ2h0d2hpdGUgPSAweDI2MWU7CiB0LnBvaW50aW5naW5kZXh1cHdoaXRlID0gMHgyNjFkOwogdC5wb2thdGFrYW5hID0gMHgzMGRkOwogdC5wb3BsYXRoYWkgPSAweDBlMWI7CiB0LnBvc3RhbG1hcmsgPSAweDMwMTI7CiB0LnBvc3RhbG1hcmtmYWNlID0gMHgzMDIwOwogdC5wcGFyZW4gPSAweDI0YWI7CiB0LnByZWNlZGVzID0gMHgyMjdhOwogdC5wcmVzY3JpcHRpb24gPSAweDIxMWU7CiB0LnByaW1lbW9kID0gMHgwMmI5OwogdC5wcmltZXJldmVyc2VkID0gMHgyMDM1OwogdC5wcm9kdWN0ID0gMHgyMjBmOwogdC5wcm9qZWN0aXZlID0gMHgyMzA1OwogdC5wcm9sb25nZWRrYW5hID0gMHgzMGZjOwogdC5wcm9wZWxsb3IgPSAweDIzMTg7CiB0LnByb3BlcnN1YnNldCA9IDB4MjI4MjsKIHQucHJvcGVyc3VwZXJzZXQgPSAweDIyODM7CiB0LnByb3BvcnRpb24gPSAweDIyMzc7CiB0LnByb3BvcnRpb25hbCA9IDB4MjIxZDsKIHQucHNpID0gMHgwM2M4OwogdC5wc2ljeXJpbGxpYyA9IDB4MDQ3MTsKIHQucHNpbGlwbmV1bWF0YWN5cmlsbGljY21iID0gMHgwNDg2OwogdC5wc3NxdWFyZSA9IDB4MzNiMDsKIHQucHVoaXJhZ2FuYSA9IDB4MzA3NzsKIHQucHVrYXRha2FuYSA9IDB4MzBkNzsKIHQucHZzcXVhcmUgPSAweDMzYjQ7CiB0LnB3c3F1YXJlID0gMHgzM2JhOwogdC5xID0gMHgwMDcxOwogdC5xYWRldmEgPSAweDA5NTg7CiB0LnFhZG1haGVicmV3ID0gMHgwNWE4OwogdC5xYWZhcmFiaWMgPSAweDA2NDI7CiB0LnFhZmZpbmFsYXJhYmljID0gMHhmZWQ2OwogdC5xYWZpbml0aWFsYXJhYmljID0gMHhmZWQ3OwogdC5xYWZtZWRpYWxhcmFiaWMgPSAweGZlZDg7CiB0LnFhbWF0cyA9IDB4MDViODsKIHQucWFtYXRzMTAgPSAweDA1Yjg7CiB0LnFhbWF0czFhID0gMHgwNWI4OwogdC5xYW1hdHMxYyA9IDB4MDViODsKIHQucWFtYXRzMjcgPSAweDA1Yjg7CiB0LnFhbWF0czI5ID0gMHgwNWI4OwogdC5xYW1hdHMzMyA9IDB4MDViODsKIHQucWFtYXRzZGUgPSAweDA1Yjg7CiB0LnFhbWF0c2hlYnJldyA9IDB4MDViODsKIHQucWFtYXRzbmFycm93aGVicmV3ID0gMHgwNWI4OwogdC5xYW1hdHNxYXRhbmhlYnJldyA9IDB4MDViODsKIHQucWFtYXRzcWF0YW5uYXJyb3doZWJyZXcgPSAweDA1Yjg7CiB0LnFhbWF0c3FhdGFucXVhcnRlcmhlYnJldyA9IDB4MDViODsKIHQucWFtYXRzcWF0YW53aWRlaGVicmV3ID0gMHgwNWI4OwogdC5xYW1hdHNxdWFydGVyaGVicmV3ID0gMHgwNWI4OwogdC5xYW1hdHN3aWRlaGVicmV3ID0gMHgwNWI4OwogdC5xYXJuZXlwYXJhaGVicmV3ID0gMHgwNTlmOwogdC5xYm9wb21vZm8gPSAweDMxMTE7CiB0LnFjaXJjbGUgPSAweDI0ZTA7CiB0LnFob29rID0gMHgwMmEwOwogdC5xbW9ub3NwYWNlID0gMHhmZjUxOwogdC5xb2YgPSAweDA1ZTc7CiB0LnFvZmRhZ2VzaCA9IDB4ZmI0NzsKIHQucW9mZGFnZXNoaGVicmV3ID0gMHhmYjQ3OwogdC5xb2ZoZWJyZXcgPSAweDA1ZTc7CiB0LnFwYXJlbiA9IDB4MjRhYzsKIHQucXVhcnRlcm5vdGUgPSAweDI2Njk7CiB0LnF1YnV0cyA9IDB4MDViYjsKIHQucXVidXRzMTggPSAweDA1YmI7CiB0LnF1YnV0czI1ID0gMHgwNWJiOwogdC5xdWJ1dHMzMSA9IDB4MDViYjsKIHQucXVidXRzaGVicmV3ID0gMHgwNWJiOwogdC5xdWJ1dHNuYXJyb3doZWJyZXcgPSAweDA1YmI7CiB0LnF1YnV0c3F1YXJ0ZXJoZWJyZXcgPSAweDA1YmI7CiB0LnF1YnV0c3dpZGVoZWJyZXcgPSAweDA1YmI7CiB0LnF1ZXN0aW9uID0gMHgwMDNmOwogdC5xdWVzdGlvbmFyYWJpYyA9IDB4MDYxZjsKIHQucXVlc3Rpb25hcm1lbmlhbiA9IDB4MDU1ZTsKIHQucXVlc3Rpb25kb3duID0gMHgwMGJmOwogdC5xdWVzdGlvbmRvd25zbWFsbCA9IDB4ZjdiZjsKIHQucXVlc3Rpb25ncmVlayA9IDB4MDM3ZTsKIHQucXVlc3Rpb25tb25vc3BhY2UgPSAweGZmMWY7CiB0LnF1ZXN0aW9uc21hbGwgPSAweGY3M2Y7CiB0LnF1b3RlZGJsID0gMHgwMDIyOwogdC5xdW90ZWRibGJhc2UgPSAweDIwMWU7CiB0LnF1b3RlZGJsbGVmdCA9IDB4MjAxYzsKIHQucXVvdGVkYmxtb25vc3BhY2UgPSAweGZmMDI7CiB0LnF1b3RlZGJscHJpbWUgPSAweDMwMWU7CiB0LnF1b3RlZGJscHJpbWVyZXZlcnNlZCA9IDB4MzAxZDsKIHQucXVvdGVkYmxyaWdodCA9IDB4MjAxZDsKIHQucXVvdGVsZWZ0ID0gMHgyMDE4OwogdC5xdW90ZWxlZnRyZXZlcnNlZCA9IDB4MjAxYjsKIHQucXVvdGVyZXZlcnNlZCA9IDB4MjAxYjsKIHQucXVvdGVyaWdodCA9IDB4MjAxOTsKIHQucXVvdGVyaWdodG4gPSAweDAxNDk7CiB0LnF1b3Rlc2luZ2xiYXNlID0gMHgyMDFhOwogdC5xdW90ZXNpbmdsZSA9IDB4MDAyNzsKIHQucXVvdGVzaW5nbGVtb25vc3BhY2UgPSAweGZmMDc7CiB0LnIgPSAweDAwNzI7CiB0LnJhYXJtZW5pYW4gPSAweDA1N2M7CiB0LnJhYmVuZ2FsaSA9IDB4MDliMDsKIHQucmFjdXRlID0gMHgwMTU1OwogdC5yYWRldmEgPSAweDA5MzA7CiB0LnJhZGljYWwgPSAweDIyMWE7CiB0LnJhZGljYWxleCA9IDB4ZjhlNTsKIHQucmFkb3ZlcnNzcXVhcmUgPSAweDMzYWU7CiB0LnJhZG92ZXJzc3F1YXJlZHNxdWFyZSA9IDB4MzNhZjsKIHQucmFkc3F1YXJlID0gMHgzM2FkOwogdC5yYWZlID0gMHgwNWJmOwogdC5yYWZlaGVicmV3ID0gMHgwNWJmOwogdC5yYWd1amFyYXRpID0gMHgwYWIwOwogdC5yYWd1cm11a2hpID0gMHgwYTMwOwogdC5yYWhpcmFnYW5hID0gMHgzMDg5OwogdC5yYWthdGFrYW5hID0gMHgzMGU5OwogdC5yYWthdGFrYW5haGFsZndpZHRoID0gMHhmZjk3OwogdC5yYWxvd2VyZGlhZ29uYWxiZW5nYWxpID0gMHgwOWYxOwogdC5yYW1pZGRsZWRpYWdvbmFsYmVuZ2FsaSA9IDB4MDlmMDsKIHQucmFtc2hvcm4gPSAweDAyNjQ7CiB0LnJhdGlvID0gMHgyMjM2OwogdC5yYm9wb21vZm8gPSAweDMxMTY7CiB0LnJjYXJvbiA9IDB4MDE1OTsKIHQucmNlZGlsbGEgPSAweDAxNTc7CiB0LnJjaXJjbGUgPSAweDI0ZTE7CiB0LnJjb21tYWFjY2VudCA9IDB4MDE1NzsKIHQucmRibGdyYXZlID0gMHgwMjExOwogdC5yZG90YWNjZW50ID0gMHgxZTU5OwogdC5yZG90YmVsb3cgPSAweDFlNWI7CiB0LnJkb3RiZWxvd21hY3JvbiA9IDB4MWU1ZDsKIHQucmVmZXJlbmNlbWFyayA9IDB4MjAzYjsKIHQucmVmbGV4c3Vic2V0ID0gMHgyMjg2OwogdC5yZWZsZXhzdXBlcnNldCA9IDB4MjI4NzsKIHQucmVnaXN0ZXJlZCA9IDB4MDBhZTsKIHQucmVnaXN0ZXJzYW5zID0gMHhmOGU4OwogdC5yZWdpc3RlcnNlcmlmID0gMHhmNmRhOwogdC5yZWhhcmFiaWMgPSAweDA2MzE7CiB0LnJlaGFybWVuaWFuID0gMHgwNTgwOwogdC5yZWhmaW5hbGFyYWJpYyA9IDB4ZmVhZTsKIHQucmVoaXJhZ2FuYSA9IDB4MzA4YzsKIHQucmVrYXRha2FuYSA9IDB4MzBlYzsKIHQucmVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY5YTsKIHQucmVzaCA9IDB4MDVlODsKIHQucmVzaGRhZ2VzaGhlYnJldyA9IDB4ZmI0ODsKIHQucmVzaGhlYnJldyA9IDB4MDVlODsKIHQucmV2ZXJzZWR0aWxkZSA9IDB4MjIzZDsKIHQucmV2aWFoZWJyZXcgPSAweDA1OTc7CiB0LnJldmlhbXVncmFzaGhlYnJldyA9IDB4MDU5NzsKIHQucmV2bG9naWNhbG5vdCA9IDB4MjMxMDsKIHQucmZpc2hob29rID0gMHgwMjdlOwogdC5yZmlzaGhvb2tyZXZlcnNlZCA9IDB4MDI3ZjsKIHQucmhhYmVuZ2FsaSA9IDB4MDlkZDsKIHQucmhhZGV2YSA9IDB4MDk1ZDsKIHQucmhvID0gMHgwM2MxOwogdC5yaG9vayA9IDB4MDI3ZDsKIHQucmhvb2t0dXJuZWQgPSAweDAyN2I7CiB0LnJob29rdHVybmVkc3VwZXJpb3IgPSAweDAyYjU7CiB0LnJob3N5bWJvbGdyZWVrID0gMHgwM2YxOwogdC5yaG90aWNob29rbW9kID0gMHgwMmRlOwogdC5yaWV1bGFjaXJjbGVrb3JlYW4gPSAweDMyNzE7CiB0LnJpZXVsYXBhcmVua29yZWFuID0gMHgzMjExOwogdC5yaWV1bGNpcmNsZWtvcmVhbiA9IDB4MzI2MzsKIHQucmlldWxoaWV1aGtvcmVhbiA9IDB4MzE0MDsKIHQucmlldWxraXllb2trb3JlYW4gPSAweDMxM2E7CiB0LnJpZXVsa2l5ZW9rc2lvc2tvcmVhbiA9IDB4MzE2OTsKIHQucmlldWxrb3JlYW4gPSAweDMxMzk7CiB0LnJpZXVsbWlldW1rb3JlYW4gPSAweDMxM2I7CiB0LnJpZXVscGFuc2lvc2tvcmVhbiA9IDB4MzE2YzsKIHQucmlldWxwYXJlbmtvcmVhbiA9IDB4MzIwMzsKIHQucmlldWxwaGlldXBoa29yZWFuID0gMHgzMTNmOwogdC5yaWV1bHBpZXVwa29yZWFuID0gMHgzMTNjOwogdC5yaWV1bHBpZXVwc2lvc2tvcmVhbiA9IDB4MzE2YjsKIHQucmlldWxzaW9za29yZWFuID0gMHgzMTNkOwogdC5yaWV1bHRoaWV1dGhrb3JlYW4gPSAweDMxM2U7CiB0LnJpZXVsdGlrZXV0a29yZWFuID0gMHgzMTZhOwogdC5yaWV1bHllb3JpbmhpZXVoa29yZWFuID0gMHgzMTZkOwogdC5yaWdodGFuZ2xlID0gMHgyMjFmOwogdC5yaWdodHRhY2tiZWxvd2NtYiA9IDB4MDMxOTsKIHQucmlnaHR0cmlhbmdsZSA9IDB4MjJiZjsKIHQucmloaXJhZ2FuYSA9IDB4MzA4YTsKIHQucmlrYXRha2FuYSA9IDB4MzBlYTsKIHQucmlrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY5ODsKIHQucmluZyA9IDB4MDJkYTsKIHQucmluZ2JlbG93Y21iID0gMHgwMzI1OwogdC5yaW5nY21iID0gMHgwMzBhOwogdC5yaW5naGFsZmxlZnQgPSAweDAyYmY7CiB0LnJpbmdoYWxmbGVmdGFybWVuaWFuID0gMHgwNTU5OwogdC5yaW5naGFsZmxlZnRiZWxvd2NtYiA9IDB4MDMxYzsKIHQucmluZ2hhbGZsZWZ0Y2VudGVyZWQgPSAweDAyZDM7CiB0LnJpbmdoYWxmcmlnaHQgPSAweDAyYmU7CiB0LnJpbmdoYWxmcmlnaHRiZWxvd2NtYiA9IDB4MDMzOTsKIHQucmluZ2hhbGZyaWdodGNlbnRlcmVkID0gMHgwMmQyOwogdC5yaW52ZXJ0ZWRicmV2ZSA9IDB4MDIxMzsKIHQucml0dG9ydXNxdWFyZSA9IDB4MzM1MTsKIHQucmxpbmViZWxvdyA9IDB4MWU1ZjsKIHQucmxvbmdsZWcgPSAweDAyN2M7CiB0LnJsb25nbGVndHVybmVkID0gMHgwMjdhOwogdC5ybW9ub3NwYWNlID0gMHhmZjUyOwogdC5yb2hpcmFnYW5hID0gMHgzMDhkOwogdC5yb2thdGFrYW5hID0gMHgzMGVkOwogdC5yb2thdGFrYW5haGFsZndpZHRoID0gMHhmZjliOwogdC5yb3J1YXRoYWkgPSAweDBlMjM7CiB0LnJwYXJlbiA9IDB4MjRhZDsKIHQucnJhYmVuZ2FsaSA9IDB4MDlkYzsKIHQucnJhZGV2YSA9IDB4MDkzMTsKIHQucnJhZ3VybXVraGkgPSAweDBhNWM7CiB0LnJyZWhhcmFiaWMgPSAweDA2OTE7CiB0LnJyZWhmaW5hbGFyYWJpYyA9IDB4ZmI4ZDsKIHQucnJ2b2NhbGljYmVuZ2FsaSA9IDB4MDllMDsKIHQucnJ2b2NhbGljZGV2YSA9IDB4MDk2MDsKIHQucnJ2b2NhbGljZ3VqYXJhdGkgPSAweDBhZTA7CiB0LnJydm9jYWxpY3Zvd2Vsc2lnbmJlbmdhbGkgPSAweDA5YzQ7CiB0LnJydm9jYWxpY3Zvd2Vsc2lnbmRldmEgPSAweDA5NDQ7CiB0LnJydm9jYWxpY3Zvd2Vsc2lnbmd1amFyYXRpID0gMHgwYWM0OwogdC5yc3VwZXJpb3IgPSAweGY2ZjE7CiB0LnJ0YmxvY2sgPSAweDI1OTA7CiB0LnJ0dXJuZWQgPSAweDAyNzk7CiB0LnJ0dXJuZWRzdXBlcmlvciA9IDB4MDJiNDsKIHQucnVoaXJhZ2FuYSA9IDB4MzA4YjsKIHQucnVrYXRha2FuYSA9IDB4MzBlYjsKIHQucnVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY5OTsKIHQucnVwZWVtYXJrYmVuZ2FsaSA9IDB4MDlmMjsKIHQucnVwZWVzaWduYmVuZ2FsaSA9IDB4MDlmMzsKIHQucnVwaWFoID0gMHhmNmRkOwogdC5ydXRoYWkgPSAweDBlMjQ7CiB0LnJ2b2NhbGljYmVuZ2FsaSA9IDB4MDk4YjsKIHQucnZvY2FsaWNkZXZhID0gMHgwOTBiOwogdC5ydm9jYWxpY2d1amFyYXRpID0gMHgwYThiOwogdC5ydm9jYWxpY3Zvd2Vsc2lnbmJlbmdhbGkgPSAweDA5YzM7CiB0LnJ2b2NhbGljdm93ZWxzaWduZGV2YSA9IDB4MDk0MzsKIHQucnZvY2FsaWN2b3dlbHNpZ25ndWphcmF0aSA9IDB4MGFjMzsKIHQucyA9IDB4MDA3MzsKIHQuc2FiZW5nYWxpID0gMHgwOWI4OwogdC5zYWN1dGUgPSAweDAxNWI7CiB0LnNhY3V0ZWRvdGFjY2VudCA9IDB4MWU2NTsKIHQuc2FkYXJhYmljID0gMHgwNjM1OwogdC5zYWRldmEgPSAweDA5Mzg7CiB0LnNhZGZpbmFsYXJhYmljID0gMHhmZWJhOwogdC5zYWRpbml0aWFsYXJhYmljID0gMHhmZWJiOwogdC5zYWRtZWRpYWxhcmFiaWMgPSAweGZlYmM7CiB0LnNhZ3VqYXJhdGkgPSAweDBhYjg7CiB0LnNhZ3VybXVraGkgPSAweDBhMzg7CiB0LnNhaGlyYWdhbmEgPSAweDMwNTU7CiB0LnNha2F0YWthbmEgPSAweDMwYjU7CiB0LnNha2F0YWthbmFoYWxmd2lkdGggPSAweGZmN2I7CiB0LnNhbGxhbGxhaG91YWxheWhld2FzYWxsYW1hcmFiaWMgPSAweGZkZmE7CiB0LnNhbWVraCA9IDB4MDVlMTsKIHQuc2FtZWtoZGFnZXNoID0gMHhmYjQxOwogdC5zYW1la2hkYWdlc2hoZWJyZXcgPSAweGZiNDE7CiB0LnNhbWVraGhlYnJldyA9IDB4MDVlMTsKIHQuc2FyYWFhdGhhaSA9IDB4MGUzMjsKIHQuc2FyYWFldGhhaSA9IDB4MGU0MTsKIHQuc2FyYWFpbWFpbWFsYWl0aGFpID0gMHgwZTQ0OwogdC5zYXJhYWltYWltdWFudGhhaSA9IDB4MGU0MzsKIHQuc2FyYWFtdGhhaSA9IDB4MGUzMzsKIHQuc2FyYWF0aGFpID0gMHgwZTMwOwogdC5zYXJhZXRoYWkgPSAweDBlNDA7CiB0LnNhcmFpaWxlZnR0aGFpID0gMHhmODg2OwogdC5zYXJhaWl0aGFpID0gMHgwZTM1OwogdC5zYXJhaWxlZnR0aGFpID0gMHhmODg1OwogdC5zYXJhaXRoYWkgPSAweDBlMzQ7CiB0LnNhcmFvdGhhaSA9IDB4MGU0MjsKIHQuc2FyYXVlZWxlZnR0aGFpID0gMHhmODg4OwogdC5zYXJhdWVldGhhaSA9IDB4MGUzNzsKIHQuc2FyYXVlbGVmdHRoYWkgPSAweGY4ODc7CiB0LnNhcmF1ZXRoYWkgPSAweDBlMzY7CiB0LnNhcmF1dGhhaSA9IDB4MGUzODsKIHQuc2FyYXV1dGhhaSA9IDB4MGUzOTsKIHQuc2JvcG9tb2ZvID0gMHgzMTE5OwogdC5zY2Fyb24gPSAweDAxNjE7CiB0LnNjYXJvbmRvdGFjY2VudCA9IDB4MWU2NzsKIHQuc2NlZGlsbGEgPSAweDAxNWY7CiB0LnNjaHdhID0gMHgwMjU5OwogdC5zY2h3YWN5cmlsbGljID0gMHgwNGQ5OwogdC5zY2h3YWRpZXJlc2lzY3lyaWxsaWMgPSAweDA0ZGI7CiB0LnNjaHdhaG9vayA9IDB4MDI1YTsKIHQuc2NpcmNsZSA9IDB4MjRlMjsKIHQuc2NpcmN1bWZsZXggPSAweDAxNWQ7CiB0LnNjb21tYWFjY2VudCA9IDB4MDIxOTsKIHQuc2RvdGFjY2VudCA9IDB4MWU2MTsKIHQuc2RvdGJlbG93ID0gMHgxZTYzOwogdC5zZG90YmVsb3dkb3RhY2NlbnQgPSAweDFlNjk7CiB0LnNlYWd1bGxiZWxvd2NtYiA9IDB4MDMzYzsKIHQuc2Vjb25kID0gMHgyMDMzOwogdC5zZWNvbmR0b25lY2hpbmVzZSA9IDB4MDJjYTsKIHQuc2VjdGlvbiA9IDB4MDBhNzsKIHQuc2VlbmFyYWJpYyA9IDB4MDYzMzsKIHQuc2VlbmZpbmFsYXJhYmljID0gMHhmZWIyOwogdC5zZWVuaW5pdGlhbGFyYWJpYyA9IDB4ZmViMzsKIHQuc2Vlbm1lZGlhbGFyYWJpYyA9IDB4ZmViNDsKIHQuc2Vnb2wgPSAweDA1YjY7CiB0LnNlZ29sMTMgPSAweDA1YjY7CiB0LnNlZ29sMWYgPSAweDA1YjY7CiB0LnNlZ29sMmMgPSAweDA1YjY7CiB0LnNlZ29saGVicmV3ID0gMHgwNWI2OwogdC5zZWdvbG5hcnJvd2hlYnJldyA9IDB4MDViNjsKIHQuc2Vnb2xxdWFydGVyaGVicmV3ID0gMHgwNWI2OwogdC5zZWdvbHRhaGVicmV3ID0gMHgwNTkyOwogdC5zZWdvbHdpZGVoZWJyZXcgPSAweDA1YjY7CiB0LnNlaGFybWVuaWFuID0gMHgwNTdkOwogdC5zZWhpcmFnYW5hID0gMHgzMDViOwogdC5zZWthdGFrYW5hID0gMHgzMGJiOwogdC5zZWthdGFrYW5haGFsZndpZHRoID0gMHhmZjdlOwogdC5zZW1pY29sb24gPSAweDAwM2I7CiB0LnNlbWljb2xvbmFyYWJpYyA9IDB4MDYxYjsKIHQuc2VtaWNvbG9ubW9ub3NwYWNlID0gMHhmZjFiOwogdC5zZW1pY29sb25zbWFsbCA9IDB4ZmU1NDsKIHQuc2VtaXZvaWNlZG1hcmtrYW5hID0gMHgzMDljOwogdC5zZW1pdm9pY2VkbWFya2thbmFoYWxmd2lkdGggPSAweGZmOWY7CiB0LnNlbnRpc3F1YXJlID0gMHgzMzIyOwogdC5zZW50b3NxdWFyZSA9IDB4MzMyMzsKIHQuc2V2ZW4gPSAweDAwMzc7CiB0LnNldmVuYXJhYmljID0gMHgwNjY3OwogdC5zZXZlbmJlbmdhbGkgPSAweDA5ZWQ7CiB0LnNldmVuY2lyY2xlID0gMHgyNDY2OwogdC5zZXZlbmNpcmNsZWludmVyc2VzYW5zc2VyaWYgPSAweDI3OTA7CiB0LnNldmVuZGV2YSA9IDB4MDk2ZDsKIHQuc2V2ZW5laWdodGhzID0gMHgyMTVlOwogdC5zZXZlbmd1amFyYXRpID0gMHgwYWVkOwogdC5zZXZlbmd1cm11a2hpID0gMHgwYTZkOwogdC5zZXZlbmhhY2thcmFiaWMgPSAweDA2Njc7CiB0LnNldmVuaGFuZ3pob3UgPSAweDMwMjc7CiB0LnNldmVuaWRlb2dyYXBoaWNwYXJlbiA9IDB4MzIyNjsKIHQuc2V2ZW5pbmZlcmlvciA9IDB4MjA4NzsKIHQuc2V2ZW5tb25vc3BhY2UgPSAweGZmMTc7CiB0LnNldmVub2xkc3R5bGUgPSAweGY3Mzc7CiB0LnNldmVucGFyZW4gPSAweDI0N2E7CiB0LnNldmVucGVyaW9kID0gMHgyNDhlOwogdC5zZXZlbnBlcnNpYW4gPSAweDA2Zjc7CiB0LnNldmVucm9tYW4gPSAweDIxNzY7CiB0LnNldmVuc3VwZXJpb3IgPSAweDIwNzc7CiB0LnNldmVudGVlbmNpcmNsZSA9IDB4MjQ3MDsKIHQuc2V2ZW50ZWVucGFyZW4gPSAweDI0ODQ7CiB0LnNldmVudGVlbnBlcmlvZCA9IDB4MjQ5ODsKIHQuc2V2ZW50aGFpID0gMHgwZTU3OwogdC5zZnRoeXBoZW4gPSAweDAwYWQ7CiB0LnNoYWFybWVuaWFuID0gMHgwNTc3OwogdC5zaGFiZW5nYWxpID0gMHgwOWI2OwogdC5zaGFjeXJpbGxpYyA9IDB4MDQ0ODsKIHQuc2hhZGRhYXJhYmljID0gMHgwNjUxOwogdC5zaGFkZGFkYW1tYWFyYWJpYyA9IDB4ZmM2MTsKIHQuc2hhZGRhZGFtbWF0YW5hcmFiaWMgPSAweGZjNWU7CiB0LnNoYWRkYWZhdGhhYXJhYmljID0gMHhmYzYwOwogdC5zaGFkZGFrYXNyYWFyYWJpYyA9IDB4ZmM2MjsKIHQuc2hhZGRha2FzcmF0YW5hcmFiaWMgPSAweGZjNWY7CiB0LnNoYWRlID0gMHgyNTkyOwogdC5zaGFkZWRhcmsgPSAweDI1OTM7CiB0LnNoYWRlbGlnaHQgPSAweDI1OTE7CiB0LnNoYWRlbWVkaXVtID0gMHgyNTkyOwogdC5zaGFkZXZhID0gMHgwOTM2OwogdC5zaGFndWphcmF0aSA9IDB4MGFiNjsKIHQuc2hhZ3VybXVraGkgPSAweDBhMzY7CiB0LnNoYWxzaGVsZXRoZWJyZXcgPSAweDA1OTM7CiB0LnNoYm9wb21vZm8gPSAweDMxMTU7CiB0LnNoY2hhY3lyaWxsaWMgPSAweDA0NDk7CiB0LnNoZWVuYXJhYmljID0gMHgwNjM0OwogdC5zaGVlbmZpbmFsYXJhYmljID0gMHhmZWI2OwogdC5zaGVlbmluaXRpYWxhcmFiaWMgPSAweGZlYjc7CiB0LnNoZWVubWVkaWFsYXJhYmljID0gMHhmZWI4OwogdC5zaGVpY29wdGljID0gMHgwM2UzOwogdC5zaGVxZWwgPSAweDIwYWE7CiB0LnNoZXFlbGhlYnJldyA9IDB4MjBhYTsKIHQuc2hldmEgPSAweDA1YjA7CiB0LnNoZXZhMTE1ID0gMHgwNWIwOwogdC5zaGV2YTE1ID0gMHgwNWIwOwogdC5zaGV2YTIyID0gMHgwNWIwOwogdC5zaGV2YTJlID0gMHgwNWIwOwogdC5zaGV2YWhlYnJldyA9IDB4MDViMDsKIHQuc2hldmFuYXJyb3doZWJyZXcgPSAweDA1YjA7CiB0LnNoZXZhcXVhcnRlcmhlYnJldyA9IDB4MDViMDsKIHQuc2hldmF3aWRlaGVicmV3ID0gMHgwNWIwOwogdC5zaGhhY3lyaWxsaWMgPSAweDA0YmI7CiB0LnNoaW1hY29wdGljID0gMHgwM2VkOwogdC5zaGluID0gMHgwNWU5OwogdC5zaGluZGFnZXNoID0gMHhmYjQ5OwogdC5zaGluZGFnZXNoaGVicmV3ID0gMHhmYjQ5OwogdC5zaGluZGFnZXNoc2hpbmRvdCA9IDB4ZmIyYzsKIHQuc2hpbmRhZ2VzaHNoaW5kb3RoZWJyZXcgPSAweGZiMmM7CiB0LnNoaW5kYWdlc2hzaW5kb3QgPSAweGZiMmQ7CiB0LnNoaW5kYWdlc2hzaW5kb3RoZWJyZXcgPSAweGZiMmQ7CiB0LnNoaW5kb3RoZWJyZXcgPSAweDA1YzE7CiB0LnNoaW5oZWJyZXcgPSAweDA1ZTk7CiB0LnNoaW5zaGluZG90ID0gMHhmYjJhOwogdC5zaGluc2hpbmRvdGhlYnJldyA9IDB4ZmIyYTsKIHQuc2hpbnNpbmRvdCA9IDB4ZmIyYjsKIHQuc2hpbnNpbmRvdGhlYnJldyA9IDB4ZmIyYjsKIHQuc2hvb2sgPSAweDAyODI7CiB0LnNpZ21hID0gMHgwM2MzOwogdC5zaWdtYTEgPSAweDAzYzI7CiB0LnNpZ21hZmluYWwgPSAweDAzYzI7CiB0LnNpZ21hbHVuYXRlc3ltYm9sZ3JlZWsgPSAweDAzZjI7CiB0LnNpaGlyYWdhbmEgPSAweDMwNTc7CiB0LnNpa2F0YWthbmEgPSAweDMwYjc7CiB0LnNpa2F0YWthbmFoYWxmd2lkdGggPSAweGZmN2M7CiB0LnNpbHVxaGVicmV3ID0gMHgwNWJkOwogdC5zaWx1cWxlZnRoZWJyZXcgPSAweDA1YmQ7CiB0LnNpbWlsYXIgPSAweDIyM2M7CiB0LnNpbmRvdGhlYnJldyA9IDB4MDVjMjsKIHQuc2lvc2FjaXJjbGVrb3JlYW4gPSAweDMyNzQ7CiB0LnNpb3NhcGFyZW5rb3JlYW4gPSAweDMyMTQ7CiB0LnNpb3NjaWV1Y2tvcmVhbiA9IDB4MzE3ZTsKIHQuc2lvc2NpcmNsZWtvcmVhbiA9IDB4MzI2NjsKIHQuc2lvc2tpeWVva2tvcmVhbiA9IDB4MzE3YTsKIHQuc2lvc2tvcmVhbiA9IDB4MzE0NTsKIHQuc2lvc25pZXVua29yZWFuID0gMHgzMTdiOwogdC5zaW9zcGFyZW5rb3JlYW4gPSAweDMyMDY7CiB0LnNpb3NwaWV1cGtvcmVhbiA9IDB4MzE3ZDsKIHQuc2lvc3Rpa2V1dGtvcmVhbiA9IDB4MzE3YzsKIHQuc2l4ID0gMHgwMDM2OwogdC5zaXhhcmFiaWMgPSAweDA2NjY7CiB0LnNpeGJlbmdhbGkgPSAweDA5ZWM7CiB0LnNpeGNpcmNsZSA9IDB4MjQ2NTsKIHQuc2l4Y2lyY2xlaW52ZXJzZXNhbnNzZXJpZiA9IDB4Mjc4ZjsKIHQuc2l4ZGV2YSA9IDB4MDk2YzsKIHQuc2l4Z3VqYXJhdGkgPSAweDBhZWM7CiB0LnNpeGd1cm11a2hpID0gMHgwYTZjOwogdC5zaXhoYWNrYXJhYmljID0gMHgwNjY2OwogdC5zaXhoYW5nemhvdSA9IDB4MzAyNjsKIHQuc2l4aWRlb2dyYXBoaWNwYXJlbiA9IDB4MzIyNTsKIHQuc2l4aW5mZXJpb3IgPSAweDIwODY7CiB0LnNpeG1vbm9zcGFjZSA9IDB4ZmYxNjsKIHQuc2l4b2xkc3R5bGUgPSAweGY3MzY7CiB0LnNpeHBhcmVuID0gMHgyNDc5OwogdC5zaXhwZXJpb2QgPSAweDI0OGQ7CiB0LnNpeHBlcnNpYW4gPSAweDA2ZjY7CiB0LnNpeHJvbWFuID0gMHgyMTc1OwogdC5zaXhzdXBlcmlvciA9IDB4MjA3NjsKIHQuc2l4dGVlbmNpcmNsZSA9IDB4MjQ2ZjsKIHQuc2l4dGVlbmN1cnJlbmN5ZGVub21pbmF0b3JiZW5nYWxpID0gMHgwOWY5OwogdC5zaXh0ZWVucGFyZW4gPSAweDI0ODM7CiB0LnNpeHRlZW5wZXJpb2QgPSAweDI0OTc7CiB0LnNpeHRoYWkgPSAweDBlNTY7CiB0LnNsYXNoID0gMHgwMDJmOwogdC5zbGFzaG1vbm9zcGFjZSA9IDB4ZmYwZjsKIHQuc2xvbmcgPSAweDAxN2Y7CiB0LnNsb25nZG90YWNjZW50ID0gMHgxZTliOwogdC5zbWlsZWZhY2UgPSAweDI2M2E7CiB0LnNtb25vc3BhY2UgPSAweGZmNTM7CiB0LnNvZnBhc3VxaGVicmV3ID0gMHgwNWMzOwogdC5zb2Z0aHlwaGVuID0gMHgwMGFkOwogdC5zb2Z0c2lnbmN5cmlsbGljID0gMHgwNDRjOwogdC5zb2hpcmFnYW5hID0gMHgzMDVkOwogdC5zb2thdGFrYW5hID0gMHgzMGJkOwogdC5zb2thdGFrYW5haGFsZndpZHRoID0gMHhmZjdmOwogdC5zb2xpZHVzbG9uZ292ZXJsYXljbWIgPSAweDAzMzg7CiB0LnNvbGlkdXNzaG9ydG92ZXJsYXljbWIgPSAweDAzMzc7CiB0LnNvcnVzaXRoYWkgPSAweDBlMjk7CiB0LnNvc2FsYXRoYWkgPSAweDBlMjg7CiB0LnNvc290aGFpID0gMHgwZTBiOwogdC5zb3N1YXRoYWkgPSAweDBlMmE7CiB0LnNwYWNlID0gMHgwMDIwOwogdC5zcGFjZWhhY2thcmFiaWMgPSAweDAwMjA7CiB0LnNwYWRlID0gMHgyNjYwOwogdC5zcGFkZXN1aXRibGFjayA9IDB4MjY2MDsKIHQuc3BhZGVzdWl0d2hpdGUgPSAweDI2NjQ7CiB0LnNwYXJlbiA9IDB4MjRhZTsKIHQuc3F1YXJlYmVsb3djbWIgPSAweDAzM2I7CiB0LnNxdWFyZWNjID0gMHgzM2M0OwogdC5zcXVhcmVjbSA9IDB4MzM5ZDsKIHQuc3F1YXJlZGlhZ29uYWxjcm9zc2hhdGNoZmlsbCA9IDB4MjVhOTsKIHQuc3F1YXJlaG9yaXpvbnRhbGZpbGwgPSAweDI1YTQ7CiB0LnNxdWFyZWtnID0gMHgzMzhmOwogdC5zcXVhcmVrbSA9IDB4MzM5ZTsKIHQuc3F1YXJla21jYXBpdGFsID0gMHgzM2NlOwogdC5zcXVhcmVsbiA9IDB4MzNkMTsKIHQuc3F1YXJlbG9nID0gMHgzM2QyOwogdC5zcXVhcmVtZyA9IDB4MzM4ZTsKIHQuc3F1YXJlbWlsID0gMHgzM2Q1OwogdC5zcXVhcmVtbSA9IDB4MzM5YzsKIHQuc3F1YXJlbXNxdWFyZWQgPSAweDMzYTE7CiB0LnNxdWFyZW9ydGhvZ29uYWxjcm9zc2hhdGNoZmlsbCA9IDB4MjVhNjsKIHQuc3F1YXJldXBwZXJsZWZ0dG9sb3dlcnJpZ2h0ZmlsbCA9IDB4MjVhNzsKIHQuc3F1YXJldXBwZXJyaWdodHRvbG93ZXJsZWZ0ZmlsbCA9IDB4MjVhODsKIHQuc3F1YXJldmVydGljYWxmaWxsID0gMHgyNWE1OwogdC5zcXVhcmV3aGl0ZXdpdGhzbWFsbGJsYWNrID0gMHgyNWEzOwogdC5zcnNxdWFyZSA9IDB4MzNkYjsKIHQuc3NhYmVuZ2FsaSA9IDB4MDliNzsKIHQuc3NhZGV2YSA9IDB4MDkzNzsKIHQuc3NhZ3VqYXJhdGkgPSAweDBhYjc7CiB0LnNzYW5nY2lldWNrb3JlYW4gPSAweDMxNDk7CiB0LnNzYW5naGlldWhrb3JlYW4gPSAweDMxODU7CiB0LnNzYW5naWV1bmdrb3JlYW4gPSAweDMxODA7CiB0LnNzYW5na2l5ZW9ra29yZWFuID0gMHgzMTMyOwogdC5zc2FuZ25pZXVua29yZWFuID0gMHgzMTY1OwogdC5zc2FuZ3BpZXVwa29yZWFuID0gMHgzMTQzOwogdC5zc2FuZ3Npb3Nrb3JlYW4gPSAweDMxNDY7CiB0LnNzYW5ndGlrZXV0a29yZWFuID0gMHgzMTM4OwogdC5zc3VwZXJpb3IgPSAweGY2ZjI7CiB0LnN0ZXJsaW5nID0gMHgwMGEzOwogdC5zdGVybGluZ21vbm9zcGFjZSA9IDB4ZmZlMTsKIHQuc3Ryb2tlbG9uZ292ZXJsYXljbWIgPSAweDAzMzY7CiB0LnN0cm9rZXNob3J0b3ZlcmxheWNtYiA9IDB4MDMzNTsKIHQuc3Vic2V0ID0gMHgyMjgyOwogdC5zdWJzZXRub3RlcXVhbCA9IDB4MjI4YTsKIHQuc3Vic2V0b3JlcXVhbCA9IDB4MjI4NjsKIHQuc3VjY2VlZHMgPSAweDIyN2I7CiB0LnN1Y2h0aGF0ID0gMHgyMjBiOwogdC5zdWhpcmFnYW5hID0gMHgzMDU5OwogdC5zdWthdGFrYW5hID0gMHgzMGI5OwogdC5zdWthdGFrYW5haGFsZndpZHRoID0gMHhmZjdkOwogdC5zdWt1bmFyYWJpYyA9IDB4MDY1MjsKIHQuc3VtbWF0aW9uID0gMHgyMjExOwogdC5zdW4gPSAweDI2M2M7CiB0LnN1cGVyc2V0ID0gMHgyMjgzOwogdC5zdXBlcnNldG5vdGVxdWFsID0gMHgyMjhiOwogdC5zdXBlcnNldG9yZXF1YWwgPSAweDIyODc7CiB0LnN2c3F1YXJlID0gMHgzM2RjOwogdC5zeW91d2FlcmFzcXVhcmUgPSAweDMzN2M7CiB0LnQgPSAweDAwNzQ7CiB0LnRhYmVuZ2FsaSA9IDB4MDlhNDsKIHQudGFja2Rvd24gPSAweDIyYTQ7CiB0LnRhY2tsZWZ0ID0gMHgyMmEzOwogdC50YWRldmEgPSAweDA5MjQ7CiB0LnRhZ3VqYXJhdGkgPSAweDBhYTQ7CiB0LnRhZ3VybXVraGkgPSAweDBhMjQ7CiB0LnRhaGFyYWJpYyA9IDB4MDYzNzsKIHQudGFoZmluYWxhcmFiaWMgPSAweGZlYzI7CiB0LnRhaGluaXRpYWxhcmFiaWMgPSAweGZlYzM7CiB0LnRhaGlyYWdhbmEgPSAweDMwNWY7CiB0LnRhaG1lZGlhbGFyYWJpYyA9IDB4ZmVjNDsKIHQudGFpc3lvdWVyYXNxdWFyZSA9IDB4MzM3ZDsKIHQudGFrYXRha2FuYSA9IDB4MzBiZjsKIHQudGFrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY4MDsKIHQudGF0d2VlbGFyYWJpYyA9IDB4MDY0MDsKIHQudGF1ID0gMHgwM2M0OwogdC50YXYgPSAweDA1ZWE7CiB0LnRhdmRhZ2VzID0gMHhmYjRhOwogdC50YXZkYWdlc2ggPSAweGZiNGE7CiB0LnRhdmRhZ2VzaGhlYnJldyA9IDB4ZmI0YTsKIHQudGF2aGVicmV3ID0gMHgwNWVhOwogdC50YmFyID0gMHgwMTY3OwogdC50Ym9wb21vZm8gPSAweDMxMGE7CiB0LnRjYXJvbiA9IDB4MDE2NTsKIHQudGNjdXJsID0gMHgwMmE4OwogdC50Y2VkaWxsYSA9IDB4MDE2MzsKIHQudGNoZWhhcmFiaWMgPSAweDA2ODY7CiB0LnRjaGVoZmluYWxhcmFiaWMgPSAweGZiN2I7CiB0LnRjaGVoaW5pdGlhbGFyYWJpYyA9IDB4ZmI3YzsKIHQudGNoZWhtZWRpYWxhcmFiaWMgPSAweGZiN2Q7CiB0LnRjaXJjbGUgPSAweDI0ZTM7CiB0LnRjaXJjdW1mbGV4YmVsb3cgPSAweDFlNzE7CiB0LnRjb21tYWFjY2VudCA9IDB4MDE2MzsKIHQudGRpZXJlc2lzID0gMHgxZTk3OwogdC50ZG90YWNjZW50ID0gMHgxZTZiOwogdC50ZG90YmVsb3cgPSAweDFlNmQ7CiB0LnRlY3lyaWxsaWMgPSAweDA0NDI7CiB0LnRlZGVzY2VuZGVyY3lyaWxsaWMgPSAweDA0YWQ7CiB0LnRlaGFyYWJpYyA9IDB4MDYyYTsKIHQudGVoZmluYWxhcmFiaWMgPSAweGZlOTY7CiB0LnRlaGhhaGluaXRpYWxhcmFiaWMgPSAweGZjYTI7CiB0LnRlaGhhaGlzb2xhdGVkYXJhYmljID0gMHhmYzBjOwogdC50ZWhpbml0aWFsYXJhYmljID0gMHhmZTk3OwogdC50ZWhpcmFnYW5hID0gMHgzMDY2OwogdC50ZWhqZWVtaW5pdGlhbGFyYWJpYyA9IDB4ZmNhMTsKIHQudGVoamVlbWlzb2xhdGVkYXJhYmljID0gMHhmYzBiOwogdC50ZWhtYXJidXRhYXJhYmljID0gMHgwNjI5OwogdC50ZWhtYXJidXRhZmluYWxhcmFiaWMgPSAweGZlOTQ7CiB0LnRlaG1lZGlhbGFyYWJpYyA9IDB4ZmU5ODsKIHQudGVobWVlbWluaXRpYWxhcmFiaWMgPSAweGZjYTQ7CiB0LnRlaG1lZW1pc29sYXRlZGFyYWJpYyA9IDB4ZmMwZTsKIHQudGVobm9vbmZpbmFsYXJhYmljID0gMHhmYzczOwogdC50ZWthdGFrYW5hID0gMHgzMGM2OwogdC50ZWthdGFrYW5haGFsZndpZHRoID0gMHhmZjgzOwogdC50ZWxlcGhvbmUgPSAweDIxMjE7CiB0LnRlbGVwaG9uZWJsYWNrID0gMHgyNjBlOwogdC50ZWxpc2hhZ2Vkb2xhaGVicmV3ID0gMHgwNWEwOwogdC50ZWxpc2hhcWV0YW5haGVicmV3ID0gMHgwNWE5OwogdC50ZW5jaXJjbGUgPSAweDI0Njk7CiB0LnRlbmlkZW9ncmFwaGljcGFyZW4gPSAweDMyMjk7CiB0LnRlbnBhcmVuID0gMHgyNDdkOwogdC50ZW5wZXJpb2QgPSAweDI0OTE7CiB0LnRlbnJvbWFuID0gMHgyMTc5OwogdC50ZXNoID0gMHgwMmE3OwogdC50ZXQgPSAweDA1ZDg7CiB0LnRldGRhZ2VzaCA9IDB4ZmIzODsKIHQudGV0ZGFnZXNoaGVicmV3ID0gMHhmYjM4OwogdC50ZXRoZWJyZXcgPSAweDA1ZDg7CiB0LnRldHNlY3lyaWxsaWMgPSAweDA0YjU7CiB0LnRldmlyaGVicmV3ID0gMHgwNTliOwogdC50ZXZpcmxlZnRoZWJyZXcgPSAweDA1OWI7CiB0LnRoYWJlbmdhbGkgPSAweDA5YTU7CiB0LnRoYWRldmEgPSAweDA5MjU7CiB0LnRoYWd1amFyYXRpID0gMHgwYWE1OwogdC50aGFndXJtdWtoaSA9IDB4MGEyNTsKIHQudGhhbGFyYWJpYyA9IDB4MDYzMDsKIHQudGhhbGZpbmFsYXJhYmljID0gMHhmZWFjOwogdC50aGFudGhha2hhdGxvd2xlZnR0aGFpID0gMHhmODk4OwogdC50aGFudGhha2hhdGxvd3JpZ2h0dGhhaSA9IDB4Zjg5NzsKIHQudGhhbnRoYWtoYXR0aGFpID0gMHgwZTRjOwogdC50aGFudGhha2hhdHVwcGVybGVmdHRoYWkgPSAweGY4OTY7CiB0LnRoZWhhcmFiaWMgPSAweDA2MmI7CiB0LnRoZWhmaW5hbGFyYWJpYyA9IDB4ZmU5YTsKIHQudGhlaGluaXRpYWxhcmFiaWMgPSAweGZlOWI7CiB0LnRoZWhtZWRpYWxhcmFiaWMgPSAweGZlOWM7CiB0LnRoZXJlZXhpc3RzID0gMHgyMjAzOwogdC50aGVyZWZvcmUgPSAweDIyMzQ7CiB0LnRoZXRhID0gMHgwM2I4OwogdC50aGV0YTEgPSAweDAzZDE7CiB0LnRoZXRhc3ltYm9sZ3JlZWsgPSAweDAzZDE7CiB0LnRoaWV1dGhhY2lyY2xla29yZWFuID0gMHgzMjc5OwogdC50aGlldXRoYXBhcmVua29yZWFuID0gMHgzMjE5OwogdC50aGlldXRoY2lyY2xla29yZWFuID0gMHgzMjZiOwogdC50aGlldXRoa29yZWFuID0gMHgzMTRjOwogdC50aGlldXRocGFyZW5rb3JlYW4gPSAweDMyMGI7CiB0LnRoaXJ0ZWVuY2lyY2xlID0gMHgyNDZjOwogdC50aGlydGVlbnBhcmVuID0gMHgyNDgwOwogdC50aGlydGVlbnBlcmlvZCA9IDB4MjQ5NDsKIHQudGhvbmFuZ21vbnRob3RoYWkgPSAweDBlMTE7CiB0LnRob29rID0gMHgwMWFkOwogdC50aG9waHV0aGFvdGhhaSA9IDB4MGUxMjsKIHQudGhvcm4gPSAweDAwZmU7CiB0LnRob3RoYWhhbnRoYWkgPSAweDBlMTc7CiB0LnRob3RoYW50aGFpID0gMHgwZTEwOwogdC50aG90aG9uZ3RoYWkgPSAweDBlMTg7CiB0LnRob3RodW5ndGhhaSA9IDB4MGUxNjsKIHQudGhvdXNhbmRjeXJpbGxpYyA9IDB4MDQ4MjsKIHQudGhvdXNhbmRzc2VwYXJhdG9yYXJhYmljID0gMHgwNjZjOwogdC50aG91c2FuZHNzZXBhcmF0b3JwZXJzaWFuID0gMHgwNjZjOwogdC50aHJlZSA9IDB4MDAzMzsKIHQudGhyZWVhcmFiaWMgPSAweDA2NjM7CiB0LnRocmVlYmVuZ2FsaSA9IDB4MDllOTsKIHQudGhyZWVjaXJjbGUgPSAweDI0NjI7CiB0LnRocmVlY2lyY2xlaW52ZXJzZXNhbnNzZXJpZiA9IDB4Mjc4YzsKIHQudGhyZWVkZXZhID0gMHgwOTY5OwogdC50aHJlZWVpZ2h0aHMgPSAweDIxNWM7CiB0LnRocmVlZ3VqYXJhdGkgPSAweDBhZTk7CiB0LnRocmVlZ3VybXVraGkgPSAweDBhNjk7CiB0LnRocmVlaGFja2FyYWJpYyA9IDB4MDY2MzsKIHQudGhyZWVoYW5nemhvdSA9IDB4MzAyMzsKIHQudGhyZWVpZGVvZ3JhcGhpY3BhcmVuID0gMHgzMjIyOwogdC50aHJlZWluZmVyaW9yID0gMHgyMDgzOwogdC50aHJlZW1vbm9zcGFjZSA9IDB4ZmYxMzsKIHQudGhyZWVudW1lcmF0b3JiZW5nYWxpID0gMHgwOWY2OwogdC50aHJlZW9sZHN0eWxlID0gMHhmNzMzOwogdC50aHJlZXBhcmVuID0gMHgyNDc2OwogdC50aHJlZXBlcmlvZCA9IDB4MjQ4YTsKIHQudGhyZWVwZXJzaWFuID0gMHgwNmYzOwogdC50aHJlZXF1YXJ0ZXJzID0gMHgwMGJlOwogdC50aHJlZXF1YXJ0ZXJzZW1kYXNoID0gMHhmNmRlOwogdC50aHJlZXJvbWFuID0gMHgyMTcyOwogdC50aHJlZXN1cGVyaW9yID0gMHgwMGIzOwogdC50aHJlZXRoYWkgPSAweDBlNTM7CiB0LnRoenNxdWFyZSA9IDB4MzM5NDsKIHQudGloaXJhZ2FuYSA9IDB4MzA2MTsKIHQudGlrYXRha2FuYSA9IDB4MzBjMTsKIHQudGlrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY4MTsKIHQudGlrZXV0YWNpcmNsZWtvcmVhbiA9IDB4MzI3MDsKIHQudGlrZXV0YXBhcmVua29yZWFuID0gMHgzMjEwOwogdC50aWtldXRjaXJjbGVrb3JlYW4gPSAweDMyNjI7CiB0LnRpa2V1dGtvcmVhbiA9IDB4MzEzNzsKIHQudGlrZXV0cGFyZW5rb3JlYW4gPSAweDMyMDI7CiB0LnRpbGRlID0gMHgwMmRjOwogdC50aWxkZWJlbG93Y21iID0gMHgwMzMwOwogdC50aWxkZWNtYiA9IDB4MDMwMzsKIHQudGlsZGVjb21iID0gMHgwMzAzOwogdC50aWxkZWRvdWJsZWNtYiA9IDB4MDM2MDsKIHQudGlsZGVvcGVyYXRvciA9IDB4MjIzYzsKIHQudGlsZGVvdmVybGF5Y21iID0gMHgwMzM0OwogdC50aWxkZXZlcnRpY2FsY21iID0gMHgwMzNlOwogdC50aW1lc2NpcmNsZSA9IDB4MjI5NzsKIHQudGlwZWhhaGVicmV3ID0gMHgwNTk2OwogdC50aXBlaGFsZWZ0aGVicmV3ID0gMHgwNTk2OwogdC50aXBwaWd1cm11a2hpID0gMHgwYTcwOwogdC50aXRsb2N5cmlsbGljY21iID0gMHgwNDgzOwogdC50aXduYXJtZW5pYW4gPSAweDA1N2Y7CiB0LnRsaW5lYmVsb3cgPSAweDFlNmY7CiB0LnRtb25vc3BhY2UgPSAweGZmNTQ7CiB0LnRvYXJtZW5pYW4gPSAweDA1Njk7CiB0LnRvaGlyYWdhbmEgPSAweDMwNjg7CiB0LnRva2F0YWthbmEgPSAweDMwYzg7CiB0LnRva2F0YWthbmFoYWxmd2lkdGggPSAweGZmODQ7CiB0LnRvbmViYXJleHRyYWhpZ2htb2QgPSAweDAyZTU7CiB0LnRvbmViYXJleHRyYWxvd21vZCA9IDB4MDJlOTsKIHQudG9uZWJhcmhpZ2htb2QgPSAweDAyZTY7CiB0LnRvbmViYXJsb3dtb2QgPSAweDAyZTg7CiB0LnRvbmViYXJtaWRtb2QgPSAweDAyZTc7CiB0LnRvbmVmaXZlID0gMHgwMWJkOwogdC50b25lc2l4ID0gMHgwMTg1OwogdC50b25ldHdvID0gMHgwMWE4OwogdC50b25vcyA9IDB4MDM4NDsKIHQudG9uc3F1YXJlID0gMHgzMzI3OwogdC50b3BhdGFrdGhhaSA9IDB4MGUwZjsKIHQudG9ydG9pc2VzaGVsbGJyYWNrZXRsZWZ0ID0gMHgzMDE0OwogdC50b3J0b2lzZXNoZWxsYnJhY2tldGxlZnRzbWFsbCA9IDB4ZmU1ZDsKIHQudG9ydG9pc2VzaGVsbGJyYWNrZXRsZWZ0dmVydGljYWwgPSAweGZlMzk7CiB0LnRvcnRvaXNlc2hlbGxicmFja2V0cmlnaHQgPSAweDMwMTU7CiB0LnRvcnRvaXNlc2hlbGxicmFja2V0cmlnaHRzbWFsbCA9IDB4ZmU1ZTsKIHQudG9ydG9pc2VzaGVsbGJyYWNrZXRyaWdodHZlcnRpY2FsID0gMHhmZTNhOwogdC50b3Rhb3RoYWkgPSAweDBlMTU7CiB0LnRwYWxhdGFsaG9vayA9IDB4MDFhYjsKIHQudHBhcmVuID0gMHgyNGFmOwogdC50cmFkZW1hcmsgPSAweDIxMjI7CiB0LnRyYWRlbWFya3NhbnMgPSAweGY4ZWE7CiB0LnRyYWRlbWFya3NlcmlmID0gMHhmNmRiOwogdC50cmV0cm9mbGV4aG9vayA9IDB4MDI4ODsKIHQudHJpYWdkbiA9IDB4MjViYzsKIHQudHJpYWdsZiA9IDB4MjVjNDsKIHQudHJpYWdydCA9IDB4MjViYTsKIHQudHJpYWd1cCA9IDB4MjViMjsKIHQudHMgPSAweDAyYTY7CiB0LnRzYWRpID0gMHgwNWU2OwogdC50c2FkaWRhZ2VzaCA9IDB4ZmI0NjsKIHQudHNhZGlkYWdlc2hoZWJyZXcgPSAweGZiNDY7CiB0LnRzYWRpaGVicmV3ID0gMHgwNWU2OwogdC50c2VjeXJpbGxpYyA9IDB4MDQ0NjsKIHQudHNlcmUgPSAweDA1YjU7CiB0LnRzZXJlMTIgPSAweDA1YjU7CiB0LnRzZXJlMWUgPSAweDA1YjU7CiB0LnRzZXJlMmIgPSAweDA1YjU7CiB0LnRzZXJlaGVicmV3ID0gMHgwNWI1OwogdC50c2VyZW5hcnJvd2hlYnJldyA9IDB4MDViNTsKIHQudHNlcmVxdWFydGVyaGVicmV3ID0gMHgwNWI1OwogdC50c2VyZXdpZGVoZWJyZXcgPSAweDA1YjU7CiB0LnRzaGVjeXJpbGxpYyA9IDB4MDQ1YjsKIHQudHN1cGVyaW9yID0gMHhmNmYzOwogdC50dGFiZW5nYWxpID0gMHgwOTlmOwogdC50dGFkZXZhID0gMHgwOTFmOwogdC50dGFndWphcmF0aSA9IDB4MGE5ZjsKIHQudHRhZ3VybXVraGkgPSAweDBhMWY7CiB0LnR0ZWhhcmFiaWMgPSAweDA2Nzk7CiB0LnR0ZWhmaW5hbGFyYWJpYyA9IDB4ZmI2NzsKIHQudHRlaGluaXRpYWxhcmFiaWMgPSAweGZiNjg7CiB0LnR0ZWhtZWRpYWxhcmFiaWMgPSAweGZiNjk7CiB0LnR0aGFiZW5nYWxpID0gMHgwOWEwOwogdC50dGhhZGV2YSA9IDB4MDkyMDsKIHQudHRoYWd1amFyYXRpID0gMHgwYWEwOwogdC50dGhhZ3VybXVraGkgPSAweDBhMjA7CiB0LnR0dXJuZWQgPSAweDAyODc7CiB0LnR1aGlyYWdhbmEgPSAweDMwNjQ7CiB0LnR1a2F0YWthbmEgPSAweDMwYzQ7CiB0LnR1a2F0YWthbmFoYWxmd2lkdGggPSAweGZmODI7CiB0LnR1c21hbGxoaXJhZ2FuYSA9IDB4MzA2MzsKIHQudHVzbWFsbGthdGFrYW5hID0gMHgzMGMzOwogdC50dXNtYWxsa2F0YWthbmFoYWxmd2lkdGggPSAweGZmNmY7CiB0LnR3ZWx2ZWNpcmNsZSA9IDB4MjQ2YjsKIHQudHdlbHZlcGFyZW4gPSAweDI0N2Y7CiB0LnR3ZWx2ZXBlcmlvZCA9IDB4MjQ5MzsKIHQudHdlbHZlcm9tYW4gPSAweDIxN2I7CiB0LnR3ZW50eWNpcmNsZSA9IDB4MjQ3MzsKIHQudHdlbnR5aGFuZ3pob3UgPSAweDUzNDQ7CiB0LnR3ZW50eXBhcmVuID0gMHgyNDg3OwogdC50d2VudHlwZXJpb2QgPSAweDI0OWI7CiB0LnR3byA9IDB4MDAzMjsKIHQudHdvYXJhYmljID0gMHgwNjYyOwogdC50d29iZW5nYWxpID0gMHgwOWU4OwogdC50d29jaXJjbGUgPSAweDI0NjE7CiB0LnR3b2NpcmNsZWludmVyc2VzYW5zc2VyaWYgPSAweDI3OGI7CiB0LnR3b2RldmEgPSAweDA5Njg7CiB0LnR3b2RvdGVubGVhZGVyID0gMHgyMDI1OwogdC50d29kb3RsZWFkZXIgPSAweDIwMjU7CiB0LnR3b2RvdGxlYWRlcnZlcnRpY2FsID0gMHhmZTMwOwogdC50d29ndWphcmF0aSA9IDB4MGFlODsKIHQudHdvZ3VybXVraGkgPSAweDBhNjg7CiB0LnR3b2hhY2thcmFiaWMgPSAweDA2NjI7CiB0LnR3b2hhbmd6aG91ID0gMHgzMDIyOwogdC50d29pZGVvZ3JhcGhpY3BhcmVuID0gMHgzMjIxOwogdC50d29pbmZlcmlvciA9IDB4MjA4MjsKIHQudHdvbW9ub3NwYWNlID0gMHhmZjEyOwogdC50d29udW1lcmF0b3JiZW5nYWxpID0gMHgwOWY1OwogdC50d29vbGRzdHlsZSA9IDB4ZjczMjsKIHQudHdvcGFyZW4gPSAweDI0NzU7CiB0LnR3b3BlcmlvZCA9IDB4MjQ4OTsKIHQudHdvcGVyc2lhbiA9IDB4MDZmMjsKIHQudHdvcm9tYW4gPSAweDIxNzE7CiB0LnR3b3N0cm9rZSA9IDB4MDFiYjsKIHQudHdvc3VwZXJpb3IgPSAweDAwYjI7CiB0LnR3b3RoYWkgPSAweDBlNTI7CiB0LnR3b3RoaXJkcyA9IDB4MjE1NDsKIHQudSA9IDB4MDA3NTsKIHQudWFjdXRlID0gMHgwMGZhOwogdC51YmFyID0gMHgwMjg5OwogdC51YmVuZ2FsaSA9IDB4MDk4OTsKIHQudWJvcG9tb2ZvID0gMHgzMTI4OwogdC51YnJldmUgPSAweDAxNmQ7CiB0LnVjYXJvbiA9IDB4MDFkNDsKIHQudWNpcmNsZSA9IDB4MjRlNDsKIHQudWNpcmN1bWZsZXggPSAweDAwZmI7CiB0LnVjaXJjdW1mbGV4YmVsb3cgPSAweDFlNzc7CiB0LnVjeXJpbGxpYyA9IDB4MDQ0MzsKIHQudWRhdHRhZGV2YSA9IDB4MDk1MTsKIHQudWRibGFjdXRlID0gMHgwMTcxOwogdC51ZGJsZ3JhdmUgPSAweDAyMTU7CiB0LnVkZXZhID0gMHgwOTA5OwogdC51ZGllcmVzaXMgPSAweDAwZmM7CiB0LnVkaWVyZXNpc2FjdXRlID0gMHgwMWQ4OwogdC51ZGllcmVzaXNiZWxvdyA9IDB4MWU3MzsKIHQudWRpZXJlc2lzY2Fyb24gPSAweDAxZGE7CiB0LnVkaWVyZXNpc2N5cmlsbGljID0gMHgwNGYxOwogdC51ZGllcmVzaXNncmF2ZSA9IDB4MDFkYzsKIHQudWRpZXJlc2lzbWFjcm9uID0gMHgwMWQ2OwogdC51ZG90YmVsb3cgPSAweDFlZTU7CiB0LnVncmF2ZSA9IDB4MDBmOTsKIHQudWd1amFyYXRpID0gMHgwYTg5OwogdC51Z3VybXVraGkgPSAweDBhMDk7CiB0LnVoaXJhZ2FuYSA9IDB4MzA0NjsKIHQudWhvb2thYm92ZSA9IDB4MWVlNzsKIHQudWhvcm4gPSAweDAxYjA7CiB0LnVob3JuYWN1dGUgPSAweDFlZTk7CiB0LnVob3JuZG90YmVsb3cgPSAweDFlZjE7CiB0LnVob3JuZ3JhdmUgPSAweDFlZWI7CiB0LnVob3JuaG9va2Fib3ZlID0gMHgxZWVkOwogdC51aG9ybnRpbGRlID0gMHgxZWVmOwogdC51aHVuZ2FydW1sYXV0ID0gMHgwMTcxOwogdC51aHVuZ2FydW1sYXV0Y3lyaWxsaWMgPSAweDA0ZjM7CiB0LnVpbnZlcnRlZGJyZXZlID0gMHgwMjE3OwogdC51a2F0YWthbmEgPSAweDMwYTY7CiB0LnVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY3MzsKIHQudWtjeXJpbGxpYyA9IDB4MDQ3OTsKIHQudWtvcmVhbiA9IDB4MzE1YzsKIHQudW1hY3JvbiA9IDB4MDE2YjsKIHQudW1hY3JvbmN5cmlsbGljID0gMHgwNGVmOwogdC51bWFjcm9uZGllcmVzaXMgPSAweDFlN2I7CiB0LnVtYXRyYWd1cm11a2hpID0gMHgwYTQxOwogdC51bW9ub3NwYWNlID0gMHhmZjU1OwogdC51bmRlcnNjb3JlID0gMHgwMDVmOwogdC51bmRlcnNjb3JlZGJsID0gMHgyMDE3OwogdC51bmRlcnNjb3JlbW9ub3NwYWNlID0gMHhmZjNmOwogdC51bmRlcnNjb3JldmVydGljYWwgPSAweGZlMzM7CiB0LnVuZGVyc2NvcmV3YXZ5ID0gMHhmZTRmOwogdC51bmlvbiA9IDB4MjIyYTsKIHQudW5pdmVyc2FsID0gMHgyMjAwOwogdC51b2dvbmVrID0gMHgwMTczOwogdC51cGFyZW4gPSAweDI0YjA7CiB0LnVwYmxvY2sgPSAweDI1ODA7CiB0LnVwcGVyZG90aGVicmV3ID0gMHgwNWM0OwogdC51cHNpbG9uID0gMHgwM2M1OwogdC51cHNpbG9uZGllcmVzaXMgPSAweDAzY2I7CiB0LnVwc2lsb25kaWVyZXNpc3Rvbm9zID0gMHgwM2IwOwogdC51cHNpbG9ubGF0aW4gPSAweDAyOGE7CiB0LnVwc2lsb250b25vcyA9IDB4MDNjZDsKIHQudXB0YWNrYmVsb3djbWIgPSAweDAzMWQ7CiB0LnVwdGFja21vZCA9IDB4MDJkNDsKIHQudXJhZ3VybXVraGkgPSAweDBhNzM7CiB0LnVyaW5nID0gMHgwMTZmOwogdC51c2hvcnRjeXJpbGxpYyA9IDB4MDQ1ZTsKIHQudXNtYWxsaGlyYWdhbmEgPSAweDMwNDU7CiB0LnVzbWFsbGthdGFrYW5hID0gMHgzMGE1OwogdC51c21hbGxrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY2OTsKIHQudXN0cmFpZ2h0Y3lyaWxsaWMgPSAweDA0YWY7CiB0LnVzdHJhaWdodHN0cm9rZWN5cmlsbGljID0gMHgwNGIxOwogdC51dGlsZGUgPSAweDAxNjk7CiB0LnV0aWxkZWFjdXRlID0gMHgxZTc5OwogdC51dGlsZGViZWxvdyA9IDB4MWU3NTsKIHQudXViZW5nYWxpID0gMHgwOThhOwogdC51dWRldmEgPSAweDA5MGE7CiB0LnV1Z3VqYXJhdGkgPSAweDBhOGE7CiB0LnV1Z3VybXVraGkgPSAweDBhMGE7CiB0LnV1bWF0cmFndXJtdWtoaSA9IDB4MGE0MjsKIHQudXV2b3dlbHNpZ25iZW5nYWxpID0gMHgwOWMyOwogdC51dXZvd2Vsc2lnbmRldmEgPSAweDA5NDI7CiB0LnV1dm93ZWxzaWduZ3VqYXJhdGkgPSAweDBhYzI7CiB0LnV2b3dlbHNpZ25iZW5nYWxpID0gMHgwOWMxOwogdC51dm93ZWxzaWduZGV2YSA9IDB4MDk0MTsKIHQudXZvd2Vsc2lnbmd1amFyYXRpID0gMHgwYWMxOwogdC52ID0gMHgwMDc2OwogdC52YWRldmEgPSAweDA5MzU7CiB0LnZhZ3VqYXJhdGkgPSAweDBhYjU7CiB0LnZhZ3VybXVraGkgPSAweDBhMzU7CiB0LnZha2F0YWthbmEgPSAweDMwZjc7CiB0LnZhdiA9IDB4MDVkNTsKIHQudmF2ZGFnZXNoID0gMHhmYjM1OwogdC52YXZkYWdlc2g2NSA9IDB4ZmIzNTsKIHQudmF2ZGFnZXNoaGVicmV3ID0gMHhmYjM1OwogdC52YXZoZWJyZXcgPSAweDA1ZDU7CiB0LnZhdmhvbGFtID0gMHhmYjRiOwogdC52YXZob2xhbWhlYnJldyA9IDB4ZmI0YjsKIHQudmF2dmF2aGVicmV3ID0gMHgwNWYwOwogdC52YXZ5b2RoZWJyZXcgPSAweDA1ZjE7CiB0LnZjaXJjbGUgPSAweDI0ZTU7CiB0LnZkb3RiZWxvdyA9IDB4MWU3ZjsKIHQudmVjeXJpbGxpYyA9IDB4MDQzMjsKIHQudmVoYXJhYmljID0gMHgwNmE0OwogdC52ZWhmaW5hbGFyYWJpYyA9IDB4ZmI2YjsKIHQudmVoaW5pdGlhbGFyYWJpYyA9IDB4ZmI2YzsKIHQudmVobWVkaWFsYXJhYmljID0gMHhmYjZkOwogdC52ZWthdGFrYW5hID0gMHgzMGY5OwogdC52ZW51cyA9IDB4MjY0MDsKIHQudmVydGljYWxiYXIgPSAweDAwN2M7CiB0LnZlcnRpY2FsbGluZWFib3ZlY21iID0gMHgwMzBkOwogdC52ZXJ0aWNhbGxpbmViZWxvd2NtYiA9IDB4MDMyOTsKIHQudmVydGljYWxsaW5lbG93bW9kID0gMHgwMmNjOwogdC52ZXJ0aWNhbGxpbmVtb2QgPSAweDAyYzg7CiB0LnZld2FybWVuaWFuID0gMHgwNTdlOwogdC52aG9vayA9IDB4MDI4YjsKIHQudmlrYXRha2FuYSA9IDB4MzBmODsKIHQudmlyYW1hYmVuZ2FsaSA9IDB4MDljZDsKIHQudmlyYW1hZGV2YSA9IDB4MDk0ZDsKIHQudmlyYW1hZ3VqYXJhdGkgPSAweDBhY2Q7CiB0LnZpc2FyZ2FiZW5nYWxpID0gMHgwOTgzOwogdC52aXNhcmdhZGV2YSA9IDB4MDkwMzsKIHQudmlzYXJnYWd1amFyYXRpID0gMHgwYTgzOwogdC52bW9ub3NwYWNlID0gMHhmZjU2OwogdC52b2FybWVuaWFuID0gMHgwNTc4OwogdC52b2ljZWRpdGVyYXRpb25oaXJhZ2FuYSA9IDB4MzA5ZTsKIHQudm9pY2VkaXRlcmF0aW9ua2F0YWthbmEgPSAweDMwZmU7CiB0LnZvaWNlZG1hcmtrYW5hID0gMHgzMDliOwogdC52b2ljZWRtYXJra2FuYWhhbGZ3aWR0aCA9IDB4ZmY5ZTsKIHQudm9rYXRha2FuYSA9IDB4MzBmYTsKIHQudnBhcmVuID0gMHgyNGIxOwogdC52dGlsZGUgPSAweDFlN2Q7CiB0LnZ0dXJuZWQgPSAweDAyOGM7CiB0LnZ1aGlyYWdhbmEgPSAweDMwOTQ7CiB0LnZ1a2F0YWthbmEgPSAweDMwZjQ7CiB0LncgPSAweDAwNzc7CiB0LndhY3V0ZSA9IDB4MWU4MzsKIHQud2Fla29yZWFuID0gMHgzMTU5OwogdC53YWhpcmFnYW5hID0gMHgzMDhmOwogdC53YWthdGFrYW5hID0gMHgzMGVmOwogdC53YWthdGFrYW5haGFsZndpZHRoID0gMHhmZjljOwogdC53YWtvcmVhbiA9IDB4MzE1ODsKIHQud2FzbWFsbGhpcmFnYW5hID0gMHgzMDhlOwogdC53YXNtYWxsa2F0YWthbmEgPSAweDMwZWU7CiB0LndhdHRvc3F1YXJlID0gMHgzMzU3OwogdC53YXZlZGFzaCA9IDB4MzAxYzsKIHQud2F2eXVuZGVyc2NvcmV2ZXJ0aWNhbCA9IDB4ZmUzNDsKIHQud2F3YXJhYmljID0gMHgwNjQ4OwogdC53YXdmaW5hbGFyYWJpYyA9IDB4ZmVlZTsKIHQud2F3aGFtemFhYm92ZWFyYWJpYyA9IDB4MDYyNDsKIHQud2F3aGFtemFhYm92ZWZpbmFsYXJhYmljID0gMHhmZTg2OwogdC53YnNxdWFyZSA9IDB4MzNkZDsKIHQud2NpcmNsZSA9IDB4MjRlNjsKIHQud2NpcmN1bWZsZXggPSAweDAxNzU7CiB0LndkaWVyZXNpcyA9IDB4MWU4NTsKIHQud2RvdGFjY2VudCA9IDB4MWU4NzsKIHQud2RvdGJlbG93ID0gMHgxZTg5OwogdC53ZWhpcmFnYW5hID0gMHgzMDkxOwogdC53ZWllcnN0cmFzcyA9IDB4MjExODsKIHQud2VrYXRha2FuYSA9IDB4MzBmMTsKIHQud2Vrb3JlYW4gPSAweDMxNWU7CiB0Lndlb2tvcmVhbiA9IDB4MzE1ZDsKIHQud2dyYXZlID0gMHgxZTgxOwogdC53aGl0ZWJ1bGxldCA9IDB4MjVlNjsKIHQud2hpdGVjaXJjbGUgPSAweDI1Y2I7CiB0LndoaXRlY2lyY2xlaW52ZXJzZSA9IDB4MjVkOTsKIHQud2hpdGVjb3JuZXJicmFja2V0bGVmdCA9IDB4MzAwZTsKIHQud2hpdGVjb3JuZXJicmFja2V0bGVmdHZlcnRpY2FsID0gMHhmZTQzOwogdC53aGl0ZWNvcm5lcmJyYWNrZXRyaWdodCA9IDB4MzAwZjsKIHQud2hpdGVjb3JuZXJicmFja2V0cmlnaHR2ZXJ0aWNhbCA9IDB4ZmU0NDsKIHQud2hpdGVkaWFtb25kID0gMHgyNWM3OwogdC53aGl0ZWRpYW1vbmRjb250YWluaW5nYmxhY2tzbWFsbGRpYW1vbmQgPSAweDI1Yzg7CiB0LndoaXRlZG93bnBvaW50aW5nc21hbGx0cmlhbmdsZSA9IDB4MjViZjsKIHQud2hpdGVkb3ducG9pbnRpbmd0cmlhbmdsZSA9IDB4MjViZDsKIHQud2hpdGVsZWZ0cG9pbnRpbmdzbWFsbHRyaWFuZ2xlID0gMHgyNWMzOwogdC53aGl0ZWxlZnRwb2ludGluZ3RyaWFuZ2xlID0gMHgyNWMxOwogdC53aGl0ZWxlbnRpY3VsYXJicmFja2V0bGVmdCA9IDB4MzAxNjsKIHQud2hpdGVsZW50aWN1bGFyYnJhY2tldHJpZ2h0ID0gMHgzMDE3OwogdC53aGl0ZXJpZ2h0cG9pbnRpbmdzbWFsbHRyaWFuZ2xlID0gMHgyNWI5OwogdC53aGl0ZXJpZ2h0cG9pbnRpbmd0cmlhbmdsZSA9IDB4MjViNzsKIHQud2hpdGVzbWFsbHNxdWFyZSA9IDB4MjVhYjsKIHQud2hpdGVzbWlsaW5nZmFjZSA9IDB4MjYzYTsKIHQud2hpdGVzcXVhcmUgPSAweDI1YTE7CiB0LndoaXRlc3RhciA9IDB4MjYwNjsKIHQud2hpdGV0ZWxlcGhvbmUgPSAweDI2MGY7CiB0LndoaXRldG9ydG9pc2VzaGVsbGJyYWNrZXRsZWZ0ID0gMHgzMDE4OwogdC53aGl0ZXRvcnRvaXNlc2hlbGxicmFja2V0cmlnaHQgPSAweDMwMTk7CiB0LndoaXRldXBwb2ludGluZ3NtYWxsdHJpYW5nbGUgPSAweDI1YjU7CiB0LndoaXRldXBwb2ludGluZ3RyaWFuZ2xlID0gMHgyNWIzOwogdC53aWhpcmFnYW5hID0gMHgzMDkwOwogdC53aWthdGFrYW5hID0gMHgzMGYwOwogdC53aWtvcmVhbiA9IDB4MzE1ZjsKIHQud21vbm9zcGFjZSA9IDB4ZmY1NzsKIHQud29oaXJhZ2FuYSA9IDB4MzA5MjsKIHQud29rYXRha2FuYSA9IDB4MzBmMjsKIHQud29rYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY2NjsKIHQud29uID0gMHgyMGE5OwogdC53b25tb25vc3BhY2UgPSAweGZmZTY7CiB0Lndvd2FlbnRoYWkgPSAweDBlMjc7CiB0LndwYXJlbiA9IDB4MjRiMjsKIHQud3JpbmcgPSAweDFlOTg7CiB0LndzdXBlcmlvciA9IDB4MDJiNzsKIHQud3R1cm5lZCA9IDB4MDI4ZDsKIHQud3lubiA9IDB4MDFiZjsKIHQueCA9IDB4MDA3ODsKIHQueGFib3ZlY21iID0gMHgwMzNkOwogdC54Ym9wb21vZm8gPSAweDMxMTI7CiB0LnhjaXJjbGUgPSAweDI0ZTc7CiB0LnhkaWVyZXNpcyA9IDB4MWU4ZDsKIHQueGRvdGFjY2VudCA9IDB4MWU4YjsKIHQueGVoYXJtZW5pYW4gPSAweDA1NmQ7CiB0LnhpID0gMHgwM2JlOwogdC54bW9ub3NwYWNlID0gMHhmZjU4OwogdC54cGFyZW4gPSAweDI0YjM7CiB0LnhzdXBlcmlvciA9IDB4MDJlMzsKIHQueSA9IDB4MDA3OTsKIHQueWFhZG9zcXVhcmUgPSAweDMzNGU7CiB0LnlhYmVuZ2FsaSA9IDB4MDlhZjsKIHQueWFjdXRlID0gMHgwMGZkOwogdC55YWRldmEgPSAweDA5MmY7CiB0LnlhZWtvcmVhbiA9IDB4MzE1MjsKIHQueWFndWphcmF0aSA9IDB4MGFhZjsKIHQueWFndXJtdWtoaSA9IDB4MGEyZjsKIHQueWFoaXJhZ2FuYSA9IDB4MzA4NDsKIHQueWFrYXRha2FuYSA9IDB4MzBlNDsKIHQueWFrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY5NDsKIHQueWFrb3JlYW4gPSAweDMxNTE7CiB0LnlhbWFra2FudGhhaSA9IDB4MGU0ZTsKIHQueWFzbWFsbGhpcmFnYW5hID0gMHgzMDgzOwogdC55YXNtYWxsa2F0YWthbmEgPSAweDMwZTM7CiB0Lnlhc21hbGxrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY2YzsKIHQueWF0Y3lyaWxsaWMgPSAweDA0NjM7CiB0LnljaXJjbGUgPSAweDI0ZTg7CiB0LnljaXJjdW1mbGV4ID0gMHgwMTc3OwogdC55ZGllcmVzaXMgPSAweDAwZmY7CiB0Lnlkb3RhY2NlbnQgPSAweDFlOGY7CiB0Lnlkb3RiZWxvdyA9IDB4MWVmNTsKIHQueWVoYXJhYmljID0gMHgwNjRhOwogdC55ZWhiYXJyZWVhcmFiaWMgPSAweDA2ZDI7CiB0LnllaGJhcnJlZWZpbmFsYXJhYmljID0gMHhmYmFmOwogdC55ZWhmaW5hbGFyYWJpYyA9IDB4ZmVmMjsKIHQueWVoaGFtemFhYm92ZWFyYWJpYyA9IDB4MDYyNjsKIHQueWVoaGFtemFhYm92ZWZpbmFsYXJhYmljID0gMHhmZThhOwogdC55ZWhoYW16YWFib3ZlaW5pdGlhbGFyYWJpYyA9IDB4ZmU4YjsKIHQueWVoaGFtemFhYm92ZW1lZGlhbGFyYWJpYyA9IDB4ZmU4YzsKIHQueWVoaW5pdGlhbGFyYWJpYyA9IDB4ZmVmMzsKIHQueWVobWVkaWFsYXJhYmljID0gMHhmZWY0OwogdC55ZWhtZWVtaW5pdGlhbGFyYWJpYyA9IDB4ZmNkZDsKIHQueWVobWVlbWlzb2xhdGVkYXJhYmljID0gMHhmYzU4OwogdC55ZWhub29uZmluYWxhcmFiaWMgPSAweGZjOTQ7CiB0LnllaHRocmVlZG90c2JlbG93YXJhYmljID0gMHgwNmQxOwogdC55ZWtvcmVhbiA9IDB4MzE1NjsKIHQueWVuID0gMHgwMGE1OwogdC55ZW5tb25vc3BhY2UgPSAweGZmZTU7CiB0Lnllb2tvcmVhbiA9IDB4MzE1NTsKIHQueWVvcmluaGlldWhrb3JlYW4gPSAweDMxODY7CiB0LnllcmFoYmVueW9tb2hlYnJldyA9IDB4MDVhYTsKIHQueWVyYWhiZW55b21vbGVmdGhlYnJldyA9IDB4MDVhYTsKIHQueWVyaWN5cmlsbGljID0gMHgwNDRiOwogdC55ZXJ1ZGllcmVzaXNjeXJpbGxpYyA9IDB4MDRmOTsKIHQueWVzaWV1bmdrb3JlYW4gPSAweDMxODE7CiB0Lnllc2lldW5ncGFuc2lvc2tvcmVhbiA9IDB4MzE4MzsKIHQueWVzaWV1bmdzaW9za29yZWFuID0gMHgzMTgyOwogdC55ZXRpdmhlYnJldyA9IDB4MDU5YTsKIHQueWdyYXZlID0gMHgxZWYzOwogdC55aG9vayA9IDB4MDFiNDsKIHQueWhvb2thYm92ZSA9IDB4MWVmNzsKIHQueWlhcm1lbmlhbiA9IDB4MDU3NTsKIHQueWljeXJpbGxpYyA9IDB4MDQ1NzsKIHQueWlrb3JlYW4gPSAweDMxNjI7CiB0LnlpbnlhbmcgPSAweDI2MmY7CiB0Lnlpd25hcm1lbmlhbiA9IDB4MDU4MjsKIHQueW1vbm9zcGFjZSA9IDB4ZmY1OTsKIHQueW9kID0gMHgwNWQ5OwogdC55b2RkYWdlc2ggPSAweGZiMzk7CiB0LnlvZGRhZ2VzaGhlYnJldyA9IDB4ZmIzOTsKIHQueW9kaGVicmV3ID0gMHgwNWQ5OwogdC55b2R5b2RoZWJyZXcgPSAweDA1ZjI7CiB0LnlvZHlvZHBhdGFoaGVicmV3ID0gMHhmYjFmOwogdC55b2hpcmFnYW5hID0gMHgzMDg4OwogdC55b2lrb3JlYW4gPSAweDMxODk7CiB0Lnlva2F0YWthbmEgPSAweDMwZTg7CiB0Lnlva2F0YWthbmFoYWxmd2lkdGggPSAweGZmOTY7CiB0Lnlva29yZWFuID0gMHgzMTViOwogdC55b3NtYWxsaGlyYWdhbmEgPSAweDMwODc7CiB0Lnlvc21hbGxrYXRha2FuYSA9IDB4MzBlNzsKIHQueW9zbWFsbGthdGFrYW5haGFsZndpZHRoID0gMHhmZjZlOwogdC55b3RncmVlayA9IDB4MDNmMzsKIHQueW95YWVrb3JlYW4gPSAweDMxODg7CiB0LnlveWFrb3JlYW4gPSAweDMxODc7CiB0LnlveWFrdGhhaSA9IDB4MGUyMjsKIHQueW95aW5ndGhhaSA9IDB4MGUwZDsKIHQueXBhcmVuID0gMHgyNGI0OwogdC55cG9nZWdyYW1tZW5pID0gMHgwMzdhOwogdC55cG9nZWdyYW1tZW5pZ3JlZWtjbWIgPSAweDAzNDU7CiB0LnlyID0gMHgwMWE2OwogdC55cmluZyA9IDB4MWU5OTsKIHQueXN1cGVyaW9yID0gMHgwMmI4OwogdC55dGlsZGUgPSAweDFlZjk7CiB0Lnl0dXJuZWQgPSAweDAyOGU7CiB0Lnl1aGlyYWdhbmEgPSAweDMwODY7CiB0Lnl1aWtvcmVhbiA9IDB4MzE4YzsKIHQueXVrYXRha2FuYSA9IDB4MzBlNjsKIHQueXVrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY5NTsKIHQueXVrb3JlYW4gPSAweDMxNjA7CiB0Lnl1c2JpZ2N5cmlsbGljID0gMHgwNDZiOwogdC55dXNiaWdpb3RpZmllZGN5cmlsbGljID0gMHgwNDZkOwogdC55dXNsaXR0bGVjeXJpbGxpYyA9IDB4MDQ2NzsKIHQueXVzbGl0dGxlaW90aWZpZWRjeXJpbGxpYyA9IDB4MDQ2OTsKIHQueXVzbWFsbGhpcmFnYW5hID0gMHgzMDg1OwogdC55dXNtYWxsa2F0YWthbmEgPSAweDMwZTU7CiB0Lnl1c21hbGxrYXRha2FuYWhhbGZ3aWR0aCA9IDB4ZmY2ZDsKIHQueXV5ZWtvcmVhbiA9IDB4MzE4YjsKIHQueXV5ZW9rb3JlYW4gPSAweDMxOGE7CiB0Lnl5YWJlbmdhbGkgPSAweDA5ZGY7CiB0Lnl5YWRldmEgPSAweDA5NWY7CiB0LnogPSAweDAwN2E7CiB0LnphYXJtZW5pYW4gPSAweDA1NjY7CiB0LnphY3V0ZSA9IDB4MDE3YTsKIHQuemFkZXZhID0gMHgwOTViOwogdC56YWd1cm11a2hpID0gMHgwYTViOwogdC56YWhhcmFiaWMgPSAweDA2Mzg7CiB0LnphaGZpbmFsYXJhYmljID0gMHhmZWM2OwogdC56YWhpbml0aWFsYXJhYmljID0gMHhmZWM3OwogdC56YWhpcmFnYW5hID0gMHgzMDU2OwogdC56YWhtZWRpYWxhcmFiaWMgPSAweGZlYzg7CiB0LnphaW5hcmFiaWMgPSAweDA2MzI7CiB0LnphaW5maW5hbGFyYWJpYyA9IDB4ZmViMDsKIHQuemFrYXRha2FuYSA9IDB4MzBiNjsKIHQuemFxZWZnYWRvbGhlYnJldyA9IDB4MDU5NTsKIHQuemFxZWZxYXRhbmhlYnJldyA9IDB4MDU5NDsKIHQuemFycWFoZWJyZXcgPSAweDA1OTg7CiB0LnpheWluID0gMHgwNWQ2OwogdC56YXlpbmRhZ2VzaCA9IDB4ZmIzNjsKIHQuemF5aW5kYWdlc2hoZWJyZXcgPSAweGZiMzY7CiB0LnpheWluaGVicmV3ID0gMHgwNWQ2OwogdC56Ym9wb21vZm8gPSAweDMxMTc7CiB0LnpjYXJvbiA9IDB4MDE3ZTsKIHQuemNpcmNsZSA9IDB4MjRlOTsKIHQuemNpcmN1bWZsZXggPSAweDFlOTE7CiB0LnpjdXJsID0gMHgwMjkxOwogdC56ZG90ID0gMHgwMTdjOwogdC56ZG90YWNjZW50ID0gMHgwMTdjOwogdC56ZG90YmVsb3cgPSAweDFlOTM7CiB0LnplY3lyaWxsaWMgPSAweDA0Mzc7CiB0LnplZGVzY2VuZGVyY3lyaWxsaWMgPSAweDA0OTk7CiB0LnplZGllcmVzaXNjeXJpbGxpYyA9IDB4MDRkZjsKIHQuemVoaXJhZ2FuYSA9IDB4MzA1YzsKIHQuemVrYXRha2FuYSA9IDB4MzBiYzsKIHQuemVybyA9IDB4MDAzMDsKIHQuemVyb2FyYWJpYyA9IDB4MDY2MDsKIHQuemVyb2JlbmdhbGkgPSAweDA5ZTY7CiB0Lnplcm9kZXZhID0gMHgwOTY2OwogdC56ZXJvZ3VqYXJhdGkgPSAweDBhZTY7CiB0Lnplcm9ndXJtdWtoaSA9IDB4MGE2NjsKIHQuemVyb2hhY2thcmFiaWMgPSAweDA2NjA7CiB0Lnplcm9pbmZlcmlvciA9IDB4MjA4MDsKIHQuemVyb21vbm9zcGFjZSA9IDB4ZmYxMDsKIHQuemVyb29sZHN0eWxlID0gMHhmNzMwOwogdC56ZXJvcGVyc2lhbiA9IDB4MDZmMDsKIHQuemVyb3N1cGVyaW9yID0gMHgyMDcwOwogdC56ZXJvdGhhaSA9IDB4MGU1MDsKIHQuemVyb3dpZHRoam9pbmVyID0gMHhmZWZmOwogdC56ZXJvd2lkdGhub25qb2luZXIgPSAweDIwMGM7CiB0Lnplcm93aWR0aHNwYWNlID0gMHgyMDBiOwogdC56ZXRhID0gMHgwM2I2OwogdC56aGJvcG9tb2ZvID0gMHgzMTEzOwogdC56aGVhcm1lbmlhbiA9IDB4MDU2YTsKIHQuemhlYnJldmVjeXJpbGxpYyA9IDB4MDRjMjsKIHQuemhlY3lyaWxsaWMgPSAweDA0MzY7CiB0LnpoZWRlc2NlbmRlcmN5cmlsbGljID0gMHgwNDk3OwogdC56aGVkaWVyZXNpc2N5cmlsbGljID0gMHgwNGRkOwogdC56aWhpcmFnYW5hID0gMHgzMDU4OwogdC56aWthdGFrYW5hID0gMHgzMGI4OwogdC56aW5vcmhlYnJldyA9IDB4MDVhZTsKIHQuemxpbmViZWxvdyA9IDB4MWU5NTsKIHQuem1vbm9zcGFjZSA9IDB4ZmY1YTsKIHQuem9oaXJhZ2FuYSA9IDB4MzA1ZTsKIHQuem9rYXRha2FuYSA9IDB4MzBiZTsKIHQuenBhcmVuID0gMHgyNGI1OwogdC56cmV0cm9mbGV4aG9vayA9IDB4MDI5MDsKIHQuenN0cm9rZSA9IDB4MDFiNjsKIHQuenVoaXJhZ2FuYSA9IDB4MzA1YTsKIHQuenVrYXRha2FuYSA9IDB4MzBiYTsKIHRbIi5ub3RkZWYiXSA9IDB4MDAwMDsKIHQuYW5nYnJhY2tldGxlZnRiaWcgPSAweDIzMjk7CiB0LmFuZ2JyYWNrZXRsZWZ0QmlnID0gMHgyMzI5OwogdC5hbmdicmFja2V0bGVmdGJpZ2cgPSAweDIzMjk7CiB0LmFuZ2JyYWNrZXRsZWZ0QmlnZyA9IDB4MjMyOTsKIHQuYW5nYnJhY2tldHJpZ2h0QmlnID0gMHgyMzJhOwogdC5hbmdicmFja2V0cmlnaHRiaWcgPSAweDIzMmE7CiB0LmFuZ2JyYWNrZXRyaWdodEJpZ2cgPSAweDIzMmE7CiB0LmFuZ2JyYWNrZXRyaWdodGJpZ2cgPSAweDIzMmE7CiB0LmFycm93aG9va2xlZnQgPSAweDIxYWE7CiB0LmFycm93aG9va3JpZ2h0ID0gMHgyMWE5OwogdC5hcnJvd2xlZnR0b3BoYWxmID0gMHgyMWJjOwogdC5hcnJvd2xlZnRib3RoYWxmID0gMHgyMWJkOwogdC5hcnJvd25vcnRoZWFzdCA9IDB4MjE5NzsKIHQuYXJyb3dub3J0aHdlc3QgPSAweDIxOTY7CiB0LmFycm93cmlnaHR0b3BoYWxmID0gMHgyMWMwOwogdC5hcnJvd3JpZ2h0Ym90aGFsZiA9IDB4MjFjMTsKIHQuYXJyb3dzb3V0aGVhc3QgPSAweDIxOTg7CiB0LmFycm93c291dGh3ZXN0ID0gMHgyMTk5OwogdC5iYWNrc2xhc2hiaWcgPSAweDIyMTY7CiB0LmJhY2tzbGFzaEJpZyA9IDB4MjIxNjsKIHQuYmFja3NsYXNoQmlnZyA9IDB4MjIxNjsKIHQuYmFja3NsYXNoYmlnZyA9IDB4MjIxNjsKIHQuYmFyZGJsID0gMHgyMDE2OwogdC5icmFjZWh0aXBkb3dubGVmdCA9IDB4ZmUzNzsKIHQuYnJhY2VodGlwZG93bnJpZ2h0ID0gMHhmZTM3OwogdC5icmFjZWh0aXB1cGxlZnQgPSAweGZlMzg7CiB0LmJyYWNlaHRpcHVwcmlnaHQgPSAweGZlMzg7CiB0LmJyYWNlbGVmdEJpZyA9IDB4MDA3YjsKIHQuYnJhY2VsZWZ0YmlnID0gMHgwMDdiOwogdC5icmFjZWxlZnRiaWdnID0gMHgwMDdiOwogdC5icmFjZWxlZnRCaWdnID0gMHgwMDdiOwogdC5icmFjZXJpZ2h0QmlnID0gMHgwMDdkOwogdC5icmFjZXJpZ2h0YmlnID0gMHgwMDdkOwogdC5icmFjZXJpZ2h0YmlnZyA9IDB4MDA3ZDsKIHQuYnJhY2VyaWdodEJpZ2cgPSAweDAwN2Q7CiB0LmJyYWNrZXRsZWZ0YmlnID0gMHgwMDViOwogdC5icmFja2V0bGVmdEJpZyA9IDB4MDA1YjsKIHQuYnJhY2tldGxlZnRiaWdnID0gMHgwMDViOwogdC5icmFja2V0bGVmdEJpZ2cgPSAweDAwNWI7CiB0LmJyYWNrZXRyaWdodEJpZyA9IDB4MDA1ZDsKIHQuYnJhY2tldHJpZ2h0YmlnID0gMHgwMDVkOwogdC5icmFja2V0cmlnaHRiaWdnID0gMHgwMDVkOwogdC5icmFja2V0cmlnaHRCaWdnID0gMHgwMDVkOwogdC5jZWlsaW5nbGVmdGJpZyA9IDB4MjMwODsKIHQuY2VpbGluZ2xlZnRCaWcgPSAweDIzMDg7CiB0LmNlaWxpbmdsZWZ0QmlnZyA9IDB4MjMwODsKIHQuY2VpbGluZ2xlZnRiaWdnID0gMHgyMzA4OwogdC5jZWlsaW5ncmlnaHRiaWcgPSAweDIzMDk7CiB0LmNlaWxpbmdyaWdodEJpZyA9IDB4MjMwOTsKIHQuY2VpbGluZ3JpZ2h0YmlnZyA9IDB4MjMwOTsKIHQuY2VpbGluZ3JpZ2h0QmlnZyA9IDB4MjMwOTsKIHQuY2lyY2xlZG90ZGlzcGxheSA9IDB4MjI5OTsKIHQuY2lyY2xlZG90dGV4dCA9IDB4MjI5OTsKIHQuY2lyY2xlbXVsdGlwbHlkaXNwbGF5ID0gMHgyMjk3OwogdC5jaXJjbGVtdWx0aXBseXRleHQgPSAweDIyOTc7CiB0LmNpcmNsZXBsdXNkaXNwbGF5ID0gMHgyMjk1OwogdC5jaXJjbGVwbHVzdGV4dCA9IDB4MjI5NTsKIHQuY29udGludGVncmFsZGlzcGxheSA9IDB4MjIyZTsKIHQuY29udGludGVncmFsdGV4dCA9IDB4MjIyZTsKIHQuY29wcm9kdWN0ZGlzcGxheSA9IDB4MjIxMDsKIHQuY29wcm9kdWN0dGV4dCA9IDB4MjIxMDsKIHQuZmxvb3JsZWZ0QmlnID0gMHgyMzBhOwogdC5mbG9vcmxlZnRiaWcgPSAweDIzMGE7CiB0LmZsb29ybGVmdGJpZ2cgPSAweDIzMGE7CiB0LmZsb29ybGVmdEJpZ2cgPSAweDIzMGE7CiB0LmZsb29ycmlnaHRiaWcgPSAweDIzMGI7CiB0LmZsb29ycmlnaHRCaWcgPSAweDIzMGI7CiB0LmZsb29ycmlnaHRCaWdnID0gMHgyMzBiOwogdC5mbG9vcnJpZ2h0YmlnZyA9IDB4MjMwYjsKIHQuaGF0d2lkZSA9IDB4MDMwMjsKIHQuaGF0d2lkZXIgPSAweDAzMDI7CiB0LmhhdHdpZGVzdCA9IDB4MDMwMjsKIHQuaW50ZXJjYWwgPSAweDFkNDA7CiB0LmludGVncmFsZGlzcGxheSA9IDB4MjIyYjsKIHQuaW50ZWdyYWx0ZXh0ID0gMHgyMjJiOwogdC5pbnRlcnNlY3Rpb25kaXNwbGF5ID0gMHgyMmMyOwogdC5pbnRlcnNlY3Rpb250ZXh0ID0gMHgyMmMyOwogdC5sb2dpY2FsYW5kZGlzcGxheSA9IDB4MjIyNzsKIHQubG9naWNhbGFuZHRleHQgPSAweDIyMjc7CiB0LmxvZ2ljYWxvcmRpc3BsYXkgPSAweDIyMjg7CiB0LmxvZ2ljYWxvcnRleHQgPSAweDIyMjg7CiB0LnBhcmVubGVmdEJpZyA9IDB4MDAyODsKIHQucGFyZW5sZWZ0YmlnID0gMHgwMDI4OwogdC5wYXJlbmxlZnRCaWdnID0gMHgwMDI4OwogdC5wYXJlbmxlZnRiaWdnID0gMHgwMDI4OwogdC5wYXJlbnJpZ2h0QmlnID0gMHgwMDI5OwogdC5wYXJlbnJpZ2h0YmlnID0gMHgwMDI5OwogdC5wYXJlbnJpZ2h0QmlnZyA9IDB4MDAyOTsKIHQucGFyZW5yaWdodGJpZ2cgPSAweDAwMjk7CiB0LnByaW1lID0gMHgyMDMyOwogdC5wcm9kdWN0ZGlzcGxheSA9IDB4MjIwZjsKIHQucHJvZHVjdHRleHQgPSAweDIyMGY7CiB0LnJhZGljYWxiaWcgPSAweDIyMWE7CiB0LnJhZGljYWxCaWcgPSAweDIyMWE7CiB0LnJhZGljYWxCaWdnID0gMHgyMjFhOwogdC5yYWRpY2FsYmlnZyA9IDB4MjIxYTsKIHQucmFkaWNhbGJ0ID0gMHgyMjFhOwogdC5yYWRpY2FsdHAgPSAweDIyMWE7CiB0LnJhZGljYWx2ZXJ0ZXggPSAweDIyMWE7CiB0LnNsYXNoYmlnID0gMHgwMDJmOwogdC5zbGFzaEJpZyA9IDB4MDAyZjsKIHQuc2xhc2hCaWdnID0gMHgwMDJmOwogdC5zbGFzaGJpZ2cgPSAweDAwMmY7CiB0LnN1bW1hdGlvbmRpc3BsYXkgPSAweDIyMTE7CiB0LnN1bW1hdGlvbnRleHQgPSAweDIyMTE7CiB0LnRpbGRld2lkZSA9IDB4MDJkYzsKIHQudGlsZGV3aWRlciA9IDB4MDJkYzsKIHQudGlsZGV3aWRlc3QgPSAweDAyZGM7CiB0LnVuaW9uZGlzcGxheSA9IDB4MjJjMzsKIHQudW5pb25tdWx0aWRpc3BsYXkgPSAweDIyOGU7CiB0LnVuaW9ubXVsdGl0ZXh0ID0gMHgyMjhlOwogdC51bmlvbnNxZGlzcGxheSA9IDB4MjI5NDsKIHQudW5pb25zcXRleHQgPSAweDIyOTQ7CiB0LnVuaW9udGV4dCA9IDB4MjJjMzsKIHQudmV4dGVuZGRvdWJsZSA9IDB4MjIyNTsKIHQudmV4dGVuZHNpbmdsZSA9IDB4MjIyMzsKfSk7CnZhciBnZXREaW5nYmF0c0dseXBoc1VuaWNvZGUgPSBnZXRMb29rdXBUYWJsZUZhY3RvcnkoZnVuY3Rpb24gKHQpIHsKIHQuc3BhY2UgPSAweDAwMjA7CiB0LmExID0gMHgyNzAxOwogdC5hMiA9IDB4MjcwMjsKIHQuYTIwMiA9IDB4MjcwMzsKIHQuYTMgPSAweDI3MDQ7CiB0LmE0ID0gMHgyNjBlOwogdC5hNSA9IDB4MjcwNjsKIHQuYTExOSA9IDB4MjcwNzsKIHQuYTExOCA9IDB4MjcwODsKIHQuYTExNyA9IDB4MjcwOTsKIHQuYTExID0gMHgyNjFiOwogdC5hMTIgPSAweDI2MWU7CiB0LmExMyA9IDB4MjcwYzsKIHQuYTE0ID0gMHgyNzBkOwogdC5hMTUgPSAweDI3MGU7CiB0LmExNiA9IDB4MjcwZjsKIHQuYTEwNSA9IDB4MjcxMDsKIHQuYTE3ID0gMHgyNzExOwogdC5hMTggPSAweDI3MTI7CiB0LmExOSA9IDB4MjcxMzsKIHQuYTIwID0gMHgyNzE0OwogdC5hMjEgPSAweDI3MTU7CiB0LmEyMiA9IDB4MjcxNjsKIHQuYTIzID0gMHgyNzE3OwogdC5hMjQgPSAweDI3MTg7CiB0LmEyNSA9IDB4MjcxOTsKIHQuYTI2ID0gMHgyNzFhOwogdC5hMjcgPSAweDI3MWI7CiB0LmEyOCA9IDB4MjcxYzsKIHQuYTYgPSAweDI3MWQ7CiB0LmE3ID0gMHgyNzFlOwogdC5hOCA9IDB4MjcxZjsKIHQuYTkgPSAweDI3MjA7CiB0LmExMCA9IDB4MjcyMTsKIHQuYTI5ID0gMHgyNzIyOwogdC5hMzAgPSAweDI3MjM7CiB0LmEzMSA9IDB4MjcyNDsKIHQuYTMyID0gMHgyNzI1OwogdC5hMzMgPSAweDI3MjY7CiB0LmEzNCA9IDB4MjcyNzsKIHQuYTM1ID0gMHgyNjA1OwogdC5hMzYgPSAweDI3Mjk7CiB0LmEzNyA9IDB4MjcyYTsKIHQuYTM4ID0gMHgyNzJiOwogdC5hMzkgPSAweDI3MmM7CiB0LmE0MCA9IDB4MjcyZDsKIHQuYTQxID0gMHgyNzJlOwogdC5hNDIgPSAweDI3MmY7CiB0LmE0MyA9IDB4MjczMDsKIHQuYTQ0ID0gMHgyNzMxOwogdC5hNDUgPSAweDI3MzI7CiB0LmE0NiA9IDB4MjczMzsKIHQuYTQ3ID0gMHgyNzM0OwogdC5hNDggPSAweDI3MzU7CiB0LmE0OSA9IDB4MjczNjsKIHQuYTUwID0gMHgyNzM3OwogdC5hNTEgPSAweDI3Mzg7CiB0LmE1MiA9IDB4MjczOTsKIHQuYTUzID0gMHgyNzNhOwogdC5hNTQgPSAweDI3M2I7CiB0LmE1NSA9IDB4MjczYzsKIHQuYTU2ID0gMHgyNzNkOwogdC5hNTcgPSAweDI3M2U7CiB0LmE1OCA9IDB4MjczZjsKIHQuYTU5ID0gMHgyNzQwOwogdC5hNjAgPSAweDI3NDE7CiB0LmE2MSA9IDB4Mjc0MjsKIHQuYTYyID0gMHgyNzQzOwogdC5hNjMgPSAweDI3NDQ7CiB0LmE2NCA9IDB4Mjc0NTsKIHQuYTY1ID0gMHgyNzQ2OwogdC5hNjYgPSAweDI3NDc7CiB0LmE2NyA9IDB4Mjc0ODsKIHQuYTY4ID0gMHgyNzQ5OwogdC5hNjkgPSAweDI3NGE7CiB0LmE3MCA9IDB4Mjc0YjsKIHQuYTcxID0gMHgyNWNmOwogdC5hNzIgPSAweDI3NGQ7CiB0LmE3MyA9IDB4MjVhMDsKIHQuYTc0ID0gMHgyNzRmOwogdC5hMjAzID0gMHgyNzUwOwogdC5hNzUgPSAweDI3NTE7CiB0LmEyMDQgPSAweDI3NTI7CiB0LmE3NiA9IDB4MjViMjsKIHQuYTc3ID0gMHgyNWJjOwogdC5hNzggPSAweDI1YzY7CiB0LmE3OSA9IDB4Mjc1NjsKIHQuYTgxID0gMHgyNWQ3OwogdC5hODIgPSAweDI3NTg7CiB0LmE4MyA9IDB4Mjc1OTsKIHQuYTg0ID0gMHgyNzVhOwogdC5hOTcgPSAweDI3NWI7CiB0LmE5OCA9IDB4Mjc1YzsKIHQuYTk5ID0gMHgyNzVkOwogdC5hMTAwID0gMHgyNzVlOwogdC5hMTAxID0gMHgyNzYxOwogdC5hMTAyID0gMHgyNzYyOwogdC5hMTAzID0gMHgyNzYzOwogdC5hMTA0ID0gMHgyNzY0OwogdC5hMTA2ID0gMHgyNzY1OwogdC5hMTA3ID0gMHgyNzY2OwogdC5hMTA4ID0gMHgyNzY3OwogdC5hMTEyID0gMHgyNjYzOwogdC5hMTExID0gMHgyNjY2OwogdC5hMTEwID0gMHgyNjY1OwogdC5hMTA5ID0gMHgyNjYwOwogdC5hMTIwID0gMHgyNDYwOwogdC5hMTIxID0gMHgyNDYxOwogdC5hMTIyID0gMHgyNDYyOwogdC5hMTIzID0gMHgyNDYzOwogdC5hMTI0ID0gMHgyNDY0OwogdC5hMTI1ID0gMHgyNDY1OwogdC5hMTI2ID0gMHgyNDY2OwogdC5hMTI3ID0gMHgyNDY3OwogdC5hMTI4ID0gMHgyNDY4OwogdC5hMTI5ID0gMHgyNDY5OwogdC5hMTMwID0gMHgyNzc2OwogdC5hMTMxID0gMHgyNzc3OwogdC5hMTMyID0gMHgyNzc4OwogdC5hMTMzID0gMHgyNzc5OwogdC5hMTM0ID0gMHgyNzdhOwogdC5hMTM1ID0gMHgyNzdiOwogdC5hMTM2ID0gMHgyNzdjOwogdC5hMTM3ID0gMHgyNzdkOwogdC5hMTM4ID0gMHgyNzdlOwogdC5hMTM5ID0gMHgyNzdmOwogdC5hMTQwID0gMHgyNzgwOwogdC5hMTQxID0gMHgyNzgxOwogdC5hMTQyID0gMHgyNzgyOwogdC5hMTQzID0gMHgyNzgzOwogdC5hMTQ0ID0gMHgyNzg0OwogdC5hMTQ1ID0gMHgyNzg1OwogdC5hMTQ2ID0gMHgyNzg2OwogdC5hMTQ3ID0gMHgyNzg3OwogdC5hMTQ4ID0gMHgyNzg4OwogdC5hMTQ5ID0gMHgyNzg5OwogdC5hMTUwID0gMHgyNzhhOwogdC5hMTUxID0gMHgyNzhiOwogdC5hMTUyID0gMHgyNzhjOwogdC5hMTUzID0gMHgyNzhkOwogdC5hMTU0ID0gMHgyNzhlOwogdC5hMTU1ID0gMHgyNzhmOwogdC5hMTU2ID0gMHgyNzkwOwogdC5hMTU3ID0gMHgyNzkxOwogdC5hMTU4ID0gMHgyNzkyOwogdC5hMTU5ID0gMHgyNzkzOwogdC5hMTYwID0gMHgyNzk0OwogdC5hMTYxID0gMHgyMTkyOwogdC5hMTYzID0gMHgyMTk0OwogdC5hMTY0ID0gMHgyMTk1OwogdC5hMTk2ID0gMHgyNzk4OwogdC5hMTY1ID0gMHgyNzk5OwogdC5hMTkyID0gMHgyNzlhOwogdC5hMTY2ID0gMHgyNzliOwogdC5hMTY3ID0gMHgyNzljOwogdC5hMTY4ID0gMHgyNzlkOwogdC5hMTY5ID0gMHgyNzllOwogdC5hMTcwID0gMHgyNzlmOwogdC5hMTcxID0gMHgyN2EwOwogdC5hMTcyID0gMHgyN2ExOwogdC5hMTczID0gMHgyN2EyOwogdC5hMTYyID0gMHgyN2EzOwogdC5hMTc0ID0gMHgyN2E0OwogdC5hMTc1ID0gMHgyN2E1OwogdC5hMTc2ID0gMHgyN2E2OwogdC5hMTc3ID0gMHgyN2E3OwogdC5hMTc4ID0gMHgyN2E4OwogdC5hMTc5ID0gMHgyN2E5OwogdC5hMTkzID0gMHgyN2FhOwogdC5hMTgwID0gMHgyN2FiOwogdC5hMTk5ID0gMHgyN2FjOwogdC5hMTgxID0gMHgyN2FkOwogdC5hMjAwID0gMHgyN2FlOwogdC5hMTgyID0gMHgyN2FmOwogdC5hMjAxID0gMHgyN2IxOwogdC5hMTgzID0gMHgyN2IyOwogdC5hMTg0ID0gMHgyN2IzOwogdC5hMTk3ID0gMHgyN2I0OwogdC5hMTg1ID0gMHgyN2I1OwogdC5hMTk0ID0gMHgyN2I2OwogdC5hMTk4ID0gMHgyN2I3OwogdC5hMTg2ID0gMHgyN2I4OwogdC5hMTk1ID0gMHgyN2I5OwogdC5hMTg3ID0gMHgyN2JhOwogdC5hMTg4ID0gMHgyN2JiOwogdC5hMTg5ID0gMHgyN2JjOwogdC5hMTkwID0gMHgyN2JkOwogdC5hMTkxID0gMHgyN2JlOwogdC5hODkgPSAweDI3Njg7CiB0LmE5MCA9IDB4Mjc2OTsKIHQuYTkzID0gMHgyNzZhOwogdC5hOTQgPSAweDI3NmI7CiB0LmE5MSA9IDB4Mjc2YzsKIHQuYTkyID0gMHgyNzZkOwogdC5hMjA1ID0gMHgyNzZlOwogdC5hODUgPSAweDI3NmY7CiB0LmEyMDYgPSAweDI3NzA7CiB0LmE4NiA9IDB4Mjc3MTsKIHQuYTg3ID0gMHgyNzcyOwogdC5hODggPSAweDI3NzM7CiB0LmE5NSA9IDB4Mjc3NDsKIHQuYTk2ID0gMHgyNzc1OwogdFsiLm5vdGRlZiJdID0gMHgwMDAwOwp9KTsKZXhwb3J0cy5nZXRHbHlwaHNVbmljb2RlID0gZ2V0R2x5cGhzVW5pY29kZTsKZXhwb3J0cy5nZXREaW5nYmF0c0dseXBoc1VuaWNvZGUgPSBnZXREaW5nYmF0c0dseXBoc1VuaWNvZGU7CgovKioqLyB9KSwKLyogMjI3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JDYWxpYnJpID0gZXhwb3J0cy5nZXRTdXBwbGVtZW50YWxHbHlwaE1hcEZvckFyaWFsQmxhY2sgPSBleHBvcnRzLmdldEdseXBoTWFwRm9yU3RhbmRhcmRGb250cyA9IGV4cG9ydHMuZ2V0U3ltYm9sc0ZvbnRzID0gZXhwb3J0cy5nZXRTZXJpZkZvbnRzID0gZXhwb3J0cy5nZXROb25TdGRGb250TWFwID0gZXhwb3J0cy5nZXRTdGRGb250TWFwID0gdm9pZCAwOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpOwoKdmFyIGdldFN0ZEZvbnRNYXAgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHQuQXJpYWxOYXJyb3cgPSAiSGVsdmV0aWNhIjsKICB0WyJBcmlhbE5hcnJvdy1Cb2xkIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkFyaWFsTmFycm93LUJvbGRJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkFyaWFsTmFycm93LUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0LkFyaWFsQmxhY2sgPSAiSGVsdmV0aWNhIjsKICB0WyJBcmlhbEJsYWNrLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQXJpYWxCbGFjay1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJBcmlhbEJsYWNrLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0WyJBcmlhbC1CbGFjayJdID0gIkhlbHZldGljYSI7CiAgdFsiQXJpYWwtQmxhY2stQm9sZCJdID0gIkhlbHZldGljYS1Cb2xkIjsKICB0WyJBcmlhbC1CbGFjay1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJBcmlhbC1CbGFjay1JdGFsaWMiXSA9ICJIZWx2ZXRpY2EtT2JsaXF1ZSI7CiAgdC5BcmlhbCA9ICJIZWx2ZXRpY2EiOwogIHRbIkFyaWFsLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQXJpYWwtQm9sZEl0YWxpYyJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiQXJpYWwtSXRhbGljIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHRbIkFyaWFsLUJvbGRJdGFsaWNNVCJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiQXJpYWwtQm9sZE1UIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIkFyaWFsLUl0YWxpY01UIl0gPSAiSGVsdmV0aWNhLU9ibGlxdWUiOwogIHQuQXJpYWxNVCA9ICJIZWx2ZXRpY2EiOwogIHRbIkNvdXJpZXItQm9sZCJdID0gIkNvdXJpZXItQm9sZCI7CiAgdFsiQ291cmllci1Cb2xkSXRhbGljIl0gPSAiQ291cmllci1Cb2xkT2JsaXF1ZSI7CiAgdFsiQ291cmllci1JdGFsaWMiXSA9ICJDb3VyaWVyLU9ibGlxdWUiOwogIHQuQ291cmllck5ldyA9ICJDb3VyaWVyIjsKICB0WyJDb3VyaWVyTmV3LUJvbGQiXSA9ICJDb3VyaWVyLUJvbGQiOwogIHRbIkNvdXJpZXJOZXctQm9sZEl0YWxpYyJdID0gIkNvdXJpZXItQm9sZE9ibGlxdWUiOwogIHRbIkNvdXJpZXJOZXctSXRhbGljIl0gPSAiQ291cmllci1PYmxpcXVlIjsKICB0WyJDb3VyaWVyTmV3UFMtQm9sZEl0YWxpY01UIl0gPSAiQ291cmllci1Cb2xkT2JsaXF1ZSI7CiAgdFsiQ291cmllck5ld1BTLUJvbGRNVCJdID0gIkNvdXJpZXItQm9sZCI7CiAgdFsiQ291cmllck5ld1BTLUl0YWxpY01UIl0gPSAiQ291cmllci1PYmxpcXVlIjsKICB0LkNvdXJpZXJOZXdQU01UID0gIkNvdXJpZXIiOwogIHQuSGVsdmV0aWNhID0gIkhlbHZldGljYSI7CiAgdFsiSGVsdmV0aWNhLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiSGVsdmV0aWNhLUJvbGRJdGFsaWMiXSA9ICJIZWx2ZXRpY2EtQm9sZE9ibGlxdWUiOwogIHRbIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSJdID0gIkhlbHZldGljYS1Cb2xkT2JsaXF1ZSI7CiAgdFsiSGVsdmV0aWNhLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0WyJIZWx2ZXRpY2EtT2JsaXF1ZSJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0WyJTeW1ib2wtQm9sZCJdID0gIlN5bWJvbCI7CiAgdFsiU3ltYm9sLUJvbGRJdGFsaWMiXSA9ICJTeW1ib2wiOwogIHRbIlN5bWJvbC1JdGFsaWMiXSA9ICJTeW1ib2wiOwogIHQuVGltZXNOZXdSb21hbiA9ICJUaW1lcy1Sb21hbiI7CiAgdFsiVGltZXNOZXdSb21hbi1Cb2xkIl0gPSAiVGltZXMtQm9sZCI7CiAgdFsiVGltZXNOZXdSb21hbi1Cb2xkSXRhbGljIl0gPSAiVGltZXMtQm9sZEl0YWxpYyI7CiAgdFsiVGltZXNOZXdSb21hbi1JdGFsaWMiXSA9ICJUaW1lcy1JdGFsaWMiOwogIHQuVGltZXNOZXdSb21hblBTID0gIlRpbWVzLVJvbWFuIjsKICB0WyJUaW1lc05ld1JvbWFuUFMtQm9sZCJdID0gIlRpbWVzLUJvbGQiOwogIHRbIlRpbWVzTmV3Um9tYW5QUy1Cb2xkSXRhbGljIl0gPSAiVGltZXMtQm9sZEl0YWxpYyI7CiAgdFsiVGltZXNOZXdSb21hblBTLUJvbGRJdGFsaWNNVCJdID0gIlRpbWVzLUJvbGRJdGFsaWMiOwogIHRbIlRpbWVzTmV3Um9tYW5QUy1Cb2xkTVQiXSA9ICJUaW1lcy1Cb2xkIjsKICB0WyJUaW1lc05ld1JvbWFuUFMtSXRhbGljIl0gPSAiVGltZXMtSXRhbGljIjsKICB0WyJUaW1lc05ld1JvbWFuUFMtSXRhbGljTVQiXSA9ICJUaW1lcy1JdGFsaWMiOwogIHQuVGltZXNOZXdSb21hblBTTVQgPSAiVGltZXMtUm9tYW4iOwogIHRbIlRpbWVzTmV3Um9tYW5QU01ULUJvbGQiXSA9ICJUaW1lcy1Cb2xkIjsKICB0WyJUaW1lc05ld1JvbWFuUFNNVC1Cb2xkSXRhbGljIl0gPSAiVGltZXMtQm9sZEl0YWxpYyI7CiAgdFsiVGltZXNOZXdSb21hblBTTVQtSXRhbGljIl0gPSAiVGltZXMtSXRhbGljIjsKfSk7CmV4cG9ydHMuZ2V0U3RkRm9udE1hcCA9IGdldFN0ZEZvbnRNYXA7CnZhciBnZXROb25TdGRGb250TWFwID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0LkNhbGlicmkgPSAiSGVsdmV0aWNhIjsKICB0WyJDYWxpYnJpLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQ2FsaWJyaS1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJDYWxpYnJpLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0LkNlbnR1cnlHb3RoaWMgPSAiSGVsdmV0aWNhIjsKICB0WyJDZW50dXJ5R290aGljLUJvbGQiXSA9ICJIZWx2ZXRpY2EtQm9sZCI7CiAgdFsiQ2VudHVyeUdvdGhpYy1Cb2xkSXRhbGljIl0gPSAiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIjsKICB0WyJDZW50dXJ5R290aGljLUl0YWxpYyJdID0gIkhlbHZldGljYS1PYmxpcXVlIjsKICB0LkNvbWljU2Fuc01TID0gIkNvbWljIFNhbnMgTVMiOwogIHRbIkNvbWljU2Fuc01TLUJvbGQiXSA9ICJDb21pYyBTYW5zIE1TLUJvbGQiOwogIHRbIkNvbWljU2Fuc01TLUJvbGRJdGFsaWMiXSA9ICJDb21pYyBTYW5zIE1TLUJvbGRJdGFsaWMiOwogIHRbIkNvbWljU2Fuc01TLUl0YWxpYyJdID0gIkNvbWljIFNhbnMgTVMtSXRhbGljIjsKICB0Lkx1Y2lkYUNvbnNvbGUgPSAiQ291cmllciI7CiAgdFsiTHVjaWRhQ29uc29sZS1Cb2xkIl0gPSAiQ291cmllci1Cb2xkIjsKICB0WyJMdWNpZGFDb25zb2xlLUJvbGRJdGFsaWMiXSA9ICJDb3VyaWVyLUJvbGRPYmxpcXVlIjsKICB0WyJMdWNpZGFDb25zb2xlLUl0YWxpYyJdID0gIkNvdXJpZXItT2JsaXF1ZSI7CiAgdFsiTHVjaWRhU2Fucy1EZW1pIl0gPSAiSGVsdmV0aWNhLUJvbGQiOwogIHRbIk1TLUdvdGhpYyJdID0gIk1TIEdvdGhpYyI7CiAgdFsiTVMtR290aGljLUJvbGQiXSA9ICJNUyBHb3RoaWMtQm9sZCI7CiAgdFsiTVMtR290aGljLUJvbGRJdGFsaWMiXSA9ICJNUyBHb3RoaWMtQm9sZEl0YWxpYyI7CiAgdFsiTVMtR290aGljLUl0YWxpYyJdID0gIk1TIEdvdGhpYy1JdGFsaWMiOwogIHRbIk1TLU1pbmNobyJdID0gIk1TIE1pbmNobyI7CiAgdFsiTVMtTWluY2hvLUJvbGQiXSA9ICJNUyBNaW5jaG8tQm9sZCI7CiAgdFsiTVMtTWluY2hvLUJvbGRJdGFsaWMiXSA9ICJNUyBNaW5jaG8tQm9sZEl0YWxpYyI7CiAgdFsiTVMtTWluY2hvLUl0YWxpYyJdID0gIk1TIE1pbmNoby1JdGFsaWMiOwogIHRbIk1TLVBHb3RoaWMiXSA9ICJNUyBQR290aGljIjsKICB0WyJNUy1QR290aGljLUJvbGQiXSA9ICJNUyBQR290aGljLUJvbGQiOwogIHRbIk1TLVBHb3RoaWMtQm9sZEl0YWxpYyJdID0gIk1TIFBHb3RoaWMtQm9sZEl0YWxpYyI7CiAgdFsiTVMtUEdvdGhpYy1JdGFsaWMiXSA9ICJNUyBQR290aGljLUl0YWxpYyI7CiAgdFsiTVMtUE1pbmNobyJdID0gIk1TIFBNaW5jaG8iOwogIHRbIk1TLVBNaW5jaG8tQm9sZCJdID0gIk1TIFBNaW5jaG8tQm9sZCI7CiAgdFsiTVMtUE1pbmNoby1Cb2xkSXRhbGljIl0gPSAiTVMgUE1pbmNoby1Cb2xkSXRhbGljIjsKICB0WyJNUy1QTWluY2hvLUl0YWxpYyJdID0gIk1TIFBNaW5jaG8tSXRhbGljIjsKICB0Lk51cHRpYWxTY3JpcHQgPSAiVGltZXMtSXRhbGljIjsKICB0LlNlZ29lVUlTeW1ib2wgPSAiSGVsdmV0aWNhIjsKICB0LldpbmdkaW5ncyA9ICJaYXBmRGluZ2JhdHMiOwogIHRbIldpbmdkaW5ncy1SZWd1bGFyIl0gPSAiWmFwZkRpbmdiYXRzIjsKfSk7CmV4cG9ydHMuZ2V0Tm9uU3RkRm9udE1hcCA9IGdldE5vblN0ZEZvbnRNYXA7CnZhciBnZXRTZXJpZkZvbnRzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0WyJBZG9iZSBKZW5zb24iXSA9IHRydWU7CiAgdFsiQWRvYmUgVGV4dCJdID0gdHJ1ZTsKICB0LkFsYmVydHVzID0gdHJ1ZTsKICB0LkFsZHVzID0gdHJ1ZTsKICB0LkFsZXhhbmRyaWEgPSB0cnVlOwogIHQuQWxnZXJpYW4gPSB0cnVlOwogIHRbIkFtZXJpY2FuIFR5cGV3cml0ZXIiXSA9IHRydWU7CiAgdC5BbnRpcXVhID0gdHJ1ZTsKICB0LkFwZXggPSB0cnVlOwogIHQuQXJubyA9IHRydWU7CiAgdC5Bc3RlciA9IHRydWU7CiAgdC5BdXJvcmEgPSB0cnVlOwogIHQuQmFza2VydmlsbGUgPSB0cnVlOwogIHQuQmVsbCA9IHRydWU7CiAgdC5CZW1ibyA9IHRydWU7CiAgdFsiQmVtYm8gU2Nob29sYm9vayJdID0gdHJ1ZTsKICB0LkJlbmd1aWF0ID0gdHJ1ZTsKICB0WyJCZXJrZWxleSBPbGQgU3R5bGUiXSA9IHRydWU7CiAgdFsiQmVybmhhcmQgTW9kZXJuIl0gPSB0cnVlOwogIHRbIkJlcnRob2xkIENpdHkiXSA9IHRydWU7CiAgdC5Cb2RvbmkgPSB0cnVlOwogIHRbIkJhdWVyIEJvZG9uaSJdID0gdHJ1ZTsKICB0WyJCb29rIEFudGlxdWEiXSA9IHRydWU7CiAgdC5Cb29rbWFuID0gdHJ1ZTsKICB0WyJCb3JkZWF1eCBSb21hbiJdID0gdHJ1ZTsKICB0WyJDYWxpZm9ybmlhbiBGQiJdID0gdHJ1ZTsKICB0LkNhbGlzdG8gPSB0cnVlOwogIHQuQ2FsdmVydCA9IHRydWU7CiAgdC5DYXBpdGFscyA9IHRydWU7CiAgdC5DYW1icmlhID0gdHJ1ZTsKICB0LkNhcnRpZXIgPSB0cnVlOwogIHQuQ2FzbG9uID0gdHJ1ZTsKICB0LkNhdHVsbCA9IHRydWU7CiAgdC5DZW50YXVyID0gdHJ1ZTsKICB0WyJDZW50dXJ5IE9sZCBTdHlsZSJdID0gdHJ1ZTsKICB0WyJDZW50dXJ5IFNjaG9vbGJvb2siXSA9IHRydWU7CiAgdC5DaGFwYXJyYWwgPSB0cnVlOwogIHRbIkNoYXJpcyBTSUwiXSA9IHRydWU7CiAgdC5DaGVsdGVuaGFtID0gdHJ1ZTsKICB0WyJDaG9sbGEgU2xhYiJdID0gdHJ1ZTsKICB0LkNsYXJlbmRvbiA9IHRydWU7CiAgdC5DbGVhcmZhY2UgPSB0cnVlOwogIHQuQ29jaGluID0gdHJ1ZTsKICB0LkNvbG9ubmEgPSB0cnVlOwogIHRbIkNvbXB1dGVyIE1vZGVybiJdID0gdHJ1ZTsKICB0WyJDb25jcmV0ZSBSb21hbiJdID0gdHJ1ZTsKICB0LkNvbnN0YW50aWEgPSB0cnVlOwogIHRbIkNvb3BlciBCbGFjayJdID0gdHJ1ZTsKICB0LkNvcm9uYSA9IHRydWU7CiAgdC5FY290eXBlID0gdHJ1ZTsKICB0LkVneXB0aWVubmUgPSB0cnVlOwogIHQuRWxlcGhhbnQgPSB0cnVlOwogIHQuRXhjZWxzaW9yID0gdHJ1ZTsKICB0LkZhaXJmaWVsZCA9IHRydWU7CiAgdFsiRkYgU2NhbGEiXSA9IHRydWU7CiAgdC5Gb2xrYXJkID0gdHJ1ZTsKICB0LkZvb3RsaWdodCA9IHRydWU7CiAgdC5GcmVlU2VyaWYgPSB0cnVlOwogIHRbIkZyaXogUXVhZHJhdGEiXSA9IHRydWU7CiAgdC5HYXJhbW9uZCA9IHRydWU7CiAgdC5HZW50aXVtID0gdHJ1ZTsKICB0Lkdlb3JnaWEgPSB0cnVlOwogIHQuR2xvdWNlc3RlciA9IHRydWU7CiAgdFsiR291ZHkgT2xkIFN0eWxlIl0gPSB0cnVlOwogIHRbIkdvdWR5IFNjaG9vbGJvb2siXSA9IHRydWU7CiAgdFsiR291ZHkgUHJvIEZvbnQiXSA9IHRydWU7CiAgdC5HcmFuam9uID0gdHJ1ZTsKICB0WyJHdWFyZGlhbiBFZ3lwdGlhbiJdID0gdHJ1ZTsKICB0LkhlYXRoZXIgPSB0cnVlOwogIHQuSGVyY3VsZXMgPSB0cnVlOwogIHRbIkhpZ2ggVG93ZXIgVGV4dCJdID0gdHJ1ZTsKICB0Lkhpcm9zaGlnZSA9IHRydWU7CiAgdFsiSG9lZmxlciBUZXh0Il0gPSB0cnVlOwogIHRbIkh1bWFuYSBTZXJpZiJdID0gdHJ1ZTsKICB0LkltcHJpbnQgPSB0cnVlOwogIHRbIklvbmljIE5vLiA1Il0gPSB0cnVlOwogIHQuSmFuc29uID0gdHJ1ZTsKICB0LkpvYW5uYSA9IHRydWU7CiAgdC5Lb3Jpbm5hID0gdHJ1ZTsKICB0LkxleGljb24gPSB0cnVlOwogIHRbIkxpYmVyYXRpb24gU2VyaWYiXSA9IHRydWU7CiAgdFsiTGludXggTGliZXJ0aW5lIl0gPSB0cnVlOwogIHQuTGl0ZXJhdHVybmF5YSA9IHRydWU7CiAgdC5MdWNpZGEgPSB0cnVlOwogIHRbIkx1Y2lkYSBCcmlnaHQiXSA9IHRydWU7CiAgdC5NZWxpb3IgPSB0cnVlOwogIHQuTWVtcGhpcyA9IHRydWU7CiAgdC5NaWxsZXIgPSB0cnVlOwogIHQuTWluaW9uID0gdHJ1ZTsKICB0Lk1vZGVybiA9IHRydWU7CiAgdFsiTW9uYSBMaXNhIl0gPSB0cnVlOwogIHRbIk1ycyBFYXZlcyJdID0gdHJ1ZTsKICB0WyJNUyBTZXJpZiJdID0gdHJ1ZTsKICB0WyJNdXNlbyBTbGFiIl0gPSB0cnVlOwogIHRbIk5ldyBZb3JrIl0gPSB0cnVlOwogIHRbIk5pbWJ1cyBSb21hbiJdID0gdHJ1ZTsKICB0WyJOUFMgUmF3bGluc29uIFJvYWR3YXkiXSA9IHRydWU7CiAgdC5OdXB0aWFsU2NyaXB0ID0gdHJ1ZTsKICB0LlBhbGF0aW5vID0gdHJ1ZTsKICB0LlBlcnBldHVhID0gdHJ1ZTsKICB0LlBsYW50aW4gPSB0cnVlOwogIHRbIlBsYW50aW4gU2Nob29sYm9vayJdID0gdHJ1ZTsKICB0LlBsYXliaWxsID0gdHJ1ZTsKICB0WyJQb29yIFJpY2hhcmQiXSA9IHRydWU7CiAgdFsiUmF3bGluc29uIFJvYWR3YXkiXSA9IHRydWU7CiAgdC5SZW5hdWx0ID0gdHJ1ZTsKICB0LlJlcXVpZW0gPSB0cnVlOwogIHQuUm9ja3dlbGwgPSB0cnVlOwogIHQuUm9tYW4gPSB0cnVlOwogIHRbIlJvdGlzIFNlcmlmIl0gPSB0cnVlOwogIHQuU2Fib24gPSB0cnVlOwogIHQuU2NhbGEgPSB0cnVlOwogIHQuU2VhZ3VsbCA9IHRydWU7CiAgdC5TaXN0aW5hID0gdHJ1ZTsKICB0LlNvdXZlbmlyID0gdHJ1ZTsKICB0LlNUSVggPSB0cnVlOwogIHRbIlN0b25lIEluZm9ybWFsIl0gPSB0cnVlOwogIHRbIlN0b25lIFNlcmlmIl0gPSB0cnVlOwogIHQuU3lsZmFlbiA9IHRydWU7CiAgdC5UaW1lcyA9IHRydWU7CiAgdC5UcmFqYW4gPSB0cnVlOwogIHRbIlRyaW5pdMOpIl0gPSB0cnVlOwogIHRbIlRydW1wIE1lZGlhZXZhbCJdID0gdHJ1ZTsKICB0LlV0b3BpYSA9IHRydWU7CiAgdFsiVmFsZSBUeXBlIl0gPSB0cnVlOwogIHRbIkJpdHN0cmVhbSBWZXJhIl0gPSB0cnVlOwogIHRbIlZlcmEgU2VyaWYiXSA9IHRydWU7CiAgdC5WZXJzYWlsbGVzID0gdHJ1ZTsKICB0LldhbnRlZCA9IHRydWU7CiAgdC5XZWlzcyA9IHRydWU7CiAgdFsiV2lkZSBMYXRpbiJdID0gdHJ1ZTsKICB0LldpbmRzb3IgPSB0cnVlOwogIHQuWElUUyA9IHRydWU7Cn0pOwpleHBvcnRzLmdldFNlcmlmRm9udHMgPSBnZXRTZXJpZkZvbnRzOwp2YXIgZ2V0U3ltYm9sc0ZvbnRzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0LkRpbmdiYXRzID0gdHJ1ZTsKICB0LlN5bWJvbCA9IHRydWU7CiAgdC5aYXBmRGluZ2JhdHMgPSB0cnVlOwp9KTsKZXhwb3J0cy5nZXRTeW1ib2xzRm9udHMgPSBnZXRTeW1ib2xzRm9udHM7CnZhciBnZXRHbHlwaE1hcEZvclN0YW5kYXJkRm9udHMgPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogIHRbMl0gPSAxMDsKICB0WzNdID0gMzI7CiAgdFs0XSA9IDMzOwogIHRbNV0gPSAzNDsKICB0WzZdID0gMzU7CiAgdFs3XSA9IDM2OwogIHRbOF0gPSAzNzsKICB0WzldID0gMzg7CiAgdFsxMF0gPSAzOTsKICB0WzExXSA9IDQwOwogIHRbMTJdID0gNDE7CiAgdFsxM10gPSA0MjsKICB0WzE0XSA9IDQzOwogIHRbMTVdID0gNDQ7CiAgdFsxNl0gPSA0NTsKICB0WzE3XSA9IDQ2OwogIHRbMThdID0gNDc7CiAgdFsxOV0gPSA0ODsKICB0WzIwXSA9IDQ5OwogIHRbMjFdID0gNTA7CiAgdFsyMl0gPSA1MTsKICB0WzIzXSA9IDUyOwogIHRbMjRdID0gNTM7CiAgdFsyNV0gPSA1NDsKICB0WzI2XSA9IDU1OwogIHRbMjddID0gNTY7CiAgdFsyOF0gPSA1NzsKICB0WzI5XSA9IDU4OwogIHRbMzBdID0gODk0OwogIHRbMzFdID0gNjA7CiAgdFszMl0gPSA2MTsKICB0WzMzXSA9IDYyOwogIHRbMzRdID0gNjM7CiAgdFszNV0gPSA2NDsKICB0WzM2XSA9IDY1OwogIHRbMzddID0gNjY7CiAgdFszOF0gPSA2NzsKICB0WzM5XSA9IDY4OwogIHRbNDBdID0gNjk7CiAgdFs0MV0gPSA3MDsKICB0WzQyXSA9IDcxOwogIHRbNDNdID0gNzI7CiAgdFs0NF0gPSA3MzsKICB0WzQ1XSA9IDc0OwogIHRbNDZdID0gNzU7CiAgdFs0N10gPSA3NjsKICB0WzQ4XSA9IDc3OwogIHRbNDldID0gNzg7CiAgdFs1MF0gPSA3OTsKICB0WzUxXSA9IDgwOwogIHRbNTJdID0gODE7CiAgdFs1M10gPSA4MjsKICB0WzU0XSA9IDgzOwogIHRbNTVdID0gODQ7CiAgdFs1Nl0gPSA4NTsKICB0WzU3XSA9IDg2OwogIHRbNThdID0gODc7CiAgdFs1OV0gPSA4ODsKICB0WzYwXSA9IDg5OwogIHRbNjFdID0gOTA7CiAgdFs2Ml0gPSA5MTsKICB0WzYzXSA9IDkyOwogIHRbNjRdID0gOTM7CiAgdFs2NV0gPSA5NDsKICB0WzY2XSA9IDk1OwogIHRbNjddID0gOTY7CiAgdFs2OF0gPSA5NzsKICB0WzY5XSA9IDk4OwogIHRbNzBdID0gOTk7CiAgdFs3MV0gPSAxMDA7CiAgdFs3Ml0gPSAxMDE7CiAgdFs3M10gPSAxMDI7CiAgdFs3NF0gPSAxMDM7CiAgdFs3NV0gPSAxMDQ7CiAgdFs3Nl0gPSAxMDU7CiAgdFs3N10gPSAxMDY7CiAgdFs3OF0gPSAxMDc7CiAgdFs3OV0gPSAxMDg7CiAgdFs4MF0gPSAxMDk7CiAgdFs4MV0gPSAxMTA7CiAgdFs4Ml0gPSAxMTE7CiAgdFs4M10gPSAxMTI7CiAgdFs4NF0gPSAxMTM7CiAgdFs4NV0gPSAxMTQ7CiAgdFs4Nl0gPSAxMTU7CiAgdFs4N10gPSAxMTY7CiAgdFs4OF0gPSAxMTc7CiAgdFs4OV0gPSAxMTg7CiAgdFs5MF0gPSAxMTk7CiAgdFs5MV0gPSAxMjA7CiAgdFs5Ml0gPSAxMjE7CiAgdFs5M10gPSAxMjI7CiAgdFs5NF0gPSAxMjM7CiAgdFs5NV0gPSAxMjQ7CiAgdFs5Nl0gPSAxMjU7CiAgdFs5N10gPSAxMjY7CiAgdFs5OF0gPSAxOTY7CiAgdFs5OV0gPSAxOTc7CiAgdFsxMDBdID0gMTk5OwogIHRbMTAxXSA9IDIwMTsKICB0WzEwMl0gPSAyMDk7CiAgdFsxMDNdID0gMjE0OwogIHRbMTA0XSA9IDIyMDsKICB0WzEwNV0gPSAyMjU7CiAgdFsxMDZdID0gMjI0OwogIHRbMTA3XSA9IDIyNjsKICB0WzEwOF0gPSAyMjg7CiAgdFsxMDldID0gMjI3OwogIHRbMTEwXSA9IDIyOTsKICB0WzExMV0gPSAyMzE7CiAgdFsxMTJdID0gMjMzOwogIHRbMTEzXSA9IDIzMjsKICB0WzExNF0gPSAyMzQ7CiAgdFsxMTVdID0gMjM1OwogIHRbMTE2XSA9IDIzNzsKICB0WzExN10gPSAyMzY7CiAgdFsxMThdID0gMjM4OwogIHRbMTE5XSA9IDIzOTsKICB0WzEyMF0gPSAyNDE7CiAgdFsxMjFdID0gMjQzOwogIHRbMTIyXSA9IDI0MjsKICB0WzEyM10gPSAyNDQ7CiAgdFsxMjRdID0gMjQ2OwogIHRbMTI1XSA9IDI0NTsKICB0WzEyNl0gPSAyNTA7CiAgdFsxMjddID0gMjQ5OwogIHRbMTI4XSA9IDI1MTsKICB0WzEyOV0gPSAyNTI7CiAgdFsxMzBdID0gODIyNDsKICB0WzEzMV0gPSAxNzY7CiAgdFsxMzJdID0gMTYyOwogIHRbMTMzXSA9IDE2MzsKICB0WzEzNF0gPSAxNjc7CiAgdFsxMzVdID0gODIyNjsKICB0WzEzNl0gPSAxODI7CiAgdFsxMzddID0gMjIzOwogIHRbMTM4XSA9IDE3NDsKICB0WzEzOV0gPSAxNjk7CiAgdFsxNDBdID0gODQ4MjsKICB0WzE0MV0gPSAxODA7CiAgdFsxNDJdID0gMTY4OwogIHRbMTQzXSA9IDg4MDA7CiAgdFsxNDRdID0gMTk4OwogIHRbMTQ1XSA9IDIxNjsKICB0WzE0Nl0gPSA4NzM0OwogIHRbMTQ3XSA9IDE3NzsKICB0WzE0OF0gPSA4ODA0OwogIHRbMTQ5XSA9IDg4MDU7CiAgdFsxNTBdID0gMTY1OwogIHRbMTUxXSA9IDE4MTsKICB0WzE1Ml0gPSA4NzA2OwogIHRbMTUzXSA9IDg3MjE7CiAgdFsxNTRdID0gODcxOTsKICB0WzE1Nl0gPSA4NzQ3OwogIHRbMTU3XSA9IDE3MDsKICB0WzE1OF0gPSAxODY7CiAgdFsxNTldID0gODQ4NjsKICB0WzE2MF0gPSAyMzA7CiAgdFsxNjFdID0gMjQ4OwogIHRbMTYyXSA9IDE5MTsKICB0WzE2M10gPSAxNjE7CiAgdFsxNjRdID0gMTcyOwogIHRbMTY1XSA9IDg3MzA7CiAgdFsxNjZdID0gNDAyOwogIHRbMTY3XSA9IDg3NzY7CiAgdFsxNjhdID0gODcxMDsKICB0WzE2OV0gPSAxNzE7CiAgdFsxNzBdID0gMTg3OwogIHRbMTcxXSA9IDgyMzA7CiAgdFsyMTBdID0gMjE4OwogIHRbMjIzXSA9IDcxMTsKICB0WzIyNF0gPSAzMjE7CiAgdFsyMjVdID0gMzIyOwogIHRbMjI3XSA9IDM1MzsKICB0WzIyOV0gPSAzODI7CiAgdFsyMzRdID0gMjUzOwogIHRbMjUyXSA9IDI2MzsKICB0WzI1M10gPSAyNjg7CiAgdFsyNTRdID0gMjY5OwogIHRbMjU4XSA9IDI1ODsKICB0WzI2MF0gPSAyNjA7CiAgdFsyNjFdID0gMjYxOwogIHRbMjY1XSA9IDI4MDsKICB0WzI2Nl0gPSAyODE7CiAgdFsyNjhdID0gMjgzOwogIHRbMjY5XSA9IDMxMzsKICB0WzI3NV0gPSAzMjM7CiAgdFsyNzZdID0gMzI0OwogIHRbMjc4XSA9IDMyODsKICB0WzI4NF0gPSAzNDU7CiAgdFsyODVdID0gMzQ2OwogIHRbMjg2XSA9IDM0NzsKICB0WzI5Ml0gPSAzNjc7CiAgdFsyOTVdID0gMzc3OwogIHRbMjk2XSA9IDM3ODsKICB0WzI5OF0gPSAzODA7CiAgdFszMDVdID0gOTYzOwogIHRbMzA2XSA9IDk2NDsKICB0WzMwN10gPSA5NjY7CiAgdFszMDhdID0gODIxNTsKICB0WzMwOV0gPSA4MjUyOwogIHRbMzEwXSA9IDgzMTk7CiAgdFszMTFdID0gODM1OTsKICB0WzMxMl0gPSA4NTkyOwogIHRbMzEzXSA9IDg1OTM7CiAgdFszMzddID0gOTU1MjsKICB0WzQ5M10gPSAxMDM5OwogIHRbNDk0XSA9IDEwNDA7CiAgdFs3MDVdID0gMTUyNDsKICB0WzcwNl0gPSA4MzYyOwogIHRbNzEwXSA9IDY0Mjg4OwogIHRbNzExXSA9IDY0Mjk4OwogIHRbNzU5XSA9IDE2MTc7CiAgdFs3NjFdID0gMTc3NjsKICB0Wzc2M10gPSAxNzc4OwogIHRbNzc1XSA9IDE2NTI7CiAgdFs3NzddID0gMTc2NDsKICB0Wzc3OF0gPSAxNzgwOwogIHRbNzc5XSA9IDE3ODE7CiAgdFs3ODBdID0gMTc4MjsKICB0Wzc4Ml0gPSA3NzE7CiAgdFs3ODNdID0gNjQ3MjY7CiAgdFs3ODZdID0gODM2MzsKICB0Wzc4OF0gPSA4NTMyOwogIHRbNzkwXSA9IDc2ODsKICB0Wzc5MV0gPSA3Njk7CiAgdFs3OTJdID0gNzY4OwogIHRbNzk1XSA9IDgwMzsKICB0Wzc5N10gPSA2NDMzNjsKICB0Wzc5OF0gPSA2NDMzNzsKICB0Wzc5OV0gPSA2NDM0MjsKICB0WzgwMF0gPSA2NDM0MzsKICB0WzgwMV0gPSA2NDM0NDsKICB0WzgwMl0gPSA2NDM0NTsKICB0WzgwM10gPSA2NDM2MjsKICB0WzgwNF0gPSA2NDM2MzsKICB0WzgwNV0gPSA2NDM2NDsKICB0WzI0MjRdID0gNzgyMTsKICB0WzI0MjVdID0gNzgyMjsKICB0WzI0MjZdID0gNzgyMzsKICB0WzI0MjddID0gNzgyNDsKICB0WzI0MjhdID0gNzgyNTsKICB0WzI0MjldID0gNzgyNjsKICB0WzI0MzBdID0gNzgyNzsKICB0WzI0MzNdID0gNzY4MjsKICB0WzI2NzhdID0gODA0NTsKICB0WzI2NzldID0gODA0NjsKICB0WzI4MzBdID0gMTU1MjsKICB0WzI4MzhdID0gNjg2OwogIHRbMjg0MF0gPSA3NTE7CiAgdFsyODQyXSA9IDc1MzsKICB0WzI4NDNdID0gNzU0OwogIHRbMjg0NF0gPSA3NTU7CiAgdFsyODQ2XSA9IDc1NzsKICB0WzI4NTZdID0gNzY3OwogIHRbMjg1N10gPSA4NDg7CiAgdFsyODU4XSA9IDg0OTsKICB0WzI4NjJdID0gODUzOwogIHRbMjg2M10gPSA4NTQ7CiAgdFsyODY0XSA9IDg1NTsKICB0WzI4NjVdID0gODYxOwogIHRbMjg2Nl0gPSA4NjI7CiAgdFsyOTA2XSA9IDc0NjA7CiAgdFsyOTA4XSA9IDc0NjI7CiAgdFsyOTA5XSA9IDc0NjM7CiAgdFsyOTEwXSA9IDc0NjQ7CiAgdFsyOTEyXSA9IDc0NjY7CiAgdFsyOTEzXSA9IDc0Njc7CiAgdFsyOTE0XSA9IDc0Njg7CiAgdFsyOTE2XSA9IDc0NzA7CiAgdFsyOTE3XSA9IDc0NzE7CiAgdFsyOTE4XSA9IDc0NzI7CiAgdFsyOTIwXSA9IDc0NzQ7CiAgdFsyOTIxXSA9IDc0NzU7CiAgdFsyOTIyXSA9IDc0NzY7CiAgdFsyOTI0XSA9IDc0Nzg7CiAgdFsyOTI1XSA9IDc0Nzk7CiAgdFsyOTI2XSA9IDc0ODA7CiAgdFsyOTI4XSA9IDc0ODI7CiAgdFsyOTI5XSA9IDc0ODM7CiAgdFsyOTMwXSA9IDc0ODQ7CiAgdFsyOTMyXSA9IDc0ODY7CiAgdFsyOTMzXSA9IDc0ODc7CiAgdFsyOTM0XSA9IDc0ODg7CiAgdFsyOTM2XSA9IDc0OTA7CiAgdFsyOTM3XSA9IDc0OTE7CiAgdFsyOTM4XSA9IDc0OTI7CiAgdFsyOTQwXSA9IDc0OTQ7CiAgdFsyOTQxXSA9IDc0OTU7CiAgdFsyOTQyXSA9IDc0OTY7CiAgdFsyOTQ0XSA9IDc0OTg7CiAgdFsyOTQ2XSA9IDc1MDA7CiAgdFsyOTQ4XSA9IDc1MDI7CiAgdFsyOTUwXSA9IDc1MDQ7CiAgdFsyOTUxXSA9IDc1MDU7CiAgdFsyOTUyXSA9IDc1MDY7CiAgdFsyOTU0XSA9IDc1MDg7CiAgdFsyOTU1XSA9IDc1MDk7CiAgdFsyOTU2XSA9IDc1MTA7CiAgdFsyOTU4XSA9IDc1MTI7CiAgdFsyOTU5XSA9IDc1MTM7CiAgdFsyOTYwXSA9IDc1MTQ7CiAgdFsyOTYyXSA9IDc1MTY7CiAgdFsyOTYzXSA9IDc1MTc7CiAgdFsyOTY0XSA9IDc1MTg7CiAgdFsyOTY2XSA9IDc1MjA7CiAgdFsyOTY3XSA9IDc1MjE7CiAgdFsyOTY4XSA9IDc1MjI7CiAgdFsyOTcwXSA9IDc1MjQ7CiAgdFsyOTcxXSA9IDc1MjU7CiAgdFsyOTcyXSA9IDc1MjY7CiAgdFsyOTc0XSA9IDc1Mjg7CiAgdFsyOTc1XSA9IDc1Mjk7CiAgdFsyOTc2XSA9IDc1MzA7CiAgdFsyOTc4XSA9IDE1Mzc7CiAgdFsyOTc5XSA9IDE1Mzg7CiAgdFsyOTgwXSA9IDE1Mzk7CiAgdFsyOTgyXSA9IDE1NDk7CiAgdFsyOTgzXSA9IDE1NTE7CiAgdFsyOTg0XSA9IDE1NTI7CiAgdFsyOTg2XSA9IDE1NTQ7CiAgdFsyOTg3XSA9IDE1NTU7CiAgdFsyOTg4XSA9IDE1NTY7CiAgdFsyOTkwXSA9IDE2MjM7CiAgdFsyOTkxXSA9IDE2MjQ7CiAgdFsyOTk1XSA9IDE3NzU7CiAgdFsyOTk5XSA9IDE3OTE7CiAgdFszMDAyXSA9IDY0MjkwOwogIHRbMzAwM10gPSA2NDI5MTsKICB0WzMwMDRdID0gNjQyOTI7CiAgdFszMDA2XSA9IDY0Mjk0OwogIHRbMzAwN10gPSA2NDI5NTsKICB0WzMwMDhdID0gNjQyOTY7CiAgdFszMDExXSA9IDE5MDA7CiAgdFszMDE0XSA9IDgyMjM7CiAgdFszMDE1XSA9IDgyNDQ7CiAgdFszMDE3XSA9IDc1MzI7CiAgdFszMDE4XSA9IDc1MzM7CiAgdFszMDE5XSA9IDc1MzQ7CiAgdFszMDc1XSA9IDc1OTA7CiAgdFszMDc2XSA9IDc1OTE7CiAgdFszMDc5XSA9IDc1OTQ7CiAgdFszMDgwXSA9IDc1OTU7CiAgdFszMDgzXSA9IDc1OTg7CiAgdFszMDg0XSA9IDc1OTk7CiAgdFszMDg3XSA9IDc2MDI7CiAgdFszMDg4XSA9IDc2MDM7CiAgdFszMDkxXSA9IDc2MDY7CiAgdFszMDkyXSA9IDc2MDc7CiAgdFszMDk1XSA9IDc2MTA7CiAgdFszMDk2XSA9IDc2MTE7CiAgdFszMDk5XSA9IDc2MTQ7CiAgdFszMTAwXSA9IDc2MTU7CiAgdFszMTAzXSA9IDc2MTg7CiAgdFszMTA0XSA9IDc2MTk7CiAgdFszMTA3XSA9IDgzMzc7CiAgdFszMTA4XSA9IDgzMzg7CiAgdFszMTE2XSA9IDE4ODQ7CiAgdFszMTE5XSA9IDE4ODU7CiAgdFszMTIwXSA9IDE4ODU7CiAgdFszMTIzXSA9IDE4ODY7CiAgdFszMTI0XSA9IDE4ODY7CiAgdFszMTI3XSA9IDE4ODc7CiAgdFszMTI4XSA9IDE4ODc7CiAgdFszMTMxXSA9IDE4ODg7CiAgdFszMTMyXSA9IDE4ODg7CiAgdFszMTM1XSA9IDE4ODk7CiAgdFszMTM2XSA9IDE4ODk7CiAgdFszMTM5XSA9IDE4OTA7CiAgdFszMTQwXSA9IDE4OTA7CiAgdFszMTQzXSA9IDE4OTE7CiAgdFszMTQ0XSA9IDE4OTE7CiAgdFszMTQ3XSA9IDE4OTI7CiAgdFszMTQ4XSA9IDE4OTI7CiAgdFszMTUzXSA9IDU4MDsKICB0WzMxNTRdID0gNTgxOwogIHRbMzE1N10gPSA1ODQ7CiAgdFszMTU4XSA9IDU4NTsKICB0WzMxNjFdID0gNTg4OwogIHRbMzE2Ml0gPSA1ODk7CiAgdFszMTY1XSA9IDg5MTsKICB0WzMxNjZdID0gODkyOwogIHRbMzE2OV0gPSAxMjc0OwogIHRbMzE3MF0gPSAxMjc1OwogIHRbMzE3M10gPSAxMjc4OwogIHRbMzE3NF0gPSAxMjc5OwogIHRbMzE4MV0gPSA3NjIyOwogIHRbMzE4Ml0gPSA3NjIzOwogIHRbMzI4Ml0gPSAxMTc5OTsKICB0WzMzMTZdID0gNTc4OwogIHRbMzM3OV0gPSA0Mjc4NTsKICB0WzMzOTNdID0gMTE1OTsKICB0WzM0MTZdID0gODM3NzsKfSk7CmV4cG9ydHMuZ2V0R2x5cGhNYXBGb3JTdGFuZGFyZEZvbnRzID0gZ2V0R2x5cGhNYXBGb3JTdGFuZGFyZEZvbnRzOwp2YXIgZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JBcmlhbEJsYWNrID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0WzIyN10gPSAzMjI7CiAgdFsyNjRdID0gMjYxOwogIHRbMjkxXSA9IDM0NjsKfSk7CmV4cG9ydHMuZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JBcmlhbEJsYWNrID0gZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JBcmlhbEJsYWNrOwp2YXIgZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JDYWxpYnJpID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0WzFdID0gMzI7CiAgdFs0XSA9IDY1OwogIHRbMTddID0gNjY7CiAgdFsxOF0gPSA2NzsKICB0WzI0XSA9IDY4OwogIHRbMjhdID0gNjk7CiAgdFszOF0gPSA3MDsKICB0WzM5XSA9IDcxOwogIHRbNDRdID0gNzI7CiAgdFs0N10gPSA3MzsKICB0WzU4XSA9IDc0OwogIHRbNjBdID0gNzU7CiAgdFs2Ml0gPSA3NjsKICB0WzY4XSA9IDc3OwogIHRbNjldID0gNzg7CiAgdFs3NV0gPSA3OTsKICB0Wzg3XSA9IDgwOwogIHRbODldID0gODE7CiAgdFs5MF0gPSA4MjsKICB0Wzk0XSA9IDgzOwogIHRbMTAwXSA9IDg0OwogIHRbMTA0XSA9IDg1OwogIHRbMTE1XSA9IDg2OwogIHRbMTE2XSA9IDg3OwogIHRbMTIxXSA9IDg4OwogIHRbMTIyXSA9IDg5OwogIHRbMTI3XSA9IDkwOwogIHRbMjU4XSA9IDk3OwogIHRbMjY4XSA9IDI2MTsKICB0WzI3MV0gPSA5ODsKICB0WzI3Ml0gPSA5OTsKICB0WzI3M10gPSAyNjM7CiAgdFsyODJdID0gMTAwOwogIHRbMjg2XSA9IDEwMTsKICB0WzI5NV0gPSAyODE7CiAgdFsyOTZdID0gMTAyOwogIHRbMzM2XSA9IDEwMzsKICB0WzM0Nl0gPSAxMDQ7CiAgdFszNDldID0gMTA1OwogIHRbMzYxXSA9IDEwNjsKICB0WzM2NF0gPSAxMDc7CiAgdFszNjddID0gMTA4OwogIHRbMzcxXSA9IDMyMjsKICB0WzM3M10gPSAxMDk7CiAgdFszNzRdID0gMTEwOwogIHRbMzgxXSA9IDExMTsKICB0WzM4M10gPSAyNDM7CiAgdFszOTNdID0gMTEyOwogIHRbMzk1XSA9IDExMzsKICB0WzM5Nl0gPSAxMTQ7CiAgdFs0MDBdID0gMTE1OwogIHRbNDAxXSA9IDM0NzsKICB0WzQxMF0gPSAxMTY7CiAgdFs0MzddID0gMTE3OwogIHRbNDQ4XSA9IDExODsKICB0WzQ0OV0gPSAxMTk7CiAgdFs0NTRdID0gMTIwOwogIHRbNDU1XSA9IDEyMTsKICB0WzQ2MF0gPSAxMjI7CiAgdFs0NjNdID0gMzgwOwogIHRbODUzXSA9IDQ0OwogIHRbODU1XSA9IDU4OwogIHRbODU2XSA9IDQ2OwogIHRbODc2XSA9IDQ3OwogIHRbODc4XSA9IDQ1OwogIHRbODgyXSA9IDQ1OwogIHRbODk0XSA9IDQwOwogIHRbODk1XSA9IDQxOwogIHRbODk2XSA9IDkxOwogIHRbODk3XSA9IDkzOwogIHRbOTIzXSA9IDY0OwogIHRbMTAwNF0gPSA0ODsKICB0WzEwMDVdID0gNDk7CiAgdFsxMDA2XSA9IDUwOwogIHRbMTAwN10gPSA1MTsKICB0WzEwMDhdID0gNTI7CiAgdFsxMDA5XSA9IDUzOwogIHRbMTAxMF0gPSA1NDsKICB0WzEwMTFdID0gNTU7CiAgdFsxMDEyXSA9IDU2OwogIHRbMTAxM10gPSA1NzsKICB0WzEwODFdID0gMzc7CiAgdFsxMDg1XSA9IDQzOwogIHRbMTA4Nl0gPSA0NTsKfSk7CmV4cG9ydHMuZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JDYWxpYnJpID0gZ2V0U3VwcGxlbWVudGFsR2x5cGhNYXBGb3JDYWxpYnJpOwoKLyoqKi8gfSksCi8qIDIyOCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7Cgp2YXIgZ2V0TG9va3VwVGFibGVGYWN0b3J5ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpLmdldExvb2t1cFRhYmxlRmFjdG9yeTsKdmFyIGdldFNwZWNpYWxQVUFTeW1ib2xzID0gZ2V0TG9va3VwVGFibGVGYWN0b3J5KGZ1bmN0aW9uICh0KSB7CiB0WzYzNzIxXSA9IDB4MDBhOTsKIHRbNjMxOTNdID0gMHgwMGE5OwogdFs2MzcyMF0gPSAweDAwYWU7CiB0WzYzMTk0XSA9IDB4MDBhZTsKIHRbNjM3MjJdID0gMHgyMTIyOwogdFs2MzE5NV0gPSAweDIxMjI7CiB0WzYzNzI5XSA9IDB4MjNhNzsKIHRbNjM3MzBdID0gMHgyM2E4OwogdFs2MzczMV0gPSAweDIzYTk7CiB0WzYzNzQwXSA9IDB4MjNhYjsKIHRbNjM3NDFdID0gMHgyM2FjOwogdFs2Mzc0Ml0gPSAweDIzYWQ7CiB0WzYzNzI2XSA9IDB4MjNhMTsKIHRbNjM3MjddID0gMHgyM2EyOwogdFs2MzcyOF0gPSAweDIzYTM7CiB0WzYzNzM3XSA9IDB4MjNhNDsKIHRbNjM3MzhdID0gMHgyM2E1OwogdFs2MzczOV0gPSAweDIzYTY7CiB0WzYzNzIzXSA9IDB4MjM5YjsKIHRbNjM3MjRdID0gMHgyMzljOwogdFs2MzcyNV0gPSAweDIzOWQ7CiB0WzYzNzM0XSA9IDB4MjM5ZTsKIHRbNjM3MzVdID0gMHgyMzlmOwogdFs2MzczNl0gPSAweDIzYTA7Cn0pOwpmdW5jdGlvbiBtYXBTcGVjaWFsVW5pY29kZVZhbHVlcyhjb2RlKSB7CiBpZiAoY29kZSA+PSAweGZmZjAgJiYgY29kZSA8PSAweGZmZmYpIHsKICByZXR1cm4gMDsKIH0gZWxzZSBpZiAoY29kZSA+PSAweGY2MDAgJiYgY29kZSA8PSAweGY4ZmYpIHsKICByZXR1cm4gZ2V0U3BlY2lhbFBVQVN5bWJvbHMoKVtjb2RlXSB8fCBjb2RlOwogfSBlbHNlIGlmIChjb2RlID09PSAweDAwYWQpIHsKICByZXR1cm4gMHgwMDJkOwogfQogcmV0dXJuIGNvZGU7Cn0KZnVuY3Rpb24gZ2V0VW5pY29kZUZvckdseXBoKG5hbWUsIGdseXBoc1VuaWNvZGVNYXApIHsKIHZhciB1bmljb2RlID0gZ2x5cGhzVW5pY29kZU1hcFtuYW1lXTsKIGlmICh1bmljb2RlICE9PSB1bmRlZmluZWQpIHsKICByZXR1cm4gdW5pY29kZTsKIH0KIGlmICghbmFtZSkgewogIHJldHVybiAtMTsKIH0KIGlmIChuYW1lWzBdID09PSAidSIpIHsKICB2YXIgbmFtZUxlbiA9IG5hbWUubGVuZ3RoLCBoZXhTdHI7CiAgaWYgKG5hbWVMZW4gPT09IDcgJiYgbmFtZVsxXSA9PT0gIm4iICYmIG5hbWVbMl0gPT09ICJpIikgewogICBoZXhTdHIgPSBuYW1lLnN1YnN0cmluZygzKTsKICB9IGVsc2UgaWYgKG5hbWVMZW4gPj0gNSAmJiBuYW1lTGVuIDw9IDcpIHsKICAgaGV4U3RyID0gbmFtZS5zdWJzdHJpbmcoMSk7CiAgfSBlbHNlIHsKICAgcmV0dXJuIC0xOwogIH0KICBpZiAoaGV4U3RyID09PSBoZXhTdHIudG9VcHBlckNhc2UoKSkgewogICB1bmljb2RlID0gcGFyc2VJbnQoaGV4U3RyLCAxNik7CiAgIGlmICh1bmljb2RlID49IDApIHsKICAgIHJldHVybiB1bmljb2RlOwogICB9CiAgfQogfQogcmV0dXJuIC0xOwp9CnZhciBVbmljb2RlUmFuZ2VzID0gWwogewogIGJlZ2luOiAweDAwMDAsCiAgZW5kOiAweDAwN2YKIH0sCiB7CiAgYmVnaW46IDB4MDA4MCwKICBlbmQ6IDB4MDBmZgogfSwKIHsKICBiZWdpbjogMHgwMTAwLAogIGVuZDogMHgwMTdmCiB9LAogewogIGJlZ2luOiAweDAxODAsCiAgZW5kOiAweDAyNGYKIH0sCiB7CiAgYmVnaW46IDB4MDI1MCwKICBlbmQ6IDB4MDJhZgogfSwKIHsKICBiZWdpbjogMHgwMmIwLAogIGVuZDogMHgwMmZmCiB9LAogewogIGJlZ2luOiAweDAzMDAsCiAgZW5kOiAweDAzNmYKIH0sCiB7CiAgYmVnaW46IDB4MDM3MCwKICBlbmQ6IDB4MDNmZgogfSwKIHsKICBiZWdpbjogMHgyYzgwLAogIGVuZDogMHgyY2ZmCiB9LAogewogIGJlZ2luOiAweDA0MDAsCiAgZW5kOiAweDA0ZmYKIH0sCiB7CiAgYmVnaW46IDB4MDUzMCwKICBlbmQ6IDB4MDU4ZgogfSwKIHsKICBiZWdpbjogMHgwNTkwLAogIGVuZDogMHgwNWZmCiB9LAogewogIGJlZ2luOiAweGE1MDAsCiAgZW5kOiAweGE2M2YKIH0sCiB7CiAgYmVnaW46IDB4MDYwMCwKICBlbmQ6IDB4MDZmZgogfSwKIHsKICBiZWdpbjogMHgwN2MwLAogIGVuZDogMHgwN2ZmCiB9LAogewogIGJlZ2luOiAweDA5MDAsCiAgZW5kOiAweDA5N2YKIH0sCiB7CiAgYmVnaW46IDB4MDk4MCwKICBlbmQ6IDB4MDlmZgogfSwKIHsKICBiZWdpbjogMHgwYTAwLAogIGVuZDogMHgwYTdmCiB9LAogewogIGJlZ2luOiAweDBhODAsCiAgZW5kOiAweDBhZmYKIH0sCiB7CiAgYmVnaW46IDB4MGIwMCwKICBlbmQ6IDB4MGI3ZgogfSwKIHsKICBiZWdpbjogMHgwYjgwLAogIGVuZDogMHgwYmZmCiB9LAogewogIGJlZ2luOiAweDBjMDAsCiAgZW5kOiAweDBjN2YKIH0sCiB7CiAgYmVnaW46IDB4MGM4MCwKICBlbmQ6IDB4MGNmZgogfSwKIHsKICBiZWdpbjogMHgwZDAwLAogIGVuZDogMHgwZDdmCiB9LAogewogIGJlZ2luOiAweDBlMDAsCiAgZW5kOiAweDBlN2YKIH0sCiB7CiAgYmVnaW46IDB4MGU4MCwKICBlbmQ6IDB4MGVmZgogfSwKIHsKICBiZWdpbjogMHgxMGEwLAogIGVuZDogMHgxMGZmCiB9LAogewogIGJlZ2luOiAweDFiMDAsCiAgZW5kOiAweDFiN2YKIH0sCiB7CiAgYmVnaW46IDB4MTEwMCwKICBlbmQ6IDB4MTFmZgogfSwKIHsKICBiZWdpbjogMHgxZTAwLAogIGVuZDogMHgxZWZmCiB9LAogewogIGJlZ2luOiAweDFmMDAsCiAgZW5kOiAweDFmZmYKIH0sCiB7CiAgYmVnaW46IDB4MjAwMCwKICBlbmQ6IDB4MjA2ZgogfSwKIHsKICBiZWdpbjogMHgyMDcwLAogIGVuZDogMHgyMDlmCiB9LAogewogIGJlZ2luOiAweDIwYTAsCiAgZW5kOiAweDIwY2YKIH0sCiB7CiAgYmVnaW46IDB4MjBkMCwKICBlbmQ6IDB4MjBmZgogfSwKIHsKICBiZWdpbjogMHgyMTAwLAogIGVuZDogMHgyMTRmCiB9LAogewogIGJlZ2luOiAweDIxNTAsCiAgZW5kOiAweDIxOGYKIH0sCiB7CiAgYmVnaW46IDB4MjE5MCwKICBlbmQ6IDB4MjFmZgogfSwKIHsKICBiZWdpbjogMHgyMjAwLAogIGVuZDogMHgyMmZmCiB9LAogewogIGJlZ2luOiAweDIzMDAsCiAgZW5kOiAweDIzZmYKIH0sCiB7CiAgYmVnaW46IDB4MjQwMCwKICBlbmQ6IDB4MjQzZgogfSwKIHsKICBiZWdpbjogMHgyNDQwLAogIGVuZDogMHgyNDVmCiB9LAogewogIGJlZ2luOiAweDI0NjAsCiAgZW5kOiAweDI0ZmYKIH0sCiB7CiAgYmVnaW46IDB4MjUwMCwKICBlbmQ6IDB4MjU3ZgogfSwKIHsKICBiZWdpbjogMHgyNTgwLAogIGVuZDogMHgyNTlmCiB9LAogewogIGJlZ2luOiAweDI1YTAsCiAgZW5kOiAweDI1ZmYKIH0sCiB7CiAgYmVnaW46IDB4MjYwMCwKICBlbmQ6IDB4MjZmZgogfSwKIHsKICBiZWdpbjogMHgyNzAwLAogIGVuZDogMHgyN2JmCiB9LAogewogIGJlZ2luOiAweDMwMDAsCiAgZW5kOiAweDMwM2YKIH0sCiB7CiAgYmVnaW46IDB4MzA0MCwKICBlbmQ6IDB4MzA5ZgogfSwKIHsKICBiZWdpbjogMHgzMGEwLAogIGVuZDogMHgzMGZmCiB9LAogewogIGJlZ2luOiAweDMxMDAsCiAgZW5kOiAweDMxMmYKIH0sCiB7CiAgYmVnaW46IDB4MzEzMCwKICBlbmQ6IDB4MzE4ZgogfSwKIHsKICBiZWdpbjogMHhhODQwLAogIGVuZDogMHhhODdmCiB9LAogewogIGJlZ2luOiAweDMyMDAsCiAgZW5kOiAweDMyZmYKIH0sCiB7CiAgYmVnaW46IDB4MzMwMCwKICBlbmQ6IDB4MzNmZgogfSwKIHsKICBiZWdpbjogMHhhYzAwLAogIGVuZDogMHhkN2FmCiB9LAogewogIGJlZ2luOiAweGQ4MDAsCiAgZW5kOiAweGRmZmYKIH0sCiB7CiAgYmVnaW46IDB4MTA5MDAsCiAgZW5kOiAweDEwOTFmCiB9LAogewogIGJlZ2luOiAweDRlMDAsCiAgZW5kOiAweDlmZmYKIH0sCiB7CiAgYmVnaW46IDB4ZTAwMCwKICBlbmQ6IDB4ZjhmZgogfSwKIHsKICBiZWdpbjogMHgzMWMwLAogIGVuZDogMHgzMWVmCiB9LAogewogIGJlZ2luOiAweGZiMDAsCiAgZW5kOiAweGZiNGYKIH0sCiB7CiAgYmVnaW46IDB4ZmI1MCwKICBlbmQ6IDB4ZmRmZgogfSwKIHsKICBiZWdpbjogMHhmZTIwLAogIGVuZDogMHhmZTJmCiB9LAogewogIGJlZ2luOiAweGZlMTAsCiAgZW5kOiAweGZlMWYKIH0sCiB7CiAgYmVnaW46IDB4ZmU1MCwKICBlbmQ6IDB4ZmU2ZgogfSwKIHsKICBiZWdpbjogMHhmZTcwLAogIGVuZDogMHhmZWZmCiB9LAogewogIGJlZ2luOiAweGZmMDAsCiAgZW5kOiAweGZmZWYKIH0sCiB7CiAgYmVnaW46IDB4ZmZmMCwKICBlbmQ6IDB4ZmZmZgogfSwKIHsKICBiZWdpbjogMHgwZjAwLAogIGVuZDogMHgwZmZmCiB9LAogewogIGJlZ2luOiAweDA3MDAsCiAgZW5kOiAweDA3NGYKIH0sCiB7CiAgYmVnaW46IDB4MDc4MCwKICBlbmQ6IDB4MDdiZgogfSwKIHsKICBiZWdpbjogMHgwZDgwLAogIGVuZDogMHgwZGZmCiB9LAogewogIGJlZ2luOiAweDEwMDAsCiAgZW5kOiAweDEwOWYKIH0sCiB7CiAgYmVnaW46IDB4MTIwMCwKICBlbmQ6IDB4MTM3ZgogfSwKIHsKICBiZWdpbjogMHgxM2EwLAogIGVuZDogMHgxM2ZmCiB9LAogewogIGJlZ2luOiAweDE0MDAsCiAgZW5kOiAweDE2N2YKIH0sCiB7CiAgYmVnaW46IDB4MTY4MCwKICBlbmQ6IDB4MTY5ZgogfSwKIHsKICBiZWdpbjogMHgxNmEwLAogIGVuZDogMHgxNmZmCiB9LAogewogIGJlZ2luOiAweDE3ODAsCiAgZW5kOiAweDE3ZmYKIH0sCiB7CiAgYmVnaW46IDB4MTgwMCwKICBlbmQ6IDB4MThhZgogfSwKIHsKICBiZWdpbjogMHgyODAwLAogIGVuZDogMHgyOGZmCiB9LAogewogIGJlZ2luOiAweGEwMDAsCiAgZW5kOiAweGE0OGYKIH0sCiB7CiAgYmVnaW46IDB4MTcwMCwKICBlbmQ6IDB4MTcxZgogfSwKIHsKICBiZWdpbjogMHgxMDMwMCwKICBlbmQ6IDB4MTAzMmYKIH0sCiB7CiAgYmVnaW46IDB4MTAzMzAsCiAgZW5kOiAweDEwMzRmCiB9LAogewogIGJlZ2luOiAweDEwNDAwLAogIGVuZDogMHgxMDQ0ZgogfSwKIHsKICBiZWdpbjogMHgxZDAwMCwKICBlbmQ6IDB4MWQwZmYKIH0sCiB7CiAgYmVnaW46IDB4MWQ0MDAsCiAgZW5kOiAweDFkN2ZmCiB9LAogewogIGJlZ2luOiAweGZmMDAwLAogIGVuZDogMHhmZmZmZAogfSwKIHsKICBiZWdpbjogMHhmZTAwLAogIGVuZDogMHhmZTBmCiB9LAogewogIGJlZ2luOiAweGUwMDAwLAogIGVuZDogMHhlMDA3ZgogfSwKIHsKICBiZWdpbjogMHgxOTAwLAogIGVuZDogMHgxOTRmCiB9LAogewogIGJlZ2luOiAweDE5NTAsCiAgZW5kOiAweDE5N2YKIH0sCiB7CiAgYmVnaW46IDB4MTk4MCwKICBlbmQ6IDB4MTlkZgogfSwKIHsKICBiZWdpbjogMHgxYTAwLAogIGVuZDogMHgxYTFmCiB9LAogewogIGJlZ2luOiAweDJjMDAsCiAgZW5kOiAweDJjNWYKIH0sCiB7CiAgYmVnaW46IDB4MmQzMCwKICBlbmQ6IDB4MmQ3ZgogfSwKIHsKICBiZWdpbjogMHg0ZGMwLAogIGVuZDogMHg0ZGZmCiB9LAogewogIGJlZ2luOiAweGE4MDAsCiAgZW5kOiAweGE4MmYKIH0sCiB7CiAgYmVnaW46IDB4MTAwMDAsCiAgZW5kOiAweDEwMDdmCiB9LAogewogIGJlZ2luOiAweDEwMTQwLAogIGVuZDogMHgxMDE4ZgogfSwKIHsKICBiZWdpbjogMHgxMDM4MCwKICBlbmQ6IDB4MTAzOWYKIH0sCiB7CiAgYmVnaW46IDB4MTAzYTAsCiAgZW5kOiAweDEwM2RmCiB9LAogewogIGJlZ2luOiAweDEwNDUwLAogIGVuZDogMHgxMDQ3ZgogfSwKIHsKICBiZWdpbjogMHgxMDQ4MCwKICBlbmQ6IDB4MTA0YWYKIH0sCiB7CiAgYmVnaW46IDB4MTA4MDAsCiAgZW5kOiAweDEwODNmCiB9LAogewogIGJlZ2luOiAweDEwYTAwLAogIGVuZDogMHgxMGE1ZgogfSwKIHsKICBiZWdpbjogMHgxZDMwMCwKICBlbmQ6IDB4MWQzNWYKIH0sCiB7CiAgYmVnaW46IDB4MTIwMDAsCiAgZW5kOiAweDEyM2ZmCiB9LAogewogIGJlZ2luOiAweDFkMzYwLAogIGVuZDogMHgxZDM3ZgogfSwKIHsKICBiZWdpbjogMHgxYjgwLAogIGVuZDogMHgxYmJmCiB9LAogewogIGJlZ2luOiAweDFjMDAsCiAgZW5kOiAweDFjNGYKIH0sCiB7CiAgYmVnaW46IDB4MWM1MCwKICBlbmQ6IDB4MWM3ZgogfSwKIHsKICBiZWdpbjogMHhhODgwLAogIGVuZDogMHhhOGRmCiB9LAogewogIGJlZ2luOiAweGE5MDAsCiAgZW5kOiAweGE5MmYKIH0sCiB7CiAgYmVnaW46IDB4YTkzMCwKICBlbmQ6IDB4YTk1ZgogfSwKIHsKICBiZWdpbjogMHhhYTAwLAogIGVuZDogMHhhYTVmCiB9LAogewogIGJlZ2luOiAweDEwMTkwLAogIGVuZDogMHgxMDFjZgogfSwKIHsKICBiZWdpbjogMHgxMDFkMCwKICBlbmQ6IDB4MTAxZmYKIH0sCiB7CiAgYmVnaW46IDB4MTAyYTAsCiAgZW5kOiAweDEwMmRmCiB9LAogewogIGJlZ2luOiAweDFmMDMwLAogIGVuZDogMHgxZjA5ZgogfQpdOwpmdW5jdGlvbiBnZXRVbmljb2RlUmFuZ2VGb3IodmFsdWUpIHsKIGZvciAodmFyIGkgPSAwLCBpaSA9IFVuaWNvZGVSYW5nZXMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogIHZhciByYW5nZSA9IFVuaWNvZGVSYW5nZXNbaV07CiAgaWYgKHZhbHVlID49IHJhbmdlLmJlZ2luICYmIHZhbHVlIDwgcmFuZ2UuZW5kKSB7CiAgIHJldHVybiBpOwogIH0KIH0KIHJldHVybiAtMTsKfQpmdW5jdGlvbiBpc1JUTFJhbmdlRm9yKHZhbHVlKSB7CiB2YXIgcmFuZ2UgPSBVbmljb2RlUmFuZ2VzWzEzXTsKIGlmICh2YWx1ZSA+PSByYW5nZS5iZWdpbiAmJiB2YWx1ZSA8IHJhbmdlLmVuZCkgewogIHJldHVybiB0cnVlOwogfQogcmFuZ2UgPSBVbmljb2RlUmFuZ2VzWzExXTsKIGlmICh2YWx1ZSA+PSByYW5nZS5iZWdpbiAmJiB2YWx1ZSA8IHJhbmdlLmVuZCkgewogIHJldHVybiB0cnVlOwogfQogcmV0dXJuIGZhbHNlOwp9CnZhciBnZXROb3JtYWxpemVkVW5pY29kZXMgPSBnZXRMb29rdXBUYWJsZUZhY3RvcnkoZnVuY3Rpb24gKHQpIHsKIHRbIlx1MDBBOCJdID0gIlx1MDAyMFx1MDMwOCI7CiB0WyJcdTAwQUYiXSA9ICJcdTAwMjBcdTAzMDQiOwogdFsiXHUwMEI0Il0gPSAiXHUwMDIwXHUwMzAxIjsKIHRbIlx1MDBCNSJdID0gIlx1MDNCQyI7CiB0WyJcdTAwQjgiXSA9ICJcdTAwMjBcdTAzMjciOwogdFsiXHUwMTMyIl0gPSAiXHUwMDQ5XHUwMDRBIjsKIHRbIlx1MDEzMyJdID0gIlx1MDA2OVx1MDA2QSI7CiB0WyJcdTAxM0YiXSA9ICJcdTAwNENcdTAwQjciOwogdFsiXHUwMTQwIl0gPSAiXHUwMDZDXHUwMEI3IjsKIHRbIlx1MDE0OSJdID0gIlx1MDJCQ1x1MDA2RSI7CiB0WyJcdTAxN0YiXSA9ICJcdTAwNzMiOwogdFsiXHUwMUM0Il0gPSAiXHUwMDQ0XHUwMTdEIjsKIHRbIlx1MDFDNSJdID0gIlx1MDA0NFx1MDE3RSI7CiB0WyJcdTAxQzYiXSA9ICJcdTAwNjRcdTAxN0UiOwogdFsiXHUwMUM3Il0gPSAiXHUwMDRDXHUwMDRBIjsKIHRbIlx1MDFDOCJdID0gIlx1MDA0Q1x1MDA2QSI7CiB0WyJcdTAxQzkiXSA9ICJcdTAwNkNcdTAwNkEiOwogdFsiXHUwMUNBIl0gPSAiXHUwMDRFXHUwMDRBIjsKIHRbIlx1MDFDQiJdID0gIlx1MDA0RVx1MDA2QSI7CiB0WyJcdTAxQ0MiXSA9ICJcdTAwNkVcdTAwNkEiOwogdFsiXHUwMUYxIl0gPSAiXHUwMDQ0XHUwMDVBIjsKIHRbIlx1MDFGMiJdID0gIlx1MDA0NFx1MDA3QSI7CiB0WyJcdTAxRjMiXSA9ICJcdTAwNjRcdTAwN0EiOwogdFsiXHUwMkQ4Il0gPSAiXHUwMDIwXHUwMzA2IjsKIHRbIlx1MDJEOSJdID0gIlx1MDAyMFx1MDMwNyI7CiB0WyJcdTAyREEiXSA9ICJcdTAwMjBcdTAzMEEiOwogdFsiXHUwMkRCIl0gPSAiXHUwMDIwXHUwMzI4IjsKIHRbIlx1MDJEQyJdID0gIlx1MDAyMFx1MDMwMyI7CiB0WyJcdTAyREQiXSA9ICJcdTAwMjBcdTAzMEIiOwogdFsiXHUwMzdBIl0gPSAiXHUwMDIwXHUwMzQ1IjsKIHRbIlx1MDM4NCJdID0gIlx1MDAyMFx1MDMwMSI7CiB0WyJcdTAzRDAiXSA9ICJcdTAzQjIiOwogdFsiXHUwM0QxIl0gPSAiXHUwM0I4IjsKIHRbIlx1MDNEMiJdID0gIlx1MDNBNSI7CiB0WyJcdTAzRDUiXSA9ICJcdTAzQzYiOwogdFsiXHUwM0Q2Il0gPSAiXHUwM0MwIjsKIHRbIlx1MDNGMCJdID0gIlx1MDNCQSI7CiB0WyJcdTAzRjEiXSA9ICJcdTAzQzEiOwogdFsiXHUwM0YyIl0gPSAiXHUwM0MyIjsKIHRbIlx1MDNGNCJdID0gIlx1MDM5OCI7CiB0WyJcdTAzRjUiXSA9ICJcdTAzQjUiOwogdFsiXHUwM0Y5Il0gPSAiXHUwM0EzIjsKIHRbIlx1MDU4NyJdID0gIlx1MDU2NVx1MDU4MiI7CiB0WyJcdTA2NzUiXSA9ICJcdTA2MjdcdTA2NzQiOwogdFsiXHUwNjc2Il0gPSAiXHUwNjQ4XHUwNjc0IjsKIHRbIlx1MDY3NyJdID0gIlx1MDZDN1x1MDY3NCI7CiB0WyJcdTA2NzgiXSA9ICJcdTA2NEFcdTA2NzQiOwogdFsiXHUwRTMzIl0gPSAiXHUwRTREXHUwRTMyIjsKIHRbIlx1MEVCMyJdID0gIlx1MEVDRFx1MEVCMiI7CiB0WyJcdTBFREMiXSA9ICJcdTBFQUJcdTBFOTkiOwogdFsiXHUwRUREIl0gPSAiXHUwRUFCXHUwRUExIjsKIHRbIlx1MEY3NyJdID0gIlx1MEZCMlx1MEY4MSI7CiB0WyJcdTBGNzkiXSA9ICJcdTBGQjNcdTBGODEiOwogdFsiXHUxRTlBIl0gPSAiXHUwMDYxXHUwMkJFIjsKIHRbIlx1MUZCRCJdID0gIlx1MDAyMFx1MDMxMyI7CiB0WyJcdTFGQkYiXSA9ICJcdTAwMjBcdTAzMTMiOwogdFsiXHUxRkMwIl0gPSAiXHUwMDIwXHUwMzQyIjsKIHRbIlx1MUZGRSJdID0gIlx1MDAyMFx1MDMxNCI7CiB0WyJcdTIwMDIiXSA9ICJcdTAwMjAiOwogdFsiXHUyMDAzIl0gPSAiXHUwMDIwIjsKIHRbIlx1MjAwNCJdID0gIlx1MDAyMCI7CiB0WyJcdTIwMDUiXSA9ICJcdTAwMjAiOwogdFsiXHUyMDA2Il0gPSAiXHUwMDIwIjsKIHRbIlx1MjAwOCJdID0gIlx1MDAyMCI7CiB0WyJcdTIwMDkiXSA9ICJcdTAwMjAiOwogdFsiXHUyMDBBIl0gPSAiXHUwMDIwIjsKIHRbIlx1MjAxNyJdID0gIlx1MDAyMFx1MDMzMyI7CiB0WyJcdTIwMjQiXSA9ICJcdTAwMkUiOwogdFsiXHUyMDI1Il0gPSAiXHUwMDJFXHUwMDJFIjsKIHRbIlx1MjAyNiJdID0gIlx1MDAyRVx1MDAyRVx1MDAyRSI7CiB0WyJcdTIwMzMiXSA9ICJcdTIwMzJcdTIwMzIiOwogdFsiXHUyMDM0Il0gPSAiXHUyMDMyXHUyMDMyXHUyMDMyIjsKIHRbIlx1MjAzNiJdID0gIlx1MjAzNVx1MjAzNSI7CiB0WyJcdTIwMzciXSA9ICJcdTIwMzVcdTIwMzVcdTIwMzUiOwogdFsiXHUyMDNDIl0gPSAiXHUwMDIxXHUwMDIxIjsKIHRbIlx1MjAzRSJdID0gIlx1MDAyMFx1MDMwNSI7CiB0WyJcdTIwNDciXSA9ICJcdTAwM0ZcdTAwM0YiOwogdFsiXHUyMDQ4Il0gPSAiXHUwMDNGXHUwMDIxIjsKIHRbIlx1MjA0OSJdID0gIlx1MDAyMVx1MDAzRiI7CiB0WyJcdTIwNTciXSA9ICJcdTIwMzJcdTIwMzJcdTIwMzJcdTIwMzIiOwogdFsiXHUyMDVGIl0gPSAiXHUwMDIwIjsKIHRbIlx1MjBBOCJdID0gIlx1MDA1Mlx1MDA3MyI7CiB0WyJcdTIxMDAiXSA9ICJcdTAwNjFcdTAwMkZcdTAwNjMiOwogdFsiXHUyMTAxIl0gPSAiXHUwMDYxXHUwMDJGXHUwMDczIjsKIHRbIlx1MjEwMyJdID0gIlx1MDBCMFx1MDA0MyI7CiB0WyJcdTIxMDUiXSA9ICJcdTAwNjNcdTAwMkZcdTAwNkYiOwogdFsiXHUyMTA2Il0gPSAiXHUwMDYzXHUwMDJGXHUwMDc1IjsKIHRbIlx1MjEwNyJdID0gIlx1MDE5MCI7CiB0WyJcdTIxMDkiXSA9ICJcdTAwQjBcdTAwNDYiOwogdFsiXHUyMTE2Il0gPSAiXHUwMDRFXHUwMDZGIjsKIHRbIlx1MjEyMSJdID0gIlx1MDA1NFx1MDA0NVx1MDA0QyI7CiB0WyJcdTIxMzUiXSA9ICJcdTA1RDAiOwogdFsiXHUyMTM2Il0gPSAiXHUwNUQxIjsKIHRbIlx1MjEzNyJdID0gIlx1MDVEMiI7CiB0WyJcdTIxMzgiXSA9ICJcdTA1RDMiOwogdFsiXHUyMTNCIl0gPSAiXHUwMDQ2XHUwMDQxXHUwMDU4IjsKIHRbIlx1MjE2MCJdID0gIlx1MDA0OSI7CiB0WyJcdTIxNjEiXSA9ICJcdTAwNDlcdTAwNDkiOwogdFsiXHUyMTYyIl0gPSAiXHUwMDQ5XHUwMDQ5XHUwMDQ5IjsKIHRbIlx1MjE2MyJdID0gIlx1MDA0OVx1MDA1NiI7CiB0WyJcdTIxNjQiXSA9ICJcdTAwNTYiOwogdFsiXHUyMTY1Il0gPSAiXHUwMDU2XHUwMDQ5IjsKIHRbIlx1MjE2NiJdID0gIlx1MDA1Nlx1MDA0OVx1MDA0OSI7CiB0WyJcdTIxNjciXSA9ICJcdTAwNTZcdTAwNDlcdTAwNDlcdTAwNDkiOwogdFsiXHUyMTY4Il0gPSAiXHUwMDQ5XHUwMDU4IjsKIHRbIlx1MjE2OSJdID0gIlx1MDA1OCI7CiB0WyJcdTIxNkEiXSA9ICJcdTAwNThcdTAwNDkiOwogdFsiXHUyMTZCIl0gPSAiXHUwMDU4XHUwMDQ5XHUwMDQ5IjsKIHRbIlx1MjE2QyJdID0gIlx1MDA0QyI7CiB0WyJcdTIxNkQiXSA9ICJcdTAwNDMiOwogdFsiXHUyMTZFIl0gPSAiXHUwMDQ0IjsKIHRbIlx1MjE2RiJdID0gIlx1MDA0RCI7CiB0WyJcdTIxNzAiXSA9ICJcdTAwNjkiOwogdFsiXHUyMTcxIl0gPSAiXHUwMDY5XHUwMDY5IjsKIHRbIlx1MjE3MiJdID0gIlx1MDA2OVx1MDA2OVx1MDA2OSI7CiB0WyJcdTIxNzMiXSA9ICJcdTAwNjlcdTAwNzYiOwogdFsiXHUyMTc0Il0gPSAiXHUwMDc2IjsKIHRbIlx1MjE3NSJdID0gIlx1MDA3Nlx1MDA2OSI7CiB0WyJcdTIxNzYiXSA9ICJcdTAwNzZcdTAwNjlcdTAwNjkiOwogdFsiXHUyMTc3Il0gPSAiXHUwMDc2XHUwMDY5XHUwMDY5XHUwMDY5IjsKIHRbIlx1MjE3OCJdID0gIlx1MDA2OVx1MDA3OCI7CiB0WyJcdTIxNzkiXSA9ICJcdTAwNzgiOwogdFsiXHUyMTdBIl0gPSAiXHUwMDc4XHUwMDY5IjsKIHRbIlx1MjE3QiJdID0gIlx1MDA3OFx1MDA2OVx1MDA2OSI7CiB0WyJcdTIxN0MiXSA9ICJcdTAwNkMiOwogdFsiXHUyMTdEIl0gPSAiXHUwMDYzIjsKIHRbIlx1MjE3RSJdID0gIlx1MDA2NCI7CiB0WyJcdTIxN0YiXSA9ICJcdTAwNkQiOwogdFsiXHUyMjJDIl0gPSAiXHUyMjJCXHUyMjJCIjsKIHRbIlx1MjIyRCJdID0gIlx1MjIyQlx1MjIyQlx1MjIyQiI7CiB0WyJcdTIyMkYiXSA9ICJcdTIyMkVcdTIyMkUiOwogdFsiXHUyMjMwIl0gPSAiXHUyMjJFXHUyMjJFXHUyMjJFIjsKIHRbIlx1MjQ3NCJdID0gIlx1MDAyOFx1MDAzMVx1MDAyOSI7CiB0WyJcdTI0NzUiXSA9ICJcdTAwMjhcdTAwMzJcdTAwMjkiOwogdFsiXHUyNDc2Il0gPSAiXHUwMDI4XHUwMDMzXHUwMDI5IjsKIHRbIlx1MjQ3NyJdID0gIlx1MDAyOFx1MDAzNFx1MDAyOSI7CiB0WyJcdTI0NzgiXSA9ICJcdTAwMjhcdTAwMzVcdTAwMjkiOwogdFsiXHUyNDc5Il0gPSAiXHUwMDI4XHUwMDM2XHUwMDI5IjsKIHRbIlx1MjQ3QSJdID0gIlx1MDAyOFx1MDAzN1x1MDAyOSI7CiB0WyJcdTI0N0IiXSA9ICJcdTAwMjhcdTAwMzhcdTAwMjkiOwogdFsiXHUyNDdDIl0gPSAiXHUwMDI4XHUwMDM5XHUwMDI5IjsKIHRbIlx1MjQ3RCJdID0gIlx1MDAyOFx1MDAzMVx1MDAzMFx1MDAyOSI7CiB0WyJcdTI0N0UiXSA9ICJcdTAwMjhcdTAwMzFcdTAwMzFcdTAwMjkiOwogdFsiXHUyNDdGIl0gPSAiXHUwMDI4XHUwMDMxXHUwMDMyXHUwMDI5IjsKIHRbIlx1MjQ4MCJdID0gIlx1MDAyOFx1MDAzMVx1MDAzM1x1MDAyOSI7CiB0WyJcdTI0ODEiXSA9ICJcdTAwMjhcdTAwMzFcdTAwMzRcdTAwMjkiOwogdFsiXHUyNDgyIl0gPSAiXHUwMDI4XHUwMDMxXHUwMDM1XHUwMDI5IjsKIHRbIlx1MjQ4MyJdID0gIlx1MDAyOFx1MDAzMVx1MDAzNlx1MDAyOSI7CiB0WyJcdTI0ODQiXSA9ICJcdTAwMjhcdTAwMzFcdTAwMzdcdTAwMjkiOwogdFsiXHUyNDg1Il0gPSAiXHUwMDI4XHUwMDMxXHUwMDM4XHUwMDI5IjsKIHRbIlx1MjQ4NiJdID0gIlx1MDAyOFx1MDAzMVx1MDAzOVx1MDAyOSI7CiB0WyJcdTI0ODciXSA9ICJcdTAwMjhcdTAwMzJcdTAwMzBcdTAwMjkiOwogdFsiXHUyNDg4Il0gPSAiXHUwMDMxXHUwMDJFIjsKIHRbIlx1MjQ4OSJdID0gIlx1MDAzMlx1MDAyRSI7CiB0WyJcdTI0OEEiXSA9ICJcdTAwMzNcdTAwMkUiOwogdFsiXHUyNDhCIl0gPSAiXHUwMDM0XHUwMDJFIjsKIHRbIlx1MjQ4QyJdID0gIlx1MDAzNVx1MDAyRSI7CiB0WyJcdTI0OEQiXSA9ICJcdTAwMzZcdTAwMkUiOwogdFsiXHUyNDhFIl0gPSAiXHUwMDM3XHUwMDJFIjsKIHRbIlx1MjQ4RiJdID0gIlx1MDAzOFx1MDAyRSI7CiB0WyJcdTI0OTAiXSA9ICJcdTAwMzlcdTAwMkUiOwogdFsiXHUyNDkxIl0gPSAiXHUwMDMxXHUwMDMwXHUwMDJFIjsKIHRbIlx1MjQ5MiJdID0gIlx1MDAzMVx1MDAzMVx1MDAyRSI7CiB0WyJcdTI0OTMiXSA9ICJcdTAwMzFcdTAwMzJcdTAwMkUiOwogdFsiXHUyNDk0Il0gPSAiXHUwMDMxXHUwMDMzXHUwMDJFIjsKIHRbIlx1MjQ5NSJdID0gIlx1MDAzMVx1MDAzNFx1MDAyRSI7CiB0WyJcdTI0OTYiXSA9ICJcdTAwMzFcdTAwMzVcdTAwMkUiOwogdFsiXHUyNDk3Il0gPSAiXHUwMDMxXHUwMDM2XHUwMDJFIjsKIHRbIlx1MjQ5OCJdID0gIlx1MDAzMVx1MDAzN1x1MDAyRSI7CiB0WyJcdTI0OTkiXSA9ICJcdTAwMzFcdTAwMzhcdTAwMkUiOwogdFsiXHUyNDlBIl0gPSAiXHUwMDMxXHUwMDM5XHUwMDJFIjsKIHRbIlx1MjQ5QiJdID0gIlx1MDAzMlx1MDAzMFx1MDAyRSI7CiB0WyJcdTI0OUMiXSA9ICJcdTAwMjhcdTAwNjFcdTAwMjkiOwogdFsiXHUyNDlEIl0gPSAiXHUwMDI4XHUwMDYyXHUwMDI5IjsKIHRbIlx1MjQ5RSJdID0gIlx1MDAyOFx1MDA2M1x1MDAyOSI7CiB0WyJcdTI0OUYiXSA9ICJcdTAwMjhcdTAwNjRcdTAwMjkiOwogdFsiXHUyNEEwIl0gPSAiXHUwMDI4XHUwMDY1XHUwMDI5IjsKIHRbIlx1MjRBMSJdID0gIlx1MDAyOFx1MDA2Nlx1MDAyOSI7CiB0WyJcdTI0QTIiXSA9ICJcdTAwMjhcdTAwNjdcdTAwMjkiOwogdFsiXHUyNEEzIl0gPSAiXHUwMDI4XHUwMDY4XHUwMDI5IjsKIHRbIlx1MjRBNCJdID0gIlx1MDAyOFx1MDA2OVx1MDAyOSI7CiB0WyJcdTI0QTUiXSA9ICJcdTAwMjhcdTAwNkFcdTAwMjkiOwogdFsiXHUyNEE2Il0gPSAiXHUwMDI4XHUwMDZCXHUwMDI5IjsKIHRbIlx1MjRBNyJdID0gIlx1MDAyOFx1MDA2Q1x1MDAyOSI7CiB0WyJcdTI0QTgiXSA9ICJcdTAwMjhcdTAwNkRcdTAwMjkiOwogdFsiXHUyNEE5Il0gPSAiXHUwMDI4XHUwMDZFXHUwMDI5IjsKIHRbIlx1MjRBQSJdID0gIlx1MDAyOFx1MDA2Rlx1MDAyOSI7CiB0WyJcdTI0QUIiXSA9ICJcdTAwMjhcdTAwNzBcdTAwMjkiOwogdFsiXHUyNEFDIl0gPSAiXHUwMDI4XHUwMDcxXHUwMDI5IjsKIHRbIlx1MjRBRCJdID0gIlx1MDAyOFx1MDA3Mlx1MDAyOSI7CiB0WyJcdTI0QUUiXSA9ICJcdTAwMjhcdTAwNzNcdTAwMjkiOwogdFsiXHUyNEFGIl0gPSAiXHUwMDI4XHUwMDc0XHUwMDI5IjsKIHRbIlx1MjRCMCJdID0gIlx1MDAyOFx1MDA3NVx1MDAyOSI7CiB0WyJcdTI0QjEiXSA9ICJcdTAwMjhcdTAwNzZcdTAwMjkiOwogdFsiXHUyNEIyIl0gPSAiXHUwMDI4XHUwMDc3XHUwMDI5IjsKIHRbIlx1MjRCMyJdID0gIlx1MDAyOFx1MDA3OFx1MDAyOSI7CiB0WyJcdTI0QjQiXSA9ICJcdTAwMjhcdTAwNzlcdTAwMjkiOwogdFsiXHUyNEI1Il0gPSAiXHUwMDI4XHUwMDdBXHUwMDI5IjsKIHRbIlx1MkEwQyJdID0gIlx1MjIyQlx1MjIyQlx1MjIyQlx1MjIyQiI7CiB0WyJcdTJBNzQiXSA9ICJcdTAwM0FcdTAwM0FcdTAwM0QiOwogdFsiXHUyQTc1Il0gPSAiXHUwMDNEXHUwMDNEIjsKIHRbIlx1MkE3NiJdID0gIlx1MDAzRFx1MDAzRFx1MDAzRCI7CiB0WyJcdTJFOUYiXSA9ICJcdTZCQ0QiOwogdFsiXHUyRUYzIl0gPSAiXHU5RjlGIjsKIHRbIlx1MkYwMCJdID0gIlx1NEUwMCI7CiB0WyJcdTJGMDEiXSA9ICJcdTRFMjgiOwogdFsiXHUyRjAyIl0gPSAiXHU0RTM2IjsKIHRbIlx1MkYwMyJdID0gIlx1NEUzRiI7CiB0WyJcdTJGMDQiXSA9ICJcdTRFNTkiOwogdFsiXHUyRjA1Il0gPSAiXHU0RTg1IjsKIHRbIlx1MkYwNiJdID0gIlx1NEU4QyI7CiB0WyJcdTJGMDciXSA9ICJcdTRFQTAiOwogdFsiXHUyRjA4Il0gPSAiXHU0RUJBIjsKIHRbIlx1MkYwOSJdID0gIlx1NTEzRiI7CiB0WyJcdTJGMEEiXSA9ICJcdTUxNjUiOwogdFsiXHUyRjBCIl0gPSAiXHU1MTZCIjsKIHRbIlx1MkYwQyJdID0gIlx1NTE4MiI7CiB0WyJcdTJGMEQiXSA9ICJcdTUxOTYiOwogdFsiXHUyRjBFIl0gPSAiXHU1MUFCIjsKIHRbIlx1MkYwRiJdID0gIlx1NTFFMCI7CiB0WyJcdTJGMTAiXSA9ICJcdTUxRjUiOwogdFsiXHUyRjExIl0gPSAiXHU1MjAwIjsKIHRbIlx1MkYxMiJdID0gIlx1NTI5QiI7CiB0WyJcdTJGMTMiXSA9ICJcdTUyRjkiOwogdFsiXHUyRjE0Il0gPSAiXHU1MzE1IjsKIHRbIlx1MkYxNSJdID0gIlx1NTMxQSI7CiB0WyJcdTJGMTYiXSA9ICJcdTUzMzgiOwogdFsiXHUyRjE3Il0gPSAiXHU1MzQxIjsKIHRbIlx1MkYxOCJdID0gIlx1NTM1QyI7CiB0WyJcdTJGMTkiXSA9ICJcdTUzNjkiOwogdFsiXHUyRjFBIl0gPSAiXHU1MzgyIjsKIHRbIlx1MkYxQiJdID0gIlx1NTNCNiI7CiB0WyJcdTJGMUMiXSA9ICJcdTUzQzgiOwogdFsiXHUyRjFEIl0gPSAiXHU1M0UzIjsKIHRbIlx1MkYxRSJdID0gIlx1NTZENyI7CiB0WyJcdTJGMUYiXSA9ICJcdTU3MUYiOwogdFsiXHUyRjIwIl0gPSAiXHU1OEVCIjsKIHRbIlx1MkYyMSJdID0gIlx1NTkwMiI7CiB0WyJcdTJGMjIiXSA9ICJcdTU5MEEiOwogdFsiXHUyRjIzIl0gPSAiXHU1OTE1IjsKIHRbIlx1MkYyNCJdID0gIlx1NTkyNyI7CiB0WyJcdTJGMjUiXSA9ICJcdTU5NzMiOwogdFsiXHUyRjI2Il0gPSAiXHU1QjUwIjsKIHRbIlx1MkYyNyJdID0gIlx1NUI4MCI7CiB0WyJcdTJGMjgiXSA9ICJcdTVCRjgiOwogdFsiXHUyRjI5Il0gPSAiXHU1QzBGIjsKIHRbIlx1MkYyQSJdID0gIlx1NUMyMiI7CiB0WyJcdTJGMkIiXSA9ICJcdTVDMzgiOwogdFsiXHUyRjJDIl0gPSAiXHU1QzZFIjsKIHRbIlx1MkYyRCJdID0gIlx1NUM3MSI7CiB0WyJcdTJGMkUiXSA9ICJcdTVEREIiOwogdFsiXHUyRjJGIl0gPSAiXHU1REU1IjsKIHRbIlx1MkYzMCJdID0gIlx1NURGMSI7CiB0WyJcdTJGMzEiXSA9ICJcdTVERkUiOwogdFsiXHUyRjMyIl0gPSAiXHU1RTcyIjsKIHRbIlx1MkYzMyJdID0gIlx1NUU3QSI7CiB0WyJcdTJGMzQiXSA9ICJcdTVFN0YiOwogdFsiXHUyRjM1Il0gPSAiXHU1RUY0IjsKIHRbIlx1MkYzNiJdID0gIlx1NUVGRSI7CiB0WyJcdTJGMzciXSA9ICJcdTVGMEIiOwogdFsiXHUyRjM4Il0gPSAiXHU1RjEzIjsKIHRbIlx1MkYzOSJdID0gIlx1NUY1MCI7CiB0WyJcdTJGM0EiXSA9ICJcdTVGNjEiOwogdFsiXHUyRjNCIl0gPSAiXHU1RjczIjsKIHRbIlx1MkYzQyJdID0gIlx1NUZDMyI7CiB0WyJcdTJGM0QiXSA9ICJcdTYyMDgiOwogdFsiXHUyRjNFIl0gPSAiXHU2MjM2IjsKIHRbIlx1MkYzRiJdID0gIlx1NjI0QiI7CiB0WyJcdTJGNDAiXSA9ICJcdTY1MkYiOwogdFsiXHUyRjQxIl0gPSAiXHU2NTM0IjsKIHRbIlx1MkY0MiJdID0gIlx1NjU4NyI7CiB0WyJcdTJGNDMiXSA9ICJcdTY1OTciOwogdFsiXHUyRjQ0Il0gPSAiXHU2NUE0IjsKIHRbIlx1MkY0NSJdID0gIlx1NjVCOSI7CiB0WyJcdTJGNDYiXSA9ICJcdTY1RTAiOwogdFsiXHUyRjQ3Il0gPSAiXHU2NUU1IjsKIHRbIlx1MkY0OCJdID0gIlx1NjZGMCI7CiB0WyJcdTJGNDkiXSA9ICJcdTY3MDgiOwogdFsiXHUyRjRBIl0gPSAiXHU2NzI4IjsKIHRbIlx1MkY0QiJdID0gIlx1NkIyMCI7CiB0WyJcdTJGNEMiXSA9ICJcdTZCNjIiOwogdFsiXHUyRjREIl0gPSAiXHU2Qjc5IjsKIHRbIlx1MkY0RSJdID0gIlx1NkJCMyI7CiB0WyJcdTJGNEYiXSA9ICJcdTZCQ0IiOwogdFsiXHUyRjUwIl0gPSAiXHU2QkQ0IjsKIHRbIlx1MkY1MSJdID0gIlx1NkJEQiI7CiB0WyJcdTJGNTIiXSA9ICJcdTZDMEYiOwogdFsiXHUyRjUzIl0gPSAiXHU2QzE0IjsKIHRbIlx1MkY1NCJdID0gIlx1NkMzNCI7CiB0WyJcdTJGNTUiXSA9ICJcdTcwNkIiOwogdFsiXHUyRjU2Il0gPSAiXHU3MjJBIjsKIHRbIlx1MkY1NyJdID0gIlx1NzIzNiI7CiB0WyJcdTJGNTgiXSA9ICJcdTcyM0IiOwogdFsiXHUyRjU5Il0gPSAiXHU3MjNGIjsKIHRbIlx1MkY1QSJdID0gIlx1NzI0NyI7CiB0WyJcdTJGNUIiXSA9ICJcdTcyNTkiOwogdFsiXHUyRjVDIl0gPSAiXHU3MjVCIjsKIHRbIlx1MkY1RCJdID0gIlx1NzJBQyI7CiB0WyJcdTJGNUUiXSA9ICJcdTczODQiOwogdFsiXHUyRjVGIl0gPSAiXHU3Mzg5IjsKIHRbIlx1MkY2MCJdID0gIlx1NzREQyI7CiB0WyJcdTJGNjEiXSA9ICJcdTc0RTYiOwogdFsiXHUyRjYyIl0gPSAiXHU3NTE4IjsKIHRbIlx1MkY2MyJdID0gIlx1NzUxRiI7CiB0WyJcdTJGNjQiXSA9ICJcdTc1MjgiOwogdFsiXHUyRjY1Il0gPSAiXHU3NTMwIjsKIHRbIlx1MkY2NiJdID0gIlx1NzU4QiI7CiB0WyJcdTJGNjciXSA9ICJcdTc1OTIiOwogdFsiXHUyRjY4Il0gPSAiXHU3Njc2IjsKIHRbIlx1MkY2OSJdID0gIlx1NzY3RCI7CiB0WyJcdTJGNkEiXSA9ICJcdTc2QUUiOwogdFsiXHUyRjZCIl0gPSAiXHU3NkJGIjsKIHRbIlx1MkY2QyJdID0gIlx1NzZFRSI7CiB0WyJcdTJGNkQiXSA9ICJcdTc3REIiOwogdFsiXHUyRjZFIl0gPSAiXHU3N0UyIjsKIHRbIlx1MkY2RiJdID0gIlx1NzdGMyI7CiB0WyJcdTJGNzAiXSA9ICJcdTc5M0EiOwogdFsiXHUyRjcxIl0gPSAiXHU3OUI4IjsKIHRbIlx1MkY3MiJdID0gIlx1NzlCRSI7CiB0WyJcdTJGNzMiXSA9ICJcdTdBNzQiOwogdFsiXHUyRjc0Il0gPSAiXHU3QUNCIjsKIHRbIlx1MkY3NSJdID0gIlx1N0FGOSI7CiB0WyJcdTJGNzYiXSA9ICJcdTdDNzMiOwogdFsiXHUyRjc3Il0gPSAiXHU3Q0Y4IjsKIHRbIlx1MkY3OCJdID0gIlx1N0YzNiI7CiB0WyJcdTJGNzkiXSA9ICJcdTdGNTEiOwogdFsiXHUyRjdBIl0gPSAiXHU3RjhBIjsKIHRbIlx1MkY3QiJdID0gIlx1N0ZCRCI7CiB0WyJcdTJGN0MiXSA9ICJcdTgwMDEiOwogdFsiXHUyRjdEIl0gPSAiXHU4MDBDIjsKIHRbIlx1MkY3RSJdID0gIlx1ODAxMiI7CiB0WyJcdTJGN0YiXSA9ICJcdTgwMzMiOwogdFsiXHUyRjgwIl0gPSAiXHU4MDdGIjsKIHRbIlx1MkY4MSJdID0gIlx1ODA4OSI7CiB0WyJcdTJGODIiXSA9ICJcdTgxRTMiOwogdFsiXHUyRjgzIl0gPSAiXHU4MUVBIjsKIHRbIlx1MkY4NCJdID0gIlx1ODFGMyI7CiB0WyJcdTJGODUiXSA9ICJcdTgxRkMiOwogdFsiXHUyRjg2Il0gPSAiXHU4MjBDIjsKIHRbIlx1MkY4NyJdID0gIlx1ODIxQiI7CiB0WyJcdTJGODgiXSA9ICJcdTgyMUYiOwogdFsiXHUyRjg5Il0gPSAiXHU4MjZFIjsKIHRbIlx1MkY4QSJdID0gIlx1ODI3MiI7CiB0WyJcdTJGOEIiXSA9ICJcdTgyNzgiOwogdFsiXHUyRjhDIl0gPSAiXHU4NjREIjsKIHRbIlx1MkY4RCJdID0gIlx1ODY2QiI7CiB0WyJcdTJGOEUiXSA9ICJcdTg4NDAiOwogdFsiXHUyRjhGIl0gPSAiXHU4ODRDIjsKIHRbIlx1MkY5MCJdID0gIlx1ODg2MyI7CiB0WyJcdTJGOTEiXSA9ICJcdTg5N0UiOwogdFsiXHUyRjkyIl0gPSAiXHU4OThCIjsKIHRbIlx1MkY5MyJdID0gIlx1ODlEMiI7CiB0WyJcdTJGOTQiXSA9ICJcdThBMDAiOwogdFsiXHUyRjk1Il0gPSAiXHU4QzM3IjsKIHRbIlx1MkY5NiJdID0gIlx1OEM0NiI7CiB0WyJcdTJGOTciXSA9ICJcdThDNTUiOwogdFsiXHUyRjk4Il0gPSAiXHU4Qzc4IjsKIHRbIlx1MkY5OSJdID0gIlx1OEM5RCI7CiB0WyJcdTJGOUEiXSA9ICJcdThENjQiOwogdFsiXHUyRjlCIl0gPSAiXHU4RDcwIjsKIHRbIlx1MkY5QyJdID0gIlx1OERCMyI7CiB0WyJcdTJGOUQiXSA9ICJcdThFQUIiOwogdFsiXHUyRjlFIl0gPSAiXHU4RUNBIjsKIHRbIlx1MkY5RiJdID0gIlx1OEY5QiI7CiB0WyJcdTJGQTAiXSA9ICJcdThGQjAiOwogdFsiXHUyRkExIl0gPSAiXHU4RkI1IjsKIHRbIlx1MkZBMiJdID0gIlx1OTA5MSI7CiB0WyJcdTJGQTMiXSA9ICJcdTkxNDkiOwogdFsiXHUyRkE0Il0gPSAiXHU5MUM2IjsKIHRbIlx1MkZBNSJdID0gIlx1OTFDQyI7CiB0WyJcdTJGQTYiXSA9ICJcdTkxRDEiOwogdFsiXHUyRkE3Il0gPSAiXHU5NTc3IjsKIHRbIlx1MkZBOCJdID0gIlx1OTU4MCI7CiB0WyJcdTJGQTkiXSA9ICJcdTk2MUMiOwogdFsiXHUyRkFBIl0gPSAiXHU5NkI2IjsKIHRbIlx1MkZBQiJdID0gIlx1OTZCOSI7CiB0WyJcdTJGQUMiXSA9ICJcdTk2RTgiOwogdFsiXHUyRkFEIl0gPSAiXHU5NzUxIjsKIHRbIlx1MkZBRSJdID0gIlx1OTc1RSI7CiB0WyJcdTJGQUYiXSA9ICJcdTk3NjIiOwogdFsiXHUyRkIwIl0gPSAiXHU5NzY5IjsKIHRbIlx1MkZCMSJdID0gIlx1OTdDQiI7CiB0WyJcdTJGQjIiXSA9ICJcdTk3RUQiOwogdFsiXHUyRkIzIl0gPSAiXHU5N0YzIjsKIHRbIlx1MkZCNCJdID0gIlx1OTgwMSI7CiB0WyJcdTJGQjUiXSA9ICJcdTk4QTgiOwogdFsiXHUyRkI2Il0gPSAiXHU5OERCIjsKIHRbIlx1MkZCNyJdID0gIlx1OThERiI7CiB0WyJcdTJGQjgiXSA9ICJcdTk5OTYiOwogdFsiXHUyRkI5Il0gPSAiXHU5OTk5IjsKIHRbIlx1MkZCQSJdID0gIlx1OTlBQyI7CiB0WyJcdTJGQkIiXSA9ICJcdTlBQTgiOwogdFsiXHUyRkJDIl0gPSAiXHU5QUQ4IjsKIHRbIlx1MkZCRCJdID0gIlx1OUFERiI7CiB0WyJcdTJGQkUiXSA9ICJcdTlCMjUiOwogdFsiXHUyRkJGIl0gPSAiXHU5QjJGIjsKIHRbIlx1MkZDMCJdID0gIlx1OUIzMiI7CiB0WyJcdTJGQzEiXSA9ICJcdTlCM0MiOwogdFsiXHUyRkMyIl0gPSAiXHU5QjVBIjsKIHRbIlx1MkZDMyJdID0gIlx1OUNFNSI7CiB0WyJcdTJGQzQiXSA9ICJcdTlFNzUiOwogdFsiXHUyRkM1Il0gPSAiXHU5RTdGIjsKIHRbIlx1MkZDNiJdID0gIlx1OUVBNSI7CiB0WyJcdTJGQzciXSA9ICJcdTlFQkIiOwogdFsiXHUyRkM4Il0gPSAiXHU5RUMzIjsKIHRbIlx1MkZDOSJdID0gIlx1OUVDRCI7CiB0WyJcdTJGQ0EiXSA9ICJcdTlFRDEiOwogdFsiXHUyRkNCIl0gPSAiXHU5RUY5IjsKIHRbIlx1MkZDQyJdID0gIlx1OUVGRCI7CiB0WyJcdTJGQ0QiXSA9ICJcdTlGMEUiOwogdFsiXHUyRkNFIl0gPSAiXHU5RjEzIjsKIHRbIlx1MkZDRiJdID0gIlx1OUYyMCI7CiB0WyJcdTJGRDAiXSA9ICJcdTlGM0IiOwogdFsiXHUyRkQxIl0gPSAiXHU5RjRBIjsKIHRbIlx1MkZEMiJdID0gIlx1OUY1MiI7CiB0WyJcdTJGRDMiXSA9ICJcdTlGOEQiOwogdFsiXHUyRkQ0Il0gPSAiXHU5RjlDIjsKIHRbIlx1MkZENSJdID0gIlx1OUZBMCI7CiB0WyJcdTMwMzYiXSA9ICJcdTMwMTIiOwogdFsiXHUzMDM4Il0gPSAiXHU1MzQxIjsKIHRbIlx1MzAzOSJdID0gIlx1NTM0NCI7CiB0WyJcdTMwM0EiXSA9ICJcdTUzNDUiOwogdFsiXHUzMDlCIl0gPSAiXHUwMDIwXHUzMDk5IjsKIHRbIlx1MzA5QyJdID0gIlx1MDAyMFx1MzA5QSI7CiB0WyJcdTMxMzEiXSA9ICJcdTExMDAiOwogdFsiXHUzMTMyIl0gPSAiXHUxMTAxIjsKIHRbIlx1MzEzMyJdID0gIlx1MTFBQSI7CiB0WyJcdTMxMzQiXSA9ICJcdTExMDIiOwogdFsiXHUzMTM1Il0gPSAiXHUxMUFDIjsKIHRbIlx1MzEzNiJdID0gIlx1MTFBRCI7CiB0WyJcdTMxMzciXSA9ICJcdTExMDMiOwogdFsiXHUzMTM4Il0gPSAiXHUxMTA0IjsKIHRbIlx1MzEzOSJdID0gIlx1MTEwNSI7CiB0WyJcdTMxM0EiXSA9ICJcdTExQjAiOwogdFsiXHUzMTNCIl0gPSAiXHUxMUIxIjsKIHRbIlx1MzEzQyJdID0gIlx1MTFCMiI7CiB0WyJcdTMxM0QiXSA9ICJcdTExQjMiOwogdFsiXHUzMTNFIl0gPSAiXHUxMUI0IjsKIHRbIlx1MzEzRiJdID0gIlx1MTFCNSI7CiB0WyJcdTMxNDAiXSA9ICJcdTExMUEiOwogdFsiXHUzMTQxIl0gPSAiXHUxMTA2IjsKIHRbIlx1MzE0MiJdID0gIlx1MTEwNyI7CiB0WyJcdTMxNDMiXSA9ICJcdTExMDgiOwogdFsiXHUzMTQ0Il0gPSAiXHUxMTIxIjsKIHRbIlx1MzE0NSJdID0gIlx1MTEwOSI7CiB0WyJcdTMxNDYiXSA9ICJcdTExMEEiOwogdFsiXHUzMTQ3Il0gPSAiXHUxMTBCIjsKIHRbIlx1MzE0OCJdID0gIlx1MTEwQyI7CiB0WyJcdTMxNDkiXSA9ICJcdTExMEQiOwogdFsiXHUzMTRBIl0gPSAiXHUxMTBFIjsKIHRbIlx1MzE0QiJdID0gIlx1MTEwRiI7CiB0WyJcdTMxNEMiXSA9ICJcdTExMTAiOwogdFsiXHUzMTREIl0gPSAiXHUxMTExIjsKIHRbIlx1MzE0RSJdID0gIlx1MTExMiI7CiB0WyJcdTMxNEYiXSA9ICJcdTExNjEiOwogdFsiXHUzMTUwIl0gPSAiXHUxMTYyIjsKIHRbIlx1MzE1MSJdID0gIlx1MTE2MyI7CiB0WyJcdTMxNTIiXSA9ICJcdTExNjQiOwogdFsiXHUzMTUzIl0gPSAiXHUxMTY1IjsKIHRbIlx1MzE1NCJdID0gIlx1MTE2NiI7CiB0WyJcdTMxNTUiXSA9ICJcdTExNjciOwogdFsiXHUzMTU2Il0gPSAiXHUxMTY4IjsKIHRbIlx1MzE1NyJdID0gIlx1MTE2OSI7CiB0WyJcdTMxNTgiXSA9ICJcdTExNkEiOwogdFsiXHUzMTU5Il0gPSAiXHUxMTZCIjsKIHRbIlx1MzE1QSJdID0gIlx1MTE2QyI7CiB0WyJcdTMxNUIiXSA9ICJcdTExNkQiOwogdFsiXHUzMTVDIl0gPSAiXHUxMTZFIjsKIHRbIlx1MzE1RCJdID0gIlx1MTE2RiI7CiB0WyJcdTMxNUUiXSA9ICJcdTExNzAiOwogdFsiXHUzMTVGIl0gPSAiXHUxMTcxIjsKIHRbIlx1MzE2MCJdID0gIlx1MTE3MiI7CiB0WyJcdTMxNjEiXSA9ICJcdTExNzMiOwogdFsiXHUzMTYyIl0gPSAiXHUxMTc0IjsKIHRbIlx1MzE2MyJdID0gIlx1MTE3NSI7CiB0WyJcdTMxNjQiXSA9ICJcdTExNjAiOwogdFsiXHUzMTY1Il0gPSAiXHUxMTE0IjsKIHRbIlx1MzE2NiJdID0gIlx1MTExNSI7CiB0WyJcdTMxNjciXSA9ICJcdTExQzciOwogdFsiXHUzMTY4Il0gPSAiXHUxMUM4IjsKIHRbIlx1MzE2OSJdID0gIlx1MTFDQyI7CiB0WyJcdTMxNkEiXSA9ICJcdTExQ0UiOwogdFsiXHUzMTZCIl0gPSAiXHUxMUQzIjsKIHRbIlx1MzE2QyJdID0gIlx1MTFENyI7CiB0WyJcdTMxNkQiXSA9ICJcdTExRDkiOwogdFsiXHUzMTZFIl0gPSAiXHUxMTFDIjsKIHRbIlx1MzE2RiJdID0gIlx1MTFERCI7CiB0WyJcdTMxNzAiXSA9ICJcdTExREYiOwogdFsiXHUzMTcxIl0gPSAiXHUxMTFEIjsKIHRbIlx1MzE3MiJdID0gIlx1MTExRSI7CiB0WyJcdTMxNzMiXSA9ICJcdTExMjAiOwogdFsiXHUzMTc0Il0gPSAiXHUxMTIyIjsKIHRbIlx1MzE3NSJdID0gIlx1MTEyMyI7CiB0WyJcdTMxNzYiXSA9ICJcdTExMjciOwogdFsiXHUzMTc3Il0gPSAiXHUxMTI5IjsKIHRbIlx1MzE3OCJdID0gIlx1MTEyQiI7CiB0WyJcdTMxNzkiXSA9ICJcdTExMkMiOwogdFsiXHUzMTdBIl0gPSAiXHUxMTJEIjsKIHRbIlx1MzE3QiJdID0gIlx1MTEyRSI7CiB0WyJcdTMxN0MiXSA9ICJcdTExMkYiOwogdFsiXHUzMTdEIl0gPSAiXHUxMTMyIjsKIHRbIlx1MzE3RSJdID0gIlx1MTEzNiI7CiB0WyJcdTMxN0YiXSA9ICJcdTExNDAiOwogdFsiXHUzMTgwIl0gPSAiXHUxMTQ3IjsKIHRbIlx1MzE4MSJdID0gIlx1MTE0QyI7CiB0WyJcdTMxODIiXSA9ICJcdTExRjEiOwogdFsiXHUzMTgzIl0gPSAiXHUxMUYyIjsKIHRbIlx1MzE4NCJdID0gIlx1MTE1NyI7CiB0WyJcdTMxODUiXSA9ICJcdTExNTgiOwogdFsiXHUzMTg2Il0gPSAiXHUxMTU5IjsKIHRbIlx1MzE4NyJdID0gIlx1MTE4NCI7CiB0WyJcdTMxODgiXSA9ICJcdTExODUiOwogdFsiXHUzMTg5Il0gPSAiXHUxMTg4IjsKIHRbIlx1MzE4QSJdID0gIlx1MTE5MSI7CiB0WyJcdTMxOEIiXSA9ICJcdTExOTIiOwogdFsiXHUzMThDIl0gPSAiXHUxMTk0IjsKIHRbIlx1MzE4RCJdID0gIlx1MTE5RSI7CiB0WyJcdTMxOEUiXSA9ICJcdTExQTEiOwogdFsiXHUzMjAwIl0gPSAiXHUwMDI4XHUxMTAwXHUwMDI5IjsKIHRbIlx1MzIwMSJdID0gIlx1MDAyOFx1MTEwMlx1MDAyOSI7CiB0WyJcdTMyMDIiXSA9ICJcdTAwMjhcdTExMDNcdTAwMjkiOwogdFsiXHUzMjAzIl0gPSAiXHUwMDI4XHUxMTA1XHUwMDI5IjsKIHRbIlx1MzIwNCJdID0gIlx1MDAyOFx1MTEwNlx1MDAyOSI7CiB0WyJcdTMyMDUiXSA9ICJcdTAwMjhcdTExMDdcdTAwMjkiOwogdFsiXHUzMjA2Il0gPSAiXHUwMDI4XHUxMTA5XHUwMDI5IjsKIHRbIlx1MzIwNyJdID0gIlx1MDAyOFx1MTEwQlx1MDAyOSI7CiB0WyJcdTMyMDgiXSA9ICJcdTAwMjhcdTExMENcdTAwMjkiOwogdFsiXHUzMjA5Il0gPSAiXHUwMDI4XHUxMTBFXHUwMDI5IjsKIHRbIlx1MzIwQSJdID0gIlx1MDAyOFx1MTEwRlx1MDAyOSI7CiB0WyJcdTMyMEIiXSA9ICJcdTAwMjhcdTExMTBcdTAwMjkiOwogdFsiXHUzMjBDIl0gPSAiXHUwMDI4XHUxMTExXHUwMDI5IjsKIHRbIlx1MzIwRCJdID0gIlx1MDAyOFx1MTExMlx1MDAyOSI7CiB0WyJcdTMyMEUiXSA9ICJcdTAwMjhcdTExMDBcdTExNjFcdTAwMjkiOwogdFsiXHUzMjBGIl0gPSAiXHUwMDI4XHUxMTAyXHUxMTYxXHUwMDI5IjsKIHRbIlx1MzIxMCJdID0gIlx1MDAyOFx1MTEwM1x1MTE2MVx1MDAyOSI7CiB0WyJcdTMyMTEiXSA9ICJcdTAwMjhcdTExMDVcdTExNjFcdTAwMjkiOwogdFsiXHUzMjEyIl0gPSAiXHUwMDI4XHUxMTA2XHUxMTYxXHUwMDI5IjsKIHRbIlx1MzIxMyJdID0gIlx1MDAyOFx1MTEwN1x1MTE2MVx1MDAyOSI7CiB0WyJcdTMyMTQiXSA9ICJcdTAwMjhcdTExMDlcdTExNjFcdTAwMjkiOwogdFsiXHUzMjE1Il0gPSAiXHUwMDI4XHUxMTBCXHUxMTYxXHUwMDI5IjsKIHRbIlx1MzIxNiJdID0gIlx1MDAyOFx1MTEwQ1x1MTE2MVx1MDAyOSI7CiB0WyJcdTMyMTciXSA9ICJcdTAwMjhcdTExMEVcdTExNjFcdTAwMjkiOwogdFsiXHUzMjE4Il0gPSAiXHUwMDI4XHUxMTBGXHUxMTYxXHUwMDI5IjsKIHRbIlx1MzIxOSJdID0gIlx1MDAyOFx1MTExMFx1MTE2MVx1MDAyOSI7CiB0WyJcdTMyMUEiXSA9ICJcdTAwMjhcdTExMTFcdTExNjFcdTAwMjkiOwogdFsiXHUzMjFCIl0gPSAiXHUwMDI4XHUxMTEyXHUxMTYxXHUwMDI5IjsKIHRbIlx1MzIxQyJdID0gIlx1MDAyOFx1MTEwQ1x1MTE2RVx1MDAyOSI7CiB0WyJcdTMyMUQiXSA9ICJcdTAwMjhcdTExMEJcdTExNjlcdTExMENcdTExNjVcdTExQUJcdTAwMjkiOwogdFsiXHUzMjFFIl0gPSAiXHUwMDI4XHUxMTBCXHUxMTY5XHUxMTEyXHUxMTZFXHUwMDI5IjsKIHRbIlx1MzIyMCJdID0gIlx1MDAyOFx1NEUwMFx1MDAyOSI7CiB0WyJcdTMyMjEiXSA9ICJcdTAwMjhcdTRFOENcdTAwMjkiOwogdFsiXHUzMjIyIl0gPSAiXHUwMDI4XHU0RTA5XHUwMDI5IjsKIHRbIlx1MzIyMyJdID0gIlx1MDAyOFx1NTZEQlx1MDAyOSI7CiB0WyJcdTMyMjQiXSA9ICJcdTAwMjhcdTRFOTRcdTAwMjkiOwogdFsiXHUzMjI1Il0gPSAiXHUwMDI4XHU1MTZEXHUwMDI5IjsKIHRbIlx1MzIyNiJdID0gIlx1MDAyOFx1NEUwM1x1MDAyOSI7CiB0WyJcdTMyMjciXSA9ICJcdTAwMjhcdTUxNkJcdTAwMjkiOwogdFsiXHUzMjI4Il0gPSAiXHUwMDI4XHU0RTVEXHUwMDI5IjsKIHRbIlx1MzIyOSJdID0gIlx1MDAyOFx1NTM0MVx1MDAyOSI7CiB0WyJcdTMyMkEiXSA9ICJcdTAwMjhcdTY3MDhcdTAwMjkiOwogdFsiXHUzMjJCIl0gPSAiXHUwMDI4XHU3MDZCXHUwMDI5IjsKIHRbIlx1MzIyQyJdID0gIlx1MDAyOFx1NkMzNFx1MDAyOSI7CiB0WyJcdTMyMkQiXSA9ICJcdTAwMjhcdTY3MjhcdTAwMjkiOwogdFsiXHUzMjJFIl0gPSAiXHUwMDI4XHU5MUQxXHUwMDI5IjsKIHRbIlx1MzIyRiJdID0gIlx1MDAyOFx1NTcxRlx1MDAyOSI7CiB0WyJcdTMyMzAiXSA9ICJcdTAwMjhcdTY1RTVcdTAwMjkiOwogdFsiXHUzMjMxIl0gPSAiXHUwMDI4XHU2ODJBXHUwMDI5IjsKIHRbIlx1MzIzMiJdID0gIlx1MDAyOFx1NjcwOVx1MDAyOSI7CiB0WyJcdTMyMzMiXSA9ICJcdTAwMjhcdTc5M0VcdTAwMjkiOwogdFsiXHUzMjM0Il0gPSAiXHUwMDI4XHU1NDBEXHUwMDI5IjsKIHRbIlx1MzIzNSJdID0gIlx1MDAyOFx1NzI3OVx1MDAyOSI7CiB0WyJcdTMyMzYiXSA9ICJcdTAwMjhcdThDQTFcdTAwMjkiOwogdFsiXHUzMjM3Il0gPSAiXHUwMDI4XHU3OTVEXHUwMDI5IjsKIHRbIlx1MzIzOCJdID0gIlx1MDAyOFx1NTJCNFx1MDAyOSI7CiB0WyJcdTMyMzkiXSA9ICJcdTAwMjhcdTRFRTNcdTAwMjkiOwogdFsiXHUzMjNBIl0gPSAiXHUwMDI4XHU1NDdDXHUwMDI5IjsKIHRbIlx1MzIzQiJdID0gIlx1MDAyOFx1NUI2Nlx1MDAyOSI7CiB0WyJcdTMyM0MiXSA9ICJcdTAwMjhcdTc2RTNcdTAwMjkiOwogdFsiXHUzMjNEIl0gPSAiXHUwMDI4XHU0RjAxXHUwMDI5IjsKIHRbIlx1MzIzRSJdID0gIlx1MDAyOFx1OENDN1x1MDAyOSI7CiB0WyJcdTMyM0YiXSA9ICJcdTAwMjhcdTUzNTRcdTAwMjkiOwogdFsiXHUzMjQwIl0gPSAiXHUwMDI4XHU3OTZEXHUwMDI5IjsKIHRbIlx1MzI0MSJdID0gIlx1MDAyOFx1NEYxMVx1MDAyOSI7CiB0WyJcdTMyNDIiXSA9ICJcdTAwMjhcdTgxRUFcdTAwMjkiOwogdFsiXHUzMjQzIl0gPSAiXHUwMDI4XHU4MUYzXHUwMDI5IjsKIHRbIlx1MzJDMCJdID0gIlx1MDAzMVx1NjcwOCI7CiB0WyJcdTMyQzEiXSA9ICJcdTAwMzJcdTY3MDgiOwogdFsiXHUzMkMyIl0gPSAiXHUwMDMzXHU2NzA4IjsKIHRbIlx1MzJDMyJdID0gIlx1MDAzNFx1NjcwOCI7CiB0WyJcdTMyQzQiXSA9ICJcdTAwMzVcdTY3MDgiOwogdFsiXHUzMkM1Il0gPSAiXHUwMDM2XHU2NzA4IjsKIHRbIlx1MzJDNiJdID0gIlx1MDAzN1x1NjcwOCI7CiB0WyJcdTMyQzciXSA9ICJcdTAwMzhcdTY3MDgiOwogdFsiXHUzMkM4Il0gPSAiXHUwMDM5XHU2NzA4IjsKIHRbIlx1MzJDOSJdID0gIlx1MDAzMVx1MDAzMFx1NjcwOCI7CiB0WyJcdTMyQ0EiXSA9ICJcdTAwMzFcdTAwMzFcdTY3MDgiOwogdFsiXHUzMkNCIl0gPSAiXHUwMDMxXHUwMDMyXHU2NzA4IjsKIHRbIlx1MzM1OCJdID0gIlx1MDAzMFx1NzBCOSI7CiB0WyJcdTMzNTkiXSA9ICJcdTAwMzFcdTcwQjkiOwogdFsiXHUzMzVBIl0gPSAiXHUwMDMyXHU3MEI5IjsKIHRbIlx1MzM1QiJdID0gIlx1MDAzM1x1NzBCOSI7CiB0WyJcdTMzNUMiXSA9ICJcdTAwMzRcdTcwQjkiOwogdFsiXHUzMzVEIl0gPSAiXHUwMDM1XHU3MEI5IjsKIHRbIlx1MzM1RSJdID0gIlx1MDAzNlx1NzBCOSI7CiB0WyJcdTMzNUYiXSA9ICJcdTAwMzdcdTcwQjkiOwogdFsiXHUzMzYwIl0gPSAiXHUwMDM4XHU3MEI5IjsKIHRbIlx1MzM2MSJdID0gIlx1MDAzOVx1NzBCOSI7CiB0WyJcdTMzNjIiXSA9ICJcdTAwMzFcdTAwMzBcdTcwQjkiOwogdFsiXHUzMzYzIl0gPSAiXHUwMDMxXHUwMDMxXHU3MEI5IjsKIHRbIlx1MzM2NCJdID0gIlx1MDAzMVx1MDAzMlx1NzBCOSI7CiB0WyJcdTMzNjUiXSA9ICJcdTAwMzFcdTAwMzNcdTcwQjkiOwogdFsiXHUzMzY2Il0gPSAiXHUwMDMxXHUwMDM0XHU3MEI5IjsKIHRbIlx1MzM2NyJdID0gIlx1MDAzMVx1MDAzNVx1NzBCOSI7CiB0WyJcdTMzNjgiXSA9ICJcdTAwMzFcdTAwMzZcdTcwQjkiOwogdFsiXHUzMzY5Il0gPSAiXHUwMDMxXHUwMDM3XHU3MEI5IjsKIHRbIlx1MzM2QSJdID0gIlx1MDAzMVx1MDAzOFx1NzBCOSI7CiB0WyJcdTMzNkIiXSA9ICJcdTAwMzFcdTAwMzlcdTcwQjkiOwogdFsiXHUzMzZDIl0gPSAiXHUwMDMyXHUwMDMwXHU3MEI5IjsKIHRbIlx1MzM2RCJdID0gIlx1MDAzMlx1MDAzMVx1NzBCOSI7CiB0WyJcdTMzNkUiXSA9ICJcdTAwMzJcdTAwMzJcdTcwQjkiOwogdFsiXHUzMzZGIl0gPSAiXHUwMDMyXHUwMDMzXHU3MEI5IjsKIHRbIlx1MzM3MCJdID0gIlx1MDAzMlx1MDAzNFx1NzBCOSI7CiB0WyJcdTMzRTAiXSA9ICJcdTAwMzFcdTY1RTUiOwogdFsiXHUzM0UxIl0gPSAiXHUwMDMyXHU2NUU1IjsKIHRbIlx1MzNFMiJdID0gIlx1MDAzM1x1NjVFNSI7CiB0WyJcdTMzRTMiXSA9ICJcdTAwMzRcdTY1RTUiOwogdFsiXHUzM0U0Il0gPSAiXHUwMDM1XHU2NUU1IjsKIHRbIlx1MzNFNSJdID0gIlx1MDAzNlx1NjVFNSI7CiB0WyJcdTMzRTYiXSA9ICJcdTAwMzdcdTY1RTUiOwogdFsiXHUzM0U3Il0gPSAiXHUwMDM4XHU2NUU1IjsKIHRbIlx1MzNFOCJdID0gIlx1MDAzOVx1NjVFNSI7CiB0WyJcdTMzRTkiXSA9ICJcdTAwMzFcdTAwMzBcdTY1RTUiOwogdFsiXHUzM0VBIl0gPSAiXHUwMDMxXHUwMDMxXHU2NUU1IjsKIHRbIlx1MzNFQiJdID0gIlx1MDAzMVx1MDAzMlx1NjVFNSI7CiB0WyJcdTMzRUMiXSA9ICJcdTAwMzFcdTAwMzNcdTY1RTUiOwogdFsiXHUzM0VEIl0gPSAiXHUwMDMxXHUwMDM0XHU2NUU1IjsKIHRbIlx1MzNFRSJdID0gIlx1MDAzMVx1MDAzNVx1NjVFNSI7CiB0WyJcdTMzRUYiXSA9ICJcdTAwMzFcdTAwMzZcdTY1RTUiOwogdFsiXHUzM0YwIl0gPSAiXHUwMDMxXHUwMDM3XHU2NUU1IjsKIHRbIlx1MzNGMSJdID0gIlx1MDAzMVx1MDAzOFx1NjVFNSI7CiB0WyJcdTMzRjIiXSA9ICJcdTAwMzFcdTAwMzlcdTY1RTUiOwogdFsiXHUzM0YzIl0gPSAiXHUwMDMyXHUwMDMwXHU2NUU1IjsKIHRbIlx1MzNGNCJdID0gIlx1MDAzMlx1MDAzMVx1NjVFNSI7CiB0WyJcdTMzRjUiXSA9ICJcdTAwMzJcdTAwMzJcdTY1RTUiOwogdFsiXHUzM0Y2Il0gPSAiXHUwMDMyXHUwMDMzXHU2NUU1IjsKIHRbIlx1MzNGNyJdID0gIlx1MDAzMlx1MDAzNFx1NjVFNSI7CiB0WyJcdTMzRjgiXSA9ICJcdTAwMzJcdTAwMzVcdTY1RTUiOwogdFsiXHUzM0Y5Il0gPSAiXHUwMDMyXHUwMDM2XHU2NUU1IjsKIHRbIlx1MzNGQSJdID0gIlx1MDAzMlx1MDAzN1x1NjVFNSI7CiB0WyJcdTMzRkIiXSA9ICJcdTAwMzJcdTAwMzhcdTY1RTUiOwogdFsiXHUzM0ZDIl0gPSAiXHUwMDMyXHUwMDM5XHU2NUU1IjsKIHRbIlx1MzNGRCJdID0gIlx1MDAzM1x1MDAzMFx1NjVFNSI7CiB0WyJcdTMzRkUiXSA9ICJcdTAwMzNcdTAwMzFcdTY1RTUiOwogdFsiXHVGQjAwIl0gPSAiXHUwMDY2XHUwMDY2IjsKIHRbIlx1RkIwMSJdID0gIlx1MDA2Nlx1MDA2OSI7CiB0WyJcdUZCMDIiXSA9ICJcdTAwNjZcdTAwNkMiOwogdFsiXHVGQjAzIl0gPSAiXHUwMDY2XHUwMDY2XHUwMDY5IjsKIHRbIlx1RkIwNCJdID0gIlx1MDA2Nlx1MDA2Nlx1MDA2QyI7CiB0WyJcdUZCMDUiXSA9ICJcdTAxN0ZcdTAwNzQiOwogdFsiXHVGQjA2Il0gPSAiXHUwMDczXHUwMDc0IjsKIHRbIlx1RkIxMyJdID0gIlx1MDU3NFx1MDU3NiI7CiB0WyJcdUZCMTQiXSA9ICJcdTA1NzRcdTA1NjUiOwogdFsiXHVGQjE1Il0gPSAiXHUwNTc0XHUwNTZCIjsKIHRbIlx1RkIxNiJdID0gIlx1MDU3RVx1MDU3NiI7CiB0WyJcdUZCMTciXSA9ICJcdTA1NzRcdTA1NkQiOwogdFsiXHVGQjRGIl0gPSAiXHUwNUQwXHUwNURDIjsKIHRbIlx1RkI1MCJdID0gIlx1MDY3MSI7CiB0WyJcdUZCNTEiXSA9ICJcdTA2NzEiOwogdFsiXHVGQjUyIl0gPSAiXHUwNjdCIjsKIHRbIlx1RkI1MyJdID0gIlx1MDY3QiI7CiB0WyJcdUZCNTQiXSA9ICJcdTA2N0IiOwogdFsiXHVGQjU1Il0gPSAiXHUwNjdCIjsKIHRbIlx1RkI1NiJdID0gIlx1MDY3RSI7CiB0WyJcdUZCNTciXSA9ICJcdTA2N0UiOwogdFsiXHVGQjU4Il0gPSAiXHUwNjdFIjsKIHRbIlx1RkI1OSJdID0gIlx1MDY3RSI7CiB0WyJcdUZCNUEiXSA9ICJcdTA2ODAiOwogdFsiXHVGQjVCIl0gPSAiXHUwNjgwIjsKIHRbIlx1RkI1QyJdID0gIlx1MDY4MCI7CiB0WyJcdUZCNUQiXSA9ICJcdTA2ODAiOwogdFsiXHVGQjVFIl0gPSAiXHUwNjdBIjsKIHRbIlx1RkI1RiJdID0gIlx1MDY3QSI7CiB0WyJcdUZCNjAiXSA9ICJcdTA2N0EiOwogdFsiXHVGQjYxIl0gPSAiXHUwNjdBIjsKIHRbIlx1RkI2MiJdID0gIlx1MDY3RiI7CiB0WyJcdUZCNjMiXSA9ICJcdTA2N0YiOwogdFsiXHVGQjY0Il0gPSAiXHUwNjdGIjsKIHRbIlx1RkI2NSJdID0gIlx1MDY3RiI7CiB0WyJcdUZCNjYiXSA9ICJcdTA2NzkiOwogdFsiXHVGQjY3Il0gPSAiXHUwNjc5IjsKIHRbIlx1RkI2OCJdID0gIlx1MDY3OSI7CiB0WyJcdUZCNjkiXSA9ICJcdTA2NzkiOwogdFsiXHVGQjZBIl0gPSAiXHUwNkE0IjsKIHRbIlx1RkI2QiJdID0gIlx1MDZBNCI7CiB0WyJcdUZCNkMiXSA9ICJcdTA2QTQiOwogdFsiXHVGQjZEIl0gPSAiXHUwNkE0IjsKIHRbIlx1RkI2RSJdID0gIlx1MDZBNiI7CiB0WyJcdUZCNkYiXSA9ICJcdTA2QTYiOwogdFsiXHVGQjcwIl0gPSAiXHUwNkE2IjsKIHRbIlx1RkI3MSJdID0gIlx1MDZBNiI7CiB0WyJcdUZCNzIiXSA9ICJcdTA2ODQiOwogdFsiXHVGQjczIl0gPSAiXHUwNjg0IjsKIHRbIlx1RkI3NCJdID0gIlx1MDY4NCI7CiB0WyJcdUZCNzUiXSA9ICJcdTA2ODQiOwogdFsiXHVGQjc2Il0gPSAiXHUwNjgzIjsKIHRbIlx1RkI3NyJdID0gIlx1MDY4MyI7CiB0WyJcdUZCNzgiXSA9ICJcdTA2ODMiOwogdFsiXHVGQjc5Il0gPSAiXHUwNjgzIjsKIHRbIlx1RkI3QSJdID0gIlx1MDY4NiI7CiB0WyJcdUZCN0IiXSA9ICJcdTA2ODYiOwogdFsiXHVGQjdDIl0gPSAiXHUwNjg2IjsKIHRbIlx1RkI3RCJdID0gIlx1MDY4NiI7CiB0WyJcdUZCN0UiXSA9ICJcdTA2ODciOwogdFsiXHVGQjdGIl0gPSAiXHUwNjg3IjsKIHRbIlx1RkI4MCJdID0gIlx1MDY4NyI7CiB0WyJcdUZCODEiXSA9ICJcdTA2ODciOwogdFsiXHVGQjgyIl0gPSAiXHUwNjhEIjsKIHRbIlx1RkI4MyJdID0gIlx1MDY4RCI7CiB0WyJcdUZCODQiXSA9ICJcdTA2OEMiOwogdFsiXHVGQjg1Il0gPSAiXHUwNjhDIjsKIHRbIlx1RkI4NiJdID0gIlx1MDY4RSI7CiB0WyJcdUZCODciXSA9ICJcdTA2OEUiOwogdFsiXHVGQjg4Il0gPSAiXHUwNjg4IjsKIHRbIlx1RkI4OSJdID0gIlx1MDY4OCI7CiB0WyJcdUZCOEEiXSA9ICJcdTA2OTgiOwogdFsiXHVGQjhCIl0gPSAiXHUwNjk4IjsKIHRbIlx1RkI4QyJdID0gIlx1MDY5MSI7CiB0WyJcdUZCOEQiXSA9ICJcdTA2OTEiOwogdFsiXHVGQjhFIl0gPSAiXHUwNkE5IjsKIHRbIlx1RkI4RiJdID0gIlx1MDZBOSI7CiB0WyJcdUZCOTAiXSA9ICJcdTA2QTkiOwogdFsiXHVGQjkxIl0gPSAiXHUwNkE5IjsKIHRbIlx1RkI5MiJdID0gIlx1MDZBRiI7CiB0WyJcdUZCOTMiXSA9ICJcdTA2QUYiOwogdFsiXHVGQjk0Il0gPSAiXHUwNkFGIjsKIHRbIlx1RkI5NSJdID0gIlx1MDZBRiI7CiB0WyJcdUZCOTYiXSA9ICJcdTA2QjMiOwogdFsiXHVGQjk3Il0gPSAiXHUwNkIzIjsKIHRbIlx1RkI5OCJdID0gIlx1MDZCMyI7CiB0WyJcdUZCOTkiXSA9ICJcdTA2QjMiOwogdFsiXHVGQjlBIl0gPSAiXHUwNkIxIjsKIHRbIlx1RkI5QiJdID0gIlx1MDZCMSI7CiB0WyJcdUZCOUMiXSA9ICJcdTA2QjEiOwogdFsiXHVGQjlEIl0gPSAiXHUwNkIxIjsKIHRbIlx1RkI5RSJdID0gIlx1MDZCQSI7CiB0WyJcdUZCOUYiXSA9ICJcdTA2QkEiOwogdFsiXHVGQkEwIl0gPSAiXHUwNkJCIjsKIHRbIlx1RkJBMSJdID0gIlx1MDZCQiI7CiB0WyJcdUZCQTIiXSA9ICJcdTA2QkIiOwogdFsiXHVGQkEzIl0gPSAiXHUwNkJCIjsKIHRbIlx1RkJBNCJdID0gIlx1MDZDMCI7CiB0WyJcdUZCQTUiXSA9ICJcdTA2QzAiOwogdFsiXHVGQkE2Il0gPSAiXHUwNkMxIjsKIHRbIlx1RkJBNyJdID0gIlx1MDZDMSI7CiB0WyJcdUZCQTgiXSA9ICJcdTA2QzEiOwogdFsiXHVGQkE5Il0gPSAiXHUwNkMxIjsKIHRbIlx1RkJBQSJdID0gIlx1MDZCRSI7CiB0WyJcdUZCQUIiXSA9ICJcdTA2QkUiOwogdFsiXHVGQkFDIl0gPSAiXHUwNkJFIjsKIHRbIlx1RkJBRCJdID0gIlx1MDZCRSI7CiB0WyJcdUZCQUUiXSA9ICJcdTA2RDIiOwogdFsiXHVGQkFGIl0gPSAiXHUwNkQyIjsKIHRbIlx1RkJCMCJdID0gIlx1MDZEMyI7CiB0WyJcdUZCQjEiXSA9ICJcdTA2RDMiOwogdFsiXHVGQkQzIl0gPSAiXHUwNkFEIjsKIHRbIlx1RkJENCJdID0gIlx1MDZBRCI7CiB0WyJcdUZCRDUiXSA9ICJcdTA2QUQiOwogdFsiXHVGQkQ2Il0gPSAiXHUwNkFEIjsKIHRbIlx1RkJENyJdID0gIlx1MDZDNyI7CiB0WyJcdUZCRDgiXSA9ICJcdTA2QzciOwogdFsiXHVGQkQ5Il0gPSAiXHUwNkM2IjsKIHRbIlx1RkJEQSJdID0gIlx1MDZDNiI7CiB0WyJcdUZCREIiXSA9ICJcdTA2QzgiOwogdFsiXHVGQkRDIl0gPSAiXHUwNkM4IjsKIHRbIlx1RkJERCJdID0gIlx1MDY3NyI7CiB0WyJcdUZCREUiXSA9ICJcdTA2Q0IiOwogdFsiXHVGQkRGIl0gPSAiXHUwNkNCIjsKIHRbIlx1RkJFMCJdID0gIlx1MDZDNSI7CiB0WyJcdUZCRTEiXSA9ICJcdTA2QzUiOwogdFsiXHVGQkUyIl0gPSAiXHUwNkM5IjsKIHRbIlx1RkJFMyJdID0gIlx1MDZDOSI7CiB0WyJcdUZCRTQiXSA9ICJcdTA2RDAiOwogdFsiXHVGQkU1Il0gPSAiXHUwNkQwIjsKIHRbIlx1RkJFNiJdID0gIlx1MDZEMCI7CiB0WyJcdUZCRTciXSA9ICJcdTA2RDAiOwogdFsiXHVGQkU4Il0gPSAiXHUwNjQ5IjsKIHRbIlx1RkJFOSJdID0gIlx1MDY0OSI7CiB0WyJcdUZCRUEiXSA9ICJcdTA2MjZcdTA2MjciOwogdFsiXHVGQkVCIl0gPSAiXHUwNjI2XHUwNjI3IjsKIHRbIlx1RkJFQyJdID0gIlx1MDYyNlx1MDZENSI7CiB0WyJcdUZCRUQiXSA9ICJcdTA2MjZcdTA2RDUiOwogdFsiXHVGQkVFIl0gPSAiXHUwNjI2XHUwNjQ4IjsKIHRbIlx1RkJFRiJdID0gIlx1MDYyNlx1MDY0OCI7CiB0WyJcdUZCRjAiXSA9ICJcdTA2MjZcdTA2QzciOwogdFsiXHVGQkYxIl0gPSAiXHUwNjI2XHUwNkM3IjsKIHRbIlx1RkJGMiJdID0gIlx1MDYyNlx1MDZDNiI7CiB0WyJcdUZCRjMiXSA9ICJcdTA2MjZcdTA2QzYiOwogdFsiXHVGQkY0Il0gPSAiXHUwNjI2XHUwNkM4IjsKIHRbIlx1RkJGNSJdID0gIlx1MDYyNlx1MDZDOCI7CiB0WyJcdUZCRjYiXSA9ICJcdTA2MjZcdTA2RDAiOwogdFsiXHVGQkY3Il0gPSAiXHUwNjI2XHUwNkQwIjsKIHRbIlx1RkJGOCJdID0gIlx1MDYyNlx1MDZEMCI7CiB0WyJcdUZCRjkiXSA9ICJcdTA2MjZcdTA2NDkiOwogdFsiXHVGQkZBIl0gPSAiXHUwNjI2XHUwNjQ5IjsKIHRbIlx1RkJGQiJdID0gIlx1MDYyNlx1MDY0OSI7CiB0WyJcdUZCRkMiXSA9ICJcdTA2Q0MiOwogdFsiXHVGQkZEIl0gPSAiXHUwNkNDIjsKIHRbIlx1RkJGRSJdID0gIlx1MDZDQyI7CiB0WyJcdUZCRkYiXSA9ICJcdTA2Q0MiOwogdFsiXHVGQzAwIl0gPSAiXHUwNjI2XHUwNjJDIjsKIHRbIlx1RkMwMSJdID0gIlx1MDYyNlx1MDYyRCI7CiB0WyJcdUZDMDIiXSA9ICJcdTA2MjZcdTA2NDUiOwogdFsiXHVGQzAzIl0gPSAiXHUwNjI2XHUwNjQ5IjsKIHRbIlx1RkMwNCJdID0gIlx1MDYyNlx1MDY0QSI7CiB0WyJcdUZDMDUiXSA9ICJcdTA2MjhcdTA2MkMiOwogdFsiXHVGQzA2Il0gPSAiXHUwNjI4XHUwNjJEIjsKIHRbIlx1RkMwNyJdID0gIlx1MDYyOFx1MDYyRSI7CiB0WyJcdUZDMDgiXSA9ICJcdTA2MjhcdTA2NDUiOwogdFsiXHVGQzA5Il0gPSAiXHUwNjI4XHUwNjQ5IjsKIHRbIlx1RkMwQSJdID0gIlx1MDYyOFx1MDY0QSI7CiB0WyJcdUZDMEIiXSA9ICJcdTA2MkFcdTA2MkMiOwogdFsiXHVGQzBDIl0gPSAiXHUwNjJBXHUwNjJEIjsKIHRbIlx1RkMwRCJdID0gIlx1MDYyQVx1MDYyRSI7CiB0WyJcdUZDMEUiXSA9ICJcdTA2MkFcdTA2NDUiOwogdFsiXHVGQzBGIl0gPSAiXHUwNjJBXHUwNjQ5IjsKIHRbIlx1RkMxMCJdID0gIlx1MDYyQVx1MDY0QSI7CiB0WyJcdUZDMTEiXSA9ICJcdTA2MkJcdTA2MkMiOwogdFsiXHVGQzEyIl0gPSAiXHUwNjJCXHUwNjQ1IjsKIHRbIlx1RkMxMyJdID0gIlx1MDYyQlx1MDY0OSI7CiB0WyJcdUZDMTQiXSA9ICJcdTA2MkJcdTA2NEEiOwogdFsiXHVGQzE1Il0gPSAiXHUwNjJDXHUwNjJEIjsKIHRbIlx1RkMxNiJdID0gIlx1MDYyQ1x1MDY0NSI7CiB0WyJcdUZDMTciXSA9ICJcdTA2MkRcdTA2MkMiOwogdFsiXHVGQzE4Il0gPSAiXHUwNjJEXHUwNjQ1IjsKIHRbIlx1RkMxOSJdID0gIlx1MDYyRVx1MDYyQyI7CiB0WyJcdUZDMUEiXSA9ICJcdTA2MkVcdTA2MkQiOwogdFsiXHVGQzFCIl0gPSAiXHUwNjJFXHUwNjQ1IjsKIHRbIlx1RkMxQyJdID0gIlx1MDYzM1x1MDYyQyI7CiB0WyJcdUZDMUQiXSA9ICJcdTA2MzNcdTA2MkQiOwogdFsiXHVGQzFFIl0gPSAiXHUwNjMzXHUwNjJFIjsKIHRbIlx1RkMxRiJdID0gIlx1MDYzM1x1MDY0NSI7CiB0WyJcdUZDMjAiXSA9ICJcdTA2MzVcdTA2MkQiOwogdFsiXHVGQzIxIl0gPSAiXHUwNjM1XHUwNjQ1IjsKIHRbIlx1RkMyMiJdID0gIlx1MDYzNlx1MDYyQyI7CiB0WyJcdUZDMjMiXSA9ICJcdTA2MzZcdTA2MkQiOwogdFsiXHVGQzI0Il0gPSAiXHUwNjM2XHUwNjJFIjsKIHRbIlx1RkMyNSJdID0gIlx1MDYzNlx1MDY0NSI7CiB0WyJcdUZDMjYiXSA9ICJcdTA2MzdcdTA2MkQiOwogdFsiXHVGQzI3Il0gPSAiXHUwNjM3XHUwNjQ1IjsKIHRbIlx1RkMyOCJdID0gIlx1MDYzOFx1MDY0NSI7CiB0WyJcdUZDMjkiXSA9ICJcdTA2MzlcdTA2MkMiOwogdFsiXHVGQzJBIl0gPSAiXHUwNjM5XHUwNjQ1IjsKIHRbIlx1RkMyQiJdID0gIlx1MDYzQVx1MDYyQyI7CiB0WyJcdUZDMkMiXSA9ICJcdTA2M0FcdTA2NDUiOwogdFsiXHVGQzJEIl0gPSAiXHUwNjQxXHUwNjJDIjsKIHRbIlx1RkMyRSJdID0gIlx1MDY0MVx1MDYyRCI7CiB0WyJcdUZDMkYiXSA9ICJcdTA2NDFcdTA2MkUiOwogdFsiXHVGQzMwIl0gPSAiXHUwNjQxXHUwNjQ1IjsKIHRbIlx1RkMzMSJdID0gIlx1MDY0MVx1MDY0OSI7CiB0WyJcdUZDMzIiXSA9ICJcdTA2NDFcdTA2NEEiOwogdFsiXHVGQzMzIl0gPSAiXHUwNjQyXHUwNjJEIjsKIHRbIlx1RkMzNCJdID0gIlx1MDY0Mlx1MDY0NSI7CiB0WyJcdUZDMzUiXSA9ICJcdTA2NDJcdTA2NDkiOwogdFsiXHVGQzM2Il0gPSAiXHUwNjQyXHUwNjRBIjsKIHRbIlx1RkMzNyJdID0gIlx1MDY0M1x1MDYyNyI7CiB0WyJcdUZDMzgiXSA9ICJcdTA2NDNcdTA2MkMiOwogdFsiXHVGQzM5Il0gPSAiXHUwNjQzXHUwNjJEIjsKIHRbIlx1RkMzQSJdID0gIlx1MDY0M1x1MDYyRSI7CiB0WyJcdUZDM0IiXSA9ICJcdTA2NDNcdTA2NDQiOwogdFsiXHVGQzNDIl0gPSAiXHUwNjQzXHUwNjQ1IjsKIHRbIlx1RkMzRCJdID0gIlx1MDY0M1x1MDY0OSI7CiB0WyJcdUZDM0UiXSA9ICJcdTA2NDNcdTA2NEEiOwogdFsiXHVGQzNGIl0gPSAiXHUwNjQ0XHUwNjJDIjsKIHRbIlx1RkM0MCJdID0gIlx1MDY0NFx1MDYyRCI7CiB0WyJcdUZDNDEiXSA9ICJcdTA2NDRcdTA2MkUiOwogdFsiXHVGQzQyIl0gPSAiXHUwNjQ0XHUwNjQ1IjsKIHRbIlx1RkM0MyJdID0gIlx1MDY0NFx1MDY0OSI7CiB0WyJcdUZDNDQiXSA9ICJcdTA2NDRcdTA2NEEiOwogdFsiXHVGQzQ1Il0gPSAiXHUwNjQ1XHUwNjJDIjsKIHRbIlx1RkM0NiJdID0gIlx1MDY0NVx1MDYyRCI7CiB0WyJcdUZDNDciXSA9ICJcdTA2NDVcdTA2MkUiOwogdFsiXHVGQzQ4Il0gPSAiXHUwNjQ1XHUwNjQ1IjsKIHRbIlx1RkM0OSJdID0gIlx1MDY0NVx1MDY0OSI7CiB0WyJcdUZDNEEiXSA9ICJcdTA2NDVcdTA2NEEiOwogdFsiXHVGQzRCIl0gPSAiXHUwNjQ2XHUwNjJDIjsKIHRbIlx1RkM0QyJdID0gIlx1MDY0Nlx1MDYyRCI7CiB0WyJcdUZDNEQiXSA9ICJcdTA2NDZcdTA2MkUiOwogdFsiXHVGQzRFIl0gPSAiXHUwNjQ2XHUwNjQ1IjsKIHRbIlx1RkM0RiJdID0gIlx1MDY0Nlx1MDY0OSI7CiB0WyJcdUZDNTAiXSA9ICJcdTA2NDZcdTA2NEEiOwogdFsiXHVGQzUxIl0gPSAiXHUwNjQ3XHUwNjJDIjsKIHRbIlx1RkM1MiJdID0gIlx1MDY0N1x1MDY0NSI7CiB0WyJcdUZDNTMiXSA9ICJcdTA2NDdcdTA2NDkiOwogdFsiXHVGQzU0Il0gPSAiXHUwNjQ3XHUwNjRBIjsKIHRbIlx1RkM1NSJdID0gIlx1MDY0QVx1MDYyQyI7CiB0WyJcdUZDNTYiXSA9ICJcdTA2NEFcdTA2MkQiOwogdFsiXHVGQzU3Il0gPSAiXHUwNjRBXHUwNjJFIjsKIHRbIlx1RkM1OCJdID0gIlx1MDY0QVx1MDY0NSI7CiB0WyJcdUZDNTkiXSA9ICJcdTA2NEFcdTA2NDkiOwogdFsiXHVGQzVBIl0gPSAiXHUwNjRBXHUwNjRBIjsKIHRbIlx1RkM1QiJdID0gIlx1MDYzMFx1MDY3MCI7CiB0WyJcdUZDNUMiXSA9ICJcdTA2MzFcdTA2NzAiOwogdFsiXHVGQzVEIl0gPSAiXHUwNjQ5XHUwNjcwIjsKIHRbIlx1RkM1RSJdID0gIlx1MDAyMFx1MDY0Q1x1MDY1MSI7CiB0WyJcdUZDNUYiXSA9ICJcdTAwMjBcdTA2NERcdTA2NTEiOwogdFsiXHVGQzYwIl0gPSAiXHUwMDIwXHUwNjRFXHUwNjUxIjsKIHRbIlx1RkM2MSJdID0gIlx1MDAyMFx1MDY0Rlx1MDY1MSI7CiB0WyJcdUZDNjIiXSA9ICJcdTAwMjBcdTA2NTBcdTA2NTEiOwogdFsiXHVGQzYzIl0gPSAiXHUwMDIwXHUwNjUxXHUwNjcwIjsKIHRbIlx1RkM2NCJdID0gIlx1MDYyNlx1MDYzMSI7CiB0WyJcdUZDNjUiXSA9ICJcdTA2MjZcdTA2MzIiOwogdFsiXHVGQzY2Il0gPSAiXHUwNjI2XHUwNjQ1IjsKIHRbIlx1RkM2NyJdID0gIlx1MDYyNlx1MDY0NiI7CiB0WyJcdUZDNjgiXSA9ICJcdTA2MjZcdTA2NDkiOwogdFsiXHVGQzY5Il0gPSAiXHUwNjI2XHUwNjRBIjsKIHRbIlx1RkM2QSJdID0gIlx1MDYyOFx1MDYzMSI7CiB0WyJcdUZDNkIiXSA9ICJcdTA2MjhcdTA2MzIiOwogdFsiXHVGQzZDIl0gPSAiXHUwNjI4XHUwNjQ1IjsKIHRbIlx1RkM2RCJdID0gIlx1MDYyOFx1MDY0NiI7CiB0WyJcdUZDNkUiXSA9ICJcdTA2MjhcdTA2NDkiOwogdFsiXHVGQzZGIl0gPSAiXHUwNjI4XHUwNjRBIjsKIHRbIlx1RkM3MCJdID0gIlx1MDYyQVx1MDYzMSI7CiB0WyJcdUZDNzEiXSA9ICJcdTA2MkFcdTA2MzIiOwogdFsiXHVGQzcyIl0gPSAiXHUwNjJBXHUwNjQ1IjsKIHRbIlx1RkM3MyJdID0gIlx1MDYyQVx1MDY0NiI7CiB0WyJcdUZDNzQiXSA9ICJcdTA2MkFcdTA2NDkiOwogdFsiXHVGQzc1Il0gPSAiXHUwNjJBXHUwNjRBIjsKIHRbIlx1RkM3NiJdID0gIlx1MDYyQlx1MDYzMSI7CiB0WyJcdUZDNzciXSA9ICJcdTA2MkJcdTA2MzIiOwogdFsiXHVGQzc4Il0gPSAiXHUwNjJCXHUwNjQ1IjsKIHRbIlx1RkM3OSJdID0gIlx1MDYyQlx1MDY0NiI7CiB0WyJcdUZDN0EiXSA9ICJcdTA2MkJcdTA2NDkiOwogdFsiXHVGQzdCIl0gPSAiXHUwNjJCXHUwNjRBIjsKIHRbIlx1RkM3QyJdID0gIlx1MDY0MVx1MDY0OSI7CiB0WyJcdUZDN0QiXSA9ICJcdTA2NDFcdTA2NEEiOwogdFsiXHVGQzdFIl0gPSAiXHUwNjQyXHUwNjQ5IjsKIHRbIlx1RkM3RiJdID0gIlx1MDY0Mlx1MDY0QSI7CiB0WyJcdUZDODAiXSA9ICJcdTA2NDNcdTA2MjciOwogdFsiXHVGQzgxIl0gPSAiXHUwNjQzXHUwNjQ0IjsKIHRbIlx1RkM4MiJdID0gIlx1MDY0M1x1MDY0NSI7CiB0WyJcdUZDODMiXSA9ICJcdTA2NDNcdTA2NDkiOwogdFsiXHVGQzg0Il0gPSAiXHUwNjQzXHUwNjRBIjsKIHRbIlx1RkM4NSJdID0gIlx1MDY0NFx1MDY0NSI7CiB0WyJcdUZDODYiXSA9ICJcdTA2NDRcdTA2NDkiOwogdFsiXHVGQzg3Il0gPSAiXHUwNjQ0XHUwNjRBIjsKIHRbIlx1RkM4OCJdID0gIlx1MDY0NVx1MDYyNyI7CiB0WyJcdUZDODkiXSA9ICJcdTA2NDVcdTA2NDUiOwogdFsiXHVGQzhBIl0gPSAiXHUwNjQ2XHUwNjMxIjsKIHRbIlx1RkM4QiJdID0gIlx1MDY0Nlx1MDYzMiI7CiB0WyJcdUZDOEMiXSA9ICJcdTA2NDZcdTA2NDUiOwogdFsiXHVGQzhEIl0gPSAiXHUwNjQ2XHUwNjQ2IjsKIHRbIlx1RkM4RSJdID0gIlx1MDY0Nlx1MDY0OSI7CiB0WyJcdUZDOEYiXSA9ICJcdTA2NDZcdTA2NEEiOwogdFsiXHVGQzkwIl0gPSAiXHUwNjQ5XHUwNjcwIjsKIHRbIlx1RkM5MSJdID0gIlx1MDY0QVx1MDYzMSI7CiB0WyJcdUZDOTIiXSA9ICJcdTA2NEFcdTA2MzIiOwogdFsiXHVGQzkzIl0gPSAiXHUwNjRBXHUwNjQ1IjsKIHRbIlx1RkM5NCJdID0gIlx1MDY0QVx1MDY0NiI7CiB0WyJcdUZDOTUiXSA9ICJcdTA2NEFcdTA2NDkiOwogdFsiXHVGQzk2Il0gPSAiXHUwNjRBXHUwNjRBIjsKIHRbIlx1RkM5NyJdID0gIlx1MDYyNlx1MDYyQyI7CiB0WyJcdUZDOTgiXSA9ICJcdTA2MjZcdTA2MkQiOwogdFsiXHVGQzk5Il0gPSAiXHUwNjI2XHUwNjJFIjsKIHRbIlx1RkM5QSJdID0gIlx1MDYyNlx1MDY0NSI7CiB0WyJcdUZDOUIiXSA9ICJcdTA2MjZcdTA2NDciOwogdFsiXHVGQzlDIl0gPSAiXHUwNjI4XHUwNjJDIjsKIHRbIlx1RkM5RCJdID0gIlx1MDYyOFx1MDYyRCI7CiB0WyJcdUZDOUUiXSA9ICJcdTA2MjhcdTA2MkUiOwogdFsiXHVGQzlGIl0gPSAiXHUwNjI4XHUwNjQ1IjsKIHRbIlx1RkNBMCJdID0gIlx1MDYyOFx1MDY0NyI7CiB0WyJcdUZDQTEiXSA9ICJcdTA2MkFcdTA2MkMiOwogdFsiXHVGQ0EyIl0gPSAiXHUwNjJBXHUwNjJEIjsKIHRbIlx1RkNBMyJdID0gIlx1MDYyQVx1MDYyRSI7CiB0WyJcdUZDQTQiXSA9ICJcdTA2MkFcdTA2NDUiOwogdFsiXHVGQ0E1Il0gPSAiXHUwNjJBXHUwNjQ3IjsKIHRbIlx1RkNBNiJdID0gIlx1MDYyQlx1MDY0NSI7CiB0WyJcdUZDQTciXSA9ICJcdTA2MkNcdTA2MkQiOwogdFsiXHVGQ0E4Il0gPSAiXHUwNjJDXHUwNjQ1IjsKIHRbIlx1RkNBOSJdID0gIlx1MDYyRFx1MDYyQyI7CiB0WyJcdUZDQUEiXSA9ICJcdTA2MkRcdTA2NDUiOwogdFsiXHVGQ0FCIl0gPSAiXHUwNjJFXHUwNjJDIjsKIHRbIlx1RkNBQyJdID0gIlx1MDYyRVx1MDY0NSI7CiB0WyJcdUZDQUQiXSA9ICJcdTA2MzNcdTA2MkMiOwogdFsiXHVGQ0FFIl0gPSAiXHUwNjMzXHUwNjJEIjsKIHRbIlx1RkNBRiJdID0gIlx1MDYzM1x1MDYyRSI7CiB0WyJcdUZDQjAiXSA9ICJcdTA2MzNcdTA2NDUiOwogdFsiXHVGQ0IxIl0gPSAiXHUwNjM1XHUwNjJEIjsKIHRbIlx1RkNCMiJdID0gIlx1MDYzNVx1MDYyRSI7CiB0WyJcdUZDQjMiXSA9ICJcdTA2MzVcdTA2NDUiOwogdFsiXHVGQ0I0Il0gPSAiXHUwNjM2XHUwNjJDIjsKIHRbIlx1RkNCNSJdID0gIlx1MDYzNlx1MDYyRCI7CiB0WyJcdUZDQjYiXSA9ICJcdTA2MzZcdTA2MkUiOwogdFsiXHVGQ0I3Il0gPSAiXHUwNjM2XHUwNjQ1IjsKIHRbIlx1RkNCOCJdID0gIlx1MDYzN1x1MDYyRCI7CiB0WyJcdUZDQjkiXSA9ICJcdTA2MzhcdTA2NDUiOwogdFsiXHVGQ0JBIl0gPSAiXHUwNjM5XHUwNjJDIjsKIHRbIlx1RkNCQiJdID0gIlx1MDYzOVx1MDY0NSI7CiB0WyJcdUZDQkMiXSA9ICJcdTA2M0FcdTA2MkMiOwogdFsiXHVGQ0JEIl0gPSAiXHUwNjNBXHUwNjQ1IjsKIHRbIlx1RkNCRSJdID0gIlx1MDY0MVx1MDYyQyI7CiB0WyJcdUZDQkYiXSA9ICJcdTA2NDFcdTA2MkQiOwogdFsiXHVGQ0MwIl0gPSAiXHUwNjQxXHUwNjJFIjsKIHRbIlx1RkNDMSJdID0gIlx1MDY0MVx1MDY0NSI7CiB0WyJcdUZDQzIiXSA9ICJcdTA2NDJcdTA2MkQiOwogdFsiXHVGQ0MzIl0gPSAiXHUwNjQyXHUwNjQ1IjsKIHRbIlx1RkNDNCJdID0gIlx1MDY0M1x1MDYyQyI7CiB0WyJcdUZDQzUiXSA9ICJcdTA2NDNcdTA2MkQiOwogdFsiXHVGQ0M2Il0gPSAiXHUwNjQzXHUwNjJFIjsKIHRbIlx1RkNDNyJdID0gIlx1MDY0M1x1MDY0NCI7CiB0WyJcdUZDQzgiXSA9ICJcdTA2NDNcdTA2NDUiOwogdFsiXHVGQ0M5Il0gPSAiXHUwNjQ0XHUwNjJDIjsKIHRbIlx1RkNDQSJdID0gIlx1MDY0NFx1MDYyRCI7CiB0WyJcdUZDQ0IiXSA9ICJcdTA2NDRcdTA2MkUiOwogdFsiXHVGQ0NDIl0gPSAiXHUwNjQ0XHUwNjQ1IjsKIHRbIlx1RkNDRCJdID0gIlx1MDY0NFx1MDY0NyI7CiB0WyJcdUZDQ0UiXSA9ICJcdTA2NDVcdTA2MkMiOwogdFsiXHVGQ0NGIl0gPSAiXHUwNjQ1XHUwNjJEIjsKIHRbIlx1RkNEMCJdID0gIlx1MDY0NVx1MDYyRSI7CiB0WyJcdUZDRDEiXSA9ICJcdTA2NDVcdTA2NDUiOwogdFsiXHVGQ0QyIl0gPSAiXHUwNjQ2XHUwNjJDIjsKIHRbIlx1RkNEMyJdID0gIlx1MDY0Nlx1MDYyRCI7CiB0WyJcdUZDRDQiXSA9ICJcdTA2NDZcdTA2MkUiOwogdFsiXHVGQ0Q1Il0gPSAiXHUwNjQ2XHUwNjQ1IjsKIHRbIlx1RkNENiJdID0gIlx1MDY0Nlx1MDY0NyI7CiB0WyJcdUZDRDciXSA9ICJcdTA2NDdcdTA2MkMiOwogdFsiXHVGQ0Q4Il0gPSAiXHUwNjQ3XHUwNjQ1IjsKIHRbIlx1RkNEOSJdID0gIlx1MDY0N1x1MDY3MCI7CiB0WyJcdUZDREEiXSA9ICJcdTA2NEFcdTA2MkMiOwogdFsiXHVGQ0RCIl0gPSAiXHUwNjRBXHUwNjJEIjsKIHRbIlx1RkNEQyJdID0gIlx1MDY0QVx1MDYyRSI7CiB0WyJcdUZDREQiXSA9ICJcdTA2NEFcdTA2NDUiOwogdFsiXHVGQ0RFIl0gPSAiXHUwNjRBXHUwNjQ3IjsKIHRbIlx1RkNERiJdID0gIlx1MDYyNlx1MDY0NSI7CiB0WyJcdUZDRTAiXSA9ICJcdTA2MjZcdTA2NDciOwogdFsiXHVGQ0UxIl0gPSAiXHUwNjI4XHUwNjQ1IjsKIHRbIlx1RkNFMiJdID0gIlx1MDYyOFx1MDY0NyI7CiB0WyJcdUZDRTMiXSA9ICJcdTA2MkFcdTA2NDUiOwogdFsiXHVGQ0U0Il0gPSAiXHUwNjJBXHUwNjQ3IjsKIHRbIlx1RkNFNSJdID0gIlx1MDYyQlx1MDY0NSI7CiB0WyJcdUZDRTYiXSA9ICJcdTA2MkJcdTA2NDciOwogdFsiXHVGQ0U3Il0gPSAiXHUwNjMzXHUwNjQ1IjsKIHRbIlx1RkNFOCJdID0gIlx1MDYzM1x1MDY0NyI7CiB0WyJcdUZDRTkiXSA9ICJcdTA2MzRcdTA2NDUiOwogdFsiXHVGQ0VBIl0gPSAiXHUwNjM0XHUwNjQ3IjsKIHRbIlx1RkNFQiJdID0gIlx1MDY0M1x1MDY0NCI7CiB0WyJcdUZDRUMiXSA9ICJcdTA2NDNcdTA2NDUiOwogdFsiXHVGQ0VEIl0gPSAiXHUwNjQ0XHUwNjQ1IjsKIHRbIlx1RkNFRSJdID0gIlx1MDY0Nlx1MDY0NSI7CiB0WyJcdUZDRUYiXSA9ICJcdTA2NDZcdTA2NDciOwogdFsiXHVGQ0YwIl0gPSAiXHUwNjRBXHUwNjQ1IjsKIHRbIlx1RkNGMSJdID0gIlx1MDY0QVx1MDY0NyI7CiB0WyJcdUZDRjIiXSA9ICJcdTA2NDBcdTA2NEVcdTA2NTEiOwogdFsiXHVGQ0YzIl0gPSAiXHUwNjQwXHUwNjRGXHUwNjUxIjsKIHRbIlx1RkNGNCJdID0gIlx1MDY0MFx1MDY1MFx1MDY1MSI7CiB0WyJcdUZDRjUiXSA9ICJcdTA2MzdcdTA2NDkiOwogdFsiXHVGQ0Y2Il0gPSAiXHUwNjM3XHUwNjRBIjsKIHRbIlx1RkNGNyJdID0gIlx1MDYzOVx1MDY0OSI7CiB0WyJcdUZDRjgiXSA9ICJcdTA2MzlcdTA2NEEiOwogdFsiXHVGQ0Y5Il0gPSAiXHUwNjNBXHUwNjQ5IjsKIHRbIlx1RkNGQSJdID0gIlx1MDYzQVx1MDY0QSI7CiB0WyJcdUZDRkIiXSA9ICJcdTA2MzNcdTA2NDkiOwogdFsiXHVGQ0ZDIl0gPSAiXHUwNjMzXHUwNjRBIjsKIHRbIlx1RkNGRCJdID0gIlx1MDYzNFx1MDY0OSI7CiB0WyJcdUZDRkUiXSA9ICJcdTA2MzRcdTA2NEEiOwogdFsiXHVGQ0ZGIl0gPSAiXHUwNjJEXHUwNjQ5IjsKIHRbIlx1RkQwMCJdID0gIlx1MDYyRFx1MDY0QSI7CiB0WyJcdUZEMDEiXSA9ICJcdTA2MkNcdTA2NDkiOwogdFsiXHVGRDAyIl0gPSAiXHUwNjJDXHUwNjRBIjsKIHRbIlx1RkQwMyJdID0gIlx1MDYyRVx1MDY0OSI7CiB0WyJcdUZEMDQiXSA9ICJcdTA2MkVcdTA2NEEiOwogdFsiXHVGRDA1Il0gPSAiXHUwNjM1XHUwNjQ5IjsKIHRbIlx1RkQwNiJdID0gIlx1MDYzNVx1MDY0QSI7CiB0WyJcdUZEMDciXSA9ICJcdTA2MzZcdTA2NDkiOwogdFsiXHVGRDA4Il0gPSAiXHUwNjM2XHUwNjRBIjsKIHRbIlx1RkQwOSJdID0gIlx1MDYzNFx1MDYyQyI7CiB0WyJcdUZEMEEiXSA9ICJcdTA2MzRcdTA2MkQiOwogdFsiXHVGRDBCIl0gPSAiXHUwNjM0XHUwNjJFIjsKIHRbIlx1RkQwQyJdID0gIlx1MDYzNFx1MDY0NSI7CiB0WyJcdUZEMEQiXSA9ICJcdTA2MzRcdTA2MzEiOwogdFsiXHVGRDBFIl0gPSAiXHUwNjMzXHUwNjMxIjsKIHRbIlx1RkQwRiJdID0gIlx1MDYzNVx1MDYzMSI7CiB0WyJcdUZEMTAiXSA9ICJcdTA2MzZcdTA2MzEiOwogdFsiXHVGRDExIl0gPSAiXHUwNjM3XHUwNjQ5IjsKIHRbIlx1RkQxMiJdID0gIlx1MDYzN1x1MDY0QSI7CiB0WyJcdUZEMTMiXSA9ICJcdTA2MzlcdTA2NDkiOwogdFsiXHVGRDE0Il0gPSAiXHUwNjM5XHUwNjRBIjsKIHRbIlx1RkQxNSJdID0gIlx1MDYzQVx1MDY0OSI7CiB0WyJcdUZEMTYiXSA9ICJcdTA2M0FcdTA2NEEiOwogdFsiXHVGRDE3Il0gPSAiXHUwNjMzXHUwNjQ5IjsKIHRbIlx1RkQxOCJdID0gIlx1MDYzM1x1MDY0QSI7CiB0WyJcdUZEMTkiXSA9ICJcdTA2MzRcdTA2NDkiOwogdFsiXHVGRDFBIl0gPSAiXHUwNjM0XHUwNjRBIjsKIHRbIlx1RkQxQiJdID0gIlx1MDYyRFx1MDY0OSI7CiB0WyJcdUZEMUMiXSA9ICJcdTA2MkRcdTA2NEEiOwogdFsiXHVGRDFEIl0gPSAiXHUwNjJDXHUwNjQ5IjsKIHRbIlx1RkQxRSJdID0gIlx1MDYyQ1x1MDY0QSI7CiB0WyJcdUZEMUYiXSA9ICJcdTA2MkVcdTA2NDkiOwogdFsiXHVGRDIwIl0gPSAiXHUwNjJFXHUwNjRBIjsKIHRbIlx1RkQyMSJdID0gIlx1MDYzNVx1MDY0OSI7CiB0WyJcdUZEMjIiXSA9ICJcdTA2MzVcdTA2NEEiOwogdFsiXHVGRDIzIl0gPSAiXHUwNjM2XHUwNjQ5IjsKIHRbIlx1RkQyNCJdID0gIlx1MDYzNlx1MDY0QSI7CiB0WyJcdUZEMjUiXSA9ICJcdTA2MzRcdTA2MkMiOwogdFsiXHVGRDI2Il0gPSAiXHUwNjM0XHUwNjJEIjsKIHRbIlx1RkQyNyJdID0gIlx1MDYzNFx1MDYyRSI7CiB0WyJcdUZEMjgiXSA9ICJcdTA2MzRcdTA2NDUiOwogdFsiXHVGRDI5Il0gPSAiXHUwNjM0XHUwNjMxIjsKIHRbIlx1RkQyQSJdID0gIlx1MDYzM1x1MDYzMSI7CiB0WyJcdUZEMkIiXSA9ICJcdTA2MzVcdTA2MzEiOwogdFsiXHVGRDJDIl0gPSAiXHUwNjM2XHUwNjMxIjsKIHRbIlx1RkQyRCJdID0gIlx1MDYzNFx1MDYyQyI7CiB0WyJcdUZEMkUiXSA9ICJcdTA2MzRcdTA2MkQiOwogdFsiXHVGRDJGIl0gPSAiXHUwNjM0XHUwNjJFIjsKIHRbIlx1RkQzMCJdID0gIlx1MDYzNFx1MDY0NSI7CiB0WyJcdUZEMzEiXSA9ICJcdTA2MzNcdTA2NDciOwogdFsiXHVGRDMyIl0gPSAiXHUwNjM0XHUwNjQ3IjsKIHRbIlx1RkQzMyJdID0gIlx1MDYzN1x1MDY0NSI7CiB0WyJcdUZEMzQiXSA9ICJcdTA2MzNcdTA2MkMiOwogdFsiXHVGRDM1Il0gPSAiXHUwNjMzXHUwNjJEIjsKIHRbIlx1RkQzNiJdID0gIlx1MDYzM1x1MDYyRSI7CiB0WyJcdUZEMzciXSA9ICJcdTA2MzRcdTA2MkMiOwogdFsiXHVGRDM4Il0gPSAiXHUwNjM0XHUwNjJEIjsKIHRbIlx1RkQzOSJdID0gIlx1MDYzNFx1MDYyRSI7CiB0WyJcdUZEM0EiXSA9ICJcdTA2MzdcdTA2NDUiOwogdFsiXHVGRDNCIl0gPSAiXHUwNjM4XHUwNjQ1IjsKIHRbIlx1RkQzQyJdID0gIlx1MDYyN1x1MDY0QiI7CiB0WyJcdUZEM0QiXSA9ICJcdTA2MjdcdTA2NEIiOwogdFsiXHVGRDUwIl0gPSAiXHUwNjJBXHUwNjJDXHUwNjQ1IjsKIHRbIlx1RkQ1MSJdID0gIlx1MDYyQVx1MDYyRFx1MDYyQyI7CiB0WyJcdUZENTIiXSA9ICJcdTA2MkFcdTA2MkRcdTA2MkMiOwogdFsiXHVGRDUzIl0gPSAiXHUwNjJBXHUwNjJEXHUwNjQ1IjsKIHRbIlx1RkQ1NCJdID0gIlx1MDYyQVx1MDYyRVx1MDY0NSI7CiB0WyJcdUZENTUiXSA9ICJcdTA2MkFcdTA2NDVcdTA2MkMiOwogdFsiXHVGRDU2Il0gPSAiXHUwNjJBXHUwNjQ1XHUwNjJEIjsKIHRbIlx1RkQ1NyJdID0gIlx1MDYyQVx1MDY0NVx1MDYyRSI7CiB0WyJcdUZENTgiXSA9ICJcdTA2MkNcdTA2NDVcdTA2MkQiOwogdFsiXHVGRDU5Il0gPSAiXHUwNjJDXHUwNjQ1XHUwNjJEIjsKIHRbIlx1RkQ1QSJdID0gIlx1MDYyRFx1MDY0NVx1MDY0QSI7CiB0WyJcdUZENUIiXSA9ICJcdTA2MkRcdTA2NDVcdTA2NDkiOwogdFsiXHVGRDVDIl0gPSAiXHUwNjMzXHUwNjJEXHUwNjJDIjsKIHRbIlx1RkQ1RCJdID0gIlx1MDYzM1x1MDYyQ1x1MDYyRCI7CiB0WyJcdUZENUUiXSA9ICJcdTA2MzNcdTA2MkNcdTA2NDkiOwogdFsiXHVGRDVGIl0gPSAiXHUwNjMzXHUwNjQ1XHUwNjJEIjsKIHRbIlx1RkQ2MCJdID0gIlx1MDYzM1x1MDY0NVx1MDYyRCI7CiB0WyJcdUZENjEiXSA9ICJcdTA2MzNcdTA2NDVcdTA2MkMiOwogdFsiXHVGRDYyIl0gPSAiXHUwNjMzXHUwNjQ1XHUwNjQ1IjsKIHRbIlx1RkQ2MyJdID0gIlx1MDYzM1x1MDY0NVx1MDY0NSI7CiB0WyJcdUZENjQiXSA9ICJcdTA2MzVcdTA2MkRcdTA2MkQiOwogdFsiXHVGRDY1Il0gPSAiXHUwNjM1XHUwNjJEXHUwNjJEIjsKIHRbIlx1RkQ2NiJdID0gIlx1MDYzNVx1MDY0NVx1MDY0NSI7CiB0WyJcdUZENjciXSA9ICJcdTA2MzRcdTA2MkRcdTA2NDUiOwogdFsiXHVGRDY4Il0gPSAiXHUwNjM0XHUwNjJEXHUwNjQ1IjsKIHRbIlx1RkQ2OSJdID0gIlx1MDYzNFx1MDYyQ1x1MDY0QSI7CiB0WyJcdUZENkEiXSA9ICJcdTA2MzRcdTA2NDVcdTA2MkUiOwogdFsiXHVGRDZCIl0gPSAiXHUwNjM0XHUwNjQ1XHUwNjJFIjsKIHRbIlx1RkQ2QyJdID0gIlx1MDYzNFx1MDY0NVx1MDY0NSI7CiB0WyJcdUZENkQiXSA9ICJcdTA2MzRcdTA2NDVcdTA2NDUiOwogdFsiXHVGRDZFIl0gPSAiXHUwNjM2XHUwNjJEXHUwNjQ5IjsKIHRbIlx1RkQ2RiJdID0gIlx1MDYzNlx1MDYyRVx1MDY0NSI7CiB0WyJcdUZENzAiXSA9ICJcdTA2MzZcdTA2MkVcdTA2NDUiOwogdFsiXHVGRDcxIl0gPSAiXHUwNjM3XHUwNjQ1XHUwNjJEIjsKIHRbIlx1RkQ3MiJdID0gIlx1MDYzN1x1MDY0NVx1MDYyRCI7CiB0WyJcdUZENzMiXSA9ICJcdTA2MzdcdTA2NDVcdTA2NDUiOwogdFsiXHVGRDc0Il0gPSAiXHUwNjM3XHUwNjQ1XHUwNjRBIjsKIHRbIlx1RkQ3NSJdID0gIlx1MDYzOVx1MDYyQ1x1MDY0NSI7CiB0WyJcdUZENzYiXSA9ICJcdTA2MzlcdTA2NDVcdTA2NDUiOwogdFsiXHVGRDc3Il0gPSAiXHUwNjM5XHUwNjQ1XHUwNjQ1IjsKIHRbIlx1RkQ3OCJdID0gIlx1MDYzOVx1MDY0NVx1MDY0OSI7CiB0WyJcdUZENzkiXSA9ICJcdTA2M0FcdTA2NDVcdTA2NDUiOwogdFsiXHVGRDdBIl0gPSAiXHUwNjNBXHUwNjQ1XHUwNjRBIjsKIHRbIlx1RkQ3QiJdID0gIlx1MDYzQVx1MDY0NVx1MDY0OSI7CiB0WyJcdUZEN0MiXSA9ICJcdTA2NDFcdTA2MkVcdTA2NDUiOwogdFsiXHVGRDdEIl0gPSAiXHUwNjQxXHUwNjJFXHUwNjQ1IjsKIHRbIlx1RkQ3RSJdID0gIlx1MDY0Mlx1MDY0NVx1MDYyRCI7CiB0WyJcdUZEN0YiXSA9ICJcdTA2NDJcdTA2NDVcdTA2NDUiOwogdFsiXHVGRDgwIl0gPSAiXHUwNjQ0XHUwNjJEXHUwNjQ1IjsKIHRbIlx1RkQ4MSJdID0gIlx1MDY0NFx1MDYyRFx1MDY0QSI7CiB0WyJcdUZEODIiXSA9ICJcdTA2NDRcdTA2MkRcdTA2NDkiOwogdFsiXHVGRDgzIl0gPSAiXHUwNjQ0XHUwNjJDXHUwNjJDIjsKIHRbIlx1RkQ4NCJdID0gIlx1MDY0NFx1MDYyQ1x1MDYyQyI7CiB0WyJcdUZEODUiXSA9ICJcdTA2NDRcdTA2MkVcdTA2NDUiOwogdFsiXHVGRDg2Il0gPSAiXHUwNjQ0XHUwNjJFXHUwNjQ1IjsKIHRbIlx1RkQ4NyJdID0gIlx1MDY0NFx1MDY0NVx1MDYyRCI7CiB0WyJcdUZEODgiXSA9ICJcdTA2NDRcdTA2NDVcdTA2MkQiOwogdFsiXHVGRDg5Il0gPSAiXHUwNjQ1XHUwNjJEXHUwNjJDIjsKIHRbIlx1RkQ4QSJdID0gIlx1MDY0NVx1MDYyRFx1MDY0NSI7CiB0WyJcdUZEOEIiXSA9ICJcdTA2NDVcdTA2MkRcdTA2NEEiOwogdFsiXHVGRDhDIl0gPSAiXHUwNjQ1XHUwNjJDXHUwNjJEIjsKIHRbIlx1RkQ4RCJdID0gIlx1MDY0NVx1MDYyQ1x1MDY0NSI7CiB0WyJcdUZEOEUiXSA9ICJcdTA2NDVcdTA2MkVcdTA2MkMiOwogdFsiXHVGRDhGIl0gPSAiXHUwNjQ1XHUwNjJFXHUwNjQ1IjsKIHRbIlx1RkQ5MiJdID0gIlx1MDY0NVx1MDYyQ1x1MDYyRSI7CiB0WyJcdUZEOTMiXSA9ICJcdTA2NDdcdTA2NDVcdTA2MkMiOwogdFsiXHVGRDk0Il0gPSAiXHUwNjQ3XHUwNjQ1XHUwNjQ1IjsKIHRbIlx1RkQ5NSJdID0gIlx1MDY0Nlx1MDYyRFx1MDY0NSI7CiB0WyJcdUZEOTYiXSA9ICJcdTA2NDZcdTA2MkRcdTA2NDkiOwogdFsiXHVGRDk3Il0gPSAiXHUwNjQ2XHUwNjJDXHUwNjQ1IjsKIHRbIlx1RkQ5OCJdID0gIlx1MDY0Nlx1MDYyQ1x1MDY0NSI7CiB0WyJcdUZEOTkiXSA9ICJcdTA2NDZcdTA2MkNcdTA2NDkiOwogdFsiXHVGRDlBIl0gPSAiXHUwNjQ2XHUwNjQ1XHUwNjRBIjsKIHRbIlx1RkQ5QiJdID0gIlx1MDY0Nlx1MDY0NVx1MDY0OSI7CiB0WyJcdUZEOUMiXSA9ICJcdTA2NEFcdTA2NDVcdTA2NDUiOwogdFsiXHVGRDlEIl0gPSAiXHUwNjRBXHUwNjQ1XHUwNjQ1IjsKIHRbIlx1RkQ5RSJdID0gIlx1MDYyOFx1MDYyRVx1MDY0QSI7CiB0WyJcdUZEOUYiXSA9ICJcdTA2MkFcdTA2MkNcdTA2NEEiOwogdFsiXHVGREEwIl0gPSAiXHUwNjJBXHUwNjJDXHUwNjQ5IjsKIHRbIlx1RkRBMSJdID0gIlx1MDYyQVx1MDYyRVx1MDY0QSI7CiB0WyJcdUZEQTIiXSA9ICJcdTA2MkFcdTA2MkVcdTA2NDkiOwogdFsiXHVGREEzIl0gPSAiXHUwNjJBXHUwNjQ1XHUwNjRBIjsKIHRbIlx1RkRBNCJdID0gIlx1MDYyQVx1MDY0NVx1MDY0OSI7CiB0WyJcdUZEQTUiXSA9ICJcdTA2MkNcdTA2NDVcdTA2NEEiOwogdFsiXHVGREE2Il0gPSAiXHUwNjJDXHUwNjJEXHUwNjQ5IjsKIHRbIlx1RkRBNyJdID0gIlx1MDYyQ1x1MDY0NVx1MDY0OSI7CiB0WyJcdUZEQTgiXSA9ICJcdTA2MzNcdTA2MkVcdTA2NDkiOwogdFsiXHVGREE5Il0gPSAiXHUwNjM1XHUwNjJEXHUwNjRBIjsKIHRbIlx1RkRBQSJdID0gIlx1MDYzNFx1MDYyRFx1MDY0QSI7CiB0WyJcdUZEQUIiXSA9ICJcdTA2MzZcdTA2MkRcdTA2NEEiOwogdFsiXHVGREFDIl0gPSAiXHUwNjQ0XHUwNjJDXHUwNjRBIjsKIHRbIlx1RkRBRCJdID0gIlx1MDY0NFx1MDY0NVx1MDY0QSI7CiB0WyJcdUZEQUUiXSA9ICJcdTA2NEFcdTA2MkRcdTA2NEEiOwogdFsiXHVGREFGIl0gPSAiXHUwNjRBXHUwNjJDXHUwNjRBIjsKIHRbIlx1RkRCMCJdID0gIlx1MDY0QVx1MDY0NVx1MDY0QSI7CiB0WyJcdUZEQjEiXSA9ICJcdTA2NDVcdTA2NDVcdTA2NEEiOwogdFsiXHVGREIyIl0gPSAiXHUwNjQyXHUwNjQ1XHUwNjRBIjsKIHRbIlx1RkRCMyJdID0gIlx1MDY0Nlx1MDYyRFx1MDY0QSI7CiB0WyJcdUZEQjQiXSA9ICJcdTA2NDJcdTA2NDVcdTA2MkQiOwogdFsiXHVGREI1Il0gPSAiXHUwNjQ0XHUwNjJEXHUwNjQ1IjsKIHRbIlx1RkRCNiJdID0gIlx1MDYzOVx1MDY0NVx1MDY0QSI7CiB0WyJcdUZEQjciXSA9ICJcdTA2NDNcdTA2NDVcdTA2NEEiOwogdFsiXHVGREI4Il0gPSAiXHUwNjQ2XHUwNjJDXHUwNjJEIjsKIHRbIlx1RkRCOSJdID0gIlx1MDY0NVx1MDYyRVx1MDY0QSI7CiB0WyJcdUZEQkEiXSA9ICJcdTA2NDRcdTA2MkNcdTA2NDUiOwogdFsiXHVGREJCIl0gPSAiXHUwNjQzXHUwNjQ1XHUwNjQ1IjsKIHRbIlx1RkRCQyJdID0gIlx1MDY0NFx1MDYyQ1x1MDY0NSI7CiB0WyJcdUZEQkQiXSA9ICJcdTA2NDZcdTA2MkNcdTA2MkQiOwogdFsiXHVGREJFIl0gPSAiXHUwNjJDXHUwNjJEXHUwNjRBIjsKIHRbIlx1RkRCRiJdID0gIlx1MDYyRFx1MDYyQ1x1MDY0QSI7CiB0WyJcdUZEQzAiXSA9ICJcdTA2NDVcdTA2MkNcdTA2NEEiOwogdFsiXHVGREMxIl0gPSAiXHUwNjQxXHUwNjQ1XHUwNjRBIjsKIHRbIlx1RkRDMiJdID0gIlx1MDYyOFx1MDYyRFx1MDY0QSI7CiB0WyJcdUZEQzMiXSA9ICJcdTA2NDNcdTA2NDVcdTA2NDUiOwogdFsiXHVGREM0Il0gPSAiXHUwNjM5XHUwNjJDXHUwNjQ1IjsKIHRbIlx1RkRDNSJdID0gIlx1MDYzNVx1MDY0NVx1MDY0NSI7CiB0WyJcdUZEQzYiXSA9ICJcdTA2MzNcdTA2MkVcdTA2NEEiOwogdFsiXHVGREM3Il0gPSAiXHUwNjQ2XHUwNjJDXHUwNjRBIjsKIHRbIlx1RkU0OSJdID0gIlx1MjAzRSI7CiB0WyJcdUZFNEEiXSA9ICJcdTIwM0UiOwogdFsiXHVGRTRCIl0gPSAiXHUyMDNFIjsKIHRbIlx1RkU0QyJdID0gIlx1MjAzRSI7CiB0WyJcdUZFNEQiXSA9ICJcdTAwNUYiOwogdFsiXHVGRTRFIl0gPSAiXHUwMDVGIjsKIHRbIlx1RkU0RiJdID0gIlx1MDA1RiI7CiB0WyJcdUZFODAiXSA9ICJcdTA2MjEiOwogdFsiXHVGRTgxIl0gPSAiXHUwNjIyIjsKIHRbIlx1RkU4MiJdID0gIlx1MDYyMiI7CiB0WyJcdUZFODMiXSA9ICJcdTA2MjMiOwogdFsiXHVGRTg0Il0gPSAiXHUwNjIzIjsKIHRbIlx1RkU4NSJdID0gIlx1MDYyNCI7CiB0WyJcdUZFODYiXSA9ICJcdTA2MjQiOwogdFsiXHVGRTg3Il0gPSAiXHUwNjI1IjsKIHRbIlx1RkU4OCJdID0gIlx1MDYyNSI7CiB0WyJcdUZFODkiXSA9ICJcdTA2MjYiOwogdFsiXHVGRThBIl0gPSAiXHUwNjI2IjsKIHRbIlx1RkU4QiJdID0gIlx1MDYyNiI7CiB0WyJcdUZFOEMiXSA9ICJcdTA2MjYiOwogdFsiXHVGRThEIl0gPSAiXHUwNjI3IjsKIHRbIlx1RkU4RSJdID0gIlx1MDYyNyI7CiB0WyJcdUZFOEYiXSA9ICJcdTA2MjgiOwogdFsiXHVGRTkwIl0gPSAiXHUwNjI4IjsKIHRbIlx1RkU5MSJdID0gIlx1MDYyOCI7CiB0WyJcdUZFOTIiXSA9ICJcdTA2MjgiOwogdFsiXHVGRTkzIl0gPSAiXHUwNjI5IjsKIHRbIlx1RkU5NCJdID0gIlx1MDYyOSI7CiB0WyJcdUZFOTUiXSA9ICJcdTA2MkEiOwogdFsiXHVGRTk2Il0gPSAiXHUwNjJBIjsKIHRbIlx1RkU5NyJdID0gIlx1MDYyQSI7CiB0WyJcdUZFOTgiXSA9ICJcdTA2MkEiOwogdFsiXHVGRTk5Il0gPSAiXHUwNjJCIjsKIHRbIlx1RkU5QSJdID0gIlx1MDYyQiI7CiB0WyJcdUZFOUIiXSA9ICJcdTA2MkIiOwogdFsiXHVGRTlDIl0gPSAiXHUwNjJCIjsKIHRbIlx1RkU5RCJdID0gIlx1MDYyQyI7CiB0WyJcdUZFOUUiXSA9ICJcdTA2MkMiOwogdFsiXHVGRTlGIl0gPSAiXHUwNjJDIjsKIHRbIlx1RkVBMCJdID0gIlx1MDYyQyI7CiB0WyJcdUZFQTEiXSA9ICJcdTA2MkQiOwogdFsiXHVGRUEyIl0gPSAiXHUwNjJEIjsKIHRbIlx1RkVBMyJdID0gIlx1MDYyRCI7CiB0WyJcdUZFQTQiXSA9ICJcdTA2MkQiOwogdFsiXHVGRUE1Il0gPSAiXHUwNjJFIjsKIHRbIlx1RkVBNiJdID0gIlx1MDYyRSI7CiB0WyJcdUZFQTciXSA9ICJcdTA2MkUiOwogdFsiXHVGRUE4Il0gPSAiXHUwNjJFIjsKIHRbIlx1RkVBOSJdID0gIlx1MDYyRiI7CiB0WyJcdUZFQUEiXSA9ICJcdTA2MkYiOwogdFsiXHVGRUFCIl0gPSAiXHUwNjMwIjsKIHRbIlx1RkVBQyJdID0gIlx1MDYzMCI7CiB0WyJcdUZFQUQiXSA9ICJcdTA2MzEiOwogdFsiXHVGRUFFIl0gPSAiXHUwNjMxIjsKIHRbIlx1RkVBRiJdID0gIlx1MDYzMiI7CiB0WyJcdUZFQjAiXSA9ICJcdTA2MzIiOwogdFsiXHVGRUIxIl0gPSAiXHUwNjMzIjsKIHRbIlx1RkVCMiJdID0gIlx1MDYzMyI7CiB0WyJcdUZFQjMiXSA9ICJcdTA2MzMiOwogdFsiXHVGRUI0Il0gPSAiXHUwNjMzIjsKIHRbIlx1RkVCNSJdID0gIlx1MDYzNCI7CiB0WyJcdUZFQjYiXSA9ICJcdTA2MzQiOwogdFsiXHVGRUI3Il0gPSAiXHUwNjM0IjsKIHRbIlx1RkVCOCJdID0gIlx1MDYzNCI7CiB0WyJcdUZFQjkiXSA9ICJcdTA2MzUiOwogdFsiXHVGRUJBIl0gPSAiXHUwNjM1IjsKIHRbIlx1RkVCQiJdID0gIlx1MDYzNSI7CiB0WyJcdUZFQkMiXSA9ICJcdTA2MzUiOwogdFsiXHVGRUJEIl0gPSAiXHUwNjM2IjsKIHRbIlx1RkVCRSJdID0gIlx1MDYzNiI7CiB0WyJcdUZFQkYiXSA9ICJcdTA2MzYiOwogdFsiXHVGRUMwIl0gPSAiXHUwNjM2IjsKIHRbIlx1RkVDMSJdID0gIlx1MDYzNyI7CiB0WyJcdUZFQzIiXSA9ICJcdTA2MzciOwogdFsiXHVGRUMzIl0gPSAiXHUwNjM3IjsKIHRbIlx1RkVDNCJdID0gIlx1MDYzNyI7CiB0WyJcdUZFQzUiXSA9ICJcdTA2MzgiOwogdFsiXHVGRUM2Il0gPSAiXHUwNjM4IjsKIHRbIlx1RkVDNyJdID0gIlx1MDYzOCI7CiB0WyJcdUZFQzgiXSA9ICJcdTA2MzgiOwogdFsiXHVGRUM5Il0gPSAiXHUwNjM5IjsKIHRbIlx1RkVDQSJdID0gIlx1MDYzOSI7CiB0WyJcdUZFQ0IiXSA9ICJcdTA2MzkiOwogdFsiXHVGRUNDIl0gPSAiXHUwNjM5IjsKIHRbIlx1RkVDRCJdID0gIlx1MDYzQSI7CiB0WyJcdUZFQ0UiXSA9ICJcdTA2M0EiOwogdFsiXHVGRUNGIl0gPSAiXHUwNjNBIjsKIHRbIlx1RkVEMCJdID0gIlx1MDYzQSI7CiB0WyJcdUZFRDEiXSA9ICJcdTA2NDEiOwogdFsiXHVGRUQyIl0gPSAiXHUwNjQxIjsKIHRbIlx1RkVEMyJdID0gIlx1MDY0MSI7CiB0WyJcdUZFRDQiXSA9ICJcdTA2NDEiOwogdFsiXHVGRUQ1Il0gPSAiXHUwNjQyIjsKIHRbIlx1RkVENiJdID0gIlx1MDY0MiI7CiB0WyJcdUZFRDciXSA9ICJcdTA2NDIiOwogdFsiXHVGRUQ4Il0gPSAiXHUwNjQyIjsKIHRbIlx1RkVEOSJdID0gIlx1MDY0MyI7CiB0WyJcdUZFREEiXSA9ICJcdTA2NDMiOwogdFsiXHVGRURCIl0gPSAiXHUwNjQzIjsKIHRbIlx1RkVEQyJdID0gIlx1MDY0MyI7CiB0WyJcdUZFREQiXSA9ICJcdTA2NDQiOwogdFsiXHVGRURFIl0gPSAiXHUwNjQ0IjsKIHRbIlx1RkVERiJdID0gIlx1MDY0NCI7CiB0WyJcdUZFRTAiXSA9ICJcdTA2NDQiOwogdFsiXHVGRUUxIl0gPSAiXHUwNjQ1IjsKIHRbIlx1RkVFMiJdID0gIlx1MDY0NSI7CiB0WyJcdUZFRTMiXSA9ICJcdTA2NDUiOwogdFsiXHVGRUU0Il0gPSAiXHUwNjQ1IjsKIHRbIlx1RkVFNSJdID0gIlx1MDY0NiI7CiB0WyJcdUZFRTYiXSA9ICJcdTA2NDYiOwogdFsiXHVGRUU3Il0gPSAiXHUwNjQ2IjsKIHRbIlx1RkVFOCJdID0gIlx1MDY0NiI7CiB0WyJcdUZFRTkiXSA9ICJcdTA2NDciOwogdFsiXHVGRUVBIl0gPSAiXHUwNjQ3IjsKIHRbIlx1RkVFQiJdID0gIlx1MDY0NyI7CiB0WyJcdUZFRUMiXSA9ICJcdTA2NDciOwogdFsiXHVGRUVEIl0gPSAiXHUwNjQ4IjsKIHRbIlx1RkVFRSJdID0gIlx1MDY0OCI7CiB0WyJcdUZFRUYiXSA9ICJcdTA2NDkiOwogdFsiXHVGRUYwIl0gPSAiXHUwNjQ5IjsKIHRbIlx1RkVGMSJdID0gIlx1MDY0QSI7CiB0WyJcdUZFRjIiXSA9ICJcdTA2NEEiOwogdFsiXHVGRUYzIl0gPSAiXHUwNjRBIjsKIHRbIlx1RkVGNCJdID0gIlx1MDY0QSI7CiB0WyJcdUZFRjUiXSA9ICJcdTA2NDRcdTA2MjIiOwogdFsiXHVGRUY2Il0gPSAiXHUwNjQ0XHUwNjIyIjsKIHRbIlx1RkVGNyJdID0gIlx1MDY0NFx1MDYyMyI7CiB0WyJcdUZFRjgiXSA9ICJcdTA2NDRcdTA2MjMiOwogdFsiXHVGRUY5Il0gPSAiXHUwNjQ0XHUwNjI1IjsKIHRbIlx1RkVGQSJdID0gIlx1MDY0NFx1MDYyNSI7CiB0WyJcdUZFRkIiXSA9ICJcdTA2NDRcdTA2MjciOwogdFsiXHVGRUZDIl0gPSAiXHUwNjQ0XHUwNjI3IjsKfSk7CmZ1bmN0aW9uIHJldmVyc2VJZlJ0bChjaGFycykgewogdmFyIGNoYXJzTGVuZ3RoID0gY2hhcnMubGVuZ3RoOwogaWYgKGNoYXJzTGVuZ3RoIDw9IDEgfHwgIWlzUlRMUmFuZ2VGb3IoY2hhcnMuY2hhckNvZGVBdCgwKSkpIHsKICByZXR1cm4gY2hhcnM7CiB9CiB2YXIgcyA9ICIiOwogZm9yICh2YXIgaWkgPSBjaGFyc0xlbmd0aCAtIDE7IGlpID49IDA7IGlpLS0pIHsKICBzICs9IGNoYXJzW2lpXTsKIH0KIHJldHVybiBzOwp9CmV4cG9ydHMubWFwU3BlY2lhbFVuaWNvZGVWYWx1ZXMgPSBtYXBTcGVjaWFsVW5pY29kZVZhbHVlczsKZXhwb3J0cy5yZXZlcnNlSWZSdGwgPSByZXZlcnNlSWZSdGw7CmV4cG9ydHMuZ2V0VW5pY29kZVJhbmdlRm9yID0gZ2V0VW5pY29kZVJhbmdlRm9yOwpleHBvcnRzLmdldE5vcm1hbGl6ZWRVbmljb2RlcyA9IGdldE5vcm1hbGl6ZWRVbmljb2RlczsKZXhwb3J0cy5nZXRVbmljb2RlRm9yR2x5cGggPSBnZXRVbmljb2RlRm9yR2x5cGg7CgovKioqLyB9KSwKLyogMjI5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuRm9udFJlbmRlcmVyRmFjdG9yeSA9IHZvaWQgMDsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgX2NmZl9wYXJzZXIgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyMyk7Cgp2YXIgX2dseXBobGlzdCA9IF9fd19wZGZqc19yZXF1aXJlX18oMjI2KTsKCnZhciBfZW5jb2RpbmdzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMjUpOwoKdmFyIF9zdHJlYW0gPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwNSk7CgpmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyAiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2YiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mKG9iaik7IH0KCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH0KCmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gIm9iamVjdCIgfHwgdHlwZW9mIGNhbGwgPT09ICJmdW5jdGlvbiIpKSB7IHJldHVybiBjYWxsOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9CgpmdW5jdGlvbiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpIHsgaWYgKHNlbGYgPT09IHZvaWQgMCkgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpOyB9IHJldHVybiBzZWxmOyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChEYXRlLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KCmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0KCmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9Cgp2YXIgRm9udFJlbmRlcmVyRmFjdG9yeSA9IGZ1bmN0aW9uIEZvbnRSZW5kZXJlckZhY3RvcnlDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGdldExvbmcoZGF0YSwgb2Zmc2V0KSB7CiAgICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDI0IHwgZGF0YVtvZmZzZXQgKyAxXSA8PCAxNiB8IGRhdGFbb2Zmc2V0ICsgMl0gPDwgOCB8IGRhdGFbb2Zmc2V0ICsgM107CiAgfQoKICBmdW5jdGlvbiBnZXRVc2hvcnQoZGF0YSwgb2Zmc2V0KSB7CiAgICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDggfCBkYXRhW29mZnNldCArIDFdOwogIH0KCiAgZnVuY3Rpb24gZ2V0U3Vicm91dGluZUJpYXMoc3VicnMpIHsKICAgIHZhciBudW1TdWJycyA9IHN1YnJzLmxlbmd0aDsKICAgIHZhciBiaWFzID0gMzI3Njg7CgogICAgaWYgKG51bVN1YnJzIDwgMTI0MCkgewogICAgICBiaWFzID0gMTA3OwogICAgfSBlbHNlIGlmIChudW1TdWJycyA8IDMzOTAwKSB7CiAgICAgIGJpYXMgPSAxMTMxOwogICAgfQoKICAgIHJldHVybiBiaWFzOwogIH0KCiAgZnVuY3Rpb24gcGFyc2VDbWFwKGRhdGEsIHN0YXJ0LCBlbmQpIHsKICAgIHZhciBvZmZzZXQgPSBnZXRVc2hvcnQoZGF0YSwgc3RhcnQgKyAyKSA9PT0gMSA/IGdldExvbmcoZGF0YSwgc3RhcnQgKyA4KSA6IGdldExvbmcoZGF0YSwgc3RhcnQgKyAxNik7CiAgICB2YXIgZm9ybWF0ID0gZ2V0VXNob3J0KGRhdGEsIHN0YXJ0ICsgb2Zmc2V0KTsKICAgIHZhciByYW5nZXMsIHAsIGk7CgogICAgaWYgKGZvcm1hdCA9PT0gNCkgewogICAgICBnZXRVc2hvcnQoZGF0YSwgc3RhcnQgKyBvZmZzZXQgKyAyKTsKICAgICAgdmFyIHNlZ0NvdW50ID0gZ2V0VXNob3J0KGRhdGEsIHN0YXJ0ICsgb2Zmc2V0ICsgNikgPj4gMTsKICAgICAgcCA9IHN0YXJ0ICsgb2Zmc2V0ICsgMTQ7CiAgICAgIHJhbmdlcyA9IFtdOwoKICAgICAgZm9yIChpID0gMDsgaSA8IHNlZ0NvdW50OyBpKyssIHAgKz0gMikgewogICAgICAgIHJhbmdlc1tpXSA9IHsKICAgICAgICAgIGVuZDogZ2V0VXNob3J0KGRhdGEsIHApCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcCArPSAyOwoKICAgICAgZm9yIChpID0gMDsgaSA8IHNlZ0NvdW50OyBpKyssIHAgKz0gMikgewogICAgICAgIHJhbmdlc1tpXS5zdGFydCA9IGdldFVzaG9ydChkYXRhLCBwKTsKICAgICAgfQoKICAgICAgZm9yIChpID0gMDsgaSA8IHNlZ0NvdW50OyBpKyssIHAgKz0gMikgewogICAgICAgIHJhbmdlc1tpXS5pZERlbHRhID0gZ2V0VXNob3J0KGRhdGEsIHApOwogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgc2VnQ291bnQ7IGkrKywgcCArPSAyKSB7CiAgICAgICAgdmFyIGlkT2Zmc2V0ID0gZ2V0VXNob3J0KGRhdGEsIHApOwoKICAgICAgICBpZiAoaWRPZmZzZXQgPT09IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgcmFuZ2VzW2ldLmlkcyA9IFtdOwoKICAgICAgICBmb3IgKHZhciBqID0gMCwgamogPSByYW5nZXNbaV0uZW5kIC0gcmFuZ2VzW2ldLnN0YXJ0ICsgMTsgaiA8IGpqOyBqKyspIHsKICAgICAgICAgIHJhbmdlc1tpXS5pZHNbal0gPSBnZXRVc2hvcnQoZGF0YSwgcCArIGlkT2Zmc2V0KTsKICAgICAgICAgIGlkT2Zmc2V0ICs9IDI7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmFuZ2VzOwogICAgfSBlbHNlIGlmIChmb3JtYXQgPT09IDEyKSB7CiAgICAgIGdldExvbmcoZGF0YSwgc3RhcnQgKyBvZmZzZXQgKyA0KTsKICAgICAgdmFyIGdyb3VwcyA9IGdldExvbmcoZGF0YSwgc3RhcnQgKyBvZmZzZXQgKyAxMik7CiAgICAgIHAgPSBzdGFydCArIG9mZnNldCArIDE2OwogICAgICByYW5nZXMgPSBbXTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBncm91cHM7IGkrKykgewogICAgICAgIHJhbmdlcy5wdXNoKHsKICAgICAgICAgIHN0YXJ0OiBnZXRMb25nKGRhdGEsIHApLAogICAgICAgICAgZW5kOiBnZXRMb25nKGRhdGEsIHAgKyA0KSwKICAgICAgICAgIGlkRGVsdGE6IGdldExvbmcoZGF0YSwgcCArIDgpIC0gZ2V0TG9uZyhkYXRhLCBwKQogICAgICAgIH0pOwogICAgICAgIHAgKz0gMTI7CiAgICAgIH0KCiAgICAgIHJldHVybiByYW5nZXM7CiAgICB9CgogICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ1bnN1cHBvcnRlZCBjbWFwOiAiLmNvbmNhdChmb3JtYXQpKTsKICB9CgogIGZ1bmN0aW9uIHBhcnNlQ2ZmKGRhdGEsIHN0YXJ0LCBlbmQsIHNlYWNBbmFseXNpc0VuYWJsZWQpIHsKICAgIHZhciBwcm9wZXJ0aWVzID0ge307CiAgICB2YXIgcGFyc2VyID0gbmV3IF9jZmZfcGFyc2VyLkNGRlBhcnNlcihuZXcgX3N0cmVhbS5TdHJlYW0oZGF0YSwgc3RhcnQsIGVuZCAtIHN0YXJ0KSwgcHJvcGVydGllcywgc2VhY0FuYWx5c2lzRW5hYmxlZCk7CiAgICB2YXIgY2ZmID0gcGFyc2VyLnBhcnNlKCk7CiAgICByZXR1cm4gewogICAgICBnbHlwaHM6IGNmZi5jaGFyU3RyaW5ncy5vYmplY3RzLAogICAgICBzdWJyczogY2ZmLnRvcERpY3QucHJpdmF0ZURpY3QgJiYgY2ZmLnRvcERpY3QucHJpdmF0ZURpY3Quc3VicnNJbmRleCAmJiBjZmYudG9wRGljdC5wcml2YXRlRGljdC5zdWJyc0luZGV4Lm9iamVjdHMsCiAgICAgIGdzdWJyczogY2ZmLmdsb2JhbFN1YnJJbmRleCAmJiBjZmYuZ2xvYmFsU3VickluZGV4Lm9iamVjdHMsCiAgICAgIGlzQ0ZGQ0lERm9udDogY2ZmLmlzQ0lERm9udCwKICAgICAgZmRTZWxlY3Q6IGNmZi5mZFNlbGVjdCwKICAgICAgZmRBcnJheTogY2ZmLmZkQXJyYXkKICAgIH07CiAgfQoKICBmdW5jdGlvbiBwYXJzZUdseWZUYWJsZShnbHlmLCBsb2NhLCBpc0dseXBoTG9jYXRpb25zTG9uZykgewogICAgdmFyIGl0ZW1TaXplLCBpdGVtRGVjb2RlOwoKICAgIGlmIChpc0dseXBoTG9jYXRpb25zTG9uZykgewogICAgICBpdGVtU2l6ZSA9IDQ7CgogICAgICBpdGVtRGVjb2RlID0gZnVuY3Rpb24gZm9udEl0ZW1EZWNvZGVMb25nKGRhdGEsIG9mZnNldCkgewogICAgICAgIHJldHVybiBkYXRhW29mZnNldF0gPDwgMjQgfCBkYXRhW29mZnNldCArIDFdIDw8IDE2IHwgZGF0YVtvZmZzZXQgKyAyXSA8PCA4IHwgZGF0YVtvZmZzZXQgKyAzXTsKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIGl0ZW1TaXplID0gMjsKCiAgICAgIGl0ZW1EZWNvZGUgPSBmdW5jdGlvbiBmb250SXRlbURlY29kZShkYXRhLCBvZmZzZXQpIHsKICAgICAgICByZXR1cm4gZGF0YVtvZmZzZXRdIDw8IDkgfCBkYXRhW29mZnNldCArIDFdIDw8IDE7CiAgICAgIH07CiAgICB9CgogICAgdmFyIGdseXBocyA9IFtdOwogICAgdmFyIHN0YXJ0T2Zmc2V0ID0gaXRlbURlY29kZShsb2NhLCAwKTsKCiAgICBmb3IgKHZhciBqID0gaXRlbVNpemU7IGogPCBsb2NhLmxlbmd0aDsgaiArPSBpdGVtU2l6ZSkgewogICAgICB2YXIgZW5kT2Zmc2V0ID0gaXRlbURlY29kZShsb2NhLCBqKTsKICAgICAgZ2x5cGhzLnB1c2goZ2x5Zi5zdWJhcnJheShzdGFydE9mZnNldCwgZW5kT2Zmc2V0KSk7CiAgICAgIHN0YXJ0T2Zmc2V0ID0gZW5kT2Zmc2V0OwogICAgfQoKICAgIHJldHVybiBnbHlwaHM7CiAgfQoKICBmdW5jdGlvbiBsb29rdXBDbWFwKHJhbmdlcywgdW5pY29kZSkgewogICAgdmFyIGNvZGUgPSB1bmljb2RlLmNvZGVQb2ludEF0KDApLAogICAgICAgIGdpZCA9IDA7CiAgICB2YXIgbCA9IDAsCiAgICAgICAgciA9IHJhbmdlcy5sZW5ndGggLSAxOwoKICAgIHdoaWxlIChsIDwgcikgewogICAgICB2YXIgYyA9IGwgKyByICsgMSA+PiAxOwoKICAgICAgaWYgKGNvZGUgPCByYW5nZXNbY10uc3RhcnQpIHsKICAgICAgICByID0gYyAtIDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbCA9IGM7CiAgICAgIH0KICAgIH0KCiAgICBpZiAocmFuZ2VzW2xdLnN0YXJ0IDw9IGNvZGUgJiYgY29kZSA8PSByYW5nZXNbbF0uZW5kKSB7CiAgICAgIGdpZCA9IHJhbmdlc1tsXS5pZERlbHRhICsgKHJhbmdlc1tsXS5pZHMgPyByYW5nZXNbbF0uaWRzW2NvZGUgLSByYW5nZXNbbF0uc3RhcnRdIDogY29kZSkgJiAweGZmZmY7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgY2hhckNvZGU6IGNvZGUsCiAgICAgIGdseXBoSWQ6IGdpZAogICAgfTsKICB9CgogIGZ1bmN0aW9uIGNvbXBpbGVHbHlmKGNvZGUsIGNtZHMsIGZvbnQpIHsKICAgIGZ1bmN0aW9uIG1vdmVUbyh4LCB5KSB7CiAgICAgIGNtZHMucHVzaCh7CiAgICAgICAgY21kOiAibW92ZVRvIiwKICAgICAgICBhcmdzOiBbeCwgeV0KICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gbGluZVRvKHgsIHkpIHsKICAgICAgY21kcy5wdXNoKHsKICAgICAgICBjbWQ6ICJsaW5lVG8iLAogICAgICAgIGFyZ3M6IFt4LCB5XQogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBxdWFkcmF0aWNDdXJ2ZVRvKHhhLCB5YSwgeCwgeSkgewogICAgICBjbWRzLnB1c2goewogICAgICAgIGNtZDogInF1YWRyYXRpY0N1cnZlVG8iLAogICAgICAgIGFyZ3M6IFt4YSwgeWEsIHgsIHldCiAgICAgIH0pOwogICAgfQoKICAgIHZhciBpID0gMDsKICAgIHZhciBudW1iZXJPZkNvbnRvdXJzID0gKGNvZGVbaV0gPDwgMjQgfCBjb2RlW2kgKyAxXSA8PCAxNikgPj4gMTY7CiAgICB2YXIgZmxhZ3M7CiAgICB2YXIgeCA9IDAsCiAgICAgICAgeSA9IDA7CiAgICBpICs9IDEwOwoKICAgIGlmIChudW1iZXJPZkNvbnRvdXJzIDwgMCkgewogICAgICBkbyB7CiAgICAgICAgZmxhZ3MgPSBjb2RlW2ldIDw8IDggfCBjb2RlW2kgKyAxXTsKICAgICAgICB2YXIgZ2x5cGhJbmRleCA9IGNvZGVbaSArIDJdIDw8IDggfCBjb2RlW2kgKyAzXTsKICAgICAgICBpICs9IDQ7CiAgICAgICAgdmFyIGFyZzEsIGFyZzI7CgogICAgICAgIGlmIChmbGFncyAmIDB4MDEpIHsKICAgICAgICAgIGFyZzEgPSAoY29kZVtpXSA8PCAyNCB8IGNvZGVbaSArIDFdIDw8IDE2KSA+PiAxNjsKICAgICAgICAgIGFyZzIgPSAoY29kZVtpICsgMl0gPDwgMjQgfCBjb2RlW2kgKyAzXSA8PCAxNikgPj4gMTY7CiAgICAgICAgICBpICs9IDQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFyZzEgPSBjb2RlW2krK107CiAgICAgICAgICBhcmcyID0gY29kZVtpKytdOwogICAgICAgIH0KCiAgICAgICAgaWYgKGZsYWdzICYgMHgwMikgewogICAgICAgICAgeCA9IGFyZzE7CiAgICAgICAgICB5ID0gYXJnMjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgeCA9IDA7CiAgICAgICAgICB5ID0gMDsKICAgICAgICB9CgogICAgICAgIHZhciBzY2FsZVggPSAxLAogICAgICAgICAgICBzY2FsZVkgPSAxLAogICAgICAgICAgICBzY2FsZTAxID0gMCwKICAgICAgICAgICAgc2NhbGUxMCA9IDA7CgogICAgICAgIGlmIChmbGFncyAmIDB4MDgpIHsKICAgICAgICAgIHNjYWxlWCA9IHNjYWxlWSA9IChjb2RlW2ldIDw8IDI0IHwgY29kZVtpICsgMV0gPDwgMTYpIC8gMTA3Mzc0MTgyNDsKICAgICAgICAgIGkgKz0gMjsKICAgICAgICB9IGVsc2UgaWYgKGZsYWdzICYgMHg0MCkgewogICAgICAgICAgc2NhbGVYID0gKGNvZGVbaV0gPDwgMjQgfCBjb2RlW2kgKyAxXSA8PCAxNikgLyAxMDczNzQxODI0OwogICAgICAgICAgc2NhbGVZID0gKGNvZGVbaSArIDJdIDw8IDI0IHwgY29kZVtpICsgM10gPDwgMTYpIC8gMTA3Mzc0MTgyNDsKICAgICAgICAgIGkgKz0gNDsKICAgICAgICB9IGVsc2UgaWYgKGZsYWdzICYgMHg4MCkgewogICAgICAgICAgc2NhbGVYID0gKGNvZGVbaV0gPDwgMjQgfCBjb2RlW2kgKyAxXSA8PCAxNikgLyAxMDczNzQxODI0OwogICAgICAgICAgc2NhbGUwMSA9IChjb2RlW2kgKyAyXSA8PCAyNCB8IGNvZGVbaSArIDNdIDw8IDE2KSAvIDEwNzM3NDE4MjQ7CiAgICAgICAgICBzY2FsZTEwID0gKGNvZGVbaSArIDRdIDw8IDI0IHwgY29kZVtpICsgNV0gPDwgMTYpIC8gMTA3Mzc0MTgyNDsKICAgICAgICAgIHNjYWxlWSA9IChjb2RlW2kgKyA2XSA8PCAyNCB8IGNvZGVbaSArIDddIDw8IDE2KSAvIDEwNzM3NDE4MjQ7CiAgICAgICAgICBpICs9IDg7CiAgICAgICAgfQoKICAgICAgICB2YXIgc3ViZ2x5cGggPSBmb250LmdseXBoc1tnbHlwaEluZGV4XTsKCiAgICAgICAgaWYgKHN1YmdseXBoKSB7CiAgICAgICAgICBjbWRzLnB1c2goewogICAgICAgICAgICBjbWQ6ICJzYXZlIgogICAgICAgICAgfSk7CiAgICAgICAgICBjbWRzLnB1c2goewogICAgICAgICAgICBjbWQ6ICJ0cmFuc2Zvcm0iLAogICAgICAgICAgICBhcmdzOiBbc2NhbGVYLCBzY2FsZTAxLCBzY2FsZTEwLCBzY2FsZVksIHgsIHldCiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbXBpbGVHbHlmKHN1YmdseXBoLCBjbWRzLCBmb250KTsKICAgICAgICAgIGNtZHMucHVzaCh7CiAgICAgICAgICAgIGNtZDogInJlc3RvcmUiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gd2hpbGUgKGZsYWdzICYgMHgyMCk7CiAgICB9IGVsc2UgewogICAgICB2YXIgZW5kUHRzT2ZDb250b3VycyA9IFtdOwogICAgICB2YXIgaiwgamo7CgogICAgICBmb3IgKGogPSAwOyBqIDwgbnVtYmVyT2ZDb250b3VyczsgaisrKSB7CiAgICAgICAgZW5kUHRzT2ZDb250b3Vycy5wdXNoKGNvZGVbaV0gPDwgOCB8IGNvZGVbaSArIDFdKTsKICAgICAgICBpICs9IDI7CiAgICAgIH0KCiAgICAgIHZhciBpbnN0cnVjdGlvbkxlbmd0aCA9IGNvZGVbaV0gPDwgOCB8IGNvZGVbaSArIDFdOwogICAgICBpICs9IDIgKyBpbnN0cnVjdGlvbkxlbmd0aDsKICAgICAgdmFyIG51bWJlck9mUG9pbnRzID0gZW5kUHRzT2ZDb250b3Vyc1tlbmRQdHNPZkNvbnRvdXJzLmxlbmd0aCAtIDFdICsgMTsKICAgICAgdmFyIHBvaW50cyA9IFtdOwoKICAgICAgd2hpbGUgKHBvaW50cy5sZW5ndGggPCBudW1iZXJPZlBvaW50cykgewogICAgICAgIGZsYWdzID0gY29kZVtpKytdOwogICAgICAgIHZhciByZXBlYXQgPSAxOwoKICAgICAgICBpZiAoZmxhZ3MgJiAweDA4KSB7CiAgICAgICAgICByZXBlYXQgKz0gY29kZVtpKytdOwogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHJlcGVhdC0tID4gMCkgewogICAgICAgICAgcG9pbnRzLnB1c2goewogICAgICAgICAgICBmbGFnczogZmxhZ3MKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yIChqID0gMDsgaiA8IG51bWJlck9mUG9pbnRzOyBqKyspIHsKICAgICAgICBzd2l0Y2ggKHBvaW50c1tqXS5mbGFncyAmIDB4MTIpIHsKICAgICAgICAgIGNhc2UgMHgwMDoKICAgICAgICAgICAgeCArPSAoY29kZVtpXSA8PCAyNCB8IGNvZGVbaSArIDFdIDw8IDE2KSA+PiAxNjsKICAgICAgICAgICAgaSArPSAyOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4MDI6CiAgICAgICAgICAgIHggLT0gY29kZVtpKytdOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4MTI6CiAgICAgICAgICAgIHggKz0gY29kZVtpKytdOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHBvaW50c1tqXS54ID0geDsKICAgICAgfQoKICAgICAgZm9yIChqID0gMDsgaiA8IG51bWJlck9mUG9pbnRzOyBqKyspIHsKICAgICAgICBzd2l0Y2ggKHBvaW50c1tqXS5mbGFncyAmIDB4MjQpIHsKICAgICAgICAgIGNhc2UgMHgwMDoKICAgICAgICAgICAgeSArPSAoY29kZVtpXSA8PCAyNCB8IGNvZGVbaSArIDFdIDw8IDE2KSA+PiAxNjsKICAgICAgICAgICAgaSArPSAyOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4MDQ6CiAgICAgICAgICAgIHkgLT0gY29kZVtpKytdOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDB4MjQ6CiAgICAgICAgICAgIHkgKz0gY29kZVtpKytdOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHBvaW50c1tqXS55ID0geTsKICAgICAgfQoKICAgICAgdmFyIHN0YXJ0UG9pbnQgPSAwOwoKICAgICAgZm9yIChpID0gMDsgaSA8IG51bWJlck9mQ29udG91cnM7IGkrKykgewogICAgICAgIHZhciBlbmRQb2ludCA9IGVuZFB0c09mQ29udG91cnNbaV07CiAgICAgICAgdmFyIGNvbnRvdXIgPSBwb2ludHMuc2xpY2Uoc3RhcnRQb2ludCwgZW5kUG9pbnQgKyAxKTsKCiAgICAgICAgaWYgKGNvbnRvdXJbMF0uZmxhZ3MgJiAxKSB7CiAgICAgICAgICBjb250b3VyLnB1c2goY29udG91clswXSk7CiAgICAgICAgfSBlbHNlIGlmIChjb250b3VyW2NvbnRvdXIubGVuZ3RoIC0gMV0uZmxhZ3MgJiAxKSB7CiAgICAgICAgICBjb250b3VyLnVuc2hpZnQoY29udG91cltjb250b3VyLmxlbmd0aCAtIDFdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHAgPSB7CiAgICAgICAgICAgIGZsYWdzOiAxLAogICAgICAgICAgICB4OiAoY29udG91clswXS54ICsgY29udG91cltjb250b3VyLmxlbmd0aCAtIDFdLngpIC8gMiwKICAgICAgICAgICAgeTogKGNvbnRvdXJbMF0ueSArIGNvbnRvdXJbY29udG91ci5sZW5ndGggLSAxXS55KSAvIDIKICAgICAgICAgIH07CiAgICAgICAgICBjb250b3VyLnVuc2hpZnQocCk7CiAgICAgICAgICBjb250b3VyLnB1c2gocCk7CiAgICAgICAgfQoKICAgICAgICBtb3ZlVG8oY29udG91clswXS54LCBjb250b3VyWzBdLnkpOwoKICAgICAgICBmb3IgKGogPSAxLCBqaiA9IGNvbnRvdXIubGVuZ3RoOyBqIDwgamo7IGorKykgewogICAgICAgICAgaWYgKGNvbnRvdXJbal0uZmxhZ3MgJiAxKSB7CiAgICAgICAgICAgIGxpbmVUbyhjb250b3VyW2pdLngsIGNvbnRvdXJbal0ueSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRvdXJbaiArIDFdLmZsYWdzICYgMSkgewogICAgICAgICAgICBxdWFkcmF0aWNDdXJ2ZVRvKGNvbnRvdXJbal0ueCwgY29udG91cltqXS55LCBjb250b3VyW2ogKyAxXS54LCBjb250b3VyW2ogKyAxXS55KTsKICAgICAgICAgICAgaisrOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcXVhZHJhdGljQ3VydmVUbyhjb250b3VyW2pdLngsIGNvbnRvdXJbal0ueSwgKGNvbnRvdXJbal0ueCArIGNvbnRvdXJbaiArIDFdLngpIC8gMiwgKGNvbnRvdXJbal0ueSArIGNvbnRvdXJbaiArIDFdLnkpIC8gMik7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzdGFydFBvaW50ID0gZW5kUG9pbnQgKyAxOwogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBjb21waWxlQ2hhclN0cmluZyhjaGFyU3RyaW5nQ29kZSwgY21kcywgZm9udCwgZ2x5cGhJZCkgewogICAgZnVuY3Rpb24gbW92ZVRvKHgsIHkpIHsKICAgICAgY21kcy5wdXNoKHsKICAgICAgICBjbWQ6ICJtb3ZlVG8iLAogICAgICAgIGFyZ3M6IFt4LCB5XQogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBsaW5lVG8oeCwgeSkgewogICAgICBjbWRzLnB1c2goewogICAgICAgIGNtZDogImxpbmVUbyIsCiAgICAgICAgYXJnczogW3gsIHldCiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGJlemllckN1cnZlVG8oeDEsIHkxLCB4MiwgeTIsIHgsIHkpIHsKICAgICAgY21kcy5wdXNoKHsKICAgICAgICBjbWQ6ICJiZXppZXJDdXJ2ZVRvIiwKICAgICAgICBhcmdzOiBbeDEsIHkxLCB4MiwgeTIsIHgsIHldCiAgICAgIH0pOwogICAgfQoKICAgIHZhciBzdGFjayA9IFtdOwogICAgdmFyIHggPSAwLAogICAgICAgIHkgPSAwOwogICAgdmFyIHN0ZW1zID0gMDsKCiAgICBmdW5jdGlvbiBwYXJzZShjb2RlKSB7CiAgICAgIHZhciBpID0gMDsKCiAgICAgIHdoaWxlIChpIDwgY29kZS5sZW5ndGgpIHsKICAgICAgICB2YXIgc3RhY2tDbGVhbiA9IGZhbHNlOwogICAgICAgIHZhciB2ID0gY29kZVtpKytdOwogICAgICAgIHZhciB4YSwgeGIsIHlhLCB5YiwgeTEsIHkyLCB5Mywgbiwgc3VickNvZGU7CgogICAgICAgIHN3aXRjaCAodikgewogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBzdGVtcyArPSBzdGFjay5sZW5ndGggPj4gMTsKICAgICAgICAgICAgc3RhY2tDbGVhbiA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgc3RlbXMgKz0gc3RhY2subGVuZ3RoID4+IDE7CiAgICAgICAgICAgIHN0YWNrQ2xlYW4gPSB0cnVlOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHkgKz0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIG1vdmVUbyh4LCB5KTsKICAgICAgICAgICAgc3RhY2tDbGVhbiA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICB4ICs9IHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeSArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIGxpbmVUbyh4LCB5KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIHggKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICBsaW5lVG8oeCwgeSk7CgogICAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgeSArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIGxpbmVUbyh4LCB5KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIHkgKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICBsaW5lVG8oeCwgeSk7CgogICAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIGxpbmVUbyh4LCB5KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIG4gPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3VickNvZGUgPSBudWxsOwoKICAgICAgICAgICAgaWYgKGZvbnQuaXNDRkZDSURGb250KSB7CiAgICAgICAgICAgICAgdmFyIGZkSW5kZXggPSBmb250LmZkU2VsZWN0LmdldEZESW5kZXgoZ2x5cGhJZCk7CgogICAgICAgICAgICAgIGlmIChmZEluZGV4ID49IDAgJiYgZmRJbmRleCA8IGZvbnQuZmRBcnJheS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHZhciBmb250RGljdCA9IGZvbnQuZmRBcnJheVtmZEluZGV4XTsKICAgICAgICAgICAgICAgIHZhciBzdWJycyA9IHZvaWQgMDsKCiAgICAgICAgICAgICAgICBpZiAoZm9udERpY3QucHJpdmF0ZURpY3QgJiYgZm9udERpY3QucHJpdmF0ZURpY3Quc3VicnNJbmRleCkgewogICAgICAgICAgICAgICAgICBzdWJycyA9IGZvbnREaWN0LnByaXZhdGVEaWN0LnN1YnJzSW5kZXgub2JqZWN0czsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoc3VicnMpIHsKICAgICAgICAgICAgICAgICAgbiArPSBnZXRTdWJyb3V0aW5lQmlhcyhzdWJycyk7CiAgICAgICAgICAgICAgICAgIHN1YnJDb2RlID0gc3VicnNbbl07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSW52YWxpZCBmZCBpbmRleCBmb3IgZ2x5cGggaW5kZXguIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN1YnJDb2RlID0gZm9udC5zdWJyc1tuICsgZm9udC5zdWJyc0JpYXNdOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc3VickNvZGUpIHsKICAgICAgICAgICAgICBwYXJzZShzdWJyQ29kZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICB2ID0gY29kZVtpKytdOwoKICAgICAgICAgICAgc3dpdGNoICh2KSB7CiAgICAgICAgICAgICAgY2FzZSAzNDoKICAgICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHkxID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeSwgeGIsIHkxLCB4LCB5MSk7CiAgICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeTEsIHhiLCB5LCB4LCB5KTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDM1OgogICAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHlhID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB5ID0geWIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHkxID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHkyID0geTEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHkxLCB4YiwgeTIsIHgsIHkyKTsKICAgICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHkzID0geTIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHkyLCB4YiwgeTMsIHgsIHkpOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMzc6CiAgICAgICAgICAgICAgICB2YXIgeDAgPSB4LAogICAgICAgICAgICAgICAgICAgIHkwID0geTsKICAgICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB5ID0geWIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB4ID0geGI7CiAgICAgICAgICAgICAgICB5ID0geWI7CgogICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHggLSB4MCkgPiBNYXRoLmFicyh5IC0geTApKSB7CiAgICAgICAgICAgICAgICAgIHggKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHkgKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJ1bmtub3duIG9wZXJhdG9yOiAxMiAiLmNvbmNhdCh2KSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPj0gNCkgewogICAgICAgICAgICAgIHZhciBhY2hhciA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIHZhciBiY2hhciA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIHkgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgICB4ID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgY21kcy5wdXNoKHsKICAgICAgICAgICAgICAgIGNtZDogInNhdmUiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgY21kcy5wdXNoKHsKICAgICAgICAgICAgICAgIGNtZDogInRyYW5zbGF0ZSIsCiAgICAgICAgICAgICAgICBhcmdzOiBbeCwgeV0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB2YXIgY21hcCA9IGxvb2t1cENtYXAoZm9udC5jbWFwLCBTdHJpbmcuZnJvbUNoYXJDb2RlKGZvbnQuZ2x5cGhOYW1lTWFwW19lbmNvZGluZ3MuU3RhbmRhcmRFbmNvZGluZ1thY2hhcl1dKSk7CiAgICAgICAgICAgICAgY29tcGlsZUNoYXJTdHJpbmcoZm9udC5nbHlwaHNbY21hcC5nbHlwaElkXSwgY21kcywgZm9udCwgY21hcC5nbHlwaElkKTsKICAgICAgICAgICAgICBjbWRzLnB1c2goewogICAgICAgICAgICAgICAgY21kOiAicmVzdG9yZSIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBjbWFwID0gbG9va3VwQ21hcChmb250LmNtYXAsIFN0cmluZy5mcm9tQ2hhckNvZGUoZm9udC5nbHlwaE5hbWVNYXBbX2VuY29kaW5ncy5TdGFuZGFyZEVuY29kaW5nW2JjaGFyXV0pKTsKICAgICAgICAgICAgICBjb21waWxlQ2hhclN0cmluZyhmb250LmdseXBoc1tjbWFwLmdseXBoSWRdLCBjbWRzLCBmb250LCBjbWFwLmdseXBoSWQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgc3RlbXMgKz0gc3RhY2subGVuZ3RoID4+IDE7CiAgICAgICAgICAgIHN0YWNrQ2xlYW4gPSB0cnVlOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICBzdGVtcyArPSBzdGFjay5sZW5ndGggPj4gMTsKICAgICAgICAgICAgaSArPSBzdGVtcyArIDcgPj4gMzsKICAgICAgICAgICAgc3RhY2tDbGVhbiA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgIHN0ZW1zICs9IHN0YWNrLmxlbmd0aCA+PiAxOwogICAgICAgICAgICBpICs9IHN0ZW1zICsgNyA+PiAzOwogICAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgeSArPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgeCArPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgbW92ZVRvKHgsIHkpOwogICAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgeCArPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgbW92ZVRvKHgsIHkpOwogICAgICAgICAgICBzdGFja0NsZWFuID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgc3RlbXMgKz0gc3RhY2subGVuZ3RoID4+IDE7CiAgICAgICAgICAgIHN0YWNrQ2xlYW4gPSB0cnVlOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMikgewogICAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeWEgPSB5ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkgPSB5YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHggKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeSArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICBsaW5lVG8oeCwgeSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiA2KSB7CiAgICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkgKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICBsaW5lVG8oeCwgeSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHhhID0geCArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHlhID0geSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeCA9IHhiICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggJSAyKSB7CiAgICAgICAgICAgICAgeCArPSBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIHhhID0geDsKICAgICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YjsKICAgICAgICAgICAgICB5ID0geWIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoICUgMikgewogICAgICAgICAgICAgIHkgKz0gc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHlhID0geTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHkgPSB5YjsKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgc3RhY2sucHVzaCgoY29kZVtpXSA8PCAyNCB8IGNvZGVbaSArIDFdIDw8IDE2KSA+PiAxNik7CiAgICAgICAgICAgIGkgKz0gMjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgbiA9IHN0YWNrLnBvcCgpICsgZm9udC5nc3VicnNCaWFzOwogICAgICAgICAgICBzdWJyQ29kZSA9IGZvbnQuZ3N1YnJzW25dOwoKICAgICAgICAgICAgaWYgKHN1YnJDb2RlKSB7CiAgICAgICAgICAgICAgcGFyc2Uoc3VickNvZGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIHhhID0geDsKICAgICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeSA9IHliICsgKHN0YWNrLmxlbmd0aCA9PT0gMSA/IHN0YWNrLnNoaWZ0KCkgOiAwKTsKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKCiAgICAgICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB4YSA9IHggKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHlhID0geTsKICAgICAgICAgICAgICB4YiA9IHhhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YiA9IHlhICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5ID0geWIgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YiArIChzdGFjay5sZW5ndGggPT09IDEgPyBzdGFjay5zaGlmdCgpIDogMCk7CiAgICAgICAgICAgICAgYmV6aWVyQ3VydmVUbyh4YSwgeWEsIHhiLCB5YiwgeCwgeSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgIHdoaWxlIChzdGFjay5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgeGEgPSB4ICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB5YSA9IHk7CiAgICAgICAgICAgICAgeGIgPSB4YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeWIgPSB5YSArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeSA9IHliICsgc3RhY2suc2hpZnQoKTsKICAgICAgICAgICAgICB4ID0geGIgKyAoc3RhY2subGVuZ3RoID09PSAxID8gc3RhY2suc2hpZnQoKSA6IDApOwogICAgICAgICAgICAgIGJlemllckN1cnZlVG8oeGEsIHlhLCB4YiwgeWIsIHgsIHkpOwoKICAgICAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHhhID0geDsKICAgICAgICAgICAgICB5YSA9IHkgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHhiID0geGEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHliID0geWEgKyBzdGFjay5zaGlmdCgpOwogICAgICAgICAgICAgIHggPSB4YiArIHN0YWNrLnNoaWZ0KCk7CiAgICAgICAgICAgICAgeSA9IHliICsgKHN0YWNrLmxlbmd0aCA9PT0gMSA/IHN0YWNrLnNoaWZ0KCkgOiAwKTsKICAgICAgICAgICAgICBiZXppZXJDdXJ2ZVRvKHhhLCB5YSwgeGIsIHliLCB4LCB5KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgaWYgKHYgPCAzMikgewogICAgICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigidW5rbm93biBvcGVyYXRvcjogIi5jb25jYXQodikpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodiA8IDI0NykgewogICAgICAgICAgICAgIHN0YWNrLnB1c2godiAtIDEzOSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodiA8IDI1MSkgewogICAgICAgICAgICAgIHN0YWNrLnB1c2goKHYgLSAyNDcpICogMjU2ICsgY29kZVtpKytdICsgMTA4KTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2IDwgMjU1KSB7CiAgICAgICAgICAgICAgc3RhY2sucHVzaCgtKHYgLSAyNTEpICogMjU2IC0gY29kZVtpKytdIC0gMTA4KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzdGFjay5wdXNoKChjb2RlW2ldIDw8IDI0IHwgY29kZVtpICsgMV0gPDwgMTYgfCBjb2RlW2kgKyAyXSA8PCA4IHwgY29kZVtpICsgM10pIC8gNjU1MzYpOwogICAgICAgICAgICAgIGkgKz0gNDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhY2tDbGVhbikgewogICAgICAgICAgc3RhY2subGVuZ3RoID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBwYXJzZShjaGFyU3RyaW5nQ29kZSk7CiAgfQoKICB2YXIgTk9PUCA9IFtdOwoKICB2YXIgQ29tcGlsZWRGb250ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIENvbXBpbGVkRm9udChmb250TWF0cml4KSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb21waWxlZEZvbnQpOwoKICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IENvbXBpbGVkRm9udCkgewogICAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNhbm5vdCBpbml0aWFsaXplIENvbXBpbGVkRm9udC4iKTsKICAgICAgfQoKICAgICAgdGhpcy5mb250TWF0cml4ID0gZm9udE1hdHJpeDsKICAgICAgdGhpcy5jb21waWxlZEdseXBocyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgIHRoaXMuY29tcGlsZWRDaGFyQ29kZVRvR2x5cGhJZCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKENvbXBpbGVkRm9udCwgW3sKICAgICAga2V5OiAiZ2V0UGF0aEpzIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBhdGhKcyh1bmljb2RlKSB7CiAgICAgICAgdmFyIGNtYXAgPSBsb29rdXBDbWFwKHRoaXMuY21hcCwgdW5pY29kZSk7CiAgICAgICAgdmFyIGZuID0gdGhpcy5jb21waWxlZEdseXBoc1tjbWFwLmdseXBoSWRdOwoKICAgICAgICBpZiAoIWZuKSB7CiAgICAgICAgICBmbiA9IHRoaXMuY29tcGlsZUdseXBoKHRoaXMuZ2x5cGhzW2NtYXAuZ2x5cGhJZF0sIGNtYXAuZ2x5cGhJZCk7CiAgICAgICAgICB0aGlzLmNvbXBpbGVkR2x5cGhzW2NtYXAuZ2x5cGhJZF0gPSBmbjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmNvbXBpbGVkQ2hhckNvZGVUb0dseXBoSWRbY21hcC5jaGFyQ29kZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy5jb21waWxlZENoYXJDb2RlVG9HbHlwaElkW2NtYXAuY2hhckNvZGVdID0gY21hcC5nbHlwaElkOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZuOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNvbXBpbGVHbHlwaCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21waWxlR2x5cGgoY29kZSwgZ2x5cGhJZCkgewogICAgICAgIGlmICghY29kZSB8fCBjb2RlLmxlbmd0aCA9PT0gMCB8fCBjb2RlWzBdID09PSAxNCkgewogICAgICAgICAgcmV0dXJuIE5PT1A7CiAgICAgICAgfQoKICAgICAgICB2YXIgZm9udE1hdHJpeCA9IHRoaXMuZm9udE1hdHJpeDsKCiAgICAgICAgaWYgKHRoaXMuaXNDRkZDSURGb250KSB7CiAgICAgICAgICB2YXIgZmRJbmRleCA9IHRoaXMuZmRTZWxlY3QuZ2V0RkRJbmRleChnbHlwaElkKTsKCiAgICAgICAgICBpZiAoZmRJbmRleCA+PSAwICYmIGZkSW5kZXggPCB0aGlzLmZkQXJyYXkubGVuZ3RoKSB7CiAgICAgICAgICAgIHZhciBmb250RGljdCA9IHRoaXMuZmRBcnJheVtmZEluZGV4XTsKICAgICAgICAgICAgZm9udE1hdHJpeCA9IGZvbnREaWN0LmdldEJ5TmFtZSgiRm9udE1hdHJpeCIpIHx8IF91dGlsLkZPTlRfSURFTlRJVFlfTUFUUklYOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgKDAsIF91dGlsLndhcm4pKCJJbnZhbGlkIGZkIGluZGV4IGZvciBnbHlwaCBpbmRleC4iKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhciBjbWRzID0gW107CiAgICAgICAgY21kcy5wdXNoKHsKICAgICAgICAgIGNtZDogInNhdmUiCiAgICAgICAgfSk7CiAgICAgICAgY21kcy5wdXNoKHsKICAgICAgICAgIGNtZDogInRyYW5zZm9ybSIsCiAgICAgICAgICBhcmdzOiBmb250TWF0cml4LnNsaWNlKCkKICAgICAgICB9KTsKICAgICAgICBjbWRzLnB1c2goewogICAgICAgICAgY21kOiAic2NhbGUiLAogICAgICAgICAgYXJnczogWyJzaXplIiwgIi1zaXplIl0KICAgICAgICB9KTsKICAgICAgICB0aGlzLmNvbXBpbGVHbHlwaEltcGwoY29kZSwgY21kcywgZ2x5cGhJZCk7CiAgICAgICAgY21kcy5wdXNoKHsKICAgICAgICAgIGNtZDogInJlc3RvcmUiCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGNtZHM7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiY29tcGlsZUdseXBoSW1wbCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21waWxlR2x5cGhJbXBsKCkgewogICAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIkNoaWxkcmVuIGNsYXNzZXMgc2hvdWxkIGltcGxlbWVudCB0aGlzLiIpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImhhc0J1aWx0UGF0aCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYXNCdWlsdFBhdGgodW5pY29kZSkgewogICAgICAgIHZhciBjbWFwID0gbG9va3VwQ21hcCh0aGlzLmNtYXAsIHVuaWNvZGUpOwogICAgICAgIHJldHVybiB0aGlzLmNvbXBpbGVkR2x5cGhzW2NtYXAuZ2x5cGhJZF0gIT09IHVuZGVmaW5lZCAmJiB0aGlzLmNvbXBpbGVkQ2hhckNvZGVUb0dseXBoSWRbY21hcC5jaGFyQ29kZV0gIT09IHVuZGVmaW5lZDsKICAgICAgfQogICAgfV0pOwoKICAgIHJldHVybiBDb21waWxlZEZvbnQ7CiAgfSgpOwoKICB2YXIgVHJ1ZVR5cGVDb21waWxlZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbXBpbGVkRm9udCkgewogICAgX2luaGVyaXRzKFRydWVUeXBlQ29tcGlsZWQsIF9Db21waWxlZEZvbnQpOwoKICAgIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoVHJ1ZVR5cGVDb21waWxlZCk7CgogICAgZnVuY3Rpb24gVHJ1ZVR5cGVDb21waWxlZChnbHlwaHMsIGNtYXAsIGZvbnRNYXRyaXgpIHsKICAgICAgdmFyIF90aGlzOwoKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRydWVUeXBlQ29tcGlsZWQpOwoKICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmb250TWF0cml4IHx8IFswLjAwMDQ4OCwgMCwgMCwgMC4wMDA0ODgsIDAsIDBdKTsKICAgICAgX3RoaXMuZ2x5cGhzID0gZ2x5cGhzOwogICAgICBfdGhpcy5jbWFwID0gY21hcDsKICAgICAgcmV0dXJuIF90aGlzOwogICAgfQoKICAgIF9jcmVhdGVDbGFzcyhUcnVlVHlwZUNvbXBpbGVkLCBbewogICAgICBrZXk6ICJjb21waWxlR2x5cGhJbXBsIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBpbGVHbHlwaEltcGwoY29kZSwgY21kcykgewogICAgICAgIGNvbXBpbGVHbHlmKGNvZGUsIGNtZHMsIHRoaXMpOwogICAgICB9CiAgICB9XSk7CgogICAgcmV0dXJuIFRydWVUeXBlQ29tcGlsZWQ7CiAgfShDb21waWxlZEZvbnQpOwoKICB2YXIgVHlwZTJDb21waWxlZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbXBpbGVkRm9udDIpIHsKICAgIF9pbmhlcml0cyhUeXBlMkNvbXBpbGVkLCBfQ29tcGlsZWRGb250Mik7CgogICAgdmFyIF9zdXBlcjIgPSBfY3JlYXRlU3VwZXIoVHlwZTJDb21waWxlZCk7CgogICAgZnVuY3Rpb24gVHlwZTJDb21waWxlZChjZmZJbmZvLCBjbWFwLCBmb250TWF0cml4LCBnbHlwaE5hbWVNYXApIHsKICAgICAgdmFyIF90aGlzMjsKCiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUeXBlMkNvbXBpbGVkKTsKCiAgICAgIF90aGlzMiA9IF9zdXBlcjIuY2FsbCh0aGlzLCBmb250TWF0cml4IHx8IFswLjAwMSwgMCwgMCwgMC4wMDEsIDAsIDBdKTsKICAgICAgX3RoaXMyLmdseXBocyA9IGNmZkluZm8uZ2x5cGhzOwogICAgICBfdGhpczIuZ3N1YnJzID0gY2ZmSW5mby5nc3VicnMgfHwgW107CiAgICAgIF90aGlzMi5zdWJycyA9IGNmZkluZm8uc3VicnMgfHwgW107CiAgICAgIF90aGlzMi5jbWFwID0gY21hcDsKICAgICAgX3RoaXMyLmdseXBoTmFtZU1hcCA9IGdseXBoTmFtZU1hcCB8fCAoMCwgX2dseXBobGlzdC5nZXRHbHlwaHNVbmljb2RlKSgpOwogICAgICBfdGhpczIuZ3N1YnJzQmlhcyA9IGdldFN1YnJvdXRpbmVCaWFzKF90aGlzMi5nc3VicnMpOwogICAgICBfdGhpczIuc3VicnNCaWFzID0gZ2V0U3Vicm91dGluZUJpYXMoX3RoaXMyLnN1YnJzKTsKICAgICAgX3RoaXMyLmlzQ0ZGQ0lERm9udCA9IGNmZkluZm8uaXNDRkZDSURGb250OwogICAgICBfdGhpczIuZmRTZWxlY3QgPSBjZmZJbmZvLmZkU2VsZWN0OwogICAgICBfdGhpczIuZmRBcnJheSA9IGNmZkluZm8uZmRBcnJheTsKICAgICAgcmV0dXJuIF90aGlzMjsKICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoVHlwZTJDb21waWxlZCwgW3sKICAgICAga2V5OiAiY29tcGlsZUdseXBoSW1wbCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21waWxlR2x5cGhJbXBsKGNvZGUsIGNtZHMsIGdseXBoSWQpIHsKICAgICAgICBjb21waWxlQ2hhclN0cmluZyhjb2RlLCBjbWRzLCB0aGlzLCBnbHlwaElkKTsKICAgICAgfQogICAgfV0pOwoKICAgIHJldHVybiBUeXBlMkNvbXBpbGVkOwogIH0oQ29tcGlsZWRGb250KTsKCiAgcmV0dXJuIHsKICAgIGNyZWF0ZTogZnVuY3Rpb24gRm9udFJlbmRlcmVyRmFjdG9yeV9jcmVhdGUoZm9udCwgc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KGZvbnQuZGF0YSk7CiAgICAgIHZhciBjbWFwLCBnbHlmLCBsb2NhLCBjZmYsIGluZGV4VG9Mb2NGb3JtYXQsIHVuaXRzUGVyRW07CiAgICAgIHZhciBudW1UYWJsZXMgPSBnZXRVc2hvcnQoZGF0YSwgNCk7CgogICAgICBmb3IgKHZhciBpID0gMCwgcCA9IDEyOyBpIDwgbnVtVGFibGVzOyBpKyssIHAgKz0gMTYpIHsKICAgICAgICB2YXIgdGFnID0gKDAsIF91dGlsLmJ5dGVzVG9TdHJpbmcpKGRhdGEuc3ViYXJyYXkocCwgcCArIDQpKTsKICAgICAgICB2YXIgb2Zmc2V0ID0gZ2V0TG9uZyhkYXRhLCBwICsgOCk7CiAgICAgICAgdmFyIGxlbmd0aCA9IGdldExvbmcoZGF0YSwgcCArIDEyKTsKCiAgICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAgICAgIGNhc2UgImNtYXAiOgogICAgICAgICAgICBjbWFwID0gcGFyc2VDbWFwKGRhdGEsIG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiZ2x5ZiI6CiAgICAgICAgICAgIGdseWYgPSBkYXRhLnN1YmFycmF5KG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAibG9jYSI6CiAgICAgICAgICAgIGxvY2EgPSBkYXRhLnN1YmFycmF5KG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiaGVhZCI6CiAgICAgICAgICAgIHVuaXRzUGVyRW0gPSBnZXRVc2hvcnQoZGF0YSwgb2Zmc2V0ICsgMTgpOwogICAgICAgICAgICBpbmRleFRvTG9jRm9ybWF0ID0gZ2V0VXNob3J0KGRhdGEsIG9mZnNldCArIDUwKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiQ0ZGICI6CiAgICAgICAgICAgIGNmZiA9IHBhcnNlQ2ZmKGRhdGEsIG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoLCBzZWFjQW5hbHlzaXNFbmFibGVkKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZ2x5ZikgewogICAgICAgIHZhciBmb250TWF0cml4ID0gIXVuaXRzUGVyRW0gPyBmb250LmZvbnRNYXRyaXggOiBbMSAvIHVuaXRzUGVyRW0sIDAsIDAsIDEgLyB1bml0c1BlckVtLCAwLCAwXTsKICAgICAgICByZXR1cm4gbmV3IFRydWVUeXBlQ29tcGlsZWQocGFyc2VHbHlmVGFibGUoZ2x5ZiwgbG9jYSwgaW5kZXhUb0xvY0Zvcm1hdCksIGNtYXAsIGZvbnRNYXRyaXgpOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IFR5cGUyQ29tcGlsZWQoY2ZmLCBjbWFwLCBmb250LmZvbnRNYXRyaXgsIGZvbnQuZ2x5cGhOYW1lTWFwKTsKICAgIH0KICB9Owp9KCk7CgpleHBvcnRzLkZvbnRSZW5kZXJlckZhY3RvcnkgPSBGb250UmVuZGVyZXJGYWN0b3J5OwoKLyoqKi8gfSksCi8qIDIzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlR5cGUxUGFyc2VyID0gdm9pZCAwOwoKdmFyIF9lbmNvZGluZ3MgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIyNSk7Cgp2YXIgX2NvcmVfdXRpbHMgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDIwMSk7Cgp2YXIgX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjA1KTsKCnZhciBfdXRpbCA9IF9fd19wZGZqc19yZXF1aXJlX18oNSk7Cgp2YXIgSElOVElOR19FTkFCTEVEID0gZmFsc2U7Cgp2YXIgVHlwZTFDaGFyU3RyaW5nID0gZnVuY3Rpb24gVHlwZTFDaGFyU3RyaW5nQ2xvc3VyZSgpIHsKICB2YXIgQ09NTUFORF9NQVAgPSB7CiAgICBoc3RlbTogWzFdLAogICAgdnN0ZW06IFszXSwKICAgIHZtb3ZldG86IFs0XSwKICAgIHJsaW5ldG86IFs1XSwKICAgIGhsaW5ldG86IFs2XSwKICAgIHZsaW5ldG86IFs3XSwKICAgIHJyY3VydmV0bzogWzhdLAogICAgY2FsbHN1YnI6IFsxMF0sCiAgICBmbGV4OiBbMTIsIDM1XSwKICAgIGRyb3A6IFsxMiwgMThdLAogICAgZW5kY2hhcjogWzE0XSwKICAgIHJtb3ZldG86IFsyMV0sCiAgICBobW92ZXRvOiBbMjJdLAogICAgdmhjdXJ2ZXRvOiBbMzBdLAogICAgaHZjdXJ2ZXRvOiBbMzFdCiAgfTsKCiAgZnVuY3Rpb24gVHlwZTFDaGFyU3RyaW5nKCkgewogICAgdGhpcy53aWR0aCA9IDA7CiAgICB0aGlzLmxzYiA9IDA7CiAgICB0aGlzLmZsZXhpbmcgPSBmYWxzZTsKICAgIHRoaXMub3V0cHV0ID0gW107CiAgICB0aGlzLnN0YWNrID0gW107CiAgfQoKICBUeXBlMUNoYXJTdHJpbmcucHJvdG90eXBlID0gewogICAgY29udmVydDogZnVuY3Rpb24gVHlwZTFDaGFyU3RyaW5nX2NvbnZlcnQoZW5jb2RlZCwgc3VicnMsIHNlYWNBbmFseXNpc0VuYWJsZWQpIHsKICAgICAgdmFyIGNvdW50ID0gZW5jb2RlZC5sZW5ndGg7CiAgICAgIHZhciBlcnJvciA9IGZhbHNlOwogICAgICB2YXIgd3gsIHNieCwgc3Vick51bWJlcjsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIHZhciB2YWx1ZSA9IGVuY29kZWRbaV07CgogICAgICAgIGlmICh2YWx1ZSA8IDMyKSB7CiAgICAgICAgICBpZiAodmFsdWUgPT09IDEyKSB7CiAgICAgICAgICAgIHZhbHVlID0gKHZhbHVlIDw8IDgpICsgZW5jb2RlZFsrK2ldOwogICAgICAgICAgfQoKICAgICAgICAgIHN3aXRjaCAodmFsdWUpIHsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGlmICghSElOVElOR19FTkFCTEVEKSB7CiAgICAgICAgICAgICAgICB0aGlzLnN0YWNrID0gW107CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgyLCBDT01NQU5EX01BUC5oc3RlbSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgaWYgKCFISU5USU5HX0VOQUJMRUQpIHsKICAgICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLnZzdGVtKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBpZiAodGhpcy5mbGV4aW5nKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFyIGR5ID0gdGhpcy5zdGFjay5wb3AoKTsKICAgICAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaCgwLCBkeSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgxLCBDT01NQU5EX01BUC52bW92ZXRvKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMiwgQ09NTUFORF9NQVAucmxpbmV0byk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDEsIENPTU1BTkRfTUFQLmhsaW5ldG8pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgxLCBDT01NQU5EX01BUC52bGluZXRvKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoNiwgQ09NTUFORF9NQVAucnJjdXJ2ZXRvKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICB0aGlzLnN0YWNrID0gW107CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA8IDEpIHsKICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgc3Vick51bWJlciA9IHRoaXMuc3RhY2sucG9wKCk7CgogICAgICAgICAgICAgIGlmICghc3VicnNbc3Vick51bWJlcl0pIHsKICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmNvbnZlcnQoc3VicnNbc3Vick51bWJlcl0sIHN1YnJzLCBzZWFjQW5hbHlzaXNFbmFibGVkKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgcmV0dXJuIGVycm9yOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHd4ID0gdGhpcy5zdGFjay5wb3AoKTsKICAgICAgICAgICAgICBzYnggPSB0aGlzLnN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIHRoaXMubHNiID0gc2J4OwogICAgICAgICAgICAgIHRoaXMud2lkdGggPSB3eDsKICAgICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2god3gsIHNieCk7CiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLmhtb3ZldG8pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICB0aGlzLm91dHB1dC5wdXNoKENPTU1BTkRfTUFQLmVuZGNoYXJbMF0pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICBpZiAodGhpcy5mbGV4aW5nKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCgyLCBDT01NQU5EX01BUC5ybW92ZXRvKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgICAgaWYgKHRoaXMuZmxleGluZykgewogICAgICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoKDApOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMSwgQ09NTUFORF9NQVAuaG1vdmV0byk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCg0LCBDT01NQU5EX01BUC52aGN1cnZldG8pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAzMToKICAgICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoNCwgQ09NTUFORF9NQVAuaHZjdXJ2ZXRvKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMDoKICAgICAgICAgICAgICB0aGlzLnN0YWNrID0gW107CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICgxMiA8PCA4KSArIDE6CiAgICAgICAgICAgICAgaWYgKCFISU5USU5HX0VOQUJMRUQpIHsKICAgICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBbXTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDIsIENPTU1BTkRfTUFQLnZzdGVtKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMjoKICAgICAgICAgICAgICBpZiAoIUhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgICAgdGhpcy5zdGFjayA9IFtdOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMiwgQ09NTUFORF9NQVAuaHN0ZW0pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyA2OgogICAgICAgICAgICAgIGlmIChzZWFjQW5hbHlzaXNFbmFibGVkKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNlYWMgPSB0aGlzLnN0YWNrLnNwbGljZSgtNCwgNCk7CiAgICAgICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMCwgQ09NTUFORF9NQVAuZW5kY2hhcik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVycm9yID0gdGhpcy5leGVjdXRlQ29tbWFuZCg0LCBDT01NQU5EX01BUC5lbmRjaGFyKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyA3OgogICAgICAgICAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA8IDQpIHsKICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5zdGFjay5wb3AoKTsKICAgICAgICAgICAgICB3eCA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgdmFyIHNieSA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgc2J4ID0gdGhpcy5zdGFjay5wb3AoKTsKICAgICAgICAgICAgICB0aGlzLmxzYiA9IHNieDsKICAgICAgICAgICAgICB0aGlzLndpZHRoID0gd3g7CiAgICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoKHd4LCBzYngsIHNieSk7CiAgICAgICAgICAgICAgZXJyb3IgPSB0aGlzLmV4ZWN1dGVDb21tYW5kKDMsIENPTU1BTkRfTUFQLnJtb3ZldG8pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyAxMjoKICAgICAgICAgICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHZhciBudW0yID0gdGhpcy5zdGFjay5wb3AoKTsKICAgICAgICAgICAgICB2YXIgbnVtMSA9IHRoaXMuc3RhY2sucG9wKCk7CiAgICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoKG51bTEgLyBudW0yKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgKDEyIDw8IDgpICsgMTY6CiAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdWJyTnVtYmVyID0gdGhpcy5zdGFjay5wb3AoKTsKICAgICAgICAgICAgICB2YXIgbnVtQXJncyA9IHRoaXMuc3RhY2sucG9wKCk7CgogICAgICAgICAgICAgIGlmIChzdWJyTnVtYmVyID09PSAwICYmIG51bUFyZ3MgPT09IDMpIHsKICAgICAgICAgICAgICAgIHZhciBmbGV4QXJncyA9IHRoaXMuc3RhY2suc3BsaWNlKHRoaXMuc3RhY2subGVuZ3RoIC0gMTcsIDE3KTsKICAgICAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaChmbGV4QXJnc1syXSArIGZsZXhBcmdzWzBdLCBmbGV4QXJnc1szXSArIGZsZXhBcmdzWzFdLCBmbGV4QXJnc1s0XSwgZmxleEFyZ3NbNV0sIGZsZXhBcmdzWzZdLCBmbGV4QXJnc1s3XSwgZmxleEFyZ3NbOF0sIGZsZXhBcmdzWzldLCBmbGV4QXJnc1sxMF0sIGZsZXhBcmdzWzExXSwgZmxleEFyZ3NbMTJdLCBmbGV4QXJnc1sxM10sIGZsZXhBcmdzWzE0XSk7CiAgICAgICAgICAgICAgICBlcnJvciA9IHRoaXMuZXhlY3V0ZUNvbW1hbmQoMTMsIENPTU1BTkRfTUFQLmZsZXgsIHRydWUpOwogICAgICAgICAgICAgICAgdGhpcy5mbGV4aW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnN0YWNrLnB1c2goZmxleEFyZ3NbMTVdLCBmbGV4QXJnc1sxNl0pOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3Vick51bWJlciA9PT0gMSAmJiBudW1BcmdzID09PSAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmZsZXhpbmcgPSB0cnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICgxMiA8PCA4KSArIDE3OgogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAoMTIgPDwgOCkgKyAzMzoKICAgICAgICAgICAgICB0aGlzLnN0YWNrID0gW107CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgnVW5rbm93biB0eXBlIDEgY2hhcnN0cmluZyBjb21tYW5kIG9mICInICsgdmFsdWUgKyAnIicpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChlcnJvcikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIDw9IDI0NikgewogICAgICAgICAgdmFsdWUgPSB2YWx1ZSAtIDEzOTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIDw9IDI1MCkgewogICAgICAgICAgdmFsdWUgPSAodmFsdWUgLSAyNDcpICogMjU2ICsgZW5jb2RlZFsrK2ldICsgMTA4OwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPD0gMjU0KSB7CiAgICAgICAgICB2YWx1ZSA9IC0oKHZhbHVlIC0gMjUxKSAqIDI1NikgLSBlbmNvZGVkWysraV0gLSAxMDg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhbHVlID0gKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDI0IHwgKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDE2IHwgKGVuY29kZWRbKytpXSAmIDB4ZmYpIDw8IDggfCAoZW5jb2RlZFsrK2ldICYgMHhmZikgPDwgMDsKICAgICAgICB9CgogICAgICAgIHRoaXMuc3RhY2sucHVzaCh2YWx1ZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBlcnJvcjsKICAgIH0sCiAgICBleGVjdXRlQ29tbWFuZDogZnVuY3Rpb24gZXhlY3V0ZUNvbW1hbmQoaG93TWFueUFyZ3MsIGNvbW1hbmQsIGtlZXBTdGFjaykgewogICAgICB2YXIgc3RhY2tMZW5ndGggPSB0aGlzLnN0YWNrLmxlbmd0aDsKCiAgICAgIGlmIChob3dNYW55QXJncyA+IHN0YWNrTGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHZhciBzdGFydCA9IHN0YWNrTGVuZ3RoIC0gaG93TWFueUFyZ3M7CgogICAgICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBzdGFja0xlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5zdGFja1tpXTsKCiAgICAgICAgaWYgKE51bWJlci5pc0ludGVnZXIodmFsdWUpKSB7CiAgICAgICAgICB0aGlzLm91dHB1dC5wdXNoKDI4LCB2YWx1ZSA+PiA4ICYgMHhmZiwgdmFsdWUgJiAweGZmKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFsdWUgPSA2NTUzNiAqIHZhbHVlIHwgMDsKICAgICAgICAgIHRoaXMub3V0cHV0LnB1c2goMjU1LCB2YWx1ZSA+PiAyNCAmIDB4ZmYsIHZhbHVlID4+IDE2ICYgMHhmZiwgdmFsdWUgPj4gOCAmIDB4ZmYsIHZhbHVlICYgMHhmZik7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLm91dHB1dC5wdXNoLmFwcGx5KHRoaXMub3V0cHV0LCBjb21tYW5kKTsKCiAgICAgIGlmIChrZWVwU3RhY2spIHsKICAgICAgICB0aGlzLnN0YWNrLnNwbGljZShzdGFydCwgaG93TWFueUFyZ3MpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc3RhY2subGVuZ3RoID0gMDsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH07CiAgcmV0dXJuIFR5cGUxQ2hhclN0cmluZzsKfSgpOwoKdmFyIFR5cGUxUGFyc2VyID0gZnVuY3Rpb24gVHlwZTFQYXJzZXJDbG9zdXJlKCkgewogIHZhciBFRVhFQ19FTkNSWVBUX0tFWSA9IDU1NjY1OwogIHZhciBDSEFSX1NUUlNfRU5DUllQVF9LRVkgPSA0MzMwOwoKICBmdW5jdGlvbiBpc0hleERpZ2l0KGNvZGUpIHsKICAgIHJldHVybiBjb2RlID49IDQ4ICYmIGNvZGUgPD0gNTcgfHwgY29kZSA+PSA2NSAmJiBjb2RlIDw9IDcwIHx8IGNvZGUgPj0gOTcgJiYgY29kZSA8PSAxMDI7CiAgfQoKICBmdW5jdGlvbiBkZWNyeXB0KGRhdGEsIGtleSwgZGlzY2FyZE51bWJlcikgewogICAgaWYgKGRpc2NhcmROdW1iZXIgPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApOwogICAgfQoKICAgIHZhciByID0ga2V5IHwgMCwKICAgICAgICBjMSA9IDUyODQ1LAogICAgICAgIGMyID0gMjI3MTksCiAgICAgICAgaSwKICAgICAgICBqOwoKICAgIGZvciAoaSA9IDA7IGkgPCBkaXNjYXJkTnVtYmVyOyBpKyspIHsKICAgICAgciA9IChkYXRhW2ldICsgcikgKiBjMSArIGMyICYgKDEgPDwgMTYpIC0gMTsKICAgIH0KCiAgICB2YXIgY291bnQgPSBkYXRhLmxlbmd0aCAtIGRpc2NhcmROdW1iZXI7CiAgICB2YXIgZGVjcnlwdGVkID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoKICAgIGZvciAoaSA9IGRpc2NhcmROdW1iZXIsIGogPSAwOyBqIDwgY291bnQ7IGkrKywgaisrKSB7CiAgICAgIHZhciB2YWx1ZSA9IGRhdGFbaV07CiAgICAgIGRlY3J5cHRlZFtqXSA9IHZhbHVlIF4gciA+PiA4OwogICAgICByID0gKHZhbHVlICsgcikgKiBjMSArIGMyICYgKDEgPDwgMTYpIC0gMTsKICAgIH0KCiAgICByZXR1cm4gZGVjcnlwdGVkOwogIH0KCiAgZnVuY3Rpb24gZGVjcnlwdEFzY2lpKGRhdGEsIGtleSwgZGlzY2FyZE51bWJlcikgewogICAgdmFyIHIgPSBrZXkgfCAwLAogICAgICAgIGMxID0gNTI4NDUsCiAgICAgICAgYzIgPSAyMjcxOTsKICAgIHZhciBjb3VudCA9IGRhdGEubGVuZ3RoLAogICAgICAgIG1heWJlTGVuZ3RoID0gY291bnQgPj4+IDE7CiAgICB2YXIgZGVjcnlwdGVkID0gbmV3IFVpbnQ4QXJyYXkobWF5YmVMZW5ndGgpOwogICAgdmFyIGksIGo7CgogICAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgIHZhciBkaWdpdDEgPSBkYXRhW2ldOwoKICAgICAgaWYgKCFpc0hleERpZ2l0KGRpZ2l0MSkpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaSsrOwogICAgICB2YXIgZGlnaXQyOwoKICAgICAgd2hpbGUgKGkgPCBjb3VudCAmJiAhaXNIZXhEaWdpdChkaWdpdDIgPSBkYXRhW2ldKSkgewogICAgICAgIGkrKzsKICAgICAgfQoKICAgICAgaWYgKGkgPCBjb3VudCkgewogICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlSW50KFN0cmluZy5mcm9tQ2hhckNvZGUoZGlnaXQxLCBkaWdpdDIpLCAxNik7CiAgICAgICAgZGVjcnlwdGVkW2orK10gPSB2YWx1ZSBeIHIgPj4gODsKICAgICAgICByID0gKHZhbHVlICsgcikgKiBjMSArIGMyICYgKDEgPDwgMTYpIC0gMTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBkZWNyeXB0ZWQuc2xpY2UoZGlzY2FyZE51bWJlciwgaik7CiAgfQoKICBmdW5jdGlvbiBpc1NwZWNpYWwoYykgewogICAgcmV0dXJuIGMgPT09IDB4MmYgfHwgYyA9PT0gMHg1YiB8fCBjID09PSAweDVkIHx8IGMgPT09IDB4N2IgfHwgYyA9PT0gMHg3ZCB8fCBjID09PSAweDI4IHx8IGMgPT09IDB4Mjk7CiAgfQoKICBmdW5jdGlvbiBUeXBlMVBhcnNlcihzdHJlYW0sIGVuY3J5cHRlZCwgc2VhY0FuYWx5c2lzRW5hYmxlZCkgewogICAgaWYgKGVuY3J5cHRlZCkgewogICAgICB2YXIgZGF0YSA9IHN0cmVhbS5nZXRCeXRlcygpOwogICAgICB2YXIgaXNCaW5hcnkgPSAhKChpc0hleERpZ2l0KGRhdGFbMF0pIHx8ICgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGRhdGFbMF0pKSAmJiBpc0hleERpZ2l0KGRhdGFbMV0pICYmIGlzSGV4RGlnaXQoZGF0YVsyXSkgJiYgaXNIZXhEaWdpdChkYXRhWzNdKSAmJiBpc0hleERpZ2l0KGRhdGFbNF0pICYmIGlzSGV4RGlnaXQoZGF0YVs1XSkgJiYgaXNIZXhEaWdpdChkYXRhWzZdKSAmJiBpc0hleERpZ2l0KGRhdGFbN10pKTsKICAgICAgc3RyZWFtID0gbmV3IF9zdHJlYW0uU3RyZWFtKGlzQmluYXJ5ID8gZGVjcnlwdChkYXRhLCBFRVhFQ19FTkNSWVBUX0tFWSwgNCkgOiBkZWNyeXB0QXNjaWkoZGF0YSwgRUVYRUNfRU5DUllQVF9LRVksIDQpKTsKICAgIH0KCiAgICB0aGlzLnNlYWNBbmFseXNpc0VuYWJsZWQgPSAhIXNlYWNBbmFseXNpc0VuYWJsZWQ7CiAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTsKICAgIHRoaXMubmV4dENoYXIoKTsKICB9CgogIFR5cGUxUGFyc2VyLnByb3RvdHlwZSA9IHsKICAgIHJlYWROdW1iZXJBcnJheTogZnVuY3Rpb24gVHlwZTFQYXJzZXJfcmVhZE51bWJlckFycmF5KCkgewogICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgIHZhciBhcnJheSA9IFtdOwoKICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CgogICAgICAgIGlmICh0b2tlbiA9PT0gbnVsbCB8fCB0b2tlbiA9PT0gIl0iIHx8IHRva2VuID09PSAifSIpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgYXJyYXkucHVzaChwYXJzZUZsb2F0KHRva2VuIHx8IDApKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGFycmF5OwogICAgfSwKICAgIHJlYWROdW1iZXI6IGZ1bmN0aW9uIFR5cGUxUGFyc2VyX3JlYWROdW1iZXIoKSB7CiAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodG9rZW4gfHwgMCk7CiAgICB9LAogICAgcmVhZEludDogZnVuY3Rpb24gVHlwZTFQYXJzZXJfcmVhZEludCgpIHsKICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpOwogICAgICByZXR1cm4gcGFyc2VJbnQodG9rZW4gfHwgMCwgMTApIHwgMDsKICAgIH0sCiAgICByZWFkQm9vbGVhbjogZnVuY3Rpb24gVHlwZTFQYXJzZXJfcmVhZEJvb2xlYW4oKSB7CiAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgcmV0dXJuIHRva2VuID09PSAidHJ1ZSIgPyAxIDogMDsKICAgIH0sCiAgICBuZXh0Q2hhcjogZnVuY3Rpb24gVHlwZTFfbmV4dENoYXIoKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRDaGFyID0gdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpOwogICAgfSwKICAgIGdldFRva2VuOiBmdW5jdGlvbiBUeXBlMVBhcnNlcl9nZXRUb2tlbigpIHsKICAgICAgdmFyIGNvbW1lbnQgPSBmYWxzZTsKICAgICAgdmFyIGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKCiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgaWYgKGNoID09PSAtMSkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29tbWVudCkgewogICAgICAgICAgaWYgKGNoID09PSAweDBhIHx8IGNoID09PSAweDBkKSB7CiAgICAgICAgICAgIGNvbW1lbnQgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGNoID09PSAweDI1KSB7CiAgICAgICAgICBjb21tZW50ID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKCEoMCwgX2NvcmVfdXRpbHMuaXNXaGl0ZVNwYWNlKShjaCkpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgIH0KCiAgICAgIGlmIChpc1NwZWNpYWwoY2gpKSB7CiAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKTsKICAgICAgfQoKICAgICAgdmFyIHRva2VuID0gIiI7CgogICAgICBkbyB7CiAgICAgICAgdG9rZW4gKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaCk7CiAgICAgICAgY2ggPSB0aGlzLm5leHRDaGFyKCk7CiAgICAgIH0gd2hpbGUgKGNoID49IDAgJiYgISgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGNoKSAmJiAhaXNTcGVjaWFsKGNoKSk7CgogICAgICByZXR1cm4gdG9rZW47CiAgICB9LAogICAgcmVhZENoYXJTdHJpbmdzOiBmdW5jdGlvbiBUeXBlMVBhcnNlcl9yZWFkQ2hhclN0cmluZ3MoYnl0ZXMsIGxlbklWKSB7CiAgICAgIGlmIChsZW5JViA9PT0gLTEpIHsKICAgICAgICByZXR1cm4gYnl0ZXM7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZWNyeXB0KGJ5dGVzLCBDSEFSX1NUUlNfRU5DUllQVF9LRVksIGxlbklWKTsKICAgIH0sCiAgICBleHRyYWN0Rm9udFByb2dyYW06IGZ1bmN0aW9uIFR5cGUxUGFyc2VyX2V4dHJhY3RGb250UHJvZ3JhbShwcm9wZXJ0aWVzKSB7CiAgICAgIHZhciBzdHJlYW0gPSB0aGlzLnN0cmVhbTsKICAgICAgdmFyIHN1YnJzID0gW10sCiAgICAgICAgICBjaGFyc3RyaW5ncyA9IFtdOwogICAgICB2YXIgcHJpdmF0ZURhdGEgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgICBwcml2YXRlRGF0YS5sZW5JViA9IDQ7CiAgICAgIHZhciBwcm9ncmFtID0gewogICAgICAgIHN1YnJzOiBbXSwKICAgICAgICBjaGFyc3RyaW5nczogW10sCiAgICAgICAgcHJvcGVydGllczogewogICAgICAgICAgcHJpdmF0ZURhdGE6IHByaXZhdGVEYXRhCiAgICAgICAgfQogICAgICB9OwogICAgICB2YXIgdG9rZW4sIGxlbmd0aCwgZGF0YSwgbGVuSVYsIGVuY29kZWQ7CgogICAgICB3aGlsZSAoKHRva2VuID0gdGhpcy5nZXRUb2tlbigpKSAhPT0gbnVsbCkgewogICAgICAgIGlmICh0b2tlbiAhPT0gIi8iKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHRva2VuID0gdGhpcy5nZXRUb2tlbigpOwoKICAgICAgICBzd2l0Y2ggKHRva2VuKSB7CiAgICAgICAgICBjYXNlICJDaGFyU3RyaW5ncyI6CiAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgICAgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CgogICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gbnVsbCB8fCB0b2tlbiA9PT0gImVuZCIpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHRva2VuICE9PSAiLyIpIHsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdmFyIGdseXBoID0gdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgIGxlbmd0aCA9IHRoaXMucmVhZEludCgpOwogICAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgICBkYXRhID0gbGVuZ3RoID4gMCA/IHN0cmVhbS5nZXRCeXRlcyhsZW5ndGgpIDogbmV3IFVpbnQ4QXJyYXkoMCk7CiAgICAgICAgICAgICAgbGVuSVYgPSBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGEubGVuSVY7CiAgICAgICAgICAgICAgZW5jb2RlZCA9IHRoaXMucmVhZENoYXJTdHJpbmdzKGRhdGEsIGxlbklWKTsKICAgICAgICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgICAgICAgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CgogICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gIm5vYWNjZXNzIikgewogICAgICAgICAgICAgICAgdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2hhcnN0cmluZ3MucHVzaCh7CiAgICAgICAgICAgICAgICBnbHlwaDogZ2x5cGgsCiAgICAgICAgICAgICAgICBlbmNvZGVkOiBlbmNvZGVkCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIlN1YnJzIjoKICAgICAgICAgICAgdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgIHdoaWxlICh0aGlzLmdldFRva2VuKCkgPT09ICJkdXAiKSB7CiAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICAgICAgbGVuZ3RoID0gdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICAgICAgdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgIGRhdGEgPSBsZW5ndGggPiAwID8gc3RyZWFtLmdldEJ5dGVzKGxlbmd0aCkgOiBuZXcgVWludDhBcnJheSgwKTsKICAgICAgICAgICAgICBsZW5JViA9IHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YS5sZW5JVjsKICAgICAgICAgICAgICBlbmNvZGVkID0gdGhpcy5yZWFkQ2hhclN0cmluZ3MoZGF0YSwgbGVuSVYpOwogICAgICAgICAgICAgIHRoaXMubmV4dENoYXIoKTsKICAgICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgICAgaWYgKHRva2VuID09PSAibm9hY2Nlc3MiKSB7CiAgICAgICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBzdWJyc1tpbmRleF0gPSBlbmNvZGVkOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJCbHVlVmFsdWVzIjoKICAgICAgICAgIGNhc2UgIk90aGVyQmx1ZXMiOgogICAgICAgICAgY2FzZSAiRmFtaWx5Qmx1ZXMiOgogICAgICAgICAgY2FzZSAiRmFtaWx5T3RoZXJCbHVlcyI6CiAgICAgICAgICAgIHZhciBibHVlQXJyYXkgPSB0aGlzLnJlYWROdW1iZXJBcnJheSgpOwoKICAgICAgICAgICAgaWYgKGJsdWVBcnJheS5sZW5ndGggPiAwICYmIGJsdWVBcnJheS5sZW5ndGggJSAyID09PSAwICYmIEhJTlRJTkdfRU5BQkxFRCkgewogICAgICAgICAgICAgIHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YVt0b2tlbl0gPSBibHVlQXJyYXk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIlN0ZW1TbmFwSCI6CiAgICAgICAgICBjYXNlICJTdGVtU25hcFYiOgogICAgICAgICAgICBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGFbdG9rZW5dID0gdGhpcy5yZWFkTnVtYmVyQXJyYXkoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiU3RkSFciOgogICAgICAgICAgY2FzZSAiU3RkVlciOgogICAgICAgICAgICBwcm9ncmFtLnByb3BlcnRpZXMucHJpdmF0ZURhdGFbdG9rZW5dID0gdGhpcy5yZWFkTnVtYmVyQXJyYXkoKVswXTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiQmx1ZVNoaWZ0IjoKICAgICAgICAgIGNhc2UgImxlbklWIjoKICAgICAgICAgIGNhc2UgIkJsdWVGdXp6IjoKICAgICAgICAgIGNhc2UgIkJsdWVTY2FsZSI6CiAgICAgICAgICBjYXNlICJMYW5ndWFnZUdyb3VwIjoKICAgICAgICAgIGNhc2UgIkV4cGFuc2lvbkZhY3RvciI6CiAgICAgICAgICAgIHByb2dyYW0ucHJvcGVydGllcy5wcml2YXRlRGF0YVt0b2tlbl0gPSB0aGlzLnJlYWROdW1iZXIoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiRm9yY2VCb2xkIjoKICAgICAgICAgICAgcHJvZ3JhbS5wcm9wZXJ0aWVzLnByaXZhdGVEYXRhW3Rva2VuXSA9IHRoaXMucmVhZEJvb2xlYW4oKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzdHJpbmdzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZ2x5cGggPSBjaGFyc3RyaW5nc1tpXS5nbHlwaDsKICAgICAgICBlbmNvZGVkID0gY2hhcnN0cmluZ3NbaV0uZW5jb2RlZDsKICAgICAgICB2YXIgY2hhclN0cmluZyA9IG5ldyBUeXBlMUNoYXJTdHJpbmcoKTsKICAgICAgICB2YXIgZXJyb3IgPSBjaGFyU3RyaW5nLmNvbnZlcnQoZW5jb2RlZCwgc3VicnMsIHRoaXMuc2VhY0FuYWx5c2lzRW5hYmxlZCk7CiAgICAgICAgdmFyIG91dHB1dCA9IGNoYXJTdHJpbmcub3V0cHV0OwoKICAgICAgICBpZiAoZXJyb3IpIHsKICAgICAgICAgIG91dHB1dCA9IFsxNF07CiAgICAgICAgfQoKICAgICAgICB2YXIgY2hhclN0cmluZ09iamVjdCA9IHsKICAgICAgICAgIGdseXBoTmFtZTogZ2x5cGgsCiAgICAgICAgICBjaGFyc3RyaW5nOiBvdXRwdXQsCiAgICAgICAgICB3aWR0aDogY2hhclN0cmluZy53aWR0aCwKICAgICAgICAgIGxzYjogY2hhclN0cmluZy5sc2IsCiAgICAgICAgICBzZWFjOiBjaGFyU3RyaW5nLnNlYWMKICAgICAgICB9OwoKICAgICAgICBpZiAoZ2x5cGggPT09ICIubm90ZGVmIikgewogICAgICAgICAgcHJvZ3JhbS5jaGFyc3RyaW5ncy51bnNoaWZ0KGNoYXJTdHJpbmdPYmplY3QpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwcm9ncmFtLmNoYXJzdHJpbmdzLnB1c2goY2hhclN0cmluZ09iamVjdCk7CiAgICAgICAgfQoKICAgICAgICBpZiAocHJvcGVydGllcy5idWlsdEluRW5jb2RpbmcpIHsKICAgICAgICAgIHZhciBfaW5kZXggPSBwcm9wZXJ0aWVzLmJ1aWx0SW5FbmNvZGluZy5pbmRleE9mKGdseXBoKTsKCiAgICAgICAgICBpZiAoX2luZGV4ID4gLTEgJiYgcHJvcGVydGllcy53aWR0aHNbX2luZGV4XSA9PT0gdW5kZWZpbmVkICYmIF9pbmRleCA+PSBwcm9wZXJ0aWVzLmZpcnN0Q2hhciAmJiBfaW5kZXggPD0gcHJvcGVydGllcy5sYXN0Q2hhcikgewogICAgICAgICAgICBwcm9wZXJ0aWVzLndpZHRoc1tfaW5kZXhdID0gY2hhclN0cmluZy53aWR0aDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBwcm9ncmFtOwogICAgfSwKICAgIGV4dHJhY3RGb250SGVhZGVyOiBmdW5jdGlvbiBUeXBlMVBhcnNlcl9leHRyYWN0Rm9udEhlYWRlcihwcm9wZXJ0aWVzKSB7CiAgICAgIHZhciB0b2tlbjsKCiAgICAgIHdoaWxlICgodG9rZW4gPSB0aGlzLmdldFRva2VuKCkpICE9PSBudWxsKSB7CiAgICAgICAgaWYgKHRva2VuICE9PSAiLyIpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CgogICAgICAgIHN3aXRjaCAodG9rZW4pIHsKICAgICAgICAgIGNhc2UgIkZvbnRNYXRyaXgiOgogICAgICAgICAgICB2YXIgbWF0cml4ID0gdGhpcy5yZWFkTnVtYmVyQXJyYXkoKTsKICAgICAgICAgICAgcHJvcGVydGllcy5mb250TWF0cml4ID0gbWF0cml4OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJFbmNvZGluZyI6CiAgICAgICAgICAgIHZhciBlbmNvZGluZ0FyZyA9IHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgdmFyIGVuY29kaW5nOwoKICAgICAgICAgICAgaWYgKCEvXlxkKyQvLnRlc3QoZW5jb2RpbmdBcmcpKSB7CiAgICAgICAgICAgICAgZW5jb2RpbmcgPSAoMCwgX2VuY29kaW5ncy5nZXRFbmNvZGluZykoZW5jb2RpbmdBcmcpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVuY29kaW5nID0gW107CiAgICAgICAgICAgICAgdmFyIHNpemUgPSBwYXJzZUludChlbmNvZGluZ0FyZywgMTApIHwgMDsKICAgICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CgogICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2l6ZTsgaisrKSB7CiAgICAgICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgICAgICB3aGlsZSAodG9rZW4gIT09ICJkdXAiICYmIHRva2VuICE9PSAiZGVmIikgewogICAgICAgICAgICAgICAgICB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTsKCiAgICAgICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gImRlZiIpIHsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5yZWFkSW50KCk7CiAgICAgICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgICAgICB2YXIgZ2x5cGggPSB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgICAgICBlbmNvZGluZ1tpbmRleF0gPSBnbHlwaDsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3BlcnRpZXMuYnVpbHRJbkVuY29kaW5nID0gZW5jb2Rpbmc7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIkZvbnRCQm94IjoKICAgICAgICAgICAgdmFyIGZvbnRCQm94ID0gdGhpcy5yZWFkTnVtYmVyQXJyYXkoKTsKICAgICAgICAgICAgcHJvcGVydGllcy5hc2NlbnQgPSBNYXRoLm1heChmb250QkJveFszXSwgZm9udEJCb3hbMV0pOwogICAgICAgICAgICBwcm9wZXJ0aWVzLmRlc2NlbnQgPSBNYXRoLm1pbihmb250QkJveFsxXSwgZm9udEJCb3hbM10pOwogICAgICAgICAgICBwcm9wZXJ0aWVzLmFzY2VudFNjYWxlZCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CiAgcmV0dXJuIFR5cGUxUGFyc2VyOwp9KCk7CgpleHBvcnRzLlR5cGUxUGFyc2VyID0gVHlwZTFQYXJzZXI7CgovKioqLyB9KSwKLyogMjMxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZ2V0VGlsaW5nUGF0dGVybklSID0gZ2V0VGlsaW5nUGF0dGVybklSOwpleHBvcnRzLlBhdHRlcm4gPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9jb2xvcnNwYWNlID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTYpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTgpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpOwoKdmFyIFNoYWRpbmdUeXBlID0gewogIEZVTkNUSU9OX0JBU0VEOiAxLAogIEFYSUFMOiAyLAogIFJBRElBTDogMywKICBGUkVFX0ZPUk1fTUVTSDogNCwKICBMQVRUSUNFX0ZPUk1fTUVTSDogNSwKICBDT09OU19QQVRDSF9NRVNIOiA2LAogIFRFTlNPUl9QQVRDSF9NRVNIOiA3Cn07Cgp2YXIgUGF0dGVybiA9IGZ1bmN0aW9uIFBhdHRlcm5DbG9zdXJlKCkgewogIGZ1bmN0aW9uIFBhdHRlcm4oKSB7CiAgICAoMCwgX3V0aWwudW5yZWFjaGFibGUpKCJzaG91bGQgbm90IGNhbGwgUGF0dGVybiBjb25zdHJ1Y3RvciIpOwogIH0KCiAgUGF0dGVybi5wcm90b3R5cGUgPSB7CiAgICBnZXRQYXR0ZXJuOiBmdW5jdGlvbiBQYXR0ZXJuX2dldFBhdHRlcm4oY3R4KSB7CiAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoIlNob3VsZCBub3QgY2FsbCBQYXR0ZXJuLmdldFN0eWxlOiAiLmNvbmNhdChjdHgpKTsKICAgIH0KICB9OwoKICBQYXR0ZXJuLnBhcnNlU2hhZGluZyA9IGZ1bmN0aW9uIChzaGFkaW5nLCBtYXRyaXgsIHhyZWYsIHJlcywgaGFuZGxlciwgcGRmRnVuY3Rpb25GYWN0b3J5KSB7CiAgICB2YXIgZGljdCA9ICgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkoc2hhZGluZykgPyBzaGFkaW5nLmRpY3QgOiBzaGFkaW5nOwogICAgdmFyIHR5cGUgPSBkaWN0LmdldCgiU2hhZGluZ1R5cGUiKTsKCiAgICB0cnkgewogICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICBjYXNlIFNoYWRpbmdUeXBlLkFYSUFMOgogICAgICAgIGNhc2UgU2hhZGluZ1R5cGUuUkFESUFMOgogICAgICAgICAgcmV0dXJuIG5ldyBTaGFkaW5ncy5SYWRpYWxBeGlhbChkaWN0LCBtYXRyaXgsIHhyZWYsIHJlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKCiAgICAgICAgY2FzZSBTaGFkaW5nVHlwZS5GUkVFX0ZPUk1fTUVTSDoKICAgICAgICBjYXNlIFNoYWRpbmdUeXBlLkxBVFRJQ0VfRk9STV9NRVNIOgogICAgICAgIGNhc2UgU2hhZGluZ1R5cGUuQ09PTlNfUEFUQ0hfTUVTSDoKICAgICAgICBjYXNlIFNoYWRpbmdUeXBlLlRFTlNPUl9QQVRDSF9NRVNIOgogICAgICAgICAgcmV0dXJuIG5ldyBTaGFkaW5ncy5NZXNoKHNoYWRpbmcsIG1hdHJpeCwgeHJlZiwgcmVzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbnN1cHBvcnRlZCBTaGFkaW5nVHlwZTogIiArIHR5cGUpOwogICAgICB9CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZXggaW5zdGFuY2VvZiBfY29yZV91dGlscy5NaXNzaW5nRGF0YUV4Y2VwdGlvbikgewogICAgICAgIHRocm93IGV4OwogICAgICB9CgogICAgICBoYW5kbGVyLnNlbmQoIlVuc3VwcG9ydGVkRmVhdHVyZSIsIHsKICAgICAgICBmZWF0dXJlSWQ6IF91dGlsLlVOU1VQUE9SVEVEX0ZFQVRVUkVTLnNoYWRpbmdQYXR0ZXJuCiAgICAgIH0pOwogICAgICAoMCwgX3V0aWwud2FybikoZXgpOwogICAgICByZXR1cm4gbmV3IFNoYWRpbmdzLkR1bW15KCk7CiAgICB9CiAgfTsKCiAgcmV0dXJuIFBhdHRlcm47Cn0oKTsKCmV4cG9ydHMuUGF0dGVybiA9IFBhdHRlcm47CnZhciBTaGFkaW5ncyA9IHt9OwpTaGFkaW5ncy5TTUFMTF9OVU1CRVIgPSAxZS02OwoKU2hhZGluZ3MuUmFkaWFsQXhpYWwgPSBmdW5jdGlvbiBSYWRpYWxBeGlhbENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gUmFkaWFsQXhpYWwoZGljdCwgbWF0cml4LCB4cmVmLCByZXMsIHBkZkZ1bmN0aW9uRmFjdG9yeSkgewogICAgdGhpcy5tYXRyaXggPSBtYXRyaXg7CiAgICB0aGlzLmNvb3Jkc0FyciA9IGRpY3QuZ2V0QXJyYXkoIkNvb3JkcyIpOwogICAgdGhpcy5zaGFkaW5nVHlwZSA9IGRpY3QuZ2V0KCJTaGFkaW5nVHlwZSIpOwogICAgdGhpcy50eXBlID0gIlBhdHRlcm4iOwogICAgdmFyIGNzID0gZGljdC5nZXQoIkNvbG9yU3BhY2UiLCAiQ1MiKTsKICAgIGNzID0gX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5wYXJzZShjcywgeHJlZiwgcmVzLCBwZGZGdW5jdGlvbkZhY3RvcnkpOwogICAgdGhpcy5jcyA9IGNzOwogICAgdmFyIGJib3ggPSBkaWN0LmdldEFycmF5KCJCQm94Iik7CgogICAgaWYgKEFycmF5LmlzQXJyYXkoYmJveCkgJiYgYmJveC5sZW5ndGggPT09IDQpIHsKICAgICAgdGhpcy5iYm94ID0gX3V0aWwuVXRpbC5ub3JtYWxpemVSZWN0KGJib3gpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5iYm94ID0gbnVsbDsKICAgIH0KCiAgICB2YXIgdDAgPSAwLjAsCiAgICAgICAgdDEgPSAxLjA7CgogICAgaWYgKGRpY3QuaGFzKCJEb21haW4iKSkgewogICAgICB2YXIgZG9tYWluQXJyID0gZGljdC5nZXRBcnJheSgiRG9tYWluIik7CiAgICAgIHQwID0gZG9tYWluQXJyWzBdOwogICAgICB0MSA9IGRvbWFpbkFyclsxXTsKICAgIH0KCiAgICB2YXIgZXh0ZW5kU3RhcnQgPSBmYWxzZSwKICAgICAgICBleHRlbmRFbmQgPSBmYWxzZTsKCiAgICBpZiAoZGljdC5oYXMoIkV4dGVuZCIpKSB7CiAgICAgIHZhciBleHRlbmRBcnIgPSBkaWN0LmdldEFycmF5KCJFeHRlbmQiKTsKICAgICAgZXh0ZW5kU3RhcnQgPSBleHRlbmRBcnJbMF07CiAgICAgIGV4dGVuZEVuZCA9IGV4dGVuZEFyclsxXTsKICAgIH0KCiAgICBpZiAodGhpcy5zaGFkaW5nVHlwZSA9PT0gU2hhZGluZ1R5cGUuUkFESUFMICYmICghZXh0ZW5kU3RhcnQgfHwgIWV4dGVuZEVuZCkpIHsKICAgICAgdmFyIHgxID0gdGhpcy5jb29yZHNBcnJbMF07CiAgICAgIHZhciB5MSA9IHRoaXMuY29vcmRzQXJyWzFdOwogICAgICB2YXIgcjEgPSB0aGlzLmNvb3Jkc0FyclsyXTsKICAgICAgdmFyIHgyID0gdGhpcy5jb29yZHNBcnJbM107CiAgICAgIHZhciB5MiA9IHRoaXMuY29vcmRzQXJyWzRdOwogICAgICB2YXIgcjIgPSB0aGlzLmNvb3Jkc0Fycls1XTsKICAgICAgdmFyIGRpc3RhbmNlID0gTWF0aC5zcXJ0KCh4MSAtIHgyKSAqICh4MSAtIHgyKSArICh5MSAtIHkyKSAqICh5MSAtIHkyKSk7CgogICAgICBpZiAocjEgPD0gcjIgKyBkaXN0YW5jZSAmJiByMiA8PSByMSArIGRpc3RhbmNlKSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnN1cHBvcnRlZCByYWRpYWwgZ3JhZGllbnQuIik7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmV4dGVuZFN0YXJ0ID0gZXh0ZW5kU3RhcnQ7CiAgICB0aGlzLmV4dGVuZEVuZCA9IGV4dGVuZEVuZDsKICAgIHZhciBmbk9iaiA9IGRpY3QuZ2V0KCJGdW5jdGlvbiIpOwogICAgdmFyIGZuID0gcGRmRnVuY3Rpb25GYWN0b3J5LmNyZWF0ZUZyb21BcnJheShmbk9iaik7CiAgICB2YXIgTlVNQkVSX09GX1NBTVBMRVMgPSAxMDsKICAgIHZhciBzdGVwID0gKHQxIC0gdDApIC8gTlVNQkVSX09GX1NBTVBMRVM7CiAgICB2YXIgY29sb3JTdG9wcyA9IHRoaXMuY29sb3JTdG9wcyA9IFtdOwoKICAgIGlmICh0MCA+PSB0MSB8fCBzdGVwIDw9IDApIHsKICAgICAgKDAsIF91dGlsLmluZm8pKCJCYWQgc2hhZGluZyBkb21haW4uIik7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgY29sb3IgPSBuZXcgRmxvYXQzMkFycmF5KGNzLm51bUNvbXBzKSwKICAgICAgICByYXRpbyA9IG5ldyBGbG9hdDMyQXJyYXkoMSk7CiAgICB2YXIgcmdiQ29sb3I7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gTlVNQkVSX09GX1NBTVBMRVM7IGkrKykgewogICAgICByYXRpb1swXSA9IHQwICsgaSAqIHN0ZXA7CiAgICAgIGZuKHJhdGlvLCAwLCBjb2xvciwgMCk7CiAgICAgIHJnYkNvbG9yID0gY3MuZ2V0UmdiKGNvbG9yLCAwKTsKCiAgICAgIHZhciBjc3NDb2xvciA9IF91dGlsLlV0aWwubWFrZUNzc1JnYihyZ2JDb2xvclswXSwgcmdiQ29sb3JbMV0sIHJnYkNvbG9yWzJdKTsKCiAgICAgIGNvbG9yU3RvcHMucHVzaChbaSAvIE5VTUJFUl9PRl9TQU1QTEVTLCBjc3NDb2xvcl0pOwogICAgfQoKICAgIHZhciBiYWNrZ3JvdW5kID0gInRyYW5zcGFyZW50IjsKCiAgICBpZiAoZGljdC5oYXMoIkJhY2tncm91bmQiKSkgewogICAgICByZ2JDb2xvciA9IGNzLmdldFJnYihkaWN0LmdldCgiQmFja2dyb3VuZCIpLCAwKTsKICAgICAgYmFja2dyb3VuZCA9IF91dGlsLlV0aWwubWFrZUNzc1JnYihyZ2JDb2xvclswXSwgcmdiQ29sb3JbMV0sIHJnYkNvbG9yWzJdKTsKICAgIH0KCiAgICBpZiAoIWV4dGVuZFN0YXJ0KSB7CiAgICAgIGNvbG9yU3RvcHMudW5zaGlmdChbMCwgYmFja2dyb3VuZF0pOwogICAgICBjb2xvclN0b3BzWzFdWzBdICs9IFNoYWRpbmdzLlNNQUxMX05VTUJFUjsKICAgIH0KCiAgICBpZiAoIWV4dGVuZEVuZCkgewogICAgICBjb2xvclN0b3BzW2NvbG9yU3RvcHMubGVuZ3RoIC0gMV1bMF0gLT0gU2hhZGluZ3MuU01BTExfTlVNQkVSOwogICAgICBjb2xvclN0b3BzLnB1c2goWzEsIGJhY2tncm91bmRdKTsKICAgIH0KCiAgICB0aGlzLmNvbG9yU3RvcHMgPSBjb2xvclN0b3BzOwogIH0KCiAgUmFkaWFsQXhpYWwucHJvdG90eXBlID0gewogICAgZ2V0SVI6IGZ1bmN0aW9uIFJhZGlhbEF4aWFsX2dldElSKCkgewogICAgICB2YXIgY29vcmRzQXJyID0gdGhpcy5jb29yZHNBcnI7CiAgICAgIHZhciBzaGFkaW5nVHlwZSA9IHRoaXMuc2hhZGluZ1R5cGU7CiAgICAgIHZhciB0eXBlLCBwMCwgcDEsIHIwLCByMTsKCiAgICAgIGlmIChzaGFkaW5nVHlwZSA9PT0gU2hhZGluZ1R5cGUuQVhJQUwpIHsKICAgICAgICBwMCA9IFtjb29yZHNBcnJbMF0sIGNvb3Jkc0FyclsxXV07CiAgICAgICAgcDEgPSBbY29vcmRzQXJyWzJdLCBjb29yZHNBcnJbM11dOwogICAgICAgIHIwID0gbnVsbDsKICAgICAgICByMSA9IG51bGw7CiAgICAgICAgdHlwZSA9ICJheGlhbCI7CiAgICAgIH0gZWxzZSBpZiAoc2hhZGluZ1R5cGUgPT09IFNoYWRpbmdUeXBlLlJBRElBTCkgewogICAgICAgIHAwID0gW2Nvb3Jkc0FyclswXSwgY29vcmRzQXJyWzFdXTsKICAgICAgICBwMSA9IFtjb29yZHNBcnJbM10sIGNvb3Jkc0Fycls0XV07CiAgICAgICAgcjAgPSBjb29yZHNBcnJbMl07CiAgICAgICAgcjEgPSBjb29yZHNBcnJbNV07CiAgICAgICAgdHlwZSA9ICJyYWRpYWwiOwogICAgICB9IGVsc2UgewogICAgICAgICgwLCBfdXRpbC51bnJlYWNoYWJsZSkoImdldFBhdHRlcm4gdHlwZSB1bmtub3duOiAiLmNvbmNhdChzaGFkaW5nVHlwZSkpOwogICAgICB9CgogICAgICB2YXIgbWF0cml4ID0gdGhpcy5tYXRyaXg7CgogICAgICBpZiAobWF0cml4KSB7CiAgICAgICAgcDAgPSBfdXRpbC5VdGlsLmFwcGx5VHJhbnNmb3JtKHAwLCBtYXRyaXgpOwogICAgICAgIHAxID0gX3V0aWwuVXRpbC5hcHBseVRyYW5zZm9ybShwMSwgbWF0cml4KTsKCiAgICAgICAgaWYgKHNoYWRpbmdUeXBlID09PSBTaGFkaW5nVHlwZS5SQURJQUwpIHsKICAgICAgICAgIHZhciBzY2FsZSA9IF91dGlsLlV0aWwuc2luZ3VsYXJWYWx1ZURlY29tcG9zZTJkU2NhbGUobWF0cml4KTsKCiAgICAgICAgICByMCAqPSBzY2FsZVswXTsKICAgICAgICAgIHIxICo9IHNjYWxlWzFdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIFsiUmFkaWFsQXhpYWwiLCB0eXBlLCB0aGlzLmJib3gsIHRoaXMuY29sb3JTdG9wcywgcDAsIHAxLCByMCwgcjFdOwogICAgfQogIH07CiAgcmV0dXJuIFJhZGlhbEF4aWFsOwp9KCk7CgpTaGFkaW5ncy5NZXNoID0gZnVuY3Rpb24gTWVzaENsb3N1cmUoKSB7CiAgZnVuY3Rpb24gTWVzaFN0cmVhbVJlYWRlcihzdHJlYW0sIGNvbnRleHQpIHsKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDsKICAgIHRoaXMuYnVmZmVyID0gMDsKICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gMDsKICAgIHZhciBudW1Db21wcyA9IGNvbnRleHQubnVtQ29tcHM7CiAgICB0aGlzLnRtcENvbXBzQnVmID0gbmV3IEZsb2F0MzJBcnJheShudW1Db21wcyk7CiAgICB2YXIgY3NOdW1Db21wcyA9IGNvbnRleHQuY29sb3JTcGFjZS5udW1Db21wczsKICAgIHRoaXMudG1wQ3NDb21wc0J1ZiA9IGNvbnRleHQuY29sb3JGbiA/IG5ldyBGbG9hdDMyQXJyYXkoY3NOdW1Db21wcykgOiB0aGlzLnRtcENvbXBzQnVmOwogIH0KCiAgTWVzaFN0cmVhbVJlYWRlci5wcm90b3R5cGUgPSB7CiAgICBnZXQgaGFzRGF0YSgpIHsKICAgICAgaWYgKHRoaXMuc3RyZWFtLmVuZCkgewogICAgICAgIHJldHVybiB0aGlzLnN0cmVhbS5wb3MgPCB0aGlzLnN0cmVhbS5lbmQ7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmJ1ZmZlckxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgdmFyIG5leHRCeXRlID0gdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpOwoKICAgICAgaWYgKG5leHRCeXRlIDwgMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5idWZmZXIgPSBuZXh0Qnl0ZTsKICAgICAgdGhpcy5idWZmZXJMZW5ndGggPSA4OwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCgogICAgcmVhZEJpdHM6IGZ1bmN0aW9uIE1lc2hTdHJlYW1SZWFkZXJfcmVhZEJpdHMobikgewogICAgICB2YXIgYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICAgIHZhciBidWZmZXJMZW5ndGggPSB0aGlzLmJ1ZmZlckxlbmd0aDsKCiAgICAgIGlmIChuID09PSAzMikgewogICAgICAgIGlmIChidWZmZXJMZW5ndGggPT09IDApIHsKICAgICAgICAgIHJldHVybiAodGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpIDw8IDI0IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpIDw8IDE2IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpIDw8IDggfCB0aGlzLnN0cmVhbS5nZXRCeXRlKCkpID4+PiAwOwogICAgICAgIH0KCiAgICAgICAgYnVmZmVyID0gYnVmZmVyIDw8IDI0IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpIDw8IDE2IHwgdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpIDw8IDggfCB0aGlzLnN0cmVhbS5nZXRCeXRlKCk7CiAgICAgICAgdmFyIG5leHRCeXRlID0gdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpOwogICAgICAgIHRoaXMuYnVmZmVyID0gbmV4dEJ5dGUgJiAoMSA8PCBidWZmZXJMZW5ndGgpIC0gMTsKICAgICAgICByZXR1cm4gKGJ1ZmZlciA8PCA4IC0gYnVmZmVyTGVuZ3RoIHwgKG5leHRCeXRlICYgMHhmZikgPj4gYnVmZmVyTGVuZ3RoKSA+Pj4gMDsKICAgICAgfQoKICAgICAgaWYgKG4gPT09IDggJiYgYnVmZmVyTGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgfQoKICAgICAgd2hpbGUgKGJ1ZmZlckxlbmd0aCA8IG4pIHsKICAgICAgICBidWZmZXIgPSBidWZmZXIgPDwgOCB8IHRoaXMuc3RyZWFtLmdldEJ5dGUoKTsKICAgICAgICBidWZmZXJMZW5ndGggKz0gODsKICAgICAgfQoKICAgICAgYnVmZmVyTGVuZ3RoIC09IG47CiAgICAgIHRoaXMuYnVmZmVyTGVuZ3RoID0gYnVmZmVyTGVuZ3RoOwogICAgICB0aGlzLmJ1ZmZlciA9IGJ1ZmZlciAmICgxIDw8IGJ1ZmZlckxlbmd0aCkgLSAxOwogICAgICByZXR1cm4gYnVmZmVyID4+IGJ1ZmZlckxlbmd0aDsKICAgIH0sCiAgICBhbGlnbjogZnVuY3Rpb24gTWVzaFN0cmVhbVJlYWRlcl9hbGlnbigpIHsKICAgICAgdGhpcy5idWZmZXIgPSAwOwogICAgICB0aGlzLmJ1ZmZlckxlbmd0aCA9IDA7CiAgICB9LAogICAgcmVhZEZsYWc6IGZ1bmN0aW9uIE1lc2hTdHJlYW1SZWFkZXJfcmVhZEZsYWcoKSB7CiAgICAgIHJldHVybiB0aGlzLnJlYWRCaXRzKHRoaXMuY29udGV4dC5iaXRzUGVyRmxhZyk7CiAgICB9LAogICAgcmVhZENvb3JkaW5hdGU6IGZ1bmN0aW9uIE1lc2hTdHJlYW1SZWFkZXJfcmVhZENvb3JkaW5hdGUoKSB7CiAgICAgIHZhciBiaXRzUGVyQ29vcmRpbmF0ZSA9IHRoaXMuY29udGV4dC5iaXRzUGVyQ29vcmRpbmF0ZTsKICAgICAgdmFyIHhpID0gdGhpcy5yZWFkQml0cyhiaXRzUGVyQ29vcmRpbmF0ZSk7CiAgICAgIHZhciB5aSA9IHRoaXMucmVhZEJpdHMoYml0c1BlckNvb3JkaW5hdGUpOwogICAgICB2YXIgZGVjb2RlID0gdGhpcy5jb250ZXh0LmRlY29kZTsKICAgICAgdmFyIHNjYWxlID0gYml0c1BlckNvb3JkaW5hdGUgPCAzMiA/IDEgLyAoKDEgPDwgYml0c1BlckNvb3JkaW5hdGUpIC0gMSkgOiAyLjMyODMwNjQzNjUzODY5NjNlLTEwOwogICAgICByZXR1cm4gW3hpICogc2NhbGUgKiAoZGVjb2RlWzFdIC0gZGVjb2RlWzBdKSArIGRlY29kZVswXSwgeWkgKiBzY2FsZSAqIChkZWNvZGVbM10gLSBkZWNvZGVbMl0pICsgZGVjb2RlWzJdXTsKICAgIH0sCiAgICByZWFkQ29tcG9uZW50czogZnVuY3Rpb24gTWVzaFN0cmVhbVJlYWRlcl9yZWFkQ29tcG9uZW50cygpIHsKICAgICAgdmFyIG51bUNvbXBzID0gdGhpcy5jb250ZXh0Lm51bUNvbXBzOwogICAgICB2YXIgYml0c1BlckNvbXBvbmVudCA9IHRoaXMuY29udGV4dC5iaXRzUGVyQ29tcG9uZW50OwogICAgICB2YXIgc2NhbGUgPSBiaXRzUGVyQ29tcG9uZW50IDwgMzIgPyAxIC8gKCgxIDw8IGJpdHNQZXJDb21wb25lbnQpIC0gMSkgOiAyLjMyODMwNjQzNjUzODY5NjNlLTEwOwogICAgICB2YXIgZGVjb2RlID0gdGhpcy5jb250ZXh0LmRlY29kZTsKICAgICAgdmFyIGNvbXBvbmVudHMgPSB0aGlzLnRtcENvbXBzQnVmOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSA0OyBpIDwgbnVtQ29tcHM7IGkrKywgaiArPSAyKSB7CiAgICAgICAgdmFyIGNpID0gdGhpcy5yZWFkQml0cyhiaXRzUGVyQ29tcG9uZW50KTsKICAgICAgICBjb21wb25lbnRzW2ldID0gY2kgKiBzY2FsZSAqIChkZWNvZGVbaiArIDFdIC0gZGVjb2RlW2pdKSArIGRlY29kZVtqXTsKICAgICAgfQoKICAgICAgdmFyIGNvbG9yID0gdGhpcy50bXBDc0NvbXBzQnVmOwoKICAgICAgaWYgKHRoaXMuY29udGV4dC5jb2xvckZuKSB7CiAgICAgICAgdGhpcy5jb250ZXh0LmNvbG9yRm4oY29tcG9uZW50cywgMCwgY29sb3IsIDApOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5jb250ZXh0LmNvbG9yU3BhY2UuZ2V0UmdiKGNvbG9yLCAwKTsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBkZWNvZGVUeXBlNFNoYWRpbmcobWVzaCwgcmVhZGVyKSB7CiAgICB2YXIgY29vcmRzID0gbWVzaC5jb29yZHM7CiAgICB2YXIgY29sb3JzID0gbWVzaC5jb2xvcnM7CiAgICB2YXIgb3BlcmF0b3JzID0gW107CiAgICB2YXIgcHMgPSBbXTsKICAgIHZhciB2ZXJ0aWNlc0xlZnQgPSAwOwoKICAgIHdoaWxlIChyZWFkZXIuaGFzRGF0YSkgewogICAgICB2YXIgZiA9IHJlYWRlci5yZWFkRmxhZygpOwogICAgICB2YXIgY29vcmQgPSByZWFkZXIucmVhZENvb3JkaW5hdGUoKTsKICAgICAgdmFyIGNvbG9yID0gcmVhZGVyLnJlYWRDb21wb25lbnRzKCk7CgogICAgICBpZiAodmVydGljZXNMZWZ0ID09PSAwKSB7CiAgICAgICAgaWYgKCEoMCA8PSBmICYmIGYgPD0gMikpIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biB0eXBlNCBmbGFnIik7CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2ggKGYpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgdmVydGljZXNMZWZ0ID0gMzsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBwcy5wdXNoKHBzW3BzLmxlbmd0aCAtIDJdLCBwc1twcy5sZW5ndGggLSAxXSk7CiAgICAgICAgICAgIHZlcnRpY2VzTGVmdCA9IDE7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcHMucHVzaChwc1twcy5sZW5ndGggLSAzXSwgcHNbcHMubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICB2ZXJ0aWNlc0xlZnQgPSAxOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIG9wZXJhdG9ycy5wdXNoKGYpOwogICAgICB9CgogICAgICBwcy5wdXNoKGNvb3Jkcy5sZW5ndGgpOwogICAgICBjb29yZHMucHVzaChjb29yZCk7CiAgICAgIGNvbG9ycy5wdXNoKGNvbG9yKTsKICAgICAgdmVydGljZXNMZWZ0LS07CiAgICAgIHJlYWRlci5hbGlnbigpOwogICAgfQoKICAgIG1lc2guZmlndXJlcy5wdXNoKHsKICAgICAgdHlwZTogInRyaWFuZ2xlcyIsCiAgICAgIGNvb3JkczogbmV3IEludDMyQXJyYXkocHMpLAogICAgICBjb2xvcnM6IG5ldyBJbnQzMkFycmF5KHBzKQogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVUeXBlNVNoYWRpbmcobWVzaCwgcmVhZGVyLCB2ZXJ0aWNlc1BlclJvdykgewogICAgdmFyIGNvb3JkcyA9IG1lc2guY29vcmRzOwogICAgdmFyIGNvbG9ycyA9IG1lc2guY29sb3JzOwogICAgdmFyIHBzID0gW107CgogICAgd2hpbGUgKHJlYWRlci5oYXNEYXRhKSB7CiAgICAgIHZhciBjb29yZCA9IHJlYWRlci5yZWFkQ29vcmRpbmF0ZSgpOwogICAgICB2YXIgY29sb3IgPSByZWFkZXIucmVhZENvbXBvbmVudHMoKTsKICAgICAgcHMucHVzaChjb29yZHMubGVuZ3RoKTsKICAgICAgY29vcmRzLnB1c2goY29vcmQpOwogICAgICBjb2xvcnMucHVzaChjb2xvcik7CiAgICB9CgogICAgbWVzaC5maWd1cmVzLnB1c2goewogICAgICB0eXBlOiAibGF0dGljZSIsCiAgICAgIGNvb3JkczogbmV3IEludDMyQXJyYXkocHMpLAogICAgICBjb2xvcnM6IG5ldyBJbnQzMkFycmF5KHBzKSwKICAgICAgdmVydGljZXNQZXJSb3c6IHZlcnRpY2VzUGVyUm93CiAgICB9KTsKICB9CgogIHZhciBNSU5fU1BMSVRfUEFUQ0hfQ0hVTktTX0FNT1VOVCA9IDM7CiAgdmFyIE1BWF9TUExJVF9QQVRDSF9DSFVOS1NfQU1PVU5UID0gMjA7CiAgdmFyIFRSSUFOR0xFX0RFTlNJVFkgPSAyMDsKCiAgdmFyIGdldEIgPSBmdW5jdGlvbiBnZXRCQ2xvc3VyZSgpIHsKICAgIGZ1bmN0aW9uIGJ1aWxkQihjb3VudCkgewogICAgICB2YXIgbHV0ID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBjb3VudDsgaSsrKSB7CiAgICAgICAgdmFyIHQgPSBpIC8gY291bnQsCiAgICAgICAgICAgIHRfID0gMSAtIHQ7CiAgICAgICAgbHV0LnB1c2gobmV3IEZsb2F0MzJBcnJheShbdF8gKiB0XyAqIHRfLCAzICogdCAqIHRfICogdF8sIDMgKiB0ICogdCAqIHRfLCB0ICogdCAqIHRdKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBsdXQ7CiAgICB9CgogICAgdmFyIGNhY2hlID0gW107CiAgICByZXR1cm4gZnVuY3Rpb24gZ2V0Qihjb3VudCkgewogICAgICBpZiAoIWNhY2hlW2NvdW50XSkgewogICAgICAgIGNhY2hlW2NvdW50XSA9IGJ1aWxkQihjb3VudCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjYWNoZVtjb3VudF07CiAgICB9OwogIH0oKTsKCiAgZnVuY3Rpb24gYnVpbGRGaWd1cmVGcm9tUGF0Y2gobWVzaCwgaW5kZXgpIHsKICAgIHZhciBmaWd1cmUgPSBtZXNoLmZpZ3VyZXNbaW5kZXhdOwogICAgKDAsIF91dGlsLmFzc2VydCkoZmlndXJlLnR5cGUgPT09ICJwYXRjaCIsICJVbmV4cGVjdGVkIHBhdGNoIG1lc2ggZmlndXJlIik7CiAgICB2YXIgY29vcmRzID0gbWVzaC5jb29yZHMsCiAgICAgICAgY29sb3JzID0gbWVzaC5jb2xvcnM7CiAgICB2YXIgcGkgPSBmaWd1cmUuY29vcmRzOwogICAgdmFyIGNpID0gZmlndXJlLmNvbG9yczsKICAgIHZhciBmaWd1cmVNaW5YID0gTWF0aC5taW4oY29vcmRzW3BpWzBdXVswXSwgY29vcmRzW3BpWzNdXVswXSwgY29vcmRzW3BpWzEyXV1bMF0sIGNvb3Jkc1twaVsxNV1dWzBdKTsKICAgIHZhciBmaWd1cmVNaW5ZID0gTWF0aC5taW4oY29vcmRzW3BpWzBdXVsxXSwgY29vcmRzW3BpWzNdXVsxXSwgY29vcmRzW3BpWzEyXV1bMV0sIGNvb3Jkc1twaVsxNV1dWzFdKTsKICAgIHZhciBmaWd1cmVNYXhYID0gTWF0aC5tYXgoY29vcmRzW3BpWzBdXVswXSwgY29vcmRzW3BpWzNdXVswXSwgY29vcmRzW3BpWzEyXV1bMF0sIGNvb3Jkc1twaVsxNV1dWzBdKTsKICAgIHZhciBmaWd1cmVNYXhZID0gTWF0aC5tYXgoY29vcmRzW3BpWzBdXVsxXSwgY29vcmRzW3BpWzNdXVsxXSwgY29vcmRzW3BpWzEyXV1bMV0sIGNvb3Jkc1twaVsxNV1dWzFdKTsKICAgIHZhciBzcGxpdFhCeSA9IE1hdGguY2VpbCgoZmlndXJlTWF4WCAtIGZpZ3VyZU1pblgpICogVFJJQU5HTEVfREVOU0lUWSAvIChtZXNoLmJvdW5kc1syXSAtIG1lc2guYm91bmRzWzBdKSk7CiAgICBzcGxpdFhCeSA9IE1hdGgubWF4KE1JTl9TUExJVF9QQVRDSF9DSFVOS1NfQU1PVU5ULCBNYXRoLm1pbihNQVhfU1BMSVRfUEFUQ0hfQ0hVTktTX0FNT1VOVCwgc3BsaXRYQnkpKTsKICAgIHZhciBzcGxpdFlCeSA9IE1hdGguY2VpbCgoZmlndXJlTWF4WSAtIGZpZ3VyZU1pblkpICogVFJJQU5HTEVfREVOU0lUWSAvIChtZXNoLmJvdW5kc1szXSAtIG1lc2guYm91bmRzWzFdKSk7CiAgICBzcGxpdFlCeSA9IE1hdGgubWF4KE1JTl9TUExJVF9QQVRDSF9DSFVOS1NfQU1PVU5ULCBNYXRoLm1pbihNQVhfU1BMSVRfUEFUQ0hfQ0hVTktTX0FNT1VOVCwgc3BsaXRZQnkpKTsKICAgIHZhciB2ZXJ0aWNlc1BlclJvdyA9IHNwbGl0WEJ5ICsgMTsKICAgIHZhciBmaWd1cmVDb29yZHMgPSBuZXcgSW50MzJBcnJheSgoc3BsaXRZQnkgKyAxKSAqIHZlcnRpY2VzUGVyUm93KTsKICAgIHZhciBmaWd1cmVDb2xvcnMgPSBuZXcgSW50MzJBcnJheSgoc3BsaXRZQnkgKyAxKSAqIHZlcnRpY2VzUGVyUm93KTsKICAgIHZhciBrID0gMDsKICAgIHZhciBjbCA9IG5ldyBVaW50OEFycmF5KDMpLAogICAgICAgIGNyID0gbmV3IFVpbnQ4QXJyYXkoMyk7CiAgICB2YXIgYzAgPSBjb2xvcnNbY2lbMF1dLAogICAgICAgIGMxID0gY29sb3JzW2NpWzFdXSwKICAgICAgICBjMiA9IGNvbG9yc1tjaVsyXV0sCiAgICAgICAgYzMgPSBjb2xvcnNbY2lbM11dOwogICAgdmFyIGJSb3cgPSBnZXRCKHNwbGl0WUJ5KSwKICAgICAgICBiQ29sID0gZ2V0QihzcGxpdFhCeSk7CgogICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDw9IHNwbGl0WUJ5OyByb3crKykgewogICAgICBjbFswXSA9IChjMFswXSAqIChzcGxpdFlCeSAtIHJvdykgKyBjMlswXSAqIHJvdykgLyBzcGxpdFlCeSB8IDA7CiAgICAgIGNsWzFdID0gKGMwWzFdICogKHNwbGl0WUJ5IC0gcm93KSArIGMyWzFdICogcm93KSAvIHNwbGl0WUJ5IHwgMDsKICAgICAgY2xbMl0gPSAoYzBbMl0gKiAoc3BsaXRZQnkgLSByb3cpICsgYzJbMl0gKiByb3cpIC8gc3BsaXRZQnkgfCAwOwogICAgICBjclswXSA9IChjMVswXSAqIChzcGxpdFlCeSAtIHJvdykgKyBjM1swXSAqIHJvdykgLyBzcGxpdFlCeSB8IDA7CiAgICAgIGNyWzFdID0gKGMxWzFdICogKHNwbGl0WUJ5IC0gcm93KSArIGMzWzFdICogcm93KSAvIHNwbGl0WUJ5IHwgMDsKICAgICAgY3JbMl0gPSAoYzFbMl0gKiAoc3BsaXRZQnkgLSByb3cpICsgYzNbMl0gKiByb3cpIC8gc3BsaXRZQnkgfCAwOwoKICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDw9IHNwbGl0WEJ5OyBjb2wrKywgaysrKSB7CiAgICAgICAgaWYgKChyb3cgPT09IDAgfHwgcm93ID09PSBzcGxpdFlCeSkgJiYgKGNvbCA9PT0gMCB8fCBjb2wgPT09IHNwbGl0WEJ5KSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgeCA9IDAsCiAgICAgICAgICAgIHkgPSAwOwogICAgICAgIHZhciBxID0gMDsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gMzsgaSsrKSB7CiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8PSAzOyBqKyssIHErKykgewogICAgICAgICAgICB2YXIgbSA9IGJSb3dbcm93XVtpXSAqIGJDb2xbY29sXVtqXTsKICAgICAgICAgICAgeCArPSBjb29yZHNbcGlbcV1dWzBdICogbTsKICAgICAgICAgICAgeSArPSBjb29yZHNbcGlbcV1dWzFdICogbTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZpZ3VyZUNvb3Jkc1trXSA9IGNvb3Jkcy5sZW5ndGg7CiAgICAgICAgY29vcmRzLnB1c2goW3gsIHldKTsKICAgICAgICBmaWd1cmVDb2xvcnNba10gPSBjb2xvcnMubGVuZ3RoOwogICAgICAgIHZhciBuZXdDb2xvciA9IG5ldyBVaW50OEFycmF5KDMpOwogICAgICAgIG5ld0NvbG9yWzBdID0gKGNsWzBdICogKHNwbGl0WEJ5IC0gY29sKSArIGNyWzBdICogY29sKSAvIHNwbGl0WEJ5IHwgMDsKICAgICAgICBuZXdDb2xvclsxXSA9IChjbFsxXSAqIChzcGxpdFhCeSAtIGNvbCkgKyBjclsxXSAqIGNvbCkgLyBzcGxpdFhCeSB8IDA7CiAgICAgICAgbmV3Q29sb3JbMl0gPSAoY2xbMl0gKiAoc3BsaXRYQnkgLSBjb2wpICsgY3JbMl0gKiBjb2wpIC8gc3BsaXRYQnkgfCAwOwogICAgICAgIGNvbG9ycy5wdXNoKG5ld0NvbG9yKTsKICAgICAgfQogICAgfQoKICAgIGZpZ3VyZUNvb3Jkc1swXSA9IHBpWzBdOwogICAgZmlndXJlQ29sb3JzWzBdID0gY2lbMF07CiAgICBmaWd1cmVDb29yZHNbc3BsaXRYQnldID0gcGlbM107CiAgICBmaWd1cmVDb2xvcnNbc3BsaXRYQnldID0gY2lbMV07CiAgICBmaWd1cmVDb29yZHNbdmVydGljZXNQZXJSb3cgKiBzcGxpdFlCeV0gPSBwaVsxMl07CiAgICBmaWd1cmVDb2xvcnNbdmVydGljZXNQZXJSb3cgKiBzcGxpdFlCeV0gPSBjaVsyXTsKICAgIGZpZ3VyZUNvb3Jkc1t2ZXJ0aWNlc1BlclJvdyAqIHNwbGl0WUJ5ICsgc3BsaXRYQnldID0gcGlbMTVdOwogICAgZmlndXJlQ29sb3JzW3ZlcnRpY2VzUGVyUm93ICogc3BsaXRZQnkgKyBzcGxpdFhCeV0gPSBjaVszXTsKICAgIG1lc2guZmlndXJlc1tpbmRleF0gPSB7CiAgICAgIHR5cGU6ICJsYXR0aWNlIiwKICAgICAgY29vcmRzOiBmaWd1cmVDb29yZHMsCiAgICAgIGNvbG9yczogZmlndXJlQ29sb3JzLAogICAgICB2ZXJ0aWNlc1BlclJvdzogdmVydGljZXNQZXJSb3cKICAgIH07CiAgfQoKICBmdW5jdGlvbiBkZWNvZGVUeXBlNlNoYWRpbmcobWVzaCwgcmVhZGVyKSB7CiAgICB2YXIgY29vcmRzID0gbWVzaC5jb29yZHM7CiAgICB2YXIgY29sb3JzID0gbWVzaC5jb2xvcnM7CiAgICB2YXIgcHMgPSBuZXcgSW50MzJBcnJheSgxNik7CiAgICB2YXIgY3MgPSBuZXcgSW50MzJBcnJheSg0KTsKCiAgICB3aGlsZSAocmVhZGVyLmhhc0RhdGEpIHsKICAgICAgdmFyIGYgPSByZWFkZXIucmVhZEZsYWcoKTsKCiAgICAgIGlmICghKDAgPD0gZiAmJiBmIDw9IDMpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIHR5cGU2IGZsYWciKTsKICAgICAgfQoKICAgICAgdmFyIGksIGlpOwogICAgICB2YXIgcGkgPSBjb29yZHMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSBmICE9PSAwID8gOCA6IDEyOyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvb3Jkcy5wdXNoKHJlYWRlci5yZWFkQ29vcmRpbmF0ZSgpKTsKICAgICAgfQoKICAgICAgdmFyIGNpID0gY29sb3JzLmxlbmd0aDsKCiAgICAgIGZvciAoaSA9IDAsIGlpID0gZiAhPT0gMCA/IDIgOiA0OyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbG9ycy5wdXNoKHJlYWRlci5yZWFkQ29tcG9uZW50cygpKTsKICAgICAgfQoKICAgICAgdmFyIHRtcDEsIHRtcDIsIHRtcDMsIHRtcDQ7CgogICAgICBzd2l0Y2ggKGYpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBwc1sxMl0gPSBwaSArIDM7CiAgICAgICAgICBwc1sxM10gPSBwaSArIDQ7CiAgICAgICAgICBwc1sxNF0gPSBwaSArIDU7CiAgICAgICAgICBwc1sxNV0gPSBwaSArIDY7CiAgICAgICAgICBwc1s4XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzExXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzRdID0gcGkgKyAxOwogICAgICAgICAgcHNbN10gPSBwaSArIDg7CiAgICAgICAgICBwc1swXSA9IHBpOwogICAgICAgICAgcHNbMV0gPSBwaSArIDExOwogICAgICAgICAgcHNbMl0gPSBwaSArIDEwOwogICAgICAgICAgcHNbM10gPSBwaSArIDk7CiAgICAgICAgICBjc1syXSA9IGNpICsgMTsKICAgICAgICAgIGNzWzNdID0gY2kgKyAyOwogICAgICAgICAgY3NbMF0gPSBjaTsKICAgICAgICAgIGNzWzFdID0gY2kgKyAzOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRtcDEgPSBwc1sxMl07CiAgICAgICAgICB0bXAyID0gcHNbMTNdOwogICAgICAgICAgdG1wMyA9IHBzWzE0XTsKICAgICAgICAgIHRtcDQgPSBwc1sxNV07CiAgICAgICAgICBwc1sxMl0gPSB0bXA0OwogICAgICAgICAgcHNbMTNdID0gcGkgKyAwOwogICAgICAgICAgcHNbMTRdID0gcGkgKyAxOwogICAgICAgICAgcHNbMTVdID0gcGkgKyAyOwogICAgICAgICAgcHNbOF0gPSB0bXAzOwogICAgICAgICAgcHNbMTFdID0gcGkgKyAzOwogICAgICAgICAgcHNbNF0gPSB0bXAyOwogICAgICAgICAgcHNbN10gPSBwaSArIDQ7CiAgICAgICAgICBwc1swXSA9IHRtcDE7CiAgICAgICAgICBwc1sxXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzJdID0gcGkgKyA2OwogICAgICAgICAgcHNbM10gPSBwaSArIDU7CiAgICAgICAgICB0bXAxID0gY3NbMl07CiAgICAgICAgICB0bXAyID0gY3NbM107CiAgICAgICAgICBjc1syXSA9IHRtcDI7CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSB0bXAxOwogICAgICAgICAgY3NbMV0gPSBjaSArIDE7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgdG1wMSA9IHBzWzE1XTsKICAgICAgICAgIHRtcDIgPSBwc1sxMV07CiAgICAgICAgICBwc1sxMl0gPSBwc1szXTsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gcHNbN107CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDM7CiAgICAgICAgICBwc1s0XSA9IHRtcDI7CiAgICAgICAgICBwc1s3XSA9IHBpICsgNDsKICAgICAgICAgIHBzWzBdID0gdG1wMTsKICAgICAgICAgIHBzWzFdID0gcGkgKyA3OwogICAgICAgICAgcHNbMl0gPSBwaSArIDY7CiAgICAgICAgICBwc1szXSA9IHBpICsgNTsKICAgICAgICAgIHRtcDEgPSBjc1szXTsKICAgICAgICAgIGNzWzJdID0gY3NbMV07CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSB0bXAxOwogICAgICAgICAgY3NbMV0gPSBjaSArIDE7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcHNbMTJdID0gcHNbMF07CiAgICAgICAgICBwc1sxM10gPSBwaSArIDA7CiAgICAgICAgICBwc1sxNF0gPSBwaSArIDE7CiAgICAgICAgICBwc1sxNV0gPSBwaSArIDI7CiAgICAgICAgICBwc1s4XSA9IHBzWzFdOwogICAgICAgICAgcHNbMTFdID0gcGkgKyAzOwogICAgICAgICAgcHNbNF0gPSBwc1syXTsKICAgICAgICAgIHBzWzddID0gcGkgKyA0OwogICAgICAgICAgcHNbMF0gPSBwc1szXTsKICAgICAgICAgIHBzWzFdID0gcGkgKyA3OwogICAgICAgICAgcHNbMl0gPSBwaSArIDY7CiAgICAgICAgICBwc1szXSA9IHBpICsgNTsKICAgICAgICAgIGNzWzJdID0gY3NbMF07CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSBjc1sxXTsKICAgICAgICAgIGNzWzFdID0gY2kgKyAxOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHBzWzVdID0gY29vcmRzLmxlbmd0aDsKICAgICAgY29vcmRzLnB1c2goWygtNCAqIGNvb3Jkc1twc1swXV1bMF0gLSBjb29yZHNbcHNbMTVdXVswXSArIDYgKiAoY29vcmRzW3BzWzRdXVswXSArIGNvb3Jkc1twc1sxXV1bMF0pIC0gMiAqIChjb29yZHNbcHNbMTJdXVswXSArIGNvb3Jkc1twc1szXV1bMF0pICsgMyAqIChjb29yZHNbcHNbMTNdXVswXSArIGNvb3Jkc1twc1s3XV1bMF0pKSAvIDksICgtNCAqIGNvb3Jkc1twc1swXV1bMV0gLSBjb29yZHNbcHNbMTVdXVsxXSArIDYgKiAoY29vcmRzW3BzWzRdXVsxXSArIGNvb3Jkc1twc1sxXV1bMV0pIC0gMiAqIChjb29yZHNbcHNbMTJdXVsxXSArIGNvb3Jkc1twc1szXV1bMV0pICsgMyAqIChjb29yZHNbcHNbMTNdXVsxXSArIGNvb3Jkc1twc1s3XV1bMV0pKSAvIDldKTsKICAgICAgcHNbNl0gPSBjb29yZHMubGVuZ3RoOwogICAgICBjb29yZHMucHVzaChbKC00ICogY29vcmRzW3BzWzNdXVswXSAtIGNvb3Jkc1twc1sxMl1dWzBdICsgNiAqIChjb29yZHNbcHNbMl1dWzBdICsgY29vcmRzW3BzWzddXVswXSkgLSAyICogKGNvb3Jkc1twc1swXV1bMF0gKyBjb29yZHNbcHNbMTVdXVswXSkgKyAzICogKGNvb3Jkc1twc1s0XV1bMF0gKyBjb29yZHNbcHNbMTRdXVswXSkpIC8gOSwgKC00ICogY29vcmRzW3BzWzNdXVsxXSAtIGNvb3Jkc1twc1sxMl1dWzFdICsgNiAqIChjb29yZHNbcHNbMl1dWzFdICsgY29vcmRzW3BzWzddXVsxXSkgLSAyICogKGNvb3Jkc1twc1swXV1bMV0gKyBjb29yZHNbcHNbMTVdXVsxXSkgKyAzICogKGNvb3Jkc1twc1s0XV1bMV0gKyBjb29yZHNbcHNbMTRdXVsxXSkpIC8gOV0pOwogICAgICBwc1s5XSA9IGNvb3Jkcy5sZW5ndGg7CiAgICAgIGNvb3Jkcy5wdXNoKFsoLTQgKiBjb29yZHNbcHNbMTJdXVswXSAtIGNvb3Jkc1twc1szXV1bMF0gKyA2ICogKGNvb3Jkc1twc1s4XV1bMF0gKyBjb29yZHNbcHNbMTNdXVswXSkgLSAyICogKGNvb3Jkc1twc1swXV1bMF0gKyBjb29yZHNbcHNbMTVdXVswXSkgKyAzICogKGNvb3Jkc1twc1sxMV1dWzBdICsgY29vcmRzW3BzWzFdXVswXSkpIC8gOSwgKC00ICogY29vcmRzW3BzWzEyXV1bMV0gLSBjb29yZHNbcHNbM11dWzFdICsgNiAqIChjb29yZHNbcHNbOF1dWzFdICsgY29vcmRzW3BzWzEzXV1bMV0pIC0gMiAqIChjb29yZHNbcHNbMF1dWzFdICsgY29vcmRzW3BzWzE1XV1bMV0pICsgMyAqIChjb29yZHNbcHNbMTFdXVsxXSArIGNvb3Jkc1twc1sxXV1bMV0pKSAvIDldKTsKICAgICAgcHNbMTBdID0gY29vcmRzLmxlbmd0aDsKICAgICAgY29vcmRzLnB1c2goWygtNCAqIGNvb3Jkc1twc1sxNV1dWzBdIC0gY29vcmRzW3BzWzBdXVswXSArIDYgKiAoY29vcmRzW3BzWzExXV1bMF0gKyBjb29yZHNbcHNbMTRdXVswXSkgLSAyICogKGNvb3Jkc1twc1sxMl1dWzBdICsgY29vcmRzW3BzWzNdXVswXSkgKyAzICogKGNvb3Jkc1twc1syXV1bMF0gKyBjb29yZHNbcHNbOF1dWzBdKSkgLyA5LCAoLTQgKiBjb29yZHNbcHNbMTVdXVsxXSAtIGNvb3Jkc1twc1swXV1bMV0gKyA2ICogKGNvb3Jkc1twc1sxMV1dWzFdICsgY29vcmRzW3BzWzE0XV1bMV0pIC0gMiAqIChjb29yZHNbcHNbMTJdXVsxXSArIGNvb3Jkc1twc1szXV1bMV0pICsgMyAqIChjb29yZHNbcHNbMl1dWzFdICsgY29vcmRzW3BzWzhdXVsxXSkpIC8gOV0pOwogICAgICBtZXNoLmZpZ3VyZXMucHVzaCh7CiAgICAgICAgdHlwZTogInBhdGNoIiwKICAgICAgICBjb29yZHM6IG5ldyBJbnQzMkFycmF5KHBzKSwKICAgICAgICBjb2xvcnM6IG5ldyBJbnQzMkFycmF5KGNzKQogICAgICB9KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGRlY29kZVR5cGU3U2hhZGluZyhtZXNoLCByZWFkZXIpIHsKICAgIHZhciBjb29yZHMgPSBtZXNoLmNvb3JkczsKICAgIHZhciBjb2xvcnMgPSBtZXNoLmNvbG9yczsKICAgIHZhciBwcyA9IG5ldyBJbnQzMkFycmF5KDE2KTsKICAgIHZhciBjcyA9IG5ldyBJbnQzMkFycmF5KDQpOwoKICAgIHdoaWxlIChyZWFkZXIuaGFzRGF0YSkgewogICAgICB2YXIgZiA9IHJlYWRlci5yZWFkRmxhZygpOwoKICAgICAgaWYgKCEoMCA8PSBmICYmIGYgPD0gMykpIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gdHlwZTcgZmxhZyIpOwogICAgICB9CgogICAgICB2YXIgaSwgaWk7CiAgICAgIHZhciBwaSA9IGNvb3Jkcy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwLCBpaSA9IGYgIT09IDAgPyAxMiA6IDE2OyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvb3Jkcy5wdXNoKHJlYWRlci5yZWFkQ29vcmRpbmF0ZSgpKTsKICAgICAgfQoKICAgICAgdmFyIGNpID0gY29sb3JzLmxlbmd0aDsKCiAgICAgIGZvciAoaSA9IDAsIGlpID0gZiAhPT0gMCA/IDIgOiA0OyBpIDwgaWk7IGkrKykgewogICAgICAgIGNvbG9ycy5wdXNoKHJlYWRlci5yZWFkQ29tcG9uZW50cygpKTsKICAgICAgfQoKICAgICAgdmFyIHRtcDEsIHRtcDIsIHRtcDMsIHRtcDQ7CgogICAgICBzd2l0Y2ggKGYpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBwc1sxMl0gPSBwaSArIDM7CiAgICAgICAgICBwc1sxM10gPSBwaSArIDQ7CiAgICAgICAgICBwc1sxNF0gPSBwaSArIDU7CiAgICAgICAgICBwc1sxNV0gPSBwaSArIDY7CiAgICAgICAgICBwc1s4XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzldID0gcGkgKyAxMzsKICAgICAgICAgIHBzWzEwXSA9IHBpICsgMTQ7CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDc7CiAgICAgICAgICBwc1s0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzVdID0gcGkgKyAxMjsKICAgICAgICAgIHBzWzZdID0gcGkgKyAxNTsKICAgICAgICAgIHBzWzddID0gcGkgKyA4OwogICAgICAgICAgcHNbMF0gPSBwaTsKICAgICAgICAgIHBzWzFdID0gcGkgKyAxMTsKICAgICAgICAgIHBzWzJdID0gcGkgKyAxMDsKICAgICAgICAgIHBzWzNdID0gcGkgKyA5OwogICAgICAgICAgY3NbMl0gPSBjaSArIDE7CiAgICAgICAgICBjc1szXSA9IGNpICsgMjsKICAgICAgICAgIGNzWzBdID0gY2k7CiAgICAgICAgICBjc1sxXSA9IGNpICsgMzsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICB0bXAxID0gcHNbMTJdOwogICAgICAgICAgdG1wMiA9IHBzWzEzXTsKICAgICAgICAgIHRtcDMgPSBwc1sxNF07CiAgICAgICAgICB0bXA0ID0gcHNbMTVdOwogICAgICAgICAgcHNbMTJdID0gdG1wNDsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gdG1wMzsKICAgICAgICAgIHBzWzldID0gcGkgKyA5OwogICAgICAgICAgcHNbMTBdID0gcGkgKyAxMDsKICAgICAgICAgIHBzWzExXSA9IHBpICsgMzsKICAgICAgICAgIHBzWzRdID0gdG1wMjsKICAgICAgICAgIHBzWzVdID0gcGkgKyA4OwogICAgICAgICAgcHNbNl0gPSBwaSArIDExOwogICAgICAgICAgcHNbN10gPSBwaSArIDQ7CiAgICAgICAgICBwc1swXSA9IHRtcDE7CiAgICAgICAgICBwc1sxXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzJdID0gcGkgKyA2OwogICAgICAgICAgcHNbM10gPSBwaSArIDU7CiAgICAgICAgICB0bXAxID0gY3NbMl07CiAgICAgICAgICB0bXAyID0gY3NbM107CiAgICAgICAgICBjc1syXSA9IHRtcDI7CiAgICAgICAgICBjc1szXSA9IGNpOwogICAgICAgICAgY3NbMF0gPSB0bXAxOwogICAgICAgICAgY3NbMV0gPSBjaSArIDE7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyOgogICAgICAgICAgdG1wMSA9IHBzWzE1XTsKICAgICAgICAgIHRtcDIgPSBwc1sxMV07CiAgICAgICAgICBwc1sxMl0gPSBwc1szXTsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gcHNbN107CiAgICAgICAgICBwc1s5XSA9IHBpICsgOTsKICAgICAgICAgIHBzWzEwXSA9IHBpICsgMTA7CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDM7CiAgICAgICAgICBwc1s0XSA9IHRtcDI7CiAgICAgICAgICBwc1s1XSA9IHBpICsgODsKICAgICAgICAgIHBzWzZdID0gcGkgKyAxMTsKICAgICAgICAgIHBzWzddID0gcGkgKyA0OwogICAgICAgICAgcHNbMF0gPSB0bXAxOwogICAgICAgICAgcHNbMV0gPSBwaSArIDc7CiAgICAgICAgICBwc1syXSA9IHBpICsgNjsKICAgICAgICAgIHBzWzNdID0gcGkgKyA1OwogICAgICAgICAgdG1wMSA9IGNzWzNdOwogICAgICAgICAgY3NbMl0gPSBjc1sxXTsKICAgICAgICAgIGNzWzNdID0gY2k7CiAgICAgICAgICBjc1swXSA9IHRtcDE7CiAgICAgICAgICBjc1sxXSA9IGNpICsgMTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBwc1sxMl0gPSBwc1swXTsKICAgICAgICAgIHBzWzEzXSA9IHBpICsgMDsKICAgICAgICAgIHBzWzE0XSA9IHBpICsgMTsKICAgICAgICAgIHBzWzE1XSA9IHBpICsgMjsKICAgICAgICAgIHBzWzhdID0gcHNbMV07CiAgICAgICAgICBwc1s5XSA9IHBpICsgOTsKICAgICAgICAgIHBzWzEwXSA9IHBpICsgMTA7CiAgICAgICAgICBwc1sxMV0gPSBwaSArIDM7CiAgICAgICAgICBwc1s0XSA9IHBzWzJdOwogICAgICAgICAgcHNbNV0gPSBwaSArIDg7CiAgICAgICAgICBwc1s2XSA9IHBpICsgMTE7CiAgICAgICAgICBwc1s3XSA9IHBpICsgNDsKICAgICAgICAgIHBzWzBdID0gcHNbM107CiAgICAgICAgICBwc1sxXSA9IHBpICsgNzsKICAgICAgICAgIHBzWzJdID0gcGkgKyA2OwogICAgICAgICAgcHNbM10gPSBwaSArIDU7CiAgICAgICAgICBjc1syXSA9IGNzWzBdOwogICAgICAgICAgY3NbM10gPSBjaTsKICAgICAgICAgIGNzWzBdID0gY3NbMV07CiAgICAgICAgICBjc1sxXSA9IGNpICsgMTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICBtZXNoLmZpZ3VyZXMucHVzaCh7CiAgICAgICAgdHlwZTogInBhdGNoIiwKICAgICAgICBjb29yZHM6IG5ldyBJbnQzMkFycmF5KHBzKSwKICAgICAgICBjb2xvcnM6IG5ldyBJbnQzMkFycmF5KGNzKQogICAgICB9KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHVwZGF0ZUJvdW5kcyhtZXNoKSB7CiAgICB2YXIgbWluWCA9IG1lc2guY29vcmRzWzBdWzBdLAogICAgICAgIG1pblkgPSBtZXNoLmNvb3Jkc1swXVsxXSwKICAgICAgICBtYXhYID0gbWluWCwKICAgICAgICBtYXhZID0gbWluWTsKCiAgICBmb3IgKHZhciBpID0gMSwgaWkgPSBtZXNoLmNvb3Jkcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHZhciB4ID0gbWVzaC5jb29yZHNbaV1bMF0sCiAgICAgICAgICB5ID0gbWVzaC5jb29yZHNbaV1bMV07CiAgICAgIG1pblggPSBtaW5YID4geCA/IHggOiBtaW5YOwogICAgICBtaW5ZID0gbWluWSA+IHkgPyB5IDogbWluWTsKICAgICAgbWF4WCA9IG1heFggPCB4ID8geCA6IG1heFg7CiAgICAgIG1heFkgPSBtYXhZIDwgeSA/IHkgOiBtYXhZOwogICAgfQoKICAgIG1lc2guYm91bmRzID0gW21pblgsIG1pblksIG1heFgsIG1heFldOwogIH0KCiAgZnVuY3Rpb24gcGFja0RhdGEobWVzaCkgewogICAgdmFyIGksIGlpLCBqLCBqajsKICAgIHZhciBjb29yZHMgPSBtZXNoLmNvb3JkczsKICAgIHZhciBjb29yZHNQYWNrZWQgPSBuZXcgRmxvYXQzMkFycmF5KGNvb3Jkcy5sZW5ndGggKiAyKTsKCiAgICBmb3IgKGkgPSAwLCBqID0gMCwgaWkgPSBjb29yZHMubGVuZ3RoOyBpIDwgaWk7IGkrKykgewogICAgICB2YXIgeHkgPSBjb29yZHNbaV07CiAgICAgIGNvb3Jkc1BhY2tlZFtqKytdID0geHlbMF07CiAgICAgIGNvb3Jkc1BhY2tlZFtqKytdID0geHlbMV07CiAgICB9CgogICAgbWVzaC5jb29yZHMgPSBjb29yZHNQYWNrZWQ7CiAgICB2YXIgY29sb3JzID0gbWVzaC5jb2xvcnM7CiAgICB2YXIgY29sb3JzUGFja2VkID0gbmV3IFVpbnQ4QXJyYXkoY29sb3JzLmxlbmd0aCAqIDMpOwoKICAgIGZvciAoaSA9IDAsIGogPSAwLCBpaSA9IGNvbG9ycy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgIHZhciBjID0gY29sb3JzW2ldOwogICAgICBjb2xvcnNQYWNrZWRbaisrXSA9IGNbMF07CiAgICAgIGNvbG9yc1BhY2tlZFtqKytdID0gY1sxXTsKICAgICAgY29sb3JzUGFja2VkW2orK10gPSBjWzJdOwogICAgfQoKICAgIG1lc2guY29sb3JzID0gY29sb3JzUGFja2VkOwogICAgdmFyIGZpZ3VyZXMgPSBtZXNoLmZpZ3VyZXM7CgogICAgZm9yIChpID0gMCwgaWkgPSBmaWd1cmVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgdmFyIGZpZ3VyZSA9IGZpZ3VyZXNbaV0sCiAgICAgICAgICBwcyA9IGZpZ3VyZS5jb29yZHMsCiAgICAgICAgICBjcyA9IGZpZ3VyZS5jb2xvcnM7CgogICAgICBmb3IgKGogPSAwLCBqaiA9IHBzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHsKICAgICAgICBwc1tqXSAqPSAyOwogICAgICAgIGNzW2pdICo9IDM7CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIE1lc2goc3RyZWFtLCBtYXRyaXgsIHhyZWYsIHJlcywgcGRmRnVuY3Rpb25GYWN0b3J5KSB7CiAgICBpZiAoISgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkoc3RyZWFtKSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk1lc2ggZGF0YSBpcyBub3QgYSBzdHJlYW0iKTsKICAgIH0KCiAgICB2YXIgZGljdCA9IHN0cmVhbS5kaWN0OwogICAgdGhpcy5tYXRyaXggPSBtYXRyaXg7CiAgICB0aGlzLnNoYWRpbmdUeXBlID0gZGljdC5nZXQoIlNoYWRpbmdUeXBlIik7CiAgICB0aGlzLnR5cGUgPSAiUGF0dGVybiI7CiAgICB2YXIgYmJveCA9IGRpY3QuZ2V0QXJyYXkoIkJCb3giKTsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShiYm94KSAmJiBiYm94Lmxlbmd0aCA9PT0gNCkgewogICAgICB0aGlzLmJib3ggPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QoYmJveCk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmJib3ggPSBudWxsOwogICAgfQoKICAgIHZhciBjcyA9IGRpY3QuZ2V0KCJDb2xvclNwYWNlIiwgIkNTIik7CiAgICBjcyA9IF9jb2xvcnNwYWNlLkNvbG9yU3BhY2UucGFyc2UoY3MsIHhyZWYsIHJlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKICAgIHRoaXMuY3MgPSBjczsKICAgIHRoaXMuYmFja2dyb3VuZCA9IGRpY3QuaGFzKCJCYWNrZ3JvdW5kIikgPyBjcy5nZXRSZ2IoZGljdC5nZXQoIkJhY2tncm91bmQiKSwgMCkgOiBudWxsOwogICAgdmFyIGZuT2JqID0gZGljdC5nZXQoIkZ1bmN0aW9uIik7CiAgICB2YXIgZm4gPSBmbk9iaiA/IHBkZkZ1bmN0aW9uRmFjdG9yeS5jcmVhdGVGcm9tQXJyYXkoZm5PYmopIDogbnVsbDsKICAgIHRoaXMuY29vcmRzID0gW107CiAgICB0aGlzLmNvbG9ycyA9IFtdOwogICAgdGhpcy5maWd1cmVzID0gW107CiAgICB2YXIgZGVjb2RlQ29udGV4dCA9IHsKICAgICAgYml0c1BlckNvb3JkaW5hdGU6IGRpY3QuZ2V0KCJCaXRzUGVyQ29vcmRpbmF0ZSIpLAogICAgICBiaXRzUGVyQ29tcG9uZW50OiBkaWN0LmdldCgiQml0c1BlckNvbXBvbmVudCIpLAogICAgICBiaXRzUGVyRmxhZzogZGljdC5nZXQoIkJpdHNQZXJGbGFnIiksCiAgICAgIGRlY29kZTogZGljdC5nZXRBcnJheSgiRGVjb2RlIiksCiAgICAgIGNvbG9yRm46IGZuLAogICAgICBjb2xvclNwYWNlOiBjcywKICAgICAgbnVtQ29tcHM6IGZuID8gMSA6IGNzLm51bUNvbXBzCiAgICB9OwogICAgdmFyIHJlYWRlciA9IG5ldyBNZXNoU3RyZWFtUmVhZGVyKHN0cmVhbSwgZGVjb2RlQ29udGV4dCk7CiAgICB2YXIgcGF0Y2hNZXNoID0gZmFsc2U7CgogICAgc3dpdGNoICh0aGlzLnNoYWRpbmdUeXBlKSB7CiAgICAgIGNhc2UgU2hhZGluZ1R5cGUuRlJFRV9GT1JNX01FU0g6CiAgICAgICAgZGVjb2RlVHlwZTRTaGFkaW5nKHRoaXMsIHJlYWRlcik7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFNoYWRpbmdUeXBlLkxBVFRJQ0VfRk9STV9NRVNIOgogICAgICAgIHZhciB2ZXJ0aWNlc1BlclJvdyA9IGRpY3QuZ2V0KCJWZXJ0aWNlc1BlclJvdyIpIHwgMDsKCiAgICAgICAgaWYgKHZlcnRpY2VzUGVyUm93IDwgMikgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIFZlcnRpY2VzUGVyUm93Iik7CiAgICAgICAgfQoKICAgICAgICBkZWNvZGVUeXBlNVNoYWRpbmcodGhpcywgcmVhZGVyLCB2ZXJ0aWNlc1BlclJvdyk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIFNoYWRpbmdUeXBlLkNPT05TX1BBVENIX01FU0g6CiAgICAgICAgZGVjb2RlVHlwZTZTaGFkaW5nKHRoaXMsIHJlYWRlcik7CiAgICAgICAgcGF0Y2hNZXNoID0gdHJ1ZTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgU2hhZGluZ1R5cGUuVEVOU09SX1BBVENIX01FU0g6CiAgICAgICAgZGVjb2RlVHlwZTdTaGFkaW5nKHRoaXMsIHJlYWRlcik7CiAgICAgICAgcGF0Y2hNZXNoID0gdHJ1ZTsKICAgICAgICBicmVhazsKCiAgICAgIGRlZmF1bHQ6CiAgICAgICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiVW5zdXBwb3J0ZWQgbWVzaCB0eXBlLiIpOwogICAgICAgIGJyZWFrOwogICAgfQoKICAgIGlmIChwYXRjaE1lc2gpIHsKICAgICAgdXBkYXRlQm91bmRzKHRoaXMpOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5maWd1cmVzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBidWlsZEZpZ3VyZUZyb21QYXRjaCh0aGlzLCBpKTsKICAgICAgfQogICAgfQoKICAgIHVwZGF0ZUJvdW5kcyh0aGlzKTsKICAgIHBhY2tEYXRhKHRoaXMpOwogIH0KCiAgTWVzaC5wcm90b3R5cGUgPSB7CiAgICBnZXRJUjogZnVuY3Rpb24gTWVzaF9nZXRJUigpIHsKICAgICAgcmV0dXJuIFsiTWVzaCIsIHRoaXMuc2hhZGluZ1R5cGUsIHRoaXMuY29vcmRzLCB0aGlzLmNvbG9ycywgdGhpcy5maWd1cmVzLCB0aGlzLmJvdW5kcywgdGhpcy5tYXRyaXgsIHRoaXMuYmJveCwgdGhpcy5iYWNrZ3JvdW5kXTsKICAgIH0KICB9OwogIHJldHVybiBNZXNoOwp9KCk7CgpTaGFkaW5ncy5EdW1teSA9IGZ1bmN0aW9uIER1bW15Q2xvc3VyZSgpIHsKICBmdW5jdGlvbiBEdW1teSgpIHsKICAgIHRoaXMudHlwZSA9ICJQYXR0ZXJuIjsKICB9CgogIER1bW15LnByb3RvdHlwZSA9IHsKICAgIGdldElSOiBmdW5jdGlvbiBEdW1teV9nZXRJUigpIHsKICAgICAgcmV0dXJuIFsiRHVtbXkiXTsKICAgIH0KICB9OwogIHJldHVybiBEdW1teTsKfSgpOwoKZnVuY3Rpb24gZ2V0VGlsaW5nUGF0dGVybklSKG9wZXJhdG9yTGlzdCwgZGljdCwgYXJncykgewogIHZhciBtYXRyaXggPSBkaWN0LmdldEFycmF5KCJNYXRyaXgiKTsKCiAgdmFyIGJib3ggPSBfdXRpbC5VdGlsLm5vcm1hbGl6ZVJlY3QoZGljdC5nZXRBcnJheSgiQkJveCIpKTsKCiAgdmFyIHhzdGVwID0gZGljdC5nZXQoIlhTdGVwIik7CiAgdmFyIHlzdGVwID0gZGljdC5nZXQoIllTdGVwIik7CiAgdmFyIHBhaW50VHlwZSA9IGRpY3QuZ2V0KCJQYWludFR5cGUiKTsKICB2YXIgdGlsaW5nVHlwZSA9IGRpY3QuZ2V0KCJUaWxpbmdUeXBlIik7CgogIGlmIChiYm94WzJdIC0gYmJveFswXSA9PT0gMCB8fCBiYm94WzNdIC0gYmJveFsxXSA9PT0gMCkgewogICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIGdldFRpbGluZ1BhdHRlcm5JUiAvQkJveCBhcnJheTogWyIuY29uY2F0KGJib3gsICJdLiIpKTsKICB9CgogIHJldHVybiBbIlRpbGluZ1BhdHRlcm4iLCBhcmdzLCBvcGVyYXRvckxpc3QsIG1hdHJpeCwgYmJveCwgeHN0ZXAsIHlzdGVwLCBwYWludFR5cGUsIHRpbGluZ1R5cGVdOwp9CgovKioqLyB9KSwKLyogMjMyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuYmlkaSA9IGJpZGk7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIGJhc2VUeXBlcyA9IFsiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiUyIsICJCIiwgIlMiLCAiV1MiLCAiQiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCIiwgIkIiLCAiQiIsICJTIiwgIldTIiwgIk9OIiwgIk9OIiwgIkVUIiwgIkVUIiwgIkVUIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIkVTIiwgIkNTIiwgIkVTIiwgIkNTIiwgIkNTIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkNTIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIk9OIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiT04iLCAiT04iLCAiT04iLCAiT04iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQk4iLCAiQiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJCTiIsICJDUyIsICJPTiIsICJFVCIsICJFVCIsICJFVCIsICJFVCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIk9OIiwgIk9OIiwgIkJOIiwgIk9OIiwgIk9OIiwgIkVUIiwgIkVUIiwgIkVOIiwgIkVOIiwgIk9OIiwgIkwiLCAiT04iLCAiT04iLCAiT04iLCAiRU4iLCAiTCIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiT04iLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJPTiIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiLCAiTCIsICJMIiwgIkwiXTsKdmFyIGFyYWJpY1R5cGVzID0gWyJBTiIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJPTiIsICJPTiIsICJBTCIsICJFVCIsICJFVCIsICJBTCIsICJDUyIsICJBTCIsICJPTiIsICJPTiIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIkFMIiwgIkFMIiwgIiIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJBTCIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJBTiIsICJFVCIsICJBTiIsICJBTiIsICJBTCIsICJBTCIsICJBTCIsICJOU00iLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiQUwiLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIkFOIiwgIk9OIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIkFMIiwgIkFMIiwgIk5TTSIsICJOU00iLCAiT04iLCAiTlNNIiwgIk5TTSIsICJOU00iLCAiTlNNIiwgIkFMIiwgIkFMIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkVOIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIiwgIkFMIl07CgpmdW5jdGlvbiBpc09kZChpKSB7CiAgcmV0dXJuIChpICYgMSkgIT09IDA7Cn0KCmZ1bmN0aW9uIGlzRXZlbihpKSB7CiAgcmV0dXJuIChpICYgMSkgPT09IDA7Cn0KCmZ1bmN0aW9uIGZpbmRVbmVxdWFsKGFyciwgc3RhcnQsIHZhbHVlKSB7CiAgZm9yICh2YXIgaiA9IHN0YXJ0LCBqaiA9IGFyci5sZW5ndGg7IGogPCBqajsgKytqKSB7CiAgICBpZiAoYXJyW2pdICE9PSB2YWx1ZSkgewogICAgICByZXR1cm4gajsKICAgIH0KICB9CgogIHJldHVybiBqOwp9CgpmdW5jdGlvbiBzZXRWYWx1ZXMoYXJyLCBzdGFydCwgZW5kLCB2YWx1ZSkgewogIGZvciAodmFyIGogPSBzdGFydDsgaiA8IGVuZDsgKytqKSB7CiAgICBhcnJbal0gPSB2YWx1ZTsKICB9Cn0KCmZ1bmN0aW9uIHJldmVyc2VWYWx1ZXMoYXJyLCBzdGFydCwgZW5kKSB7CiAgZm9yICh2YXIgaSA9IHN0YXJ0LCBqID0gZW5kIC0gMTsgaSA8IGo7ICsraSwgLS1qKSB7CiAgICB2YXIgdGVtcCA9IGFycltpXTsKICAgIGFycltpXSA9IGFycltqXTsKICAgIGFycltqXSA9IHRlbXA7CiAgfQp9CgpmdW5jdGlvbiBjcmVhdGVCaWRpVGV4dChzdHIsIGlzTFRSKSB7CiAgdmFyIHZlcnRpY2FsID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICB2YXIgZGlyID0gImx0ciI7CgogIGlmICh2ZXJ0aWNhbCkgewogICAgZGlyID0gInR0YiI7CiAgfSBlbHNlIGlmICghaXNMVFIpIHsKICAgIGRpciA9ICJydGwiOwogIH0KCiAgcmV0dXJuIHsKICAgIHN0cjogc3RyLAogICAgZGlyOiBkaXIKICB9Owp9Cgp2YXIgY2hhcnMgPSBbXTsKdmFyIHR5cGVzID0gW107CgpmdW5jdGlvbiBiaWRpKHN0ciwgc3RhcnRMZXZlbCwgdmVydGljYWwpIHsKICB2YXIgaXNMVFIgPSB0cnVlOwogIHZhciBzdHJMZW5ndGggPSBzdHIubGVuZ3RoOwoKICBpZiAoc3RyTGVuZ3RoID09PSAwIHx8IHZlcnRpY2FsKSB7CiAgICByZXR1cm4gY3JlYXRlQmlkaVRleHQoc3RyLCBpc0xUUiwgdmVydGljYWwpOwogIH0KCiAgY2hhcnMubGVuZ3RoID0gc3RyTGVuZ3RoOwogIHR5cGVzLmxlbmd0aCA9IHN0ckxlbmd0aDsKICB2YXIgbnVtQmlkaSA9IDA7CiAgdmFyIGksIGlpOwoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIGNoYXJzW2ldID0gc3RyLmNoYXJBdChpKTsKICAgIHZhciBjaGFyQ29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpOwogICAgdmFyIGNoYXJUeXBlID0gIkwiOwoKICAgIGlmIChjaGFyQ29kZSA8PSAweDAwZmYpIHsKICAgICAgY2hhclR5cGUgPSBiYXNlVHlwZXNbY2hhckNvZGVdOwogICAgfSBlbHNlIGlmICgweDA1OTAgPD0gY2hhckNvZGUgJiYgY2hhckNvZGUgPD0gMHgwNWY0KSB7CiAgICAgIGNoYXJUeXBlID0gIlIiOwogICAgfSBlbHNlIGlmICgweDA2MDAgPD0gY2hhckNvZGUgJiYgY2hhckNvZGUgPD0gMHgwNmZmKSB7CiAgICAgIGNoYXJUeXBlID0gYXJhYmljVHlwZXNbY2hhckNvZGUgJiAweGZmXTsKCiAgICAgIGlmICghY2hhclR5cGUpIHsKICAgICAgICAoMCwgX3V0aWwud2FybikoIkJpZGk6IGludmFsaWQgVW5pY29kZSBjaGFyYWN0ZXIgIiArIGNoYXJDb2RlLnRvU3RyaW5nKDE2KSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoMHgwNzAwIDw9IGNoYXJDb2RlICYmIGNoYXJDb2RlIDw9IDB4MDhhYykgewogICAgICBjaGFyVHlwZSA9ICJBTCI7CiAgICB9CgogICAgaWYgKGNoYXJUeXBlID09PSAiUiIgfHwgY2hhclR5cGUgPT09ICJBTCIgfHwgY2hhclR5cGUgPT09ICJBTiIpIHsKICAgICAgbnVtQmlkaSsrOwogICAgfQoKICAgIHR5cGVzW2ldID0gY2hhclR5cGU7CiAgfQoKICBpZiAobnVtQmlkaSA9PT0gMCkgewogICAgaXNMVFIgPSB0cnVlOwogICAgcmV0dXJuIGNyZWF0ZUJpZGlUZXh0KHN0ciwgaXNMVFIpOwogIH0KCiAgaWYgKHN0YXJ0TGV2ZWwgPT09IC0xKSB7CiAgICBpZiAobnVtQmlkaSAvIHN0ckxlbmd0aCA8IDAuMykgewogICAgICBpc0xUUiA9IHRydWU7CiAgICAgIHN0YXJ0TGV2ZWwgPSAwOwogICAgfSBlbHNlIHsKICAgICAgaXNMVFIgPSBmYWxzZTsKICAgICAgc3RhcnRMZXZlbCA9IDE7CiAgICB9CiAgfQoKICB2YXIgbGV2ZWxzID0gW107CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgbGV2ZWxzW2ldID0gc3RhcnRMZXZlbDsKICB9CgogIHZhciBlID0gaXNPZGQoc3RhcnRMZXZlbCkgPyAiUiIgOiAiTCI7CiAgdmFyIHNvciA9IGU7CiAgdmFyIGVvciA9IHNvcjsKICB2YXIgbGFzdFR5cGUgPSBzb3I7CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgaWYgKHR5cGVzW2ldID09PSAiTlNNIikgewogICAgICB0eXBlc1tpXSA9IGxhc3RUeXBlOwogICAgfSBlbHNlIHsKICAgICAgbGFzdFR5cGUgPSB0eXBlc1tpXTsKICAgIH0KICB9CgogIGxhc3RUeXBlID0gc29yOwogIHZhciB0OwoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIHQgPSB0eXBlc1tpXTsKCiAgICBpZiAodCA9PT0gIkVOIikgewogICAgICB0eXBlc1tpXSA9IGxhc3RUeXBlID09PSAiQUwiID8gIkFOIiA6ICJFTiI7CiAgICB9IGVsc2UgaWYgKHQgPT09ICJSIiB8fCB0ID09PSAiTCIgfHwgdCA9PT0gIkFMIikgewogICAgICBsYXN0VHlwZSA9IHQ7CiAgICB9CiAgfQoKICBmb3IgKGkgPSAwOyBpIDwgc3RyTGVuZ3RoOyArK2kpIHsKICAgIHQgPSB0eXBlc1tpXTsKCiAgICBpZiAodCA9PT0gIkFMIikgewogICAgICB0eXBlc1tpXSA9ICJSIjsKICAgIH0KICB9CgogIGZvciAoaSA9IDE7IGkgPCBzdHJMZW5ndGggLSAxOyArK2kpIHsKICAgIGlmICh0eXBlc1tpXSA9PT0gIkVTIiAmJiB0eXBlc1tpIC0gMV0gPT09ICJFTiIgJiYgdHlwZXNbaSArIDFdID09PSAiRU4iKSB7CiAgICAgIHR5cGVzW2ldID0gIkVOIjsKICAgIH0KCiAgICBpZiAodHlwZXNbaV0gPT09ICJDUyIgJiYgKHR5cGVzW2kgLSAxXSA9PT0gIkVOIiB8fCB0eXBlc1tpIC0gMV0gPT09ICJBTiIpICYmIHR5cGVzW2kgKyAxXSA9PT0gdHlwZXNbaSAtIDFdKSB7CiAgICAgIHR5cGVzW2ldID0gdHlwZXNbaSAtIDFdOwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICBpZiAodHlwZXNbaV0gPT09ICJFTiIpIHsKICAgICAgdmFyIGo7CgogICAgICBmb3IgKGogPSBpIC0gMTsgaiA+PSAwOyAtLWopIHsKICAgICAgICBpZiAodHlwZXNbal0gIT09ICJFVCIpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgdHlwZXNbal0gPSAiRU4iOwogICAgICB9CgogICAgICBmb3IgKGogPSBpICsgMTsgaiA8IHN0ckxlbmd0aDsgKytqKSB7CiAgICAgICAgaWYgKHR5cGVzW2pdICE9PSAiRVQiKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHR5cGVzW2pdID0gIkVOIjsKICAgICAgfQogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICB0ID0gdHlwZXNbaV07CgogICAgaWYgKHQgPT09ICJXUyIgfHwgdCA9PT0gIkVTIiB8fCB0ID09PSAiRVQiIHx8IHQgPT09ICJDUyIpIHsKICAgICAgdHlwZXNbaV0gPSAiT04iOwogICAgfQogIH0KCiAgbGFzdFR5cGUgPSBzb3I7CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgdCA9IHR5cGVzW2ldOwoKICAgIGlmICh0ID09PSAiRU4iKSB7CiAgICAgIHR5cGVzW2ldID0gbGFzdFR5cGUgPT09ICJMIiA/ICJMIiA6ICJFTiI7CiAgICB9IGVsc2UgaWYgKHQgPT09ICJSIiB8fCB0ID09PSAiTCIpIHsKICAgICAgbGFzdFR5cGUgPSB0OwogICAgfQogIH0KCiAgZm9yIChpID0gMDsgaSA8IHN0ckxlbmd0aDsgKytpKSB7CiAgICBpZiAodHlwZXNbaV0gPT09ICJPTiIpIHsKICAgICAgdmFyIGVuZCA9IGZpbmRVbmVxdWFsKHR5cGVzLCBpICsgMSwgIk9OIik7CiAgICAgIHZhciBiZWZvcmUgPSBzb3I7CgogICAgICBpZiAoaSA+IDApIHsKICAgICAgICBiZWZvcmUgPSB0eXBlc1tpIC0gMV07CiAgICAgIH0KCiAgICAgIHZhciBhZnRlciA9IGVvcjsKCiAgICAgIGlmIChlbmQgKyAxIDwgc3RyTGVuZ3RoKSB7CiAgICAgICAgYWZ0ZXIgPSB0eXBlc1tlbmQgKyAxXTsKICAgICAgfQoKICAgICAgaWYgKGJlZm9yZSAhPT0gIkwiKSB7CiAgICAgICAgYmVmb3JlID0gIlIiOwogICAgICB9CgogICAgICBpZiAoYWZ0ZXIgIT09ICJMIikgewogICAgICAgIGFmdGVyID0gIlIiOwogICAgICB9CgogICAgICBpZiAoYmVmb3JlID09PSBhZnRlcikgewogICAgICAgIHNldFZhbHVlcyh0eXBlcywgaSwgZW5kLCBiZWZvcmUpOwogICAgICB9CgogICAgICBpID0gZW5kIC0gMTsKICAgIH0KICB9CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgaWYgKHR5cGVzW2ldID09PSAiT04iKSB7CiAgICAgIHR5cGVzW2ldID0gZTsKICAgIH0KICB9CgogIGZvciAoaSA9IDA7IGkgPCBzdHJMZW5ndGg7ICsraSkgewogICAgdCA9IHR5cGVzW2ldOwoKICAgIGlmIChpc0V2ZW4obGV2ZWxzW2ldKSkgewogICAgICBpZiAodCA9PT0gIlIiKSB7CiAgICAgICAgbGV2ZWxzW2ldICs9IDE7CiAgICAgIH0gZWxzZSBpZiAodCA9PT0gIkFOIiB8fCB0ID09PSAiRU4iKSB7CiAgICAgICAgbGV2ZWxzW2ldICs9IDI7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmICh0ID09PSAiTCIgfHwgdCA9PT0gIkFOIiB8fCB0ID09PSAiRU4iKSB7CiAgICAgICAgbGV2ZWxzW2ldICs9IDE7CiAgICAgIH0KICAgIH0KICB9CgogIHZhciBoaWdoZXN0TGV2ZWwgPSAtMTsKICB2YXIgbG93ZXN0T2RkTGV2ZWwgPSA5OTsKICB2YXIgbGV2ZWw7CgogIGZvciAoaSA9IDAsIGlpID0gbGV2ZWxzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgIGxldmVsID0gbGV2ZWxzW2ldOwoKICAgIGlmIChoaWdoZXN0TGV2ZWwgPCBsZXZlbCkgewogICAgICBoaWdoZXN0TGV2ZWwgPSBsZXZlbDsKICAgIH0KCiAgICBpZiAobG93ZXN0T2RkTGV2ZWwgPiBsZXZlbCAmJiBpc09kZChsZXZlbCkpIHsKICAgICAgbG93ZXN0T2RkTGV2ZWwgPSBsZXZlbDsKICAgIH0KICB9CgogIGZvciAobGV2ZWwgPSBoaWdoZXN0TGV2ZWw7IGxldmVsID49IGxvd2VzdE9kZExldmVsOyAtLWxldmVsKSB7CiAgICB2YXIgc3RhcnQgPSAtMTsKCiAgICBmb3IgKGkgPSAwLCBpaSA9IGxldmVscy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgIGlmIChsZXZlbHNbaV0gPCBsZXZlbCkgewogICAgICAgIGlmIChzdGFydCA+PSAwKSB7CiAgICAgICAgICByZXZlcnNlVmFsdWVzKGNoYXJzLCBzdGFydCwgaSk7CiAgICAgICAgICBzdGFydCA9IC0xOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChzdGFydCA8IDApIHsKICAgICAgICBzdGFydCA9IGk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoc3RhcnQgPj0gMCkgewogICAgICByZXZlcnNlVmFsdWVzKGNoYXJzLCBzdGFydCwgbGV2ZWxzLmxlbmd0aCk7CiAgICB9CiAgfQoKICBmb3IgKGkgPSAwLCBpaSA9IGNoYXJzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgIHZhciBjaCA9IGNoYXJzW2ldOwoKICAgIGlmIChjaCA9PT0gIjwiIHx8IGNoID09PSAiPiIpIHsKICAgICAgY2hhcnNbaV0gPSAiIjsKICAgIH0KICB9CgogIHJldHVybiBjcmVhdGVCaWRpVGV4dChjaGFycy5qb2luKCIiKSwgaXNMVFIpOwp9CgovKioqLyB9KSwKLyogMjMzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZ2V0TWV0cmljcyA9IHZvaWQgMDsKCnZhciBfY29yZV91dGlscyA9IF9fd19wZGZqc19yZXF1aXJlX18oMjAxKTsKCnZhciBnZXRNZXRyaWNzID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICB0LkNvdXJpZXIgPSA2MDA7CiAgdFsiQ291cmllci1Cb2xkIl0gPSA2MDA7CiAgdFsiQ291cmllci1Cb2xkT2JsaXF1ZSJdID0gNjAwOwogIHRbIkNvdXJpZXItT2JsaXF1ZSJdID0gNjAwOwogIHQuSGVsdmV0aWNhID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNzg7CiAgICB0LmV4Y2xhbSA9IDI3ODsKICAgIHQucXVvdGVkYmwgPSAzNTU7CiAgICB0Lm51bWJlcnNpZ24gPSA1NTY7CiAgICB0LmRvbGxhciA9IDU1NjsKICAgIHQucGVyY2VudCA9IDg4OTsKICAgIHQuYW1wZXJzYW5kID0gNjY3OwogICAgdC5xdW90ZXJpZ2h0ID0gMjIyOwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gMzg5OwogICAgdC5wbHVzID0gNTg0OwogICAgdC5jb21tYSA9IDI3ODsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNzg7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTU2OwogICAgdC5vbmUgPSA1NTY7CiAgICB0LnR3byA9IDU1NjsKICAgIHQudGhyZWUgPSA1NTY7CiAgICB0LmZvdXIgPSA1NTY7CiAgICB0LmZpdmUgPSA1NTY7CiAgICB0LnNpeCA9IDU1NjsKICAgIHQuc2V2ZW4gPSA1NTY7CiAgICB0LmVpZ2h0ID0gNTU2OwogICAgdC5uaW5lID0gNTU2OwogICAgdC5jb2xvbiA9IDI3ODsKICAgIHQuc2VtaWNvbG9uID0gMjc4OwogICAgdC5sZXNzID0gNTg0OwogICAgdC5lcXVhbCA9IDU4NDsKICAgIHQuZ3JlYXRlciA9IDU4NDsKICAgIHQucXVlc3Rpb24gPSA1NTY7CiAgICB0LmF0ID0gMTAxNTsKICAgIHQuQSA9IDY2NzsKICAgIHQuQiA9IDY2NzsKICAgIHQuQyA9IDcyMjsKICAgIHQuRCA9IDcyMjsKICAgIHQuRSA9IDY2NzsKICAgIHQuRiA9IDYxMTsKICAgIHQuRyA9IDc3ODsKICAgIHQuSCA9IDcyMjsKICAgIHQuSSA9IDI3ODsKICAgIHQuSiA9IDUwMDsKICAgIHQuSyA9IDY2NzsKICAgIHQuTCA9IDU1NjsKICAgIHQuTSA9IDgzMzsKICAgIHQuTiA9IDcyMjsKICAgIHQuTyA9IDc3ODsKICAgIHQuUCA9IDY2NzsKICAgIHQuUSA9IDc3ODsKICAgIHQuUiA9IDcyMjsKICAgIHQuUyA9IDY2NzsKICAgIHQuVCA9IDYxMTsKICAgIHQuVSA9IDcyMjsKICAgIHQuViA9IDY2NzsKICAgIHQuVyA9IDk0NDsKICAgIHQuWCA9IDY2NzsKICAgIHQuWSA9IDY2NzsKICAgIHQuWiA9IDYxMTsKICAgIHQuYnJhY2tldGxlZnQgPSAyNzg7CiAgICB0LmJhY2tzbGFzaCA9IDI3ODsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMjc4OwogICAgdC5hc2NpaWNpcmN1bSA9IDQ2OTsKICAgIHQudW5kZXJzY29yZSA9IDU1NjsKICAgIHQucXVvdGVsZWZ0ID0gMjIyOwogICAgdC5hID0gNTU2OwogICAgdC5iID0gNTU2OwogICAgdC5jID0gNTAwOwogICAgdC5kID0gNTU2OwogICAgdC5lID0gNTU2OwogICAgdC5mID0gMjc4OwogICAgdC5nID0gNTU2OwogICAgdC5oID0gNTU2OwogICAgdC5pID0gMjIyOwogICAgdC5qID0gMjIyOwogICAgdC5rID0gNTAwOwogICAgdC5sID0gMjIyOwogICAgdC5tID0gODMzOwogICAgdC5uID0gNTU2OwogICAgdC5vID0gNTU2OwogICAgdC5wID0gNTU2OwogICAgdC5xID0gNTU2OwogICAgdC5yID0gMzMzOwogICAgdC5zID0gNTAwOwogICAgdC50ID0gMjc4OwogICAgdC51ID0gNTU2OwogICAgdC52ID0gNTAwOwogICAgdC53ID0gNzIyOwogICAgdC54ID0gNTAwOwogICAgdC55ID0gNTAwOwogICAgdC56ID0gNTAwOwogICAgdC5icmFjZWxlZnQgPSAzMzQ7CiAgICB0LmJhciA9IDI2MDsKICAgIHQuYnJhY2VyaWdodCA9IDMzNDsKICAgIHQuYXNjaWl0aWxkZSA9IDU4NDsKICAgIHQuZXhjbGFtZG93biA9IDMzMzsKICAgIHQuY2VudCA9IDU1NjsKICAgIHQuc3RlcmxpbmcgPSA1NTY7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC55ZW4gPSA1NTY7CiAgICB0LmZsb3JpbiA9IDU1NjsKICAgIHQuc2VjdGlvbiA9IDU1NjsKICAgIHQuY3VycmVuY3kgPSA1NTY7CiAgICB0LnF1b3Rlc2luZ2xlID0gMTkxOwogICAgdC5xdW90ZWRibGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxsZW1vdGxlZnQgPSA1NTY7CiAgICB0Lmd1aWxzaW5nbGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxzaW5nbHJpZ2h0ID0gMzMzOwogICAgdC5maSA9IDUwMDsKICAgIHQuZmwgPSA1MDA7CiAgICB0LmVuZGFzaCA9IDU1NjsKICAgIHQuZGFnZ2VyID0gNTU2OwogICAgdC5kYWdnZXJkYmwgPSA1NTY7CiAgICB0LnBlcmlvZGNlbnRlcmVkID0gMjc4OwogICAgdC5wYXJhZ3JhcGggPSA1Mzc7CiAgICB0LmJ1bGxldCA9IDM1MDsKICAgIHQucXVvdGVzaW5nbGJhc2UgPSAyMjI7CiAgICB0LnF1b3RlZGJsYmFzZSA9IDMzMzsKICAgIHQucXVvdGVkYmxyaWdodCA9IDMzMzsKICAgIHQuZ3VpbGxlbW90cmlnaHQgPSA1NTY7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA2MTE7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gMTAwMDsKICAgIHQuQUUgPSAxMDAwOwogICAgdC5vcmRmZW1pbmluZSA9IDM3MDsKICAgIHQuTHNsYXNoID0gNTU2OwogICAgdC5Pc2xhc2ggPSA3Nzg7CiAgICB0Lk9FID0gMTAwMDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzY1OwogICAgdC5hZSA9IDg4OTsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDIyMjsKICAgIHQub3NsYXNoID0gNjExOwogICAgdC5vZSA9IDk0NDsKICAgIHQuZ2VybWFuZGJscyA9IDYxMTsKICAgIHQuSWRpZXJlc2lzID0gMjc4OwogICAgdC5lYWN1dGUgPSA1NTY7CiAgICB0LmFicmV2ZSA9IDU1NjsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuZWNhcm9uID0gNTU2OwogICAgdC5ZZGllcmVzaXMgPSA2Njc7CiAgICB0LmRpdmlkZSA9IDU4NDsKICAgIHQuWWFjdXRlID0gNjY3OwogICAgdC5BY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWFjdXRlID0gNTU2OwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTAwOwogICAgdC5zY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0LmVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTU2OwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1NTY7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzM3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA1MDA7CiAgICB0LmFyaW5nID0gNTU2OwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDIyMjsKICAgIHQuYWdyYXZlID0gNTU2OwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDcyMjsKICAgIHQuYXRpbGRlID0gNTU2OwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSA1MDA7CiAgICB0LnNjZWRpbGxhID0gNTAwOwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0NzE7CiAgICB0LlJjYXJvbiA9IDcyMjsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC51Y2lyY3VtZmxleCA9IDU1NjsKICAgIHQuYWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LkFtYWNyb24gPSA2Njc7CiAgICB0LnJjYXJvbiA9IDMzMzsKICAgIHQuY2NlZGlsbGEgPSA1MDA7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNjY3OwogICAgdC5PbWFjcm9uID0gNzc4OwogICAgdC5SYWN1dGUgPSA3MjI7CiAgICB0LlNhY3V0ZSA9IDY2NzsKICAgIHQuZGNhcm9uID0gNjQzOwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDU1NjsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMzMzsKICAgIHQuT2dyYXZlID0gNzc4OwogICAgdC5BZ3JhdmUgPSA2Njc7CiAgICB0LkFicmV2ZSA9IDY2NzsKICAgIHQubXVsdGlwbHkgPSA1ODQ7CiAgICB0LnVhY3V0ZSA9IDU1NjsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ3NjsKICAgIHQueWRpZXJlc2lzID0gNTAwOwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTU2OwogICAgdC5lZGllcmVzaXMgPSA1NTY7CiAgICB0LmNhY3V0ZSA9IDUwMDsKICAgIHQubmFjdXRlID0gNTU2OwogICAgdC51bWFjcm9uID0gNTU2OwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDI3ODsKICAgIHQucGx1c21pbnVzID0gNTg0OwogICAgdC5icm9rZW5iYXIgPSAyNjA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3Mzc7CiAgICB0LkdicmV2ZSA9IDc3ODsKICAgIHQuSWRvdGFjY2VudCA9IDI3ODsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDMzMzsKICAgIHQub21hY3JvbiA9IDU1NjsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDcyMjsKICAgIHQubGNvbW1hYWNjZW50ID0gMjIyOwogICAgdC50Y2Fyb24gPSAzMTc7CiAgICB0LmVvZ29uZWsgPSA1NTY7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDY2NzsKICAgIHQuQWRpZXJlc2lzID0gNjY3OwogICAgdC5lZ3JhdmUgPSA1NTY7CiAgICB0LnphY3V0ZSA9IDUwMDsKICAgIHQuaW9nb25layA9IDIyMjsKICAgIHQuT2FjdXRlID0gNzc4OwogICAgdC5vYWN1dGUgPSA1NTY7CiAgICB0LmFtYWNyb24gPSA1NTY7CiAgICB0LnNhY3V0ZSA9IDUwMDsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDc3ODsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1NTY7CiAgICB0LnR3b3N1cGVyaW9yID0gMzMzOwogICAgdC5PZGllcmVzaXMgPSA3Nzg7CiAgICB0Lm11ID0gNTU2OwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1NTY7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDU1NjsKICAgIHQudGhyZWVxdWFydGVycyA9IDgzNDsKICAgIHQuU2NlZGlsbGEgPSA2Njc7CiAgICB0LmxjYXJvbiA9IDI5OTsKICAgIHQuS2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MYWN1dGUgPSA1NTY7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA1NTY7CiAgICB0LklncmF2ZSA9IDI3ODsKICAgIHQuSW1hY3JvbiA9IDI3ODsKICAgIHQuTGNhcm9uID0gNTU2OwogICAgdC5vbmVoYWxmID0gODM0OwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNTU2OwogICAgdC5udGlsZGUgPSA1NTY7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDU1NjsKICAgIHQuZ2JyZXZlID0gNTU2OwogICAgdC5vbmVxdWFydGVyID0gODM0OwogICAgdC5TY2Fyb24gPSA2Njc7CiAgICB0LlNjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDc3ODsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA1NTY7CiAgICB0LkNjYXJvbiA9IDcyMjsKICAgIHQudWdyYXZlID0gNTU2OwogICAgdC5yYWRpY2FsID0gNDUzOwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDMzMzsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA1NTY7CiAgICB0LlJjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGNvbW1hYWNjZW50ID0gNTU2OwogICAgdC5BdGlsZGUgPSA2Njc7CiAgICB0LkFvZ29uZWsgPSA2Njc7CiAgICB0LkFyaW5nID0gNjY3OwogICAgdC5PdGlsZGUgPSA3Nzg7CiAgICB0Lnpkb3RhY2NlbnQgPSA1MDA7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDI3ODsKICAgIHQua2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5taW51cyA9IDU4NDsKICAgIHQuSWNpcmN1bWZsZXggPSAyNzg7CiAgICB0Lm5jYXJvbiA9IDU1NjsKICAgIHQudGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC5sb2dpY2Fsbm90ID0gNTg0OwogICAgdC5vZGllcmVzaXMgPSA1NTY7CiAgICB0LnVkaWVyZXNpcyA9IDU1NjsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuZXRoID0gNTU2OwogICAgdC56Y2Fyb24gPSA1MDA7CiAgICB0Lm5jb21tYWFjY2VudCA9IDU1NjsKICAgIHQub25lc3VwZXJpb3IgPSAzMzM7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1NTY7CiAgfSk7CiAgdFsiSGVsdmV0aWNhLUJvbGQiXSA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjc4OwogICAgdC5leGNsYW0gPSAzMzM7CiAgICB0LnF1b3RlZGJsID0gNDc0OwogICAgdC5udW1iZXJzaWduID0gNTU2OwogICAgdC5kb2xsYXIgPSA1NTY7CiAgICB0LnBlcmNlbnQgPSA4ODk7CiAgICB0LmFtcGVyc2FuZCA9IDcyMjsKICAgIHQucXVvdGVyaWdodCA9IDI3ODsKICAgIHQucGFyZW5sZWZ0ID0gMzMzOwogICAgdC5wYXJlbnJpZ2h0ID0gMzMzOwogICAgdC5hc3RlcmlzayA9IDM4OTsKICAgIHQucGx1cyA9IDU4NDsKICAgIHQuY29tbWEgPSAyNzg7CiAgICB0Lmh5cGhlbiA9IDMzMzsKICAgIHQucGVyaW9kID0gMjc4OwogICAgdC5zbGFzaCA9IDI3ODsKICAgIHQuemVybyA9IDU1NjsKICAgIHQub25lID0gNTU2OwogICAgdC50d28gPSA1NTY7CiAgICB0LnRocmVlID0gNTU2OwogICAgdC5mb3VyID0gNTU2OwogICAgdC5maXZlID0gNTU2OwogICAgdC5zaXggPSA1NTY7CiAgICB0LnNldmVuID0gNTU2OwogICAgdC5laWdodCA9IDU1NjsKICAgIHQubmluZSA9IDU1NjsKICAgIHQuY29sb24gPSAzMzM7CiAgICB0LnNlbWljb2xvbiA9IDMzMzsKICAgIHQubGVzcyA9IDU4NDsKICAgIHQuZXF1YWwgPSA1ODQ7CiAgICB0LmdyZWF0ZXIgPSA1ODQ7CiAgICB0LnF1ZXN0aW9uID0gNjExOwogICAgdC5hdCA9IDk3NTsKICAgIHQuQSA9IDcyMjsKICAgIHQuQiA9IDcyMjsKICAgIHQuQyA9IDcyMjsKICAgIHQuRCA9IDcyMjsKICAgIHQuRSA9IDY2NzsKICAgIHQuRiA9IDYxMTsKICAgIHQuRyA9IDc3ODsKICAgIHQuSCA9IDcyMjsKICAgIHQuSSA9IDI3ODsKICAgIHQuSiA9IDU1NjsKICAgIHQuSyA9IDcyMjsKICAgIHQuTCA9IDYxMTsKICAgIHQuTSA9IDgzMzsKICAgIHQuTiA9IDcyMjsKICAgIHQuTyA9IDc3ODsKICAgIHQuUCA9IDY2NzsKICAgIHQuUSA9IDc3ODsKICAgIHQuUiA9IDcyMjsKICAgIHQuUyA9IDY2NzsKICAgIHQuVCA9IDYxMTsKICAgIHQuVSA9IDcyMjsKICAgIHQuViA9IDY2NzsKICAgIHQuVyA9IDk0NDsKICAgIHQuWCA9IDY2NzsKICAgIHQuWSA9IDY2NzsKICAgIHQuWiA9IDYxMTsKICAgIHQuYnJhY2tldGxlZnQgPSAzMzM7CiAgICB0LmJhY2tzbGFzaCA9IDI3ODsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMzMzOwogICAgdC5hc2NpaWNpcmN1bSA9IDU4NDsKICAgIHQudW5kZXJzY29yZSA9IDU1NjsKICAgIHQucXVvdGVsZWZ0ID0gMjc4OwogICAgdC5hID0gNTU2OwogICAgdC5iID0gNjExOwogICAgdC5jID0gNTU2OwogICAgdC5kID0gNjExOwogICAgdC5lID0gNTU2OwogICAgdC5mID0gMzMzOwogICAgdC5nID0gNjExOwogICAgdC5oID0gNjExOwogICAgdC5pID0gMjc4OwogICAgdC5qID0gMjc4OwogICAgdC5rID0gNTU2OwogICAgdC5sID0gMjc4OwogICAgdC5tID0gODg5OwogICAgdC5uID0gNjExOwogICAgdC5vID0gNjExOwogICAgdC5wID0gNjExOwogICAgdC5xID0gNjExOwogICAgdC5yID0gMzg5OwogICAgdC5zID0gNTU2OwogICAgdC50ID0gMzMzOwogICAgdC51ID0gNjExOwogICAgdC52ID0gNTU2OwogICAgdC53ID0gNzc4OwogICAgdC54ID0gNTU2OwogICAgdC55ID0gNTU2OwogICAgdC56ID0gNTAwOwogICAgdC5icmFjZWxlZnQgPSAzODk7CiAgICB0LmJhciA9IDI4MDsKICAgIHQuYnJhY2VyaWdodCA9IDM4OTsKICAgIHQuYXNjaWl0aWxkZSA9IDU4NDsKICAgIHQuZXhjbGFtZG93biA9IDMzMzsKICAgIHQuY2VudCA9IDU1NjsKICAgIHQuc3RlcmxpbmcgPSA1NTY7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC55ZW4gPSA1NTY7CiAgICB0LmZsb3JpbiA9IDU1NjsKICAgIHQuc2VjdGlvbiA9IDU1NjsKICAgIHQuY3VycmVuY3kgPSA1NTY7CiAgICB0LnF1b3Rlc2luZ2xlID0gMjM4OwogICAgdC5xdW90ZWRibGxlZnQgPSA1MDA7CiAgICB0Lmd1aWxsZW1vdGxlZnQgPSA1NTY7CiAgICB0Lmd1aWxzaW5nbGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxzaW5nbHJpZ2h0ID0gMzMzOwogICAgdC5maSA9IDYxMTsKICAgIHQuZmwgPSA2MTE7CiAgICB0LmVuZGFzaCA9IDU1NjsKICAgIHQuZGFnZ2VyID0gNTU2OwogICAgdC5kYWdnZXJkYmwgPSA1NTY7CiAgICB0LnBlcmlvZGNlbnRlcmVkID0gMjc4OwogICAgdC5wYXJhZ3JhcGggPSA1NTY7CiAgICB0LmJ1bGxldCA9IDM1MDsKICAgIHQucXVvdGVzaW5nbGJhc2UgPSAyNzg7CiAgICB0LnF1b3RlZGJsYmFzZSA9IDUwMDsKICAgIHQucXVvdGVkYmxyaWdodCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90cmlnaHQgPSA1NTY7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA2MTE7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gMTAwMDsKICAgIHQuQUUgPSAxMDAwOwogICAgdC5vcmRmZW1pbmluZSA9IDM3MDsKICAgIHQuTHNsYXNoID0gNjExOwogICAgdC5Pc2xhc2ggPSA3Nzg7CiAgICB0Lk9FID0gMTAwMDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzY1OwogICAgdC5hZSA9IDg4OTsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNjExOwogICAgdC5vZSA9IDk0NDsKICAgIHQuZ2VybWFuZGJscyA9IDYxMTsKICAgIHQuSWRpZXJlc2lzID0gMjc4OwogICAgdC5lYWN1dGUgPSA1NTY7CiAgICB0LmFicmV2ZSA9IDU1NjsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDYxMTsKICAgIHQuZWNhcm9uID0gNTU2OwogICAgdC5ZZGllcmVzaXMgPSA2Njc7CiAgICB0LmRpdmlkZSA9IDU4NDsKICAgIHQuWWFjdXRlID0gNjY3OwogICAgdC5BY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuYWFjdXRlID0gNTU2OwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTU2OwogICAgdC5zY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LmVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTU2OwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA2MTE7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzM3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA1NTY7CiAgICB0LmFyaW5nID0gNTU2OwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTU2OwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDcyMjsKICAgIHQuYXRpbGRlID0gNTU2OwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSA1NTY7CiAgICB0LnNjZWRpbGxhID0gNTU2OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0OTQ7CiAgICB0LlJjYXJvbiA9IDcyMjsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC51Y2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LkFtYWNyb24gPSA3MjI7CiAgICB0LnJjYXJvbiA9IDM4OTsKICAgIHQuY2NlZGlsbGEgPSA1NTY7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNjY3OwogICAgdC5PbWFjcm9uID0gNzc4OwogICAgdC5SYWN1dGUgPSA3MjI7CiAgICB0LlNhY3V0ZSA9IDY2NzsKICAgIHQuZGNhcm9uID0gNzQzOwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDYxMTsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMzMzsKICAgIHQuT2dyYXZlID0gNzc4OwogICAgdC5BZ3JhdmUgPSA3MjI7CiAgICB0LkFicmV2ZSA9IDcyMjsKICAgIHQubXVsdGlwbHkgPSA1ODQ7CiAgICB0LnVhY3V0ZSA9IDYxMTsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQueWRpZXJlc2lzID0gNTU2OwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTU2OwogICAgdC5lZGllcmVzaXMgPSA1NTY7CiAgICB0LmNhY3V0ZSA9IDU1NjsKICAgIHQubmFjdXRlID0gNjExOwogICAgdC51bWFjcm9uID0gNjExOwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDI3ODsKICAgIHQucGx1c21pbnVzID0gNTg0OwogICAgdC5icm9rZW5iYXIgPSAyODA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3Mzc7CiAgICB0LkdicmV2ZSA9IDc3ODsKICAgIHQuSWRvdGFjY2VudCA9IDI3ODsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDM4OTsKICAgIHQub21hY3JvbiA9IDYxMTsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDcyMjsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzODk7CiAgICB0LmVvZ29uZWsgPSA1NTY7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDcyMjsKICAgIHQuQWRpZXJlc2lzID0gNzIyOwogICAgdC5lZ3JhdmUgPSA1NTY7CiAgICB0LnphY3V0ZSA9IDUwMDsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzc4OwogICAgdC5vYWN1dGUgPSA2MTE7CiAgICB0LmFtYWNyb24gPSA1NTY7CiAgICB0LnNhY3V0ZSA9IDU1NjsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDc3ODsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA2MTE7CiAgICB0LnR3b3N1cGVyaW9yID0gMzMzOwogICAgdC5PZGllcmVzaXMgPSA3Nzg7CiAgICB0Lm11ID0gNjExOwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA2MTE7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDYxMTsKICAgIHQudGhyZWVxdWFydGVycyA9IDgzNDsKICAgIHQuU2NlZGlsbGEgPSA2Njc7CiAgICB0LmxjYXJvbiA9IDQwMDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MYWN1dGUgPSA2MTE7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA1NTY7CiAgICB0LklncmF2ZSA9IDI3ODsKICAgIHQuSW1hY3JvbiA9IDI3ODsKICAgIHQuTGNhcm9uID0gNjExOwogICAgdC5vbmVoYWxmID0gODM0OwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNjExOwogICAgdC5udGlsZGUgPSA2MTE7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDU1NjsKICAgIHQuZ2JyZXZlID0gNjExOwogICAgdC5vbmVxdWFydGVyID0gODM0OwogICAgdC5TY2Fyb24gPSA2Njc7CiAgICB0LlNjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDc3ODsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA2MTE7CiAgICB0LkNjYXJvbiA9IDcyMjsKICAgIHQudWdyYXZlID0gNjExOwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA2MTE7CiAgICB0LlJjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGNvbW1hYWNjZW50ID0gNjExOwogICAgdC5BdGlsZGUgPSA3MjI7CiAgICB0LkFvZ29uZWsgPSA3MjI7CiAgICB0LkFyaW5nID0gNzIyOwogICAgdC5PdGlsZGUgPSA3Nzg7CiAgICB0Lnpkb3RhY2NlbnQgPSA1MDA7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDI3ODsKICAgIHQua2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5taW51cyA9IDU4NDsKICAgIHQuSWNpcmN1bWZsZXggPSAyNzg7CiAgICB0Lm5jYXJvbiA9IDYxMTsKICAgIHQudGNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5sb2dpY2Fsbm90ID0gNTg0OwogICAgdC5vZGllcmVzaXMgPSA2MTE7CiAgICB0LnVkaWVyZXNpcyA9IDYxMTsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuZXRoID0gNjExOwogICAgdC56Y2Fyb24gPSA1MDA7CiAgICB0Lm5jb21tYWFjY2VudCA9IDYxMTsKICAgIHQub25lc3VwZXJpb3IgPSAzMzM7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1NTY7CiAgfSk7CiAgdFsiSGVsdmV0aWNhLUJvbGRPYmxpcXVlIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI3ODsKICAgIHQuZXhjbGFtID0gMzMzOwogICAgdC5xdW90ZWRibCA9IDQ3NDsKICAgIHQubnVtYmVyc2lnbiA9IDU1NjsKICAgIHQuZG9sbGFyID0gNTU2OwogICAgdC5wZXJjZW50ID0gODg5OwogICAgdC5hbXBlcnNhbmQgPSA3MjI7CiAgICB0LnF1b3RlcmlnaHQgPSAyNzg7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSAzODk7CiAgICB0LnBsdXMgPSA1ODQ7CiAgICB0LmNvbW1hID0gMjc4OwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI3ODsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1NTY7CiAgICB0Lm9uZSA9IDU1NjsKICAgIHQudHdvID0gNTU2OwogICAgdC50aHJlZSA9IDU1NjsKICAgIHQuZm91ciA9IDU1NjsKICAgIHQuZml2ZSA9IDU1NjsKICAgIHQuc2l4ID0gNTU2OwogICAgdC5zZXZlbiA9IDU1NjsKICAgIHQuZWlnaHQgPSA1NTY7CiAgICB0Lm5pbmUgPSA1NTY7CiAgICB0LmNvbG9uID0gMzMzOwogICAgdC5zZW1pY29sb24gPSAzMzM7CiAgICB0Lmxlc3MgPSA1ODQ7CiAgICB0LmVxdWFsID0gNTg0OwogICAgdC5ncmVhdGVyID0gNTg0OwogICAgdC5xdWVzdGlvbiA9IDYxMTsKICAgIHQuYXQgPSA5NzU7CiAgICB0LkEgPSA3MjI7CiAgICB0LkIgPSA3MjI7CiAgICB0LkMgPSA3MjI7CiAgICB0LkQgPSA3MjI7CiAgICB0LkUgPSA2Njc7CiAgICB0LkYgPSA2MTE7CiAgICB0LkcgPSA3Nzg7CiAgICB0LkggPSA3MjI7CiAgICB0LkkgPSAyNzg7CiAgICB0LkogPSA1NTY7CiAgICB0LksgPSA3MjI7CiAgICB0LkwgPSA2MTE7CiAgICB0Lk0gPSA4MzM7CiAgICB0Lk4gPSA3MjI7CiAgICB0Lk8gPSA3Nzg7CiAgICB0LlAgPSA2Njc7CiAgICB0LlEgPSA3Nzg7CiAgICB0LlIgPSA3MjI7CiAgICB0LlMgPSA2Njc7CiAgICB0LlQgPSA2MTE7CiAgICB0LlUgPSA3MjI7CiAgICB0LlYgPSA2Njc7CiAgICB0LlcgPSA5NDQ7CiAgICB0LlggPSA2Njc7CiAgICB0LlkgPSA2Njc7CiAgICB0LlogPSA2MTE7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMzMzOwogICAgdC5iYWNrc2xhc2ggPSAyNzg7CiAgICB0LmJyYWNrZXRyaWdodCA9IDMzMzsKICAgIHQuYXNjaWljaXJjdW0gPSA1ODQ7CiAgICB0LnVuZGVyc2NvcmUgPSA1NTY7CiAgICB0LnF1b3RlbGVmdCA9IDI3ODsKICAgIHQuYSA9IDU1NjsKICAgIHQuYiA9IDYxMTsKICAgIHQuYyA9IDU1NjsKICAgIHQuZCA9IDYxMTsKICAgIHQuZSA9IDU1NjsKICAgIHQuZiA9IDMzMzsKICAgIHQuZyA9IDYxMTsKICAgIHQuaCA9IDYxMTsKICAgIHQuaSA9IDI3ODsKICAgIHQuaiA9IDI3ODsKICAgIHQuayA9IDU1NjsKICAgIHQubCA9IDI3ODsKICAgIHQubSA9IDg4OTsKICAgIHQubiA9IDYxMTsKICAgIHQubyA9IDYxMTsKICAgIHQucCA9IDYxMTsKICAgIHQucSA9IDYxMTsKICAgIHQuciA9IDM4OTsKICAgIHQucyA9IDU1NjsKICAgIHQudCA9IDMzMzsKICAgIHQudSA9IDYxMTsKICAgIHQudiA9IDU1NjsKICAgIHQudyA9IDc3ODsKICAgIHQueCA9IDU1NjsKICAgIHQueSA9IDU1NjsKICAgIHQueiA9IDUwMDsKICAgIHQuYnJhY2VsZWZ0ID0gMzg5OwogICAgdC5iYXIgPSAyODA7CiAgICB0LmJyYWNlcmlnaHQgPSAzODk7CiAgICB0LmFzY2lpdGlsZGUgPSA1ODQ7CiAgICB0LmV4Y2xhbWRvd24gPSAzMzM7CiAgICB0LmNlbnQgPSA1NTY7CiAgICB0LnN0ZXJsaW5nID0gNTU2OwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQueWVuID0gNTU2OwogICAgdC5mbG9yaW4gPSA1NTY7CiAgICB0LnNlY3Rpb24gPSA1NTY7CiAgICB0LmN1cnJlbmN5ID0gNTU2OwogICAgdC5xdW90ZXNpbmdsZSA9IDIzODsKICAgIHQucXVvdGVkYmxsZWZ0ID0gNTAwOwogICAgdC5ndWlsbGVtb3RsZWZ0ID0gNTU2OwogICAgdC5ndWlsc2luZ2xsZWZ0ID0gMzMzOwogICAgdC5ndWlsc2luZ2xyaWdodCA9IDMzMzsKICAgIHQuZmkgPSA2MTE7CiAgICB0LmZsID0gNjExOwogICAgdC5lbmRhc2ggPSA1NTY7CiAgICB0LmRhZ2dlciA9IDU1NjsKICAgIHQuZGFnZ2VyZGJsID0gNTU2OwogICAgdC5wZXJpb2RjZW50ZXJlZCA9IDI3ODsKICAgIHQucGFyYWdyYXBoID0gNTU2OwogICAgdC5idWxsZXQgPSAzNTA7CiAgICB0LnF1b3Rlc2luZ2xiYXNlID0gMjc4OwogICAgdC5xdW90ZWRibGJhc2UgPSA1MDA7CiAgICB0LnF1b3RlZGJscmlnaHQgPSA1MDA7CiAgICB0Lmd1aWxsZW1vdHJpZ2h0ID0gNTU2OwogICAgdC5lbGxpcHNpcyA9IDEwMDA7CiAgICB0LnBlcnRob3VzYW5kID0gMTAwMDsKICAgIHQucXVlc3Rpb25kb3duID0gNjExOwogICAgdC5ncmF2ZSA9IDMzMzsKICAgIHQuYWN1dGUgPSAzMzM7CiAgICB0LmNpcmN1bWZsZXggPSAzMzM7CiAgICB0LnRpbGRlID0gMzMzOwogICAgdC5tYWNyb24gPSAzMzM7CiAgICB0LmJyZXZlID0gMzMzOwogICAgdC5kb3RhY2NlbnQgPSAzMzM7CiAgICB0LmRpZXJlc2lzID0gMzMzOwogICAgdC5yaW5nID0gMzMzOwogICAgdC5jZWRpbGxhID0gMzMzOwogICAgdC5odW5nYXJ1bWxhdXQgPSAzMzM7CiAgICB0Lm9nb25layA9IDMzMzsKICAgIHQuY2Fyb24gPSAzMzM7CiAgICB0LmVtZGFzaCA9IDEwMDA7CiAgICB0LkFFID0gMTAwMDsKICAgIHQub3JkZmVtaW5pbmUgPSAzNzA7CiAgICB0LkxzbGFzaCA9IDYxMTsKICAgIHQuT3NsYXNoID0gNzc4OwogICAgdC5PRSA9IDEwMDA7CiAgICB0Lm9yZG1hc2N1bGluZSA9IDM2NTsKICAgIHQuYWUgPSA4ODk7CiAgICB0LmRvdGxlc3NpID0gMjc4OwogICAgdC5sc2xhc2ggPSAyNzg7CiAgICB0Lm9zbGFzaCA9IDYxMTsKICAgIHQub2UgPSA5NDQ7CiAgICB0Lmdlcm1hbmRibHMgPSA2MTE7CiAgICB0LklkaWVyZXNpcyA9IDI3ODsKICAgIHQuZWFjdXRlID0gNTU2OwogICAgdC5hYnJldmUgPSA1NTY7CiAgICB0LnVodW5nYXJ1bWxhdXQgPSA2MTE7CiAgICB0LmVjYXJvbiA9IDU1NjsKICAgIHQuWWRpZXJlc2lzID0gNjY3OwogICAgdC5kaXZpZGUgPSA1ODQ7CiAgICB0LllhY3V0ZSA9IDY2NzsKICAgIHQuQWNpcmN1bWZsZXggPSA3MjI7CiAgICB0LmFhY3V0ZSA9IDU1NjsKICAgIHQuVWNpcmN1bWZsZXggPSA3MjI7CiAgICB0LnlhY3V0ZSA9IDU1NjsKICAgIHQuc2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5lY2lyY3VtZmxleCA9IDU1NjsKICAgIHQuVXJpbmcgPSA3MjI7CiAgICB0LlVkaWVyZXNpcyA9IDcyMjsKICAgIHQuYW9nb25layA9IDU1NjsKICAgIHQuVWFjdXRlID0gNzIyOwogICAgdC51b2dvbmVrID0gNjExOwogICAgdC5FZGllcmVzaXMgPSA2Njc7CiAgICB0LkRjcm9hdCA9IDcyMjsKICAgIHQuY29tbWFhY2NlbnQgPSAyNTA7CiAgICB0LmNvcHlyaWdodCA9IDczNzsKICAgIHQuRW1hY3JvbiA9IDY2NzsKICAgIHQuY2Nhcm9uID0gNTU2OwogICAgdC5hcmluZyA9IDU1NjsKICAgIHQuTmNvbW1hYWNjZW50ID0gNzIyOwogICAgdC5sYWN1dGUgPSAyNzg7CiAgICB0LmFncmF2ZSA9IDU1NjsKICAgIHQuVGNvbW1hYWNjZW50ID0gNjExOwogICAgdC5DYWN1dGUgPSA3MjI7CiAgICB0LmF0aWxkZSA9IDU1NjsKICAgIHQuRWRvdGFjY2VudCA9IDY2NzsKICAgIHQuc2Nhcm9uID0gNTU2OwogICAgdC5zY2VkaWxsYSA9IDU1NjsKICAgIHQuaWFjdXRlID0gMjc4OwogICAgdC5sb3plbmdlID0gNDk0OwogICAgdC5SY2Fyb24gPSA3MjI7CiAgICB0Lkdjb21tYWFjY2VudCA9IDc3ODsKICAgIHQudWNpcmN1bWZsZXggPSA2MTE7CiAgICB0LmFjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5BbWFjcm9uID0gNzIyOwogICAgdC5yY2Fyb24gPSAzODk7CiAgICB0LmNjZWRpbGxhID0gNTU2OwogICAgdC5aZG90YWNjZW50ID0gNjExOwogICAgdC5UaG9ybiA9IDY2NzsKICAgIHQuT21hY3JvbiA9IDc3ODsKICAgIHQuUmFjdXRlID0gNzIyOwogICAgdC5TYWN1dGUgPSA2Njc7CiAgICB0LmRjYXJvbiA9IDc0MzsKICAgIHQuVW1hY3JvbiA9IDcyMjsKICAgIHQudXJpbmcgPSA2MTE7CiAgICB0LnRocmVlc3VwZXJpb3IgPSAzMzM7CiAgICB0Lk9ncmF2ZSA9IDc3ODsKICAgIHQuQWdyYXZlID0gNzIyOwogICAgdC5BYnJldmUgPSA3MjI7CiAgICB0Lm11bHRpcGx5ID0gNTg0OwogICAgdC51YWN1dGUgPSA2MTE7CiAgICB0LlRjYXJvbiA9IDYxMTsKICAgIHQucGFydGlhbGRpZmYgPSA0OTQ7CiAgICB0LnlkaWVyZXNpcyA9IDU1NjsKICAgIHQuTmFjdXRlID0gNzIyOwogICAgdC5pY2lyY3VtZmxleCA9IDI3ODsKICAgIHQuRWNpcmN1bWZsZXggPSA2Njc7CiAgICB0LmFkaWVyZXNpcyA9IDU1NjsKICAgIHQuZWRpZXJlc2lzID0gNTU2OwogICAgdC5jYWN1dGUgPSA1NTY7CiAgICB0Lm5hY3V0ZSA9IDYxMTsKICAgIHQudW1hY3JvbiA9IDYxMTsKICAgIHQuTmNhcm9uID0gNzIyOwogICAgdC5JYWN1dGUgPSAyNzg7CiAgICB0LnBsdXNtaW51cyA9IDU4NDsKICAgIHQuYnJva2VuYmFyID0gMjgwOwogICAgdC5yZWdpc3RlcmVkID0gNzM3OwogICAgdC5HYnJldmUgPSA3Nzg7CiAgICB0Lklkb3RhY2NlbnQgPSAyNzg7CiAgICB0LnN1bW1hdGlvbiA9IDYwMDsKICAgIHQuRWdyYXZlID0gNjY3OwogICAgdC5yYWN1dGUgPSAzODk7CiAgICB0Lm9tYWNyb24gPSA2MTE7CiAgICB0LlphY3V0ZSA9IDYxMTsKICAgIHQuWmNhcm9uID0gNjExOwogICAgdC5ncmVhdGVyZXF1YWwgPSA1NDk7CiAgICB0LkV0aCA9IDcyMjsKICAgIHQuQ2NlZGlsbGEgPSA3MjI7CiAgICB0Lmxjb21tYWFjY2VudCA9IDI3ODsKICAgIHQudGNhcm9uID0gMzg5OwogICAgdC5lb2dvbmVrID0gNTU2OwogICAgdC5Vb2dvbmVrID0gNzIyOwogICAgdC5BYWN1dGUgPSA3MjI7CiAgICB0LkFkaWVyZXNpcyA9IDcyMjsKICAgIHQuZWdyYXZlID0gNTU2OwogICAgdC56YWN1dGUgPSA1MDA7CiAgICB0LmlvZ29uZWsgPSAyNzg7CiAgICB0Lk9hY3V0ZSA9IDc3ODsKICAgIHQub2FjdXRlID0gNjExOwogICAgdC5hbWFjcm9uID0gNTU2OwogICAgdC5zYWN1dGUgPSA1NTY7CiAgICB0LmlkaWVyZXNpcyA9IDI3ODsKICAgIHQuT2NpcmN1bWZsZXggPSA3Nzg7CiAgICB0LlVncmF2ZSA9IDcyMjsKICAgIHQuRGVsdGEgPSA2MTI7CiAgICB0LnRob3JuID0gNjExOwogICAgdC50d29zdXBlcmlvciA9IDMzMzsKICAgIHQuT2RpZXJlc2lzID0gNzc4OwogICAgdC5tdSA9IDYxMTsKICAgIHQuaWdyYXZlID0gMjc4OwogICAgdC5vaHVuZ2FydW1sYXV0ID0gNjExOwogICAgdC5Fb2dvbmVrID0gNjY3OwogICAgdC5kY3JvYXQgPSA2MTE7CiAgICB0LnRocmVlcXVhcnRlcnMgPSA4MzQ7CiAgICB0LlNjZWRpbGxhID0gNjY3OwogICAgdC5sY2Fyb24gPSA0MDA7CiAgICB0Lktjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGFjdXRlID0gNjExOwogICAgdC50cmFkZW1hcmsgPSAxMDAwOwogICAgdC5lZG90YWNjZW50ID0gNTU2OwogICAgdC5JZ3JhdmUgPSAyNzg7CiAgICB0LkltYWNyb24gPSAyNzg7CiAgICB0LkxjYXJvbiA9IDYxMTsKICAgIHQub25laGFsZiA9IDgzNDsKICAgIHQubGVzc2VxdWFsID0gNTQ5OwogICAgdC5vY2lyY3VtZmxleCA9IDYxMTsKICAgIHQubnRpbGRlID0gNjExOwogICAgdC5VaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5FYWN1dGUgPSA2Njc7CiAgICB0LmVtYWNyb24gPSA1NTY7CiAgICB0LmdicmV2ZSA9IDYxMTsKICAgIHQub25lcXVhcnRlciA9IDgzNDsKICAgIHQuU2Nhcm9uID0gNjY3OwogICAgdC5TY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0Lk9odW5nYXJ1bWxhdXQgPSA3Nzg7CiAgICB0LmRlZ3JlZSA9IDQwMDsKICAgIHQub2dyYXZlID0gNjExOwogICAgdC5DY2Fyb24gPSA3MjI7CiAgICB0LnVncmF2ZSA9IDYxMTsKICAgIHQucmFkaWNhbCA9IDU0OTsKICAgIHQuRGNhcm9uID0gNzIyOwogICAgdC5yY29tbWFhY2NlbnQgPSAzODk7CiAgICB0Lk50aWxkZSA9IDcyMjsKICAgIHQub3RpbGRlID0gNjExOwogICAgdC5SY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0Lkxjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQXRpbGRlID0gNzIyOwogICAgdC5Bb2dvbmVrID0gNzIyOwogICAgdC5BcmluZyA9IDcyMjsKICAgIHQuT3RpbGRlID0gNzc4OwogICAgdC56ZG90YWNjZW50ID0gNTAwOwogICAgdC5FY2Fyb24gPSA2Njc7CiAgICB0LklvZ29uZWsgPSAyNzg7CiAgICB0Lmtjb21tYWFjY2VudCA9IDU1NjsKICAgIHQubWludXMgPSA1ODQ7CiAgICB0LkljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5uY2Fyb24gPSA2MTE7CiAgICB0LnRjb21tYWFjY2VudCA9IDMzMzsKICAgIHQubG9naWNhbG5vdCA9IDU4NDsKICAgIHQub2RpZXJlc2lzID0gNjExOwogICAgdC51ZGllcmVzaXMgPSA2MTE7CiAgICB0Lm5vdGVxdWFsID0gNTQ5OwogICAgdC5nY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LmV0aCA9IDYxMTsKICAgIHQuemNhcm9uID0gNTAwOwogICAgdC5uY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0Lm9uZXN1cGVyaW9yID0gMzMzOwogICAgdC5pbWFjcm9uID0gMjc4OwogICAgdC5FdXJvID0gNTU2OwogIH0pOwogIHRbIkhlbHZldGljYS1PYmxpcXVlIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI3ODsKICAgIHQuZXhjbGFtID0gMjc4OwogICAgdC5xdW90ZWRibCA9IDM1NTsKICAgIHQubnVtYmVyc2lnbiA9IDU1NjsKICAgIHQuZG9sbGFyID0gNTU2OwogICAgdC5wZXJjZW50ID0gODg5OwogICAgdC5hbXBlcnNhbmQgPSA2Njc7CiAgICB0LnF1b3RlcmlnaHQgPSAyMjI7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSAzODk7CiAgICB0LnBsdXMgPSA1ODQ7CiAgICB0LmNvbW1hID0gMjc4OwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI3ODsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1NTY7CiAgICB0Lm9uZSA9IDU1NjsKICAgIHQudHdvID0gNTU2OwogICAgdC50aHJlZSA9IDU1NjsKICAgIHQuZm91ciA9IDU1NjsKICAgIHQuZml2ZSA9IDU1NjsKICAgIHQuc2l4ID0gNTU2OwogICAgdC5zZXZlbiA9IDU1NjsKICAgIHQuZWlnaHQgPSA1NTY7CiAgICB0Lm5pbmUgPSA1NTY7CiAgICB0LmNvbG9uID0gMjc4OwogICAgdC5zZW1pY29sb24gPSAyNzg7CiAgICB0Lmxlc3MgPSA1ODQ7CiAgICB0LmVxdWFsID0gNTg0OwogICAgdC5ncmVhdGVyID0gNTg0OwogICAgdC5xdWVzdGlvbiA9IDU1NjsKICAgIHQuYXQgPSAxMDE1OwogICAgdC5BID0gNjY3OwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNzIyOwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjY3OwogICAgdC5GID0gNjExOwogICAgdC5HID0gNzc4OwogICAgdC5IID0gNzIyOwogICAgdC5JID0gMjc4OwogICAgdC5KID0gNTAwOwogICAgdC5LID0gNjY3OwogICAgdC5MID0gNTU2OwogICAgdC5NID0gODMzOwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzc4OwogICAgdC5QID0gNjY3OwogICAgdC5RID0gNzc4OwogICAgdC5SID0gNzIyOwogICAgdC5TID0gNjY3OwogICAgdC5UID0gNjExOwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNjY3OwogICAgdC5XID0gOTQ0OwogICAgdC5YID0gNjY3OwogICAgdC5ZID0gNjY3OwogICAgdC5aID0gNjExOwogICAgdC5icmFja2V0bGVmdCA9IDI3ODsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAyNzg7CiAgICB0LmFzY2lpY2lyY3VtID0gNDY5OwogICAgdC51bmRlcnNjb3JlID0gNTU2OwogICAgdC5xdW90ZWxlZnQgPSAyMjI7CiAgICB0LmEgPSA1NTY7CiAgICB0LmIgPSA1NTY7CiAgICB0LmMgPSA1MDA7CiAgICB0LmQgPSA1NTY7CiAgICB0LmUgPSA1NTY7CiAgICB0LmYgPSAyNzg7CiAgICB0LmcgPSA1NTY7CiAgICB0LmggPSA1NTY7CiAgICB0LmkgPSAyMjI7CiAgICB0LmogPSAyMjI7CiAgICB0LmsgPSA1MDA7CiAgICB0LmwgPSAyMjI7CiAgICB0Lm0gPSA4MzM7CiAgICB0Lm4gPSA1NTY7CiAgICB0Lm8gPSA1NTY7CiAgICB0LnAgPSA1NTY7CiAgICB0LnEgPSA1NTY7CiAgICB0LnIgPSAzMzM7CiAgICB0LnMgPSA1MDA7CiAgICB0LnQgPSAyNzg7CiAgICB0LnUgPSA1NTY7CiAgICB0LnYgPSA1MDA7CiAgICB0LncgPSA3MjI7CiAgICB0LnggPSA1MDA7CiAgICB0LnkgPSA1MDA7CiAgICB0LnogPSA1MDA7CiAgICB0LmJyYWNlbGVmdCA9IDMzNDsKICAgIHQuYmFyID0gMjYwOwogICAgdC5icmFjZXJpZ2h0ID0gMzM0OwogICAgdC5hc2NpaXRpbGRlID0gNTg0OwogICAgdC5leGNsYW1kb3duID0gMzMzOwogICAgdC5jZW50ID0gNTU2OwogICAgdC5zdGVybGluZyA9IDU1NjsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDU1NjsKICAgIHQuZmxvcmluID0gNTU2OwogICAgdC5zZWN0aW9uID0gNTU2OwogICAgdC5jdXJyZW5jeSA9IDU1NjsKICAgIHQucXVvdGVzaW5nbGUgPSAxOTE7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDU1NjsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNTAwOwogICAgdC5mbCA9IDUwMDsKICAgIHQuZW5kYXNoID0gNTU2OwogICAgdC5kYWdnZXIgPSA1NTY7CiAgICB0LmRhZ2dlcmRibCA9IDU1NjsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNzg7CiAgICB0LnBhcmFncmFwaCA9IDUzNzsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDIyMjsKICAgIHQucXVvdGVkYmxiYXNlID0gMzMzOwogICAgdC5xdW90ZWRibHJpZ2h0ID0gMzMzOwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDU1NjsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDYxMTsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDEwMDA7CiAgICB0Lm9yZGZlbWluaW5lID0gMzcwOwogICAgdC5Mc2xhc2ggPSA1NTY7CiAgICB0Lk9zbGFzaCA9IDc3ODsKICAgIHQuT0UgPSAxMDAwOwogICAgdC5vcmRtYXNjdWxpbmUgPSAzNjU7CiAgICB0LmFlID0gODg5OwogICAgdC5kb3RsZXNzaSA9IDI3ODsKICAgIHQubHNsYXNoID0gMjIyOwogICAgdC5vc2xhc2ggPSA2MTE7CiAgICB0Lm9lID0gOTQ0OwogICAgdC5nZXJtYW5kYmxzID0gNjExOwogICAgdC5JZGllcmVzaXMgPSAyNzg7CiAgICB0LmVhY3V0ZSA9IDU1NjsKICAgIHQuYWJyZXZlID0gNTU2OwogICAgdC51aHVuZ2FydW1sYXV0ID0gNTU2OwogICAgdC5lY2Fyb24gPSA1NTY7CiAgICB0LllkaWVyZXNpcyA9IDY2NzsKICAgIHQuZGl2aWRlID0gNTg0OwogICAgdC5ZYWN1dGUgPSA2Njc7CiAgICB0LkFjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hYWN1dGUgPSA1NTY7CiAgICB0LlVjaXJjdW1mbGV4ID0gNzIyOwogICAgdC55YWN1dGUgPSA1MDA7CiAgICB0LnNjb21tYWFjY2VudCA9IDUwMDsKICAgIHQuZWNpcmN1bWZsZXggPSA1NTY7CiAgICB0LlVyaW5nID0gNzIyOwogICAgdC5VZGllcmVzaXMgPSA3MjI7CiAgICB0LmFvZ29uZWsgPSA1NTY7CiAgICB0LlVhY3V0ZSA9IDcyMjsKICAgIHQudW9nb25layA9IDU1NjsKICAgIHQuRWRpZXJlc2lzID0gNjY3OwogICAgdC5EY3JvYXQgPSA3MjI7CiAgICB0LmNvbW1hYWNjZW50ID0gMjUwOwogICAgdC5jb3B5cmlnaHQgPSA3Mzc7CiAgICB0LkVtYWNyb24gPSA2Njc7CiAgICB0LmNjYXJvbiA9IDUwMDsKICAgIHQuYXJpbmcgPSA1NTY7CiAgICB0Lk5jb21tYWFjY2VudCA9IDcyMjsKICAgIHQubGFjdXRlID0gMjIyOwogICAgdC5hZ3JhdmUgPSA1NTY7CiAgICB0LlRjb21tYWFjY2VudCA9IDYxMTsKICAgIHQuQ2FjdXRlID0gNzIyOwogICAgdC5hdGlsZGUgPSA1NTY7CiAgICB0LkVkb3RhY2NlbnQgPSA2Njc7CiAgICB0LnNjYXJvbiA9IDUwMDsKICAgIHQuc2NlZGlsbGEgPSA1MDA7CiAgICB0LmlhY3V0ZSA9IDI3ODsKICAgIHQubG96ZW5nZSA9IDQ3MTsKICAgIHQuUmNhcm9uID0gNzIyOwogICAgdC5HY29tbWFhY2NlbnQgPSA3Nzg7CiAgICB0LnVjaXJjdW1mbGV4ID0gNTU2OwogICAgdC5hY2lyY3VtZmxleCA9IDU1NjsKICAgIHQuQW1hY3JvbiA9IDY2NzsKICAgIHQucmNhcm9uID0gMzMzOwogICAgdC5jY2VkaWxsYSA9IDUwMDsKICAgIHQuWmRvdGFjY2VudCA9IDYxMTsKICAgIHQuVGhvcm4gPSA2Njc7CiAgICB0Lk9tYWNyb24gPSA3Nzg7CiAgICB0LlJhY3V0ZSA9IDcyMjsKICAgIHQuU2FjdXRlID0gNjY3OwogICAgdC5kY2Fyb24gPSA2NDM7CiAgICB0LlVtYWNyb24gPSA3MjI7CiAgICB0LnVyaW5nID0gNTU2OwogICAgdC50aHJlZXN1cGVyaW9yID0gMzMzOwogICAgdC5PZ3JhdmUgPSA3Nzg7CiAgICB0LkFncmF2ZSA9IDY2NzsKICAgIHQuQWJyZXZlID0gNjY3OwogICAgdC5tdWx0aXBseSA9IDU4NDsKICAgIHQudWFjdXRlID0gNTU2OwogICAgdC5UY2Fyb24gPSA2MTE7CiAgICB0LnBhcnRpYWxkaWZmID0gNDc2OwogICAgdC55ZGllcmVzaXMgPSA1MDA7CiAgICB0Lk5hY3V0ZSA9IDcyMjsKICAgIHQuaWNpcmN1bWZsZXggPSAyNzg7CiAgICB0LkVjaXJjdW1mbGV4ID0gNjY3OwogICAgdC5hZGllcmVzaXMgPSA1NTY7CiAgICB0LmVkaWVyZXNpcyA9IDU1NjsKICAgIHQuY2FjdXRlID0gNTAwOwogICAgdC5uYWN1dGUgPSA1NTY7CiAgICB0LnVtYWNyb24gPSA1NTY7CiAgICB0Lk5jYXJvbiA9IDcyMjsKICAgIHQuSWFjdXRlID0gMjc4OwogICAgdC5wbHVzbWludXMgPSA1ODQ7CiAgICB0LmJyb2tlbmJhciA9IDI2MDsKICAgIHQucmVnaXN0ZXJlZCA9IDczNzsKICAgIHQuR2JyZXZlID0gNzc4OwogICAgdC5JZG90YWNjZW50ID0gMjc4OwogICAgdC5zdW1tYXRpb24gPSA2MDA7CiAgICB0LkVncmF2ZSA9IDY2NzsKICAgIHQucmFjdXRlID0gMzMzOwogICAgdC5vbWFjcm9uID0gNTU2OwogICAgdC5aYWN1dGUgPSA2MTE7CiAgICB0LlpjYXJvbiA9IDYxMTsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5FdGggPSA3MjI7CiAgICB0LkNjZWRpbGxhID0gNzIyOwogICAgdC5sY29tbWFhY2NlbnQgPSAyMjI7CiAgICB0LnRjYXJvbiA9IDMxNzsKICAgIHQuZW9nb25layA9IDU1NjsKICAgIHQuVW9nb25layA9IDcyMjsKICAgIHQuQWFjdXRlID0gNjY3OwogICAgdC5BZGllcmVzaXMgPSA2Njc7CiAgICB0LmVncmF2ZSA9IDU1NjsKICAgIHQuemFjdXRlID0gNTAwOwogICAgdC5pb2dvbmVrID0gMjIyOwogICAgdC5PYWN1dGUgPSA3Nzg7CiAgICB0Lm9hY3V0ZSA9IDU1NjsKICAgIHQuYW1hY3JvbiA9IDU1NjsKICAgIHQuc2FjdXRlID0gNTAwOwogICAgdC5pZGllcmVzaXMgPSAyNzg7CiAgICB0Lk9jaXJjdW1mbGV4ID0gNzc4OwogICAgdC5VZ3JhdmUgPSA3MjI7CiAgICB0LkRlbHRhID0gNjEyOwogICAgdC50aG9ybiA9IDU1NjsKICAgIHQudHdvc3VwZXJpb3IgPSAzMzM7CiAgICB0Lk9kaWVyZXNpcyA9IDc3ODsKICAgIHQubXUgPSA1NTY7CiAgICB0LmlncmF2ZSA9IDI3ODsKICAgIHQub2h1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuRW9nb25layA9IDY2NzsKICAgIHQuZGNyb2F0ID0gNTU2OwogICAgdC50aHJlZXF1YXJ0ZXJzID0gODM0OwogICAgdC5TY2VkaWxsYSA9IDY2NzsKICAgIHQubGNhcm9uID0gMjk5OwogICAgdC5LY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LkxhY3V0ZSA9IDU1NjsKICAgIHQudHJhZGVtYXJrID0gMTAwMDsKICAgIHQuZWRvdGFjY2VudCA9IDU1NjsKICAgIHQuSWdyYXZlID0gMjc4OwogICAgdC5JbWFjcm9uID0gMjc4OwogICAgdC5MY2Fyb24gPSA1NTY7CiAgICB0Lm9uZWhhbGYgPSA4MzQ7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1NTY7CiAgICB0Lm50aWxkZSA9IDU1NjsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjY3OwogICAgdC5lbWFjcm9uID0gNTU2OwogICAgdC5nYnJldmUgPSA1NTY7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA4MzQ7CiAgICB0LlNjYXJvbiA9IDY2NzsKICAgIHQuU2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzc4OwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDU1NjsKICAgIHQuQ2Nhcm9uID0gNzIyOwogICAgdC51Z3JhdmUgPSA1NTY7CiAgICB0LnJhZGljYWwgPSA0NTM7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5OdGlsZGUgPSA3MjI7CiAgICB0Lm90aWxkZSA9IDU1NjsKICAgIHQuUmNvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LkF0aWxkZSA9IDY2NzsKICAgIHQuQW9nb25layA9IDY2NzsKICAgIHQuQXJpbmcgPSA2Njc7CiAgICB0Lk90aWxkZSA9IDc3ODsKICAgIHQuemRvdGFjY2VudCA9IDUwMDsKICAgIHQuRWNhcm9uID0gNjY3OwogICAgdC5Jb2dvbmVrID0gMjc4OwogICAgdC5rY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lm1pbnVzID0gNTg0OwogICAgdC5JY2lyY3VtZmxleCA9IDI3ODsKICAgIHQubmNhcm9uID0gNTU2OwogICAgdC50Y29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LmxvZ2ljYWxub3QgPSA1ODQ7CiAgICB0Lm9kaWVyZXNpcyA9IDU1NjsKICAgIHQudWRpZXJlc2lzID0gNTU2OwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5ldGggPSA1NTY7CiAgICB0LnpjYXJvbiA9IDUwMDsKICAgIHQubmNvbW1hYWNjZW50ID0gNTU2OwogICAgdC5vbmVzdXBlcmlvciA9IDMzMzsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDU1NjsKICB9KTsKICB0LlN5bWJvbCA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjUwOwogICAgdC5leGNsYW0gPSAzMzM7CiAgICB0LnVuaXZlcnNhbCA9IDcxMzsKICAgIHQubnVtYmVyc2lnbiA9IDUwMDsKICAgIHQuZXhpc3RlbnRpYWwgPSA1NDk7CiAgICB0LnBlcmNlbnQgPSA4MzM7CiAgICB0LmFtcGVyc2FuZCA9IDc3ODsKICAgIHQuc3VjaHRoYXQgPSA0Mzk7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2ttYXRoID0gNTAwOwogICAgdC5wbHVzID0gNTQ5OwogICAgdC5jb21tYSA9IDI1MDsKICAgIHQubWludXMgPSA1NDk7CiAgICB0LnBlcmlvZCA9IDI1MDsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1MDA7CiAgICB0Lm9uZSA9IDUwMDsKICAgIHQudHdvID0gNTAwOwogICAgdC50aHJlZSA9IDUwMDsKICAgIHQuZm91ciA9IDUwMDsKICAgIHQuZml2ZSA9IDUwMDsKICAgIHQuc2l4ID0gNTAwOwogICAgdC5zZXZlbiA9IDUwMDsKICAgIHQuZWlnaHQgPSA1MDA7CiAgICB0Lm5pbmUgPSA1MDA7CiAgICB0LmNvbG9uID0gMjc4OwogICAgdC5zZW1pY29sb24gPSAyNzg7CiAgICB0Lmxlc3MgPSA1NDk7CiAgICB0LmVxdWFsID0gNTQ5OwogICAgdC5ncmVhdGVyID0gNTQ5OwogICAgdC5xdWVzdGlvbiA9IDQ0NDsKICAgIHQuY29uZ3J1ZW50ID0gNTQ5OwogICAgdC5BbHBoYSA9IDcyMjsKICAgIHQuQmV0YSA9IDY2NzsKICAgIHQuQ2hpID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQuRXBzaWxvbiA9IDYxMTsKICAgIHQuUGhpID0gNzYzOwogICAgdC5HYW1tYSA9IDYwMzsKICAgIHQuRXRhID0gNzIyOwogICAgdC5Jb3RhID0gMzMzOwogICAgdC50aGV0YTEgPSA2MzE7CiAgICB0LkthcHBhID0gNzIyOwogICAgdC5MYW1iZGEgPSA2ODY7CiAgICB0Lk11ID0gODg5OwogICAgdC5OdSA9IDcyMjsKICAgIHQuT21pY3JvbiA9IDcyMjsKICAgIHQuUGkgPSA3Njg7CiAgICB0LlRoZXRhID0gNzQxOwogICAgdC5SaG8gPSA1NTY7CiAgICB0LlNpZ21hID0gNTkyOwogICAgdC5UYXUgPSA2MTE7CiAgICB0LlVwc2lsb24gPSA2OTA7CiAgICB0LnNpZ21hMSA9IDQzOTsKICAgIHQuT21lZ2EgPSA3Njg7CiAgICB0LlhpID0gNjQ1OwogICAgdC5Qc2kgPSA3OTU7CiAgICB0LlpldGEgPSA2MTE7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMzMzOwogICAgdC50aGVyZWZvcmUgPSA4NjM7CiAgICB0LmJyYWNrZXRyaWdodCA9IDMzMzsKICAgIHQucGVycGVuZGljdWxhciA9IDY1ODsKICAgIHQudW5kZXJzY29yZSA9IDUwMDsKICAgIHQucmFkaWNhbGV4ID0gNTAwOwogICAgdC5hbHBoYSA9IDYzMTsKICAgIHQuYmV0YSA9IDU0OTsKICAgIHQuY2hpID0gNTQ5OwogICAgdC5kZWx0YSA9IDQ5NDsKICAgIHQuZXBzaWxvbiA9IDQzOTsKICAgIHQucGhpID0gNTIxOwogICAgdC5nYW1tYSA9IDQxMTsKICAgIHQuZXRhID0gNjAzOwogICAgdC5pb3RhID0gMzI5OwogICAgdC5waGkxID0gNjAzOwogICAgdC5rYXBwYSA9IDU0OTsKICAgIHQubGFtYmRhID0gNTQ5OwogICAgdC5tdSA9IDU3NjsKICAgIHQubnUgPSA1MjE7CiAgICB0Lm9taWNyb24gPSA1NDk7CiAgICB0LnBpID0gNTQ5OwogICAgdC50aGV0YSA9IDUyMTsKICAgIHQucmhvID0gNTQ5OwogICAgdC5zaWdtYSA9IDYwMzsKICAgIHQudGF1ID0gNDM5OwogICAgdC51cHNpbG9uID0gNTc2OwogICAgdC5vbWVnYTEgPSA3MTM7CiAgICB0Lm9tZWdhID0gNjg2OwogICAgdC54aSA9IDQ5MzsKICAgIHQucHNpID0gNjg2OwogICAgdC56ZXRhID0gNDk0OwogICAgdC5icmFjZWxlZnQgPSA0ODA7CiAgICB0LmJhciA9IDIwMDsKICAgIHQuYnJhY2VyaWdodCA9IDQ4MDsKICAgIHQuc2ltaWxhciA9IDU0OTsKICAgIHQuRXVybyA9IDc1MDsKICAgIHQuVXBzaWxvbjEgPSA2MjA7CiAgICB0Lm1pbnV0ZSA9IDI0NzsKICAgIHQubGVzc2VxdWFsID0gNTQ5OwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQuaW5maW5pdHkgPSA3MTM7CiAgICB0LmZsb3JpbiA9IDUwMDsKICAgIHQuY2x1YiA9IDc1MzsKICAgIHQuZGlhbW9uZCA9IDc1MzsKICAgIHQuaGVhcnQgPSA3NTM7CiAgICB0LnNwYWRlID0gNzUzOwogICAgdC5hcnJvd2JvdGggPSAxMDQyOwogICAgdC5hcnJvd2xlZnQgPSA5ODc7CiAgICB0LmFycm93dXAgPSA2MDM7CiAgICB0LmFycm93cmlnaHQgPSA5ODc7CiAgICB0LmFycm93ZG93biA9IDYwMzsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5wbHVzbWludXMgPSA1NDk7CiAgICB0LnNlY29uZCA9IDQxMTsKICAgIHQuZ3JlYXRlcmVxdWFsID0gNTQ5OwogICAgdC5tdWx0aXBseSA9IDU0OTsKICAgIHQucHJvcG9ydGlvbmFsID0gNzEzOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQuYnVsbGV0ID0gNDYwOwogICAgdC5kaXZpZGUgPSA1NDk7CiAgICB0Lm5vdGVxdWFsID0gNTQ5OwogICAgdC5lcXVpdmFsZW5jZSA9IDU0OTsKICAgIHQuYXBwcm94ZXF1YWwgPSA1NDk7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQuYXJyb3d2ZXJ0ZXggPSA2MDM7CiAgICB0LmFycm93aG9yaXpleCA9IDEwMDA7CiAgICB0LmNhcnJpYWdlcmV0dXJuID0gNjU4OwogICAgdC5hbGVwaCA9IDgyMzsKICAgIHQuSWZyYWt0dXIgPSA2ODY7CiAgICB0LlJmcmFrdHVyID0gNzk1OwogICAgdC53ZWllcnN0cmFzcyA9IDk4NzsKICAgIHQuY2lyY2xlbXVsdGlwbHkgPSA3Njg7CiAgICB0LmNpcmNsZXBsdXMgPSA3Njg7CiAgICB0LmVtcHR5c2V0ID0gODIzOwogICAgdC5pbnRlcnNlY3Rpb24gPSA3Njg7CiAgICB0LnVuaW9uID0gNzY4OwogICAgdC5wcm9wZXJzdXBlcnNldCA9IDcxMzsKICAgIHQucmVmbGV4c3VwZXJzZXQgPSA3MTM7CiAgICB0Lm5vdHN1YnNldCA9IDcxMzsKICAgIHQucHJvcGVyc3Vic2V0ID0gNzEzOwogICAgdC5yZWZsZXhzdWJzZXQgPSA3MTM7CiAgICB0LmVsZW1lbnQgPSA3MTM7CiAgICB0Lm5vdGVsZW1lbnQgPSA3MTM7CiAgICB0LmFuZ2xlID0gNzY4OwogICAgdC5ncmFkaWVudCA9IDcxMzsKICAgIHQucmVnaXN0ZXJzZXJpZiA9IDc5MDsKICAgIHQuY29weXJpZ2h0c2VyaWYgPSA3OTA7CiAgICB0LnRyYWRlbWFya3NlcmlmID0gODkwOwogICAgdC5wcm9kdWN0ID0gODIzOwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5kb3RtYXRoID0gMjUwOwogICAgdC5sb2dpY2Fsbm90ID0gNzEzOwogICAgdC5sb2dpY2FsYW5kID0gNjAzOwogICAgdC5sb2dpY2Fsb3IgPSA2MDM7CiAgICB0LmFycm93ZGJsYm90aCA9IDEwNDI7CiAgICB0LmFycm93ZGJsbGVmdCA9IDk4NzsKICAgIHQuYXJyb3dkYmx1cCA9IDYwMzsKICAgIHQuYXJyb3dkYmxyaWdodCA9IDk4NzsKICAgIHQuYXJyb3dkYmxkb3duID0gNjAzOwogICAgdC5sb3plbmdlID0gNDk0OwogICAgdC5hbmdsZWxlZnQgPSAzMjk7CiAgICB0LnJlZ2lzdGVyc2FucyA9IDc5MDsKICAgIHQuY29weXJpZ2h0c2FucyA9IDc5MDsKICAgIHQudHJhZGVtYXJrc2FucyA9IDc4NjsKICAgIHQuc3VtbWF0aW9uID0gNzEzOwogICAgdC5wYXJlbmxlZnR0cCA9IDM4NDsKICAgIHQucGFyZW5sZWZ0ZXggPSAzODQ7CiAgICB0LnBhcmVubGVmdGJ0ID0gMzg0OwogICAgdC5icmFja2V0bGVmdHRwID0gMzg0OwogICAgdC5icmFja2V0bGVmdGV4ID0gMzg0OwogICAgdC5icmFja2V0bGVmdGJ0ID0gMzg0OwogICAgdC5icmFjZWxlZnR0cCA9IDQ5NDsKICAgIHQuYnJhY2VsZWZ0bWlkID0gNDk0OwogICAgdC5icmFjZWxlZnRidCA9IDQ5NDsKICAgIHQuYnJhY2VleCA9IDQ5NDsKICAgIHQuYW5nbGVyaWdodCA9IDMyOTsKICAgIHQuaW50ZWdyYWwgPSAyNzQ7CiAgICB0LmludGVncmFsdHAgPSA2ODY7CiAgICB0LmludGVncmFsZXggPSA2ODY7CiAgICB0LmludGVncmFsYnQgPSA2ODY7CiAgICB0LnBhcmVucmlnaHR0cCA9IDM4NDsKICAgIHQucGFyZW5yaWdodGV4ID0gMzg0OwogICAgdC5wYXJlbnJpZ2h0YnQgPSAzODQ7CiAgICB0LmJyYWNrZXRyaWdodHRwID0gMzg0OwogICAgdC5icmFja2V0cmlnaHRleCA9IDM4NDsKICAgIHQuYnJhY2tldHJpZ2h0YnQgPSAzODQ7CiAgICB0LmJyYWNlcmlnaHR0cCA9IDQ5NDsKICAgIHQuYnJhY2VyaWdodG1pZCA9IDQ5NDsKICAgIHQuYnJhY2VyaWdodGJ0ID0gNDk0OwogICAgdC5hcHBsZSA9IDc5MDsKICB9KTsKICB0WyJUaW1lcy1Sb21hbiJdID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNTA7CiAgICB0LmV4Y2xhbSA9IDMzMzsKICAgIHQucXVvdGVkYmwgPSA0MDg7CiAgICB0Lm51bWJlcnNpZ24gPSA1MDA7CiAgICB0LmRvbGxhciA9IDUwMDsKICAgIHQucGVyY2VudCA9IDgzMzsKICAgIHQuYW1wZXJzYW5kID0gNzc4OwogICAgdC5xdW90ZXJpZ2h0ID0gMzMzOwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gNTAwOwogICAgdC5wbHVzID0gNTY0OwogICAgdC5jb21tYSA9IDI1MDsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNTA7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTAwOwogICAgdC5vbmUgPSA1MDA7CiAgICB0LnR3byA9IDUwMDsKICAgIHQudGhyZWUgPSA1MDA7CiAgICB0LmZvdXIgPSA1MDA7CiAgICB0LmZpdmUgPSA1MDA7CiAgICB0LnNpeCA9IDUwMDsKICAgIHQuc2V2ZW4gPSA1MDA7CiAgICB0LmVpZ2h0ID0gNTAwOwogICAgdC5uaW5lID0gNTAwOwogICAgdC5jb2xvbiA9IDI3ODsKICAgIHQuc2VtaWNvbG9uID0gMjc4OwogICAgdC5sZXNzID0gNTY0OwogICAgdC5lcXVhbCA9IDU2NDsKICAgIHQuZ3JlYXRlciA9IDU2NDsKICAgIHQucXVlc3Rpb24gPSA0NDQ7CiAgICB0LmF0ID0gOTIxOwogICAgdC5BID0gNzIyOwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNjY3OwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjExOwogICAgdC5GID0gNTU2OwogICAgdC5HID0gNzIyOwogICAgdC5IID0gNzIyOwogICAgdC5JID0gMzMzOwogICAgdC5KID0gMzg5OwogICAgdC5LID0gNzIyOwogICAgdC5MID0gNjExOwogICAgdC5NID0gODg5OwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzIyOwogICAgdC5QID0gNTU2OwogICAgdC5RID0gNzIyOwogICAgdC5SID0gNjY3OwogICAgdC5TID0gNTU2OwogICAgdC5UID0gNjExOwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNzIyOwogICAgdC5XID0gOTQ0OwogICAgdC5YID0gNzIyOwogICAgdC5ZID0gNzIyOwogICAgdC5aID0gNjExOwogICAgdC5icmFja2V0bGVmdCA9IDMzMzsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAzMzM7CiAgICB0LmFzY2lpY2lyY3VtID0gNDY5OwogICAgdC51bmRlcnNjb3JlID0gNTAwOwogICAgdC5xdW90ZWxlZnQgPSAzMzM7CiAgICB0LmEgPSA0NDQ7CiAgICB0LmIgPSA1MDA7CiAgICB0LmMgPSA0NDQ7CiAgICB0LmQgPSA1MDA7CiAgICB0LmUgPSA0NDQ7CiAgICB0LmYgPSAzMzM7CiAgICB0LmcgPSA1MDA7CiAgICB0LmggPSA1MDA7CiAgICB0LmkgPSAyNzg7CiAgICB0LmogPSAyNzg7CiAgICB0LmsgPSA1MDA7CiAgICB0LmwgPSAyNzg7CiAgICB0Lm0gPSA3Nzg7CiAgICB0Lm4gPSA1MDA7CiAgICB0Lm8gPSA1MDA7CiAgICB0LnAgPSA1MDA7CiAgICB0LnEgPSA1MDA7CiAgICB0LnIgPSAzMzM7CiAgICB0LnMgPSAzODk7CiAgICB0LnQgPSAyNzg7CiAgICB0LnUgPSA1MDA7CiAgICB0LnYgPSA1MDA7CiAgICB0LncgPSA3MjI7CiAgICB0LnggPSA1MDA7CiAgICB0LnkgPSA1MDA7CiAgICB0LnogPSA0NDQ7CiAgICB0LmJyYWNlbGVmdCA9IDQ4MDsKICAgIHQuYmFyID0gMjAwOwogICAgdC5icmFjZXJpZ2h0ID0gNDgwOwogICAgdC5hc2NpaXRpbGRlID0gNTQxOwogICAgdC5leGNsYW1kb3duID0gMzMzOwogICAgdC5jZW50ID0gNTAwOwogICAgdC5zdGVybGluZyA9IDUwMDsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDUwMDsKICAgIHQuZmxvcmluID0gNTAwOwogICAgdC5zZWN0aW9uID0gNTAwOwogICAgdC5jdXJyZW5jeSA9IDUwMDsKICAgIHQucXVvdGVzaW5nbGUgPSAxODA7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDQ0NDsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDUwMDsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNTU2OwogICAgdC5mbCA9IDU1NjsKICAgIHQuZW5kYXNoID0gNTAwOwogICAgdC5kYWdnZXIgPSA1MDA7CiAgICB0LmRhZ2dlcmRibCA9IDUwMDsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNTA7CiAgICB0LnBhcmFncmFwaCA9IDQ1MzsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDMzMzsKICAgIHQucXVvdGVkYmxiYXNlID0gNDQ0OwogICAgdC5xdW90ZWRibHJpZ2h0ID0gNDQ0OwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDUwMDsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDQ0NDsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDg4OTsKICAgIHQub3JkZmVtaW5pbmUgPSAyNzY7CiAgICB0LkxzbGFzaCA9IDYxMTsKICAgIHQuT3NsYXNoID0gNzIyOwogICAgdC5PRSA9IDg4OTsKICAgIHQub3JkbWFzY3VsaW5lID0gMzEwOwogICAgdC5hZSA9IDY2NzsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNTAwOwogICAgdC5vZSA9IDcyMjsKICAgIHQuZ2VybWFuZGJscyA9IDUwMDsKICAgIHQuSWRpZXJlc2lzID0gMzMzOwogICAgdC5lYWN1dGUgPSA0NDQ7CiAgICB0LmFicmV2ZSA9IDQ0NDsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDUwMDsKICAgIHQuZWNhcm9uID0gNDQ0OwogICAgdC5ZZGllcmVzaXMgPSA3MjI7CiAgICB0LmRpdmlkZSA9IDU2NDsKICAgIHQuWWFjdXRlID0gNzIyOwogICAgdC5BY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuYWFjdXRlID0gNDQ0OwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTAwOwogICAgdC5zY29tbWFhY2NlbnQgPSAzODk7CiAgICB0LmVjaXJjdW1mbGV4ID0gNDQ0OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNDQ0OwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1MDA7CiAgICB0LkVkaWVyZXNpcyA9IDYxMTsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzYwOwogICAgdC5FbWFjcm9uID0gNjExOwogICAgdC5jY2Fyb24gPSA0NDQ7CiAgICB0LmFyaW5nID0gNDQ0OwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNDQ0OwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDY2NzsKICAgIHQuYXRpbGRlID0gNDQ0OwogICAgdC5FZG90YWNjZW50ID0gNjExOwogICAgdC5zY2Fyb24gPSAzODk7CiAgICB0LnNjZWRpbGxhID0gMzg5OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0NzE7CiAgICB0LlJjYXJvbiA9IDY2NzsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC51Y2lyY3VtZmxleCA9IDUwMDsKICAgIHQuYWNpcmN1bWZsZXggPSA0NDQ7CiAgICB0LkFtYWNyb24gPSA3MjI7CiAgICB0LnJjYXJvbiA9IDMzMzsKICAgIHQuY2NlZGlsbGEgPSA0NDQ7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNTU2OwogICAgdC5PbWFjcm9uID0gNzIyOwogICAgdC5SYWN1dGUgPSA2Njc7CiAgICB0LlNhY3V0ZSA9IDU1NjsKICAgIHQuZGNhcm9uID0gNTg4OwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDUwMDsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMwMDsKICAgIHQuT2dyYXZlID0gNzIyOwogICAgdC5BZ3JhdmUgPSA3MjI7CiAgICB0LkFicmV2ZSA9IDcyMjsKICAgIHQubXVsdGlwbHkgPSA1NjQ7CiAgICB0LnVhY3V0ZSA9IDUwMDsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ3NjsKICAgIHQueWRpZXJlc2lzID0gNTAwOwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWRpZXJlc2lzID0gNDQ0OwogICAgdC5lZGllcmVzaXMgPSA0NDQ7CiAgICB0LmNhY3V0ZSA9IDQ0NDsKICAgIHQubmFjdXRlID0gNTAwOwogICAgdC51bWFjcm9uID0gNTAwOwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDMzMzsKICAgIHQucGx1c21pbnVzID0gNTY0OwogICAgdC5icm9rZW5iYXIgPSAyMDA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3NjA7CiAgICB0LkdicmV2ZSA9IDcyMjsKICAgIHQuSWRvdGFjY2VudCA9IDMzMzsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2MTE7CiAgICB0LnJhY3V0ZSA9IDMzMzsKICAgIHQub21hY3JvbiA9IDUwMDsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDY2NzsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzMjY7CiAgICB0LmVvZ29uZWsgPSA0NDQ7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDcyMjsKICAgIHQuQWRpZXJlc2lzID0gNzIyOwogICAgdC5lZ3JhdmUgPSA0NDQ7CiAgICB0LnphY3V0ZSA9IDQ0NDsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzIyOwogICAgdC5vYWN1dGUgPSA1MDA7CiAgICB0LmFtYWNyb24gPSA0NDQ7CiAgICB0LnNhY3V0ZSA9IDM4OTsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1MDA7CiAgICB0LnR3b3N1cGVyaW9yID0gMzAwOwogICAgdC5PZGllcmVzaXMgPSA3MjI7CiAgICB0Lm11ID0gNTAwOwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1MDA7CiAgICB0LkVvZ29uZWsgPSA2MTE7CiAgICB0LmRjcm9hdCA9IDUwMDsKICAgIHQudGhyZWVxdWFydGVycyA9IDc1MDsKICAgIHQuU2NlZGlsbGEgPSA1NTY7CiAgICB0LmxjYXJvbiA9IDM0NDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC5MYWN1dGUgPSA2MTE7CiAgICB0LnRyYWRlbWFyayA9IDk4MDsKICAgIHQuZWRvdGFjY2VudCA9IDQ0NDsKICAgIHQuSWdyYXZlID0gMzMzOwogICAgdC5JbWFjcm9uID0gMzMzOwogICAgdC5MY2Fyb24gPSA2MTE7CiAgICB0Lm9uZWhhbGYgPSA3NTA7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1MDA7CiAgICB0Lm50aWxkZSA9IDUwMDsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjExOwogICAgdC5lbWFjcm9uID0gNDQ0OwogICAgdC5nYnJldmUgPSA1MDA7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA3NTA7CiAgICB0LlNjYXJvbiA9IDU1NjsKICAgIHQuU2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDUwMDsKICAgIHQuQ2Nhcm9uID0gNjY3OwogICAgdC51Z3JhdmUgPSA1MDA7CiAgICB0LnJhZGljYWwgPSA0NTM7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5OdGlsZGUgPSA3MjI7CiAgICB0Lm90aWxkZSA9IDUwMDsKICAgIHQuUmNvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkF0aWxkZSA9IDcyMjsKICAgIHQuQW9nb25layA9IDcyMjsKICAgIHQuQXJpbmcgPSA3MjI7CiAgICB0Lk90aWxkZSA9IDcyMjsKICAgIHQuemRvdGFjY2VudCA9IDQ0NDsKICAgIHQuRWNhcm9uID0gNjExOwogICAgdC5Jb2dvbmVrID0gMzMzOwogICAgdC5rY29tbWFhY2NlbnQgPSA1MDA7CiAgICB0Lm1pbnVzID0gNTY0OwogICAgdC5JY2lyY3VtZmxleCA9IDMzMzsKICAgIHQubmNhcm9uID0gNTAwOwogICAgdC50Y29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LmxvZ2ljYWxub3QgPSA1NjQ7CiAgICB0Lm9kaWVyZXNpcyA9IDUwMDsKICAgIHQudWRpZXJlc2lzID0gNTAwOwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5ldGggPSA1MDA7CiAgICB0LnpjYXJvbiA9IDQ0NDsKICAgIHQubmNvbW1hYWNjZW50ID0gNTAwOwogICAgdC5vbmVzdXBlcmlvciA9IDMwMDsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDUwMDsKICB9KTsKICB0WyJUaW1lcy1Cb2xkIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI1MDsKICAgIHQuZXhjbGFtID0gMzMzOwogICAgdC5xdW90ZWRibCA9IDU1NTsKICAgIHQubnVtYmVyc2lnbiA9IDUwMDsKICAgIHQuZG9sbGFyID0gNTAwOwogICAgdC5wZXJjZW50ID0gMTAwMDsKICAgIHQuYW1wZXJzYW5kID0gODMzOwogICAgdC5xdW90ZXJpZ2h0ID0gMzMzOwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gNTAwOwogICAgdC5wbHVzID0gNTcwOwogICAgdC5jb21tYSA9IDI1MDsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNTA7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTAwOwogICAgdC5vbmUgPSA1MDA7CiAgICB0LnR3byA9IDUwMDsKICAgIHQudGhyZWUgPSA1MDA7CiAgICB0LmZvdXIgPSA1MDA7CiAgICB0LmZpdmUgPSA1MDA7CiAgICB0LnNpeCA9IDUwMDsKICAgIHQuc2V2ZW4gPSA1MDA7CiAgICB0LmVpZ2h0ID0gNTAwOwogICAgdC5uaW5lID0gNTAwOwogICAgdC5jb2xvbiA9IDMzMzsKICAgIHQuc2VtaWNvbG9uID0gMzMzOwogICAgdC5sZXNzID0gNTcwOwogICAgdC5lcXVhbCA9IDU3MDsKICAgIHQuZ3JlYXRlciA9IDU3MDsKICAgIHQucXVlc3Rpb24gPSA1MDA7CiAgICB0LmF0ID0gOTMwOwogICAgdC5BID0gNzIyOwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNzIyOwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjY3OwogICAgdC5GID0gNjExOwogICAgdC5HID0gNzc4OwogICAgdC5IID0gNzc4OwogICAgdC5JID0gMzg5OwogICAgdC5KID0gNTAwOwogICAgdC5LID0gNzc4OwogICAgdC5MID0gNjY3OwogICAgdC5NID0gOTQ0OwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzc4OwogICAgdC5QID0gNjExOwogICAgdC5RID0gNzc4OwogICAgdC5SID0gNzIyOwogICAgdC5TID0gNTU2OwogICAgdC5UID0gNjY3OwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNzIyOwogICAgdC5XID0gMTAwMDsKICAgIHQuWCA9IDcyMjsKICAgIHQuWSA9IDcyMjsKICAgIHQuWiA9IDY2NzsKICAgIHQuYnJhY2tldGxlZnQgPSAzMzM7CiAgICB0LmJhY2tzbGFzaCA9IDI3ODsKICAgIHQuYnJhY2tldHJpZ2h0ID0gMzMzOwogICAgdC5hc2NpaWNpcmN1bSA9IDU4MTsKICAgIHQudW5kZXJzY29yZSA9IDUwMDsKICAgIHQucXVvdGVsZWZ0ID0gMzMzOwogICAgdC5hID0gNTAwOwogICAgdC5iID0gNTU2OwogICAgdC5jID0gNDQ0OwogICAgdC5kID0gNTU2OwogICAgdC5lID0gNDQ0OwogICAgdC5mID0gMzMzOwogICAgdC5nID0gNTAwOwogICAgdC5oID0gNTU2OwogICAgdC5pID0gMjc4OwogICAgdC5qID0gMzMzOwogICAgdC5rID0gNTU2OwogICAgdC5sID0gMjc4OwogICAgdC5tID0gODMzOwogICAgdC5uID0gNTU2OwogICAgdC5vID0gNTAwOwogICAgdC5wID0gNTU2OwogICAgdC5xID0gNTU2OwogICAgdC5yID0gNDQ0OwogICAgdC5zID0gMzg5OwogICAgdC50ID0gMzMzOwogICAgdC51ID0gNTU2OwogICAgdC52ID0gNTAwOwogICAgdC53ID0gNzIyOwogICAgdC54ID0gNTAwOwogICAgdC55ID0gNTAwOwogICAgdC56ID0gNDQ0OwogICAgdC5icmFjZWxlZnQgPSAzOTQ7CiAgICB0LmJhciA9IDIyMDsKICAgIHQuYnJhY2VyaWdodCA9IDM5NDsKICAgIHQuYXNjaWl0aWxkZSA9IDUyMDsKICAgIHQuZXhjbGFtZG93biA9IDMzMzsKICAgIHQuY2VudCA9IDUwMDsKICAgIHQuc3RlcmxpbmcgPSA1MDA7CiAgICB0LmZyYWN0aW9uID0gMTY3OwogICAgdC55ZW4gPSA1MDA7CiAgICB0LmZsb3JpbiA9IDUwMDsKICAgIHQuc2VjdGlvbiA9IDUwMDsKICAgIHQuY3VycmVuY3kgPSA1MDA7CiAgICB0LnF1b3Rlc2luZ2xlID0gMjc4OwogICAgdC5xdW90ZWRibGxlZnQgPSA1MDA7CiAgICB0Lmd1aWxsZW1vdGxlZnQgPSA1MDA7CiAgICB0Lmd1aWxzaW5nbGxlZnQgPSAzMzM7CiAgICB0Lmd1aWxzaW5nbHJpZ2h0ID0gMzMzOwogICAgdC5maSA9IDU1NjsKICAgIHQuZmwgPSA1NTY7CiAgICB0LmVuZGFzaCA9IDUwMDsKICAgIHQuZGFnZ2VyID0gNTAwOwogICAgdC5kYWdnZXJkYmwgPSA1MDA7CiAgICB0LnBlcmlvZGNlbnRlcmVkID0gMjUwOwogICAgdC5wYXJhZ3JhcGggPSA1NDA7CiAgICB0LmJ1bGxldCA9IDM1MDsKICAgIHQucXVvdGVzaW5nbGJhc2UgPSAzMzM7CiAgICB0LnF1b3RlZGJsYmFzZSA9IDUwMDsKICAgIHQucXVvdGVkYmxyaWdodCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90cmlnaHQgPSA1MDA7CiAgICB0LmVsbGlwc2lzID0gMTAwMDsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA1MDA7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gMTAwMDsKICAgIHQuQUUgPSAxMDAwOwogICAgdC5vcmRmZW1pbmluZSA9IDMwMDsKICAgIHQuTHNsYXNoID0gNjY3OwogICAgdC5Pc2xhc2ggPSA3Nzg7CiAgICB0Lk9FID0gMTAwMDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzMwOwogICAgdC5hZSA9IDcyMjsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNTAwOwogICAgdC5vZSA9IDcyMjsKICAgIHQuZ2VybWFuZGJscyA9IDU1NjsKICAgIHQuSWRpZXJlc2lzID0gMzg5OwogICAgdC5lYWN1dGUgPSA0NDQ7CiAgICB0LmFicmV2ZSA9IDUwMDsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuZWNhcm9uID0gNDQ0OwogICAgdC5ZZGllcmVzaXMgPSA3MjI7CiAgICB0LmRpdmlkZSA9IDU3MDsKICAgIHQuWWFjdXRlID0gNzIyOwogICAgdC5BY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuYWFjdXRlID0gNTAwOwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNTAwOwogICAgdC5zY29tbWFhY2NlbnQgPSAzODk7CiAgICB0LmVjaXJjdW1mbGV4ID0gNDQ0OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTAwOwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1NTY7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzQ3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA0NDQ7CiAgICB0LmFyaW5nID0gNTAwOwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTAwOwogICAgdC5UY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LkNhY3V0ZSA9IDcyMjsKICAgIHQuYXRpbGRlID0gNTAwOwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSAzODk7CiAgICB0LnNjZWRpbGxhID0gMzg5OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0OTQ7CiAgICB0LlJjYXJvbiA9IDcyMjsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC51Y2lyY3VtZmxleCA9IDU1NjsKICAgIHQuYWNpcmN1bWZsZXggPSA1MDA7CiAgICB0LkFtYWNyb24gPSA3MjI7CiAgICB0LnJjYXJvbiA9IDQ0NDsKICAgIHQuY2NlZGlsbGEgPSA0NDQ7CiAgICB0Llpkb3RhY2NlbnQgPSA2Njc7CiAgICB0LlRob3JuID0gNjExOwogICAgdC5PbWFjcm9uID0gNzc4OwogICAgdC5SYWN1dGUgPSA3MjI7CiAgICB0LlNhY3V0ZSA9IDU1NjsKICAgIHQuZGNhcm9uID0gNjcyOwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDU1NjsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMwMDsKICAgIHQuT2dyYXZlID0gNzc4OwogICAgdC5BZ3JhdmUgPSA3MjI7CiAgICB0LkFicmV2ZSA9IDcyMjsKICAgIHQubXVsdGlwbHkgPSA1NzA7CiAgICB0LnVhY3V0ZSA9IDU1NjsKICAgIHQuVGNhcm9uID0gNjY3OwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQueWRpZXJlc2lzID0gNTAwOwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTAwOwogICAgdC5lZGllcmVzaXMgPSA0NDQ7CiAgICB0LmNhY3V0ZSA9IDQ0NDsKICAgIHQubmFjdXRlID0gNTU2OwogICAgdC51bWFjcm9uID0gNTU2OwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDM4OTsKICAgIHQucGx1c21pbnVzID0gNTcwOwogICAgdC5icm9rZW5iYXIgPSAyMjA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3NDc7CiAgICB0LkdicmV2ZSA9IDc3ODsKICAgIHQuSWRvdGFjY2VudCA9IDM4OTsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDQ0NDsKICAgIHQub21hY3JvbiA9IDUwMDsKICAgIHQuWmFjdXRlID0gNjY3OwogICAgdC5aY2Fyb24gPSA2Njc7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDcyMjsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSA0MTY7CiAgICB0LmVvZ29uZWsgPSA0NDQ7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDcyMjsKICAgIHQuQWRpZXJlc2lzID0gNzIyOwogICAgdC5lZ3JhdmUgPSA0NDQ7CiAgICB0LnphY3V0ZSA9IDQ0NDsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzc4OwogICAgdC5vYWN1dGUgPSA1MDA7CiAgICB0LmFtYWNyb24gPSA1MDA7CiAgICB0LnNhY3V0ZSA9IDM4OTsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDc3ODsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1NTY7CiAgICB0LnR3b3N1cGVyaW9yID0gMzAwOwogICAgdC5PZGllcmVzaXMgPSA3Nzg7CiAgICB0Lm11ID0gNTU2OwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1MDA7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDU1NjsKICAgIHQudGhyZWVxdWFydGVycyA9IDc1MDsKICAgIHQuU2NlZGlsbGEgPSA1NTY7CiAgICB0LmxjYXJvbiA9IDM5NDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNzc4OwogICAgdC5MYWN1dGUgPSA2Njc7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA0NDQ7CiAgICB0LklncmF2ZSA9IDM4OTsKICAgIHQuSW1hY3JvbiA9IDM4OTsKICAgIHQuTGNhcm9uID0gNjY3OwogICAgdC5vbmVoYWxmID0gNzUwOwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNTAwOwogICAgdC5udGlsZGUgPSA1NTY7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDQ0NDsKICAgIHQuZ2JyZXZlID0gNTAwOwogICAgdC5vbmVxdWFydGVyID0gNzUwOwogICAgdC5TY2Fyb24gPSA1NTY7CiAgICB0LlNjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDc3ODsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA1MDA7CiAgICB0LkNjYXJvbiA9IDcyMjsKICAgIHQudWdyYXZlID0gNTU2OwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDQ0NDsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA1MDA7CiAgICB0LlJjb21tYWFjY2VudCA9IDcyMjsKICAgIHQuTGNvbW1hYWNjZW50ID0gNjY3OwogICAgdC5BdGlsZGUgPSA3MjI7CiAgICB0LkFvZ29uZWsgPSA3MjI7CiAgICB0LkFyaW5nID0gNzIyOwogICAgdC5PdGlsZGUgPSA3Nzg7CiAgICB0Lnpkb3RhY2NlbnQgPSA0NDQ7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDM4OTsKICAgIHQua2NvbW1hYWNjZW50ID0gNTU2OwogICAgdC5taW51cyA9IDU3MDsKICAgIHQuSWNpcmN1bWZsZXggPSAzODk7CiAgICB0Lm5jYXJvbiA9IDU1NjsKICAgIHQudGNvbW1hYWNjZW50ID0gMzMzOwogICAgdC5sb2dpY2Fsbm90ID0gNTcwOwogICAgdC5vZGllcmVzaXMgPSA1MDA7CiAgICB0LnVkaWVyZXNpcyA9IDU1NjsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDUwMDsKICAgIHQuZXRoID0gNTAwOwogICAgdC56Y2Fyb24gPSA0NDQ7CiAgICB0Lm5jb21tYWFjY2VudCA9IDU1NjsKICAgIHQub25lc3VwZXJpb3IgPSAzMDA7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1MDA7CiAgfSk7CiAgdFsiVGltZXMtQm9sZEl0YWxpYyJdID0gKDAsIF9jb3JlX3V0aWxzLmdldExvb2t1cFRhYmxlRmFjdG9yeSkoZnVuY3Rpb24gKHQpIHsKICAgIHQuc3BhY2UgPSAyNTA7CiAgICB0LmV4Y2xhbSA9IDM4OTsKICAgIHQucXVvdGVkYmwgPSA1NTU7CiAgICB0Lm51bWJlcnNpZ24gPSA1MDA7CiAgICB0LmRvbGxhciA9IDUwMDsKICAgIHQucGVyY2VudCA9IDgzMzsKICAgIHQuYW1wZXJzYW5kID0gNzc4OwogICAgdC5xdW90ZXJpZ2h0ID0gMzMzOwogICAgdC5wYXJlbmxlZnQgPSAzMzM7CiAgICB0LnBhcmVucmlnaHQgPSAzMzM7CiAgICB0LmFzdGVyaXNrID0gNTAwOwogICAgdC5wbHVzID0gNTcwOwogICAgdC5jb21tYSA9IDI1MDsKICAgIHQuaHlwaGVuID0gMzMzOwogICAgdC5wZXJpb2QgPSAyNTA7CiAgICB0LnNsYXNoID0gMjc4OwogICAgdC56ZXJvID0gNTAwOwogICAgdC5vbmUgPSA1MDA7CiAgICB0LnR3byA9IDUwMDsKICAgIHQudGhyZWUgPSA1MDA7CiAgICB0LmZvdXIgPSA1MDA7CiAgICB0LmZpdmUgPSA1MDA7CiAgICB0LnNpeCA9IDUwMDsKICAgIHQuc2V2ZW4gPSA1MDA7CiAgICB0LmVpZ2h0ID0gNTAwOwogICAgdC5uaW5lID0gNTAwOwogICAgdC5jb2xvbiA9IDMzMzsKICAgIHQuc2VtaWNvbG9uID0gMzMzOwogICAgdC5sZXNzID0gNTcwOwogICAgdC5lcXVhbCA9IDU3MDsKICAgIHQuZ3JlYXRlciA9IDU3MDsKICAgIHQucXVlc3Rpb24gPSA1MDA7CiAgICB0LmF0ID0gODMyOwogICAgdC5BID0gNjY3OwogICAgdC5CID0gNjY3OwogICAgdC5DID0gNjY3OwogICAgdC5EID0gNzIyOwogICAgdC5FID0gNjY3OwogICAgdC5GID0gNjY3OwogICAgdC5HID0gNzIyOwogICAgdC5IID0gNzc4OwogICAgdC5JID0gMzg5OwogICAgdC5KID0gNTAwOwogICAgdC5LID0gNjY3OwogICAgdC5MID0gNjExOwogICAgdC5NID0gODg5OwogICAgdC5OID0gNzIyOwogICAgdC5PID0gNzIyOwogICAgdC5QID0gNjExOwogICAgdC5RID0gNzIyOwogICAgdC5SID0gNjY3OwogICAgdC5TID0gNTU2OwogICAgdC5UID0gNjExOwogICAgdC5VID0gNzIyOwogICAgdC5WID0gNjY3OwogICAgdC5XID0gODg5OwogICAgdC5YID0gNjY3OwogICAgdC5ZID0gNjExOwogICAgdC5aID0gNjExOwogICAgdC5icmFja2V0bGVmdCA9IDMzMzsKICAgIHQuYmFja3NsYXNoID0gMjc4OwogICAgdC5icmFja2V0cmlnaHQgPSAzMzM7CiAgICB0LmFzY2lpY2lyY3VtID0gNTcwOwogICAgdC51bmRlcnNjb3JlID0gNTAwOwogICAgdC5xdW90ZWxlZnQgPSAzMzM7CiAgICB0LmEgPSA1MDA7CiAgICB0LmIgPSA1MDA7CiAgICB0LmMgPSA0NDQ7CiAgICB0LmQgPSA1MDA7CiAgICB0LmUgPSA0NDQ7CiAgICB0LmYgPSAzMzM7CiAgICB0LmcgPSA1MDA7CiAgICB0LmggPSA1NTY7CiAgICB0LmkgPSAyNzg7CiAgICB0LmogPSAyNzg7CiAgICB0LmsgPSA1MDA7CiAgICB0LmwgPSAyNzg7CiAgICB0Lm0gPSA3Nzg7CiAgICB0Lm4gPSA1NTY7CiAgICB0Lm8gPSA1MDA7CiAgICB0LnAgPSA1MDA7CiAgICB0LnEgPSA1MDA7CiAgICB0LnIgPSAzODk7CiAgICB0LnMgPSAzODk7CiAgICB0LnQgPSAyNzg7CiAgICB0LnUgPSA1NTY7CiAgICB0LnYgPSA0NDQ7CiAgICB0LncgPSA2Njc7CiAgICB0LnggPSA1MDA7CiAgICB0LnkgPSA0NDQ7CiAgICB0LnogPSAzODk7CiAgICB0LmJyYWNlbGVmdCA9IDM0ODsKICAgIHQuYmFyID0gMjIwOwogICAgdC5icmFjZXJpZ2h0ID0gMzQ4OwogICAgdC5hc2NpaXRpbGRlID0gNTcwOwogICAgdC5leGNsYW1kb3duID0gMzg5OwogICAgdC5jZW50ID0gNTAwOwogICAgdC5zdGVybGluZyA9IDUwMDsKICAgIHQuZnJhY3Rpb24gPSAxNjc7CiAgICB0LnllbiA9IDUwMDsKICAgIHQuZmxvcmluID0gNTAwOwogICAgdC5zZWN0aW9uID0gNTAwOwogICAgdC5jdXJyZW5jeSA9IDUwMDsKICAgIHQucXVvdGVzaW5nbGUgPSAyNzg7CiAgICB0LnF1b3RlZGJsbGVmdCA9IDUwMDsKICAgIHQuZ3VpbGxlbW90bGVmdCA9IDUwMDsKICAgIHQuZ3VpbHNpbmdsbGVmdCA9IDMzMzsKICAgIHQuZ3VpbHNpbmdscmlnaHQgPSAzMzM7CiAgICB0LmZpID0gNTU2OwogICAgdC5mbCA9IDU1NjsKICAgIHQuZW5kYXNoID0gNTAwOwogICAgdC5kYWdnZXIgPSA1MDA7CiAgICB0LmRhZ2dlcmRibCA9IDUwMDsKICAgIHQucGVyaW9kY2VudGVyZWQgPSAyNTA7CiAgICB0LnBhcmFncmFwaCA9IDUwMDsKICAgIHQuYnVsbGV0ID0gMzUwOwogICAgdC5xdW90ZXNpbmdsYmFzZSA9IDMzMzsKICAgIHQucXVvdGVkYmxiYXNlID0gNTAwOwogICAgdC5xdW90ZWRibHJpZ2h0ID0gNTAwOwogICAgdC5ndWlsbGVtb3RyaWdodCA9IDUwMDsKICAgIHQuZWxsaXBzaXMgPSAxMDAwOwogICAgdC5wZXJ0aG91c2FuZCA9IDEwMDA7CiAgICB0LnF1ZXN0aW9uZG93biA9IDUwMDsKICAgIHQuZ3JhdmUgPSAzMzM7CiAgICB0LmFjdXRlID0gMzMzOwogICAgdC5jaXJjdW1mbGV4ID0gMzMzOwogICAgdC50aWxkZSA9IDMzMzsKICAgIHQubWFjcm9uID0gMzMzOwogICAgdC5icmV2ZSA9IDMzMzsKICAgIHQuZG90YWNjZW50ID0gMzMzOwogICAgdC5kaWVyZXNpcyA9IDMzMzsKICAgIHQucmluZyA9IDMzMzsKICAgIHQuY2VkaWxsYSA9IDMzMzsKICAgIHQuaHVuZ2FydW1sYXV0ID0gMzMzOwogICAgdC5vZ29uZWsgPSAzMzM7CiAgICB0LmNhcm9uID0gMzMzOwogICAgdC5lbWRhc2ggPSAxMDAwOwogICAgdC5BRSA9IDk0NDsKICAgIHQub3JkZmVtaW5pbmUgPSAyNjY7CiAgICB0LkxzbGFzaCA9IDYxMTsKICAgIHQuT3NsYXNoID0gNzIyOwogICAgdC5PRSA9IDk0NDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzAwOwogICAgdC5hZSA9IDcyMjsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNTAwOwogICAgdC5vZSA9IDcyMjsKICAgIHQuZ2VybWFuZGJscyA9IDUwMDsKICAgIHQuSWRpZXJlc2lzID0gMzg5OwogICAgdC5lYWN1dGUgPSA0NDQ7CiAgICB0LmFicmV2ZSA9IDUwMDsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDU1NjsKICAgIHQuZWNhcm9uID0gNDQ0OwogICAgdC5ZZGllcmVzaXMgPSA2MTE7CiAgICB0LmRpdmlkZSA9IDU3MDsKICAgIHQuWWFjdXRlID0gNjExOwogICAgdC5BY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWFjdXRlID0gNTAwOwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNDQ0OwogICAgdC5zY29tbWFhY2NlbnQgPSAzODk7CiAgICB0LmVjaXJjdW1mbGV4ID0gNDQ0OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTAwOwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1NTY7CiAgICB0LkVkaWVyZXNpcyA9IDY2NzsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzQ3OwogICAgdC5FbWFjcm9uID0gNjY3OwogICAgdC5jY2Fyb24gPSA0NDQ7CiAgICB0LmFyaW5nID0gNTAwOwogICAgdC5OY29tbWFhY2NlbnQgPSA3MjI7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTAwOwogICAgdC5UY29tbWFhY2NlbnQgPSA2MTE7CiAgICB0LkNhY3V0ZSA9IDY2NzsKICAgIHQuYXRpbGRlID0gNTAwOwogICAgdC5FZG90YWNjZW50ID0gNjY3OwogICAgdC5zY2Fyb24gPSAzODk7CiAgICB0LnNjZWRpbGxhID0gMzg5OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0OTQ7CiAgICB0LlJjYXJvbiA9IDY2NzsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC51Y2lyY3VtZmxleCA9IDU1NjsKICAgIHQuYWNpcmN1bWZsZXggPSA1MDA7CiAgICB0LkFtYWNyb24gPSA2Njc7CiAgICB0LnJjYXJvbiA9IDM4OTsKICAgIHQuY2NlZGlsbGEgPSA0NDQ7CiAgICB0Llpkb3RhY2NlbnQgPSA2MTE7CiAgICB0LlRob3JuID0gNjExOwogICAgdC5PbWFjcm9uID0gNzIyOwogICAgdC5SYWN1dGUgPSA2Njc7CiAgICB0LlNhY3V0ZSA9IDU1NjsKICAgIHQuZGNhcm9uID0gNjA4OwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDU1NjsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMwMDsKICAgIHQuT2dyYXZlID0gNzIyOwogICAgdC5BZ3JhdmUgPSA2Njc7CiAgICB0LkFicmV2ZSA9IDY2NzsKICAgIHQubXVsdGlwbHkgPSA1NzA7CiAgICB0LnVhY3V0ZSA9IDU1NjsKICAgIHQuVGNhcm9uID0gNjExOwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ5NDsKICAgIHQueWRpZXJlc2lzID0gNDQ0OwogICAgdC5OYWN1dGUgPSA3MjI7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDY2NzsKICAgIHQuYWRpZXJlc2lzID0gNTAwOwogICAgdC5lZGllcmVzaXMgPSA0NDQ7CiAgICB0LmNhY3V0ZSA9IDQ0NDsKICAgIHQubmFjdXRlID0gNTU2OwogICAgdC51bWFjcm9uID0gNTU2OwogICAgdC5OY2Fyb24gPSA3MjI7CiAgICB0LklhY3V0ZSA9IDM4OTsKICAgIHQucGx1c21pbnVzID0gNTcwOwogICAgdC5icm9rZW5iYXIgPSAyMjA7CiAgICB0LnJlZ2lzdGVyZWQgPSA3NDc7CiAgICB0LkdicmV2ZSA9IDcyMjsKICAgIHQuSWRvdGFjY2VudCA9IDM4OTsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2Njc7CiAgICB0LnJhY3V0ZSA9IDM4OTsKICAgIHQub21hY3JvbiA9IDUwMDsKICAgIHQuWmFjdXRlID0gNjExOwogICAgdC5aY2Fyb24gPSA2MTE7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDY2NzsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzNjY7CiAgICB0LmVvZ29uZWsgPSA0NDQ7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDY2NzsKICAgIHQuQWRpZXJlc2lzID0gNjY3OwogICAgdC5lZ3JhdmUgPSA0NDQ7CiAgICB0LnphY3V0ZSA9IDM4OTsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzIyOwogICAgdC5vYWN1dGUgPSA1MDA7CiAgICB0LmFtYWNyb24gPSA1MDA7CiAgICB0LnNhY3V0ZSA9IDM4OTsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1MDA7CiAgICB0LnR3b3N1cGVyaW9yID0gMzAwOwogICAgdC5PZGllcmVzaXMgPSA3MjI7CiAgICB0Lm11ID0gNTc2OwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1MDA7CiAgICB0LkVvZ29uZWsgPSA2Njc7CiAgICB0LmRjcm9hdCA9IDUwMDsKICAgIHQudGhyZWVxdWFydGVycyA9IDc1MDsKICAgIHQuU2NlZGlsbGEgPSA1NTY7CiAgICB0LmxjYXJvbiA9IDM4MjsKICAgIHQuS2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MYWN1dGUgPSA2MTE7CiAgICB0LnRyYWRlbWFyayA9IDEwMDA7CiAgICB0LmVkb3RhY2NlbnQgPSA0NDQ7CiAgICB0LklncmF2ZSA9IDM4OTsKICAgIHQuSW1hY3JvbiA9IDM4OTsKICAgIHQuTGNhcm9uID0gNjExOwogICAgdC5vbmVoYWxmID0gNzUwOwogICAgdC5sZXNzZXF1YWwgPSA1NDk7CiAgICB0Lm9jaXJjdW1mbGV4ID0gNTAwOwogICAgdC5udGlsZGUgPSA1NTY7CiAgICB0LlVodW5nYXJ1bWxhdXQgPSA3MjI7CiAgICB0LkVhY3V0ZSA9IDY2NzsKICAgIHQuZW1hY3JvbiA9IDQ0NDsKICAgIHQuZ2JyZXZlID0gNTAwOwogICAgdC5vbmVxdWFydGVyID0gNzUwOwogICAgdC5TY2Fyb24gPSA1NTY7CiAgICB0LlNjb21tYWFjY2VudCA9IDU1NjsKICAgIHQuT2h1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuZGVncmVlID0gNDAwOwogICAgdC5vZ3JhdmUgPSA1MDA7CiAgICB0LkNjYXJvbiA9IDY2NzsKICAgIHQudWdyYXZlID0gNTU2OwogICAgdC5yYWRpY2FsID0gNTQ5OwogICAgdC5EY2Fyb24gPSA3MjI7CiAgICB0LnJjb21tYWFjY2VudCA9IDM4OTsKICAgIHQuTnRpbGRlID0gNzIyOwogICAgdC5vdGlsZGUgPSA1MDA7CiAgICB0LlJjb21tYWFjY2VudCA9IDY2NzsKICAgIHQuTGNvbW1hYWNjZW50ID0gNjExOwogICAgdC5BdGlsZGUgPSA2Njc7CiAgICB0LkFvZ29uZWsgPSA2Njc7CiAgICB0LkFyaW5nID0gNjY3OwogICAgdC5PdGlsZGUgPSA3MjI7CiAgICB0Lnpkb3RhY2NlbnQgPSAzODk7CiAgICB0LkVjYXJvbiA9IDY2NzsKICAgIHQuSW9nb25layA9IDM4OTsKICAgIHQua2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5taW51cyA9IDYwNjsKICAgIHQuSWNpcmN1bWZsZXggPSAzODk7CiAgICB0Lm5jYXJvbiA9IDU1NjsKICAgIHQudGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC5sb2dpY2Fsbm90ID0gNjA2OwogICAgdC5vZGllcmVzaXMgPSA1MDA7CiAgICB0LnVkaWVyZXNpcyA9IDU1NjsKICAgIHQubm90ZXF1YWwgPSA1NDk7CiAgICB0Lmdjb21tYWFjY2VudCA9IDUwMDsKICAgIHQuZXRoID0gNTAwOwogICAgdC56Y2Fyb24gPSAzODk7CiAgICB0Lm5jb21tYWFjY2VudCA9IDU1NjsKICAgIHQub25lc3VwZXJpb3IgPSAzMDA7CiAgICB0LmltYWNyb24gPSAyNzg7CiAgICB0LkV1cm8gPSA1MDA7CiAgfSk7CiAgdFsiVGltZXMtSXRhbGljIl0gPSAoMCwgX2NvcmVfdXRpbHMuZ2V0TG9va3VwVGFibGVGYWN0b3J5KShmdW5jdGlvbiAodCkgewogICAgdC5zcGFjZSA9IDI1MDsKICAgIHQuZXhjbGFtID0gMzMzOwogICAgdC5xdW90ZWRibCA9IDQyMDsKICAgIHQubnVtYmVyc2lnbiA9IDUwMDsKICAgIHQuZG9sbGFyID0gNTAwOwogICAgdC5wZXJjZW50ID0gODMzOwogICAgdC5hbXBlcnNhbmQgPSA3Nzg7CiAgICB0LnF1b3RlcmlnaHQgPSAzMzM7CiAgICB0LnBhcmVubGVmdCA9IDMzMzsKICAgIHQucGFyZW5yaWdodCA9IDMzMzsKICAgIHQuYXN0ZXJpc2sgPSA1MDA7CiAgICB0LnBsdXMgPSA2NzU7CiAgICB0LmNvbW1hID0gMjUwOwogICAgdC5oeXBoZW4gPSAzMzM7CiAgICB0LnBlcmlvZCA9IDI1MDsKICAgIHQuc2xhc2ggPSAyNzg7CiAgICB0Lnplcm8gPSA1MDA7CiAgICB0Lm9uZSA9IDUwMDsKICAgIHQudHdvID0gNTAwOwogICAgdC50aHJlZSA9IDUwMDsKICAgIHQuZm91ciA9IDUwMDsKICAgIHQuZml2ZSA9IDUwMDsKICAgIHQuc2l4ID0gNTAwOwogICAgdC5zZXZlbiA9IDUwMDsKICAgIHQuZWlnaHQgPSA1MDA7CiAgICB0Lm5pbmUgPSA1MDA7CiAgICB0LmNvbG9uID0gMzMzOwogICAgdC5zZW1pY29sb24gPSAzMzM7CiAgICB0Lmxlc3MgPSA2NzU7CiAgICB0LmVxdWFsID0gNjc1OwogICAgdC5ncmVhdGVyID0gNjc1OwogICAgdC5xdWVzdGlvbiA9IDUwMDsKICAgIHQuYXQgPSA5MjA7CiAgICB0LkEgPSA2MTE7CiAgICB0LkIgPSA2MTE7CiAgICB0LkMgPSA2Njc7CiAgICB0LkQgPSA3MjI7CiAgICB0LkUgPSA2MTE7CiAgICB0LkYgPSA2MTE7CiAgICB0LkcgPSA3MjI7CiAgICB0LkggPSA3MjI7CiAgICB0LkkgPSAzMzM7CiAgICB0LkogPSA0NDQ7CiAgICB0LksgPSA2Njc7CiAgICB0LkwgPSA1NTY7CiAgICB0Lk0gPSA4MzM7CiAgICB0Lk4gPSA2Njc7CiAgICB0Lk8gPSA3MjI7CiAgICB0LlAgPSA2MTE7CiAgICB0LlEgPSA3MjI7CiAgICB0LlIgPSA2MTE7CiAgICB0LlMgPSA1MDA7CiAgICB0LlQgPSA1NTY7CiAgICB0LlUgPSA3MjI7CiAgICB0LlYgPSA2MTE7CiAgICB0LlcgPSA4MzM7CiAgICB0LlggPSA2MTE7CiAgICB0LlkgPSA1NTY7CiAgICB0LlogPSA1NTY7CiAgICB0LmJyYWNrZXRsZWZ0ID0gMzg5OwogICAgdC5iYWNrc2xhc2ggPSAyNzg7CiAgICB0LmJyYWNrZXRyaWdodCA9IDM4OTsKICAgIHQuYXNjaWljaXJjdW0gPSA0MjI7CiAgICB0LnVuZGVyc2NvcmUgPSA1MDA7CiAgICB0LnF1b3RlbGVmdCA9IDMzMzsKICAgIHQuYSA9IDUwMDsKICAgIHQuYiA9IDUwMDsKICAgIHQuYyA9IDQ0NDsKICAgIHQuZCA9IDUwMDsKICAgIHQuZSA9IDQ0NDsKICAgIHQuZiA9IDI3ODsKICAgIHQuZyA9IDUwMDsKICAgIHQuaCA9IDUwMDsKICAgIHQuaSA9IDI3ODsKICAgIHQuaiA9IDI3ODsKICAgIHQuayA9IDQ0NDsKICAgIHQubCA9IDI3ODsKICAgIHQubSA9IDcyMjsKICAgIHQubiA9IDUwMDsKICAgIHQubyA9IDUwMDsKICAgIHQucCA9IDUwMDsKICAgIHQucSA9IDUwMDsKICAgIHQuciA9IDM4OTsKICAgIHQucyA9IDM4OTsKICAgIHQudCA9IDI3ODsKICAgIHQudSA9IDUwMDsKICAgIHQudiA9IDQ0NDsKICAgIHQudyA9IDY2NzsKICAgIHQueCA9IDQ0NDsKICAgIHQueSA9IDQ0NDsKICAgIHQueiA9IDM4OTsKICAgIHQuYnJhY2VsZWZ0ID0gNDAwOwogICAgdC5iYXIgPSAyNzU7CiAgICB0LmJyYWNlcmlnaHQgPSA0MDA7CiAgICB0LmFzY2lpdGlsZGUgPSA1NDE7CiAgICB0LmV4Y2xhbWRvd24gPSAzODk7CiAgICB0LmNlbnQgPSA1MDA7CiAgICB0LnN0ZXJsaW5nID0gNTAwOwogICAgdC5mcmFjdGlvbiA9IDE2NzsKICAgIHQueWVuID0gNTAwOwogICAgdC5mbG9yaW4gPSA1MDA7CiAgICB0LnNlY3Rpb24gPSA1MDA7CiAgICB0LmN1cnJlbmN5ID0gNTAwOwogICAgdC5xdW90ZXNpbmdsZSA9IDIxNDsKICAgIHQucXVvdGVkYmxsZWZ0ID0gNTU2OwogICAgdC5ndWlsbGVtb3RsZWZ0ID0gNTAwOwogICAgdC5ndWlsc2luZ2xsZWZ0ID0gMzMzOwogICAgdC5ndWlsc2luZ2xyaWdodCA9IDMzMzsKICAgIHQuZmkgPSA1MDA7CiAgICB0LmZsID0gNTAwOwogICAgdC5lbmRhc2ggPSA1MDA7CiAgICB0LmRhZ2dlciA9IDUwMDsKICAgIHQuZGFnZ2VyZGJsID0gNTAwOwogICAgdC5wZXJpb2RjZW50ZXJlZCA9IDI1MDsKICAgIHQucGFyYWdyYXBoID0gNTIzOwogICAgdC5idWxsZXQgPSAzNTA7CiAgICB0LnF1b3Rlc2luZ2xiYXNlID0gMzMzOwogICAgdC5xdW90ZWRibGJhc2UgPSA1NTY7CiAgICB0LnF1b3RlZGJscmlnaHQgPSA1NTY7CiAgICB0Lmd1aWxsZW1vdHJpZ2h0ID0gNTAwOwogICAgdC5lbGxpcHNpcyA9IDg4OTsKICAgIHQucGVydGhvdXNhbmQgPSAxMDAwOwogICAgdC5xdWVzdGlvbmRvd24gPSA1MDA7CiAgICB0LmdyYXZlID0gMzMzOwogICAgdC5hY3V0ZSA9IDMzMzsKICAgIHQuY2lyY3VtZmxleCA9IDMzMzsKICAgIHQudGlsZGUgPSAzMzM7CiAgICB0Lm1hY3JvbiA9IDMzMzsKICAgIHQuYnJldmUgPSAzMzM7CiAgICB0LmRvdGFjY2VudCA9IDMzMzsKICAgIHQuZGllcmVzaXMgPSAzMzM7CiAgICB0LnJpbmcgPSAzMzM7CiAgICB0LmNlZGlsbGEgPSAzMzM7CiAgICB0Lmh1bmdhcnVtbGF1dCA9IDMzMzsKICAgIHQub2dvbmVrID0gMzMzOwogICAgdC5jYXJvbiA9IDMzMzsKICAgIHQuZW1kYXNoID0gODg5OwogICAgdC5BRSA9IDg4OTsKICAgIHQub3JkZmVtaW5pbmUgPSAyNzY7CiAgICB0LkxzbGFzaCA9IDU1NjsKICAgIHQuT3NsYXNoID0gNzIyOwogICAgdC5PRSA9IDk0NDsKICAgIHQub3JkbWFzY3VsaW5lID0gMzEwOwogICAgdC5hZSA9IDY2NzsKICAgIHQuZG90bGVzc2kgPSAyNzg7CiAgICB0LmxzbGFzaCA9IDI3ODsKICAgIHQub3NsYXNoID0gNTAwOwogICAgdC5vZSA9IDY2NzsKICAgIHQuZ2VybWFuZGJscyA9IDUwMDsKICAgIHQuSWRpZXJlc2lzID0gMzMzOwogICAgdC5lYWN1dGUgPSA0NDQ7CiAgICB0LmFicmV2ZSA9IDUwMDsKICAgIHQudWh1bmdhcnVtbGF1dCA9IDUwMDsKICAgIHQuZWNhcm9uID0gNDQ0OwogICAgdC5ZZGllcmVzaXMgPSA1NTY7CiAgICB0LmRpdmlkZSA9IDY3NTsKICAgIHQuWWFjdXRlID0gNTU2OwogICAgdC5BY2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWFjdXRlID0gNTAwOwogICAgdC5VY2lyY3VtZmxleCA9IDcyMjsKICAgIHQueWFjdXRlID0gNDQ0OwogICAgdC5zY29tbWFhY2NlbnQgPSAzODk7CiAgICB0LmVjaXJjdW1mbGV4ID0gNDQ0OwogICAgdC5VcmluZyA9IDcyMjsKICAgIHQuVWRpZXJlc2lzID0gNzIyOwogICAgdC5hb2dvbmVrID0gNTAwOwogICAgdC5VYWN1dGUgPSA3MjI7CiAgICB0LnVvZ29uZWsgPSA1MDA7CiAgICB0LkVkaWVyZXNpcyA9IDYxMTsKICAgIHQuRGNyb2F0ID0gNzIyOwogICAgdC5jb21tYWFjY2VudCA9IDI1MDsKICAgIHQuY29weXJpZ2h0ID0gNzYwOwogICAgdC5FbWFjcm9uID0gNjExOwogICAgdC5jY2Fyb24gPSA0NDQ7CiAgICB0LmFyaW5nID0gNTAwOwogICAgdC5OY29tbWFhY2NlbnQgPSA2Njc7CiAgICB0LmxhY3V0ZSA9IDI3ODsKICAgIHQuYWdyYXZlID0gNTAwOwogICAgdC5UY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LkNhY3V0ZSA9IDY2NzsKICAgIHQuYXRpbGRlID0gNTAwOwogICAgdC5FZG90YWNjZW50ID0gNjExOwogICAgdC5zY2Fyb24gPSAzODk7CiAgICB0LnNjZWRpbGxhID0gMzg5OwogICAgdC5pYWN1dGUgPSAyNzg7CiAgICB0LmxvemVuZ2UgPSA0NzE7CiAgICB0LlJjYXJvbiA9IDYxMTsKICAgIHQuR2NvbW1hYWNjZW50ID0gNzIyOwogICAgdC51Y2lyY3VtZmxleCA9IDUwMDsKICAgIHQuYWNpcmN1bWZsZXggPSA1MDA7CiAgICB0LkFtYWNyb24gPSA2MTE7CiAgICB0LnJjYXJvbiA9IDM4OTsKICAgIHQuY2NlZGlsbGEgPSA0NDQ7CiAgICB0Llpkb3RhY2NlbnQgPSA1NTY7CiAgICB0LlRob3JuID0gNjExOwogICAgdC5PbWFjcm9uID0gNzIyOwogICAgdC5SYWN1dGUgPSA2MTE7CiAgICB0LlNhY3V0ZSA9IDUwMDsKICAgIHQuZGNhcm9uID0gNTQ0OwogICAgdC5VbWFjcm9uID0gNzIyOwogICAgdC51cmluZyA9IDUwMDsKICAgIHQudGhyZWVzdXBlcmlvciA9IDMwMDsKICAgIHQuT2dyYXZlID0gNzIyOwogICAgdC5BZ3JhdmUgPSA2MTE7CiAgICB0LkFicmV2ZSA9IDYxMTsKICAgIHQubXVsdGlwbHkgPSA2NzU7CiAgICB0LnVhY3V0ZSA9IDUwMDsKICAgIHQuVGNhcm9uID0gNTU2OwogICAgdC5wYXJ0aWFsZGlmZiA9IDQ3NjsKICAgIHQueWRpZXJlc2lzID0gNDQ0OwogICAgdC5OYWN1dGUgPSA2Njc7CiAgICB0LmljaXJjdW1mbGV4ID0gMjc4OwogICAgdC5FY2lyY3VtZmxleCA9IDYxMTsKICAgIHQuYWRpZXJlc2lzID0gNTAwOwogICAgdC5lZGllcmVzaXMgPSA0NDQ7CiAgICB0LmNhY3V0ZSA9IDQ0NDsKICAgIHQubmFjdXRlID0gNTAwOwogICAgdC51bWFjcm9uID0gNTAwOwogICAgdC5OY2Fyb24gPSA2Njc7CiAgICB0LklhY3V0ZSA9IDMzMzsKICAgIHQucGx1c21pbnVzID0gNjc1OwogICAgdC5icm9rZW5iYXIgPSAyNzU7CiAgICB0LnJlZ2lzdGVyZWQgPSA3NjA7CiAgICB0LkdicmV2ZSA9IDcyMjsKICAgIHQuSWRvdGFjY2VudCA9IDMzMzsKICAgIHQuc3VtbWF0aW9uID0gNjAwOwogICAgdC5FZ3JhdmUgPSA2MTE7CiAgICB0LnJhY3V0ZSA9IDM4OTsKICAgIHQub21hY3JvbiA9IDUwMDsKICAgIHQuWmFjdXRlID0gNTU2OwogICAgdC5aY2Fyb24gPSA1NTY7CiAgICB0LmdyZWF0ZXJlcXVhbCA9IDU0OTsKICAgIHQuRXRoID0gNzIyOwogICAgdC5DY2VkaWxsYSA9IDY2NzsKICAgIHQubGNvbW1hYWNjZW50ID0gMjc4OwogICAgdC50Y2Fyb24gPSAzMDA7CiAgICB0LmVvZ29uZWsgPSA0NDQ7CiAgICB0LlVvZ29uZWsgPSA3MjI7CiAgICB0LkFhY3V0ZSA9IDYxMTsKICAgIHQuQWRpZXJlc2lzID0gNjExOwogICAgdC5lZ3JhdmUgPSA0NDQ7CiAgICB0LnphY3V0ZSA9IDM4OTsKICAgIHQuaW9nb25layA9IDI3ODsKICAgIHQuT2FjdXRlID0gNzIyOwogICAgdC5vYWN1dGUgPSA1MDA7CiAgICB0LmFtYWNyb24gPSA1MDA7CiAgICB0LnNhY3V0ZSA9IDM4OTsKICAgIHQuaWRpZXJlc2lzID0gMjc4OwogICAgdC5PY2lyY3VtZmxleCA9IDcyMjsKICAgIHQuVWdyYXZlID0gNzIyOwogICAgdC5EZWx0YSA9IDYxMjsKICAgIHQudGhvcm4gPSA1MDA7CiAgICB0LnR3b3N1cGVyaW9yID0gMzAwOwogICAgdC5PZGllcmVzaXMgPSA3MjI7CiAgICB0Lm11ID0gNTAwOwogICAgdC5pZ3JhdmUgPSAyNzg7CiAgICB0Lm9odW5nYXJ1bWxhdXQgPSA1MDA7CiAgICB0LkVvZ29uZWsgPSA2MTE7CiAgICB0LmRjcm9hdCA9IDUwMDsKICAgIHQudGhyZWVxdWFydGVycyA9IDc1MDsKICAgIHQuU2NlZGlsbGEgPSA1MDA7CiAgICB0LmxjYXJvbiA9IDMwMDsKICAgIHQuS2NvbW1hYWNjZW50ID0gNjY3OwogICAgdC5MYWN1dGUgPSA1NTY7CiAgICB0LnRyYWRlbWFyayA9IDk4MDsKICAgIHQuZWRvdGFjY2VudCA9IDQ0NDsKICAgIHQuSWdyYXZlID0gMzMzOwogICAgdC5JbWFjcm9uID0gMzMzOwogICAgdC5MY2Fyb24gPSA2MTE7CiAgICB0Lm9uZWhhbGYgPSA3NTA7CiAgICB0Lmxlc3NlcXVhbCA9IDU0OTsKICAgIHQub2NpcmN1bWZsZXggPSA1MDA7CiAgICB0Lm50aWxkZSA9IDUwMDsKICAgIHQuVWh1bmdhcnVtbGF1dCA9IDcyMjsKICAgIHQuRWFjdXRlID0gNjExOwogICAgdC5lbWFjcm9uID0gNDQ0OwogICAgdC5nYnJldmUgPSA1MDA7CiAgICB0Lm9uZXF1YXJ0ZXIgPSA3NTA7CiAgICB0LlNjYXJvbiA9IDUwMDsKICAgIHQuU2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5PaHVuZ2FydW1sYXV0ID0gNzIyOwogICAgdC5kZWdyZWUgPSA0MDA7CiAgICB0Lm9ncmF2ZSA9IDUwMDsKICAgIHQuQ2Nhcm9uID0gNjY3OwogICAgdC51Z3JhdmUgPSA1MDA7CiAgICB0LnJhZGljYWwgPSA0NTM7CiAgICB0LkRjYXJvbiA9IDcyMjsKICAgIHQucmNvbW1hYWNjZW50ID0gMzg5OwogICAgdC5OdGlsZGUgPSA2Njc7CiAgICB0Lm90aWxkZSA9IDUwMDsKICAgIHQuUmNvbW1hYWNjZW50ID0gNjExOwogICAgdC5MY29tbWFhY2NlbnQgPSA1NTY7CiAgICB0LkF0aWxkZSA9IDYxMTsKICAgIHQuQW9nb25layA9IDYxMTsKICAgIHQuQXJpbmcgPSA2MTE7CiAgICB0Lk90aWxkZSA9IDcyMjsKICAgIHQuemRvdGFjY2VudCA9IDM4OTsKICAgIHQuRWNhcm9uID0gNjExOwogICAgdC5Jb2dvbmVrID0gMzMzOwogICAgdC5rY29tbWFhY2NlbnQgPSA0NDQ7CiAgICB0Lm1pbnVzID0gNjc1OwogICAgdC5JY2lyY3VtZmxleCA9IDMzMzsKICAgIHQubmNhcm9uID0gNTAwOwogICAgdC50Y29tbWFhY2NlbnQgPSAyNzg7CiAgICB0LmxvZ2ljYWxub3QgPSA2NzU7CiAgICB0Lm9kaWVyZXNpcyA9IDUwMDsKICAgIHQudWRpZXJlc2lzID0gNTAwOwogICAgdC5ub3RlcXVhbCA9IDU0OTsKICAgIHQuZ2NvbW1hYWNjZW50ID0gNTAwOwogICAgdC5ldGggPSA1MDA7CiAgICB0LnpjYXJvbiA9IDM4OTsKICAgIHQubmNvbW1hYWNjZW50ID0gNTAwOwogICAgdC5vbmVzdXBlcmlvciA9IDMwMDsKICAgIHQuaW1hY3JvbiA9IDI3ODsKICAgIHQuRXVybyA9IDUwMDsKICB9KTsKICB0LlphcGZEaW5nYmF0cyA9ICgwLCBfY29yZV91dGlscy5nZXRMb29rdXBUYWJsZUZhY3RvcnkpKGZ1bmN0aW9uICh0KSB7CiAgICB0LnNwYWNlID0gMjc4OwogICAgdC5hMSA9IDk3NDsKICAgIHQuYTIgPSA5NjE7CiAgICB0LmEyMDIgPSA5NzQ7CiAgICB0LmEzID0gOTgwOwogICAgdC5hNCA9IDcxOTsKICAgIHQuYTUgPSA3ODk7CiAgICB0LmExMTkgPSA3OTA7CiAgICB0LmExMTggPSA3OTE7CiAgICB0LmExMTcgPSA2OTA7CiAgICB0LmExMSA9IDk2MDsKICAgIHQuYTEyID0gOTM5OwogICAgdC5hMTMgPSA1NDk7CiAgICB0LmExNCA9IDg1NTsKICAgIHQuYTE1ID0gOTExOwogICAgdC5hMTYgPSA5MzM7CiAgICB0LmExMDUgPSA5MTE7CiAgICB0LmExNyA9IDk0NTsKICAgIHQuYTE4ID0gOTc0OwogICAgdC5hMTkgPSA3NTU7CiAgICB0LmEyMCA9IDg0NjsKICAgIHQuYTIxID0gNzYyOwogICAgdC5hMjIgPSA3NjE7CiAgICB0LmEyMyA9IDU3MTsKICAgIHQuYTI0ID0gNjc3OwogICAgdC5hMjUgPSA3NjM7CiAgICB0LmEyNiA9IDc2MDsKICAgIHQuYTI3ID0gNzU5OwogICAgdC5hMjggPSA3NTQ7CiAgICB0LmE2ID0gNDk0OwogICAgdC5hNyA9IDU1MjsKICAgIHQuYTggPSA1Mzc7CiAgICB0LmE5ID0gNTc3OwogICAgdC5hMTAgPSA2OTI7CiAgICB0LmEyOSA9IDc4NjsKICAgIHQuYTMwID0gNzg4OwogICAgdC5hMzEgPSA3ODg7CiAgICB0LmEzMiA9IDc5MDsKICAgIHQuYTMzID0gNzkzOwogICAgdC5hMzQgPSA3OTQ7CiAgICB0LmEzNSA9IDgxNjsKICAgIHQuYTM2ID0gODIzOwogICAgdC5hMzcgPSA3ODk7CiAgICB0LmEzOCA9IDg0MTsKICAgIHQuYTM5ID0gODIzOwogICAgdC5hNDAgPSA4MzM7CiAgICB0LmE0MSA9IDgxNjsKICAgIHQuYTQyID0gODMxOwogICAgdC5hNDMgPSA5MjM7CiAgICB0LmE0NCA9IDc0NDsKICAgIHQuYTQ1ID0gNzIzOwogICAgdC5hNDYgPSA3NDk7CiAgICB0LmE0NyA9IDc5MDsKICAgIHQuYTQ4ID0gNzkyOwogICAgdC5hNDkgPSA2OTU7CiAgICB0LmE1MCA9IDc3NjsKICAgIHQuYTUxID0gNzY4OwogICAgdC5hNTIgPSA3OTI7CiAgICB0LmE1MyA9IDc1OTsKICAgIHQuYTU0ID0gNzA3OwogICAgdC5hNTUgPSA3MDg7CiAgICB0LmE1NiA9IDY4MjsKICAgIHQuYTU3ID0gNzAxOwogICAgdC5hNTggPSA4MjY7CiAgICB0LmE1OSA9IDgxNTsKICAgIHQuYTYwID0gNzg5OwogICAgdC5hNjEgPSA3ODk7CiAgICB0LmE2MiA9IDcwNzsKICAgIHQuYTYzID0gNjg3OwogICAgdC5hNjQgPSA2OTY7CiAgICB0LmE2NSA9IDY4OTsKICAgIHQuYTY2ID0gNzg2OwogICAgdC5hNjcgPSA3ODc7CiAgICB0LmE2OCA9IDcxMzsKICAgIHQuYTY5ID0gNzkxOwogICAgdC5hNzAgPSA3ODU7CiAgICB0LmE3MSA9IDc5MTsKICAgIHQuYTcyID0gODczOwogICAgdC5hNzMgPSA3NjE7CiAgICB0LmE3NCA9IDc2MjsKICAgIHQuYTIwMyA9IDc2MjsKICAgIHQuYTc1ID0gNzU5OwogICAgdC5hMjA0ID0gNzU5OwogICAgdC5hNzYgPSA4OTI7CiAgICB0LmE3NyA9IDg5MjsKICAgIHQuYTc4ID0gNzg4OwogICAgdC5hNzkgPSA3ODQ7CiAgICB0LmE4MSA9IDQzODsKICAgIHQuYTgyID0gMTM4OwogICAgdC5hODMgPSAyNzc7CiAgICB0LmE4NCA9IDQxNTsKICAgIHQuYTk3ID0gMzkyOwogICAgdC5hOTggPSAzOTI7CiAgICB0LmE5OSA9IDY2ODsKICAgIHQuYTEwMCA9IDY2ODsKICAgIHQuYTg5ID0gMzkwOwogICAgdC5hOTAgPSAzOTA7CiAgICB0LmE5MyA9IDMxNzsKICAgIHQuYTk0ID0gMzE3OwogICAgdC5hOTEgPSAyNzY7CiAgICB0LmE5MiA9IDI3NjsKICAgIHQuYTIwNSA9IDUwOTsKICAgIHQuYTg1ID0gNTA5OwogICAgdC5hMjA2ID0gNDEwOwogICAgdC5hODYgPSA0MTA7CiAgICB0LmE4NyA9IDIzNDsKICAgIHQuYTg4ID0gMjM0OwogICAgdC5hOTUgPSAzMzQ7CiAgICB0LmE5NiA9IDMzNDsKICAgIHQuYTEwMSA9IDczMjsKICAgIHQuYTEwMiA9IDU0NDsKICAgIHQuYTEwMyA9IDU0NDsKICAgIHQuYTEwNCA9IDkxMDsKICAgIHQuYTEwNiA9IDY2NzsKICAgIHQuYTEwNyA9IDc2MDsKICAgIHQuYTEwOCA9IDc2MDsKICAgIHQuYTExMiA9IDc3NjsKICAgIHQuYTExMSA9IDU5NTsKICAgIHQuYTExMCA9IDY5NDsKICAgIHQuYTEwOSA9IDYyNjsKICAgIHQuYTEyMCA9IDc4ODsKICAgIHQuYTEyMSA9IDc4ODsKICAgIHQuYTEyMiA9IDc4ODsKICAgIHQuYTEyMyA9IDc4ODsKICAgIHQuYTEyNCA9IDc4ODsKICAgIHQuYTEyNSA9IDc4ODsKICAgIHQuYTEyNiA9IDc4ODsKICAgIHQuYTEyNyA9IDc4ODsKICAgIHQuYTEyOCA9IDc4ODsKICAgIHQuYTEyOSA9IDc4ODsKICAgIHQuYTEzMCA9IDc4ODsKICAgIHQuYTEzMSA9IDc4ODsKICAgIHQuYTEzMiA9IDc4ODsKICAgIHQuYTEzMyA9IDc4ODsKICAgIHQuYTEzNCA9IDc4ODsKICAgIHQuYTEzNSA9IDc4ODsKICAgIHQuYTEzNiA9IDc4ODsKICAgIHQuYTEzNyA9IDc4ODsKICAgIHQuYTEzOCA9IDc4ODsKICAgIHQuYTEzOSA9IDc4ODsKICAgIHQuYTE0MCA9IDc4ODsKICAgIHQuYTE0MSA9IDc4ODsKICAgIHQuYTE0MiA9IDc4ODsKICAgIHQuYTE0MyA9IDc4ODsKICAgIHQuYTE0NCA9IDc4ODsKICAgIHQuYTE0NSA9IDc4ODsKICAgIHQuYTE0NiA9IDc4ODsKICAgIHQuYTE0NyA9IDc4ODsKICAgIHQuYTE0OCA9IDc4ODsKICAgIHQuYTE0OSA9IDc4ODsKICAgIHQuYTE1MCA9IDc4ODsKICAgIHQuYTE1MSA9IDc4ODsKICAgIHQuYTE1MiA9IDc4ODsKICAgIHQuYTE1MyA9IDc4ODsKICAgIHQuYTE1NCA9IDc4ODsKICAgIHQuYTE1NSA9IDc4ODsKICAgIHQuYTE1NiA9IDc4ODsKICAgIHQuYTE1NyA9IDc4ODsKICAgIHQuYTE1OCA9IDc4ODsKICAgIHQuYTE1OSA9IDc4ODsKICAgIHQuYTE2MCA9IDg5NDsKICAgIHQuYTE2MSA9IDgzODsKICAgIHQuYTE2MyA9IDEwMTY7CiAgICB0LmExNjQgPSA0NTg7CiAgICB0LmExOTYgPSA3NDg7CiAgICB0LmExNjUgPSA5MjQ7CiAgICB0LmExOTIgPSA3NDg7CiAgICB0LmExNjYgPSA5MTg7CiAgICB0LmExNjcgPSA5Mjc7CiAgICB0LmExNjggPSA5Mjg7CiAgICB0LmExNjkgPSA5Mjg7CiAgICB0LmExNzAgPSA4MzQ7CiAgICB0LmExNzEgPSA4NzM7CiAgICB0LmExNzIgPSA4Mjg7CiAgICB0LmExNzMgPSA5MjQ7CiAgICB0LmExNjIgPSA5MjQ7CiAgICB0LmExNzQgPSA5MTc7CiAgICB0LmExNzUgPSA5MzA7CiAgICB0LmExNzYgPSA5MzE7CiAgICB0LmExNzcgPSA0NjM7CiAgICB0LmExNzggPSA4ODM7CiAgICB0LmExNzkgPSA4MzY7CiAgICB0LmExOTMgPSA4MzY7CiAgICB0LmExODAgPSA4Njc7CiAgICB0LmExOTkgPSA4Njc7CiAgICB0LmExODEgPSA2OTY7CiAgICB0LmEyMDAgPSA2OTY7CiAgICB0LmExODIgPSA4NzQ7CiAgICB0LmEyMDEgPSA4NzQ7CiAgICB0LmExODMgPSA3NjA7CiAgICB0LmExODQgPSA5NDY7CiAgICB0LmExOTcgPSA3NzE7CiAgICB0LmExODUgPSA4NjU7CiAgICB0LmExOTQgPSA3NzE7CiAgICB0LmExOTggPSA4ODg7CiAgICB0LmExODYgPSA5Njc7CiAgICB0LmExOTUgPSA4ODg7CiAgICB0LmExODcgPSA4MzE7CiAgICB0LmExODggPSA4NzM7CiAgICB0LmExODkgPSA5Mjc7CiAgICB0LmExOTAgPSA5NzA7CiAgICB0LmExOTEgPSA5MTg7CiAgfSk7Cn0pOwpleHBvcnRzLmdldE1ldHJpY3MgPSBnZXRNZXRyaWNzOwoKLyoqKi8gfSksCi8qIDIzNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmlzUERGRnVuY3Rpb24gPSBpc1BERkZ1bmN0aW9uOwpleHBvcnRzLlBvc3RTY3JpcHRDb21waWxlciA9IGV4cG9ydHMuUG9zdFNjcmlwdEV2YWx1YXRvciA9IGV4cG9ydHMuUERGRnVuY3Rpb25GYWN0b3J5ID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfcHNfcGFyc2VyID0gX193X3BkZmpzX3JlcXVpcmVfXygyMzUpOwoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKdmFyIFBERkZ1bmN0aW9uRmFjdG9yeSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUERGRnVuY3Rpb25GYWN0b3J5KF9yZWYpIHsKICAgIHZhciB4cmVmID0gX3JlZi54cmVmLAogICAgICAgIF9yZWYkaXNFdmFsU3VwcG9ydGVkID0gX3JlZi5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgaXNFdmFsU3VwcG9ydGVkID0gX3JlZiRpc0V2YWxTdXBwb3J0ZWQgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmJGlzRXZhbFN1cHBvcnRlZDsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUERGRnVuY3Rpb25GYWN0b3J5KTsKCiAgICB0aGlzLnhyZWYgPSB4cmVmOwogICAgdGhpcy5pc0V2YWxTdXBwb3J0ZWQgPSBpc0V2YWxTdXBwb3J0ZWQgIT09IGZhbHNlOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFBERkZ1bmN0aW9uRmFjdG9yeSwgW3sKICAgIGtleTogImNyZWF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKGZuKSB7CiAgICAgIHJldHVybiBQREZGdW5jdGlvbi5wYXJzZSh7CiAgICAgICAgeHJlZjogdGhpcy54cmVmLAogICAgICAgIGlzRXZhbFN1cHBvcnRlZDogdGhpcy5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgZm46IGZuCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZUZyb21BcnJheSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlRnJvbUFycmF5KGZuT2JqKSB7CiAgICAgIHJldHVybiBQREZGdW5jdGlvbi5wYXJzZUFycmF5KHsKICAgICAgICB4cmVmOiB0aGlzLnhyZWYsCiAgICAgICAgaXNFdmFsU3VwcG9ydGVkOiB0aGlzLmlzRXZhbFN1cHBvcnRlZCwKICAgICAgICBmbk9iajogZm5PYmoKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUERGRnVuY3Rpb25GYWN0b3J5Owp9KCk7CgpleHBvcnRzLlBERkZ1bmN0aW9uRmFjdG9yeSA9IFBERkZ1bmN0aW9uRmFjdG9yeTsKCmZ1bmN0aW9uIHRvTnVtYmVyQXJyYXkoYXJyKSB7CiAgaWYgKCFBcnJheS5pc0FycmF5KGFycikpIHsKICAgIHJldHVybiBudWxsOwogIH0KCiAgdmFyIGxlbmd0aCA9IGFyci5sZW5ndGg7CgogIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgIGlmICh0eXBlb2YgYXJyW2ldICE9PSAibnVtYmVyIikgewogICAgICB2YXIgcmVzdWx0ID0gbmV3IEFycmF5KGxlbmd0aCk7CgogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxlbmd0aDsgaisrKSB7CiAgICAgICAgcmVzdWx0W2pdID0gK2FycltqXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9CgogIHJldHVybiBhcnI7Cn0KCnZhciBQREZGdW5jdGlvbiA9IGZ1bmN0aW9uIFBERkZ1bmN0aW9uQ2xvc3VyZSgpIHsKICB2YXIgQ09OU1RSVUNUX1NBTVBMRUQgPSAwOwogIHZhciBDT05TVFJVQ1RfSU5URVJQT0xBVEVEID0gMjsKICB2YXIgQ09OU1RSVUNUX1NUSUNIRUQgPSAzOwogIHZhciBDT05TVFJVQ1RfUE9TVFNDUklQVCA9IDQ7CiAgcmV0dXJuIHsKICAgIGdldFNhbXBsZUFycmF5OiBmdW5jdGlvbiBnZXRTYW1wbGVBcnJheShzaXplLCBvdXRwdXRTaXplLCBicHMsIHN0cmVhbSkgewogICAgICB2YXIgaSwgaWk7CiAgICAgIHZhciBsZW5ndGggPSAxOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSBzaXplLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICBsZW5ndGggKj0gc2l6ZVtpXTsKICAgICAgfQoKICAgICAgbGVuZ3RoICo9IG91dHB1dFNpemU7CiAgICAgIHZhciBhcnJheSA9IG5ldyBBcnJheShsZW5ndGgpOwogICAgICB2YXIgY29kZVNpemUgPSAwOwogICAgICB2YXIgY29kZUJ1ZiA9IDA7CiAgICAgIHZhciBzYW1wbGVNdWwgPSAxLjAgLyAoTWF0aC5wb3coMi4wLCBicHMpIC0gMSk7CiAgICAgIHZhciBzdHJCeXRlcyA9IHN0cmVhbS5nZXRCeXRlcygobGVuZ3RoICogYnBzICsgNykgLyA4KTsKICAgICAgdmFyIHN0cklkeCA9IDA7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICB3aGlsZSAoY29kZVNpemUgPCBicHMpIHsKICAgICAgICAgIGNvZGVCdWYgPDw9IDg7CiAgICAgICAgICBjb2RlQnVmIHw9IHN0ckJ5dGVzW3N0cklkeCsrXTsKICAgICAgICAgIGNvZGVTaXplICs9IDg7CiAgICAgICAgfQoKICAgICAgICBjb2RlU2l6ZSAtPSBicHM7CiAgICAgICAgYXJyYXlbaV0gPSAoY29kZUJ1ZiA+PiBjb2RlU2l6ZSkgKiBzYW1wbGVNdWw7CiAgICAgICAgY29kZUJ1ZiAmPSAoMSA8PCBjb2RlU2l6ZSkgLSAxOwogICAgICB9CgogICAgICByZXR1cm4gYXJyYXk7CiAgICB9LAogICAgZ2V0SVI6IGZ1bmN0aW9uIGdldElSKF9yZWYyKSB7CiAgICAgIHZhciB4cmVmID0gX3JlZjIueHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCA9IF9yZWYyLmlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgIGZuID0gX3JlZjIuZm47CiAgICAgIHZhciBkaWN0ID0gZm4uZGljdDsKCiAgICAgIGlmICghZGljdCkgewogICAgICAgIGRpY3QgPSBmbjsKICAgICAgfQoKICAgICAgdmFyIHR5cGVzID0gW3RoaXMuY29uc3RydWN0U2FtcGxlZCwgbnVsbCwgdGhpcy5jb25zdHJ1Y3RJbnRlcnBvbGF0ZWQsIHRoaXMuY29uc3RydWN0U3RpY2hlZCwgdGhpcy5jb25zdHJ1Y3RQb3N0U2NyaXB0XTsKICAgICAgdmFyIHR5cGVOdW0gPSBkaWN0LmdldCgiRnVuY3Rpb25UeXBlIik7CiAgICAgIHZhciB0eXBlRm4gPSB0eXBlc1t0eXBlTnVtXTsKCiAgICAgIGlmICghdHlwZUZuKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJVbmtub3duIHR5cGUgb2YgZnVuY3Rpb24iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHR5cGVGbi5jYWxsKHRoaXMsIHsKICAgICAgICB4cmVmOiB4cmVmLAogICAgICAgIGlzRXZhbFN1cHBvcnRlZDogaXNFdmFsU3VwcG9ydGVkLAogICAgICAgIGZuOiBmbiwKICAgICAgICBkaWN0OiBkaWN0CiAgICAgIH0pOwogICAgfSwKICAgIGZyb21JUjogZnVuY3Rpb24gZnJvbUlSKF9yZWYzKSB7CiAgICAgIHZhciB4cmVmID0gX3JlZjMueHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCA9IF9yZWYzLmlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgIElSID0gX3JlZjMuSVI7CiAgICAgIHZhciB0eXBlID0gSVJbMF07CgogICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICBjYXNlIENPTlNUUlVDVF9TQU1QTEVEOgogICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0U2FtcGxlZEZyb21JUih7CiAgICAgICAgICAgIHhyZWY6IHhyZWYsCiAgICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZDogaXNFdmFsU3VwcG9ydGVkLAogICAgICAgICAgICBJUjogSVIKICAgICAgICAgIH0pOwoKICAgICAgICBjYXNlIENPTlNUUlVDVF9JTlRFUlBPTEFURUQ6CiAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RJbnRlcnBvbGF0ZWRGcm9tSVIoewogICAgICAgICAgICB4cmVmOiB4cmVmLAogICAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQ6IGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgICAgSVI6IElSCiAgICAgICAgICB9KTsKCiAgICAgICAgY2FzZSBDT05TVFJVQ1RfU1RJQ0hFRDoKICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdFN0aWNoZWRGcm9tSVIoewogICAgICAgICAgICB4cmVmOiB4cmVmLAogICAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQ6IGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgICAgSVI6IElSCiAgICAgICAgICB9KTsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdFBvc3RTY3JpcHRGcm9tSVIoewogICAgICAgICAgICB4cmVmOiB4cmVmLAogICAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQ6IGlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgICAgSVI6IElSCiAgICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHBhcnNlOiBmdW5jdGlvbiBwYXJzZShfcmVmNCkgewogICAgICB2YXIgeHJlZiA9IF9yZWY0LnhyZWYsCiAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQgPSBfcmVmNC5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBmbiA9IF9yZWY0LmZuOwogICAgICB2YXIgSVIgPSB0aGlzLmdldElSKHsKICAgICAgICB4cmVmOiB4cmVmLAogICAgICAgIGlzRXZhbFN1cHBvcnRlZDogaXNFdmFsU3VwcG9ydGVkLAogICAgICAgIGZuOiBmbgogICAgICB9KTsKICAgICAgcmV0dXJuIHRoaXMuZnJvbUlSKHsKICAgICAgICB4cmVmOiB4cmVmLAogICAgICAgIGlzRXZhbFN1cHBvcnRlZDogaXNFdmFsU3VwcG9ydGVkLAogICAgICAgIElSOiBJUgogICAgICB9KTsKICAgIH0sCiAgICBwYXJzZUFycmF5OiBmdW5jdGlvbiBwYXJzZUFycmF5KF9yZWY1KSB7CiAgICAgIHZhciB4cmVmID0gX3JlZjUueHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCA9IF9yZWY1LmlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgIGZuT2JqID0gX3JlZjUuZm5PYmo7CgogICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZm5PYmopKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2UoewogICAgICAgICAgeHJlZjogeHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZDogaXNFdmFsU3VwcG9ydGVkLAogICAgICAgICAgZm46IGZuT2JqCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHZhciBmbkFycmF5ID0gW107CgogICAgICBmb3IgKHZhciBqID0gMCwgamogPSBmbk9iai5sZW5ndGg7IGogPCBqajsgaisrKSB7CiAgICAgICAgZm5BcnJheS5wdXNoKHRoaXMucGFyc2UoewogICAgICAgICAgeHJlZjogeHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZDogaXNFdmFsU3VwcG9ydGVkLAogICAgICAgICAgZm46IHhyZWYuZmV0Y2hJZlJlZihmbk9ialtqXSkKICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmdW5jdGlvbiAoc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBmbkFycmF5Lmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIGZuQXJyYXlbaV0oc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQgKyBpKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9LAogICAgY29uc3RydWN0U2FtcGxlZDogZnVuY3Rpb24gY29uc3RydWN0U2FtcGxlZChfcmVmNikgewogICAgICB2YXIgeHJlZiA9IF9yZWY2LnhyZWYsCiAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQgPSBfcmVmNi5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBmbiA9IF9yZWY2LmZuLAogICAgICAgICAgZGljdCA9IF9yZWY2LmRpY3Q7CgogICAgICBmdW5jdGlvbiB0b011bHRpQXJyYXkoYXJyKSB7CiAgICAgICAgdmFyIGlucHV0TGVuZ3RoID0gYXJyLmxlbmd0aDsKICAgICAgICB2YXIgb3V0ID0gW107CiAgICAgICAgdmFyIGluZGV4ID0gMDsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dExlbmd0aDsgaSArPSAyKSB7CiAgICAgICAgICBvdXRbaW5kZXhdID0gW2FycltpXSwgYXJyW2kgKyAxXV07CiAgICAgICAgICArK2luZGV4OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG91dDsKICAgICAgfQoKICAgICAgdmFyIGRvbWFpbiA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRG9tYWluIikpOwogICAgICB2YXIgcmFuZ2UgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIlJhbmdlIikpOwoKICAgICAgaWYgKCFkb21haW4gfHwgIXJhbmdlKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJObyBkb21haW4gb3IgcmFuZ2UiKTsKICAgICAgfQoKICAgICAgdmFyIGlucHV0U2l6ZSA9IGRvbWFpbi5sZW5ndGggLyAyOwogICAgICB2YXIgb3V0cHV0U2l6ZSA9IHJhbmdlLmxlbmd0aCAvIDI7CiAgICAgIGRvbWFpbiA9IHRvTXVsdGlBcnJheShkb21haW4pOwogICAgICByYW5nZSA9IHRvTXVsdGlBcnJheShyYW5nZSk7CiAgICAgIHZhciBzaXplID0gdG9OdW1iZXJBcnJheShkaWN0LmdldEFycmF5KCJTaXplIikpOwogICAgICB2YXIgYnBzID0gZGljdC5nZXQoIkJpdHNQZXJTYW1wbGUiKTsKICAgICAgdmFyIG9yZGVyID0gZGljdC5nZXQoIk9yZGVyIikgfHwgMTsKCiAgICAgIGlmIChvcmRlciAhPT0gMSkgewogICAgICAgICgwLCBfdXRpbC5pbmZvKSgiTm8gc3VwcG9ydCBmb3IgY3ViaWMgc3BsaW5lIGludGVycG9sYXRpb246ICIgKyBvcmRlcik7CiAgICAgIH0KCiAgICAgIHZhciBlbmNvZGUgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkVuY29kZSIpKTsKCiAgICAgIGlmICghZW5jb2RlKSB7CiAgICAgICAgZW5jb2RlID0gW107CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXRTaXplOyArK2kpIHsKICAgICAgICAgIGVuY29kZS5wdXNoKFswLCBzaXplW2ldIC0gMV0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBlbmNvZGUgPSB0b011bHRpQXJyYXkoZW5jb2RlKTsKICAgICAgfQoKICAgICAgdmFyIGRlY29kZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRGVjb2RlIikpOwoKICAgICAgaWYgKCFkZWNvZGUpIHsKICAgICAgICBkZWNvZGUgPSByYW5nZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkZWNvZGUgPSB0b011bHRpQXJyYXkoZGVjb2RlKTsKICAgICAgfQoKICAgICAgdmFyIHNhbXBsZXMgPSB0aGlzLmdldFNhbXBsZUFycmF5KHNpemUsIG91dHB1dFNpemUsIGJwcywgZm4pOwogICAgICByZXR1cm4gW0NPTlNUUlVDVF9TQU1QTEVELCBpbnB1dFNpemUsIGRvbWFpbiwgZW5jb2RlLCBkZWNvZGUsIHNhbXBsZXMsIHNpemUsIG91dHB1dFNpemUsIE1hdGgucG93KDIsIGJwcykgLSAxLCByYW5nZV07CiAgICB9LAogICAgY29uc3RydWN0U2FtcGxlZEZyb21JUjogZnVuY3Rpb24gY29uc3RydWN0U2FtcGxlZEZyb21JUihfcmVmNykgewogICAgICB2YXIgeHJlZiA9IF9yZWY3LnhyZWYsCiAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQgPSBfcmVmNy5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBJUiA9IF9yZWY3LklSOwoKICAgICAgZnVuY3Rpb24gaW50ZXJwb2xhdGUoeCwgeG1pbiwgeG1heCwgeW1pbiwgeW1heCkgewogICAgICAgIHJldHVybiB5bWluICsgKHggLSB4bWluKSAqICgoeW1heCAtIHltaW4pIC8gKHhtYXggLSB4bWluKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmdW5jdGlvbiBjb25zdHJ1Y3RTYW1wbGVkRnJvbUlSUmVzdWx0KHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgICAgdmFyIG0gPSBJUlsxXTsKICAgICAgICB2YXIgZG9tYWluID0gSVJbMl07CiAgICAgICAgdmFyIGVuY29kZSA9IElSWzNdOwogICAgICAgIHZhciBkZWNvZGUgPSBJUls0XTsKICAgICAgICB2YXIgc2FtcGxlcyA9IElSWzVdOwogICAgICAgIHZhciBzaXplID0gSVJbNl07CiAgICAgICAgdmFyIG4gPSBJUls3XTsKICAgICAgICB2YXIgcmFuZ2UgPSBJUls5XTsKICAgICAgICB2YXIgY3ViZVZlcnRpY2VzID0gMSA8PCBtOwogICAgICAgIHZhciBjdWJlTiA9IG5ldyBGbG9hdDY0QXJyYXkoY3ViZVZlcnRpY2VzKTsKICAgICAgICB2YXIgY3ViZVZlcnRleCA9IG5ldyBVaW50MzJBcnJheShjdWJlVmVydGljZXMpOwogICAgICAgIHZhciBpLCBqOwoKICAgICAgICBmb3IgKGogPSAwOyBqIDwgY3ViZVZlcnRpY2VzOyBqKyspIHsKICAgICAgICAgIGN1YmVOW2pdID0gMTsKICAgICAgICB9CgogICAgICAgIHZhciBrID0gbiwKICAgICAgICAgICAgcG9zID0gMTsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IG07ICsraSkgewogICAgICAgICAgdmFyIGRvbWFpbl8yaSA9IGRvbWFpbltpXVswXTsKICAgICAgICAgIHZhciBkb21haW5fMmlfMSA9IGRvbWFpbltpXVsxXTsKICAgICAgICAgIHZhciB4aSA9IE1hdGgubWluKE1hdGgubWF4KHNyY1tzcmNPZmZzZXQgKyBpXSwgZG9tYWluXzJpKSwgZG9tYWluXzJpXzEpOwogICAgICAgICAgdmFyIGUgPSBpbnRlcnBvbGF0ZSh4aSwgZG9tYWluXzJpLCBkb21haW5fMmlfMSwgZW5jb2RlW2ldWzBdLCBlbmNvZGVbaV1bMV0pOwogICAgICAgICAgdmFyIHNpemVfaSA9IHNpemVbaV07CiAgICAgICAgICBlID0gTWF0aC5taW4oTWF0aC5tYXgoZSwgMCksIHNpemVfaSAtIDEpOwogICAgICAgICAgdmFyIGUwID0gZSA8IHNpemVfaSAtIDEgPyBNYXRoLmZsb29yKGUpIDogZSAtIDE7CiAgICAgICAgICB2YXIgbjAgPSBlMCArIDEgLSBlOwogICAgICAgICAgdmFyIG4xID0gZSAtIGUwOwogICAgICAgICAgdmFyIG9mZnNldDAgPSBlMCAqIGs7CiAgICAgICAgICB2YXIgb2Zmc2V0MSA9IG9mZnNldDAgKyBrOwoKICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBjdWJlVmVydGljZXM7IGorKykgewogICAgICAgICAgICBpZiAoaiAmIHBvcykgewogICAgICAgICAgICAgIGN1YmVOW2pdICo9IG4xOwogICAgICAgICAgICAgIGN1YmVWZXJ0ZXhbal0gKz0gb2Zmc2V0MTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjdWJlTltqXSAqPSBuMDsKICAgICAgICAgICAgICBjdWJlVmVydGV4W2pdICs9IG9mZnNldDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBrICo9IHNpemVfaTsKICAgICAgICAgIHBvcyA8PD0gMTsKICAgICAgICB9CgogICAgICAgIGZvciAoaiA9IDA7IGogPCBuOyArK2opIHsKICAgICAgICAgIHZhciByaiA9IDA7CgogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGN1YmVWZXJ0aWNlczsgaSsrKSB7CiAgICAgICAgICAgIHJqICs9IHNhbXBsZXNbY3ViZVZlcnRleFtpXSArIGpdICogY3ViZU5baV07CiAgICAgICAgICB9CgogICAgICAgICAgcmogPSBpbnRlcnBvbGF0ZShyaiwgMCwgMSwgZGVjb2RlW2pdWzBdLCBkZWNvZGVbal1bMV0pOwogICAgICAgICAgZGVzdFtkZXN0T2Zmc2V0ICsgal0gPSBNYXRoLm1pbihNYXRoLm1heChyaiwgcmFuZ2Vbal1bMF0pLCByYW5nZVtqXVsxXSk7CiAgICAgICAgfQogICAgICB9OwogICAgfSwKICAgIGNvbnN0cnVjdEludGVycG9sYXRlZDogZnVuY3Rpb24gY29uc3RydWN0SW50ZXJwb2xhdGVkKF9yZWY4KSB7CiAgICAgIHZhciB4cmVmID0gX3JlZjgueHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCA9IF9yZWY4LmlzRXZhbFN1cHBvcnRlZCwKICAgICAgICAgIGZuID0gX3JlZjguZm4sCiAgICAgICAgICBkaWN0ID0gX3JlZjguZGljdDsKICAgICAgdmFyIGMwID0gdG9OdW1iZXJBcnJheShkaWN0LmdldEFycmF5KCJDMCIpKSB8fCBbMF07CiAgICAgIHZhciBjMSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiQzEiKSkgfHwgWzFdOwogICAgICB2YXIgbiA9IGRpY3QuZ2V0KCJOIik7CiAgICAgIHZhciBsZW5ndGggPSBjMC5sZW5ndGg7CiAgICAgIHZhciBkaWZmID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7CiAgICAgICAgZGlmZi5wdXNoKGMxW2ldIC0gYzBbaV0pOwogICAgICB9CgogICAgICByZXR1cm4gW0NPTlNUUlVDVF9JTlRFUlBPTEFURUQsIGMwLCBkaWZmLCBuXTsKICAgIH0sCiAgICBjb25zdHJ1Y3RJbnRlcnBvbGF0ZWRGcm9tSVI6IGZ1bmN0aW9uIGNvbnN0cnVjdEludGVycG9sYXRlZEZyb21JUihfcmVmOSkgewogICAgICB2YXIgeHJlZiA9IF9yZWY5LnhyZWYsCiAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQgPSBfcmVmOS5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBJUiA9IF9yZWY5LklSOwogICAgICB2YXIgYzAgPSBJUlsxXTsKICAgICAgdmFyIGRpZmYgPSBJUlsyXTsKICAgICAgdmFyIG4gPSBJUlszXTsKICAgICAgdmFyIGxlbmd0aCA9IGRpZmYubGVuZ3RoOwogICAgICByZXR1cm4gZnVuY3Rpb24gY29uc3RydWN0SW50ZXJwb2xhdGVkRnJvbUlSUmVzdWx0KHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgICAgdmFyIHggPSBuID09PSAxID8gc3JjW3NyY09mZnNldF0gOiBNYXRoLnBvdyhzcmNbc3JjT2Zmc2V0XSwgbik7CgogICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbGVuZ3RoOyArK2opIHsKICAgICAgICAgIGRlc3RbZGVzdE9mZnNldCArIGpdID0gYzBbal0gKyB4ICogZGlmZltqXTsKICAgICAgICB9CiAgICAgIH07CiAgICB9LAogICAgY29uc3RydWN0U3RpY2hlZDogZnVuY3Rpb24gY29uc3RydWN0U3RpY2hlZChfcmVmMTApIHsKICAgICAgdmFyIHhyZWYgPSBfcmVmMTAueHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCA9IF9yZWYxMC5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBmbiA9IF9yZWYxMC5mbiwKICAgICAgICAgIGRpY3QgPSBfcmVmMTAuZGljdDsKICAgICAgdmFyIGRvbWFpbiA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRG9tYWluIikpOwoKICAgICAgaWYgKCFkb21haW4pIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk5vIGRvbWFpbiIpOwogICAgICB9CgogICAgICB2YXIgaW5wdXRTaXplID0gZG9tYWluLmxlbmd0aCAvIDI7CgogICAgICBpZiAoaW5wdXRTaXplICE9PSAxKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCYWQgZG9tYWluIGZvciBzdGljaGVkIGZ1bmN0aW9uIik7CiAgICAgIH0KCiAgICAgIHZhciBmblJlZnMgPSBkaWN0LmdldCgiRnVuY3Rpb25zIik7CiAgICAgIHZhciBmbnMgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGZuUmVmcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgZm5zLnB1c2godGhpcy5wYXJzZSh7CiAgICAgICAgICB4cmVmOiB4cmVmLAogICAgICAgICAgaXNFdmFsU3VwcG9ydGVkOiBpc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBmbjogeHJlZi5mZXRjaElmUmVmKGZuUmVmc1tpXSkKICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIHZhciBib3VuZHMgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIkJvdW5kcyIpKTsKICAgICAgdmFyIGVuY29kZSA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRW5jb2RlIikpOwogICAgICByZXR1cm4gW0NPTlNUUlVDVF9TVElDSEVELCBkb21haW4sIGJvdW5kcywgZW5jb2RlLCBmbnNdOwogICAgfSwKICAgIGNvbnN0cnVjdFN0aWNoZWRGcm9tSVI6IGZ1bmN0aW9uIGNvbnN0cnVjdFN0aWNoZWRGcm9tSVIoX3JlZjExKSB7CiAgICAgIHZhciB4cmVmID0gX3JlZjExLnhyZWYsCiAgICAgICAgICBpc0V2YWxTdXBwb3J0ZWQgPSBfcmVmMTEuaXNFdmFsU3VwcG9ydGVkLAogICAgICAgICAgSVIgPSBfcmVmMTEuSVI7CiAgICAgIHZhciBkb21haW4gPSBJUlsxXTsKICAgICAgdmFyIGJvdW5kcyA9IElSWzJdOwogICAgICB2YXIgZW5jb2RlID0gSVJbM107CiAgICAgIHZhciBmbnMgPSBJUls0XTsKICAgICAgdmFyIHRtcEJ1ZiA9IG5ldyBGbG9hdDMyQXJyYXkoMSk7CiAgICAgIHJldHVybiBmdW5jdGlvbiBjb25zdHJ1Y3RTdGljaGVkRnJvbUlSUmVzdWx0KHNyYywgc3JjT2Zmc2V0LCBkZXN0LCBkZXN0T2Zmc2V0KSB7CiAgICAgICAgdmFyIGNsaXAgPSBmdW5jdGlvbiBjb25zdHJ1Y3RTdGljaGVkRnJvbUlSQ2xpcCh2LCBtaW4sIG1heCkgewogICAgICAgICAgaWYgKHYgPiBtYXgpIHsKICAgICAgICAgICAgdiA9IG1heDsKICAgICAgICAgIH0gZWxzZSBpZiAodiA8IG1pbikgewogICAgICAgICAgICB2ID0gbWluOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB2OwogICAgICAgIH07CgogICAgICAgIHZhciB2ID0gY2xpcChzcmNbc3JjT2Zmc2V0XSwgZG9tYWluWzBdLCBkb21haW5bMV0pOwoKICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBib3VuZHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewogICAgICAgICAgaWYgKHYgPCBib3VuZHNbaV0pIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgZG1pbiA9IGRvbWFpblswXTsKCiAgICAgICAgaWYgKGkgPiAwKSB7CiAgICAgICAgICBkbWluID0gYm91bmRzW2kgLSAxXTsKICAgICAgICB9CgogICAgICAgIHZhciBkbWF4ID0gZG9tYWluWzFdOwoKICAgICAgICBpZiAoaSA8IGJvdW5kcy5sZW5ndGgpIHsKICAgICAgICAgIGRtYXggPSBib3VuZHNbaV07CiAgICAgICAgfQoKICAgICAgICB2YXIgcm1pbiA9IGVuY29kZVsyICogaV07CiAgICAgICAgdmFyIHJtYXggPSBlbmNvZGVbMiAqIGkgKyAxXTsKICAgICAgICB0bXBCdWZbMF0gPSBkbWluID09PSBkbWF4ID8gcm1pbiA6IHJtaW4gKyAodiAtIGRtaW4pICogKHJtYXggLSBybWluKSAvIChkbWF4IC0gZG1pbik7CiAgICAgICAgZm5zW2ldKHRtcEJ1ZiwgMCwgZGVzdCwgZGVzdE9mZnNldCk7CiAgICAgIH07CiAgICB9LAogICAgY29uc3RydWN0UG9zdFNjcmlwdDogZnVuY3Rpb24gY29uc3RydWN0UG9zdFNjcmlwdChfcmVmMTIpIHsKICAgICAgdmFyIHhyZWYgPSBfcmVmMTIueHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCA9IF9yZWYxMi5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBmbiA9IF9yZWYxMi5mbiwKICAgICAgICAgIGRpY3QgPSBfcmVmMTIuZGljdDsKICAgICAgdmFyIGRvbWFpbiA9IHRvTnVtYmVyQXJyYXkoZGljdC5nZXRBcnJheSgiRG9tYWluIikpOwogICAgICB2YXIgcmFuZ2UgPSB0b051bWJlckFycmF5KGRpY3QuZ2V0QXJyYXkoIlJhbmdlIikpOwoKICAgICAgaWYgKCFkb21haW4pIHsKICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIk5vIGRvbWFpbi4iKTsKICAgICAgfQoKICAgICAgaWYgKCFyYW5nZSkgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiTm8gcmFuZ2UuIik7CiAgICAgIH0KCiAgICAgIHZhciBsZXhlciA9IG5ldyBfcHNfcGFyc2VyLlBvc3RTY3JpcHRMZXhlcihmbik7CiAgICAgIHZhciBwYXJzZXIgPSBuZXcgX3BzX3BhcnNlci5Qb3N0U2NyaXB0UGFyc2VyKGxleGVyKTsKICAgICAgdmFyIGNvZGUgPSBwYXJzZXIucGFyc2UoKTsKICAgICAgcmV0dXJuIFtDT05TVFJVQ1RfUE9TVFNDUklQVCwgZG9tYWluLCByYW5nZSwgY29kZV07CiAgICB9LAogICAgY29uc3RydWN0UG9zdFNjcmlwdEZyb21JUjogZnVuY3Rpb24gY29uc3RydWN0UG9zdFNjcmlwdEZyb21JUihfcmVmMTMpIHsKICAgICAgdmFyIHhyZWYgPSBfcmVmMTMueHJlZiwKICAgICAgICAgIGlzRXZhbFN1cHBvcnRlZCA9IF9yZWYxMy5pc0V2YWxTdXBwb3J0ZWQsCiAgICAgICAgICBJUiA9IF9yZWYxMy5JUjsKICAgICAgdmFyIGRvbWFpbiA9IElSWzFdOwogICAgICB2YXIgcmFuZ2UgPSBJUlsyXTsKICAgICAgdmFyIGNvZGUgPSBJUlszXTsKCiAgICAgIGlmIChpc0V2YWxTdXBwb3J0ZWQgJiYgX3V0aWwuSXNFdmFsU3VwcG9ydGVkQ2FjaGVkLnZhbHVlKSB7CiAgICAgICAgdmFyIGNvbXBpbGVkID0gbmV3IFBvc3RTY3JpcHRDb21waWxlcigpLmNvbXBpbGUoY29kZSwgZG9tYWluLCByYW5nZSk7CgogICAgICAgIGlmIChjb21waWxlZCkgewogICAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbigic3JjIiwgInNyY09mZnNldCIsICJkZXN0IiwgImRlc3RPZmZzZXQiLCBjb21waWxlZCk7CiAgICAgICAgfQogICAgICB9CgogICAgICAoMCwgX3V0aWwuaW5mbykoIlVuYWJsZSB0byBjb21waWxlIFBTIGZ1bmN0aW9uIik7CiAgICAgIHZhciBudW1PdXRwdXRzID0gcmFuZ2UubGVuZ3RoID4+IDE7CiAgICAgIHZhciBudW1JbnB1dHMgPSBkb21haW4ubGVuZ3RoID4+IDE7CiAgICAgIHZhciBldmFsdWF0b3IgPSBuZXcgUG9zdFNjcmlwdEV2YWx1YXRvcihjb2RlKTsKICAgICAgdmFyIGNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgdmFyIE1BWF9DQUNIRV9TSVpFID0gMjA0OCAqIDQ7CiAgICAgIHZhciBjYWNoZV9hdmFpbGFibGUgPSBNQVhfQ0FDSEVfU0laRTsKICAgICAgdmFyIHRtcEJ1ZiA9IG5ldyBGbG9hdDMyQXJyYXkobnVtSW5wdXRzKTsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIGNvbnN0cnVjdFBvc3RTY3JpcHRGcm9tSVJSZXN1bHQoc3JjLCBzcmNPZmZzZXQsIGRlc3QsIGRlc3RPZmZzZXQpIHsKICAgICAgICB2YXIgaSwgdmFsdWU7CiAgICAgICAgdmFyIGtleSA9ICIiOwogICAgICAgIHZhciBpbnB1dCA9IHRtcEJ1ZjsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IG51bUlucHV0czsgaSsrKSB7CiAgICAgICAgICB2YWx1ZSA9IHNyY1tzcmNPZmZzZXQgKyBpXTsKICAgICAgICAgIGlucHV0W2ldID0gdmFsdWU7CiAgICAgICAgICBrZXkgKz0gdmFsdWUgKyAiXyI7CiAgICAgICAgfQoKICAgICAgICB2YXIgY2FjaGVkVmFsdWUgPSBjYWNoZVtrZXldOwoKICAgICAgICBpZiAoY2FjaGVkVmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgZGVzdC5zZXQoY2FjaGVkVmFsdWUsIGRlc3RPZmZzZXQpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIG91dHB1dCA9IG5ldyBGbG9hdDMyQXJyYXkobnVtT3V0cHV0cyk7CiAgICAgICAgdmFyIHN0YWNrID0gZXZhbHVhdG9yLmV4ZWN1dGUoaW5wdXQpOwogICAgICAgIHZhciBzdGFja0luZGV4ID0gc3RhY2subGVuZ3RoIC0gbnVtT3V0cHV0czsKCiAgICAgICAgZm9yIChpID0gMDsgaSA8IG51bU91dHB1dHM7IGkrKykgewogICAgICAgICAgdmFsdWUgPSBzdGFja1tzdGFja0luZGV4ICsgaV07CiAgICAgICAgICB2YXIgYm91bmQgPSByYW5nZVtpICogMl07CgogICAgICAgICAgaWYgKHZhbHVlIDwgYm91bmQpIHsKICAgICAgICAgICAgdmFsdWUgPSBib3VuZDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGJvdW5kID0gcmFuZ2VbaSAqIDIgKyAxXTsKCiAgICAgICAgICAgIGlmICh2YWx1ZSA+IGJvdW5kKSB7CiAgICAgICAgICAgICAgdmFsdWUgPSBib3VuZDsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIG91dHB1dFtpXSA9IHZhbHVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNhY2hlX2F2YWlsYWJsZSA+IDApIHsKICAgICAgICAgIGNhY2hlX2F2YWlsYWJsZS0tOwogICAgICAgICAgY2FjaGVba2V5XSA9IG91dHB1dDsKICAgICAgICB9CgogICAgICAgIGRlc3Quc2V0KG91dHB1dCwgZGVzdE9mZnNldCk7CiAgICAgIH07CiAgICB9CiAgfTsKfSgpOwoKZnVuY3Rpb24gaXNQREZGdW5jdGlvbih2KSB7CiAgdmFyIGZuRGljdDsKCiAgaWYgKF90eXBlb2YodikgIT09ICJvYmplY3QiKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfSBlbHNlIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNEaWN0KSh2KSkgewogICAgZm5EaWN0ID0gdjsKICB9IGVsc2UgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc1N0cmVhbSkodikpIHsKICAgIGZuRGljdCA9IHYuZGljdDsKICB9IGVsc2UgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgcmV0dXJuIGZuRGljdC5oYXMoIkZ1bmN0aW9uVHlwZSIpOwp9Cgp2YXIgUG9zdFNjcmlwdFN0YWNrID0gZnVuY3Rpb24gUG9zdFNjcmlwdFN0YWNrQ2xvc3VyZSgpIHsKICB2YXIgTUFYX1NUQUNLX1NJWkUgPSAxMDA7CgogIGZ1bmN0aW9uIFBvc3RTY3JpcHRTdGFjayhpbml0aWFsU3RhY2spIHsKICAgIHRoaXMuc3RhY2sgPSAhaW5pdGlhbFN0YWNrID8gW10gOiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChpbml0aWFsU3RhY2ssIDApOwogIH0KCiAgUG9zdFNjcmlwdFN0YWNrLnByb3RvdHlwZSA9IHsKICAgIHB1c2g6IGZ1bmN0aW9uIFBvc3RTY3JpcHRTdGFja19wdXNoKHZhbHVlKSB7CiAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA+PSBNQVhfU1RBQ0tfU0laRSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiUG9zdFNjcmlwdCBmdW5jdGlvbiBzdGFjayBvdmVyZmxvdy4iKTsKICAgICAgfQoKICAgICAgdGhpcy5zdGFjay5wdXNoKHZhbHVlKTsKICAgIH0sCiAgICBwb3A6IGZ1bmN0aW9uIFBvc3RTY3JpcHRTdGFja19wb3AoKSB7CiAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA8PSAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQb3N0U2NyaXB0IGZ1bmN0aW9uIHN0YWNrIHVuZGVyZmxvdy4iKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuc3RhY2sucG9wKCk7CiAgICB9LAogICAgY29weTogZnVuY3Rpb24gUG9zdFNjcmlwdFN0YWNrX2NvcHkobikgewogICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggKyBuID49IE1BWF9TVEFDS19TSVpFKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJQb3N0U2NyaXB0IGZ1bmN0aW9uIHN0YWNrIG92ZXJmbG93LiIpOwogICAgICB9CgogICAgICB2YXIgc3RhY2sgPSB0aGlzLnN0YWNrOwoKICAgICAgZm9yICh2YXIgaSA9IHN0YWNrLmxlbmd0aCAtIG4sIGogPSBuIC0gMTsgaiA+PSAwOyBqLS0sIGkrKykgewogICAgICAgIHN0YWNrLnB1c2goc3RhY2tbaV0pOwogICAgICB9CiAgICB9LAogICAgaW5kZXg6IGZ1bmN0aW9uIFBvc3RTY3JpcHRTdGFja19pbmRleChuKSB7CiAgICAgIHRoaXMucHVzaCh0aGlzLnN0YWNrW3RoaXMuc3RhY2subGVuZ3RoIC0gbiAtIDFdKTsKICAgIH0sCiAgICByb2xsOiBmdW5jdGlvbiBQb3N0U2NyaXB0U3RhY2tfcm9sbChuLCBwKSB7CiAgICAgIHZhciBzdGFjayA9IHRoaXMuc3RhY2s7CiAgICAgIHZhciBsID0gc3RhY2subGVuZ3RoIC0gbjsKICAgICAgdmFyIHIgPSBzdGFjay5sZW5ndGggLSAxLAogICAgICAgICAgYyA9IGwgKyAocCAtIE1hdGguZmxvb3IocCAvIG4pICogbiksCiAgICAgICAgICBpLAogICAgICAgICAgaiwKICAgICAgICAgIHQ7CgogICAgICBmb3IgKGkgPSBsLCBqID0gcjsgaSA8IGo7IGkrKywgai0tKSB7CiAgICAgICAgdCA9IHN0YWNrW2ldOwogICAgICAgIHN0YWNrW2ldID0gc3RhY2tbal07CiAgICAgICAgc3RhY2tbal0gPSB0OwogICAgICB9CgogICAgICBmb3IgKGkgPSBsLCBqID0gYyAtIDE7IGkgPCBqOyBpKyssIGotLSkgewogICAgICAgIHQgPSBzdGFja1tpXTsKICAgICAgICBzdGFja1tpXSA9IHN0YWNrW2pdOwogICAgICAgIHN0YWNrW2pdID0gdDsKICAgICAgfQoKICAgICAgZm9yIChpID0gYywgaiA9IHI7IGkgPCBqOyBpKyssIGotLSkgewogICAgICAgIHQgPSBzdGFja1tpXTsKICAgICAgICBzdGFja1tpXSA9IHN0YWNrW2pdOwogICAgICAgIHN0YWNrW2pdID0gdDsKICAgICAgfQogICAgfQogIH07CiAgcmV0dXJuIFBvc3RTY3JpcHRTdGFjazsKfSgpOwoKdmFyIFBvc3RTY3JpcHRFdmFsdWF0b3IgPSBmdW5jdGlvbiBQb3N0U2NyaXB0RXZhbHVhdG9yQ2xvc3VyZSgpIHsKICBmdW5jdGlvbiBQb3N0U2NyaXB0RXZhbHVhdG9yKG9wZXJhdG9ycykgewogICAgdGhpcy5vcGVyYXRvcnMgPSBvcGVyYXRvcnM7CiAgfQoKICBQb3N0U2NyaXB0RXZhbHVhdG9yLnByb3RvdHlwZSA9IHsKICAgIGV4ZWN1dGU6IGZ1bmN0aW9uIFBvc3RTY3JpcHRFdmFsdWF0b3JfZXhlY3V0ZShpbml0aWFsU3RhY2spIHsKICAgICAgdmFyIHN0YWNrID0gbmV3IFBvc3RTY3JpcHRTdGFjayhpbml0aWFsU3RhY2spOwogICAgICB2YXIgY291bnRlciA9IDA7CiAgICAgIHZhciBvcGVyYXRvcnMgPSB0aGlzLm9wZXJhdG9yczsKICAgICAgdmFyIGxlbmd0aCA9IG9wZXJhdG9ycy5sZW5ndGg7CiAgICAgIHZhciBvcGVyYXRvciwgYSwgYjsKCiAgICAgIHdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7CiAgICAgICAgb3BlcmF0b3IgPSBvcGVyYXRvcnNbY291bnRlcisrXTsKCiAgICAgICAgaWYgKHR5cGVvZiBvcGVyYXRvciA9PT0gIm51bWJlciIpIHsKICAgICAgICAgIHN0YWNrLnB1c2gob3BlcmF0b3IpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7CiAgICAgICAgICBjYXNlICJqeiI6CiAgICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwoKICAgICAgICAgICAgaWYgKCFhKSB7CiAgICAgICAgICAgICAgY291bnRlciA9IGI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImoiOgogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGNvdW50ZXIgPSBhOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJhYnMiOgogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goTWF0aC5hYnMoYSkpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJhZGQiOgogICAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChhICsgYik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImFuZCI6CiAgICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwoKICAgICAgICAgICAgaWYgKCgwLCBfdXRpbC5pc0Jvb2wpKGEpICYmICgwLCBfdXRpbC5pc0Jvb2wpKGIpKSB7CiAgICAgICAgICAgICAgc3RhY2sucHVzaChhICYmIGIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN0YWNrLnB1c2goYSAmIGIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJhdGFuIjoKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5wdXNoKE1hdGguYXRhbihhKSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImJpdHNoaWZ0IjoKICAgICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgICBpZiAoYSA+IDApIHsKICAgICAgICAgICAgICBzdGFjay5wdXNoKGEgPDwgYik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc3RhY2sucHVzaChhID4+IGIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJjZWlsaW5nIjoKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5wdXNoKE1hdGguY2VpbChhKSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImNvcHkiOgogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLmNvcHkoYSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImNvcyI6CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChNYXRoLmNvcyhhKSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImN2aSI6CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKSB8IDA7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImN2ciI6CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImRpdiI6CiAgICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5wdXNoKGEgLyBiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiZHVwIjoKICAgICAgICAgICAgc3RhY2suY29weSgxKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiZXEiOgogICAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChhID09PSBiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiZXhjaCI6CiAgICAgICAgICAgIHN0YWNrLnJvbGwoMiwgMSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImV4cCI6CiAgICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5wdXNoKE1hdGgucG93KGEsIGIpKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiZmFsc2UiOgogICAgICAgICAgICBzdGFjay5wdXNoKGZhbHNlKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiZmxvb3IiOgogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goTWF0aC5mbG9vcihhKSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImdlIjoKICAgICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSA+PSBiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiZ3QiOgogICAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChhID4gYik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImlkaXYiOgogICAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChhIC8gYiB8IDApOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJpbmRleCI6CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2suaW5kZXgoYSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImxlIjoKICAgICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSA8PSBiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAibG4iOgogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goTWF0aC5sb2coYSkpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJsb2ciOgogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goTWF0aC5sb2coYSkgLyBNYXRoLkxOMTApOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJsdCI6CiAgICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5wdXNoKGEgPCBiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAibW9kIjoKICAgICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSAlIGIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJtdWwiOgogICAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChhICogYik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIm5lIjoKICAgICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYSAhPT0gYik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIm5lZyI6CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaCgtYSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIm5vdCI6CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKCiAgICAgICAgICAgIGlmICgoMCwgX3V0aWwuaXNCb29sKShhKSkgewogICAgICAgICAgICAgIHN0YWNrLnB1c2goIWEpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN0YWNrLnB1c2gofmEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJvciI6CiAgICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwoKICAgICAgICAgICAgaWYgKCgwLCBfdXRpbC5pc0Jvb2wpKGEpICYmICgwLCBfdXRpbC5pc0Jvb2wpKGIpKSB7CiAgICAgICAgICAgICAgc3RhY2sucHVzaChhIHx8IGIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN0YWNrLnB1c2goYSB8IGIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJwb3AiOgogICAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAicm9sbCI6CiAgICAgICAgICAgIGIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5yb2xsKGEsIGIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJyb3VuZCI6CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChNYXRoLnJvdW5kKGEpKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAic2luIjoKICAgICAgICAgICAgYSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5wdXNoKE1hdGguc2luKGEpKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAic3FydCI6CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChNYXRoLnNxcnQoYSkpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJzdWIiOgogICAgICAgICAgICBiID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChhIC0gYik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgInRydWUiOgogICAgICAgICAgICBzdGFjay5wdXNoKHRydWUpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJ0cnVuY2F0ZSI6CiAgICAgICAgICAgIGEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYSA9IGEgPCAwID8gTWF0aC5jZWlsKGEpIDogTWF0aC5mbG9vcihhKTsKICAgICAgICAgICAgc3RhY2sucHVzaChhKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAieG9yIjoKICAgICAgICAgICAgYiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBhID0gc3RhY2sucG9wKCk7CgogICAgICAgICAgICBpZiAoKDAsIF91dGlsLmlzQm9vbCkoYSkgJiYgKDAsIF91dGlsLmlzQm9vbCkoYikpIHsKICAgICAgICAgICAgICBzdGFjay5wdXNoKGEgIT09IGIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN0YWNrLnB1c2goYSBeIGIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIlVua25vd24gb3BlcmF0b3IgIi5jb25jYXQob3BlcmF0b3IpKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBzdGFjay5zdGFjazsKICAgIH0KICB9OwogIHJldHVybiBQb3N0U2NyaXB0RXZhbHVhdG9yOwp9KCk7CgpleHBvcnRzLlBvc3RTY3JpcHRFdmFsdWF0b3IgPSBQb3N0U2NyaXB0RXZhbHVhdG9yOwoKdmFyIFBvc3RTY3JpcHRDb21waWxlciA9IGZ1bmN0aW9uIFBvc3RTY3JpcHRDb21waWxlckNsb3N1cmUoKSB7CiAgZnVuY3Rpb24gQXN0Tm9kZSh0eXBlKSB7CiAgICB0aGlzLnR5cGUgPSB0eXBlOwogIH0KCiAgQXN0Tm9kZS5wcm90b3R5cGUudmlzaXQgPSBmdW5jdGlvbiAodmlzaXRvcikgewogICAgKDAsIF91dGlsLnVucmVhY2hhYmxlKSgiYWJzdHJhY3QgbWV0aG9kIik7CiAgfTsKCiAgZnVuY3Rpb24gQXN0QXJndW1lbnQoaW5kZXgsIG1pbiwgbWF4KSB7CiAgICBBc3ROb2RlLmNhbGwodGhpcywgImFyZ3MiKTsKICAgIHRoaXMuaW5kZXggPSBpbmRleDsKICAgIHRoaXMubWluID0gbWluOwogICAgdGhpcy5tYXggPSBtYXg7CiAgfQoKICBBc3RBcmd1bWVudC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEFzdE5vZGUucHJvdG90eXBlKTsKCiAgQXN0QXJndW1lbnQucHJvdG90eXBlLnZpc2l0ID0gZnVuY3Rpb24gKHZpc2l0b3IpIHsKICAgIHZpc2l0b3IudmlzaXRBcmd1bWVudCh0aGlzKTsKICB9OwoKICBmdW5jdGlvbiBBc3RMaXRlcmFsKG51bWJlcikgewogICAgQXN0Tm9kZS5jYWxsKHRoaXMsICJsaXRlcmFsIik7CiAgICB0aGlzLm51bWJlciA9IG51bWJlcjsKICAgIHRoaXMubWluID0gbnVtYmVyOwogICAgdGhpcy5tYXggPSBudW1iZXI7CiAgfQoKICBBc3RMaXRlcmFsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQXN0Tm9kZS5wcm90b3R5cGUpOwoKICBBc3RMaXRlcmFsLnByb3RvdHlwZS52aXNpdCA9IGZ1bmN0aW9uICh2aXNpdG9yKSB7CiAgICB2aXNpdG9yLnZpc2l0TGl0ZXJhbCh0aGlzKTsKICB9OwoKICBmdW5jdGlvbiBBc3RCaW5hcnlPcGVyYXRpb24ob3AsIGFyZzEsIGFyZzIsIG1pbiwgbWF4KSB7CiAgICBBc3ROb2RlLmNhbGwodGhpcywgImJpbmFyeSIpOwogICAgdGhpcy5vcCA9IG9wOwogICAgdGhpcy5hcmcxID0gYXJnMTsKICAgIHRoaXMuYXJnMiA9IGFyZzI7CiAgICB0aGlzLm1pbiA9IG1pbjsKICAgIHRoaXMubWF4ID0gbWF4OwogIH0KCiAgQXN0QmluYXJ5T3BlcmF0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQXN0Tm9kZS5wcm90b3R5cGUpOwoKICBBc3RCaW5hcnlPcGVyYXRpb24ucHJvdG90eXBlLnZpc2l0ID0gZnVuY3Rpb24gKHZpc2l0b3IpIHsKICAgIHZpc2l0b3IudmlzaXRCaW5hcnlPcGVyYXRpb24odGhpcyk7CiAgfTsKCiAgZnVuY3Rpb24gQXN0TWluKGFyZywgbWF4KSB7CiAgICBBc3ROb2RlLmNhbGwodGhpcywgIm1heCIpOwogICAgdGhpcy5hcmcgPSBhcmc7CiAgICB0aGlzLm1pbiA9IGFyZy5taW47CiAgICB0aGlzLm1heCA9IG1heDsKICB9CgogIEFzdE1pbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEFzdE5vZGUucHJvdG90eXBlKTsKCiAgQXN0TWluLnByb3RvdHlwZS52aXNpdCA9IGZ1bmN0aW9uICh2aXNpdG9yKSB7CiAgICB2aXNpdG9yLnZpc2l0TWluKHRoaXMpOwogIH07CgogIGZ1bmN0aW9uIEFzdFZhcmlhYmxlKGluZGV4LCBtaW4sIG1heCkgewogICAgQXN0Tm9kZS5jYWxsKHRoaXMsICJ2YXIiKTsKICAgIHRoaXMuaW5kZXggPSBpbmRleDsKICAgIHRoaXMubWluID0gbWluOwogICAgdGhpcy5tYXggPSBtYXg7CiAgfQoKICBBc3RWYXJpYWJsZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEFzdE5vZGUucHJvdG90eXBlKTsKCiAgQXN0VmFyaWFibGUucHJvdG90eXBlLnZpc2l0ID0gZnVuY3Rpb24gKHZpc2l0b3IpIHsKICAgIHZpc2l0b3IudmlzaXRWYXJpYWJsZSh0aGlzKTsKICB9OwoKICBmdW5jdGlvbiBBc3RWYXJpYWJsZURlZmluaXRpb24odmFyaWFibGUsIGFyZykgewogICAgQXN0Tm9kZS5jYWxsKHRoaXMsICJkZWZpbml0aW9uIik7CiAgICB0aGlzLnZhcmlhYmxlID0gdmFyaWFibGU7CiAgICB0aGlzLmFyZyA9IGFyZzsKICB9CgogIEFzdFZhcmlhYmxlRGVmaW5pdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEFzdE5vZGUucHJvdG90eXBlKTsKCiAgQXN0VmFyaWFibGVEZWZpbml0aW9uLnByb3RvdHlwZS52aXNpdCA9IGZ1bmN0aW9uICh2aXNpdG9yKSB7CiAgICB2aXNpdG9yLnZpc2l0VmFyaWFibGVEZWZpbml0aW9uKHRoaXMpOwogIH07CgogIGZ1bmN0aW9uIEV4cHJlc3Npb25CdWlsZGVyVmlzaXRvcigpIHsKICAgIHRoaXMucGFydHMgPSBbXTsKICB9CgogIEV4cHJlc3Npb25CdWlsZGVyVmlzaXRvci5wcm90b3R5cGUgPSB7CiAgICB2aXNpdEFyZ3VtZW50OiBmdW5jdGlvbiB2aXNpdEFyZ3VtZW50KGFyZykgewogICAgICB0aGlzLnBhcnRzLnB1c2goIk1hdGgubWF4KCIsIGFyZy5taW4sICIsIE1hdGgubWluKCIsIGFyZy5tYXgsICIsIHNyY1tzcmNPZmZzZXQgKyAiLCBhcmcuaW5kZXgsICJdKSkiKTsKICAgIH0sCiAgICB2aXNpdFZhcmlhYmxlOiBmdW5jdGlvbiB2aXNpdFZhcmlhYmxlKHZhcmlhYmxlKSB7CiAgICAgIHRoaXMucGFydHMucHVzaCgidiIsIHZhcmlhYmxlLmluZGV4KTsKICAgIH0sCiAgICB2aXNpdExpdGVyYWw6IGZ1bmN0aW9uIHZpc2l0TGl0ZXJhbChsaXRlcmFsKSB7CiAgICAgIHRoaXMucGFydHMucHVzaChsaXRlcmFsLm51bWJlcik7CiAgICB9LAogICAgdmlzaXRCaW5hcnlPcGVyYXRpb246IGZ1bmN0aW9uIHZpc2l0QmluYXJ5T3BlcmF0aW9uKG9wZXJhdGlvbikgewogICAgICB0aGlzLnBhcnRzLnB1c2goIigiKTsKICAgICAgb3BlcmF0aW9uLmFyZzEudmlzaXQodGhpcyk7CiAgICAgIHRoaXMucGFydHMucHVzaCgiICIsIG9wZXJhdGlvbi5vcCwgIiAiKTsKICAgICAgb3BlcmF0aW9uLmFyZzIudmlzaXQodGhpcyk7CiAgICAgIHRoaXMucGFydHMucHVzaCgiKSIpOwogICAgfSwKICAgIHZpc2l0VmFyaWFibGVEZWZpbml0aW9uOiBmdW5jdGlvbiB2aXNpdFZhcmlhYmxlRGVmaW5pdGlvbihkZWZpbml0aW9uKSB7CiAgICAgIHRoaXMucGFydHMucHVzaCgidmFyICIpOwogICAgICBkZWZpbml0aW9uLnZhcmlhYmxlLnZpc2l0KHRoaXMpOwogICAgICB0aGlzLnBhcnRzLnB1c2goIiA9ICIpOwogICAgICBkZWZpbml0aW9uLmFyZy52aXNpdCh0aGlzKTsKICAgICAgdGhpcy5wYXJ0cy5wdXNoKCI7Iik7CiAgICB9LAogICAgdmlzaXRNaW46IGZ1bmN0aW9uIHZpc2l0TWluKG1heCkgewogICAgICB0aGlzLnBhcnRzLnB1c2goIk1hdGgubWluKCIpOwogICAgICBtYXguYXJnLnZpc2l0KHRoaXMpOwogICAgICB0aGlzLnBhcnRzLnB1c2goIiwgIiwgbWF4Lm1heCwgIikiKTsKICAgIH0sCiAgICB0b1N0cmluZzogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLnBhcnRzLmpvaW4oIiIpOwogICAgfQogIH07CgogIGZ1bmN0aW9uIGJ1aWxkQWRkT3BlcmF0aW9uKG51bTEsIG51bTIpIHsKICAgIGlmIChudW0yLnR5cGUgPT09ICJsaXRlcmFsIiAmJiBudW0yLm51bWJlciA9PT0gMCkgewogICAgICByZXR1cm4gbnVtMTsKICAgIH0KCiAgICBpZiAobnVtMS50eXBlID09PSAibGl0ZXJhbCIgJiYgbnVtMS5udW1iZXIgPT09IDApIHsKICAgICAgcmV0dXJuIG51bTI7CiAgICB9CgogICAgaWYgKG51bTIudHlwZSA9PT0gImxpdGVyYWwiICYmIG51bTEudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICAgIHJldHVybiBuZXcgQXN0TGl0ZXJhbChudW0xLm51bWJlciArIG51bTIubnVtYmVyKTsKICAgIH0KCiAgICByZXR1cm4gbmV3IEFzdEJpbmFyeU9wZXJhdGlvbigiKyIsIG51bTEsIG51bTIsIG51bTEubWluICsgbnVtMi5taW4sIG51bTEubWF4ICsgbnVtMi5tYXgpOwogIH0KCiAgZnVuY3Rpb24gYnVpbGRNdWxPcGVyYXRpb24obnVtMSwgbnVtMikgewogICAgaWYgKG51bTIudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICAgIGlmIChudW0yLm51bWJlciA9PT0gMCkgewogICAgICAgIHJldHVybiBuZXcgQXN0TGl0ZXJhbCgwKTsKICAgICAgfSBlbHNlIGlmIChudW0yLm51bWJlciA9PT0gMSkgewogICAgICAgIHJldHVybiBudW0xOwogICAgICB9IGVsc2UgaWYgKG51bTEudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBc3RMaXRlcmFsKG51bTEubnVtYmVyICogbnVtMi5udW1iZXIpOwogICAgICB9CiAgICB9CgogICAgaWYgKG51bTEudHlwZSA9PT0gImxpdGVyYWwiKSB7CiAgICAgIGlmIChudW0xLm51bWJlciA9PT0gMCkgewogICAgICAgIHJldHVybiBuZXcgQXN0TGl0ZXJhbCgwKTsKICAgICAgfSBlbHNlIGlmIChudW0xLm51bWJlciA9PT0gMSkgewogICAgICAgIHJldHVybiBudW0yOwogICAgICB9CiAgICB9CgogICAgdmFyIG1pbiA9IE1hdGgubWluKG51bTEubWluICogbnVtMi5taW4sIG51bTEubWluICogbnVtMi5tYXgsIG51bTEubWF4ICogbnVtMi5taW4sIG51bTEubWF4ICogbnVtMi5tYXgpOwogICAgdmFyIG1heCA9IE1hdGgubWF4KG51bTEubWluICogbnVtMi5taW4sIG51bTEubWluICogbnVtMi5tYXgsIG51bTEubWF4ICogbnVtMi5taW4sIG51bTEubWF4ICogbnVtMi5tYXgpOwogICAgcmV0dXJuIG5ldyBBc3RCaW5hcnlPcGVyYXRpb24oIioiLCBudW0xLCBudW0yLCBtaW4sIG1heCk7CiAgfQoKICBmdW5jdGlvbiBidWlsZFN1Yk9wZXJhdGlvbihudW0xLCBudW0yKSB7CiAgICBpZiAobnVtMi50eXBlID09PSAibGl0ZXJhbCIpIHsKICAgICAgaWYgKG51bTIubnVtYmVyID09PSAwKSB7CiAgICAgICAgcmV0dXJuIG51bTE7CiAgICAgIH0gZWxzZSBpZiAobnVtMS50eXBlID09PSAibGl0ZXJhbCIpIHsKICAgICAgICByZXR1cm4gbmV3IEFzdExpdGVyYWwobnVtMS5udW1iZXIgLSBudW0yLm51bWJlcik7CiAgICAgIH0KICAgIH0KCiAgICBpZiAobnVtMi50eXBlID09PSAiYmluYXJ5IiAmJiBudW0yLm9wID09PSAiLSIgJiYgbnVtMS50eXBlID09PSAibGl0ZXJhbCIgJiYgbnVtMS5udW1iZXIgPT09IDEgJiYgbnVtMi5hcmcxLnR5cGUgPT09ICJsaXRlcmFsIiAmJiBudW0yLmFyZzEubnVtYmVyID09PSAxKSB7CiAgICAgIHJldHVybiBudW0yLmFyZzI7CiAgICB9CgogICAgcmV0dXJuIG5ldyBBc3RCaW5hcnlPcGVyYXRpb24oIi0iLCBudW0xLCBudW0yLCBudW0xLm1pbiAtIG51bTIubWF4LCBudW0xLm1heCAtIG51bTIubWluKTsKICB9CgogIGZ1bmN0aW9uIGJ1aWxkTWluT3BlcmF0aW9uKG51bTEsIG1heCkgewogICAgaWYgKG51bTEubWluID49IG1heCkgewogICAgICByZXR1cm4gbmV3IEFzdExpdGVyYWwobWF4KTsKICAgIH0gZWxzZSBpZiAobnVtMS5tYXggPD0gbWF4KSB7CiAgICAgIHJldHVybiBudW0xOwogICAgfQoKICAgIHJldHVybiBuZXcgQXN0TWluKG51bTEsIG1heCk7CiAgfQoKICBmdW5jdGlvbiBQb3N0U2NyaXB0Q29tcGlsZXIoKSB7fQoKICBQb3N0U2NyaXB0Q29tcGlsZXIucHJvdG90eXBlID0gewogICAgY29tcGlsZTogZnVuY3Rpb24gUG9zdFNjcmlwdENvbXBpbGVyX2NvbXBpbGUoY29kZSwgZG9tYWluLCByYW5nZSkgewogICAgICB2YXIgc3RhY2sgPSBbXTsKICAgICAgdmFyIGluc3RydWN0aW9ucyA9IFtdOwogICAgICB2YXIgaW5wdXRTaXplID0gZG9tYWluLmxlbmd0aCA+PiAxLAogICAgICAgICAgb3V0cHV0U2l6ZSA9IHJhbmdlLmxlbmd0aCA+PiAxOwogICAgICB2YXIgbGFzdFJlZ2lzdGVyID0gMDsKICAgICAgdmFyIG4sIGo7CiAgICAgIHZhciBudW0xLCBudW0yLCBhc3QxLCBhc3QyLCB0bXBWYXIsIGl0ZW07CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0U2l6ZTsgaSsrKSB7CiAgICAgICAgc3RhY2sucHVzaChuZXcgQXN0QXJndW1lbnQoaSwgZG9tYWluW2kgKiAyXSwgZG9tYWluW2kgKiAyICsgMV0pKTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgX2kgPSAwLCBpaSA9IGNvZGUubGVuZ3RoOyBfaSA8IGlpOyBfaSsrKSB7CiAgICAgICAgaXRlbSA9IGNvZGVbX2ldOwoKICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJudW1iZXIiKSB7CiAgICAgICAgICBzdGFjay5wdXNoKG5ldyBBc3RMaXRlcmFsKGl0ZW0pKTsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgc3dpdGNoIChpdGVtKSB7CiAgICAgICAgICBjYXNlICJhZGQiOgogICAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBudW0yID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIG51bTEgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgc3RhY2sucHVzaChidWlsZEFkZE9wZXJhdGlvbihudW0xLCBudW0yKSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImN2ciI6CiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgIm11bCI6CiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG51bTIgPSBzdGFjay5wb3AoKTsKICAgICAgICAgICAgbnVtMSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBzdGFjay5wdXNoKGJ1aWxkTXVsT3BlcmF0aW9uKG51bTEsIG51bTIpKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAic3ViIjoKICAgICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbnVtMiA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBudW0xID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYnVpbGRTdWJPcGVyYXRpb24obnVtMSwgbnVtMikpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJleGNoIjoKICAgICAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYXN0MSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICBhc3QyID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIHN0YWNrLnB1c2goYXN0MSwgYXN0Mik7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgInBvcCI6CiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJpbmRleCI6CiAgICAgICAgICAgIGlmIChzdGFjay5sZW5ndGggPCAxKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG51bTEgPSBzdGFjay5wb3AoKTsKCiAgICAgICAgICAgIGlmIChudW0xLnR5cGUgIT09ICJsaXRlcmFsIikgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuID0gbnVtMS5udW1iZXI7CgogICAgICAgICAgICBpZiAobiA8IDAgfHwgIU51bWJlci5pc0ludGVnZXIobikgfHwgc3RhY2subGVuZ3RoIDwgbikgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhc3QxID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gbiAtIDFdOwoKICAgICAgICAgICAgaWYgKGFzdDEudHlwZSA9PT0gImxpdGVyYWwiIHx8IGFzdDEudHlwZSA9PT0gInZhciIpIHsKICAgICAgICAgICAgICBzdGFjay5wdXNoKGFzdDEpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0bXBWYXIgPSBuZXcgQXN0VmFyaWFibGUobGFzdFJlZ2lzdGVyKyssIGFzdDEubWluLCBhc3QxLm1heCk7CiAgICAgICAgICAgIHN0YWNrW3N0YWNrLmxlbmd0aCAtIG4gLSAxXSA9IHRtcFZhcjsKICAgICAgICAgICAgc3RhY2sucHVzaCh0bXBWYXIpOwogICAgICAgICAgICBpbnN0cnVjdGlvbnMucHVzaChuZXcgQXN0VmFyaWFibGVEZWZpbml0aW9uKHRtcFZhciwgYXN0MSkpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJkdXAiOgogICAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMSkgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodHlwZW9mIGNvZGVbX2kgKyAxXSA9PT0gIm51bWJlciIgJiYgY29kZVtfaSArIDJdID09PSAiZ3QiICYmIGNvZGVbX2kgKyAzXSA9PT0gX2kgKyA3ICYmIGNvZGVbX2kgKyA0XSA9PT0gImp6IiAmJiBjb2RlW19pICsgNV0gPT09ICJwb3AiICYmIGNvZGVbX2kgKyA2XSA9PT0gY29kZVtfaSArIDFdKSB7CiAgICAgICAgICAgICAgbnVtMSA9IHN0YWNrLnBvcCgpOwogICAgICAgICAgICAgIHN0YWNrLnB1c2goYnVpbGRNaW5PcGVyYXRpb24obnVtMSwgY29kZVtfaSArIDFdKSk7CiAgICAgICAgICAgICAgX2kgKz0gNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYXN0MSA9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdOwoKICAgICAgICAgICAgaWYgKGFzdDEudHlwZSA9PT0gImxpdGVyYWwiIHx8IGFzdDEudHlwZSA9PT0gInZhciIpIHsKICAgICAgICAgICAgICBzdGFjay5wdXNoKGFzdDEpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0bXBWYXIgPSBuZXcgQXN0VmFyaWFibGUobGFzdFJlZ2lzdGVyKyssIGFzdDEubWluLCBhc3QxLm1heCk7CiAgICAgICAgICAgIHN0YWNrW3N0YWNrLmxlbmd0aCAtIDFdID0gdG1wVmFyOwogICAgICAgICAgICBzdGFjay5wdXNoKHRtcFZhcik7CiAgICAgICAgICAgIGluc3RydWN0aW9ucy5wdXNoKG5ldyBBc3RWYXJpYWJsZURlZmluaXRpb24odG1wVmFyLCBhc3QxKSk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgInJvbGwiOgogICAgICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDwgMikgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBudW0yID0gc3RhY2sucG9wKCk7CiAgICAgICAgICAgIG51bTEgPSBzdGFjay5wb3AoKTsKCiAgICAgICAgICAgIGlmIChudW0yLnR5cGUgIT09ICJsaXRlcmFsIiB8fCBudW0xLnR5cGUgIT09ICJsaXRlcmFsIikgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBqID0gbnVtMi5udW1iZXI7CiAgICAgICAgICAgIG4gPSBudW0xLm51bWJlcjsKCiAgICAgICAgICAgIGlmIChuIDw9IDAgfHwgIU51bWJlci5pc0ludGVnZXIobikgfHwgIU51bWJlci5pc0ludGVnZXIoaikgfHwgc3RhY2subGVuZ3RoIDwgbikgewogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBqID0gKGogJSBuICsgbikgJSBuOwoKICAgICAgICAgICAgaWYgKGogPT09IDApIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoc3RhY2ssIHN0YWNrLnNwbGljZShzdGFjay5sZW5ndGggLSBuLCBuIC0gaikpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChzdGFjay5sZW5ndGggIT09IG91dHB1dFNpemUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICBpbnN0cnVjdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoaW5zdHJ1Y3Rpb24pIHsKICAgICAgICB2YXIgc3RhdGVtZW50QnVpbGRlciA9IG5ldyBFeHByZXNzaW9uQnVpbGRlclZpc2l0b3IoKTsKICAgICAgICBpbnN0cnVjdGlvbi52aXNpdChzdGF0ZW1lbnRCdWlsZGVyKTsKICAgICAgICByZXN1bHQucHVzaChzdGF0ZW1lbnRCdWlsZGVyLnRvU3RyaW5nKCkpOwogICAgICB9KTsKICAgICAgc3RhY2suZm9yRWFjaChmdW5jdGlvbiAoZXhwciwgaSkgewogICAgICAgIHZhciBzdGF0ZW1lbnRCdWlsZGVyID0gbmV3IEV4cHJlc3Npb25CdWlsZGVyVmlzaXRvcigpOwogICAgICAgIGV4cHIudmlzaXQoc3RhdGVtZW50QnVpbGRlcik7CiAgICAgICAgdmFyIG1pbiA9IHJhbmdlW2kgKiAyXSwKICAgICAgICAgICAgbWF4ID0gcmFuZ2VbaSAqIDIgKyAxXTsKICAgICAgICB2YXIgb3V0ID0gW3N0YXRlbWVudEJ1aWxkZXIudG9TdHJpbmcoKV07CgogICAgICAgIGlmIChtaW4gPiBleHByLm1pbikgewogICAgICAgICAgb3V0LnVuc2hpZnQoIk1hdGgubWF4KCIsIG1pbiwgIiwgIik7CiAgICAgICAgICBvdXQucHVzaCgiKSIpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG1heCA8IGV4cHIubWF4KSB7CiAgICAgICAgICBvdXQudW5zaGlmdCgiTWF0aC5taW4oIiwgbWF4LCAiLCAiKTsKICAgICAgICAgIG91dC5wdXNoKCIpIik7CiAgICAgICAgfQoKICAgICAgICBvdXQudW5zaGlmdCgiZGVzdFtkZXN0T2Zmc2V0ICsgIiwgaSwgIl0gPSAiKTsKICAgICAgICBvdXQucHVzaCgiOyIpOwogICAgICAgIHJlc3VsdC5wdXNoKG91dC5qb2luKCIiKSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzdWx0LmpvaW4oIlxuIik7CiAgICB9CiAgfTsKICByZXR1cm4gUG9zdFNjcmlwdENvbXBpbGVyOwp9KCk7CgpleHBvcnRzLlBvc3RTY3JpcHRDb21waWxlciA9IFBvc3RTY3JpcHRDb21waWxlcjsKCi8qKiovIH0pLAovKiAyMzUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5Qb3N0U2NyaXB0UGFyc2VyID0gZXhwb3J0cy5Qb3N0U2NyaXB0TGV4ZXIgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKdmFyIF9wcmltaXRpdmVzID0gX193X3BkZmpzX3JlcXVpcmVfXygxOTgpOwoKdmFyIF9jb3JlX3V0aWxzID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDEpOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCnZhciBQb3N0U2NyaXB0UGFyc2VyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBQb3N0U2NyaXB0UGFyc2VyKGxleGVyKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUG9zdFNjcmlwdFBhcnNlcik7CgogICAgdGhpcy5sZXhlciA9IGxleGVyOwogICAgdGhpcy5vcGVyYXRvcnMgPSBbXTsKICAgIHRoaXMudG9rZW4gPSBudWxsOwogICAgdGhpcy5wcmV2ID0gbnVsbDsKICB9CgogIF9jcmVhdGVDbGFzcyhQb3N0U2NyaXB0UGFyc2VyLCBbewogICAga2V5OiAibmV4dFRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBuZXh0VG9rZW4oKSB7CiAgICAgIHRoaXMucHJldiA9IHRoaXMudG9rZW47CiAgICAgIHRoaXMudG9rZW4gPSB0aGlzLmxleGVyLmdldFRva2VuKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWNjZXB0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhY2NlcHQodHlwZSkgewogICAgICBpZiAodGhpcy50b2tlbi50eXBlID09PSB0eXBlKSB7CiAgICAgICAgdGhpcy5uZXh0VG9rZW4oKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogImV4cGVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZXhwZWN0KHR5cGUpIHsKICAgICAgaWYgKHRoaXMuYWNjZXB0KHR5cGUpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5leHBlY3RlZCBzeW1ib2w6IGZvdW5kICIuY29uY2F0KHRoaXMudG9rZW4udHlwZSwgIiBleHBlY3RlZCAiKS5jb25jYXQodHlwZSwgIi4iKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicGFyc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlKCkgewogICAgICB0aGlzLm5leHRUb2tlbigpOwogICAgICB0aGlzLmV4cGVjdChQb3N0U2NyaXB0VG9rZW5UeXBlcy5MQlJBQ0UpOwogICAgICB0aGlzLnBhcnNlQmxvY2soKTsKICAgICAgdGhpcy5leHBlY3QoUG9zdFNjcmlwdFRva2VuVHlwZXMuUkJSQUNFKTsKICAgICAgcmV0dXJuIHRoaXMub3BlcmF0b3JzOwogICAgfQogIH0sIHsKICAgIGtleTogInBhcnNlQmxvY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlQmxvY2soKSB7CiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLk5VTUJFUikpIHsKICAgICAgICAgIHRoaXMub3BlcmF0b3JzLnB1c2godGhpcy5wcmV2LnZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLk9QRVJBVE9SKSkgewogICAgICAgICAgdGhpcy5vcGVyYXRvcnMucHVzaCh0aGlzLnByZXYudmFsdWUpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5hY2NlcHQoUG9zdFNjcmlwdFRva2VuVHlwZXMuTEJSQUNFKSkgewogICAgICAgICAgdGhpcy5wYXJzZUNvbmRpdGlvbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicGFyc2VDb25kaXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlQ29uZGl0aW9uKCkgewogICAgICB2YXIgY29uZGl0aW9uTG9jYXRpb24gPSB0aGlzLm9wZXJhdG9ycy5sZW5ndGg7CiAgICAgIHRoaXMub3BlcmF0b3JzLnB1c2gobnVsbCwgbnVsbCk7CiAgICAgIHRoaXMucGFyc2VCbG9jaygpOwogICAgICB0aGlzLmV4cGVjdChQb3N0U2NyaXB0VG9rZW5UeXBlcy5SQlJBQ0UpOwoKICAgICAgaWYgKHRoaXMuYWNjZXB0KFBvc3RTY3JpcHRUb2tlblR5cGVzLklGKSkgewogICAgICAgIHRoaXMub3BlcmF0b3JzW2NvbmRpdGlvbkxvY2F0aW9uXSA9IHRoaXMub3BlcmF0b3JzLmxlbmd0aDsKICAgICAgICB0aGlzLm9wZXJhdG9yc1tjb25kaXRpb25Mb2NhdGlvbiArIDFdID0gImp6IjsKICAgICAgfSBlbHNlIGlmICh0aGlzLmFjY2VwdChQb3N0U2NyaXB0VG9rZW5UeXBlcy5MQlJBQ0UpKSB7CiAgICAgICAgdmFyIGp1bXBMb2NhdGlvbiA9IHRoaXMub3BlcmF0b3JzLmxlbmd0aDsKICAgICAgICB0aGlzLm9wZXJhdG9ycy5wdXNoKG51bGwsIG51bGwpOwogICAgICAgIHZhciBlbmRPZlRydWUgPSB0aGlzLm9wZXJhdG9ycy5sZW5ndGg7CiAgICAgICAgdGhpcy5wYXJzZUJsb2NrKCk7CiAgICAgICAgdGhpcy5leHBlY3QoUG9zdFNjcmlwdFRva2VuVHlwZXMuUkJSQUNFKTsKICAgICAgICB0aGlzLmV4cGVjdChQb3N0U2NyaXB0VG9rZW5UeXBlcy5JRkVMU0UpOwogICAgICAgIHRoaXMub3BlcmF0b3JzW2p1bXBMb2NhdGlvbl0gPSB0aGlzLm9wZXJhdG9ycy5sZW5ndGg7CiAgICAgICAgdGhpcy5vcGVyYXRvcnNbanVtcExvY2F0aW9uICsgMV0gPSAiaiI7CiAgICAgICAgdGhpcy5vcGVyYXRvcnNbY29uZGl0aW9uTG9jYXRpb25dID0gZW5kT2ZUcnVlOwogICAgICAgIHRoaXMub3BlcmF0b3JzW2NvbmRpdGlvbkxvY2F0aW9uICsgMV0gPSAianoiOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiUFMgRnVuY3Rpb246IGVycm9yIHBhcnNpbmcgY29uZGl0aW9uYWwuIik7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBQb3N0U2NyaXB0UGFyc2VyOwp9KCk7CgpleHBvcnRzLlBvc3RTY3JpcHRQYXJzZXIgPSBQb3N0U2NyaXB0UGFyc2VyOwp2YXIgUG9zdFNjcmlwdFRva2VuVHlwZXMgPSB7CiAgTEJSQUNFOiAwLAogIFJCUkFDRTogMSwKICBOVU1CRVI6IDIsCiAgT1BFUkFUT1I6IDMsCiAgSUY6IDQsCiAgSUZFTFNFOiA1Cn07Cgp2YXIgUG9zdFNjcmlwdFRva2VuID0gZnVuY3Rpb24gUG9zdFNjcmlwdFRva2VuQ2xvc3VyZSgpIHsKICB2YXIgb3BDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7CgogIHZhciBQb3N0U2NyaXB0VG9rZW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gUG9zdFNjcmlwdFRva2VuKHR5cGUsIHZhbHVlKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQb3N0U2NyaXB0VG9rZW4pOwoKICAgICAgdGhpcy50eXBlID0gdHlwZTsKICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlOwogICAgfQoKICAgIF9jcmVhdGVDbGFzcyhQb3N0U2NyaXB0VG9rZW4sIG51bGwsIFt7CiAgICAgIGtleTogImdldE9wZXJhdG9yIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE9wZXJhdG9yKG9wKSB7CiAgICAgICAgdmFyIG9wVmFsdWUgPSBvcENhY2hlW29wXTsKCiAgICAgICAgaWYgKG9wVmFsdWUpIHsKICAgICAgICAgIHJldHVybiBvcFZhbHVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG9wQ2FjaGVbb3BdID0gbmV3IFBvc3RTY3JpcHRUb2tlbihQb3N0U2NyaXB0VG9rZW5UeXBlcy5PUEVSQVRPUiwgb3ApOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIkxCUkFDRSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiTEJSQUNFIiwgbmV3IFBvc3RTY3JpcHRUb2tlbihQb3N0U2NyaXB0VG9rZW5UeXBlcy5MQlJBQ0UsICJ7IikpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIlJCUkFDRSIsCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiAoMCwgX3V0aWwuc2hhZG93KSh0aGlzLCAiUkJSQUNFIiwgbmV3IFBvc3RTY3JpcHRUb2tlbihQb3N0U2NyaXB0VG9rZW5UeXBlcy5SQlJBQ0UsICJ9IikpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIklGIiwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuICgwLCBfdXRpbC5zaGFkb3cpKHRoaXMsICJJRiIsIG5ldyBQb3N0U2NyaXB0VG9rZW4oUG9zdFNjcmlwdFRva2VuVHlwZXMuSUYsICJJRiIpKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJJRkVMU0UiLAogICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgICByZXR1cm4gKDAsIF91dGlsLnNoYWRvdykodGhpcywgIklGRUxTRSIsIG5ldyBQb3N0U2NyaXB0VG9rZW4oUG9zdFNjcmlwdFRva2VuVHlwZXMuSUZFTFNFLCAiSUZFTFNFIikpOwogICAgICB9CiAgICB9XSk7CgogICAgcmV0dXJuIFBvc3RTY3JpcHRUb2tlbjsKICB9KCk7CgogIHJldHVybiBQb3N0U2NyaXB0VG9rZW47Cn0oKTsKCnZhciBQb3N0U2NyaXB0TGV4ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFBvc3RTY3JpcHRMZXhlcihzdHJlYW0pIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQb3N0U2NyaXB0TGV4ZXIpOwoKICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtOwogICAgdGhpcy5uZXh0Q2hhcigpOwogICAgdGhpcy5zdHJCdWYgPSBbXTsKICB9CgogIF9jcmVhdGVDbGFzcyhQb3N0U2NyaXB0TGV4ZXIsIFt7CiAgICBrZXk6ICJuZXh0Q2hhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbmV4dENoYXIoKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRDaGFyID0gdGhpcy5zdHJlYW0uZ2V0Qnl0ZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUb2tlbigpIHsKICAgICAgdmFyIGNvbW1lbnQgPSBmYWxzZTsKICAgICAgdmFyIGNoID0gdGhpcy5jdXJyZW50Q2hhcjsKCiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgaWYgKGNoIDwgMCkgewogICAgICAgICAgcmV0dXJuIF9wcmltaXRpdmVzLkVPRjsKICAgICAgICB9CgogICAgICAgIGlmIChjb21tZW50KSB7CiAgICAgICAgICBpZiAoY2ggPT09IDB4MGEgfHwgY2ggPT09IDB4MGQpIHsKICAgICAgICAgICAgY29tbWVudCA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoY2ggPT09IDB4MjUpIHsKICAgICAgICAgIGNvbW1lbnQgPSB0cnVlOwogICAgICAgIH0gZWxzZSBpZiAoISgwLCBfY29yZV91dGlscy5pc1doaXRlU3BhY2UpKGNoKSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjaCA9IHRoaXMubmV4dENoYXIoKTsKICAgICAgfQoKICAgICAgc3dpdGNoIChjaCB8IDApIHsKICAgICAgICBjYXNlIDB4MzA6CiAgICAgICAgY2FzZSAweDMxOgogICAgICAgIGNhc2UgMHgzMjoKICAgICAgICBjYXNlIDB4MzM6CiAgICAgICAgY2FzZSAweDM0OgogICAgICAgIGNhc2UgMHgzNToKICAgICAgICBjYXNlIDB4MzY6CiAgICAgICAgY2FzZSAweDM3OgogICAgICAgIGNhc2UgMHgzODoKICAgICAgICBjYXNlIDB4Mzk6CiAgICAgICAgY2FzZSAweDJiOgogICAgICAgIGNhc2UgMHgyZDoKICAgICAgICBjYXNlIDB4MmU6CiAgICAgICAgICByZXR1cm4gbmV3IFBvc3RTY3JpcHRUb2tlbihQb3N0U2NyaXB0VG9rZW5UeXBlcy5OVU1CRVIsIHRoaXMuZ2V0TnVtYmVyKCkpOwoKICAgICAgICBjYXNlIDB4N2I6CiAgICAgICAgICB0aGlzLm5leHRDaGFyKCk7CiAgICAgICAgICByZXR1cm4gUG9zdFNjcmlwdFRva2VuLkxCUkFDRTsKCiAgICAgICAgY2FzZSAweDdkOgogICAgICAgICAgdGhpcy5uZXh0Q2hhcigpOwogICAgICAgICAgcmV0dXJuIFBvc3RTY3JpcHRUb2tlbi5SQlJBQ0U7CiAgICAgIH0KCiAgICAgIHZhciBzdHJCdWYgPSB0aGlzLnN0ckJ1ZjsKICAgICAgc3RyQnVmLmxlbmd0aCA9IDA7CiAgICAgIHN0ckJ1ZlswXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpOwoKICAgICAgd2hpbGUgKChjaCA9IHRoaXMubmV4dENoYXIoKSkgPj0gMCAmJiAoY2ggPj0gMHg0MSAmJiBjaCA8PSAweDVhIHx8IGNoID49IDB4NjEgJiYgY2ggPD0gMHg3YSkpIHsKICAgICAgICBzdHJCdWYucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSk7CiAgICAgIH0KCiAgICAgIHZhciBzdHIgPSBzdHJCdWYuam9pbigiIik7CgogICAgICBzd2l0Y2ggKHN0ci50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgY2FzZSAiaWYiOgogICAgICAgICAgcmV0dXJuIFBvc3RTY3JpcHRUb2tlbi5JRjsKCiAgICAgICAgY2FzZSAiaWZlbHNlIjoKICAgICAgICAgIHJldHVybiBQb3N0U2NyaXB0VG9rZW4uSUZFTFNFOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIFBvc3RTY3JpcHRUb2tlbi5nZXRPcGVyYXRvcihzdHIpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TnVtYmVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROdW1iZXIoKSB7CiAgICAgIHZhciBjaCA9IHRoaXMuY3VycmVudENoYXI7CiAgICAgIHZhciBzdHJCdWYgPSB0aGlzLnN0ckJ1ZjsKICAgICAgc3RyQnVmLmxlbmd0aCA9IDA7CiAgICAgIHN0ckJ1ZlswXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpOwoKICAgICAgd2hpbGUgKChjaCA9IHRoaXMubmV4dENoYXIoKSkgPj0gMCkgewogICAgICAgIGlmIChjaCA+PSAweDMwICYmIGNoIDw9IDB4MzkgfHwgY2ggPT09IDB4MmQgfHwgY2ggPT09IDB4MmUpIHsKICAgICAgICAgIHN0ckJ1Zi5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0ckJ1Zi5qb2luKCIiKSk7CgogICAgICBpZiAoaXNOYU4odmFsdWUpKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJJbnZhbGlkIGZsb2F0aW5nIHBvaW50IG51bWJlcjogIi5jb25jYXQodmFsdWUpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFBvc3RTY3JpcHRMZXhlcjsKfSgpOwoKZXhwb3J0cy5Qb3N0U2NyaXB0TGV4ZXIgPSBQb3N0U2NyaXB0TGV4ZXI7CgovKioqLyB9KSwKLyogMjM2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd19wZGZqc19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuTXVybXVySGFzaDNfNjQgPSB2b2lkIDA7Cgp2YXIgX3V0aWwgPSBfX3dfcGRmanNfcmVxdWlyZV9fKDUpOwoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCnZhciBTRUVEID0gMHhjM2QyZTFmMDsKdmFyIE1BU0tfSElHSCA9IDB4ZmZmZjAwMDA7CnZhciBNQVNLX0xPVyA9IDB4ZmZmZjsKCnZhciBNdXJtdXJIYXNoM182NCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTXVybXVySGFzaDNfNjQoc2VlZCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE11cm11ckhhc2gzXzY0KTsKCiAgICB0aGlzLmgxID0gc2VlZCA/IHNlZWQgJiAweGZmZmZmZmZmIDogU0VFRDsKICAgIHRoaXMuaDIgPSBzZWVkID8gc2VlZCAmIDB4ZmZmZmZmZmYgOiBTRUVEOwogIH0KCiAgX2NyZWF0ZUNsYXNzKE11cm11ckhhc2gzXzY0LCBbewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoaW5wdXQpIHsKICAgICAgdmFyIGRhdGEsIGxlbmd0aDsKCiAgICAgIGlmICgoMCwgX3V0aWwuaXNTdHJpbmcpKGlucHV0KSkgewogICAgICAgIGRhdGEgPSBuZXcgVWludDhBcnJheShpbnB1dC5sZW5ndGggKiAyKTsKICAgICAgICBsZW5ndGggPSAwOwoKICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBpbnB1dC5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICB2YXIgY29kZSA9IGlucHV0LmNoYXJDb2RlQXQoaSk7CgogICAgICAgICAgaWYgKGNvZGUgPD0gMHhmZikgewogICAgICAgICAgICBkYXRhW2xlbmd0aCsrXSA9IGNvZGU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkYXRhW2xlbmd0aCsrXSA9IGNvZGUgPj4+IDg7CiAgICAgICAgICAgIGRhdGFbbGVuZ3RoKytdID0gY29kZSAmIDB4ZmY7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKCgwLCBfdXRpbC5pc0FycmF5QnVmZmVyKShpbnB1dCkpIHsKICAgICAgICBkYXRhID0gaW5wdXQ7CiAgICAgICAgbGVuZ3RoID0gZGF0YS5ieXRlTGVuZ3RoOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiV3JvbmcgZGF0YSBmb3JtYXQgaW4gTXVybXVySGFzaDNfNjRfdXBkYXRlLiAiICsgIklucHV0IG11c3QgYmUgYSBzdHJpbmcgb3IgYXJyYXkuIik7CiAgICAgIH0KCiAgICAgIHZhciBibG9ja0NvdW50cyA9IGxlbmd0aCA+PiAyOwogICAgICB2YXIgdGFpbExlbmd0aCA9IGxlbmd0aCAtIGJsb2NrQ291bnRzICogNDsKICAgICAgdmFyIGRhdGFVaW50MzIgPSBuZXcgVWludDMyQXJyYXkoZGF0YS5idWZmZXIsIDAsIGJsb2NrQ291bnRzKTsKICAgICAgdmFyIGsxID0gMCwKICAgICAgICAgIGsyID0gMDsKICAgICAgdmFyIGgxID0gdGhpcy5oMSwKICAgICAgICAgIGgyID0gdGhpcy5oMjsKICAgICAgdmFyIEMxID0gMHhjYzllMmQ1MSwKICAgICAgICAgIEMyID0gMHgxYjg3MzU5MzsKICAgICAgdmFyIEMxX0xPVyA9IEMxICYgTUFTS19MT1csCiAgICAgICAgICBDMl9MT1cgPSBDMiAmIE1BU0tfTE9XOwoKICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGJsb2NrQ291bnRzOyBfaSsrKSB7CiAgICAgICAgaWYgKF9pICYgMSkgewogICAgICAgICAgazEgPSBkYXRhVWludDMyW19pXTsKICAgICAgICAgIGsxID0gazEgKiBDMSAmIE1BU0tfSElHSCB8IGsxICogQzFfTE9XICYgTUFTS19MT1c7CiAgICAgICAgICBrMSA9IGsxIDw8IDE1IHwgazEgPj4+IDE3OwogICAgICAgICAgazEgPSBrMSAqIEMyICYgTUFTS19ISUdIIHwgazEgKiBDMl9MT1cgJiBNQVNLX0xPVzsKICAgICAgICAgIGgxIF49IGsxOwogICAgICAgICAgaDEgPSBoMSA8PCAxMyB8IGgxID4+PiAxOTsKICAgICAgICAgIGgxID0gaDEgKiA1ICsgMHhlNjU0NmI2NDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgazIgPSBkYXRhVWludDMyW19pXTsKICAgICAgICAgIGsyID0gazIgKiBDMSAmIE1BU0tfSElHSCB8IGsyICogQzFfTE9XICYgTUFTS19MT1c7CiAgICAgICAgICBrMiA9IGsyIDw8IDE1IHwgazIgPj4+IDE3OwogICAgICAgICAgazIgPSBrMiAqIEMyICYgTUFTS19ISUdIIHwgazIgKiBDMl9MT1cgJiBNQVNLX0xPVzsKICAgICAgICAgIGgyIF49IGsyOwogICAgICAgICAgaDIgPSBoMiA8PCAxMyB8IGgyID4+PiAxOTsKICAgICAgICAgIGgyID0gaDIgKiA1ICsgMHhlNjU0NmI2NDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGsxID0gMDsKCiAgICAgIHN3aXRjaCAodGFpbExlbmd0aCkgewogICAgICAgIGNhc2UgMzoKICAgICAgICAgIGsxIF49IGRhdGFbYmxvY2tDb3VudHMgKiA0ICsgMl0gPDwgMTY7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIGsxIF49IGRhdGFbYmxvY2tDb3VudHMgKiA0ICsgMV0gPDwgODsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgazEgXj0gZGF0YVtibG9ja0NvdW50cyAqIDRdOwogICAgICAgICAgazEgPSBrMSAqIEMxICYgTUFTS19ISUdIIHwgazEgKiBDMV9MT1cgJiBNQVNLX0xPVzsKICAgICAgICAgIGsxID0gazEgPDwgMTUgfCBrMSA+Pj4gMTc7CiAgICAgICAgICBrMSA9IGsxICogQzIgJiBNQVNLX0hJR0ggfCBrMSAqIEMyX0xPVyAmIE1BU0tfTE9XOwoKICAgICAgICAgIGlmIChibG9ja0NvdW50cyAmIDEpIHsKICAgICAgICAgICAgaDEgXj0gazE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBoMiBePSBrMTsKICAgICAgICAgIH0KCiAgICAgIH0KCiAgICAgIHRoaXMuaDEgPSBoMTsKICAgICAgdGhpcy5oMiA9IGgyOwogICAgfQogIH0sIHsKICAgIGtleTogImhleGRpZ2VzdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGV4ZGlnZXN0KCkgewogICAgICB2YXIgaDEgPSB0aGlzLmgxLAogICAgICAgICAgaDIgPSB0aGlzLmgyOwogICAgICBoMSBePSBoMiA+Pj4gMTsKICAgICAgaDEgPSBoMSAqIDB4ZWQ1NThjY2QgJiBNQVNLX0hJR0ggfCBoMSAqIDB4OGNjZCAmIE1BU0tfTE9XOwogICAgICBoMiA9IGgyICogMHhmZjUxYWZkNyAmIE1BU0tfSElHSCB8ICgoaDIgPDwgMTYgfCBoMSA+Pj4gMTYpICogMHhhZmQ3ZWQ1NSAmIE1BU0tfSElHSCkgPj4+IDE2OwogICAgICBoMSBePSBoMiA+Pj4gMTsKICAgICAgaDEgPSBoMSAqIDB4MWE4NWVjNTMgJiBNQVNLX0hJR0ggfCBoMSAqIDB4ZWM1MyAmIE1BU0tfTE9XOwogICAgICBoMiA9IGgyICogMHhjNGNlYjlmZSAmIE1BU0tfSElHSCB8ICgoaDIgPDwgMTYgfCBoMSA+Pj4gMTYpICogMHhiOWZlMWE4NSAmIE1BU0tfSElHSCkgPj4+IDE2OwogICAgICBoMSBePSBoMiA+Pj4gMTsKICAgICAgdmFyIGhleDEgPSAoaDEgPj4+IDApLnRvU3RyaW5nKDE2KSwKICAgICAgICAgIGhleDIgPSAoaDIgPj4+IDApLnRvU3RyaW5nKDE2KTsKICAgICAgcmV0dXJuIGhleDEucGFkU3RhcnQoOCwgIjAiKSArIGhleDIucGFkU3RhcnQoOCwgIjAiKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBNdXJtdXJIYXNoM182NDsKfSgpOwoKZXhwb3J0cy5NdXJtdXJIYXNoM182NCA9IE11cm11ckhhc2gzXzY0OwoKLyoqKi8gfSksCi8qIDIzNyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlBERkltYWdlID0gdm9pZCAwOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCnZhciBfcHJpbWl0aXZlcyA9IF9fd19wZGZqc19yZXF1aXJlX18oMTk4KTsKCnZhciBfY29sb3JzcGFjZSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjE2KTsKCnZhciBfc3RyZWFtID0gX193X3BkZmpzX3JlcXVpcmVfXygyMDUpOwoKdmFyIF9qcGVnX3N0cmVhbSA9IF9fd19wZGZqc19yZXF1aXJlX18oMjExKTsKCnZhciBfanB4ID0gX193X3BkZmpzX3JlcXVpcmVfXygyMTQpOwoKdmFyIFBERkltYWdlID0gZnVuY3Rpb24gUERGSW1hZ2VDbG9zdXJlKCkgewogIGZ1bmN0aW9uIGRlY29kZUFuZENsYW1wKHZhbHVlLCBhZGRlbmQsIGNvZWZmaWNpZW50LCBtYXgpIHsKICAgIHZhbHVlID0gYWRkZW5kICsgdmFsdWUgKiBjb2VmZmljaWVudDsKCiAgICBpZiAodmFsdWUgPCAwKSB7CiAgICAgIHZhbHVlID0gMDsKICAgIH0gZWxzZSBpZiAodmFsdWUgPiBtYXgpIHsKICAgICAgdmFsdWUgPSBtYXg7CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0KCiAgZnVuY3Rpb24gcmVzaXplSW1hZ2VNYXNrKHNyYywgYnBjLCB3MSwgaDEsIHcyLCBoMikgewogICAgdmFyIGxlbmd0aCA9IHcyICogaDI7CiAgICB2YXIgZGVzdDsKCiAgICBpZiAoYnBjIDw9IDgpIHsKICAgICAgZGVzdCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7CiAgICB9IGVsc2UgaWYgKGJwYyA8PSAxNikgewogICAgICBkZXN0ID0gbmV3IFVpbnQxNkFycmF5KGxlbmd0aCk7CiAgICB9IGVsc2UgewogICAgICBkZXN0ID0gbmV3IFVpbnQzMkFycmF5KGxlbmd0aCk7CiAgICB9CgogICAgdmFyIHhSYXRpbyA9IHcxIC8gdzI7CiAgICB2YXIgeVJhdGlvID0gaDEgLyBoMjsKICAgIHZhciBpLAogICAgICAgIGosCiAgICAgICAgcHksCiAgICAgICAgbmV3SW5kZXggPSAwLAogICAgICAgIG9sZEluZGV4OwogICAgdmFyIHhTY2FsZWQgPSBuZXcgVWludDE2QXJyYXkodzIpOwogICAgdmFyIHcxU2NhbmxpbmUgPSB3MTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgdzI7IGkrKykgewogICAgICB4U2NhbGVkW2ldID0gTWF0aC5mbG9vcihpICogeFJhdGlvKTsKICAgIH0KCiAgICBmb3IgKGkgPSAwOyBpIDwgaDI7IGkrKykgewogICAgICBweSA9IE1hdGguZmxvb3IoaSAqIHlSYXRpbykgKiB3MVNjYW5saW5lOwoKICAgICAgZm9yIChqID0gMDsgaiA8IHcyOyBqKyspIHsKICAgICAgICBvbGRJbmRleCA9IHB5ICsgeFNjYWxlZFtqXTsKICAgICAgICBkZXN0W25ld0luZGV4KytdID0gc3JjW29sZEluZGV4XTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBkZXN0OwogIH0KCiAgZnVuY3Rpb24gUERGSW1hZ2UoX3JlZikgewogICAgdmFyIHhyZWYgPSBfcmVmLnhyZWYsCiAgICAgICAgcmVzID0gX3JlZi5yZXMsCiAgICAgICAgaW1hZ2UgPSBfcmVmLmltYWdlLAogICAgICAgIF9yZWYkaXNJbmxpbmUgPSBfcmVmLmlzSW5saW5lLAogICAgICAgIGlzSW5saW5lID0gX3JlZiRpc0lubGluZSA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmJGlzSW5saW5lLAogICAgICAgIF9yZWYkc21hc2sgPSBfcmVmLnNtYXNrLAogICAgICAgIHNtYXNrID0gX3JlZiRzbWFzayA9PT0gdm9pZCAwID8gbnVsbCA6IF9yZWYkc21hc2ssCiAgICAgICAgX3JlZiRtYXNrID0gX3JlZi5tYXNrLAogICAgICAgIG1hc2sgPSBfcmVmJG1hc2sgPT09IHZvaWQgMCA/IG51bGwgOiBfcmVmJG1hc2ssCiAgICAgICAgX3JlZiRpc01hc2sgPSBfcmVmLmlzTWFzaywKICAgICAgICBpc01hc2sgPSBfcmVmJGlzTWFzayA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmJGlzTWFzaywKICAgICAgICBwZGZGdW5jdGlvbkZhY3RvcnkgPSBfcmVmLnBkZkZ1bmN0aW9uRmFjdG9yeTsKICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKICAgIHZhciBkaWN0ID0gaW1hZ2UuZGljdDsKICAgIHZhciBmaWx0ZXIgPSBkaWN0LmdldCgiRmlsdGVyIik7CgogICAgaWYgKCgwLCBfcHJpbWl0aXZlcy5pc05hbWUpKGZpbHRlcikpIHsKICAgICAgc3dpdGNoIChmaWx0ZXIubmFtZSkgewogICAgICAgIGNhc2UgIkpQWERlY29kZSI6CiAgICAgICAgICB2YXIganB4SW1hZ2UgPSBuZXcgX2pweC5KcHhJbWFnZSgpOwogICAgICAgICAganB4SW1hZ2UucGFyc2VJbWFnZVByb3BlcnRpZXMoaW1hZ2Uuc3RyZWFtKTsKICAgICAgICAgIGltYWdlLnN0cmVhbS5yZXNldCgpOwogICAgICAgICAgaW1hZ2Uud2lkdGggPSBqcHhJbWFnZS53aWR0aDsKICAgICAgICAgIGltYWdlLmhlaWdodCA9IGpweEltYWdlLmhlaWdodDsKICAgICAgICAgIGltYWdlLmJpdHNQZXJDb21wb25lbnQgPSBqcHhJbWFnZS5iaXRzUGVyQ29tcG9uZW50OwogICAgICAgICAgaW1hZ2UubnVtQ29tcHMgPSBqcHhJbWFnZS5jb21wb25lbnRzQ291bnQ7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAiSkJJRzJEZWNvZGUiOgogICAgICAgICAgaW1hZ2UuYml0c1BlckNvbXBvbmVudCA9IDE7CiAgICAgICAgICBpbWFnZS5udW1Db21wcyA9IDE7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHZhciB3aWR0aCA9IGRpY3QuZ2V0KCJXaWR0aCIsICJXIik7CiAgICB2YXIgaGVpZ2h0ID0gZGljdC5nZXQoIkhlaWdodCIsICJIIik7CgogICAgaWYgKE51bWJlci5pc0ludGVnZXIoaW1hZ2Uud2lkdGgpICYmIGltYWdlLndpZHRoID4gMCAmJiBOdW1iZXIuaXNJbnRlZ2VyKGltYWdlLmhlaWdodCkgJiYgaW1hZ2UuaGVpZ2h0ID4gMCAmJiAoaW1hZ2Uud2lkdGggIT09IHdpZHRoIHx8IGltYWdlLmhlaWdodCAhPT0gaGVpZ2h0KSkgewogICAgICAoMCwgX3V0aWwud2FybikoIlBERkltYWdlIC0gdXNpbmcgdGhlIFdpZHRoL0hlaWdodCBvZiB0aGUgaW1hZ2UgZGF0YSwgIiArICJyYXRoZXIgdGhhbiB0aGUgaW1hZ2UgZGljdGlvbmFyeS4iKTsKICAgICAgd2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgaGVpZ2h0ID0gaW1hZ2UuaGVpZ2h0OwogICAgfQoKICAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewogICAgICB0aHJvdyBuZXcgX3V0aWwuRm9ybWF0RXJyb3IoIkludmFsaWQgaW1hZ2Ugd2lkdGg6ICIuY29uY2F0KHdpZHRoLCAiIG9yIGhlaWdodDogIikuY29uY2F0KGhlaWdodCkpOwogICAgfQoKICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwogICAgdGhpcy5pbnRlcnBvbGF0ZSA9IGRpY3QuZ2V0KCJJbnRlcnBvbGF0ZSIsICJJIikgfHwgZmFsc2U7CiAgICB0aGlzLmltYWdlTWFzayA9IGRpY3QuZ2V0KCJJbWFnZU1hc2siLCAiSU0iKSB8fCBmYWxzZTsKICAgIHRoaXMubWF0dGUgPSBkaWN0LmdldCgiTWF0dGUiKSB8fCBmYWxzZTsKICAgIHZhciBiaXRzUGVyQ29tcG9uZW50ID0gaW1hZ2UuYml0c1BlckNvbXBvbmVudDsKCiAgICBpZiAoIWJpdHNQZXJDb21wb25lbnQpIHsKICAgICAgYml0c1BlckNvbXBvbmVudCA9IGRpY3QuZ2V0KCJCaXRzUGVyQ29tcG9uZW50IiwgIkJQQyIpOwoKICAgICAgaWYgKCFiaXRzUGVyQ29tcG9uZW50KSB7CiAgICAgICAgaWYgKHRoaXMuaW1hZ2VNYXNrKSB7CiAgICAgICAgICBiaXRzUGVyQ29tcG9uZW50ID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJCaXRzIHBlciBjb21wb25lbnQgbWlzc2luZyBpbiBpbWFnZTogIi5jb25jYXQodGhpcy5pbWFnZU1hc2spKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLmJwYyA9IGJpdHNQZXJDb21wb25lbnQ7CgogICAgaWYgKCF0aGlzLmltYWdlTWFzaykgewogICAgICB2YXIgY29sb3JTcGFjZSA9IGRpY3QuZ2V0KCJDb2xvclNwYWNlIiwgIkNTIik7CgogICAgICBpZiAoIWNvbG9yU3BhY2UpIHsKICAgICAgICAoMCwgX3V0aWwuaW5mbykoIkpQWCBpbWFnZXMgKHdoaWNoIGRvIG5vdCByZXF1aXJlIGNvbG9yIHNwYWNlcykiKTsKCiAgICAgICAgc3dpdGNoIChpbWFnZS5udW1Db21wcykgewogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjb2xvclNwYWNlID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkRldmljZUdyYXkiKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjb2xvclNwYWNlID0gX3ByaW1pdGl2ZXMuTmFtZS5nZXQoIkRldmljZVJHQiIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNvbG9yU3BhY2UgPSBfcHJpbWl0aXZlcy5OYW1lLmdldCgiRGV2aWNlQ01ZSyIpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkpQWCBpbWFnZXMgd2l0aCAiLmNvbmNhdChpbWFnZS5udW1Db21wcywgIiAiKSArICJjb2xvciBjb21wb25lbnRzIG5vdCBzdXBwb3J0ZWQuIik7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgcmVzb3VyY2VzID0gaXNJbmxpbmUgPyByZXMgOiBudWxsOwogICAgICB0aGlzLmNvbG9yU3BhY2UgPSBfY29sb3JzcGFjZS5Db2xvclNwYWNlLnBhcnNlKGNvbG9yU3BhY2UsIHhyZWYsIHJlc291cmNlcywgcGRmRnVuY3Rpb25GYWN0b3J5KTsKICAgICAgdGhpcy5udW1Db21wcyA9IHRoaXMuY29sb3JTcGFjZS5udW1Db21wczsKICAgIH0KCiAgICB0aGlzLmRlY29kZSA9IGRpY3QuZ2V0QXJyYXkoIkRlY29kZSIsICJEIik7CiAgICB0aGlzLm5lZWRzRGVjb2RlID0gZmFsc2U7CgogICAgaWYgKHRoaXMuZGVjb2RlICYmICh0aGlzLmNvbG9yU3BhY2UgJiYgIXRoaXMuY29sb3JTcGFjZS5pc0RlZmF1bHREZWNvZGUodGhpcy5kZWNvZGUsIGJpdHNQZXJDb21wb25lbnQpIHx8IGlzTWFzayAmJiAhX2NvbG9yc3BhY2UuQ29sb3JTcGFjZS5pc0RlZmF1bHREZWNvZGUodGhpcy5kZWNvZGUsIDEpKSkgewogICAgICB0aGlzLm5lZWRzRGVjb2RlID0gdHJ1ZTsKICAgICAgdmFyIG1heCA9ICgxIDw8IGJpdHNQZXJDb21wb25lbnQpIC0gMTsKICAgICAgdGhpcy5kZWNvZGVDb2VmZmljaWVudHMgPSBbXTsKICAgICAgdGhpcy5kZWNvZGVBZGRlbmRzID0gW107CiAgICAgIHZhciBpc0luZGV4ZWQgPSB0aGlzLmNvbG9yU3BhY2UgJiYgdGhpcy5jb2xvclNwYWNlLm5hbWUgPT09ICJJbmRleGVkIjsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBqID0gMDsgaSA8IHRoaXMuZGVjb2RlLmxlbmd0aDsgaSArPSAyLCArK2opIHsKICAgICAgICB2YXIgZG1pbiA9IHRoaXMuZGVjb2RlW2ldOwogICAgICAgIHZhciBkbWF4ID0gdGhpcy5kZWNvZGVbaSArIDFdOwogICAgICAgIHRoaXMuZGVjb2RlQ29lZmZpY2llbnRzW2pdID0gaXNJbmRleGVkID8gKGRtYXggLSBkbWluKSAvIG1heCA6IGRtYXggLSBkbWluOwogICAgICAgIHRoaXMuZGVjb2RlQWRkZW5kc1tqXSA9IGlzSW5kZXhlZCA/IGRtaW4gOiBtYXggKiBkbWluOwogICAgICB9CiAgICB9CgogICAgaWYgKHNtYXNrKSB7CiAgICAgIHRoaXMuc21hc2sgPSBuZXcgUERGSW1hZ2UoewogICAgICAgIHhyZWY6IHhyZWYsCiAgICAgICAgcmVzOiByZXMsCiAgICAgICAgaW1hZ2U6IHNtYXNrLAogICAgICAgIGlzSW5saW5lOiBpc0lubGluZSwKICAgICAgICBwZGZGdW5jdGlvbkZhY3Rvcnk6IHBkZkZ1bmN0aW9uRmFjdG9yeQogICAgICB9KTsKICAgIH0gZWxzZSBpZiAobWFzaykgewogICAgICBpZiAoKDAsIF9wcmltaXRpdmVzLmlzU3RyZWFtKShtYXNrKSkgewogICAgICAgIHZhciBtYXNrRGljdCA9IG1hc2suZGljdCwKICAgICAgICAgICAgaW1hZ2VNYXNrID0gbWFza0RpY3QuZ2V0KCJJbWFnZU1hc2siLCAiSU0iKTsKCiAgICAgICAgaWYgKCFpbWFnZU1hc2spIHsKICAgICAgICAgICgwLCBfdXRpbC53YXJuKSgiSWdub3JpbmcgL01hc2sgaW4gaW1hZ2Ugd2l0aG91dCAvSW1hZ2VNYXNrLiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm1hc2sgPSBuZXcgUERGSW1hZ2UoewogICAgICAgICAgICB4cmVmOiB4cmVmLAogICAgICAgICAgICByZXM6IHJlcywKICAgICAgICAgICAgaW1hZ2U6IG1hc2ssCiAgICAgICAgICAgIGlzSW5saW5lOiBpc0lubGluZSwKICAgICAgICAgICAgaXNNYXNrOiB0cnVlLAogICAgICAgICAgICBwZGZGdW5jdGlvbkZhY3Rvcnk6IHBkZkZ1bmN0aW9uRmFjdG9yeQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubWFzayA9IG1hc2s7CiAgICAgIH0KICAgIH0KICB9CgogIFBERkltYWdlLmJ1aWxkSW1hZ2UgPSBmdW5jdGlvbiAoX3JlZjIpIHsKICAgIHZhciB4cmVmID0gX3JlZjIueHJlZiwKICAgICAgICByZXMgPSBfcmVmMi5yZXMsCiAgICAgICAgaW1hZ2UgPSBfcmVmMi5pbWFnZSwKICAgICAgICBfcmVmMiRpc0lubGluZSA9IF9yZWYyLmlzSW5saW5lLAogICAgICAgIGlzSW5saW5lID0gX3JlZjIkaXNJbmxpbmUgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjIkaXNJbmxpbmUsCiAgICAgICAgcGRmRnVuY3Rpb25GYWN0b3J5ID0gX3JlZjIucGRmRnVuY3Rpb25GYWN0b3J5OwogICAgdmFyIGltYWdlRGF0YSA9IGltYWdlOwogICAgdmFyIHNtYXNrRGF0YSA9IG51bGw7CiAgICB2YXIgbWFza0RhdGEgPSBudWxsOwogICAgdmFyIHNtYXNrID0gaW1hZ2UuZGljdC5nZXQoIlNNYXNrIik7CiAgICB2YXIgbWFzayA9IGltYWdlLmRpY3QuZ2V0KCJNYXNrIik7CgogICAgaWYgKHNtYXNrKSB7CiAgICAgIHNtYXNrRGF0YSA9IHNtYXNrOwogICAgfSBlbHNlIGlmIChtYXNrKSB7CiAgICAgIGlmICgoMCwgX3ByaW1pdGl2ZXMuaXNTdHJlYW0pKG1hc2spIHx8IEFycmF5LmlzQXJyYXkobWFzaykpIHsKICAgICAgICBtYXNrRGF0YSA9IG1hc2s7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgKDAsIF91dGlsLndhcm4pKCJVbnN1cHBvcnRlZCBtYXNrIGZvcm1hdC4iKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IFBERkltYWdlKHsKICAgICAgeHJlZjogeHJlZiwKICAgICAgcmVzOiByZXMsCiAgICAgIGltYWdlOiBpbWFnZURhdGEsCiAgICAgIGlzSW5saW5lOiBpc0lubGluZSwKICAgICAgc21hc2s6IHNtYXNrRGF0YSwKICAgICAgbWFzazogbWFza0RhdGEsCiAgICAgIHBkZkZ1bmN0aW9uRmFjdG9yeTogcGRmRnVuY3Rpb25GYWN0b3J5CiAgICB9KSk7CiAgfTsKCiAgUERGSW1hZ2UuY3JlYXRlTWFzayA9IGZ1bmN0aW9uIChfcmVmMykgewogICAgdmFyIGltZ0FycmF5ID0gX3JlZjMuaW1nQXJyYXksCiAgICAgICAgd2lkdGggPSBfcmVmMy53aWR0aCwKICAgICAgICBoZWlnaHQgPSBfcmVmMy5oZWlnaHQsCiAgICAgICAgaW1hZ2VJc0Zyb21EZWNvZGVTdHJlYW0gPSBfcmVmMy5pbWFnZUlzRnJvbURlY29kZVN0cmVhbSwKICAgICAgICBpbnZlcnNlRGVjb2RlID0gX3JlZjMuaW52ZXJzZURlY29kZTsKICAgIHZhciBjb21wdXRlZExlbmd0aCA9ICh3aWR0aCArIDcgPj4gMykgKiBoZWlnaHQ7CiAgICB2YXIgYWN0dWFsTGVuZ3RoID0gaW1nQXJyYXkuYnl0ZUxlbmd0aDsKICAgIHZhciBoYXZlRnVsbERhdGEgPSBjb21wdXRlZExlbmd0aCA9PT0gYWN0dWFsTGVuZ3RoOwogICAgdmFyIGRhdGEsIGk7CgogICAgaWYgKGltYWdlSXNGcm9tRGVjb2RlU3RyZWFtICYmICghaW52ZXJzZURlY29kZSB8fCBoYXZlRnVsbERhdGEpKSB7CiAgICAgIGRhdGEgPSBpbWdBcnJheTsKICAgIH0gZWxzZSBpZiAoIWludmVyc2VEZWNvZGUpIHsKICAgICAgZGF0YSA9IG5ldyBVaW50OENsYW1wZWRBcnJheShhY3R1YWxMZW5ndGgpOwogICAgICBkYXRhLnNldChpbWdBcnJheSk7CiAgICB9IGVsc2UgewogICAgICBkYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGNvbXB1dGVkTGVuZ3RoKTsKICAgICAgZGF0YS5zZXQoaW1nQXJyYXkpOwoKICAgICAgZm9yIChpID0gYWN0dWFsTGVuZ3RoOyBpIDwgY29tcHV0ZWRMZW5ndGg7IGkrKykgewogICAgICAgIGRhdGFbaV0gPSAweGZmOwogICAgICB9CiAgICB9CgogICAgaWYgKGludmVyc2VEZWNvZGUpIHsKICAgICAgZm9yIChpID0gMDsgaSA8IGFjdHVhbExlbmd0aDsgaSsrKSB7CiAgICAgICAgZGF0YVtpXSBePSAweGZmOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgZGF0YTogZGF0YSwKICAgICAgd2lkdGg6IHdpZHRoLAogICAgICBoZWlnaHQ6IGhlaWdodAogICAgfTsKICB9OwoKICBQREZJbWFnZS5wcm90b3R5cGUgPSB7CiAgICBnZXQgZHJhd1dpZHRoKCkgewogICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy53aWR0aCwgdGhpcy5zbWFzayAmJiB0aGlzLnNtYXNrLndpZHRoIHx8IDAsIHRoaXMubWFzayAmJiB0aGlzLm1hc2sud2lkdGggfHwgMCk7CiAgICB9LAoKICAgIGdldCBkcmF3SGVpZ2h0KCkgewogICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5oZWlnaHQsIHRoaXMuc21hc2sgJiYgdGhpcy5zbWFzay5oZWlnaHQgfHwgMCwgdGhpcy5tYXNrICYmIHRoaXMubWFzay5oZWlnaHQgfHwgMCk7CiAgICB9LAoKICAgIGRlY29kZUJ1ZmZlcjogZnVuY3Rpb24gZGVjb2RlQnVmZmVyKGJ1ZmZlcikgewogICAgICB2YXIgYnBjID0gdGhpcy5icGM7CiAgICAgIHZhciBudW1Db21wcyA9IHRoaXMubnVtQ29tcHM7CiAgICAgIHZhciBkZWNvZGVBZGRlbmRzID0gdGhpcy5kZWNvZGVBZGRlbmRzOwogICAgICB2YXIgZGVjb2RlQ29lZmZpY2llbnRzID0gdGhpcy5kZWNvZGVDb2VmZmljaWVudHM7CiAgICAgIHZhciBtYXggPSAoMSA8PCBicGMpIC0gMTsKICAgICAgdmFyIGksIGlpOwoKICAgICAgaWYgKGJwYyA9PT0gMSkgewogICAgICAgIGZvciAoaSA9IDAsIGlpID0gYnVmZmVyLmxlbmd0aDsgaSA8IGlpOyBpKyspIHsKICAgICAgICAgIGJ1ZmZlcltpXSA9ICshYnVmZmVyW2ldOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgaW5kZXggPSAwOwoKICAgICAgZm9yIChpID0gMCwgaWkgPSB0aGlzLndpZHRoICogdGhpcy5oZWlnaHQ7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1Db21wczsgaisrKSB7CiAgICAgICAgICBidWZmZXJbaW5kZXhdID0gZGVjb2RlQW5kQ2xhbXAoYnVmZmVyW2luZGV4XSwgZGVjb2RlQWRkZW5kc1tqXSwgZGVjb2RlQ29lZmZpY2llbnRzW2pdLCBtYXgpOwogICAgICAgICAgaW5kZXgrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBnZXRDb21wb25lbnRzOiBmdW5jdGlvbiBnZXRDb21wb25lbnRzKGJ1ZmZlcikgewogICAgICB2YXIgYnBjID0gdGhpcy5icGM7CgogICAgICBpZiAoYnBjID09PSA4KSB7CiAgICAgICAgcmV0dXJuIGJ1ZmZlcjsKICAgICAgfQoKICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwogICAgICB2YXIgbnVtQ29tcHMgPSB0aGlzLm51bUNvbXBzOwogICAgICB2YXIgbGVuZ3RoID0gd2lkdGggKiBoZWlnaHQgKiBudW1Db21wczsKICAgICAgdmFyIGJ1ZmZlclBvcyA9IDA7CiAgICAgIHZhciBvdXRwdXQ7CgogICAgICBpZiAoYnBjIDw9IDgpIHsKICAgICAgICBvdXRwdXQgPSBuZXcgVWludDhBcnJheShsZW5ndGgpOwogICAgICB9IGVsc2UgaWYgKGJwYyA8PSAxNikgewogICAgICAgIG91dHB1dCA9IG5ldyBVaW50MTZBcnJheShsZW5ndGgpOwogICAgICB9IGVsc2UgewogICAgICAgIG91dHB1dCA9IG5ldyBVaW50MzJBcnJheShsZW5ndGgpOwogICAgICB9CgogICAgICB2YXIgcm93Q29tcHMgPSB3aWR0aCAqIG51bUNvbXBzOwogICAgICB2YXIgbWF4ID0gKDEgPDwgYnBjKSAtIDE7CiAgICAgIHZhciBpID0gMCwKICAgICAgICAgIGlpLAogICAgICAgICAgYnVmOwoKICAgICAgaWYgKGJwYyA9PT0gMSkgewogICAgICAgIHZhciBtYXNrLCBsb29wMUVuZCwgbG9vcDJFbmQ7CgogICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaGVpZ2h0OyBqKyspIHsKICAgICAgICAgIGxvb3AxRW5kID0gaSArIChyb3dDb21wcyAmIH43KTsKICAgICAgICAgIGxvb3AyRW5kID0gaSArIHJvd0NvbXBzOwoKICAgICAgICAgIHdoaWxlIChpIDwgbG9vcDFFbmQpIHsKICAgICAgICAgICAgYnVmID0gYnVmZmVyW2J1ZmZlclBvcysrXTsKICAgICAgICAgICAgb3V0cHV0W2ldID0gYnVmID4+IDcgJiAxOwogICAgICAgICAgICBvdXRwdXRbaSArIDFdID0gYnVmID4+IDYgJiAxOwogICAgICAgICAgICBvdXRwdXRbaSArIDJdID0gYnVmID4+IDUgJiAxOwogICAgICAgICAgICBvdXRwdXRbaSArIDNdID0gYnVmID4+IDQgJiAxOwogICAgICAgICAgICBvdXRwdXRbaSArIDRdID0gYnVmID4+IDMgJiAxOwogICAgICAgICAgICBvdXRwdXRbaSArIDVdID0gYnVmID4+IDIgJiAxOwogICAgICAgICAgICBvdXRwdXRbaSArIDZdID0gYnVmID4+IDEgJiAxOwogICAgICAgICAgICBvdXRwdXRbaSArIDddID0gYnVmICYgMTsKICAgICAgICAgICAgaSArPSA4OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChpIDwgbG9vcDJFbmQpIHsKICAgICAgICAgICAgYnVmID0gYnVmZmVyW2J1ZmZlclBvcysrXTsKICAgICAgICAgICAgbWFzayA9IDEyODsKCiAgICAgICAgICAgIHdoaWxlIChpIDwgbG9vcDJFbmQpIHsKICAgICAgICAgICAgICBvdXRwdXRbaSsrXSA9ICshIShidWYgJiBtYXNrKTsKICAgICAgICAgICAgICBtYXNrID4+PSAxOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBiaXRzID0gMDsKICAgICAgICBidWYgPSAwOwoKICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IGxlbmd0aDsgaSA8IGlpOyArK2kpIHsKICAgICAgICAgIGlmIChpICUgcm93Q29tcHMgPT09IDApIHsKICAgICAgICAgICAgYnVmID0gMDsKICAgICAgICAgICAgYml0cyA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgd2hpbGUgKGJpdHMgPCBicGMpIHsKICAgICAgICAgICAgYnVmID0gYnVmIDw8IDggfCBidWZmZXJbYnVmZmVyUG9zKytdOwogICAgICAgICAgICBiaXRzICs9IDg7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHJlbWFpbmluZ0JpdHMgPSBiaXRzIC0gYnBjOwogICAgICAgICAgdmFyIHZhbHVlID0gYnVmID4+IHJlbWFpbmluZ0JpdHM7CgogICAgICAgICAgaWYgKHZhbHVlIDwgMCkgewogICAgICAgICAgICB2YWx1ZSA9IDA7CiAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gbWF4KSB7CiAgICAgICAgICAgIHZhbHVlID0gbWF4OwogICAgICAgICAgfQoKICAgICAgICAgIG91dHB1dFtpXSA9IHZhbHVlOwogICAgICAgICAgYnVmID0gYnVmICYgKDEgPDwgcmVtYWluaW5nQml0cykgLSAxOwogICAgICAgICAgYml0cyA9IHJlbWFpbmluZ0JpdHM7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gb3V0cHV0OwogICAgfSwKICAgIGZpbGxPcGFjaXR5OiBmdW5jdGlvbiBmaWxsT3BhY2l0eShyZ2JhQnVmLCB3aWR0aCwgaGVpZ2h0LCBhY3R1YWxIZWlnaHQsIGltYWdlKSB7CiAgICAgIHZhciBzbWFzayA9IHRoaXMuc21hc2s7CiAgICAgIHZhciBtYXNrID0gdGhpcy5tYXNrOwogICAgICB2YXIgYWxwaGFCdWYsIHN3LCBzaCwgaSwgaWksIGo7CgogICAgICBpZiAoc21hc2spIHsKICAgICAgICBzdyA9IHNtYXNrLndpZHRoOwogICAgICAgIHNoID0gc21hc2suaGVpZ2h0OwogICAgICAgIGFscGhhQnVmID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHN3ICogc2gpOwogICAgICAgIHNtYXNrLmZpbGxHcmF5QnVmZmVyKGFscGhhQnVmKTsKCiAgICAgICAgaWYgKHN3ICE9PSB3aWR0aCB8fCBzaCAhPT0gaGVpZ2h0KSB7CiAgICAgICAgICBhbHBoYUJ1ZiA9IHJlc2l6ZUltYWdlTWFzayhhbHBoYUJ1Ziwgc21hc2suYnBjLCBzdywgc2gsIHdpZHRoLCBoZWlnaHQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChtYXNrKSB7CiAgICAgICAgaWYgKG1hc2sgaW5zdGFuY2VvZiBQREZJbWFnZSkgewogICAgICAgICAgc3cgPSBtYXNrLndpZHRoOwogICAgICAgICAgc2ggPSBtYXNrLmhlaWdodDsKICAgICAgICAgIGFscGhhQnVmID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHN3ICogc2gpOwogICAgICAgICAgbWFzay5udW1Db21wcyA9IDE7CiAgICAgICAgICBtYXNrLmZpbGxHcmF5QnVmZmVyKGFscGhhQnVmKTsKCiAgICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHN3ICogc2g7IGkgPCBpaTsgKytpKSB7CiAgICAgICAgICAgIGFscGhhQnVmW2ldID0gMjU1IC0gYWxwaGFCdWZbaV07CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHN3ICE9PSB3aWR0aCB8fCBzaCAhPT0gaGVpZ2h0KSB7CiAgICAgICAgICAgIGFscGhhQnVmID0gcmVzaXplSW1hZ2VNYXNrKGFscGhhQnVmLCBtYXNrLmJwYywgc3csIHNoLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkobWFzaykpIHsKICAgICAgICAgIGFscGhhQnVmID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHdpZHRoICogaGVpZ2h0KTsKICAgICAgICAgIHZhciBudW1Db21wcyA9IHRoaXMubnVtQ29tcHM7CgogICAgICAgICAgZm9yIChpID0gMCwgaWkgPSB3aWR0aCAqIGhlaWdodDsgaSA8IGlpOyArK2kpIHsKICAgICAgICAgICAgdmFyIG9wYWNpdHkgPSAwOwogICAgICAgICAgICB2YXIgaW1hZ2VPZmZzZXQgPSBpICogbnVtQ29tcHM7CgogICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbnVtQ29tcHM7ICsraikgewogICAgICAgICAgICAgIHZhciBjb2xvciA9IGltYWdlW2ltYWdlT2Zmc2V0ICsgal07CiAgICAgICAgICAgICAgdmFyIG1hc2tPZmZzZXQgPSBqICogMjsKCiAgICAgICAgICAgICAgaWYgKGNvbG9yIDwgbWFza1ttYXNrT2Zmc2V0XSB8fCBjb2xvciA+IG1hc2tbbWFza09mZnNldCArIDFdKSB7CiAgICAgICAgICAgICAgICBvcGFjaXR5ID0gMjU1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBhbHBoYUJ1ZltpXSA9IG9wYWNpdHk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBfdXRpbC5Gb3JtYXRFcnJvcigiVW5rbm93biBtYXNrIGZvcm1hdC4iKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChhbHBoYUJ1ZikgewogICAgICAgIGZvciAoaSA9IDAsIGogPSAzLCBpaSA9IHdpZHRoICogYWN0dWFsSGVpZ2h0OyBpIDwgaWk7ICsraSwgaiArPSA0KSB7CiAgICAgICAgICByZ2JhQnVmW2pdID0gYWxwaGFCdWZbaV07CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAoaSA9IDAsIGogPSAzLCBpaSA9IHdpZHRoICogYWN0dWFsSGVpZ2h0OyBpIDwgaWk7ICsraSwgaiArPSA0KSB7CiAgICAgICAgICByZ2JhQnVmW2pdID0gMjU1OwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHVuZG9QcmVibGVuZDogZnVuY3Rpb24gdW5kb1ByZWJsZW5kKGJ1ZmZlciwgd2lkdGgsIGhlaWdodCkgewogICAgICB2YXIgbWF0dGUgPSB0aGlzLnNtYXNrICYmIHRoaXMuc21hc2subWF0dGU7CgogICAgICBpZiAoIW1hdHRlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgbWF0dGVSZ2IgPSB0aGlzLmNvbG9yU3BhY2UuZ2V0UmdiKG1hdHRlLCAwKTsKICAgICAgdmFyIG1hdHRlUiA9IG1hdHRlUmdiWzBdOwogICAgICB2YXIgbWF0dGVHID0gbWF0dGVSZ2JbMV07CiAgICAgIHZhciBtYXR0ZUIgPSBtYXR0ZVJnYlsyXTsKICAgICAgdmFyIGxlbmd0aCA9IHdpZHRoICogaGVpZ2h0ICogNDsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDQpIHsKICAgICAgICB2YXIgYWxwaGEgPSBidWZmZXJbaSArIDNdOwoKICAgICAgICBpZiAoYWxwaGEgPT09IDApIHsKICAgICAgICAgIGJ1ZmZlcltpXSA9IDI1NTsKICAgICAgICAgIGJ1ZmZlcltpICsgMV0gPSAyNTU7CiAgICAgICAgICBidWZmZXJbaSArIDJdID0gMjU1OwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgayA9IDI1NSAvIGFscGhhOwogICAgICAgIGJ1ZmZlcltpXSA9IChidWZmZXJbaV0gLSBtYXR0ZVIpICogayArIG1hdHRlUjsKICAgICAgICBidWZmZXJbaSArIDFdID0gKGJ1ZmZlcltpICsgMV0gLSBtYXR0ZUcpICogayArIG1hdHRlRzsKICAgICAgICBidWZmZXJbaSArIDJdID0gKGJ1ZmZlcltpICsgMl0gLSBtYXR0ZUIpICogayArIG1hdHRlQjsKICAgICAgfQogICAgfSwKICAgIGNyZWF0ZUltYWdlRGF0YTogZnVuY3Rpb24gY3JlYXRlSW1hZ2VEYXRhKCkgewogICAgICB2YXIgZm9yY2VSR0JBID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgICAgdmFyIGRyYXdXaWR0aCA9IHRoaXMuZHJhd1dpZHRoOwogICAgICB2YXIgZHJhd0hlaWdodCA9IHRoaXMuZHJhd0hlaWdodDsKICAgICAgdmFyIGltZ0RhdGEgPSB7CiAgICAgICAgd2lkdGg6IGRyYXdXaWR0aCwKICAgICAgICBoZWlnaHQ6IGRyYXdIZWlnaHQsCiAgICAgICAga2luZDogMCwKICAgICAgICBkYXRhOiBudWxsCiAgICAgIH07CiAgICAgIHZhciBudW1Db21wcyA9IHRoaXMubnVtQ29tcHM7CiAgICAgIHZhciBvcmlnaW5hbFdpZHRoID0gdGhpcy53aWR0aDsKICAgICAgdmFyIG9yaWdpbmFsSGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICAgIHZhciBicGMgPSB0aGlzLmJwYzsKICAgICAgdmFyIHJvd0J5dGVzID0gb3JpZ2luYWxXaWR0aCAqIG51bUNvbXBzICogYnBjICsgNyA+PiAzOwogICAgICB2YXIgaW1nQXJyYXk7CgogICAgICBpZiAoIWZvcmNlUkdCQSkgewogICAgICAgIHZhciBraW5kOwoKICAgICAgICBpZiAodGhpcy5jb2xvclNwYWNlLm5hbWUgPT09ICJEZXZpY2VHcmF5IiAmJiBicGMgPT09IDEpIHsKICAgICAgICAgIGtpbmQgPSBfdXRpbC5JbWFnZUtpbmQuR1JBWVNDQUxFXzFCUFA7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbG9yU3BhY2UubmFtZSA9PT0gIkRldmljZVJHQiIgJiYgYnBjID09PSA4ICYmICF0aGlzLm5lZWRzRGVjb2RlKSB7CiAgICAgICAgICBraW5kID0gX3V0aWwuSW1hZ2VLaW5kLlJHQl8yNEJQUDsKICAgICAgICB9CgogICAgICAgIGlmIChraW5kICYmICF0aGlzLnNtYXNrICYmICF0aGlzLm1hc2sgJiYgZHJhd1dpZHRoID09PSBvcmlnaW5hbFdpZHRoICYmIGRyYXdIZWlnaHQgPT09IG9yaWdpbmFsSGVpZ2h0KSB7CiAgICAgICAgICBpbWdEYXRhLmtpbmQgPSBraW5kOwogICAgICAgICAgaW1nQXJyYXkgPSB0aGlzLmdldEltYWdlQnl0ZXMob3JpZ2luYWxIZWlnaHQgKiByb3dCeXRlcyk7CgogICAgICAgICAgaWYgKHRoaXMuaW1hZ2UgaW5zdGFuY2VvZiBfc3RyZWFtLkRlY29kZVN0cmVhbSkgewogICAgICAgICAgICBpbWdEYXRhLmRhdGEgPSBpbWdBcnJheTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciBuZXdBcnJheSA9IG5ldyBVaW50OENsYW1wZWRBcnJheShpbWdBcnJheS5sZW5ndGgpOwogICAgICAgICAgICBuZXdBcnJheS5zZXQoaW1nQXJyYXkpOwogICAgICAgICAgICBpbWdEYXRhLmRhdGEgPSBuZXdBcnJheTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5uZWVkc0RlY29kZSkgewogICAgICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShraW5kID09PSBfdXRpbC5JbWFnZUtpbmQuR1JBWVNDQUxFXzFCUFAsICJQREZJbWFnZS5jcmVhdGVJbWFnZURhdGE6IFRoZSBpbWFnZSBtdXN0IGJlIGdyYXlzY2FsZS4iKTsKICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IGltZ0RhdGEuZGF0YTsKCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IGJ1ZmZlci5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7CiAgICAgICAgICAgICAgYnVmZmVyW2ldIF49IDB4ZmY7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gaW1nRGF0YTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmltYWdlIGluc3RhbmNlb2YgX2pwZWdfc3RyZWFtLkpwZWdTdHJlYW0gJiYgIXRoaXMuc21hc2sgJiYgIXRoaXMubWFzaykgewogICAgICAgICAgdmFyIGltYWdlTGVuZ3RoID0gb3JpZ2luYWxIZWlnaHQgKiByb3dCeXRlczsKCiAgICAgICAgICBzd2l0Y2ggKHRoaXMuY29sb3JTcGFjZS5uYW1lKSB7CiAgICAgICAgICAgIGNhc2UgIkRldmljZUdyYXkiOgogICAgICAgICAgICAgIGltYWdlTGVuZ3RoICo9IDM7CgogICAgICAgICAgICBjYXNlICJEZXZpY2VSR0IiOgogICAgICAgICAgICBjYXNlICJEZXZpY2VDTVlLIjoKICAgICAgICAgICAgICBpbWdEYXRhLmtpbmQgPSBfdXRpbC5JbWFnZUtpbmQuUkdCXzI0QlBQOwogICAgICAgICAgICAgIGltZ0RhdGEuZGF0YSA9IHRoaXMuZ2V0SW1hZ2VCeXRlcyhpbWFnZUxlbmd0aCwgZHJhd1dpZHRoLCBkcmF3SGVpZ2h0LCB0cnVlKTsKICAgICAgICAgICAgICByZXR1cm4gaW1nRGF0YTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGltZ0FycmF5ID0gdGhpcy5nZXRJbWFnZUJ5dGVzKG9yaWdpbmFsSGVpZ2h0ICogcm93Qnl0ZXMpOwogICAgICB2YXIgYWN0dWFsSGVpZ2h0ID0gMCB8IGltZ0FycmF5Lmxlbmd0aCAvIHJvd0J5dGVzICogZHJhd0hlaWdodCAvIG9yaWdpbmFsSGVpZ2h0OwogICAgICB2YXIgY29tcHMgPSB0aGlzLmdldENvbXBvbmVudHMoaW1nQXJyYXkpOwogICAgICB2YXIgYWxwaGEwMSwgbWF5YmVVbmRvUHJlYmxlbmQ7CgogICAgICBpZiAoIWZvcmNlUkdCQSAmJiAhdGhpcy5zbWFzayAmJiAhdGhpcy5tYXNrKSB7CiAgICAgICAgaW1nRGF0YS5raW5kID0gX3V0aWwuSW1hZ2VLaW5kLlJHQl8yNEJQUDsKICAgICAgICBpbWdEYXRhLmRhdGEgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoZHJhd1dpZHRoICogZHJhd0hlaWdodCAqIDMpOwogICAgICAgIGFscGhhMDEgPSAwOwogICAgICAgIG1heWJlVW5kb1ByZWJsZW5kID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaW1nRGF0YS5raW5kID0gX3V0aWwuSW1hZ2VLaW5kLlJHQkFfMzJCUFA7CiAgICAgICAgaW1nRGF0YS5kYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGRyYXdXaWR0aCAqIGRyYXdIZWlnaHQgKiA0KTsKICAgICAgICBhbHBoYTAxID0gMTsKICAgICAgICBtYXliZVVuZG9QcmVibGVuZCA9IHRydWU7CiAgICAgICAgdGhpcy5maWxsT3BhY2l0eShpbWdEYXRhLmRhdGEsIGRyYXdXaWR0aCwgZHJhd0hlaWdodCwgYWN0dWFsSGVpZ2h0LCBjb21wcyk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm5lZWRzRGVjb2RlKSB7CiAgICAgICAgdGhpcy5kZWNvZGVCdWZmZXIoY29tcHMpOwogICAgICB9CgogICAgICB0aGlzLmNvbG9yU3BhY2UuZmlsbFJnYihpbWdEYXRhLmRhdGEsIG9yaWdpbmFsV2lkdGgsIG9yaWdpbmFsSGVpZ2h0LCBkcmF3V2lkdGgsIGRyYXdIZWlnaHQsIGFjdHVhbEhlaWdodCwgYnBjLCBjb21wcywgYWxwaGEwMSk7CgogICAgICBpZiAobWF5YmVVbmRvUHJlYmxlbmQpIHsKICAgICAgICB0aGlzLnVuZG9QcmVibGVuZChpbWdEYXRhLmRhdGEsIGRyYXdXaWR0aCwgYWN0dWFsSGVpZ2h0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGltZ0RhdGE7CiAgICB9LAogICAgZmlsbEdyYXlCdWZmZXI6IGZ1bmN0aW9uIGZpbGxHcmF5QnVmZmVyKGJ1ZmZlcikgewogICAgICB2YXIgbnVtQ29tcHMgPSB0aGlzLm51bUNvbXBzOwoKICAgICAgaWYgKG51bUNvbXBzICE9PSAxKSB7CiAgICAgICAgdGhyb3cgbmV3IF91dGlsLkZvcm1hdEVycm9yKCJSZWFkaW5nIGdyYXkgc2NhbGUgZnJvbSBhIGNvbG9yIGltYWdlOiAiLmNvbmNhdChudW1Db21wcykpOwogICAgICB9CgogICAgICB2YXIgd2lkdGggPSB0aGlzLndpZHRoOwogICAgICB2YXIgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7CiAgICAgIHZhciBicGMgPSB0aGlzLmJwYzsKICAgICAgdmFyIHJvd0J5dGVzID0gd2lkdGggKiBudW1Db21wcyAqIGJwYyArIDcgPj4gMzsKICAgICAgdmFyIGltZ0FycmF5ID0gdGhpcy5nZXRJbWFnZUJ5dGVzKGhlaWdodCAqIHJvd0J5dGVzKTsKICAgICAgdmFyIGNvbXBzID0gdGhpcy5nZXRDb21wb25lbnRzKGltZ0FycmF5KTsKICAgICAgdmFyIGksIGxlbmd0aDsKCiAgICAgIGlmIChicGMgPT09IDEpIHsKICAgICAgICBsZW5ndGggPSB3aWR0aCAqIGhlaWdodDsKCiAgICAgICAgaWYgKHRoaXMubmVlZHNEZWNvZGUpIHsKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgICAgICBidWZmZXJbaV0gPSBjb21wc1tpXSAtIDEgJiAyNTU7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgICAgICBidWZmZXJbaV0gPSAtY29tcHNbaV0gJiAyNTU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm5lZWRzRGVjb2RlKSB7CiAgICAgICAgdGhpcy5kZWNvZGVCdWZmZXIoY29tcHMpOwogICAgICB9CgogICAgICBsZW5ndGggPSB3aWR0aCAqIGhlaWdodDsKICAgICAgdmFyIHNjYWxlID0gMjU1IC8gKCgxIDw8IGJwYykgLSAxKTsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewogICAgICAgIGJ1ZmZlcltpXSA9IHNjYWxlICogY29tcHNbaV07CiAgICAgIH0KICAgIH0sCiAgICBnZXRJbWFnZUJ5dGVzOiBmdW5jdGlvbiBnZXRJbWFnZUJ5dGVzKGxlbmd0aCwgZHJhd1dpZHRoLCBkcmF3SGVpZ2h0KSB7CiAgICAgIHZhciBmb3JjZVJHQiA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogZmFsc2U7CiAgICAgIHRoaXMuaW1hZ2UucmVzZXQoKTsKICAgICAgdGhpcy5pbWFnZS5kcmF3V2lkdGggPSBkcmF3V2lkdGggfHwgdGhpcy53aWR0aDsKICAgICAgdGhpcy5pbWFnZS5kcmF3SGVpZ2h0ID0gZHJhd0hlaWdodCB8fCB0aGlzLmhlaWdodDsKICAgICAgdGhpcy5pbWFnZS5mb3JjZVJHQiA9ICEhZm9yY2VSR0I7CiAgICAgIHJldHVybiB0aGlzLmltYWdlLmdldEJ5dGVzKGxlbmd0aCwgdHJ1ZSk7CiAgICB9CiAgfTsKICByZXR1cm4gUERGSW1hZ2U7Cn0oKTsKCmV4cG9ydHMuUERGSW1hZ2UgPSBQREZJbWFnZTsKCi8qKiovIH0pLAovKiAyMzggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193X3BkZmpzX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5NZXNzYWdlSGFuZGxlciA9IHZvaWQgMDsKCnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9fd19wZGZqc19yZXF1aXJlX18oMikpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICJkZWZhdWx0Ijogb2JqIH07IH0KCmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHsgdHJ5IHsgdmFyIGluZm8gPSBnZW5ba2V5XShhcmcpOyB2YXIgdmFsdWUgPSBpbmZvLnZhbHVlOyB9IGNhdGNoIChlcnJvcikgeyByZWplY3QoZXJyb3IpOyByZXR1cm47IH0gaWYgKGluZm8uZG9uZSkgeyByZXNvbHZlKHZhbHVlKTsgfSBlbHNlIHsgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpOyB9IH0KCmZ1bmN0aW9uIF9hc3luY1RvR2VuZXJhdG9yKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csICJuZXh0IiwgdmFsdWUpOyB9IGZ1bmN0aW9uIF90aHJvdyhlcnIpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAidGhyb3ciLCBlcnIpOyB9IF9uZXh0KHVuZGVmaW5lZCk7IH0pOyB9OyB9CgpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9CgpmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfQoKZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gInN5bWJvbCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9Cgp2YXIgQ2FsbGJhY2tLaW5kID0gewogIFVOS05PV046IDAsCiAgREFUQTogMSwKICBFUlJPUjogMgp9Owp2YXIgU3RyZWFtS2luZCA9IHsKICBVTktOT1dOOiAwLAogIENBTkNFTDogMSwKICBDQU5DRUxfQ09NUExFVEU6IDIsCiAgQ0xPU0U6IDMsCiAgRU5RVUVVRTogNCwKICBFUlJPUjogNSwKICBQVUxMOiA2LAogIFBVTExfQ09NUExFVEU6IDcsCiAgU1RBUlRfQ09NUExFVEU6IDgKfTsKCmZ1bmN0aW9uIHdyYXBSZWFzb24ocmVhc29uKSB7CiAgaWYgKF90eXBlb2YocmVhc29uKSAhPT0gIm9iamVjdCIgfHwgcmVhc29uID09PSBudWxsKSB7CiAgICByZXR1cm4gcmVhc29uOwogIH0KCiAgc3dpdGNoIChyZWFzb24ubmFtZSkgewogICAgY2FzZSAiQWJvcnRFeGNlcHRpb24iOgogICAgICByZXR1cm4gbmV3IF91dGlsLkFib3J0RXhjZXB0aW9uKHJlYXNvbi5tZXNzYWdlKTsKCiAgICBjYXNlICJNaXNzaW5nUERGRXhjZXB0aW9uIjoKICAgICAgcmV0dXJuIG5ldyBfdXRpbC5NaXNzaW5nUERGRXhjZXB0aW9uKHJlYXNvbi5tZXNzYWdlKTsKCiAgICBjYXNlICJVbmV4cGVjdGVkUmVzcG9uc2VFeGNlcHRpb24iOgogICAgICByZXR1cm4gbmV3IF91dGlsLlVuZXhwZWN0ZWRSZXNwb25zZUV4Y2VwdGlvbihyZWFzb24ubWVzc2FnZSwgcmVhc29uLnN0YXR1cyk7CgogICAgY2FzZSAiVW5rbm93bkVycm9yRXhjZXB0aW9uIjoKICAgICAgcmV0dXJuIG5ldyBfdXRpbC5Vbmtub3duRXJyb3JFeGNlcHRpb24ocmVhc29uLm1lc3NhZ2UsIHJlYXNvbi5kZXRhaWxzKTsKCiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gbmV3IF91dGlsLlVua25vd25FcnJvckV4Y2VwdGlvbihyZWFzb24ubWVzc2FnZSwgcmVhc29uLnRvU3RyaW5nKCkpOwogIH0KfQoKdmFyIE1lc3NhZ2VIYW5kbGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBNZXNzYWdlSGFuZGxlcihzb3VyY2VOYW1lLCB0YXJnZXROYW1lLCBjb21PYmopIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lc3NhZ2VIYW5kbGVyKTsKCiAgICB0aGlzLnNvdXJjZU5hbWUgPSBzb3VyY2VOYW1lOwogICAgdGhpcy50YXJnZXROYW1lID0gdGFyZ2V0TmFtZTsKICAgIHRoaXMuY29tT2JqID0gY29tT2JqOwogICAgdGhpcy5jYWxsYmFja0lkID0gMTsKICAgIHRoaXMuc3RyZWFtSWQgPSAxOwogICAgdGhpcy5wb3N0TWVzc2FnZVRyYW5zZmVycyA9IHRydWU7CiAgICB0aGlzLnN0cmVhbVNpbmtzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdGhpcy5jYWxsYmFja0NhcGFiaWxpdGllcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICB0aGlzLmFjdGlvbkhhbmRsZXIgPSBPYmplY3QuY3JlYXRlKG51bGwpOwoKICAgIHRoaXMuX29uQ29tT2JqT25NZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciBkYXRhID0gZXZlbnQuZGF0YTsKCiAgICAgIGlmIChkYXRhLnRhcmdldE5hbWUgIT09IF90aGlzLnNvdXJjZU5hbWUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChkYXRhLnN0cmVhbSkgewogICAgICAgIF90aGlzLl9wcm9jZXNzU3RyZWFtTWVzc2FnZShkYXRhKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYWxsYmFjaykgewogICAgICAgIHZhciBjYWxsYmFja0lkID0gZGF0YS5jYWxsYmFja0lkOwogICAgICAgIHZhciBjYXBhYmlsaXR5ID0gX3RoaXMuY2FsbGJhY2tDYXBhYmlsaXRpZXNbY2FsbGJhY2tJZF07CgogICAgICAgIGlmICghY2FwYWJpbGl0eSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgcmVzb2x2ZSBjYWxsYmFjayAiLmNvbmNhdChjYWxsYmFja0lkKSk7CiAgICAgICAgfQoKICAgICAgICBkZWxldGUgX3RoaXMuY2FsbGJhY2tDYXBhYmlsaXRpZXNbY2FsbGJhY2tJZF07CgogICAgICAgIGlmIChkYXRhLmNhbGxiYWNrID09PSBDYWxsYmFja0tpbmQuREFUQSkgewogICAgICAgICAgY2FwYWJpbGl0eS5yZXNvbHZlKGRhdGEuZGF0YSk7CiAgICAgICAgfSBlbHNlIGlmIChkYXRhLmNhbGxiYWNrID09PSBDYWxsYmFja0tpbmQuRVJST1IpIHsKICAgICAgICAgIGNhcGFiaWxpdHkucmVqZWN0KHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIGNhbGxiYWNrIGNhc2UiKTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGFjdGlvbiA9IF90aGlzLmFjdGlvbkhhbmRsZXJbZGF0YS5hY3Rpb25dOwoKICAgICAgaWYgKCFhY3Rpb24pIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gYWN0aW9uIGZyb20gd29ya2VyOiAiLmNvbmNhdChkYXRhLmFjdGlvbikpOwogICAgICB9CgogICAgICBpZiAoZGF0YS5jYWxsYmFja0lkKSB7CiAgICAgICAgdmFyIGNiU291cmNlTmFtZSA9IF90aGlzLnNvdXJjZU5hbWU7CiAgICAgICAgdmFyIGNiVGFyZ2V0TmFtZSA9IGRhdGEuc291cmNlTmFtZTsKICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgcmVzb2x2ZShhY3Rpb24oZGF0YS5kYXRhKSk7CiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICBzb3VyY2VOYW1lOiBjYlNvdXJjZU5hbWUsCiAgICAgICAgICAgIHRhcmdldE5hbWU6IGNiVGFyZ2V0TmFtZSwKICAgICAgICAgICAgY2FsbGJhY2s6IENhbGxiYWNrS2luZC5EQVRBLAogICAgICAgICAgICBjYWxsYmFja0lkOiBkYXRhLmNhbGxiYWNrSWQsCiAgICAgICAgICAgIGRhdGE6IHJlc3VsdAogICAgICAgICAgfSk7CiAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZTogY2JTb3VyY2VOYW1lLAogICAgICAgICAgICB0YXJnZXROYW1lOiBjYlRhcmdldE5hbWUsCiAgICAgICAgICAgIGNhbGxiYWNrOiBDYWxsYmFja0tpbmQuRVJST1IsCiAgICAgICAgICAgIGNhbGxiYWNrSWQ6IGRhdGEuY2FsbGJhY2tJZCwKICAgICAgICAgICAgcmVhc29uOiB3cmFwUmVhc29uKHJlYXNvbikKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGRhdGEuc3RyZWFtSWQpIHsKICAgICAgICBfdGhpcy5fY3JlYXRlU3RyZWFtU2luayhkYXRhKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBhY3Rpb24oZGF0YS5kYXRhKTsKICAgIH07CgogICAgY29tT2JqLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCB0aGlzLl9vbkNvbU9iak9uTWVzc2FnZSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTWVzc2FnZUhhbmRsZXIsIFt7CiAgICBrZXk6ICJvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb24oYWN0aW9uTmFtZSwgaGFuZGxlcikgewogICAgICB2YXIgYWggPSB0aGlzLmFjdGlvbkhhbmRsZXI7CgogICAgICBpZiAoYWhbYWN0aW9uTmFtZV0pIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlRoZXJlIGlzIGFscmVhZHkgYW4gYWN0aW9uTmFtZSBjYWxsZWQgXCIiLmNvbmNhdChhY3Rpb25OYW1lLCAiXCIiKSk7CiAgICAgIH0KCiAgICAgIGFoW2FjdGlvbk5hbWVdID0gaGFuZGxlcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kKGFjdGlvbk5hbWUsIGRhdGEsIHRyYW5zZmVycykgewogICAgICB0aGlzLl9wb3N0TWVzc2FnZSh7CiAgICAgICAgc291cmNlTmFtZTogdGhpcy5zb3VyY2VOYW1lLAogICAgICAgIHRhcmdldE5hbWU6IHRoaXMudGFyZ2V0TmFtZSwKICAgICAgICBhY3Rpb246IGFjdGlvbk5hbWUsCiAgICAgICAgZGF0YTogZGF0YQogICAgICB9LCB0cmFuc2ZlcnMpOwogICAgfQogIH0sIHsKICAgIGtleTogInNlbmRXaXRoUHJvbWlzZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VuZFdpdGhQcm9taXNlKGFjdGlvbk5hbWUsIGRhdGEsIHRyYW5zZmVycykgewogICAgICB2YXIgY2FsbGJhY2tJZCA9IHRoaXMuY2FsbGJhY2tJZCsrOwogICAgICB2YXIgY2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICAgICAgdGhpcy5jYWxsYmFja0NhcGFiaWxpdGllc1tjYWxsYmFja0lkXSA9IGNhcGFiaWxpdHk7CgogICAgICB0cnkgewogICAgICAgIHRoaXMuX3Bvc3RNZXNzYWdlKHsKICAgICAgICAgIHNvdXJjZU5hbWU6IHRoaXMuc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWU6IHRoaXMudGFyZ2V0TmFtZSwKICAgICAgICAgIGFjdGlvbjogYWN0aW9uTmFtZSwKICAgICAgICAgIGNhbGxiYWNrSWQ6IGNhbGxiYWNrSWQsCiAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgfSwgdHJhbnNmZXJzKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICBjYXBhYmlsaXR5LnJlamVjdChleCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAic2VuZFdpdGhTdHJlYW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRXaXRoU3RyZWFtKGFjdGlvbk5hbWUsIGRhdGEsIHF1ZXVlaW5nU3RyYXRlZ3ksIHRyYW5zZmVycykgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBzdHJlYW1JZCA9IHRoaXMuc3RyZWFtSWQrKzsKICAgICAgdmFyIHNvdXJjZU5hbWUgPSB0aGlzLnNvdXJjZU5hbWU7CiAgICAgIHZhciB0YXJnZXROYW1lID0gdGhpcy50YXJnZXROYW1lOwogICAgICB2YXIgY29tT2JqID0gdGhpcy5jb21PYmo7CiAgICAgIHJldHVybiBuZXcgUmVhZGFibGVTdHJlYW0oewogICAgICAgIHN0YXJ0OiBmdW5jdGlvbiBzdGFydChjb250cm9sbGVyKSB7CiAgICAgICAgICB2YXIgc3RhcnRDYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICAgICAgX3RoaXMyLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXSA9IHsKICAgICAgICAgICAgY29udHJvbGxlcjogY29udHJvbGxlciwKICAgICAgICAgICAgc3RhcnRDYWxsOiBzdGFydENhcGFiaWxpdHksCiAgICAgICAgICAgIHB1bGxDYWxsOiBudWxsLAogICAgICAgICAgICBjYW5jZWxDYWxsOiBudWxsLAogICAgICAgICAgICBpc0Nsb3NlZDogZmFsc2UKICAgICAgICAgIH07CgogICAgICAgICAgX3RoaXMyLl9wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHNvdXJjZU5hbWU6IHNvdXJjZU5hbWUsCiAgICAgICAgICAgIHRhcmdldE5hbWU6IHRhcmdldE5hbWUsCiAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uTmFtZSwKICAgICAgICAgICAgc3RyZWFtSWQ6IHN0cmVhbUlkLAogICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICBkZXNpcmVkU2l6ZTogY29udHJvbGxlci5kZXNpcmVkU2l6ZQogICAgICAgICAgfSwgdHJhbnNmZXJzKTsKCiAgICAgICAgICByZXR1cm4gc3RhcnRDYXBhYmlsaXR5LnByb21pc2U7CiAgICAgICAgfSwKICAgICAgICBwdWxsOiBmdW5jdGlvbiBwdWxsKGNvbnRyb2xsZXIpIHsKICAgICAgICAgIHZhciBwdWxsQ2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICAgICAgICAgIF90aGlzMi5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0ucHVsbENhbGwgPSBwdWxsQ2FwYWJpbGl0eTsKICAgICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHNvdXJjZU5hbWU6IHNvdXJjZU5hbWUsCiAgICAgICAgICAgIHRhcmdldE5hbWU6IHRhcmdldE5hbWUsCiAgICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5QVUxMLAogICAgICAgICAgICBzdHJlYW1JZDogc3RyZWFtSWQsCiAgICAgICAgICAgIGRlc2lyZWRTaXplOiBjb250cm9sbGVyLmRlc2lyZWRTaXplCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBwdWxsQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgICAgIH0sCiAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiBjYW5jZWwocmVhc29uKSB7CiAgICAgICAgICAoMCwgX3V0aWwuYXNzZXJ0KShyZWFzb24gaW5zdGFuY2VvZiBFcnJvciwgImNhbmNlbCBtdXN0IGhhdmUgYSB2YWxpZCByZWFzb24iKTsKICAgICAgICAgIHZhciBjYW5jZWxDYXBhYmlsaXR5ID0gKDAsIF91dGlsLmNyZWF0ZVByb21pc2VDYXBhYmlsaXR5KSgpOwogICAgICAgICAgX3RoaXMyLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5jYW5jZWxDYWxsID0gY2FuY2VsQ2FwYWJpbGl0eTsKICAgICAgICAgIF90aGlzMi5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0uaXNDbG9zZWQgPSB0cnVlOwogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZTogc291cmNlTmFtZSwKICAgICAgICAgICAgdGFyZ2V0TmFtZTogdGFyZ2V0TmFtZSwKICAgICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLkNBTkNFTCwKICAgICAgICAgICAgc3RyZWFtSWQ6IHN0cmVhbUlkLAogICAgICAgICAgICByZWFzb246IHdyYXBSZWFzb24ocmVhc29uKQogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gY2FuY2VsQ2FwYWJpbGl0eS5wcm9taXNlOwogICAgICAgIH0KICAgICAgfSwgcXVldWVpbmdTdHJhdGVneSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2NyZWF0ZVN0cmVhbVNpbmsiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVTdHJlYW1TaW5rKGRhdGEpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgYWN0aW9uID0gdGhpcy5hY3Rpb25IYW5kbGVyW2RhdGEuYWN0aW9uXTsKICAgICAgdmFyIHN0cmVhbUlkID0gZGF0YS5zdHJlYW1JZDsKICAgICAgdmFyIHNvdXJjZU5hbWUgPSB0aGlzLnNvdXJjZU5hbWU7CiAgICAgIHZhciB0YXJnZXROYW1lID0gZGF0YS5zb3VyY2VOYW1lOwogICAgICB2YXIgY29tT2JqID0gdGhpcy5jb21PYmo7CiAgICAgIHZhciBzdHJlYW1TaW5rID0gewogICAgICAgIGVucXVldWU6IGZ1bmN0aW9uIGVucXVldWUoY2h1bmspIHsKICAgICAgICAgIHZhciBzaXplID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAxOwogICAgICAgICAgdmFyIHRyYW5zZmVycyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwoKICAgICAgICAgIGlmICh0aGlzLmlzQ2FuY2VsbGVkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgbGFzdERlc2lyZWRTaXplID0gdGhpcy5kZXNpcmVkU2l6ZTsKICAgICAgICAgIHRoaXMuZGVzaXJlZFNpemUgLT0gc2l6ZTsKCiAgICAgICAgICBpZiAobGFzdERlc2lyZWRTaXplID4gMCAmJiB0aGlzLmRlc2lyZWRTaXplIDw9IDApIHsKICAgICAgICAgICAgdGhpcy5zaW5rQ2FwYWJpbGl0eSA9ICgwLCBfdXRpbC5jcmVhdGVQcm9taXNlQ2FwYWJpbGl0eSkoKTsKICAgICAgICAgICAgdGhpcy5yZWFkeSA9IHRoaXMuc2lua0NhcGFiaWxpdHkucHJvbWlzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzZWxmLl9wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHNvdXJjZU5hbWU6IHNvdXJjZU5hbWUsCiAgICAgICAgICAgIHRhcmdldE5hbWU6IHRhcmdldE5hbWUsCiAgICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5FTlFVRVVFLAogICAgICAgICAgICBzdHJlYW1JZDogc3RyZWFtSWQsCiAgICAgICAgICAgIGNodW5rOiBjaHVuawogICAgICAgICAgfSwgdHJhbnNmZXJzKTsKICAgICAgICB9LAogICAgICAgIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHsKICAgICAgICAgIGlmICh0aGlzLmlzQ2FuY2VsbGVkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmlzQ2FuY2VsbGVkID0gdHJ1ZTsKICAgICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIHNvdXJjZU5hbWU6IHNvdXJjZU5hbWUsCiAgICAgICAgICAgIHRhcmdldE5hbWU6IHRhcmdldE5hbWUsCiAgICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5DTE9TRSwKICAgICAgICAgICAgc3RyZWFtSWQ6IHN0cmVhbUlkCiAgICAgICAgICB9KTsKICAgICAgICAgIGRlbGV0ZSBzZWxmLnN0cmVhbVNpbmtzW3N0cmVhbUlkXTsKICAgICAgICB9LAogICAgICAgIGVycm9yOiBmdW5jdGlvbiBlcnJvcihyZWFzb24pIHsKICAgICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHJlYXNvbiBpbnN0YW5jZW9mIEVycm9yLCAiZXJyb3IgbXVzdCBoYXZlIGEgdmFsaWQgcmVhc29uIik7CgogICAgICAgICAgaWYgKHRoaXMuaXNDYW5jZWxsZWQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuaXNDYW5jZWxsZWQgPSB0cnVlOwogICAgICAgICAgY29tT2JqLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgc291cmNlTmFtZTogc291cmNlTmFtZSwKICAgICAgICAgICAgdGFyZ2V0TmFtZTogdGFyZ2V0TmFtZSwKICAgICAgICAgICAgc3RyZWFtOiBTdHJlYW1LaW5kLkVSUk9SLAogICAgICAgICAgICBzdHJlYW1JZDogc3RyZWFtSWQsCiAgICAgICAgICAgIHJlYXNvbjogd3JhcFJlYXNvbihyZWFzb24pCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHNpbmtDYXBhYmlsaXR5OiAoMCwgX3V0aWwuY3JlYXRlUHJvbWlzZUNhcGFiaWxpdHkpKCksCiAgICAgICAgb25QdWxsOiBudWxsLAogICAgICAgIG9uQ2FuY2VsOiBudWxsLAogICAgICAgIGlzQ2FuY2VsbGVkOiBmYWxzZSwKICAgICAgICBkZXNpcmVkU2l6ZTogZGF0YS5kZXNpcmVkU2l6ZSwKICAgICAgICByZWFkeTogbnVsbAogICAgICB9OwogICAgICBzdHJlYW1TaW5rLnNpbmtDYXBhYmlsaXR5LnJlc29sdmUoKTsKICAgICAgc3RyZWFtU2luay5yZWFkeSA9IHN0cmVhbVNpbmsuc2lua0NhcGFiaWxpdHkucHJvbWlzZTsKICAgICAgdGhpcy5zdHJlYW1TaW5rc1tzdHJlYW1JZF0gPSBzdHJlYW1TaW5rOwogICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIHJlc29sdmUoYWN0aW9uKGRhdGEuZGF0YSwgc3RyZWFtU2luaykpOwogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgc291cmNlTmFtZTogc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWU6IHRhcmdldE5hbWUsCiAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuU1RBUlRfQ09NUExFVEUsCiAgICAgICAgICBzdHJlYW1JZDogc3RyZWFtSWQsCiAgICAgICAgICBzdWNjZXNzOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgc291cmNlTmFtZTogc291cmNlTmFtZSwKICAgICAgICAgIHRhcmdldE5hbWU6IHRhcmdldE5hbWUsCiAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuU1RBUlRfQ09NUExFVEUsCiAgICAgICAgICBzdHJlYW1JZDogc3RyZWFtSWQsCiAgICAgICAgICByZWFzb246IHdyYXBSZWFzb24ocmVhc29uKQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfcHJvY2Vzc1N0cmVhbU1lc3NhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9wcm9jZXNzU3RyZWFtTWVzc2FnZShkYXRhKSB7CiAgICAgIHZhciBzdHJlYW1JZCA9IGRhdGEuc3RyZWFtSWQ7CiAgICAgIHZhciBzb3VyY2VOYW1lID0gdGhpcy5zb3VyY2VOYW1lOwogICAgICB2YXIgdGFyZ2V0TmFtZSA9IGRhdGEuc291cmNlTmFtZTsKICAgICAgdmFyIGNvbU9iaiA9IHRoaXMuY29tT2JqOwoKICAgICAgc3dpdGNoIChkYXRhLnN0cmVhbSkgewogICAgICAgIGNhc2UgU3RyZWFtS2luZC5TVEFSVF9DT01QTEVURToKICAgICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgdGhpcy5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0uc3RhcnRDYWxsLnJlc29sdmUoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLnN0YXJ0Q2FsbC5yZWplY3Qod3JhcFJlYXNvbihkYXRhLnJlYXNvbikpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFN0cmVhbUtpbmQuUFVMTF9DT01QTEVURToKICAgICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgdGhpcy5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0ucHVsbENhbGwucmVzb2x2ZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0ucHVsbENhbGwucmVqZWN0KHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBTdHJlYW1LaW5kLlBVTEw6CiAgICAgICAgICBpZiAoIXRoaXMuc3RyZWFtU2lua3Nbc3RyZWFtSWRdKSB7CiAgICAgICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgc291cmNlTmFtZTogc291cmNlTmFtZSwKICAgICAgICAgICAgICB0YXJnZXROYW1lOiB0YXJnZXROYW1lLAogICAgICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5QVUxMX0NPTVBMRVRFLAogICAgICAgICAgICAgIHN0cmVhbUlkOiBzdHJlYW1JZCwKICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodGhpcy5zdHJlYW1TaW5rc1tzdHJlYW1JZF0uZGVzaXJlZFNpemUgPD0gMCAmJiBkYXRhLmRlc2lyZWRTaXplID4gMCkgewogICAgICAgICAgICB0aGlzLnN0cmVhbVNpbmtzW3N0cmVhbUlkXS5zaW5rQ2FwYWJpbGl0eS5yZXNvbHZlKCk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5zdHJlYW1TaW5rc1tzdHJlYW1JZF0uZGVzaXJlZFNpemUgPSBkYXRhLmRlc2lyZWRTaXplOwogICAgICAgICAgdmFyIG9uUHVsbCA9IHRoaXMuc3RyZWFtU2lua3NbZGF0YS5zdHJlYW1JZF0ub25QdWxsOwogICAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgcmVzb2x2ZShvblB1bGwgJiYgb25QdWxsKCkpOwogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbU9iai5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgc291cmNlTmFtZTogc291cmNlTmFtZSwKICAgICAgICAgICAgICB0YXJnZXROYW1lOiB0YXJnZXROYW1lLAogICAgICAgICAgICAgIHN0cmVhbTogU3RyZWFtS2luZC5QVUxMX0NPTVBMRVRFLAogICAgICAgICAgICAgIHN0cmVhbUlkOiBzdHJlYW1JZCwKICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgIHNvdXJjZU5hbWU6IHNvdXJjZU5hbWUsCiAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogdGFyZ2V0TmFtZSwKICAgICAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuUFVMTF9DT01QTEVURSwKICAgICAgICAgICAgICBzdHJlYW1JZDogc3RyZWFtSWQsCiAgICAgICAgICAgICAgcmVhc29uOiB3cmFwUmVhc29uKHJlYXNvbikKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFN0cmVhbUtpbmQuRU5RVUVVRToKICAgICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLCAiZW5xdWV1ZSBzaG91bGQgaGF2ZSBzdHJlYW0gY29udHJvbGxlciIpOwoKICAgICAgICAgIGlmICh0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5pc0Nsb3NlZCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5jb250cm9sbGVyLmVucXVldWUoZGF0YS5jaHVuayk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBTdHJlYW1LaW5kLkNMT1NFOgogICAgICAgICAgKDAsIF91dGlsLmFzc2VydCkodGhpcy5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0sICJjbG9zZSBzaG91bGQgaGF2ZSBzdHJlYW0gY29udHJvbGxlciIpOwoKICAgICAgICAgIGlmICh0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5pc0Nsb3NlZCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5pc0Nsb3NlZCA9IHRydWU7CiAgICAgICAgICB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5jb250cm9sbGVyLmNsb3NlKCk7CgogICAgICAgICAgdGhpcy5fZGVsZXRlU3RyZWFtQ29udHJvbGxlcihzdHJlYW1JZCk7CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgU3RyZWFtS2luZC5FUlJPUjoKICAgICAgICAgICgwLCBfdXRpbC5hc3NlcnQpKHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLCAiZXJyb3Igc2hvdWxkIGhhdmUgc3RyZWFtIGNvbnRyb2xsZXIiKTsKICAgICAgICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLmNvbnRyb2xsZXIuZXJyb3Iod3JhcFJlYXNvbihkYXRhLnJlYXNvbikpOwoKICAgICAgICAgIHRoaXMuX2RlbGV0ZVN0cmVhbUNvbnRyb2xsZXIoc3RyZWFtSWQpOwoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIFN0cmVhbUtpbmQuQ0FOQ0VMX0NPTVBMRVRFOgogICAgICAgICAgaWYgKGRhdGEuc3VjY2VzcykgewogICAgICAgICAgICB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5jYW5jZWxDYWxsLnJlc29sdmUoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdLmNhbmNlbENhbGwucmVqZWN0KHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLl9kZWxldGVTdHJlYW1Db250cm9sbGVyKHN0cmVhbUlkKTsKCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBTdHJlYW1LaW5kLkNBTkNFTDoKICAgICAgICAgIGlmICghdGhpcy5zdHJlYW1TaW5rc1tzdHJlYW1JZF0pIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG9uQ2FuY2VsID0gdGhpcy5zdHJlYW1TaW5rc1tkYXRhLnN0cmVhbUlkXS5vbkNhbmNlbDsKICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgICAgIHJlc29sdmUob25DYW5jZWwgJiYgb25DYW5jZWwod3JhcFJlYXNvbihkYXRhLnJlYXNvbikpKTsKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgIHNvdXJjZU5hbWU6IHNvdXJjZU5hbWUsCiAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogdGFyZ2V0TmFtZSwKICAgICAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuQ0FOQ0VMX0NPTVBMRVRFLAogICAgICAgICAgICAgIHN0cmVhbUlkOiBzdHJlYW1JZCwKICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgICAgICBjb21PYmoucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgIHNvdXJjZU5hbWU6IHNvdXJjZU5hbWUsCiAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogdGFyZ2V0TmFtZSwKICAgICAgICAgICAgICBzdHJlYW06IFN0cmVhbUtpbmQuQ0FOQ0VMX0NPTVBMRVRFLAogICAgICAgICAgICAgIHN0cmVhbUlkOiBzdHJlYW1JZCwKICAgICAgICAgICAgICByZWFzb246IHdyYXBSZWFzb24ocmVhc29uKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zdHJlYW1TaW5rc1tzdHJlYW1JZF0uc2lua0NhcGFiaWxpdHkucmVqZWN0KHdyYXBSZWFzb24oZGF0YS5yZWFzb24pKTsKICAgICAgICAgIHRoaXMuc3RyZWFtU2lua3Nbc3RyZWFtSWRdLmlzQ2FuY2VsbGVkID0gdHJ1ZTsKICAgICAgICAgIGRlbGV0ZSB0aGlzLnN0cmVhbVNpbmtzW3N0cmVhbUlkXTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmV4cGVjdGVkIHN0cmVhbSBjYXNlIik7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZGVsZXRlU3RyZWFtQ29udHJvbGxlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2RlbGV0ZVN0cmVhbUNvbnRyb2xsZXIyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JbImRlZmF1bHQiXS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoc3RyZWFtSWQpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yWyJkZWZhdWx0Il0ud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsU2V0dGxlZChbdGhpcy5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0uc3RhcnRDYWxsLCB0aGlzLnN0cmVhbUNvbnRyb2xsZXJzW3N0cmVhbUlkXS5wdWxsQ2FsbCwgdGhpcy5zdHJlYW1Db250cm9sbGVyc1tzdHJlYW1JZF0uY2FuY2VsQ2FsbF0ubWFwKGZ1bmN0aW9uIChjYXBhYmlsaXR5KSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBjYXBhYmlsaXR5ICYmIGNhcGFiaWxpdHkucHJvbWlzZTsKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuc3RyZWFtQ29udHJvbGxlcnNbc3RyZWFtSWRdOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gX2RlbGV0ZVN0cmVhbUNvbnRyb2xsZXIoX3gpIHsKICAgICAgICByZXR1cm4gX2RlbGV0ZVN0cmVhbUNvbnRyb2xsZXIyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBfZGVsZXRlU3RyZWFtQ29udHJvbGxlcjsKICAgIH0oKQogIH0sIHsKICAgIGtleTogIl9wb3N0TWVzc2FnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3Bvc3RNZXNzYWdlKG1lc3NhZ2UsIHRyYW5zZmVycykgewogICAgICBpZiAodHJhbnNmZXJzICYmIHRoaXMucG9zdE1lc3NhZ2VUcmFuc2ZlcnMpIHsKICAgICAgICB0aGlzLmNvbU9iai5wb3N0TWVzc2FnZShtZXNzYWdlLCB0cmFuc2ZlcnMpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29tT2JqLnBvc3RNZXNzYWdlKG1lc3NhZ2UpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVzdHJveSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHsKICAgICAgdGhpcy5jb21PYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIHRoaXMuX29uQ29tT2JqT25NZXNzYWdlKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBNZXNzYWdlSGFuZGxlcjsKfSgpOwoKZXhwb3J0cy5NZXNzYWdlSGFuZGxlciA9IE1lc3NhZ2VIYW5kbGVyOwoKLyoqKi8gfSksCi8qIDIzOSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dfcGRmanNfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLlBERldvcmtlclN0cmVhbSA9IHZvaWQgMDsKCnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9fd19wZGZqc19yZXF1aXJlX18oMikpOwoKdmFyIF91dGlsID0gX193X3BkZmpzX3JlcXVpcmVfXyg1KTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CgpmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoKZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH0KCnZhciBQREZXb3JrZXJTdHJlYW0gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFBERldvcmtlclN0cmVhbShtc2dIYW5kbGVyKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUERGV29ya2VyU3RyZWFtKTsKCiAgICB0aGlzLl9tc2dIYW5kbGVyID0gbXNnSGFuZGxlcjsKICAgIHRoaXMuX2NvbnRlbnRMZW5ndGggPSBudWxsOwogICAgdGhpcy5fZnVsbFJlcXVlc3RSZWFkZXIgPSBudWxsOwogICAgdGhpcy5fcmFuZ2VSZXF1ZXN0UmVhZGVycyA9IFtdOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFBERldvcmtlclN0cmVhbSwgW3sKICAgIGtleTogImdldEZ1bGxSZWFkZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZ1bGxSZWFkZXIoKSB7CiAgICAgICgwLCBfdXRpbC5hc3NlcnQpKCF0aGlzLl9mdWxsUmVxdWVzdFJlYWRlciwgIlBERldvcmtlclN0cmVhbS5nZXRGdWxsUmVhZGVyIGNhbiBvbmx5IGJlIGNhbGxlZCBvbmNlLiIpOwogICAgICB0aGlzLl9mdWxsUmVxdWVzdFJlYWRlciA9IG5ldyBQREZXb3JrZXJTdHJlYW1SZWFkZXIodGhpcy5fbXNnSGFuZGxlcik7CiAgICAgIHJldHVybiB0aGlzLl9mdWxsUmVxdWVzdFJlYWRlcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRSYW5nZVJlYWRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmFuZ2VSZWFkZXIoYmVnaW4sIGVuZCkgewogICAgICB2YXIgcmVhZGVyID0gbmV3IFBERldvcmtlclN0cmVhbVJhbmdlUmVhZGVyKGJlZ2luLCBlbmQsIHRoaXMuX21zZ0hhbmRsZXIpOwoKICAgICAgdGhpcy5fcmFuZ2VSZXF1ZXN0UmVhZGVycy5wdXNoKHJlYWRlcik7CgogICAgICByZXR1cm4gcmVhZGVyOwogICAgfQogIH0sIHsKICAgIGtleTogImNhbmNlbEFsbFJlcXVlc3RzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5jZWxBbGxSZXF1ZXN0cyhyZWFzb24pIHsKICAgICAgaWYgKHRoaXMuX2Z1bGxSZXF1ZXN0UmVhZGVyKSB7CiAgICAgICAgdGhpcy5fZnVsbFJlcXVlc3RSZWFkZXIuY2FuY2VsKHJlYXNvbik7CiAgICAgIH0KCiAgICAgIHZhciByZWFkZXJzID0gdGhpcy5fcmFuZ2VSZXF1ZXN0UmVhZGVycy5zbGljZSgwKTsKCiAgICAgIHJlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAocmVhZGVyKSB7CiAgICAgICAgcmVhZGVyLmNhbmNlbChyZWFzb24pOwogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBQREZXb3JrZXJTdHJlYW07Cn0oKTsKCmV4cG9ydHMuUERGV29ya2VyU3RyZWFtID0gUERGV29ya2VyU3RyZWFtOwoKdmFyIFBERldvcmtlclN0cmVhbVJlYWRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUERGV29ya2VyU3RyZWFtUmVhZGVyKG1zZ0hhbmRsZXIpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBERldvcmtlclN0cmVhbVJlYWRlcik7CgogICAgdGhpcy5fbXNnSGFuZGxlciA9IG1zZ0hhbmRsZXI7CiAgICB0aGlzLm9uUHJvZ3Jlc3MgPSBudWxsOwogICAgdGhpcy5fY29udGVudExlbmd0aCA9IG51bGw7CiAgICB0aGlzLl9pc1JhbmdlU3VwcG9ydGVkID0gZmFsc2U7CiAgICB0aGlzLl9pc1N0cmVhbWluZ1N1cHBvcnRlZCA9IGZhbHNlOwoKICAgIHZhciByZWFkYWJsZVN0cmVhbSA9IHRoaXMuX21zZ0hhbmRsZXIuc2VuZFdpdGhTdHJlYW0oIkdldFJlYWRlciIpOwoKICAgIHRoaXMuX3JlYWRlciA9IHJlYWRhYmxlU3RyZWFtLmdldFJlYWRlcigpOwogICAgdGhpcy5faGVhZGVyc1JlYWR5ID0gdGhpcy5fbXNnSGFuZGxlci5zZW5kV2l0aFByb21pc2UoIlJlYWRlckhlYWRlcnNSZWFkeSIpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgX3RoaXMuX2lzU3RyZWFtaW5nU3VwcG9ydGVkID0gZGF0YS5pc1N0cmVhbWluZ1N1cHBvcnRlZDsKICAgICAgX3RoaXMuX2lzUmFuZ2VTdXBwb3J0ZWQgPSBkYXRhLmlzUmFuZ2VTdXBwb3J0ZWQ7CiAgICAgIF90aGlzLl9jb250ZW50TGVuZ3RoID0gZGF0YS5jb250ZW50TGVuZ3RoOwogICAgfSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoUERGV29ya2VyU3RyZWFtUmVhZGVyLCBbewogICAga2V5OiAicmVhZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlYWQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclsiZGVmYXVsdCJdLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgX3lpZWxkJHRoaXMkX3JlYWRlciRyLCB2YWx1ZSwgZG9uZTsKCiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclsiZGVmYXVsdCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkZXIucmVhZCgpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyRfcmVhZGVyJHIgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgdmFsdWUgPSBfeWllbGQkdGhpcyRfcmVhZGVyJHIudmFsdWU7CiAgICAgICAgICAgICAgICBkb25lID0gX3lpZWxkJHRoaXMkX3JlYWRlciRyLmRvbmU7CgogICAgICAgICAgICAgICAgaWYgKCFkb25lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICAgIGRvbmU6IHRydWUKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZS5idWZmZXIsCiAgICAgICAgICAgICAgICAgIGRvbmU6IGZhbHNlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHJlYWQoKSB7CiAgICAgICAgcmV0dXJuIF9yZWFkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZWFkOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiY2FuY2VsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5jZWwocmVhc29uKSB7CiAgICAgIHRoaXMuX3JlYWRlci5jYW5jZWwocmVhc29uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJoZWFkZXJzUmVhZHkiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9oZWFkZXJzUmVhZHk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29udGVudExlbmd0aCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnRMZW5ndGg7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNTdHJlYW1pbmdTdXBwb3J0ZWQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9pc1N0cmVhbWluZ1N1cHBvcnRlZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc1JhbmdlU3VwcG9ydGVkIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5faXNSYW5nZVN1cHBvcnRlZDsKICAgIH0KICB9XSk7CgogIHJldHVybiBQREZXb3JrZXJTdHJlYW1SZWFkZXI7Cn0oKTsKCnZhciBQREZXb3JrZXJTdHJlYW1SYW5nZVJlYWRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUERGV29ya2VyU3RyZWFtUmFuZ2VSZWFkZXIoYmVnaW4sIGVuZCwgbXNnSGFuZGxlcikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBERldvcmtlclN0cmVhbVJhbmdlUmVhZGVyKTsKCiAgICB0aGlzLl9tc2dIYW5kbGVyID0gbXNnSGFuZGxlcjsKICAgIHRoaXMub25Qcm9ncmVzcyA9IG51bGw7CgogICAgdmFyIHJlYWRhYmxlU3RyZWFtID0gdGhpcy5fbXNnSGFuZGxlci5zZW5kV2l0aFN0cmVhbSgiR2V0UmFuZ2VSZWFkZXIiLCB7CiAgICAgIGJlZ2luOiBiZWdpbiwKICAgICAgZW5kOiBlbmQKICAgIH0pOwoKICAgIHRoaXMuX3JlYWRlciA9IHJlYWRhYmxlU3RyZWFtLmdldFJlYWRlcigpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFBERldvcmtlclN0cmVhbVJhbmdlUmVhZGVyLCBbewogICAga2V5OiAicmVhZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlYWQyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JbImRlZmF1bHQiXS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBfeWllbGQkdGhpcyRfcmVhZGVyJHIyLCB2YWx1ZSwgZG9uZTsKCiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclsiZGVmYXVsdCJdLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWRlci5yZWFkKCk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJF9yZWFkZXIkcjIgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIHZhbHVlID0gX3lpZWxkJHRoaXMkX3JlYWRlciRyMi52YWx1ZTsKICAgICAgICAgICAgICAgIGRvbmUgPSBfeWllbGQkdGhpcyRfcmVhZGVyJHIyLmRvbmU7CgogICAgICAgICAgICAgICAgaWYgKCFkb25lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCwKICAgICAgICAgICAgICAgICAgZG9uZTogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZS5idWZmZXIsCiAgICAgICAgICAgICAgICAgIGRvbmU6IGZhbHNlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcmVhZCgpIHsKICAgICAgICByZXR1cm4gX3JlYWQyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZWFkOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiY2FuY2VsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5jZWwocmVhc29uKSB7CiAgICAgIHRoaXMuX3JlYWRlci5jYW5jZWwocmVhc29uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc1N0cmVhbWluZ1N1cHBvcnRlZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFBERldvcmtlclN0cmVhbVJhbmdlUmVhZGVyOwp9KCk7CgovKioqLyB9KQovKioqKioqLyBdKTsKfSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXBkZi53b3JrZXIuanMubWFw';
  export function getBundle() {
    return bundle;
  }
  export function getBundleMd5() {
    return '4ed0244cf5ce1f61eb5b2d4a56c0a316';
  }
  export function getFileName() {
    return 'pdf.worker.min.js';
  }
  